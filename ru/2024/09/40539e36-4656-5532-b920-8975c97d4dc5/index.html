<!doctype html><html class=h-100 dir=ltr lang=ru-RU data-bs-theme=auto prefix="og: http://ogp.me/ns#
      article: http://ogp.me/ns/article#
      profile: http://ogp.me/ns/profile#
      fb: http://ogp.me/ns/fb#"><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1,viewport-fit=cover"><title>Уведомления от Windows Server Backup / Library Online</title>
<meta name=title content="Уведомления от Windows Server Backup / Library Online"><meta name=description content="Windows Server Backup хороша в качестве компонента резервного копирования, встроенного в ОС. Но работу этого компонента неплохо было бы отслеживать."><meta name=keywords content="backup,mail,notice"><link rel=preconnect href=https://gravatar.com crossorigin=anonymous><link rel=preconnect href=https://images.unsplash.com crossorigin=anonymous><script src=/js/theme.min.5f10d03721145ce818261015067fd92d71c874ab15bf49889ca53b1cf0c73c18.js integrity="sha256-XxDQNyEUXOgYJhAVBn/ZLXHIdKsVv0mInKU7HPDHPBg=" crossorigin=anonymous></script><link rel=preload href=/css/vendor.bundle.min.css as=style><link rel=stylesheet href=/css/vendor.bundle.min.css><link rel=preload href=/ru/css/system.bundle.min.css as=style><link rel=stylesheet href=/ru/css/system.bundle.min.css><link rel=icon type=image/png sizes=16x16 href=https://lib.onl/favicon-16.png><link rel="shortcut icon" type=image/png sizes=16x16 href=https://lib.onl/favicon-16.png><link rel=apple-touch-icon sizes=16x16 href=https://lib.onl/favicon-16.png><link rel=icon type=image/png sizes=24x24 href=https://lib.onl/favicon-24.png><link rel="shortcut icon" type=image/png sizes=24x24 href=https://lib.onl/favicon-24.png><link rel=apple-touch-icon sizes=24x24 href=https://lib.onl/favicon-24.png><link rel=icon type=image/png sizes=32x32 href=https://lib.onl/favicon-32.png><link rel="shortcut icon" type=image/png sizes=32x32 href=https://lib.onl/favicon-32.png><link rel=apple-touch-icon sizes=32x32 href=https://lib.onl/favicon-32.png><link rel=icon type=image/png sizes=48x48 href=https://lib.onl/favicon-48.png><link rel="shortcut icon" type=image/png sizes=48x48 href=https://lib.onl/favicon-48.png><link rel=apple-touch-icon sizes=48x48 href=https://lib.onl/favicon-48.png><link rel=icon type=image/png sizes=64x64 href=https://lib.onl/favicon-64.png><link rel="shortcut icon" type=image/png sizes=64x64 href=https://lib.onl/favicon-64.png><link rel=apple-touch-icon sizes=64x64 href=https://lib.onl/favicon-64.png><link rel=icon type=image/png sizes=72x72 href=https://lib.onl/favicon-72.png><link rel="shortcut icon" type=image/png sizes=72x72 href=https://lib.onl/favicon-72.png><link rel=apple-touch-icon sizes=72x72 href=https://lib.onl/favicon-72.png><link rel=icon type=image/png sizes=80x80 href=https://lib.onl/favicon-80.png><link rel="shortcut icon" type=image/png sizes=80x80 href=https://lib.onl/favicon-80.png><link rel=apple-touch-icon sizes=80x80 href=https://lib.onl/favicon-80.png><link rel=icon type=image/png sizes=96x96 href=https://lib.onl/favicon-96.png><link rel="shortcut icon" type=image/png sizes=96x96 href=https://lib.onl/favicon-96.png><link rel=apple-touch-icon sizes=96x96 href=https://lib.onl/favicon-96.png><link rel=icon type=image/png sizes=128x128 href=https://lib.onl/favicon-128.png><link rel="shortcut icon" type=image/png sizes=128x128 href=https://lib.onl/favicon-128.png><link rel=apple-touch-icon sizes=128x128 href=https://lib.onl/favicon-128.png><link rel=icon type=image/png sizes=144x144 href=https://lib.onl/favicon-144.png><link rel="shortcut icon" type=image/png sizes=144x144 href=https://lib.onl/favicon-144.png><link rel=apple-touch-icon sizes=144x144 href=https://lib.onl/favicon-144.png><link rel=icon type=image/png sizes=152x152 href=https://lib.onl/favicon-152.png><link rel="shortcut icon" type=image/png sizes=152x152 href=https://lib.onl/favicon-152.png><link rel=apple-touch-icon sizes=152x152 href=https://lib.onl/favicon-152.png><link rel=icon type=image/png sizes=167x167 href=https://lib.onl/favicon-167.png><link rel="shortcut icon" type=image/png sizes=167x167 href=https://lib.onl/favicon-167.png><link rel=apple-touch-icon sizes=167x167 href=https://lib.onl/favicon-167.png><link rel=icon type=image/png sizes=180x180 href=https://lib.onl/favicon-180.png><link rel="shortcut icon" type=image/png sizes=180x180 href=https://lib.onl/favicon-180.png><link rel=apple-touch-icon sizes=180x180 href=https://lib.onl/favicon-180.png><link rel=icon type=image/png sizes=192x192 href=https://lib.onl/favicon-192.png><link rel="shortcut icon" type=image/png sizes=192x192 href=https://lib.onl/favicon-192.png><link rel=apple-touch-icon sizes=192x192 href=https://lib.onl/favicon-192.png><link rel=icon type=image/png sizes=196x196 href=https://lib.onl/favicon-196.png><link rel="shortcut icon" type=image/png sizes=196x196 href=https://lib.onl/favicon-196.png><link rel=apple-touch-icon sizes=196x196 href=https://lib.onl/favicon-196.png><link rel=icon type=image/png sizes=256x256 href=https://lib.onl/favicon-256.png><link rel="shortcut icon" type=image/png sizes=256x256 href=https://lib.onl/favicon-256.png><link rel=apple-touch-icon sizes=256x256 href=https://lib.onl/favicon-256.png><link rel=icon type=image/png sizes=300x300 href=https://lib.onl/favicon-300.png><link rel="shortcut icon" type=image/png sizes=300x300 href=https://lib.onl/favicon-300.png><link rel=apple-touch-icon sizes=300x300 href=https://lib.onl/favicon-300.png><link rel=icon type=image/png sizes=512x512 href=https://lib.onl/favicon-512.png><link rel="shortcut icon" type=image/png sizes=512x512 href=https://lib.onl/favicon-512.png><link rel=apple-touch-icon sizes=512x512 href=https://lib.onl/favicon-512.png><link rel=icon type=image/svg+xml sizes=any href=https://lib.onl/favicon.svg><link rel="shortcut icon" type=image/x-icon href=https://lib.onl/favicon.ico><link rel="shortcut icon" type=image/vnd.microsoft.icon href=https://lib.onl/favicon.ico><link rel=canonical href=https://lib.onl/ru/2024/09/40539e36-4656-5532-b920-8975c97d4dc5/><link rel=alternate href=https://lib.onl/ hreflang=x-default><link rel=alternate href=https://lib.onl/ru/2024/09/40539e36-4656-5532-b920-8975c97d4dc5/ hreflang=ru><link rel=manifest type=application/manifest+json href=https://lib.onl/ru/manifest.json title="Library Online"><link rel=search type=application/opensearchdescription+xml href=https://lib.onl/ru/opensearch.xml title="Library Online"><link rel=alternate type=application/json href=https://lib.onl/ru/2024/09/40539e36-4656-5532-b920-8975c97d4dc5/index.json title="Library Online"><meta name=application-name content="Library Online"><meta name=theme-color content="#f8f9fa" media="(prefers-color-scheme: light)"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://images.unsplash.com/photo-1704265586128-7fc54dcc774f"><meta name=twitter:title content="Уведомления от Windows Server Backup"><meta name=twitter:description content="Windows Server Backup хороша в качестве компонента резервного копирования, встроенного в ОС. Но работу этого компонента неплохо было бы отслеживать."><meta property="og:url" content="https://lib.onl/ru/2024/09/40539e36-4656-5532-b920-8975c97d4dc5/"><meta property="og:site_name" content="Library Online"><meta property="og:title" content="Уведомления от Windows Server Backup"><meta property="og:description" content="Windows Server Backup хороша в качестве компонента резервного копирования, встроенного в ОС. Но работу этого компонента неплохо было бы отслеживать."><meta property="og:locale" content="ru_RU"><meta property="og:type" content="article"><meta property="article:section" content="articles"><meta property="article:published_time" content="2024-09-17T23:47:31+03:00"><meta property="article:modified_time" content="2024-09-17T23:47:31+03:00"><meta property="article:tag" content="Backup"><meta property="article:tag" content="Mail"><meta property="article:tag" content="Notice"><meta property="og:image" content="https://images.unsplash.com/photo-1704265586128-7fc54dcc774f"><meta property="twitter:domain" content="lib.onl"><meta property="twitter:url" content="https://lib.onl/ru/2024/09/40539e36-4656-5532-b920-8975c97d4dc5/"><meta property="og:locale" content="ru_RU"><meta property="og:site_name" content="Library Online"><meta name=aiturec:title content="Уведомления от Windows Server Backup"><meta property="aiturec:description" content="Windows Server Backup хороша в качестве компонента резервного копирования, встроенного в ОС. Но работу этого компонента неплохо было бы отслеживать."><meta property="aiturec:item_id" content="40539e36-4656-5532-b920-8975c97d4dc5"><meta property="aiturec:datetime" content="2024-09-17T20:47:31Z"><meta property="aiturec:image" content="https://images.unsplash.com/photo-1704265586128-7fc54dcc774f"><meta property="vk:image" content="https://images.unsplash.com/photo-1704265586128-7fc54dcc774f"><meta property="article:author" content="Kai Kimera"><meta property="article:tag" content="backup"><meta property="article:tag" content="mail"><meta property="article:tag" content="notice"><meta name=DC.Title content="Уведомления от Windows Server Backup"><meta name=DC.Subject content="Windows Server Backup хороша в качестве компонента резервного копирования, встроенного в ОС. Но работу этого компонента неплохо было бы отслеживать."><meta name=DC.Description content="Windows Server Backup хороша в качестве компонента резервного копирования, встроенного в ОС. Но работу этого компонента неплохо было бы отслеживать."><meta name=DC.Type content="Text"><meta name=DC.Source content="https://lib.onl/ru/2024/09/40539e36-4656-5532-b920-8975c97d4dc5/"><meta name=DC.Relation content="https://lib.onl/ru/2024/09/40539e36-4656-5532-b920-8975c97d4dc5/"><meta name=DC.Coverage content="World"><meta name=DC.Creator content="Library Online"><meta name=DC.Publisher content="Library Online"><meta name=DC.Contributor content="Library Online"><meta name=DC.Rights content="Library Online"><meta name=DC.Format content="Digital"><meta name=DC.Identifier content="https://lib.onl/ru/2024/09/40539e36-4656-5532-b920-8975c97d4dc5/"><meta name=DC.Language content="ru-RU"><meta name=DC.Provenance content="Library Online"><meta name=DC.RightsHolder content="Library Online"><meta name=DC.AccrualPeriodicity content="Weekly"><meta name=DC.AccrualPolicy content="Active"></head><body class="d-flex flex-column h-100 is-page type-articles"><header id=site-header><nav class="navbar navbar-expand-lg navbar-light fixed-top border-bottom shadow-sm text-lg-center bg-body-tertiary"><div class=container-fluid><a class=navbar-brand href=/ru/><img src=https://lib.onl/img/logo.min.svg alt=Логотип width=30 height=24 class="d-inline-block align-text-top"><h2 class="d-inline-block h5 m-0 ms-1">Library Online</h2></a><button type=button class=navbar-toggler data-bs-toggle=collapse data-bs-target=#navTopBar aria-controls=navTopBar aria-expanded=false aria-label='Переключить навигацию'>
<span class=navbar-toggler-icon></span></button><div class="collapse navbar-collapse" id=navTopBar><ul class=navbar-nav><li class=nav-item><a class=nav-link href=/ru/articles/><i class="fas fa-file-lines fa-fw"></i>
<span>Статьи</span></a></li><li class=nav-item><a class=nav-link href=/ru/faq/><i class="fas fa-circle-question fa-fw"></i>
<span>Q&amp;A</span></a></li><li class=nav-item><a class=nav-link href=/ru/archive/><i class="fas fa-archive fa-fw"></i>
<span>Архив</span></a></li><li class=nav-item><a class=nav-link href=/ru/about/><i class="fas fa-info-circle fa-fw"></i>
<span>О проекте</span></a></li><li class="nav-item dropdown"><a class="nav-link dropdown-toggle" href=# role=button data-bs-toggle=dropdown aria-expanded=false><i class="fas fa-list fa-fw"></i>
<span>META</span></a><ul class="dropdown-menu shadow"><li><a class=dropdown-item href=/ru/authors/><i class="fas fa-user-circle fa-fw"></i>
<span>Авторы</span></a></li><li><a class=dropdown-item href=/ru/categories/><i class="fas fa-folder-open fa-fw"></i>
<span>Категории</span></a></li><li><a class=dropdown-item href=/ru/tags/><i class="fas fa-tags fa-fw"></i>
<span>Теги</span></a></li></ul></li></ul><ul class="navbar-nav ms-auto"><li class=nav-item><a class="nav-link d-lg-none" href=# data-bs-toggle=modal data-bs-target=#search-modal aria-label=Поиск><i class="fas fa-search fa-fw"></i>
<span>Поиск</span>
</a><a title=Поиск class="nav-link d-none d-lg-block" href=# data-bs-toggle=modal data-bs-target=#search-modal aria-label=Поиск><i class="fas fa-search fa-fw"></i></a></li></ul></div></div></nav></header><main class="wrapper flex-shrink-0" id=site-main><div class="section py-3"><div class=container><nav style="--bs-breadcrumb-divider:'\2f '" class=small aria-label=breadcrumb><ol class="breadcrumb p-2 rounded bg-body-tertiary"><li class=breadcrumb-item><a href=/ru/ aria-label=Главная><i class="fas fa-home fa-fw"></i></a></li><li class=breadcrumb-item><a href=/ru/articles/ aria-label=Статьи>Статьи</a></li><li class="breadcrumb-item active">Уведомления от Windows Server Backup</li></ol></nav><article><header><div class="node-cover mb-3"><a title="Уведомления от Windows Server Backup" class="d-flex align-items-center rounded overflow-hidden bg-body-tertiary" href=/ru/2024/09/40539e36-4656-5532-b920-8975c97d4dc5/><picture><source srcset='https://images.unsplash.com/photo-1704265586128-7fc54dcc774f?crop=edges&amp;w=640&amp;h=360&amp;fit=crop&amp;auto=compress,format 640w,https://images.unsplash.com/photo-1704265586128-7fc54dcc774f?crop=edges&amp;w=768&amp;h=432&amp;fit=crop&amp;auto=compress,format 768w,https://images.unsplash.com/photo-1704265586128-7fc54dcc774f?crop=edges&amp;w=1024&amp;h=576&amp;fit=crop&amp;auto=compress,format 1024w,https://images.unsplash.com/photo-1704265586128-7fc54dcc774f?crop=edges&amp;w=1280&amp;h=720&amp;fit=crop&amp;auto=compress,format 1280w,https://images.unsplash.com/photo-1704265586128-7fc54dcc774f?crop=edges&amp;w=1600&amp;h=900&amp;fit=crop&amp;auto=compress,format 1600w' sizes="(min-width: 576px) 100vw"><img class=img-fluid src="https://images.unsplash.com/photo-1704265586128-7fc54dcc774f?crop=edges&amp;w=1600&amp;h=900&amp;fit=crop&amp;auto=compress,format" width=1600 height=900 alt="Уведомления от Windows Server Backup" loading=lazy></picture></a></div><div class=node-title><h1 class=text-center>Уведомления от Windows Server Backup</h1></div></header><footer><ul class="list-inline text-center text-body-secondary small"><li class=list-inline-item><time datetime=2024-09-17T20:47:31Z data-fn=date-local>2024/09/17 20:47:31 UTC</time></li><li class=list-inline-item>&bull;</li><li class="list-inline-item text-success" title='Уровень сложности: Простой'><i class="far fa-face-smile fa-fw"></i></li></ul></footer><ul class="nav nav-tabs mb-3" id=node-tabs-6cdd97d9ad0e1b00dc92dfec67ca2a7b data-fn=node-tabs role=tablist><li class=nav-item role=presentation title=Главная><button class="nav-link active" id=tab-main-home type=button role=tab data-bs-toggle=tab data-bs-target=#tab-pane-main-home aria-controls=tab-pane-main-home aria-selected=true aria-label=Главная>
<i class="fas fa-home fa-fw"></i></button></li><li class=nav-item role=presentation title=Информация><button class=nav-link id=tab-main-info type=button role=tab data-bs-toggle=tab data-bs-target=#tab-pane-main-info aria-controls=tab-pane-main-info aria-selected=false aria-label=Информация>
<i class="fas fa-info fa-fw"></i></button></li><li class=nav-item role=presentation title=Комментарии><button class=nav-link id=tab-main-comments type=button role=tab data-bs-toggle=tab data-bs-target=#tab-pane-main-comments aria-controls=tab-pane-main-comments aria-selected=false aria-label=Комментарии>
<i class="far fa-comments fa-fw"></i></button></li><li class="nav-item ms-auto" role=presentation title=Поделиться><button class=nav-link id=tab-main-share type=button role=tab data-bs-toggle=tab data-bs-target=#tab-pane-main-share aria-controls=tab-pane-main-share aria-selected=false aria-label=Поделиться>
<i class="fas fa-share fa-fw"></i></button></li></ul><div class=tab-content><div class="tab-pane show active" id=tab-pane-main-home role=tabpanel aria-labelledby=tab-main-home tabindex=0><div class=node-body><div class="node-toc mb-3"><div class=accordion id=accordion-toc-5f8c3b6189b5a8df425b93534a0b9917><div class=accordion-item><h2 class=accordion-header><a class="accordion-button collapsed" href=# role=button tabindex=0 data-bs-toggle=collapse data-bs-target=#collapse-toc-5f8c3b6189b5a8df425b93534a0b9917 aria-expanded=false aria-controls=collapse-toc-5f8c3b6189b5a8df425b93534a0b9917 aria-label=Содержание>Содержание</a></h2><div id=collapse-toc-5f8c3b6189b5a8df425b93534a0b9917 class="accordion-collapse collapse"><div class=accordion-body><nav id=TableOfContents><ul><li><a href=#скрипт>Скрипт</a><ul><li><a href=#установка>Установка</a></li><li><a href=#настройка>Настройка</a></li><li><a href=#приложение>Приложение</a></li><li><a href=#задачи>Задачи</a><ul><li><a href=#ошибка>Ошибка</a></li><li><a href=#успешно>Успешно</a></li></ul></li></ul></li></ul></nav></div></div></div></div></div><p>Windows Server Backup хороша в качестве компонента резервного копирования, встроенного в ОС. Но работу этого компонента неплохо было бы отслеживать.</p><p>Я написал небольшой скрипт, позволяющий по крону отслеживать системный журнал и находить записи по работе <strong>Windows Server Backup</strong>.</p><h2 id=скрипт><a class=link-body-emphasis href=#%d1%81%d0%ba%d1%80%d0%b8%d0%bf%d1%82>Скрипт</a></h2><p>Скрипт анализирует системный журнал и фиксирует записи, принадлежащие <span class="shortcode shortcode-tag"><a href=/ru/tags/windows/ target=_blank>#Windows</a></span> Server Backup. Скрипт состоит из файла настроек, к которому можно ограничить доступ, приложения и двух задач.</p><h3 id=установка><a class=link-body-emphasis href=#%d1%83%d1%81%d1%82%d0%b0%d0%bd%d0%be%d0%b2%d0%ba%d0%b0>Установка</a></h3><ul><li>Скопировать файлы <code>app.backup.wsb.mail.ps1</code> и <code>app.backup.wsb.mail.ini</code> в директорию <code>C:\Scripts\</code>.</li><li>Импортировать задания <code>task.backup.wsb.mail.error.xml</code> и <code>task.backup.wsb.mail.success.xml</code> в <strong>Windows Task Scheduler</strong> и откорректировать параметры вызова скрипта.</li><li>Изменить параметры скрипта в файле <code>app.backup.wsb.mail.ini</code>.</li></ul><h3 id=настройка><a class=link-body-emphasis href=#%d0%bd%d0%b0%d1%81%d1%82%d1%80%d0%be%d0%b9%d0%ba%d0%b0>Настройка</a></h3><p>Файл настройки представляет собой простой файл <code>.ini</code>, содержащий в себе приватные параметры.</p><div class="shortcode shortcode-file mb-3"><div class="card overflow-hidden" data-bs-theme=dark><div class=card-header><div class="d-flex align-items-center"><div class=flex-shrink-0><i class="far fa-file-code fa-fw"></i></div><div class="flex-grow-1 mx-2 text-truncate"><code>app.backup.wsb.mail.ini</code></div><div class=flex-shrink-0><ul class="list-inline mb-0"><li class=list-inline-item title=Копировать><a class=text-body href=# data-fn=clipboard data-clipboard-target=#cp-948853311639c0b36dd169a2cb07c519 role=button aria-label=Копировать><i class="fas fa-copy fa-fw"></i></a></li><li class=list-inline-item title=Скачать><a class=text-body href=/ru/2024/09/40539e36-4656-5532-b920-8975c97d4dc5/app.backup.wsb.mail.ini download role=button aria-label=Скачать><i class="fas fa-download fa-fw"></i></a></li><li class=list-inline-item title=Открыть><a class=text-body href=/ru/2024/09/40539e36-4656-5532-b920-8975c97d4dc5/app.backup.wsb.mail.ini target=_blank role=button aria-label=Открыть><i class="fas fa-arrow-up-right-from-square fa-fw"></i></a></li></ul></div></div></div><div class="card-body p-0 overflow-auto" id=cp-948853311639c0b36dd169a2cb07c519><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-ini data-lang=ini><span class=line><span class=cl><span class=na>From</span><span class=o>=</span><span class=s>mail@domain.com</span>
</span></span><span class=line><span class=cl><span class=na>To</span><span class=o>=</span><span class=s>mail@domain.org</span>
</span></span><span class=line><span class=cl><span class=na>Server</span><span class=o>=</span><span class=s>192.168.11.22</span>
</span></span><span class=line><span class=cl><span class=na>Port</span><span class=o>=</span><span class=s>25</span>
</span></span><span class=line><span class=cl><span class=na>User</span><span class=o>=</span><span class=s>smtp_user</span>
</span></span><span class=line><span class=cl><span class=na>Password</span><span class=o>=</span><span class=s>smtp_password</span></span></span></code></pre></td></tr></table></div></div></div></div></div><p><strong>Параметры:</strong></p><ul><li><code>From</code> - адрес email, с которого будет отправлено сообщение.</li><li><code>To</code> - адрес email, на который будет отправлено сообщение.</li><li><code>Server</code> - IP-адрес SMTP-сервера.</li><li><code>Port</code> - порт SMTP-сервера.</li><li><code>User</code> - имя пользователя в SMTP-сервере.</li><li><code>Password</code> - пароль пользователя в SMTP-сервере.</li></ul><h3 id=приложение><a class=link-body-emphasis href=#%d0%bf%d1%80%d0%b8%d0%bb%d0%be%d0%b6%d0%b5%d0%bd%d0%b8%d0%b5>Приложение</a></h3><div class="shortcode shortcode-file mb-3"><div class="card overflow-hidden" data-bs-theme=dark><div class=card-header><div class="d-flex align-items-center"><div class=flex-shrink-0><i class="far fa-file-code fa-fw"></i></div><div class="flex-grow-1 mx-2 text-truncate"><code>app.backup.wsb.mail.ps1</code></div><div class=flex-shrink-0><ul class="list-inline mb-0"><li class=list-inline-item title=Копировать><a class=text-body href=# data-fn=clipboard data-clipboard-target=#cp-bec572a705333f17cc4a80bf4729c016 role=button aria-label=Копировать><i class="fas fa-copy fa-fw"></i></a></li><li class=list-inline-item title=Скачать><a class=text-body href=/ru/2024/09/40539e36-4656-5532-b920-8975c97d4dc5/app.backup.wsb.mail.ps1 download role=button aria-label=Скачать><i class="fas fa-download fa-fw"></i></a></li><li class=list-inline-item title=Открыть><a class=text-body href=/ru/2024/09/40539e36-4656-5532-b920-8975c97d4dc5/app.backup.wsb.mail.ps1 target=_blank role=button aria-label=Открыть><i class="fas fa-arrow-up-right-from-square fa-fw"></i></a></li></ul></div></div></div><div class="card-body p-0 overflow-auto" id=cp-bec572a705333f17cc4a80bf4729c016><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>  1
</span><span class=lnt>  2
</span><span class=lnt>  3
</span><span class=lnt>  4
</span><span class=lnt>  5
</span><span class=lnt>  6
</span><span class=lnt>  7
</span><span class=lnt>  8
</span><span class=lnt>  9
</span><span class=lnt> 10
</span><span class=lnt> 11
</span><span class=lnt> 12
</span><span class=lnt> 13
</span><span class=lnt> 14
</span><span class=lnt> 15
</span><span class=lnt> 16
</span><span class=lnt> 17
</span><span class=lnt> 18
</span><span class=lnt> 19
</span><span class=lnt> 20
</span><span class=lnt> 21
</span><span class=lnt> 22
</span><span class=lnt> 23
</span><span class=lnt> 24
</span><span class=lnt> 25
</span><span class=lnt> 26
</span><span class=lnt> 27
</span><span class=lnt> 28
</span><span class=lnt> 29
</span><span class=lnt> 30
</span><span class=lnt> 31
</span><span class=lnt> 32
</span><span class=lnt> 33
</span><span class=lnt> 34
</span><span class=lnt> 35
</span><span class=lnt> 36
</span><span class=lnt> 37
</span><span class=lnt> 38
</span><span class=lnt> 39
</span><span class=lnt> 40
</span><span class=lnt> 41
</span><span class=lnt> 42
</span><span class=lnt> 43
</span><span class=lnt> 44
</span><span class=lnt> 45
</span><span class=lnt> 46
</span><span class=lnt> 47
</span><span class=lnt> 48
</span><span class=lnt> 49
</span><span class=lnt> 50
</span><span class=lnt> 51
</span><span class=lnt> 52
</span><span class=lnt> 53
</span><span class=lnt> 54
</span><span class=lnt> 55
</span><span class=lnt> 56
</span><span class=lnt> 57
</span><span class=lnt> 58
</span><span class=lnt> 59
</span><span class=lnt> 60
</span><span class=lnt> 61
</span><span class=lnt> 62
</span><span class=lnt> 63
</span><span class=lnt> 64
</span><span class=lnt> 65
</span><span class=lnt> 66
</span><span class=lnt> 67
</span><span class=lnt> 68
</span><span class=lnt> 69
</span><span class=lnt> 70
</span><span class=lnt> 71
</span><span class=lnt> 72
</span><span class=lnt> 73
</span><span class=lnt> 74
</span><span class=lnt> 75
</span><span class=lnt> 76
</span><span class=lnt> 77
</span><span class=lnt> 78
</span><span class=lnt> 79
</span><span class=lnt> 80
</span><span class=lnt> 81
</span><span class=lnt> 82
</span><span class=lnt> 83
</span><span class=lnt> 84
</span><span class=lnt> 85
</span><span class=lnt> 86
</span><span class=lnt> 87
</span><span class=lnt> 88
</span><span class=lnt> 89
</span><span class=lnt> 90
</span><span class=lnt> 91
</span><span class=lnt> 92
</span><span class=lnt> 93
</span><span class=lnt> 94
</span><span class=lnt> 95
</span><span class=lnt> 96
</span><span class=lnt> 97
</span><span class=lnt> 98
</span><span class=lnt> 99
</span><span class=lnt>100
</span><span class=lnt>101
</span><span class=lnt>102
</span><span class=lnt>103
</span><span class=lnt>104
</span><span class=lnt>105
</span><span class=lnt>106
</span><span class=lnt>107
</span><span class=lnt>108
</span><span class=lnt>109
</span><span class=lnt>110
</span><span class=lnt>111
</span><span class=lnt>112
</span><span class=lnt>113
</span><span class=lnt>114
</span><span class=lnt>115
</span><span class=lnt>116
</span><span class=lnt>117
</span><span class=lnt>118
</span><span class=lnt>119
</span><span class=lnt>120
</span><span class=lnt>121
</span><span class=lnt>122
</span><span class=lnt>123
</span><span class=lnt>124
</span><span class=lnt>125
</span><span class=lnt>126
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-ps1 data-lang=ps1><span class=line><span class=cl><span class=cm>&lt;#PSScriptInfo
</span></span></span><span class=line><span class=cl><span class=cm>.VERSION      0.1.0
</span></span></span><span class=line><span class=cl><span class=cm>.GUID         18c25998-a474-425e-a59f-e32f79c8431d
</span></span></span><span class=line><span class=cl><span class=cm>.AUTHOR       Kai Kimera
</span></span></span><span class=line><span class=cl><span class=cm>.AUTHOREMAIL  mail@kai.kim
</span></span></span><span class=line><span class=cl><span class=cm>.COMPANYNAME  Library Online
</span></span></span><span class=line><span class=cl><span class=cm>.COPYRIGHT    2024 Library Online. All rights reserved.
</span></span></span><span class=line><span class=cl><span class=cm>.TAGS         windows server backup mail
</span></span></span><span class=line><span class=cl><span class=cm>.LICENSEURI   https://choosealicense.com/licenses/mit/
</span></span></span><span class=line><span class=cl><span class=cm>.PROJECTURI   https://lib.onl/ru/2024/09/40539e36-4656-5532-b920-8975c97d4dc5/
</span></span></span><span class=line><span class=cl><span class=cm>#&gt;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=cm>&lt;#
</span></span></span><span class=line><span class=cl><span class=cm>.</span><span class=sd>SYNOPSIS</span><span class=cm>
</span></span></span><span class=line><span class=cl><span class=cm>Script for sending messages about backup status.
</span></span></span><span class=line><span class=cl><span class=cm>
</span></span></span><span class=line><span class=cl><span class=cm>.</span><span class=sd>DESCRIPTION</span><span class=cm>
</span></span></span><span class=line><span class=cl><span class=cm>The script sends messages to the specified address for further analysis.
</span></span></span><span class=line><span class=cl><span class=cm>The messages contain the host ID and notification type.
</span></span></span><span class=line><span class=cl><span class=cm>
</span></span></span><span class=line><span class=cl><span class=cm>.</span><span class=sd>EXAMPLE</span><span class=cm>
</span></span></span><span class=line><span class=cl><span class=cm>.\app.backup.wsb.mail.ps1 -Type &#39;error&#39; [-SSL]
</span></span></span><span class=line><span class=cl><span class=cm>.\app.backup.wsb.mail.ps1 -Type &#39;success&#39; [-SSL]
</span></span></span><span class=line><span class=cl><span class=cm>
</span></span></span><span class=line><span class=cl><span class=cm>.</span><span class=sd>LINK</span><span class=cm>
</span></span></span><span class=line><span class=cl><span class=cm>https://lib.onl/ru/2024/09/40539e36-4656-5532-b920-8975c97d4dc5/
</span></span></span><span class=line><span class=cl><span class=cm>#&gt;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c># -------------------------------------------------------------------------------------------------------------------- #</span>
</span></span><span class=line><span class=cl><span class=c># CONFIGURATION</span>
</span></span><span class=line><span class=cl><span class=c># -------------------------------------------------------------------------------------------------------------------- #</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>Param</span><span class=p>(</span>
</span></span><span class=line><span class=cl>  <span class=p>[</span><span class=nb>Parameter</span><span class=p>(</span><span class=na>HelpMessage</span><span class=p>=</span><span class=s1>&#39;Message type.&#39;</span><span class=p>)]</span>
</span></span><span class=line><span class=cl>  <span class=p>[</span><span class=nb>ValidateSet</span><span class=p>(</span><span class=s1>&#39;error&#39;</span><span class=p>,</span> <span class=s1>&#39;success&#39;</span><span class=p>)]</span>
</span></span><span class=line><span class=cl>  <span class=p>[</span><span class=no>string</span><span class=p>]</span><span class=nv>$Type</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=p>[</span><span class=nb>Parameter</span><span class=p>(</span><span class=na>HelpMessage</span><span class=p>=</span><span class=s1>&#39;Enable or disable encrypted connection.&#39;</span><span class=p>)]</span>
</span></span><span class=line><span class=cl>  <span class=p>[</span><span class=no>switch</span><span class=p>]</span><span class=nv>$SSL</span> <span class=p>=</span> <span class=vm>$false</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=p>[</span><span class=nb>Alias</span><span class=p>(</span><span class=s1>&#39;Host&#39;</span><span class=p>)][</span><span class=no>string</span><span class=p>]</span><span class=nv>$Hostname</span> <span class=p>=</span> <span class=p>([</span><span class=no>System.Net.Dns</span><span class=p>]::</span><span class=n>GetHostByName</span><span class=p>([</span><span class=no>string</span><span class=p>]</span><span class=s1>&#39;localhost&#39;</span><span class=p>).</span><span class=n>HostName</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c># Loading configuration data.</span>
</span></span><span class=line><span class=cl><span class=nv>$S</span> <span class=p>=</span> <span class=p>((</span><span class=nb>Get-Item</span> <span class=s2>&#34;</span><span class=nv>${PSCommandPath}</span><span class=s2>&#34;</span><span class=p>).</span><span class=py>Basename</span> <span class=p>+</span> <span class=s1>&#39;.ini&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nv>$P</span> <span class=p>=</span> <span class=p>(</span><span class=nb>Get-Content</span> <span class=n>-Path</span> <span class=s2>&#34;</span><span class=nv>${PSScriptRoot}</span><span class=s2>\</span><span class=nv>${S}</span><span class=s2>&#34;</span> <span class=p>|</span> <span class=nb>ConvertFrom-StringData</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c># Generating HostID (HID).</span>
</span></span><span class=line><span class=cl><span class=nv>$UUID</span> <span class=p>=</span> <span class=p>(</span><span class=nb>Get-CimInstance</span> <span class=s1>&#39;Win32_ComputerSystemProduct&#39;</span> <span class=p>|</span> <span class=nb>Select-Object</span> <span class=n>-ExpandProperty</span> <span class=s1>&#39;UUID&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nv>$HID</span> <span class=p>=</span> <span class=p>((${</span><span class=n>Hostname</span><span class=p>}</span> <span class=p>+</span> <span class=s1>&#39;:&#39;</span> <span class=p>+</span> <span class=p>${</span><span class=n>UUID</span><span class=p>}).</span><span class=py>ToUpper</span><span class=p>())</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c># -------------------------------------------------------------------------------------------------------------------- #</span>
</span></span><span class=line><span class=cl><span class=c># INITIALIZATION</span>
</span></span><span class=line><span class=cl><span class=c># -------------------------------------------------------------------------------------------------------------------- #</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>function</span><span class=w> </span><span class=nb>Start-Script</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=k>switch</span> <span class=p>(</span><span class=s2>&#34;</span><span class=nv>${Type}</span><span class=s2>&#34;</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=s1>&#39;error&#39;</span>   <span class=p>{</span> <span class=nb>Send-BackupError</span> <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=s1>&#39;success&#39;</span> <span class=p>{</span> <span class=nb>Send-BackupSuccess</span> <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=k>default</span>   <span class=p>{</span> <span class=n>exit</span> <span class=p>}</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c># -------------------------------------------------------------------------------------------------------------------- #</span>
</span></span><span class=line><span class=cl><span class=c># BACKUP: ERROR</span>
</span></span><span class=line><span class=cl><span class=c># Sending an email after a failed backup.</span>
</span></span><span class=line><span class=cl><span class=c># -------------------------------------------------------------------------------------------------------------------- #</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>function</span><span class=w> </span><span class=nb>Send-BackupError</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=nv>$Subject</span> <span class=p>=</span> <span class=s2>&#34;Windows Server Backup: </span><span class=nv>${Hostname}</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl>  <span class=nv>$Body</span> <span class=p>=</span> <span class=sh>@&#34;
</span></span></span><span class=line><span class=cl><span class=sh>Windows Server Backup failed: </span><span class=nv>${Hostname}</span><span class=sh>.
</span></span></span><span class=line><span class=cl><span class=sh>Please check server backup!
</span></span></span><span class=line><span class=cl><span class=sh>
</span></span></span><span class=line><span class=cl><span class=sh>Host: </span><span class=nv>${Hostname}</span><span class=sh>
</span></span></span><span class=line><span class=cl><span class=sh>Status: ERROR
</span></span></span><span class=line><span class=cl><span class=sh>
</span></span></span><span class=line><span class=cl><span class=sh>-- 
</span></span></span><span class=line><span class=cl><span class=sh>#ID:</span><span class=nv>${HID}</span><span class=sh>
</span></span></span><span class=line><span class=cl><span class=sh>#TYPE:BACKUP:ERROR
</span></span></span><span class=line><span class=cl><span class=sh>&#34;@</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=nb>Start-Smtp</span> <span class=n>-S</span> <span class=s2>&#34;</span><span class=nv>${Subject}</span><span class=s2>&#34;</span> <span class=n>-B</span> <span class=s2>&#34;</span><span class=nv>${Body}</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c># -------------------------------------------------------------------------------------------------------------------- #</span>
</span></span><span class=line><span class=cl><span class=c># BACKUP: SUCCESS</span>
</span></span><span class=line><span class=cl><span class=c># Sending an email after a successful backup.</span>
</span></span><span class=line><span class=cl><span class=c># -------------------------------------------------------------------------------------------------------------------- #</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>function</span><span class=w> </span><span class=nb>Send-BackupSuccess</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=nv>$Subject</span> <span class=p>=</span> <span class=s2>&#34;Windows Server Backup: </span><span class=nv>${Hostname}</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl>  <span class=nv>$Body</span> <span class=p>=</span> <span class=sh>@&#34;
</span></span></span><span class=line><span class=cl><span class=sh>Windows Server Backup completed successfully!
</span></span></span><span class=line><span class=cl><span class=sh>
</span></span></span><span class=line><span class=cl><span class=sh>Host: </span><span class=nv>${Hostname}</span><span class=sh>
</span></span></span><span class=line><span class=cl><span class=sh>Status: SUCCESS
</span></span></span><span class=line><span class=cl><span class=sh>
</span></span></span><span class=line><span class=cl><span class=sh>-- 
</span></span></span><span class=line><span class=cl><span class=sh>#ID:</span><span class=nv>${HID}</span><span class=sh>
</span></span></span><span class=line><span class=cl><span class=sh>#TYPE:BACKUP:SUCCESS
</span></span></span><span class=line><span class=cl><span class=sh>&#34;@</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=nb>Start-Smtp</span> <span class=n>-S</span> <span class=s2>&#34;</span><span class=nv>${Subject}</span><span class=s2>&#34;</span> <span class=n>-B</span> <span class=s2>&#34;</span><span class=nv>${Body}</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c># -------------------------------------------------------------------------------------------------------------------- #</span>
</span></span><span class=line><span class=cl><span class=c># SMTP</span>
</span></span><span class=line><span class=cl><span class=c># SMTP configuration.</span>
</span></span><span class=line><span class=cl><span class=c># -------------------------------------------------------------------------------------------------------------------- #</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>function</span><span class=w> </span><span class=nb>Start-Smtp</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=k>Param</span><span class=p>(</span>
</span></span><span class=line><span class=cl>    <span class=p>[</span><span class=nb>Alias</span><span class=p>(</span><span class=s1>&#39;S&#39;</span><span class=p>)][</span><span class=no>string</span><span class=p>]</span><span class=nv>$Subject</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=p>[</span><span class=nb>Alias</span><span class=p>(</span><span class=s1>&#39;B&#39;</span><span class=p>)][</span><span class=no>string</span><span class=p>]</span><span class=nv>$Body</span>
</span></span><span class=line><span class=cl>  <span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=nv>$SmtpClient</span> <span class=p>=</span> <span class=nb>New-Object</span> <span class=n>Net</span><span class=p>.</span><span class=py>Mail</span><span class=p>.</span><span class=py>SmtpClient</span><span class=p>(</span><span class=s2>&#34;</span><span class=p>$(</span><span class=nv>$P</span><span class=p>.</span><span class=n>Server</span><span class=p>)</span><span class=s2>&#34;</span><span class=p>,</span> <span class=s2>&#34;</span><span class=p>$(</span><span class=nv>$P</span><span class=p>.</span><span class=n>Port</span><span class=p>)</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=nv>$SmtpClient</span><span class=p>.</span><span class=py>EnableSsl</span> <span class=p>=</span> <span class=nv>$SSL</span>
</span></span><span class=line><span class=cl>  <span class=nv>$SmtpClient</span><span class=p>.</span><span class=py>Credentials</span> <span class=p>=</span> <span class=nb>New-Object</span> <span class=n>System</span><span class=p>.</span><span class=py>Net</span><span class=p>.</span><span class=py>NetworkCredential</span><span class=p>(</span><span class=s2>&#34;</span><span class=p>$(</span><span class=nv>$P</span><span class=p>.</span><span class=n>User</span><span class=p>)</span><span class=s2>&#34;</span><span class=p>,</span> <span class=s2>&#34;</span><span class=p>$(</span><span class=nv>$P</span><span class=p>.</span><span class=n>Password</span><span class=p>)</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=nv>$SmtpClient</span><span class=p>.</span><span class=py>Send</span><span class=p>(</span><span class=s2>&#34;</span><span class=p>$(</span><span class=nv>$P</span><span class=p>.</span><span class=n>From</span><span class=p>)</span><span class=s2>&#34;</span><span class=p>,</span> <span class=s2>&#34;</span><span class=p>$(</span><span class=nv>$P</span><span class=p>.</span><span class=n>To</span><span class=p>)</span><span class=s2>&#34;</span><span class=p>,</span> <span class=s2>&#34;</span><span class=nv>${Subject}</span><span class=s2>&#34;</span><span class=p>,</span> <span class=s2>&#34;</span><span class=nv>${Body}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c># -------------------------------------------------------------------------------------------------------------------- #</span>
</span></span><span class=line><span class=cl><span class=c># -------------------------------------------------&lt; RUNNING SCRIPT &gt;------------------------------------------------- #</span>
</span></span><span class=line><span class=cl><span class=c># -------------------------------------------------------------------------------------------------------------------- #</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nb>Start-Script</span></span></span></code></pre></td></tr></table></div></div></div></div></div><p><strong>Параметры:</strong></p><ul><li><code>Type</code> - тип сообщения.<ul><li><code>success</code> - задание <span class="shortcode shortcode-tag"><a href=/ru/tags/windows/ target=_blank>#Windows</a></span> Server Backup успешно выполнено.</li><li><code>error</code> - задание <span class="shortcode shortcode-tag"><a href=/ru/tags/windows/ target=_blank>#Windows</a></span> Server Backup не выполнено или выполнено с ошибками.</li></ul></li></ul><h3 id=задачи><a class=link-body-emphasis href=#%d0%b7%d0%b0%d0%b4%d0%b0%d1%87%d0%b8>Задачи</a></h3><p>Задачи делятся на два типа: <em><strong>ошибка</strong></em> и <em><strong>успешное выполнение</strong></em>. Каждая из задач будет искать записи <span class="shortcode shortcode-tag"><a href=/ru/tags/windows/ target=_blank>#Windows</a></span> Server Backup в журнале и запускаться в зависимости от идентификатора события (<code>EventID</code>).</p><h4 id=ошибка><a class=link-body-emphasis href=#%d0%be%d1%88%d0%b8%d0%b1%d0%ba%d0%b0>Ошибка</a></h4><p>Задача присылает уведомление в том случае, когда в журнале событий появляется запись об ошибке выполнения <span class="shortcode shortcode-tag"><a href=/ru/tags/windows/ target=_blank>#Windows</a></span> Server Backup.</p><div class="shortcode shortcode-file mb-3"><div class="card overflow-hidden" data-bs-theme=dark><div class=card-header><div class="d-flex align-items-center"><div class=flex-shrink-0><i class="far fa-file-code fa-fw"></i></div><div class="flex-grow-1 mx-2 text-truncate"><code>task.backup.wsb.mail.error.xml</code></div><div class=flex-shrink-0><ul class="list-inline mb-0"><li class=list-inline-item title=Копировать><a class=text-body href=# data-fn=clipboard data-clipboard-target=#cp-a3aeceb295b8aa193e490e1d4bfacba2 role=button aria-label=Копировать><i class="fas fa-copy fa-fw"></i></a></li><li class=list-inline-item title=Скачать><a class=text-body href=/ru/2024/09/40539e36-4656-5532-b920-8975c97d4dc5/task.backup.wsb.mail.error.xml download role=button aria-label=Скачать><i class="fas fa-download fa-fw"></i></a></li><li class=list-inline-item title=Открыть><a class=text-body href=/ru/2024/09/40539e36-4656-5532-b920-8975c97d4dc5/task.backup.wsb.mail.error.xml target=_blank role=button aria-label=Открыть><i class="fas fa-arrow-up-right-from-square fa-fw"></i></a></li></ul></div></div></div><div class="card-body p-0 overflow-auto" id=cp-a3aeceb295b8aa193e490e1d4bfacba2><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-xml data-lang=xml><span class=line><span class=cl><span class=cp>&lt;?xml version=&#34;1.0&#34; encoding=&#34;UTF-16&#34;?&gt;</span>
</span></span><span class=line><span class=cl><span class=nt>&lt;Task</span> <span class=na>version=</span><span class=s>&#34;1.2&#34;</span> <span class=na>xmlns=</span><span class=s>&#34;http://schemas.microsoft.com/windows/2004/02/mit/task&#34;</span><span class=nt>&gt;</span>
</span></span><span class=line><span class=cl>  <span class=nt>&lt;RegistrationInfo&gt;</span>
</span></span><span class=line><span class=cl>    <span class=nt>&lt;Description&gt;</span>Notifies backup admin of scheduled backup failure.<span class=nt>&lt;/Description&gt;</span>
</span></span><span class=line><span class=cl>  <span class=nt>&lt;/RegistrationInfo&gt;</span>
</span></span><span class=line><span class=cl>  <span class=nt>&lt;Triggers&gt;</span>
</span></span><span class=line><span class=cl>    <span class=nt>&lt;EventTrigger&gt;</span>
</span></span><span class=line><span class=cl>      <span class=nt>&lt;Enabled&gt;</span>true<span class=nt>&lt;/Enabled&gt;</span>
</span></span><span class=line><span class=cl>      <span class=nt>&lt;Subscription&gt;</span><span class=ni>&amp;lt;</span>QueryList<span class=ni>&amp;gt;&amp;lt;</span>Query Id=&#34;0&#34; Path=&#34;Microsoft-Windows-Backup&#34;<span class=ni>&amp;gt;&amp;lt;</span>Select Path=&#34;Microsoft-Windows-Backup&#34;<span class=ni>&amp;gt;</span>*[System[Provider[@Name=&#39;Microsoft-Windows-Backup&#39;] and (EventID=5 or EventID=8 or EventID=9 or  (EventID <span class=ni>&amp;amp;</span>gt;= 17 and EventID <span class=ni>&amp;amp;</span>lt;= 22)  or EventID=49 or EventID=50 or EventID=52 or EventID=100 or EventID=517 or EventID=518 or EventID=521 or EventID=527 or EventID=528 or EventID=544 or EventID=545 or EventID=546 or EventID=561 or EventID=564 or EventID=612)]]<span class=ni>&amp;lt;</span>/Select<span class=ni>&amp;gt;&amp;lt;</span>/Query<span class=ni>&amp;gt;&amp;lt;</span>/QueryList<span class=ni>&amp;gt;</span><span class=nt>&lt;/Subscription&gt;</span>
</span></span><span class=line><span class=cl>    <span class=nt>&lt;/EventTrigger&gt;</span>
</span></span><span class=line><span class=cl>  <span class=nt>&lt;/Triggers&gt;</span>
</span></span><span class=line><span class=cl>  <span class=nt>&lt;Settings&gt;</span>
</span></span><span class=line><span class=cl>    <span class=nt>&lt;MultipleInstancesPolicy&gt;</span>IgnoreNew<span class=nt>&lt;/MultipleInstancesPolicy&gt;</span>
</span></span><span class=line><span class=cl>    <span class=nt>&lt;DisallowStartIfOnBatteries&gt;</span>true<span class=nt>&lt;/DisallowStartIfOnBatteries&gt;</span>
</span></span><span class=line><span class=cl>    <span class=nt>&lt;StopIfGoingOnBatteries&gt;</span>true<span class=nt>&lt;/StopIfGoingOnBatteries&gt;</span>
</span></span><span class=line><span class=cl>    <span class=nt>&lt;AllowHardTerminate&gt;</span>true<span class=nt>&lt;/AllowHardTerminate&gt;</span>
</span></span><span class=line><span class=cl>    <span class=nt>&lt;StartWhenAvailable&gt;</span>false<span class=nt>&lt;/StartWhenAvailable&gt;</span>
</span></span><span class=line><span class=cl>    <span class=nt>&lt;RunOnlyIfNetworkAvailable&gt;</span>false<span class=nt>&lt;/RunOnlyIfNetworkAvailable&gt;</span>
</span></span><span class=line><span class=cl>    <span class=nt>&lt;IdleSettings&gt;</span>
</span></span><span class=line><span class=cl>      <span class=nt>&lt;StopOnIdleEnd&gt;</span>true<span class=nt>&lt;/StopOnIdleEnd&gt;</span>
</span></span><span class=line><span class=cl>      <span class=nt>&lt;RestartOnIdle&gt;</span>false<span class=nt>&lt;/RestartOnIdle&gt;</span>
</span></span><span class=line><span class=cl>    <span class=nt>&lt;/IdleSettings&gt;</span>
</span></span><span class=line><span class=cl>    <span class=nt>&lt;AllowStartOnDemand&gt;</span>true<span class=nt>&lt;/AllowStartOnDemand&gt;</span>
</span></span><span class=line><span class=cl>    <span class=nt>&lt;Enabled&gt;</span>true<span class=nt>&lt;/Enabled&gt;</span>
</span></span><span class=line><span class=cl>    <span class=nt>&lt;Hidden&gt;</span>false<span class=nt>&lt;/Hidden&gt;</span>
</span></span><span class=line><span class=cl>    <span class=nt>&lt;RunOnlyIfIdle&gt;</span>false<span class=nt>&lt;/RunOnlyIfIdle&gt;</span>
</span></span><span class=line><span class=cl>    <span class=nt>&lt;WakeToRun&gt;</span>false<span class=nt>&lt;/WakeToRun&gt;</span>
</span></span><span class=line><span class=cl>  <span class=nt>&lt;/Settings&gt;</span>
</span></span><span class=line><span class=cl>  <span class=nt>&lt;Actions</span> <span class=na>Context=</span><span class=s>&#34;Author&#34;</span><span class=nt>&gt;</span>
</span></span><span class=line><span class=cl>    <span class=nt>&lt;Exec&gt;</span>
</span></span><span class=line><span class=cl>      <span class=nt>&lt;Command&gt;</span>powershell<span class=nt>&lt;/Command&gt;</span>
</span></span><span class=line><span class=cl>      <span class=nt>&lt;Arguments&gt;</span>&#34;C:\Scripts\app.backup.wsb.mail.ps1&#34; -Type &#39;error&#39;<span class=nt>&lt;/Arguments&gt;</span>
</span></span><span class=line><span class=cl>    <span class=nt>&lt;/Exec&gt;</span>
</span></span><span class=line><span class=cl>  <span class=nt>&lt;/Actions&gt;</span>
</span></span><span class=line><span class=cl><span class=nt>&lt;/Task&gt;</span></span></span></code></pre></td></tr></table></div></div></div></div></div><h4 id=успешно><a class=link-body-emphasis href=#%d1%83%d1%81%d0%bf%d0%b5%d1%88%d0%bd%d0%be>Успешно</a></h4><p>Задача присылает уведомление в том случае, когда в журнале событий появляется запись об успешном выполнении <span class="shortcode shortcode-tag"><a href=/ru/tags/windows/ target=_blank>#Windows</a></span> Server Backup.</p><div class="shortcode shortcode-file mb-3"><div class="card overflow-hidden" data-bs-theme=dark><div class=card-header><div class="d-flex align-items-center"><div class=flex-shrink-0><i class="far fa-file-code fa-fw"></i></div><div class="flex-grow-1 mx-2 text-truncate"><code>task.backup.wsb.mail.success.xml</code></div><div class=flex-shrink-0><ul class="list-inline mb-0"><li class=list-inline-item title=Копировать><a class=text-body href=# data-fn=clipboard data-clipboard-target=#cp-69f4164899d6e03be2387c35fb90408f role=button aria-label=Копировать><i class="fas fa-copy fa-fw"></i></a></li><li class=list-inline-item title=Скачать><a class=text-body href=/ru/2024/09/40539e36-4656-5532-b920-8975c97d4dc5/task.backup.wsb.mail.success.xml download role=button aria-label=Скачать><i class="fas fa-download fa-fw"></i></a></li><li class=list-inline-item title=Открыть><a class=text-body href=/ru/2024/09/40539e36-4656-5532-b920-8975c97d4dc5/task.backup.wsb.mail.success.xml target=_blank role=button aria-label=Открыть><i class="fas fa-arrow-up-right-from-square fa-fw"></i></a></li></ul></div></div></div><div class="card-body p-0 overflow-auto" id=cp-69f4164899d6e03be2387c35fb90408f><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-xml data-lang=xml><span class=line><span class=cl><span class=cp>&lt;?xml version=&#34;1.0&#34; encoding=&#34;UTF-16&#34;?&gt;</span>
</span></span><span class=line><span class=cl><span class=nt>&lt;Task</span> <span class=na>version=</span><span class=s>&#34;1.2&#34;</span> <span class=na>xmlns=</span><span class=s>&#34;http://schemas.microsoft.com/windows/2004/02/mit/task&#34;</span><span class=nt>&gt;</span>
</span></span><span class=line><span class=cl>  <span class=nt>&lt;RegistrationInfo&gt;</span>
</span></span><span class=line><span class=cl>    <span class=nt>&lt;Description&gt;</span>Notifies backup admin of scheduled backup successful completion.<span class=nt>&lt;/Description&gt;</span>
</span></span><span class=line><span class=cl>  <span class=nt>&lt;/RegistrationInfo&gt;</span>
</span></span><span class=line><span class=cl>  <span class=nt>&lt;Triggers&gt;</span>
</span></span><span class=line><span class=cl>    <span class=nt>&lt;EventTrigger&gt;</span>
</span></span><span class=line><span class=cl>      <span class=nt>&lt;Enabled&gt;</span>true<span class=nt>&lt;/Enabled&gt;</span>
</span></span><span class=line><span class=cl>      <span class=nt>&lt;Subscription&gt;</span><span class=ni>&amp;lt;</span>QueryList<span class=ni>&amp;gt;&amp;lt;</span>Query Id=&#34;0&#34; Path=&#34;Microsoft-Windows-Backup&#34;<span class=ni>&amp;gt;&amp;lt;</span>Select Path=&#34;Microsoft-Windows-Backup&#34;<span class=ni>&amp;gt;</span>*[System[Provider[@Name=&#39;Microsoft-Windows-Backup&#39;] and (EventID=4)]]<span class=ni>&amp;lt;</span>/Select<span class=ni>&amp;gt;&amp;lt;</span>/Query<span class=ni>&amp;gt;&amp;lt;</span>/QueryList<span class=ni>&amp;gt;</span><span class=nt>&lt;/Subscription&gt;</span>
</span></span><span class=line><span class=cl>    <span class=nt>&lt;/EventTrigger&gt;</span>
</span></span><span class=line><span class=cl>  <span class=nt>&lt;/Triggers&gt;</span>
</span></span><span class=line><span class=cl>  <span class=nt>&lt;Settings&gt;</span>
</span></span><span class=line><span class=cl>    <span class=nt>&lt;MultipleInstancesPolicy&gt;</span>IgnoreNew<span class=nt>&lt;/MultipleInstancesPolicy&gt;</span>
</span></span><span class=line><span class=cl>    <span class=nt>&lt;DisallowStartIfOnBatteries&gt;</span>true<span class=nt>&lt;/DisallowStartIfOnBatteries&gt;</span>
</span></span><span class=line><span class=cl>    <span class=nt>&lt;StopIfGoingOnBatteries&gt;</span>true<span class=nt>&lt;/StopIfGoingOnBatteries&gt;</span>
</span></span><span class=line><span class=cl>    <span class=nt>&lt;AllowHardTerminate&gt;</span>true<span class=nt>&lt;/AllowHardTerminate&gt;</span>
</span></span><span class=line><span class=cl>    <span class=nt>&lt;StartWhenAvailable&gt;</span>false<span class=nt>&lt;/StartWhenAvailable&gt;</span>
</span></span><span class=line><span class=cl>    <span class=nt>&lt;RunOnlyIfNetworkAvailable&gt;</span>false<span class=nt>&lt;/RunOnlyIfNetworkAvailable&gt;</span>
</span></span><span class=line><span class=cl>    <span class=nt>&lt;IdleSettings&gt;</span>
</span></span><span class=line><span class=cl>      <span class=nt>&lt;StopOnIdleEnd&gt;</span>true<span class=nt>&lt;/StopOnIdleEnd&gt;</span>
</span></span><span class=line><span class=cl>      <span class=nt>&lt;RestartOnIdle&gt;</span>false<span class=nt>&lt;/RestartOnIdle&gt;</span>
</span></span><span class=line><span class=cl>    <span class=nt>&lt;/IdleSettings&gt;</span>
</span></span><span class=line><span class=cl>    <span class=nt>&lt;AllowStartOnDemand&gt;</span>true<span class=nt>&lt;/AllowStartOnDemand&gt;</span>
</span></span><span class=line><span class=cl>    <span class=nt>&lt;Enabled&gt;</span>true<span class=nt>&lt;/Enabled&gt;</span>
</span></span><span class=line><span class=cl>    <span class=nt>&lt;Hidden&gt;</span>false<span class=nt>&lt;/Hidden&gt;</span>
</span></span><span class=line><span class=cl>    <span class=nt>&lt;RunOnlyIfIdle&gt;</span>false<span class=nt>&lt;/RunOnlyIfIdle&gt;</span>
</span></span><span class=line><span class=cl>    <span class=nt>&lt;WakeToRun&gt;</span>false<span class=nt>&lt;/WakeToRun&gt;</span>
</span></span><span class=line><span class=cl>  <span class=nt>&lt;/Settings&gt;</span>
</span></span><span class=line><span class=cl>  <span class=nt>&lt;Actions</span> <span class=na>Context=</span><span class=s>&#34;Author&#34;</span><span class=nt>&gt;</span>
</span></span><span class=line><span class=cl>    <span class=nt>&lt;Exec&gt;</span>
</span></span><span class=line><span class=cl>      <span class=nt>&lt;Command&gt;</span>powershell<span class=nt>&lt;/Command&gt;</span>
</span></span><span class=line><span class=cl>      <span class=nt>&lt;Arguments&gt;</span>&#34;C:\Scripts\app.backup.wsb.mail.ps1&#34; -Type &#39;success&#39;<span class=nt>&lt;/Arguments&gt;</span>
</span></span><span class=line><span class=cl>    <span class=nt>&lt;/Exec&gt;</span>
</span></span><span class=line><span class=cl>  <span class=nt>&lt;/Actions&gt;</span>
</span></span><span class=line><span class=cl><span class=nt>&lt;/Task&gt;</span></span></span></code></pre></td></tr></table></div></div></div></div></div></div></div><div class=tab-pane id=tab-pane-main-info role=tabpanel aria-labelledby=tab-main-info tabindex=0><div class=node-body><div class="row row-cols-1 row-cols-lg-2 g-3"><div class=col><section class="card node-categories h-100"><div class=card-body><h5 class=card-title>Категории</h5><ul class=list-inline><li class=list-inline-item><a href=https://lib.onl/ru/categories/scripts/>Скрипты</a></li><li class=list-inline-item><a href=https://lib.onl/ru/categories/windows/>MS Windows</a></li><li class=list-inline-item><a href=https://lib.onl/ru/categories/terminal/>Терминал</a></li></ul></div></section></div><div class=col><section class="card node-tags h-100"><div class=card-body><h5 class=card-title>Теги</h5><ul class=list-inline><li class=list-inline-item><a href=https://lib.onl/ru/tags/backup/>#backup</a></li><li class=list-inline-item><a href=https://lib.onl/ru/tags/mail/>#mail</a></li><li class=list-inline-item><a href=https://lib.onl/ru/tags/notice/>#notice</a></li></ul></div></section></div><div class=col><section class="card node-authors h-100"><div class=card-body><h5 class=card-title>Авторы</h5><ul><li><a href=https://lib.onl/ru/authors/kaikimera/>Kai Kimera</a></li></ul></div></section></div><div class=col><section class="card node-similar h-100"><div class=card-body><h5 class=card-title>Смотрите также</h5><div class="alert alert-warning d-flex align-items-center overflow-hidden node-body" id=alert-88ec4b5efa04588ba16a5d01bc3ef183 role=alert><div class=flex-shrink-0><i class="fas fa-triangle-exclamation fa-fw fa-2x"></i></div><div class="flex-grow-1 ms-3 overflow-hidden"><p>Похожие записи не найдены.</p></div></div></div></section></div><div class=col><section class="card node-meta h-100"><div class=card-body><h5 class=card-title>Мета</h5><div class="row row-cols-1 row-cols-sm-2 g-2 align-items-center"><div class=col>Лицензия</div><div class=col><div class=input-group><input type=text class=form-control value=CC-BY-SA-4.0 readonly>
<a class="btn btn-primary" href=https://choosealicense.com/licenses/cc-by-sa-4.0 target=_blank role=button rel="noopener noreferrer nofollow" title="Текст лицензии"><i class="far fa-file-lines fa-fw"></i></a></div></div><div class=col>ID файла</div><div class=col><input type=text class=form-control value=5f8c3b6189b5a8df425b93534a0b9917 readonly></div><div class=col>UUID</div><div class=col><input type=text class=form-control value=40539e36-4656-5532-b920-8975c97d4dc5 readonly></div><div class=col>Системный путь</div><div class=col><input type=text class=form-control value=articles/2024/09/1726606050968_6689/index.md readonly></div><div class=col>Тип</div><div class=col><input type=text class=form-control value=articles readonly></div></div></div></section></div><div class=col><section class="card node-stats h-100"><div class=card-body><h5 class=card-title>Статистика</h5><div class="row row-cols-1 row-cols-sm-2 g-2 align-items-center"><div class=col>Количество слов</div><div class=col><input type=text class=form-control value=910 readonly></div><div class=col>Время чтения</div><div class=col><div class=input-group><input type=text class=form-control value=5 readonly>
<span class=input-group-text>мин.</span></div></div></div></div></section></div></div></div></div><div class=tab-pane id=tab-pane-main-comments role=tabpanel aria-labelledby=tab-main-comments tabindex=0><div class=node-body><div class=giscus></div></div></div><div class=tab-pane id=tab-pane-main-share role=tabpanel aria-labelledby=tab-main-share tabindex=0><div class=node-body><div class="row row-cols-1 row-cols-lg-2 g-3"><div class=col><div class="row row-cols-1 g-3"><div class=col><div class="row row-cols-auto g-2"><div class=col><a class="btn btn-light" href="mailto:?subject=%d0%a3%d0%b2%d0%b5%d0%b4%d0%be%d0%bc%d0%bb%d0%b5%d0%bd%d0%b8%d1%8f%20%d0%be%d1%82%20Windows%20Server%20Backup&amp;body=https%3a%2f%2flib.onl%2fru%2f2024%2f09%2f40539e36-4656-5532-b920-8975c97d4dc5%2f" data-bs-tooltip data-bs-title=Email role=button rel="noopener noreferrer nofollow"><i class="fas fa-envelope-open-text fa-fw"></i></a></div><div class=col><a class="btn btn-light btn-social" href="https://twitter.com/intent/tweet?url=https%3a%2f%2flib.onl%2fru%2f2024%2f09%2f40539e36-4656-5532-b920-8975c97d4dc5%2f&amp;text=%d0%a3%d0%b2%d0%b5%d0%b4%d0%be%d0%bc%d0%bb%d0%b5%d0%bd%d0%b8%d1%8f%20%d0%be%d1%82%20Windows%20Server%20Backup&amp;hashtags=backup%2cmail%2cnotice" title=Twitter role=button rel="noopener noreferrer nofollow" data-fn=popup><i class="fab fa-twitter fa-fw"></i></a></div><div class=col><a class="btn btn-light btn-social" href="https://facebook.com/sharer/sharer.php?u=https%3a%2f%2flib.onl%2fru%2f2024%2f09%2f40539e36-4656-5532-b920-8975c97d4dc5%2f" title=Facebook role=button rel="noopener noreferrer nofollow" data-fn=popup><i class="fab fa-facebook fa-fw"></i></a></div><div class=col><a class="btn btn-light btn-social" href="https://linkedin.com/sharing/share-offsite/?url=https%3a%2f%2flib.onl%2fru%2f2024%2f09%2f40539e36-4656-5532-b920-8975c97d4dc5%2f" data-bs-tooltip data-bs-title=LinkedIn role=button rel="noopener noreferrer nofollow" data-fn=popup><i class="fab fa-linkedin fa-fw"></i></a></div><div class=col><a class="btn btn-light btn-social" href="https://reddit.com/submit?url=https%3a%2f%2flib.onl%2fru%2f2024%2f09%2f40539e36-4656-5532-b920-8975c97d4dc5%2f&amp;title=%d0%a3%d0%b2%d0%b5%d0%b4%d0%be%d0%bc%d0%bb%d0%b5%d0%bd%d0%b8%d1%8f%20%d0%be%d1%82%20Windows%20Server%20Backup" data-bs-tooltip data-bs-title=Reddit role=button rel="noopener noreferrer nofollow" data-fn=popup><i class="fab fa-reddit fa-fw"></i></a></div><div class=col><a class="btn btn-light btn-social" href="https://vk.com/share.php?url=https%3a%2f%2flib.onl%2fru%2f2024%2f09%2f40539e36-4656-5532-b920-8975c97d4dc5%2f&amp;title=%d0%a3%d0%b2%d0%b5%d0%b4%d0%be%d0%bc%d0%bb%d0%b5%d0%bd%d0%b8%d1%8f%20%d0%be%d1%82%20Windows%20Server%20Backup&amp;description=Windows%20Server%20Backup%20%d1%85%d0%be%d1%80%d0%be%d1%88%d0%b0%20%d0%b2%20%d0%ba%d0%b0%d1%87%d0%b5%d1%81%d1%82%d0%b2%d0%b5%20%d0%ba%d0%be%d0%bc%d0%bf%d0%be%d0%bd%d0%b5%d0%bd%d1%82%d0%b0%20%d1%80%d0%b5%d0%b7%d0%b5%d1%80%d0%b2%d0%bd%d0%be%d0%b3%d0%be%20%d0%ba%d0%be%d0%bf%d0%b8%d1%80%d0%be%d0%b2%d0%b0%d0%bd%d0%b8%d1%8f%2c%20%d0%b2%d1%81%d1%82%d1%80%d0%be%d0%b5%d0%bd%d0%bd%d0%be%d0%b3%d0%be%20%d0%b2%20%d0%9e%d0%a1.%20%d0%9d%d0%be%20%d1%80%d0%b0%d0%b1%d0%be%d1%82%d1%83%20%d1%8d%d1%82%d0%be%d0%b3%d0%be%20%d0%ba%d0%be%d0%bc%d0%bf%d0%be%d0%bd%d0%b5%d0%bd%d1%82%d0%b0%20%d0%bd%d0%b5%d0%bf%d0%bb%d0%be%d1%85%d0%be%20%d0%b1%d1%8b%d0%bb%d0%be%20%d0%b1%d1%8b%20%d0%be%d1%82%d1%81%d0%bb%d0%b5%d0%b6%d0%b8%d0%b2%d0%b0%d1%82%d1%8c.%0a" title=ВКонтакте role=button rel="noopener noreferrer nofollow" data-fn=popup><i class="fab fa-vk fa-fw"></i></a></div><div class=col><a class="btn btn-light btn-social" href="https://t.me/share/url?url=https%3a%2f%2flib.onl%2fru%2f2024%2f09%2f40539e36-4656-5532-b920-8975c97d4dc5%2f&amp;text=%d0%a3%d0%b2%d0%b5%d0%b4%d0%be%d0%bc%d0%bb%d0%b5%d0%bd%d0%b8%d1%8f%20%d0%be%d1%82%20Windows%20Server%20Backup" data-bs-tooltip data-bs-title=Telegram role=button rel="noopener noreferrer nofollow" data-fn=popup><i class="fab fa-telegram fa-fw"></i></a></div><div class=col><a class="btn btn-light btn-social" href="http://pinterest.com/pin/create/button/?url=https%3a%2f%2flib.onl%2fru%2f2024%2f09%2f40539e36-4656-5532-b920-8975c97d4dc5%2f" title=Pinterest role=button rel="noopener noreferrer nofollow" data-fn=popup><i class="fab fa-pinterest fa-fw"></i></a></div><div class=col><a class="btn btn-light btn-social" href="https://getpocket.com/edit?url=https%3a%2f%2flib.onl%2fru%2f2024%2f09%2f40539e36-4656-5532-b920-8975c97d4dc5%2f&amp;title=%d0%a3%d0%b2%d0%b5%d0%b4%d0%be%d0%bc%d0%bb%d0%b5%d0%bd%d0%b8%d1%8f%20%d0%be%d1%82%20Windows%20Server%20Backup" target=_blank title=Pocket role=button rel="noopener noreferrer nofollow" data-fn=popup><i class="fab fa-get-pocket fa-fw"></i></a></div><div class=col><a class="btn btn-light btn-social" href="https://news.ycombinator.com/submitlink?u=https%3a%2f%2flib.onl%2fru%2f2024%2f09%2f40539e36-4656-5532-b920-8975c97d4dc5%2f&amp;t=%d0%a3%d0%b2%d0%b5%d0%b4%d0%be%d0%bc%d0%bb%d0%b5%d0%bd%d0%b8%d1%8f%20%d0%be%d1%82%20Windows%20Server%20Backup" data-bs-tooltip data-bs-title='Hacker News' role=button rel="noopener noreferrer nofollow" data-fn=popup><i class="fab fa-hacker-news fa-fw"></i></a></div><div class=col><a class="btn btn-light btn-social" href="https://livejournal.com/update.bml?subject=%d0%a3%d0%b2%d0%b5%d0%b4%d0%be%d0%bc%d0%bb%d0%b5%d0%bd%d0%b8%d1%8f%20%d0%be%d1%82%20Windows%20Server%20Backup&amp;event=https%3a%2f%2flib.onl%2fru%2f2024%2f09%2f40539e36-4656-5532-b920-8975c97d4dc5%2f" title=LiveJournal role=button rel="noopener noreferrer nofollow" data-fn=popup><i class="fas fa-edit fa-fw"></i></a></div><div class=col><a class="btn btn-light btn-social" href="https://connect.ok.ru/dk?st.cmd=WidgetSharePreview&amp;st.shareUrl=https%3a%2f%2flib.onl%2fru%2f2024%2f09%2f40539e36-4656-5532-b920-8975c97d4dc5%2f&amp;title=%d0%a3%d0%b2%d0%b5%d0%b4%d0%be%d0%bc%d0%bb%d0%b5%d0%bd%d0%b8%d1%8f%20%d0%be%d1%82%20Windows%20Server%20Backup" title=Одноклассники role=button rel="noopener noreferrer nofollow" data-fn=popup><i class="fab fa-odnoklassniki fa-fw"></i></a></div><div class=col><a class="btn btn-light btn-social" href="https://blogger.com/blog-this.g?u=https%3a%2f%2flib.onl%2fru%2f2024%2f09%2f40539e36-4656-5532-b920-8975c97d4dc5%2f&amp;n=%d0%a3%d0%b2%d0%b5%d0%b4%d0%be%d0%bc%d0%bb%d0%b5%d0%bd%d0%b8%d1%8f%20%d0%be%d1%82%20Windows%20Server%20Backup&amp;t=Windows%20Server%20Backup%20%d1%85%d0%be%d1%80%d0%be%d1%88%d0%b0%20%d0%b2%20%d0%ba%d0%b0%d1%87%d0%b5%d1%81%d1%82%d0%b2%d0%b5%20%d0%ba%d0%be%d0%bc%d0%bf%d0%be%d0%bd%d0%b5%d0%bd%d1%82%d0%b0%20%d1%80%d0%b5%d0%b7%d0%b5%d1%80%d0%b2%d0%bd%d0%be%d0%b3%d0%be%20%d0%ba%d0%be%d0%bf%d0%b8%d1%80%d0%be%d0%b2%d0%b0%d0%bd%d0%b8%d1%8f%2c%20%d0%b2%d1%81%d1%82%d1%80%d0%be%d0%b5%d0%bd%d0%bd%d0%be%d0%b3%d0%be%20%d0%b2%20%d0%9e%d0%a1.%20%d0%9d%d0%be%20%d1%80%d0%b0%d0%b1%d0%be%d1%82%d1%83%20%d1%8d%d1%82%d0%be%d0%b3%d0%be%20%d0%ba%d0%be%d0%bc%d0%bf%d0%be%d0%bd%d0%b5%d0%bd%d1%82%d0%b0%20%d0%bd%d0%b5%d0%bf%d0%bb%d0%be%d1%85%d0%be%20%d0%b1%d1%8b%d0%bb%d0%be%20%d0%b1%d1%8b%20%d0%be%d1%82%d1%81%d0%bb%d0%b5%d0%b6%d0%b8%d0%b2%d0%b0%d1%82%d1%8c.%0a" title=Blogger role=button rel="noopener noreferrer nofollow" data-fn=popup><i class="fab fa-blogger fa-fw"></i></a></div><div class=col><a class="btn btn-light btn-social" href="https://digg.com/submit?url=https%3a%2f%2flib.onl%2fru%2f2024%2f09%2f40539e36-4656-5532-b920-8975c97d4dc5%2f" data-bs-tooltip data-bs-title=Digg role=button rel="noopener noreferrer nofollow" data-fn=popup><i class="fab fa-digg fa-fw"></i></a></div><div class=col><a class="btn btn-light btn-social" href="https://web.skype.com/share?url=https%3a%2f%2flib.onl%2fru%2f2024%2f09%2f40539e36-4656-5532-b920-8975c97d4dc5%2f&amp;title=%d0%a3%d0%b2%d0%b5%d0%b4%d0%be%d0%bc%d0%bb%d0%b5%d0%bd%d0%b8%d1%8f%20%d0%be%d1%82%20Windows%20Server%20Backup" data-bs-tooltip data-bs-title=Skype role=button rel="noopener noreferrer nofollow" data-fn=popup><i class="fab fa-skype fa-fw"></i></a></div><div class=col><a class="btn btn-light btn-social" href="https://api.whatsapp.com/send?text=https%3a%2f%2flib.onl%2fru%2f2024%2f09%2f40539e36-4656-5532-b920-8975c97d4dc5%2f" title=WhatsApp role=button rel="noopener noreferrer nofollow" data-fn=popup><i class="fab fa-whatsapp fa-fw"></i></a></div><div class=col><a class="btn btn-light btn-social" href="https://tumblr.com/widgets/share/tool?canonicalUrl=https%3a%2f%2flib.onl%2fru%2f2024%2f09%2f40539e36-4656-5532-b920-8975c97d4dc5%2f&amp;title=%d0%a3%d0%b2%d0%b5%d0%b4%d0%be%d0%bc%d0%bb%d0%b5%d0%bd%d0%b8%d1%8f%20%d0%be%d1%82%20Windows%20Server%20Backup&amp;content=Windows%20Server%20Backup%20%d1%85%d0%be%d1%80%d0%be%d1%88%d0%b0%20%d0%b2%20%d0%ba%d0%b0%d1%87%d0%b5%d1%81%d1%82%d0%b2%d0%b5%20%d0%ba%d0%be%d0%bc%d0%bf%d0%be%d0%bd%d0%b5%d0%bd%d1%82%d0%b0%20%d1%80%d0%b5%d0%b7%d0%b5%d1%80%d0%b2%d0%bd%d0%be%d0%b3%d0%be%20%d0%ba%d0%be%d0%bf%d0%b8%d1%80%d0%be%d0%b2%d0%b0%d0%bd%d0%b8%d1%8f%2c%20%d0%b2%d1%81%d1%82%d1%80%d0%be%d0%b5%d0%bd%d0%bd%d0%be%d0%b3%d0%be%20%d0%b2%20%d0%9e%d0%a1.%20%d0%9d%d0%be%20%d1%80%d0%b0%d0%b1%d0%be%d1%82%d1%83%20%d1%8d%d1%82%d0%be%d0%b3%d0%be%20%d0%ba%d0%be%d0%bc%d0%bf%d0%be%d0%bd%d0%b5%d0%bd%d1%82%d0%b0%20%d0%bd%d0%b5%d0%bf%d0%bb%d0%be%d1%85%d0%be%20%d0%b1%d1%8b%d0%bb%d0%be%20%d0%b1%d1%8b%20%d0%be%d1%82%d1%81%d0%bb%d0%b5%d0%b6%d0%b8%d0%b2%d0%b0%d1%82%d1%8c.%0a&amp;tags=backup%2cmail%2cnotice&amp;posttype=link" title=Tumblr role=button rel="noopener noreferrer nofollow" data-fn=popup><i class="fab fa-tumblr fa-fw"></i></a></div><div class=col><a class="btn btn-light btn-social" href="https://wordpress.com/wp-admin/press-this.php?u=https%3a%2f%2flib.onl%2fru%2f2024%2f09%2f40539e36-4656-5532-b920-8975c97d4dc5%2f&amp;t=%d0%a3%d0%b2%d0%b5%d0%b4%d0%be%d0%bc%d0%bb%d0%b5%d0%bd%d0%b8%d1%8f%20%d0%be%d1%82%20Windows%20Server%20Backup&amp;s=Windows%20Server%20Backup%20%d1%85%d0%be%d1%80%d0%be%d1%88%d0%b0%20%d0%b2%20%d0%ba%d0%b0%d1%87%d0%b5%d1%81%d1%82%d0%b2%d0%b5%20%d0%ba%d0%be%d0%bc%d0%bf%d0%be%d0%bd%d0%b5%d0%bd%d1%82%d0%b0%20%d1%80%d0%b5%d0%b7%d0%b5%d1%80%d0%b2%d0%bd%d0%be%d0%b3%d0%be%20%d0%ba%d0%be%d0%bf%d0%b8%d1%80%d0%be%d0%b2%d0%b0%d0%bd%d0%b8%d1%8f%2c%20%d0%b2%d1%81%d1%82%d1%80%d0%be%d0%b5%d0%bd%d0%bd%d0%be%d0%b3%d0%be%20%d0%b2%20%d0%9e%d0%a1.%20%d0%9d%d0%be%20%d1%80%d0%b0%d0%b1%d0%be%d1%82%d1%83%20%d1%8d%d1%82%d0%be%d0%b3%d0%be%20%d0%ba%d0%be%d0%bc%d0%bf%d0%be%d0%bd%d0%b5%d0%bd%d1%82%d0%b0%20%d0%bd%d0%b5%d0%bf%d0%bb%d0%be%d1%85%d0%be%20%d0%b1%d1%8b%d0%bb%d0%be%20%d0%b1%d1%8b%20%d0%be%d1%82%d1%81%d0%bb%d0%b5%d0%b6%d0%b8%d0%b2%d0%b0%d1%82%d1%8c.%0a" title=WordPress role=button rel="noopener noreferrer nofollow" data-fn=popup><i class="fab fa-wordpress fa-fw"></i></a></div></div></div><div class=col><div class=input-group><span class=input-group-text><i class="fas fa-link fa-fw"></i></span>
<input type=text class=form-control value=https://lib.onl/ru/2024/09/40539e36-4656-5532-b920-8975c97d4dc5/ data-fn=select-all readonly></div></div><div class=col><div class=input-group><span class=input-group-text><i class="fas fa-file fa-fw"></i></span>
<input type=text class=form-control value=articles/2024/09/1726606050968_6689/index.md data-fn=select-all readonly></div></div></div></div><div class=col><div class="d-flex justify-content-center"><div class="d-block img-thumbnail" data-fn=qrcode data-qr-text=https://lib.onl/ru/2024/09/40539e36-4656-5532-b920-8975c97d4dc5/></div></div></div></div></div></div></div></article></div></div></main><footer class="mt-auto border-top bg-body-tertiary" id=site-footer><div class="section py-5 border-bottom"><div class=container><div class="row g-3"><div class=col-lg><article><h2 class="h5 border-bottom pb-1 mb-3">О проекте</h2><div class=node-body><p>Заметки по системному администрированию и веб-разработкам.</p></div></article></div><div class=col-lg><article><h2 class="h5 border-bottom pb-1 mb-3">Ресурсы</h2><div class=node-body><ul><li><a title href=https://kai.kim/ target=_blank rel="noopener noreferrer">Kai Kimera</a></li><li><a title href=https://uaik.github.io/ target=_blank rel="noopener noreferrer">Universal AIK</a></li></ul></div></article></div><div class=col-lg><article><h2 class="h5 border-bottom pb-1 mb-3">Контакты</h2><div class=node-body><ul><li><a title href=mailto:mail@lib.onl target=_self rel>Email</a></li></ul></div></article></div></div></div></div><div class="section py-3 bg-body-secondary"><div class=container><div class="row row-cols-1 row-cols-lg-2 small text-body-secondary align-items-center"><div class="col text-center text-lg-start"><ul class="list-inline mb-0"><li class=list-inline-item><div>Library Online &copy; 2024</div><div>Заметки на тему администрирования и разработки различных систем, приложений и серверов.</div></li></ul></div><div class="col text-center text-lg-end"><ul class="list-inline mb-0"><li class=list-inline-item title=JSON><a class="btn btn-sm" href=/ru/2024/09/40539e36-4656-5532-b920-8975c97d4dc5/index.json target=_blank aria-label=JSON><i class="fas fa-code fa-fw"></i></a></li><li class="list-inline-item dropup" title='Тема интерфейса'><button class="btn btn-sm dropdown-toggle ui-theme" type=button data-bs-toggle=dropdown aria-expanded=false aria-label='Переключить тему'>
<i class="fas fa-circle-half-stroke fa-fw"></i></button><ul class="dropdown-menu dropdown-menu-end shadow"><li><button class=dropdown-item type=button data-bs-theme-value=light aria-pressed=false>
<i class="fas fa-sun fa-fw"></i>
<span>Светлая</span></button></li><li><button class=dropdown-item type=button data-bs-theme-value=dark aria-pressed=false>
<i class="fas fa-moon fa-fw"></i>
<span>Тёмная</span></button></li><li><button class="dropdown-item active" type=button data-bs-theme-value=auto aria-pressed=true>
<i class="fas fa-circle-half-stroke fa-fw"></i>
<span>Системная</span></button></li></ul></li><li class="list-inline-item dropup" title=Языки><button class="btn btn-sm dropdown-toggle" type=button data-bs-toggle=dropdown aria-expanded=false aria-label=Языки>
<i class="fas fa-language fa-fw"></i></button><ul class="dropdown-menu dropdown-menu-end shadow"><li><a class=dropdown-item href=/ru/ hreflang=ru>Русский</a></li><li><a class=dropdown-item href=/en/ hreflang=en>English</a></li></ul></li></ul></div></div></div></div></footer><div class="modal fade" id=search-modal tabindex=-1 aria-labelledby=searchModalLabel aria-hidden=true><div class="modal-dialog modal-dialog-scrollable modal-xl"><div class=modal-content><div class=modal-header><h5 class=modal-title id=searchModalLabel>Поиск</h5><button type=button class=btn-close data-bs-dismiss=modal aria-label=Закрыть></button></div><div class="modal-body node-body"><div class="row row-cols-1 g-3"><div class=col><div class="row g-3"><div class=col-lg><form action=https://google.com/search method=get class=d-flex target=_blank><input type=hidden name=domains value=lib.onl>
<input type=hidden name=sitesearch value=lib.onl><div class=input-group><span class=input-group-text><i class="fas fa-search fa-fw"></i></span>
<input type=search class=form-control name=q placeholder='Поиск Google' aria-label='Поиск Google'>
<span class=input-group-text><i class="fab fa-google fa-fw"></i></span></div></form></div><div class=col-lg><form action=https://ya.ru/search method=get class=d-flex target=_blank><input type=hidden name=site value=lib.onl><div class=input-group><span class=input-group-text><i class="fas fa-search fa-fw"></i></span>
<input type=search class=form-control name=text placeholder='Поиск Яндекс' aria-label='Поиск Яндекс'>
<span class=input-group-text><i class="fab fa-yandex fa-fw"></i></span></div></form></div></div></div><div class=col><form id=search-form method=get class=d-flex autocomplete=off><div class=input-group><span class=input-group-text><i class="fas fa-search fa-fw"></i></span>
<input id=search-input type=search class=form-control name=q placeholder='Внутренний поиск' aria-label='Внутренний поиск'>
<span class=input-group-text><i class="fas fa-brain fa-fw"></i></span></div></form></div><div class=col><div class="list-group list-group-flush d-none overflow-auto" id=search-results></div><div id=search-help><div class="alert alert-info d-flex align-items-center overflow-hidden node-body" id=alert-f091cb94db86344212e8631e440b3f8f role=alert><div class=flex-shrink-0><i class="fas fa-search fa-fw fa-2x"></i></div><div class="flex-grow-1 ms-3 overflow-hidden"><p>Используется нечёткий поиск (приблизительное сопоставление строк).
Это метод поиска строк, которые приблизительно соответствуют поисковому шаблону.</p><p>Результаты поиска сортируются по точности совпадения с поисковым шаблоном.
Результаты поиска, наиболее точно соответствующие запросу, находятся сверху, приблизительные результаты - снизу.</p></div></div></div></div></div></div></div></div></div><script src=/js/vendor.bundle.min.85b1a46641329b26e58b16e922d5e9797dbc96de73b50df4a9e8f4b897566128.js integrity="sha256-hbGkZkEymyblixbpItXpeX28lt5ztQ30qej0uJdWYSg=" crossorigin=anonymous defer></script><script src=/ru/js/system.bundle.min.e8278af4a5e659c111987a377887079e16ac2cb49267841b749d588d554f6820.js integrity="sha256-6CeK9KXmWcERmHo3eIcHnhasLLSSZ4QbdJ1YjVVPaCA=" crossorigin=anonymous defer></script><script src=https://giscus.app/client.js data-repo=s8956/comments data-repo-id=R_kgDOKgu0Tg data-category=Site data-category-id=DIC_kwDOKgu0Ts4CaJ2z data-mapping=pathname data-strict=1 data-reactions-enabled=1 data-emit-metadata=0 data-input-position=top data-theme=preferred_color_scheme data-lang=ru data-loading=lazy crossorigin=anonymous async></script><script type=application/ld+json>{"@context":"https://schema.org","@type":"Article","articleBody":"Windows Server Backup хороша в качестве компонента резервного копирования, встроенного в ОС. Но работу этого компонента неплохо было бы отслеживать.\nЯ написал небольшой скрипт, позволяющий по крону отслеживать системный журнал и находить записи по работе Windows Server Backup.\nСкрипт Скрипт анализирует системный журнал и фиксирует записи, принадлежащие #Windows Server Backup. Скрипт состоит из файла настроек, к которому можно ограничить доступ, приложения и двух задач.\nУстановка Скопировать файлы app.backup.wsb.mail.ps1 и app.backup.wsb.mail.ini в директорию C:\\Scripts\\. Импортировать задания task.backup.wsb.mail.error.xml и task.backup.wsb.mail.success.xml в Windows Task Scheduler и откорректировать параметры вызова скрипта. Изменить параметры скрипта в файле app.backup.wsb.mail.ini. Настройка Файл настройки представляет собой простой файл .ini, содержащий в себе приватные параметры.\napp.backup.wsb.mail.ini 1 2 3 4 5 6 From=mail@domain.com To=mail@domain.org Server=192.168.11.22 Port=25 User=smtp_user Password=smtp_password Параметры:\nFrom - адрес email, с которого будет отправлено сообщение. To - адрес email, на который будет отправлено сообщение. Server - IP-адрес SMTP-сервера. Port - порт SMTP-сервера. User - имя пользователя в SMTP-сервере. Password - пароль пользователя в SMTP-сервере. Приложение app.backup.wsb.mail.ps1 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 \u0026lt;#PSScriptInfo .VERSION 0.1.0 .GUID 18c25998-a474-425e-a59f-e32f79c8431d .AUTHOR Kai Kimera .AUTHOREMAIL mail@kai.kim .COMPANYNAME Library Online .COPYRIGHT 2024 Library Online. All rights reserved. .TAGS windows server backup mail .LICENSEURI https://choosealicense.com/licenses/mit/ .PROJECTURI https://lib.onl/ru/2024/09/40539e36-4656-5532-b920-8975c97d4dc5/ #\u0026gt; \u0026lt;# .SYNOPSIS Script for sending messages about backup status. .DESCRIPTION The script sends messages to the specified address for further analysis. The messages contain the host ID and notification type. .EXAMPLE .\\app.backup.wsb.mail.ps1 -Type \u0026#39;error\u0026#39; [-SSL] .\\app.backup.wsb.mail.ps1 -Type \u0026#39;success\u0026#39; [-SSL] .LINK https://lib.onl/ru/2024/09/40539e36-4656-5532-b920-8975c97d4dc5/ #\u0026gt; # -------------------------------------------------------------------------------------------------------------------- # # CONFIGURATION # -------------------------------------------------------------------------------------------------------------------- # Param( [Parameter(HelpMessage=\u0026#39;Message type.\u0026#39;)] [ValidateSet(\u0026#39;error\u0026#39;, \u0026#39;success\u0026#39;)] [string]$Type, [Parameter(HelpMessage=\u0026#39;Enable or disable encrypted connection.\u0026#39;)] [switch]$SSL = $false, [Alias(\u0026#39;Host\u0026#39;)][string]$Hostname = ([System.Net.Dns]::GetHostByName([string]\u0026#39;localhost\u0026#39;).HostName) ) # Loading configuration data. $S = ((Get-Item \u0026#34;${PSCommandPath}\u0026#34;).Basename + \u0026#39;.ini\u0026#39;) $P = (Get-Content -Path \u0026#34;${PSScriptRoot}\\${S}\u0026#34; | ConvertFrom-StringData) # Generating HostID (HID). $UUID = (Get-CimInstance \u0026#39;Win32_ComputerSystemProduct\u0026#39; | Select-Object -ExpandProperty \u0026#39;UUID\u0026#39;) $HID = ((${Hostname} + \u0026#39;:\u0026#39; + ${UUID}).ToUpper()) # -------------------------------------------------------------------------------------------------------------------- # # INITIALIZATION # -------------------------------------------------------------------------------------------------------------------- # function Start-Script() { switch (\u0026#34;${Type}\u0026#34;) { \u0026#39;error\u0026#39; { Send-BackupError } \u0026#39;success\u0026#39; { Send-BackupSuccess } default { exit } } } # -------------------------------------------------------------------------------------------------------------------- # # BACKUP: ERROR # Sending an email after a failed backup. # -------------------------------------------------------------------------------------------------------------------- # function Send-BackupError() { $Subject = \u0026#34;Windows Server Backup: ${Hostname}\u0026#34; $Body = @\u0026#34; Windows Server Backup failed: ${Hostname}. Please check server backup! Host: ${Hostname} Status: ERROR -- #ID:${HID} #TYPE:BACKUP:ERROR \u0026#34;@ Start-Smtp -S \u0026#34;${Subject}\u0026#34; -B \u0026#34;${Body}\u0026#34; } # -------------------------------------------------------------------------------------------------------------------- # # BACKUP: SUCCESS # Sending an email after a successful backup. # -------------------------------------------------------------------------------------------------------------------- # function Send-BackupSuccess() { $Subject = \u0026#34;Windows Server Backup: ${Hostname}\u0026#34; $Body = @\u0026#34; Windows Server Backup completed successfully! Host: ${Hostname} Status: SUCCESS -- #ID:${HID} #TYPE:BACKUP:SUCCESS \u0026#34;@ Start-Smtp -S \u0026#34;${Subject}\u0026#34; -B \u0026#34;${Body}\u0026#34; } # -------------------------------------------------------------------------------------------------------------------- # # SMTP # SMTP configuration. # -------------------------------------------------------------------------------------------------------------------- # function Start-Smtp { Param( [Alias(\u0026#39;S\u0026#39;)][string]$Subject, [Alias(\u0026#39;B\u0026#39;)][string]$Body ) $SmtpClient = New-Object Net.Mail.SmtpClient(\u0026#34;$($P.Server)\u0026#34;, \u0026#34;$($P.Port)\u0026#34;) $SmtpClient.EnableSsl = $SSL $SmtpClient.Credentials = New-Object System.Net.NetworkCredential(\u0026#34;$($P.User)\u0026#34;, \u0026#34;$($P.Password)\u0026#34;) $SmtpClient.Send(\u0026#34;$($P.From)\u0026#34;, \u0026#34;$($P.To)\u0026#34;, \u0026#34;${Subject}\u0026#34;, \u0026#34;${Body}\u0026#34;) } # -------------------------------------------------------------------------------------------------------------------- # # -------------------------------------------------\u0026lt; RUNNING SCRIPT \u0026gt;------------------------------------------------- # # -------------------------------------------------------------------------------------------------------------------- # Start-Script Параметры:\nType - тип сообщения. success - задание #Windows Server Backup успешно выполнено. error - задание #Windows Server Backup не выполнено или выполнено с ошибками. Задачи Задачи делятся на два типа: ошибка и успешное выполнение. Каждая из задач будет искать записи #Windows Server Backup в журнале и запускаться в зависимости от идентификатора события (EventID).\nОшибка Задача присылает уведомление в том случае, когда в журнале событий появляется запись об ошибке выполнения #Windows Server Backup.\ntask.backup.wsb.mail.error.xml 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 \u0026lt;?xml version=\u0026#34;1.0\u0026#34; encoding=\u0026#34;UTF-16\u0026#34;?\u0026gt; \u0026lt;Task version=\u0026#34;1.2\u0026#34; xmlns=\u0026#34;http://schemas.microsoft.com/windows/2004/02/mit/task\u0026#34;\u0026gt; \u0026lt;RegistrationInfo\u0026gt; \u0026lt;Description\u0026gt;Notifies backup admin of scheduled backup failure.\u0026lt;/Description\u0026gt; \u0026lt;/RegistrationInfo\u0026gt; \u0026lt;Triggers\u0026gt; \u0026lt;EventTrigger\u0026gt; \u0026lt;Enabled\u0026gt;true\u0026lt;/Enabled\u0026gt; \u0026lt;Subscription\u0026gt;\u0026amp;lt;QueryList\u0026amp;gt;\u0026amp;lt;Query Id=\u0026#34;0\u0026#34; Path=\u0026#34;Microsoft-Windows-Backup\u0026#34;\u0026amp;gt;\u0026amp;lt;Select Path=\u0026#34;Microsoft-Windows-Backup\u0026#34;\u0026amp;gt;*[System[Provider[@Name=\u0026#39;Microsoft-Windows-Backup\u0026#39;] and (EventID=5 or EventID=8 or EventID=9 or (EventID \u0026amp;amp;gt;= 17 and EventID \u0026amp;amp;lt;= 22) or EventID=49 or EventID=50 or EventID=52 or EventID=100 or EventID=517 or EventID=518 or EventID=521 or EventID=527 or EventID=528 or EventID=544 or EventID=545 or EventID=546 or EventID=561 or EventID=564 or EventID=612)]]\u0026amp;lt;/Select\u0026amp;gt;\u0026amp;lt;/Query\u0026amp;gt;\u0026amp;lt;/QueryList\u0026amp;gt;\u0026lt;/Subscription\u0026gt; \u0026lt;/EventTrigger\u0026gt; \u0026lt;/Triggers\u0026gt; \u0026lt;Settings\u0026gt; \u0026lt;MultipleInstancesPolicy\u0026gt;IgnoreNew\u0026lt;/MultipleInstancesPolicy\u0026gt; \u0026lt;DisallowStartIfOnBatteries\u0026gt;true\u0026lt;/DisallowStartIfOnBatteries\u0026gt; \u0026lt;StopIfGoingOnBatteries\u0026gt;true\u0026lt;/StopIfGoingOnBatteries\u0026gt; \u0026lt;AllowHardTerminate\u0026gt;true\u0026lt;/AllowHardTerminate\u0026gt; \u0026lt;StartWhenAvailable\u0026gt;false\u0026lt;/StartWhenAvailable\u0026gt; \u0026lt;RunOnlyIfNetworkAvailable\u0026gt;false\u0026lt;/RunOnlyIfNetworkAvailable\u0026gt; \u0026lt;IdleSettings\u0026gt; \u0026lt;StopOnIdleEnd\u0026gt;true\u0026lt;/StopOnIdleEnd\u0026gt; \u0026lt;RestartOnIdle\u0026gt;false\u0026lt;/RestartOnIdle\u0026gt; \u0026lt;/IdleSettings\u0026gt; \u0026lt;AllowStartOnDemand\u0026gt;true\u0026lt;/AllowStartOnDemand\u0026gt; \u0026lt;Enabled\u0026gt;true\u0026lt;/Enabled\u0026gt; \u0026lt;Hidden\u0026gt;false\u0026lt;/Hidden\u0026gt; \u0026lt;RunOnlyIfIdle\u0026gt;false\u0026lt;/RunOnlyIfIdle\u0026gt; \u0026lt;WakeToRun\u0026gt;false\u0026lt;/WakeToRun\u0026gt; \u0026lt;/Settings\u0026gt; \u0026lt;Actions Context=\u0026#34;Author\u0026#34;\u0026gt; \u0026lt;Exec\u0026gt; \u0026lt;Command\u0026gt;powershell\u0026lt;/Command\u0026gt; \u0026lt;Arguments\u0026gt;\u0026#34;C:\\Scripts\\app.backup.wsb.mail.ps1\u0026#34; -Type \u0026#39;error\u0026#39;\u0026lt;/Arguments\u0026gt; \u0026lt;/Exec\u0026gt; \u0026lt;/Actions\u0026gt; \u0026lt;/Task\u0026gt; Успешно Задача присылает уведомление в том случае, когда в журнале событий появляется запись об успешном выполнении #Windows Server Backup.\ntask.backup.wsb.mail.success.xml 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 \u0026lt;?xml version=\u0026#34;1.0\u0026#34; encoding=\u0026#34;UTF-16\u0026#34;?\u0026gt; \u0026lt;Task version=\u0026#34;1.2\u0026#34; xmlns=\u0026#34;http://schemas.microsoft.com/windows/2004/02/mit/task\u0026#34;\u0026gt; \u0026lt;RegistrationInfo\u0026gt; \u0026lt;Description\u0026gt;Notifies backup admin of scheduled backup successful completion.\u0026lt;/Description\u0026gt; \u0026lt;/RegistrationInfo\u0026gt; \u0026lt;Triggers\u0026gt; \u0026lt;EventTrigger\u0026gt; \u0026lt;Enabled\u0026gt;true\u0026lt;/Enabled\u0026gt; \u0026lt;Subscription\u0026gt;\u0026amp;lt;QueryList\u0026amp;gt;\u0026amp;lt;Query Id=\u0026#34;0\u0026#34; Path=\u0026#34;Microsoft-Windows-Backup\u0026#34;\u0026amp;gt;\u0026amp;lt;Select Path=\u0026#34;Microsoft-Windows-Backup\u0026#34;\u0026amp;gt;*[System[Provider[@Name=\u0026#39;Microsoft-Windows-Backup\u0026#39;] and (EventID=4)]]\u0026amp;lt;/Select\u0026amp;gt;\u0026amp;lt;/Query\u0026amp;gt;\u0026amp;lt;/QueryList\u0026amp;gt;\u0026lt;/Subscription\u0026gt; \u0026lt;/EventTrigger\u0026gt; \u0026lt;/Triggers\u0026gt; \u0026lt;Settings\u0026gt; \u0026lt;MultipleInstancesPolicy\u0026gt;IgnoreNew\u0026lt;/MultipleInstancesPolicy\u0026gt; \u0026lt;DisallowStartIfOnBatteries\u0026gt;true\u0026lt;/DisallowStartIfOnBatteries\u0026gt; \u0026lt;StopIfGoingOnBatteries\u0026gt;true\u0026lt;/StopIfGoingOnBatteries\u0026gt; \u0026lt;AllowHardTerminate\u0026gt;true\u0026lt;/AllowHardTerminate\u0026gt; \u0026lt;StartWhenAvailable\u0026gt;false\u0026lt;/StartWhenAvailable\u0026gt; \u0026lt;RunOnlyIfNetworkAvailable\u0026gt;false\u0026lt;/RunOnlyIfNetworkAvailable\u0026gt; \u0026lt;IdleSettings\u0026gt; \u0026lt;StopOnIdleEnd\u0026gt;true\u0026lt;/StopOnIdleEnd\u0026gt; \u0026lt;RestartOnIdle\u0026gt;false\u0026lt;/RestartOnIdle\u0026gt; \u0026lt;/IdleSettings\u0026gt; \u0026lt;AllowStartOnDemand\u0026gt;true\u0026lt;/AllowStartOnDemand\u0026gt; \u0026lt;Enabled\u0026gt;true\u0026lt;/Enabled\u0026gt; \u0026lt;Hidden\u0026gt;false\u0026lt;/Hidden\u0026gt; \u0026lt;RunOnlyIfIdle\u0026gt;false\u0026lt;/RunOnlyIfIdle\u0026gt; \u0026lt;WakeToRun\u0026gt;false\u0026lt;/WakeToRun\u0026gt; \u0026lt;/Settings\u0026gt; \u0026lt;Actions Context=\u0026#34;Author\u0026#34;\u0026gt; \u0026lt;Exec\u0026gt; \u0026lt;Command\u0026gt;powershell\u0026lt;/Command\u0026gt; \u0026lt;Arguments\u0026gt;\u0026#34;C:\\Scripts\\app.backup.wsb.mail.ps1\u0026#34; -Type \u0026#39;success\u0026#39;\u0026lt;/Arguments\u0026gt; \u0026lt;/Exec\u0026gt; \u0026lt;/Actions\u0026gt; \u0026lt;/Task\u0026gt; ","author":[{"@context":"https://schema.org","@type":"Person","address":{"@type":"PostalAddress","addressCountry":"Russia","addressLocality":"Reutov","addressRegion":"Moscow Region"},"alternateName":"Kai Kimera","award":["Грамота АО Институт ЭНЕРГОСЕТЬПРОЕКТ"],"birthDate":"1987-03-13","birthPlace":{"@type":"Place","address":{"@type":"PostalAddress","addressCountry":"Russia","addressLocality":"Reutov","addressRegion":"Moscow Region"}},"email":"mail@kai.kim","gender":"Male","image":"https://gravatar.com/avatar/911c0a839d7d4c3d750a8ce0de293e84?s=512","jobTitle":"System administrator","mainEntityOfPage":"https://lib.onl/ru/authors/kaikimera/","name":"Kai Kimera","sameAs":["https://github.com/KaiKimera","https://instagram.com/KaiKimera","https://twitter.com/KaiKimera","https://vk.com/KaiKimera","https://youtube.com/@KaiKimera"],"telephone":"+7 (000) 000-0000","url":"https://kai.kim/"}],"dateCreated":"2024-09-17T20:47:31Z","dateModified":"2024-09-17T20:47:31Z","datePublished":"2024-09-17T20:47:31Z","description":"Windows Server Backup хороша в качестве компонента резервного копирования, встроенного в ОС. Но работу этого компонента неплохо было бы отслеживать.\n","headline":"Уведомления от Windows Server Backup","image":"https://images.unsplash.com/photo-1704265586128-7fc54dcc774f","inLanguage":[{"@type":"Language","alternateName":"ru-RU","name":"Русский"}],"keywords":["backup","mail","notice"],"mainEntityOfPage":"https://lib.onl/ru/2024/09/40539e36-4656-5532-b920-8975c97d4dc5/","pageEnd":1,"pageStart":1,"publisher":"https://lib.onl/#organization","text":"Windows Server Backup хороша в качестве компонента резервного копирования, встроенного в ОС. Но работу этого компонента неплохо было бы отслеживать.\nЯ написал небольшой скрипт, позволяющий по крону отслеживать системный журнал и находить записи по работе Windows Server Backup.\nСкрипт Скрипт анализирует системный журнал и фиксирует записи, принадлежащие #Windows Server Backup. Скрипт состоит из файла настроек, к которому можно ограничить доступ, приложения и двух задач.\nУстановка Скопировать файлы app.backup.wsb.mail.ps1 и app.backup.wsb.mail.ini в директорию C:\\Scripts\\. Импортировать задания task.backup.wsb.mail.error.xml и task.backup.wsb.mail.success.xml в Windows Task Scheduler и откорректировать параметры вызова скрипта. Изменить параметры скрипта в файле app.backup.wsb.mail.ini. Настройка Файл настройки представляет собой простой файл .ini, содержащий в себе приватные параметры.\napp.backup.wsb.mail.ini 1 2 3 4 5 6 From=mail@domain.com To=mail@domain.org Server=192.168.11.22 Port=25 User=smtp_user Password=smtp_password Параметры:\nFrom - адрес email, с которого будет отправлено сообщение. To - адрес email, на который будет отправлено сообщение. Server - IP-адрес SMTP-сервера. Port - порт SMTP-сервера. User - имя пользователя в SMTP-сервере. Password - пароль пользователя в SMTP-сервере. Приложение app.backup.wsb.mail.ps1 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 \u0026lt;#PSScriptInfo .VERSION 0.1.0 .GUID 18c25998-a474-425e-a59f-e32f79c8431d .AUTHOR Kai Kimera .AUTHOREMAIL mail@kai.kim .COMPANYNAME Library Online .COPYRIGHT 2024 Library Online. All rights reserved. .TAGS windows server backup mail .LICENSEURI https://choosealicense.com/licenses/mit/ .PROJECTURI https://lib.onl/ru/2024/09/40539e36-4656-5532-b920-8975c97d4dc5/ #\u0026gt; \u0026lt;# .SYNOPSIS Script for sending messages about backup status. .DESCRIPTION The script sends messages to the specified address for further analysis. The messages contain the host ID and notification type. .EXAMPLE .\\app.backup.wsb.mail.ps1 -Type \u0026#39;error\u0026#39; [-SSL] .\\app.backup.wsb.mail.ps1 -Type \u0026#39;success\u0026#39; [-SSL] .LINK https://lib.onl/ru/2024/09/40539e36-4656-5532-b920-8975c97d4dc5/ #\u0026gt; # -------------------------------------------------------------------------------------------------------------------- # # CONFIGURATION # -------------------------------------------------------------------------------------------------------------------- # Param( [Parameter(HelpMessage=\u0026#39;Message type.\u0026#39;)] [ValidateSet(\u0026#39;error\u0026#39;, \u0026#39;success\u0026#39;)] [string]$Type, [Parameter(HelpMessage=\u0026#39;Enable or disable encrypted connection.\u0026#39;)] [switch]$SSL = $false, [Alias(\u0026#39;Host\u0026#39;)][string]$Hostname = ([System.Net.Dns]::GetHostByName([string]\u0026#39;localhost\u0026#39;).HostName) ) # Loading configuration data. $S = ((Get-Item \u0026#34;${PSCommandPath}\u0026#34;).Basename + \u0026#39;.ini\u0026#39;) $P = (Get-Content -Path \u0026#34;${PSScriptRoot}\\${S}\u0026#34; | ConvertFrom-StringData) # Generating HostID (HID). $UUID = (Get-CimInstance \u0026#39;Win32_ComputerSystemProduct\u0026#39; | Select-Object -ExpandProperty \u0026#39;UUID\u0026#39;) $HID = ((${Hostname} + \u0026#39;:\u0026#39; + ${UUID}).ToUpper()) # -------------------------------------------------------------------------------------------------------------------- # # INITIALIZATION # -------------------------------------------------------------------------------------------------------------------- # function Start-Script() { switch (\u0026#34;${Type}\u0026#34;) { \u0026#39;error\u0026#39; { Send-BackupError } \u0026#39;success\u0026#39; { Send-BackupSuccess } default { exit } } } # -------------------------------------------------------------------------------------------------------------------- # # BACKUP: ERROR # Sending an email after a failed backup. # -------------------------------------------------------------------------------------------------------------------- # function Send-BackupError() { $Subject = \u0026#34;Windows Server Backup: ${Hostname}\u0026#34; $Body = @\u0026#34; Windows Server Backup failed: ${Hostname}. Please check server backup! Host: ${Hostname} Status: ERROR -- #ID:${HID} #TYPE:BACKUP:ERROR \u0026#34;@ Start-Smtp -S \u0026#34;${Subject}\u0026#34; -B \u0026#34;${Body}\u0026#34; } # -------------------------------------------------------------------------------------------------------------------- # # BACKUP: SUCCESS # Sending an email after a successful backup. # -------------------------------------------------------------------------------------------------------------------- # function Send-BackupSuccess() { $Subject = \u0026#34;Windows Server Backup: ${Hostname}\u0026#34; $Body = @\u0026#34; Windows Server Backup completed successfully! Host: ${Hostname} Status: SUCCESS -- #ID:${HID} #TYPE:BACKUP:SUCCESS \u0026#34;@ Start-Smtp -S \u0026#34;${Subject}\u0026#34; -B \u0026#34;${Body}\u0026#34; } # -------------------------------------------------------------------------------------------------------------------- # # SMTP # SMTP configuration. # -------------------------------------------------------------------------------------------------------------------- # function Start-Smtp { Param( [Alias(\u0026#39;S\u0026#39;)][string]$Subject, [Alias(\u0026#39;B\u0026#39;)][string]$Body ) $SmtpClient = New-Object Net.Mail.SmtpClient(\u0026#34;$($P.Server)\u0026#34;, \u0026#34;$($P.Port)\u0026#34;) $SmtpClient.EnableSsl = $SSL $SmtpClient.Credentials = New-Object System.Net.NetworkCredential(\u0026#34;$($P.User)\u0026#34;, \u0026#34;$($P.Password)\u0026#34;) $SmtpClient.Send(\u0026#34;$($P.From)\u0026#34;, \u0026#34;$($P.To)\u0026#34;, \u0026#34;${Subject}\u0026#34;, \u0026#34;${Body}\u0026#34;) } # -------------------------------------------------------------------------------------------------------------------- # # -------------------------------------------------\u0026lt; RUNNING SCRIPT \u0026gt;------------------------------------------------- # # -------------------------------------------------------------------------------------------------------------------- # Start-Script Параметры:\nType - тип сообщения. success - задание #Windows Server Backup успешно выполнено. error - задание #Windows Server Backup не выполнено или выполнено с ошибками. Задачи Задачи делятся на два типа: ошибка и успешное выполнение. Каждая из задач будет искать записи #Windows Server Backup в журнале и запускаться в зависимости от идентификатора события (EventID).\nОшибка Задача присылает уведомление в том случае, когда в журнале событий появляется запись об ошибке выполнения #Windows Server Backup.\ntask.backup.wsb.mail.error.xml 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 \u0026lt;?xml version=\u0026#34;1.0\u0026#34; encoding=\u0026#34;UTF-16\u0026#34;?\u0026gt; \u0026lt;Task version=\u0026#34;1.2\u0026#34; xmlns=\u0026#34;http://schemas.microsoft.com/windows/2004/02/mit/task\u0026#34;\u0026gt; \u0026lt;RegistrationInfo\u0026gt; \u0026lt;Description\u0026gt;Notifies backup admin of scheduled backup failure.\u0026lt;/Description\u0026gt; \u0026lt;/RegistrationInfo\u0026gt; \u0026lt;Triggers\u0026gt; \u0026lt;EventTrigger\u0026gt; \u0026lt;Enabled\u0026gt;true\u0026lt;/Enabled\u0026gt; \u0026lt;Subscription\u0026gt;\u0026amp;lt;QueryList\u0026amp;gt;\u0026amp;lt;Query Id=\u0026#34;0\u0026#34; Path=\u0026#34;Microsoft-Windows-Backup\u0026#34;\u0026amp;gt;\u0026amp;lt;Select Path=\u0026#34;Microsoft-Windows-Backup\u0026#34;\u0026amp;gt;*[System[Provider[@Name=\u0026#39;Microsoft-Windows-Backup\u0026#39;] and (EventID=5 or EventID=8 or EventID=9 or (EventID \u0026amp;amp;gt;= 17 and EventID \u0026amp;amp;lt;= 22) or EventID=49 or EventID=50 or EventID=52 or EventID=100 or EventID=517 or EventID=518 or EventID=521 or EventID=527 or EventID=528 or EventID=544 or EventID=545 or EventID=546 or EventID=561 or EventID=564 or EventID=612)]]\u0026amp;lt;/Select\u0026amp;gt;\u0026amp;lt;/Query\u0026amp;gt;\u0026amp;lt;/QueryList\u0026amp;gt;\u0026lt;/Subscription\u0026gt; \u0026lt;/EventTrigger\u0026gt; \u0026lt;/Triggers\u0026gt; \u0026lt;Settings\u0026gt; \u0026lt;MultipleInstancesPolicy\u0026gt;IgnoreNew\u0026lt;/MultipleInstancesPolicy\u0026gt; \u0026lt;DisallowStartIfOnBatteries\u0026gt;true\u0026lt;/DisallowStartIfOnBatteries\u0026gt; \u0026lt;StopIfGoingOnBatteries\u0026gt;true\u0026lt;/StopIfGoingOnBatteries\u0026gt; \u0026lt;AllowHardTerminate\u0026gt;true\u0026lt;/AllowHardTerminate\u0026gt; \u0026lt;StartWhenAvailable\u0026gt;false\u0026lt;/StartWhenAvailable\u0026gt; \u0026lt;RunOnlyIfNetworkAvailable\u0026gt;false\u0026lt;/RunOnlyIfNetworkAvailable\u0026gt; \u0026lt;IdleSettings\u0026gt; \u0026lt;StopOnIdleEnd\u0026gt;true\u0026lt;/StopOnIdleEnd\u0026gt; \u0026lt;RestartOnIdle\u0026gt;false\u0026lt;/RestartOnIdle\u0026gt; \u0026lt;/IdleSettings\u0026gt; \u0026lt;AllowStartOnDemand\u0026gt;true\u0026lt;/AllowStartOnDemand\u0026gt; \u0026lt;Enabled\u0026gt;true\u0026lt;/Enabled\u0026gt; \u0026lt;Hidden\u0026gt;false\u0026lt;/Hidden\u0026gt; \u0026lt;RunOnlyIfIdle\u0026gt;false\u0026lt;/RunOnlyIfIdle\u0026gt; \u0026lt;WakeToRun\u0026gt;false\u0026lt;/WakeToRun\u0026gt; \u0026lt;/Settings\u0026gt; \u0026lt;Actions Context=\u0026#34;Author\u0026#34;\u0026gt; \u0026lt;Exec\u0026gt; \u0026lt;Command\u0026gt;powershell\u0026lt;/Command\u0026gt; \u0026lt;Arguments\u0026gt;\u0026#34;C:\\Scripts\\app.backup.wsb.mail.ps1\u0026#34; -Type \u0026#39;error\u0026#39;\u0026lt;/Arguments\u0026gt; \u0026lt;/Exec\u0026gt; \u0026lt;/Actions\u0026gt; \u0026lt;/Task\u0026gt; Успешно Задача присылает уведомление в том случае, когда в журнале событий появляется запись об успешном выполнении #Windows Server Backup.\ntask.backup.wsb.mail.success.xml 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 \u0026lt;?xml version=\u0026#34;1.0\u0026#34; encoding=\u0026#34;UTF-16\u0026#34;?\u0026gt; \u0026lt;Task version=\u0026#34;1.2\u0026#34; xmlns=\u0026#34;http://schemas.microsoft.com/windows/2004/02/mit/task\u0026#34;\u0026gt; \u0026lt;RegistrationInfo\u0026gt; \u0026lt;Description\u0026gt;Notifies backup admin of scheduled backup successful completion.\u0026lt;/Description\u0026gt; \u0026lt;/RegistrationInfo\u0026gt; \u0026lt;Triggers\u0026gt; \u0026lt;EventTrigger\u0026gt; \u0026lt;Enabled\u0026gt;true\u0026lt;/Enabled\u0026gt; \u0026lt;Subscription\u0026gt;\u0026amp;lt;QueryList\u0026amp;gt;\u0026amp;lt;Query Id=\u0026#34;0\u0026#34; Path=\u0026#34;Microsoft-Windows-Backup\u0026#34;\u0026amp;gt;\u0026amp;lt;Select Path=\u0026#34;Microsoft-Windows-Backup\u0026#34;\u0026amp;gt;*[System[Provider[@Name=\u0026#39;Microsoft-Windows-Backup\u0026#39;] and (EventID=4)]]\u0026amp;lt;/Select\u0026amp;gt;\u0026amp;lt;/Query\u0026amp;gt;\u0026amp;lt;/QueryList\u0026amp;gt;\u0026lt;/Subscription\u0026gt; \u0026lt;/EventTrigger\u0026gt; \u0026lt;/Triggers\u0026gt; \u0026lt;Settings\u0026gt; \u0026lt;MultipleInstancesPolicy\u0026gt;IgnoreNew\u0026lt;/MultipleInstancesPolicy\u0026gt; \u0026lt;DisallowStartIfOnBatteries\u0026gt;true\u0026lt;/DisallowStartIfOnBatteries\u0026gt; \u0026lt;StopIfGoingOnBatteries\u0026gt;true\u0026lt;/StopIfGoingOnBatteries\u0026gt; \u0026lt;AllowHardTerminate\u0026gt;true\u0026lt;/AllowHardTerminate\u0026gt; \u0026lt;StartWhenAvailable\u0026gt;false\u0026lt;/StartWhenAvailable\u0026gt; \u0026lt;RunOnlyIfNetworkAvailable\u0026gt;false\u0026lt;/RunOnlyIfNetworkAvailable\u0026gt; \u0026lt;IdleSettings\u0026gt; \u0026lt;StopOnIdleEnd\u0026gt;true\u0026lt;/StopOnIdleEnd\u0026gt; \u0026lt;RestartOnIdle\u0026gt;false\u0026lt;/RestartOnIdle\u0026gt; \u0026lt;/IdleSettings\u0026gt; \u0026lt;AllowStartOnDemand\u0026gt;true\u0026lt;/AllowStartOnDemand\u0026gt; \u0026lt;Enabled\u0026gt;true\u0026lt;/Enabled\u0026gt; \u0026lt;Hidden\u0026gt;false\u0026lt;/Hidden\u0026gt; \u0026lt;RunOnlyIfIdle\u0026gt;false\u0026lt;/RunOnlyIfIdle\u0026gt; \u0026lt;WakeToRun\u0026gt;false\u0026lt;/WakeToRun\u0026gt; \u0026lt;/Settings\u0026gt; \u0026lt;Actions Context=\u0026#34;Author\u0026#34;\u0026gt; \u0026lt;Exec\u0026gt; \u0026lt;Command\u0026gt;powershell\u0026lt;/Command\u0026gt; \u0026lt;Arguments\u0026gt;\u0026#34;C:\\Scripts\\app.backup.wsb.mail.ps1\u0026#34; -Type \u0026#39;success\u0026#39;\u0026lt;/Arguments\u0026gt; \u0026lt;/Exec\u0026gt; \u0026lt;/Actions\u0026gt; \u0026lt;/Task\u0026gt; ","url":"https://lib.onl/ru/2024/09/40539e36-4656-5532-b920-8975c97d4dc5/","wordCount":910}</script><script type=application/ld+json>{"@context":"https://schema.org","@id":"https://lib.onl/#website","@type":"WebSite","description":"Заметки на тему администрирования и разработки различных систем, приложений и серверов.","hasPart":[{"@context":"https://schema.org","@type":"WPHeader","cssSelector":"#site-header","headline":"headline-string"},{"@context":"https://schema.org","@type":"WPFooter","copyrightHolder":"https://lib.onl/#organization","copyrightYear":"2024","cssSelector":"#site-footer","publisher":"https://lib.onl/#organization"}],"inLanguage":[{"@type":"Language","alternateName":"ru-RU","name":"Русский"}],"keywords":["Powershell","Forum","Debian","Ipb","Ips","Mikrotik","Cisco","Freebsd","Routeros","Bash","Dns","Cmd","Cmf","Cms","Linux","Vbulletin","Chmod","Cloudflare","Fedora","Git"],"mainEntityOfPage":"https://lib.onl/","name":"Library Online","publisher":"https://lib.onl/#organization","url":"https://lib.onl/"}</script><script type=application/ld+json>{"@context":"https://schema.org","@id":"https://lib.onl/#organization","@type":"Organization","address":{"@type":"PostalAddress","addressCountry":"Russia","addressLocality":"Moscow","addressRegion":"Moscow Region"},"contactPoint":{"@type":"ContactPoint","contactType":"customer service","email":"mail@lib.onl","telephone":"+7 (000) 000-0000"},"description":"Заметки на тему администрирования и разработки различных систем, приложений и серверов.","foundingDate":"2020","legalName":"Library Online","logo":{"@type":"ImageObject","url":"https://lib.onl/img/logo.min.svg"},"mainEntityOfPage":"https://lib.onl/","name":"Library Online","sameAs":[""],"url":"https://lib.onl/"}</script><script type=application/ld+json>{"@context":"https://schema.org","@graph":[{"@type":"SiteNavigationElement","name":"Статьи","position":10,"url":"https://lib.onl/ru/articles/"},{"@type":"SiteNavigationElement","name":"Q\u0026A","position":20,"url":"https://lib.onl/ru/faq/"},{"@type":"SiteNavigationElement","name":"Архив","position":100,"url":"https://lib.onl/ru/archive/"},{"@type":"SiteNavigationElement","name":"О проекте","position":999,"url":"https://lib.onl/ru/about/"},{"@type":"SiteNavigationElement","name":"META","position":9999,"url":"https://lib.onl/ru/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","item":{"@id":"https://lib.onl/ru/","name":"Главная"},"position":1},{"@type":"ListItem","item":{"@id":"https://lib.onl/ru/articles/","name":"Статьи"},"position":2},{"@type":"ListItem","item":{"@id":"https://lib.onl/ru/2024/09/40539e36-4656-5532-b920-8975c97d4dc5/","name":"Уведомления от Windows Server Backup"},"position":3}]}</script></body></html>