<?xml version='1.0' encoding='UTF-8'?><rss version="2.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:yandex="http://news.yandex.ru" xmlns:turbo="http://turbo.yandex.ru"><channel><title>Library Online</title><link>https://lib.onl/ru/</link><description>Заметки на тему администрирования и разработки различных систем, приложений и серверов.</description><language>ru-RU</language><item turbo="true"><title>Работа с MySQL</title><link>https://lib.onl/ru/2024/12/8a40b3d0-4535-5ace-8480-72b94734b0f7/</link><pubDate>Mon, 02 Dec 2024 12:59:02 +0000</pubDate><dc:creator>Kai Kimera</dc:creator><category>Linux</category><category>Терминал</category><category>В доработке</category><yandex:related><link url="https://lib.onl/ru/2024/11/3297173e-ad39-574f-9cc6-e4f550096851/">Работа с PostgreSQL</link><link url="https://lib.onl/ru/2023/10/54d4e488-9a8f-55ed-8fea-c77d4dba0720/">SQL запросы IP.Board 2.3</link><link url="https://lib.onl/ru/2023/10/06c9d359-31f0-5862-a342-62a21d4eb032/">SQL запросы IP.Board 3.x</link></yandex:related><turbo:extendedHtml>true</turbo:extendedHtml><turbo:source>https://lib.onl/ru/2024/12/8a40b3d0-4535-5ace-8480-72b94734b0f7/</turbo:source><turbo:topic>Работа с MySQL</turbo:topic><turbo:content><![CDATA[<p>Шпаргалка по работе с <span class="shortcode shortcode-tag"><a href="/ru/tags/mysql/" target="_blank">#MySQL</a></span>.</p>
<h2 id="пользователи">
  <a class="link-body-emphasis" href="#%d0%bf%d0%be%d0%bb%d1%8c%d0%b7%d0%be%d0%b2%d0%b0%d1%82%d0%b5%d0%bb%d0%b8">Пользователи</a>
</h2><ul>
<li>Создать пользователя <code>DB_USER</code> с паролем <code>DB_PASSWORD</code>:</li>
</ul>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-0
shortcode-codeblock-bash">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-827b416ea63e09f99a64be3d31a118d8" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="nb">echo</span> <span class="s2">&#34;CREATE USER &#39;DB_USER&#39;@&#39;127.0.0.1&#39; IDENTIFIED BY &#39;DB_PASSWORD&#39;;&#34;</span> <span class="p">|</span> mysql --user<span class="o">=</span><span class="s1">&#39;root&#39;</span> --password</span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-827b416ea63e09f99a64be3d31a118d8"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<ul>
<li>Переименовать пользователя <code>DB_USER@127.0.0.1</code> в <code>DB_USER@localhost</code>:</li>
</ul>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-1
shortcode-codeblock-bash">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-ed41317f218456332f41f77652f36f64" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="nb">echo</span> <span class="s2">&#34;RENAME USER &#39;DB_USER&#39;@&#39;127.0.0.1&#39; TO &#39;DB_USER&#39;@&#39;localhost&#39;;&#34;</span> <span class="p">|</span> mysql --user<span class="o">=</span><span class="s1">&#39;root&#39;</span> --password</span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-ed41317f218456332f41f77652f36f64"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<ul>
<li>Изменить пароль пользователя <code>DB_USER</code> на <code>DB_PASSWORD_NEW</code>:</li>
</ul>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-2
shortcode-codeblock-bash">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-630024e948040e362d6985ff042b14d8" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="nb">echo</span> <span class="s2">&#34;ALTER USER &#39;DB_USER&#39;@&#39;127.0.0.1&#39; IDENTIFIED BY &#39;DB_PASSWORD_NEW&#39;;&#34;</span> <span class="p">|</span> mysql --user<span class="o">=</span><span class="s1">&#39;root&#39;</span> --password</span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-630024e948040e362d6985ff042b14d8"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<ul>
<li>Удалить пользователя <code>DB_USER</code>:</li>
</ul>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-3
shortcode-codeblock-bash">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-94264c6abef75f9691513dcda7cbeea8" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="nb">echo</span> <span class="s2">&#34;DROP USER &#39;DB_USER&#39;@&#39;127.0.0.1&#39;;&#34;</span> <span class="p">|</span> mysql --user<span class="o">=</span><span class="s1">&#39;root&#39;</span> --password</span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-94264c6abef75f9691513dcda7cbeea8"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<ul>
<li>Дать права <code>CREATE</code>, <code>ALTER</code>, <code>DROP</code>, <code>INSERT</code>, <code>UPDATE</code>, <code>DELETE</code>, <code>SELECT</code>, <code>REFERENCES</code> и <code>RELOAD</code> на базу данных <code>DB_NAME</code> пользователю <code>DB_USER</code>:</li>
</ul>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-4
shortcode-codeblock-bash">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-c18dff8f2c1ceb3f5f543f042a565c4d" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="nb">echo</span> <span class="s2">&#34;GRANT CREATE, ALTER, DROP, INSERT, UPDATE, DELETE, SELECT, REFERENCES, RELOAD on DB_NAME.* TO &#39;DB_USER&#39;@&#39;127.0.0.1&#39;; FLUSH PRIVILEGES;&#34;</span> <span class="p">|</span> mysql --user<span class="o">=</span><span class="s1">&#39;root&#39;</span> --password</span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-c18dff8f2c1ceb3f5f543f042a565c4d"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<ul>
<li>Дать все права на базу данных <code>DB_NAME</code> пользователю <code>DB_USER</code>:</li>
</ul>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-5
shortcode-codeblock-bash">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-563ea0f3f60be53612780a9bc2a02aca" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="nb">echo</span> <span class="s2">&#34;GRANT ALL ON DB_NAME.* TO &#39;DB_USER&#39;@&#39;127.0.01&#39;; FLUSH PRIVILEGES;&#34;</span> <span class="p">|</span> mysql --user<span class="o">=</span><span class="s1">&#39;root&#39;</span> --password</span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-563ea0f3f60be53612780a9bc2a02aca"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<ul>
<li>Дать все права на все базы данных пользователю <code>DB_USER</code>:</li>
</ul>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-6
shortcode-codeblock-bash">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-9b4bce05ce46cf61c5e553f1ec4c1863" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="nb">echo</span> <span class="s2">&#34;GRANT ALL ON *.* TO &#39;DB_USER&#39;@&#39;127.0.01&#39;; FLUSH PRIVILEGES;&#34;</span> <span class="p">|</span> mysql --user<span class="o">=</span><span class="s1">&#39;root&#39;</span> --password</span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-9b4bce05ce46cf61c5e553f1ec4c1863"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<ul>
<li>Отозвать права пользователя <code>DB_USER</code> у базы данных <code>DB_NAME</code>:</li>
</ul>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-7
shortcode-codeblock-bash">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-b5d4785190e30b4da6bf7e663aa6c044" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="nb">echo</span> <span class="s2">&#34;REVOKE ALL ON DB_NAME FROM &#39;DB_USER&#39;@&#39;127.0.0.1&#39;;&#34;</span> <span class="p">|</span> mysql --user<span class="o">=</span><span class="s1">&#39;root&#39;</span> --password</span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-b5d4785190e30b4da6bf7e663aa6c044"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<ul>
<li>Показать права пользователя <code>DB_USER</code>:</li>
</ul>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-8
shortcode-codeblock-bash">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-724358ba34528f14aab25b14aa529055" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="nb">echo</span> <span class="s2">&#34;SHOW GRANTS FOR &#39;DB_USER&#39;@&#39;127.0.0.1&#39;;&#34;</span> <span class="p">|</span> mysql --user<span class="o">=</span><span class="s1">&#39;root&#39;</span> --password</span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-724358ba34528f14aab25b14aa529055"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<h2 id="базы-данных">
  <a class="link-body-emphasis" href="#%d0%b1%d0%b0%d0%b7%d1%8b-%d0%b4%d0%b0%d0%bd%d0%bd%d1%8b%d1%85">Базы данных</a>
</h2><ul>
<li>Создать базу данных <code>DB_NAME</code> с кодировкой <code>utf8mb4</code> и сопоставлением <code>utf8mb4_unicode_ci</code>:</li>
</ul>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-9
shortcode-codeblock-bash">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-81f3465aa5395b59fc1e0bd89ee7379f" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="nb">echo</span> <span class="s2">&#34;CREATE DATABASE IF NOT EXISTS DB_NAME CHARACTER SET &#39;utf8mb4&#39; COLLATE &#39;utf8mb4_unicode_ci&#39;;&#34;</span> <span class="p">|</span> mysql --user<span class="o">=</span><span class="s1">&#39;root&#39;</span> --password</span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-81f3465aa5395b59fc1e0bd89ee7379f"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<ul>
<li>Изменить кодировку и сопоставление базы данных на <code>utf8mb4</code> и <code>utf8mb4_unicode_ci</code> соответственно:</li>
</ul>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-10
shortcode-codeblock-bash">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-6d0f73a008aaa1811fc4c0794e10099a" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="nb">echo</span> <span class="s2">&#34;ALTER DATABASE DB_NAME CHARACTER SET &#39;utf8mb4&#39; COLLATE &#39;utf8mb4_unicode_ci&#39;;&#34;</span> <span class="p">|</span> mysql --user<span class="o">=</span><span class="s1">&#39;root&#39;</span> --password</span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-6d0f73a008aaa1811fc4c0794e10099a"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<ul>
<li>Удалить базу данных <code>DB_NAME</code>:</li>
</ul>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-11
shortcode-codeblock-bash">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-1a038b55efd0c3f3e7690bb0e94d8900" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="nb">echo</span> <span class="s2">&#34;DROP DATABASE IF EXISTS DB_NAME;&#34;</span> <span class="p">|</span> mysql --user<span class="o">=</span><span class="s1">&#39;root&#39;</span> --password</span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-1a038b55efd0c3f3e7690bb0e94d8900"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<h2 id="резервное-копирование">
  <a class="link-body-emphasis" href="#%d1%80%d0%b5%d0%b7%d0%b5%d1%80%d0%b2%d0%bd%d0%be%d0%b5-%d0%ba%d0%be%d0%bf%d0%b8%d1%80%d0%be%d0%b2%d0%b0%d0%bd%d0%b8%d0%b5">Резервное копирование</a>
</h2><ul>
<li>Создать резервную копию базы данных <code>DB_NAME</code> и записать в файл <code>backup.sql.xz</code>:</li>
</ul>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-12
shortcode-codeblock-bash">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-04dc97263b422aeed618cad2e6e0f346" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="nv">f</span><span class="o">=</span><span class="s1">&#39;backup.sql&#39;</span><span class="p">;</span> mysqldump --user<span class="o">=</span><span class="s1">&#39;root&#39;</span> --password --single-transaction --databases <span class="s1">&#39;DB_NAME&#39;</span> --result-file<span class="o">=</span><span class="s2">&#34;</span><span class="si">${</span><span class="nv">f</span><span class="si">}</span><span class="s2">&#34;</span> <span class="o">&amp;&amp;</span> xz <span class="s2">&#34;</span><span class="si">${</span><span class="nv">f</span><span class="si">}</span><span class="s2">&#34;</span> <span class="o">&amp;&amp;</span> rm -f <span class="s2">&#34;</span><span class="si">${</span><span class="nv">f</span><span class="si">}</span><span class="s2">&#34;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-04dc97263b422aeed618cad2e6e0f346"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<h2 id="восстановление">
  <a class="link-body-emphasis" href="#%d0%b2%d0%be%d1%81%d1%81%d1%82%d0%b0%d0%bd%d0%be%d0%b2%d0%bb%d0%b5%d0%bd%d0%b8%d0%b5">Восстановление</a>
</h2><ul>
<li>Удалить старую базу данных <code>DB_NAME</code>:</li>
</ul>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-13
shortcode-codeblock-bash">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-48432a57ee1a2302588347e81b188c8c" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="nb">echo</span> <span class="s2">&#34;DROP DATABASE IF EXISTS DB_NAME;&#34;</span> <span class="p">|</span> mysql --user<span class="o">=</span><span class="s1">&#39;root&#39;</span> --password</span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-48432a57ee1a2302588347e81b188c8c"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<ul>
<li>Создать базу данных <code>DB_NAME</code> с кодировкой <code>utf8mb4</code> и сопоставлением <code>utf8mb4_unicode_ci</code>:</li>
</ul>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-14
shortcode-codeblock-bash">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-1b1ccf6f3000406701bc4feb5cb0d2b2" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="nb">echo</span> <span class="s2">&#34;CREATE DATABASE IF NOT EXISTS DB_NAME CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci;&#34;</span> <span class="p">|</span> mysql --user<span class="o">=</span><span class="s1">&#39;root&#39;</span> --password</span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-1b1ccf6f3000406701bc4feb5cb0d2b2"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<ul>
<li>Дать все права на базу данных <code>DB_NAME</code> пользователю <code>DB_USER</code>:</li>
</ul>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-15
shortcode-codeblock-bash">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-e2076ef2d8e69ad1efc20f11e47f253f" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="nb">echo</span> <span class="s2">&#34;GRANT ALL PRIVILEGES ON DB_NAME.* TO &#39;DB_USER&#39;@&#39;127.0.01&#39;; FLUSH PRIVILEGES;&#34;</span> <span class="p">|</span> mysql --user<span class="o">=</span><span class="s1">&#39;root&#39;</span> --password</span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-e2076ef2d8e69ad1efc20f11e47f253f"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<ul>
<li>Восстановить данные в новую базу данных <code>DB_NAME</code> из файла <code>backup.sql.xz</code>:</li>
</ul>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-16
shortcode-codeblock-bash">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-d6e11192c713a86b661f4db22de36756" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="nv">f</span><span class="o">=</span><span class="s1">&#39;backup.sql&#39;</span><span class="p">;</span> xz -d <span class="s2">&#34;</span><span class="si">${</span><span class="nv">f</span><span class="si">}</span><span class="s2">.xz&#34;</span> <span class="o">&amp;&amp;</span> mysql --user<span class="o">=</span><span class="s1">&#39;root&#39;</span> --password --database<span class="o">=</span><span class="s1">&#39;DB_NAME&#39;</span> &lt; <span class="s2">&#34;</span><span class="si">${</span><span class="nv">f</span><span class="si">}</span><span class="s2">&#34;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-d6e11192c713a86b661f4db22de36756"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>]]></turbo:content></item><item turbo="true"><title>Работа с PostgreSQL</title><link>https://lib.onl/ru/2024/11/3297173e-ad39-574f-9cc6-e4f550096851/</link><pubDate>Thu, 28 Nov 2024 08:57:34 +0000</pubDate><dc:creator>Kai Kimera</dc:creator><category>Linux</category><category>Терминал</category><category>В доработке</category><yandex:related><link url="https://lib.onl/ru/2023/10/54d4e488-9a8f-55ed-8fea-c77d4dba0720/">SQL запросы IP.Board 2.3</link><link url="https://lib.onl/ru/2023/10/06c9d359-31f0-5862-a342-62a21d4eb032/">SQL запросы IP.Board 3.x</link></yandex:related><turbo:extendedHtml>true</turbo:extendedHtml><turbo:source>https://lib.onl/ru/2024/11/3297173e-ad39-574f-9cc6-e4f550096851/</turbo:source><turbo:topic>Работа с PostgreSQL</turbo:topic><turbo:content><![CDATA[<p>Шпаргалка по работе с <span class="shortcode shortcode-tag"><a href="/ru/tags/postgresql/" target="_blank">#PostgreSQL</a></span>.</p>
<h2 id="роли-пользователи">
  <a class="link-body-emphasis" href="#%d1%80%d0%be%d0%bb%d0%b8-%d0%bf%d0%be%d0%bb%d1%8c%d0%b7%d0%be%d0%b2%d0%b0%d1%82%d0%b5%d0%bb%d0%b8">Роли (пользователи)</a>
</h2><ul>
<li>Посмотреть список ролей:</li>
</ul>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-0
shortcode-codeblock-bash">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-59291d1ddd1f02a02d1c4d84d79c2d9c" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">sudo -u <span class="s1">&#39;postgres&#39;</span> psql -c <span class="s1">&#39;\du&#39;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-59291d1ddd1f02a02d1c4d84d79c2d9c"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<ul>
<li>Создать пользователя <code>DB_USER</code> с паролем:</li>
</ul>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-1
shortcode-codeblock-bash">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-071eb3712e42466e2353e7b13ed2b4f9" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">sudo -u <span class="s1">&#39;postgres&#39;</span> createuser --pwprompt <span class="s1">&#39;DB_USER&#39;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-071eb3712e42466e2353e7b13ed2b4f9"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<ul>
<li>Удалить пользователя <code>DB_USER</code>:</li>
</ul>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-2
shortcode-codeblock-bash">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-a6e3aa6b4d58f649e8c249f00fad5c27" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">sudo -u <span class="s1">&#39;postgres&#39;</span> dropuser <span class="s1">&#39;DB_USER&#39;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-a6e3aa6b4d58f649e8c249f00fad5c27"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<h2 id="базы-данных">
  <a class="link-body-emphasis" href="#%d0%b1%d0%b0%d0%b7%d1%8b-%d0%b4%d0%b0%d0%bd%d0%bd%d1%8b%d1%85">Базы данных</a>
</h2><ul>
<li>Посмотреть список баз данных:</li>
</ul>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-3
shortcode-codeblock-bash">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-c2b70b31d55f88f3069c3b4ecfdac2c1" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">sudo -u <span class="s1">&#39;postgres&#39;</span> psql -c <span class="s1">&#39;\l&#39;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-c2b70b31d55f88f3069c3b4ecfdac2c1"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<ul>
<li>Посмотреть список таблиц схемы <code>public</code> в базе данных <code>DB_NAME</code>:</li>
</ul>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-4
shortcode-codeblock-bash">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-047ca626c94e50be7da387e80f365a30" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">sudo -u <span class="s1">&#39;postgres&#39;</span> psql -c <span class="s1">&#39;\c DB_NAME&#39;</span> -c <span class="s1">&#39;\dt&#39;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-047ca626c94e50be7da387e80f365a30"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<ul>
<li>Посмотреть список таблиц всех схем в базе данных <code>DB_NAME</code>:</li>
</ul>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-5
shortcode-codeblock-bash">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-0a3e5788a45e488d948501175557c198" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">sudo -u <span class="s1">&#39;postgres&#39;</span> psql -c <span class="s1">&#39;\c DB_NAME&#39;</span> -c <span class="s1">&#39;\dt *.*&#39;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-0a3e5788a45e488d948501175557c198"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<ul>
<li>Создать базу данных <code>DB_NAME</code> с владельцем <code>DB_USER</code>:</li>
</ul>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-6
shortcode-codeblock-bash">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-3d03264340bfb803b5b84c9b09bc36cc" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">sudo -u <span class="s1">&#39;postgres&#39;</span> createdb --owner<span class="o">=</span><span class="s1">&#39;DB_USER&#39;</span> <span class="s1">&#39;DB_NAME&#39;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-3d03264340bfb803b5b84c9b09bc36cc"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<ul>
<li>Создать базу данных <code>DB_NAME</code> из шаблона <code>template0</code> с владельцем <code>DB_USER</code>:</li>
</ul>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-7
shortcode-codeblock-bash">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-72872cc27b75c23dd68730d40846264e" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">sudo -u <span class="s1">&#39;postgres&#39;</span> createdb --owner<span class="o">=</span><span class="s1">&#39;DB_USER&#39;</span> --template<span class="o">=</span><span class="s1">&#39;template0&#39;</span> <span class="s1">&#39;DB_NAME&#39;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-72872cc27b75c23dd68730d40846264e"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<ul>
<li>Удалить базу данных <code>DB_NAME</code>:</li>
</ul>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-8
shortcode-codeblock-bash">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-d5788a2b58ca7a95a69cceca26085e78" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">sudo -u <span class="s1">&#39;postgres&#39;</span> dropdb <span class="s1">&#39;DB_NAME&#39;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-d5788a2b58ca7a95a69cceca26085e78"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<h2 id="резервное-копирование">
  <a class="link-body-emphasis" href="#%d1%80%d0%b5%d0%b7%d0%b5%d1%80%d0%b2%d0%bd%d0%be%d0%b5-%d0%ba%d0%be%d0%bf%d0%b8%d1%80%d0%be%d0%b2%d0%b0%d0%bd%d0%b8%d0%b5">Резервное копирование</a>
</h2>



    












    
    


<div class="shortcode shortcode-alert">
  <div class="alert alert-danger d-flex overflow-hidden" role="alert">
    <div class="flex-shrink-0 align-self-center">
      <i class="fas fa-circle-radiation fa-fw fa-2x"></i>
    </div>
    <div class="flex-grow-1 ms-3 overflow-hidden">
        <p>Использовать перенаправление для резервного копирования и восстановления базы данных не рекомендуется. Резервная копия базы данных может оказаться повреждённой.</p>

    </div>
  </div>
</div>

<ul>
<li>Создать резервную копию базы данных <code>DB_NAME</code> при помощи пользователя <code>DB_USER</code> и записать в файл <code>backup.sql.xz</code>:</li>
</ul>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-9
shortcode-codeblock-bash">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-2b8e2414b0aa54db782bcb1d668f9276" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="nv">f</span><span class="o">=</span><span class="s1">&#39;backup.sql&#39;</span><span class="p">;</span> pg_dump --host<span class="o">=</span><span class="s1">&#39;127.0.0.1&#39;</span> --port<span class="o">=</span><span class="s1">&#39;5432&#39;</span> --username<span class="o">=</span><span class="s1">&#39;DB_USER&#39;</span> --password --dbname<span class="o">=</span><span class="s1">&#39;DB_NAME&#39;</span> --file<span class="o">=</span><span class="s2">&#34;</span><span class="si">${</span><span class="nv">f</span><span class="si">}</span><span class="s2">&#34;</span> <span class="o">&amp;&amp;</span> xz <span class="s2">&#34;</span><span class="si">${</span><span class="nv">f</span><span class="si">}</span><span class="s2">&#34;</span> <span class="o">&amp;&amp;</span> rm -f <span class="s2">&#34;</span><span class="si">${</span><span class="nv">f</span><span class="si">}</span><span class="s2">&#34;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-2b8e2414b0aa54db782bcb1d668f9276"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<h2 id="восстановление">
  <a class="link-body-emphasis" href="#%d0%b2%d0%be%d1%81%d1%81%d1%82%d0%b0%d0%bd%d0%be%d0%b2%d0%bb%d0%b5%d0%bd%d0%b8%d0%b5">Восстановление</a>
</h2><ul>
<li>Удалить старую базу данных <code>DB_NAME</code> (при необходимости):</li>
</ul>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-10
shortcode-codeblock-bash">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-429d284efe47a42e862e56b628a27c4b" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">sudo -u <span class="s1">&#39;postgres&#39;</span> dropdb <span class="s1">&#39;DB_NAME&#39;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-429d284efe47a42e862e56b628a27c4b"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<ul>
<li>Создать новую базу данных <code>DB_NAME</code> с владельцем <code>DB_USER</code>:</li>
</ul>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-11
shortcode-codeblock-bash">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-ad4b78b93be0c415b747b6a21a8aec46" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">sudo -u <span class="s1">&#39;postgres&#39;</span> createdb --owner<span class="o">=</span><span class="s1">&#39;DB_USER&#39;</span> <span class="s1">&#39;DB_NAME&#39;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-ad4b78b93be0c415b747b6a21a8aec46"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<ul>
<li>Восстановить данные в новую базу данных <code>DB_NAME</code> из файла <code>backup.sql.xz</code>:</li>
</ul>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-12
shortcode-codeblock-bash">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-5832d65d02070736d1c9cdc37ec649e2" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="nv">f</span><span class="o">=</span><span class="s1">&#39;backup.sql&#39;</span><span class="p">;</span> xz -d <span class="s2">&#34;</span><span class="si">${</span><span class="nv">f</span><span class="si">}</span><span class="s2">.xz&#34;</span> <span class="o">&amp;&amp;</span> sudo -u <span class="s1">&#39;postgres&#39;</span> psql --dbname<span class="o">=</span><span class="s1">&#39;DB_NAME&#39;</span> --file<span class="o">=</span><span class="s2">&#34;</span><span class="si">${</span><span class="nv">f</span><span class="si">}</span><span class="s2">&#34;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-5832d65d02070736d1c9cdc37ec649e2"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<h2 id="очистка-и-анализ">
  <a class="link-body-emphasis" href="#%d0%be%d1%87%d0%b8%d1%81%d1%82%d0%ba%d0%b0-%d0%b8-%d0%b0%d0%bd%d0%b0%d0%bb%d0%b8%d0%b7">Очистка и анализ</a>
</h2><ul>
<li>Выполнить очистку и собрать статистику базы данных <code>DB_NAME</code>:</li>
</ul>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-13
shortcode-codeblock-bash">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-f786f18ea158c24b3fec6dc20ad18b62" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">sudo -u <span class="s1">&#39;postgres&#39;</span> vacuumdb --dbname<span class="o">=</span><span class="s1">&#39;DB_NAME&#39;</span> --analyze</span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-f786f18ea158c24b3fec6dc20ad18b62"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<ul>
<li>Выполнить очистку и собрать статистику всех баз данных:</li>
</ul>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-14
shortcode-codeblock-bash">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-e0922f81c724974dd14da9935b85953b" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">sudo -u <span class="s1">&#39;postgres&#39;</span> vacuumdb --all --analyze</span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-e0922f81c724974dd14da9935b85953b"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<h2 id="обновление-кластера">
  <a class="link-body-emphasis" href="#%d0%be%d0%b1%d0%bd%d0%be%d0%b2%d0%bb%d0%b5%d0%bd%d0%b8%d0%b5-%d0%ba%d0%bb%d0%b0%d1%81%d1%82%d0%b5%d1%80%d0%b0">Обновление кластера</a>
</h2>



    








    
    






<div class="shortcode shortcode-alert">
  <div class="alert alert-warning d-flex overflow-hidden" role="alert">
    <div class="flex-shrink-0 align-self-center">
      <i class="fas fa-exclamation-triangle fa-fw fa-2x"></i>
    </div>
    <div class="flex-grow-1 ms-3 overflow-hidden">
        <p>В данном примере рассматривается сценарий обновления PostgreSQL <strong>16</strong> до PostgreSQL <strong>17</strong> на ОС <strong>Debian</strong>.</p>

    </div>
  </div>
</div>

<ul>
<li>Посмотреть список экземпляров PostgreSQL в кластере:</li>
</ul>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-15
shortcode-codeblock-bash">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-88752ab35329f3a5ae967be6410961d9" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">pg_lsclusters</span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-88752ab35329f3a5ae967be6410961d9"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<ul>
<li>Установить новую версию PostgreSQL 17:</li>
</ul>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-16
shortcode-codeblock-bash">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-45f1deaff364dafdbf8a824a6360e2c9" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">apt install postgresql-17</span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-45f1deaff364dafdbf8a824a6360e2c9"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>






  <div class="accordion mb-3 shortcode shortcode-accordion-item">
    <div class="accordion-item">
      <div class="accordion-header">
        <a class="accordion-button collapsed" href="#" role="button"
           data-bs-toggle="collapse" data-bs-target="#sc-b0ed2c2e2929bb2abb541b5790fa4780"
           aria-expanded="false" aria-controls="sc-b0ed2c2e2929bb2abb541b5790fa4780" aria-label="TimescaleDB">
            TimescaleDB
        </a>
      </div>
      <div class="accordion-collapse collapse" id="sc-b0ed2c2e2929bb2abb541b5790fa4780">
        <div class="accordion-body">
            <ul>
<li>Установить новую версию TimescaleDB для PostgreSQL 17:</li>
</ul>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-0
shortcode-codeblock-bash">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-9b1111ed55664d726749b79497e70826" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">apt install timescaledb-2-postgresql-17 timescaledb-2-loader-postgresql-17</span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-9b1111ed55664d726749b79497e70826"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<ul>
<li>Импортировать настройки TimescaleDB в конфигурацию PostgreSQL 17:</li>
</ul>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-1
shortcode-codeblock-bash">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-5450a861a82e1c682441caa425ec0c0b" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">timescaledb-tune --quiet --yes <span class="o">&amp;&amp;</span> systemctl restart postgresql@17-main.service</span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-5450a861a82e1c682441caa425ec0c0b"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>



        </div>
      </div>
    </div>
  </div>


<ul>
<li>Остановить новую версию экземпляра PostgreSQL 17 в кластере:</li>
</ul>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-17
shortcode-codeblock-bash">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-fb4949e87e26242efb6d0448f90b8e1d" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">pg_dropcluster --stop <span class="m">17</span> main</span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-fb4949e87e26242efb6d0448f90b8e1d"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<ul>
<li>Запустить обновление версии экземпляра PostgreSQL 16 до PostgreSQL 17 в кластере:</li>
</ul>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-18
shortcode-codeblock-bash">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-7f45b53c417822daed80dc87e9411ba8" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">pg_upgradecluster <span class="m">16</span> main</span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-7f45b53c417822daed80dc87e9411ba8"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<ul>
<li>Удалить версию экземпляра PostgreSQL 16 из кластера:</li>
</ul>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-19
shortcode-codeblock-bash">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-c1495381aff3a6cb5c0a48392e2fb667" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">pg_dropcluster <span class="m">16</span> main</span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-c1495381aff3a6cb5c0a48392e2fb667"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<ul>
<li>Посмотреть установленные пакеты для PostgreSQL 16 и удалить ненужные:</li>
</ul>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-20
shortcode-codeblock-bash">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-3e4bad08da7d7f718c2a9dd0534af8fe" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">apt list --installed <span class="p">|</span> grep <span class="s1">&#39;postgresql.*-16&#39;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-3e4bad08da7d7f718c2a9dd0534af8fe"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>]]></turbo:content></item><item turbo="true"><title>MikroTik: Сертификат Let's Encrypt</title><link>https://lib.onl/ru/2024/11/f892bebc-3ecd-518a-a948-27eed31649da/</link><pubDate>Thu, 21 Nov 2024 08:05:43 +0000</pubDate><dc:creator>Kai Kimera</dc:creator><category>Скрипты</category><category>Сеть</category><category>Безопасность</category><yandex:related><link url="https://lib.onl/ru/2024/04/326618af-d950-5001-8114-57c66bb8a5af/">MikroTik: Туннель GRE/IPsec (Site-to-Site)</link><link url="https://lib.onl/ru/2024/04/146e83d5-f571-5273-9a29-172bf5dc10fe/">MikroTik: Туннель WireGuard (Site-to-Site) + OSPF</link><link url="https://lib.onl/ru/2024/03/54a2b39f-38b4-5f0c-9b54-310f853da38f/">MikroTik: Туннель IPsec (Site-to-Site)</link><link url="https://lib.onl/ru/2023/12/0f3478b3-9fde-59aa-a424-ff160431fa35/">MikroTik: Базовая настройка</link><link url="https://lib.onl/ru/2023/10/cc13623b-970c-5950-867e-168f9ba9025a/">MikroTik: Добавление корневых сертификатов в RouterOS</link><link url="https://lib.onl/ru/2020/07/ff2ae66e-8e14-5c4a-baa6-0cd2e59f6517/">MikroTik и CloudFlare: Динамический IP для домена</link><link url="https://lib.onl/ru/2024/11/1f5924fa-7a3d-574e-a15d-8a41208fe10d/">Автоматическое получение и обновление сертификатов Let's Encrypt</link><link url="https://lib.onl/ru/2023/12/b6c7c5cd-1b0d-5fcd-8dd2-f28f87a5064c/">MikroTik: Настройка DoH</link></yandex:related><turbo:extendedHtml>true</turbo:extendedHtml><turbo:source>https://lib.onl/ru/2024/11/f892bebc-3ecd-518a-a948-27eed31649da/</turbo:source><turbo:topic>MikroTik: Сертификат Let's Encrypt</turbo:topic><turbo:content><![CDATA[<p>Алгоритм получения сертификата Let&rsquo;s Encrypt и последующего его продления при помощи скрипта.</p>
<h2 id="получение-сертификата">
  <a class="link-body-emphasis" href="#%d0%bf%d0%be%d0%bb%d1%83%d1%87%d0%b5%d0%bd%d0%b8%d0%b5-%d1%81%d0%b5%d1%80%d1%82%d0%b8%d1%84%d0%b8%d0%ba%d0%b0%d1%82%d0%b0">Получение сертификата</a>
</h2><ul>
<li>Создать правило в брандмауэре, которое будет разрешать обращение к порту <code>80</code> IP-адресов из списка <code>acme</code>:</li>
</ul>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-0
shortcode-codeblock-plaintext">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-0b687cb37f177507e9c8529adb73175b" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-plaintext" data-lang="plaintext"><span class="line"><span class="cl">/ip firewall filter add action=accept chain=input dst-port=80 protocol=tcp src-address-list=acme comment=&#34;[ROS] ACME&#34;</span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-0b687cb37f177507e9c8529adb73175b"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<ul>
<li>Включить сервис <code>WWW</code>:</li>
</ul>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-1
shortcode-codeblock-plaintext">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-0363d90cdb8fcec4d4c16c018832613d" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-plaintext" data-lang="plaintext"><span class="line"><span class="cl">/ip service enable www</span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-0363d90cdb8fcec4d4c16c018832613d"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<ul>
<li>Добавить адрес <code>0.0.0.0/0</code> в адрес-лист <code>acme</code> на 2 минуты:</li>
</ul>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-2
shortcode-codeblock-plaintext">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-f6d16d42026522e69590580dc9e87aad" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-plaintext" data-lang="plaintext"><span class="line"><span class="cl">/ip firewall address-list add list=acme address=0.0.0.0/0 timeout=00:02:00 comment=&#34;[ROS] ACME running...&#34;</span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-f6d16d42026522e69590580dc9e87aad"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<ul>
<li>Запустить получение сертификата для домена <code>sub.example.com</code>:</li>
</ul>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-3
shortcode-codeblock-plaintext">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-3c5ee42a27956326c085844460833e95" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-plaintext" data-lang="plaintext"><span class="line"><span class="cl">/certificate enable-ssl-certificate dns-name=sub.example.com</span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-3c5ee42a27956326c085844460833e95"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<ul>
<li>Отключить сервис <code>WWW</code>:</li>
</ul>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-4
shortcode-codeblock-plaintext">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-82af1df11e612aa1fdb62b931a310dbc" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-plaintext" data-lang="plaintext"><span class="line"><span class="cl">/ip service disable www</span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-82af1df11e612aa1fdb62b931a310dbc"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<h2 id="скрипт">
  <a class="link-body-emphasis" href="#%d1%81%d0%ba%d1%80%d0%b8%d0%bf%d1%82">Скрипт</a>
</h2><p>Сертификат получен, но по условиям Let&rsquo;s Encrypt, его необходимо продлевать каждые 90 дней. Этим занимается специальный скрип, который будет контролировать количество дней до истечения действия сертификата и перезапускать задачу на получения нового.</p>
<h3 id="приложение">
  <a class="link-body-emphasis" href="#%d0%bf%d1%80%d0%b8%d0%bb%d0%be%d0%b6%d0%b5%d0%bd%d0%b8%d0%b5">Приложение</a>
</h3>
    

    
        
            
            <div class="shortcode shortcode-file mb-3">
              <div class="card overflow-hidden" data-bs-theme="dark">
                <div class="card-header">
                  <div class="d-flex align-items-center">
                    <div class="flex-shrink-0">
                      <i class="far fa-file-code fa-fw"></i>
                    </div>
                    <div class="flex-grow-1 mx-2 text-truncate">
                      <code>ros.acme.rsc</code>
                    </div>
                    <div class="flex-shrink-0">
                      <ul class="list-inline mb-0">
                        <li class="list-inline-item" title='Копировать'>
                          <a class="text-body" href="#"
                             data-fn="clipboard" data-clipboard-target="#cp-cf5754175033a1235bf9a6cef7ac8b6b"
                             role="button" aria-label='Копировать'>
                            <i class="fas fa-copy fa-fw"></i>
                          </a>
                        </li>
                        <li class="list-inline-item" title='Скачать'>
                          <a class="text-body" href="/ru/2024/11/f892bebc-3ecd-518a-a948-27eed31649da/ros.acme.rsc" download
                             role="button" aria-label='Скачать'>
                            <i class="fas fa-download fa-fw"></i>
                          </a>
                        </li>
                        <li class="list-inline-item" title='Открыть'>
                          <a class="text-body" href="/ru/2024/11/f892bebc-3ecd-518a-a948-27eed31649da/ros.acme.rsc" target="_blank"
                             role="button" aria-label='Открыть'>
                            <i class="fas fa-arrow-up-right-from-square fa-fw"></i>
                          </a>
                        </li>
                      </ul>
                    </div>
                  </div>
                </div>
                <div class="card-body p-0 overflow-auto" id="cp-cf5754175033a1235bf9a6cef7ac8b6b">
                    
                    <div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-text" data-lang="text"><span class="line"><span class="cl"># LET&#39;S ENCRYPT
</span></span><span class="line"><span class="cl"># -------------------------------------------------------------------------------------------------------------------- #
</span></span><span class="line"><span class="cl"># @package    RouterOS
</span></span><span class="line"><span class="cl"># @author     Kai Kimera &lt;mail@kai.kim&gt;
</span></span><span class="line"><span class="cl"># @copyright  2024 Library Online
</span></span><span class="line"><span class="cl"># @license    MIT
</span></span><span class="line"><span class="cl"># @version    0.1.0
</span></span><span class="line"><span class="cl"># @policy     read, write, test
</span></span><span class="line"><span class="cl"># @schedule:  1d 00:00:00
</span></span><span class="line"><span class="cl"># @link       https://lib.onl/ru/2024/11/f892bebc-3ecd-518a-a948-27eed31649da/
</span></span><span class="line"><span class="cl"># -------------------------------------------------------------------------------------------------------------------- #
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">:local crtApi &#34;https://acme-v02.api.letsencrypt.org/directory&#34;
</span></span><span class="line"><span class="cl">:local crtDays 30d
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"># -------------------------------------------------------------------------------------------------------------------- #
</span></span><span class="line"><span class="cl"># -----------------------------------------------------&lt; SCRIPT &gt;----------------------------------------------------- #
</span></span><span class="line"><span class="cl"># -------------------------------------------------------------------------------------------------------------------- #
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">:local crtDomain
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">/certificate
</span></span><span class="line"><span class="cl">:foreach i in=[find where issuer~&#34;Let&#39;s Encrypt&#34;] do={
</span></span><span class="line"><span class="cl">  :if (([get $i expires-after] &lt; $crtDays) || [get $i expired]) do={
</span></span><span class="line"><span class="cl">    :set crtDomain [get $i common-name]
</span></span><span class="line"><span class="cl">    :do { remove $i } on-error={ :log error &#34;ACME: $crtDomain not found!&#34; }
</span></span><span class="line"><span class="cl">    :do {
</span></span><span class="line"><span class="cl">      :log info &#34;ACME: $crtDomain renewal starting...&#34;
</span></span><span class="line"><span class="cl">      /ip service enable www
</span></span><span class="line"><span class="cl">      /ip firewall address-list add list=acme address=0.0.0.0/0 timeout=00:02:00 comment=&#34;[ROS] ACME running...&#34;
</span></span><span class="line"><span class="cl">      /certificate enable-ssl-certificate directory-url=&#34;$crtApi&#34; dns-name=$crtDomain; :delay 60s
</span></span><span class="line"><span class="cl">      /ip service disable www
</span></span><span class="line"><span class="cl">      /ip service set api-ssl certificate=$crtDomain
</span></span><span class="line"><span class="cl">      /ip service set www-ssl certificate=$crtDomain
</span></span><span class="line"><span class="cl">      /interface sstp-server server set certificate=$crtDomain
</span></span><span class="line"><span class="cl">      :log info &#34;ACME: $crtDomain renewal completed!&#34;
</span></span><span class="line"><span class="cl">    } on-error={ :log error &#34;ACME: $crtDomain renewal failed!&#34; }
</span></span><span class="line"><span class="cl">  }
</span></span><span class="line"><span class="cl">}</span></span></code></pre></td></tr></table>
</div>
</div>
                </div>
              </div>
            </div>
        
    
<h4 id="параметры">
  <a class="link-body-emphasis" href="#%d0%bf%d0%b0%d1%80%d0%b0%d0%bc%d0%b5%d1%82%d1%80%d1%8b">Параметры</a>
</h4><ul>
<li><code>crtApi</code> - ссылка на ACME API. Принимает следующие значения:
<ul>
<li><code>https://acme-staging-v02.api.letsencrypt.org/directory</code> - API для тестирования заказа сертификата.</li>
<li><code>https://acme-v02.api.letsencrypt.org/directory</code> - основное API для заказа сертификата.</li>
</ul>
</li>
<li><code>crtDays</code> - количество дней до окончания срока действия сертификата.</li>
</ul>
<h3 id="установка">
  <a class="link-body-emphasis" href="#%d1%83%d1%81%d1%82%d0%b0%d0%bd%d0%be%d0%b2%d0%ba%d0%b0">Установка</a>
</h3><p>После настройки скрипта, его нужно добавить в репозиторий скриптов <span class="shortcode shortcode-tag"><a href="/ru/tags/routeros/" target="_blank">#RouterOS</a></span>. Находится репозиторий в System / Scripts. При добавлении скрипта, необходимо выбрать политики <code>read</code>, <code>write</code>, <code>test</code>.</p>
<h3 id="планировщик">
  <a class="link-body-emphasis" href="#%d0%bf%d0%bb%d0%b0%d0%bd%d0%b8%d1%80%d0%be%d0%b2%d1%89%d0%b8%d0%ba">Планировщик</a>
</h3><p>Скрипт должен переодически запускаться для проверки сертификатов. В этом поможет планировщик <span class="shortcode shortcode-tag"><a href="/ru/tags/routeros/" target="_blank">#RouterOS</a></span>. Заходим в System / Scheduler и создаём задачу с политиками <code>read</code>, <code>write</code>, <code>test</code>. В поле <strong>On Event</strong> вписываем точное название скрипта, ранее добавленного в репозиторий <span class="shortcode shortcode-tag"><a href="/ru/tags/routeros/" target="_blank">#RouterOS</a></span>.</p>]]></turbo:content></item><item turbo="true"><title>Как отключить ECH для домена за CloudFlare?</title><link>https://lib.onl/ru/2024/11/7cd2eb8b-4695-5737-8a9b-fa7b3a903562/</link><pubDate>Tue, 12 Nov 2024 18:48:59 +0000</pubDate><dc:creator>Kai Kimera</dc:creator><category>Ech</category><category>Cloudflare</category><category>Tls</category><category>Curl</category><category>Json</category><yandex:related><link url="https://lib.onl/ru/2023/10/3c4c6709-69a6-54be-9404-e4b7ede6ab90/">Как при помощи CloudFlare заменить в URL одну директорию на другую?</link></yandex:related><turbo:extendedHtml>true</turbo:extendedHtml><turbo:source>https://lib.onl/ru/2024/11/7cd2eb8b-4695-5737-8a9b-fa7b3a903562/</turbo:source><turbo:topic>Как отключить ECH для домена за CloudFlare?</turbo:topic><turbo:content>&lt;p>РКН начал блокировать технологию &lt;strong>ECH (Encrypted Client Hello)&lt;/strong>, соответственно, и домены, использующие эту технологию. Как можно её отключить?&lt;/p></turbo:content></item><item turbo="true"><title>Автоматическое получение и обновление сертификатов Let's Encrypt</title><link>https://lib.onl/ru/2024/11/1f5924fa-7a3d-574e-a15d-8a41208fe10d/</link><pubDate>Tue, 12 Nov 2024 11:59:17 +0000</pubDate><dc:creator>Kai Kimera</dc:creator><category>Скрипты</category><category>Безопасность</category><category>Терминал</category><category>Linux</category><yandex:related><link url="https://lib.onl/ru/2024/11/45ffdbeb-37ec-5ed2-b3cd-347df5e3d07b/">Jigasi: "The following addresses failed: RFC 6120 A/AAAA Endpoint"</link><link url="https://lib.onl/ru/2024/10/0a633c87-935c-54ba-bedf-9c95152b6b51/">Автоматическое закрытие конференц-комнаты в Asterisk</link><link url="https://lib.onl/ru/2024/06/b29b331d-ac93-5193-83ef-beab5a0f8dff/">Linux: Пользователи и группы</link><link url="https://lib.onl/ru/2024/03/6c7a038f-f41e-5a45-a285-b99fdacf82d4/">Работа с ZFS</link></yandex:related><turbo:extendedHtml>true</turbo:extendedHtml><turbo:source>https://lib.onl/ru/2024/11/1f5924fa-7a3d-574e-a15d-8a41208fe10d/</turbo:source><turbo:topic>Автоматическое получение и обновление сертификатов Let's Encrypt</turbo:topic><turbo:content><![CDATA[<p>Скрипт для автоматизации массового получения и обновления сертификатов. Базируется на библиотеке <span class="shortcode shortcode-tag"><a href="/ru/tags/lego/" target="_blank">#LeGo</a></span>.</p>
<h2 id="установка">
  <a class="link-body-emphasis" href="#%d1%83%d1%81%d1%82%d0%b0%d0%bd%d0%be%d0%b2%d0%ba%d0%b0">Установка</a>
</h2><ul>
<li>Скопировать файлы <code>app.acme.lego.conf</code>, <code>app.acme.lego.example.com.conf</code> и <code>app.acme.lego.sh</code> в директорию <code>/root/apps/acme/</code>.</li>
<li>Указать бит выполнения для <code>*.sh</code> скриптов: <code>chmod +x /root/apps/acme/*.sh</code>.</li>
<li>Скопировать файл <code>app_acme_lego</code> в директорию <code>/etc/cron.d/</code>.</li>
<li>Настроить параметры скрипта в файлах <code>app.acme.lego.conf</code> и <code>app.acme.lego.example.com.conf</code>.</li>
<li>При заказе первого сертификата для домена, необходимо выполнить следующую команду:</li>
</ul>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-0
shortcode-codeblock-bash">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-54a512f1fb1c714be5bef0fa9a8e3d82" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">~/apps/acme/app.acme.lego.sh <span class="s1">&#39;example.com&#39;</span> <span class="s1">&#39;run&#39;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-54a512f1fb1c714be5bef0fa9a8e3d82"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<h2 id="скрипт">
  <a class="link-body-emphasis" href="#%d1%81%d0%ba%d1%80%d0%b8%d0%bf%d1%82">Скрипт</a>
</h2><p>Скрипт состоит из 4-х компонентов:</p>
<ul>
<li>Файл с основными настройками.</li>
<li>Файл с настройками домена.</li>
<li>Приложение.</li>
<li>Задача для CRON.</li>
</ul>
<h3 id="общая-конфигурация">
  <a class="link-body-emphasis" href="#%d0%be%d0%b1%d1%89%d0%b0%d1%8f-%d0%ba%d0%be%d0%bd%d1%84%d0%b8%d0%b3%d1%83%d1%80%d0%b0%d1%86%d0%b8%d1%8f">Общая конфигурация</a>
</h3><p>Файл в общими параметрами скрипта. Этот файл подключается первым и содержит в себе общие параметры для всех доменов. Общие параметры можно переопределять файлом конфигурации домена.</p>

    

    
        
            
            <div class="shortcode shortcode-file mb-3">
              <div class="card overflow-hidden" data-bs-theme="dark">
                <div class="card-header">
                  <div class="d-flex align-items-center">
                    <div class="flex-shrink-0">
                      <i class="far fa-file-code fa-fw"></i>
                    </div>
                    <div class="flex-grow-1 mx-2 text-truncate">
                      <code>app.acme.lego.conf</code>
                    </div>
                    <div class="flex-shrink-0">
                      <ul class="list-inline mb-0">
                        <li class="list-inline-item" title='Копировать'>
                          <a class="text-body" href="#"
                             data-fn="clipboard" data-clipboard-target="#cp-5af5fff6c1d854a3afa72e91bc4de903"
                             role="button" aria-label='Копировать'>
                            <i class="fas fa-copy fa-fw"></i>
                          </a>
                        </li>
                        <li class="list-inline-item" title='Скачать'>
                          <a class="text-body" href="/ru/2024/11/1f5924fa-7a3d-574e-a15d-8a41208fe10d/app.acme.lego.conf" download
                             role="button" aria-label='Скачать'>
                            <i class="fas fa-download fa-fw"></i>
                          </a>
                        </li>
                        <li class="list-inline-item" title='Открыть'>
                          <a class="text-body" href="/ru/2024/11/1f5924fa-7a3d-574e-a15d-8a41208fe10d/app.acme.lego.conf" target="_blank"
                             role="button" aria-label='Открыть'>
                            <i class="fas fa-arrow-up-right-from-square fa-fw"></i>
                          </a>
                        </li>
                      </ul>
                    </div>
                  </div>
                </div>
                <div class="card-body p-0 overflow-auto" id="cp-5af5fff6c1d854a3afa72e91bc4de903">
                    
                    <div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="nv">ACME_SERVER</span><span class="o">=</span><span class="s1">&#39;https://acme-staging-v02.api.letsencrypt.org/directory&#39;</span>
</span></span><span class="line"><span class="cl"><span class="c1"># ACME_SERVER=&#39;https://acme-v02.api.letsencrypt.org/directory&#39;</span>
</span></span><span class="line"><span class="cl"><span class="nv">ACME_EMAIL</span><span class="o">=</span><span class="s1">&#39;mail@example.com&#39;</span>
</span></span><span class="line"><span class="cl"><span class="nv">ACME_PATH</span><span class="o">=</span><span class="s1">&#39;/etc/ssl/acme&#39;</span>
</span></span><span class="line"><span class="cl"><span class="nv">ACME_METHOD</span><span class="o">=</span><span class="s1">&#39;http&#39;</span>
</span></span><span class="line"><span class="cl"><span class="nv">ACME_HTTP_PORT</span><span class="o">=</span><span class="s1">&#39;:80&#39;</span>
</span></span><span class="line"><span class="cl"><span class="nv">ACME_HTTP_PROXY_HEADER</span><span class="o">=</span><span class="s1">&#39;Host&#39;</span>
</span></span><span class="line"><span class="cl"><span class="nv">ACME_TLS_PORT</span><span class="o">=</span><span class="s1">&#39;:443&#39;</span>
</span></span><span class="line"><span class="cl"><span class="nv">ACME_KEY_TYPE</span><span class="o">=</span><span class="s1">&#39;ec256&#39;</span>
</span></span><span class="line"><span class="cl"><span class="nv">ACME_PFX_PASSWORD</span><span class="o">=</span><span class="s1">&#39;pa$$word&#39;</span>
</span></span><span class="line"><span class="cl"><span class="nv">ACME_PFX_FORMAT</span><span class="o">=</span><span class="s1">&#39;RC2&#39;</span>
</span></span><span class="line"><span class="cl"><span class="nv">ACME_CRT_TIMEOUT</span><span class="o">=</span><span class="s1">&#39;30&#39;</span>
</span></span><span class="line"><span class="cl"><span class="nv">ACME_DAYS</span><span class="o">=</span><span class="s1">&#39;30&#39;</span>
</span></span><span class="line"><span class="cl"><span class="nv">ACME_SERVICES</span><span class="o">=(</span>
</span></span><span class="line"><span class="cl">  <span class="s1">&#39;angie.service&#39;</span>
</span></span><span class="line"><span class="cl">  <span class="s1">&#39;apache2.service&#39;</span>
</span></span><span class="line"><span class="cl">  <span class="s1">&#39;nginx.service&#39;</span>
</span></span><span class="line"><span class="cl">  <span class="s1">&#39;postfix@-.service&#39;</span>
</span></span><span class="line"><span class="cl">  <span class="s1">&#39;prosody.service&#39;</span>
</span></span><span class="line"><span class="cl"><span class="o">)</span>
</span></span><span class="line"><span class="cl"><span class="nv">ACME_DNS_PROVIDER</span><span class="o">=</span><span class="s1">&#39;cloudflare&#39;</span>
</span></span><span class="line"><span class="cl"><span class="nv">ACME_DNS_RESOLVERS</span><span class="o">=(</span>
</span></span><span class="line"><span class="cl">  <span class="s1">&#39;8.8.8.8&#39;</span>
</span></span><span class="line"><span class="cl">  <span class="s1">&#39;8.8.4.4&#39;</span>
</span></span><span class="line"><span class="cl"><span class="o">)</span>
</span></span><span class="line"><span class="cl"><span class="nb">export</span> <span class="nv">CLOUDFLARE_API_EMAIL</span><span class="o">=</span><span class="s1">&#39;mail@example.com&#39;</span>
</span></span><span class="line"><span class="cl"><span class="nb">export</span> <span class="nv">CLOUDFLARE_API_KEY</span><span class="o">=</span><span class="s1">&#39;&#39;</span>
</span></span><span class="line"><span class="cl"><span class="nb">export</span> <span class="nv">CLOUDFLARE_DNS_API_TOKEN</span><span class="o">=</span><span class="s1">&#39;&#39;</span>
</span></span><span class="line"><span class="cl"><span class="nb">export</span> <span class="nv">CLOUDFLARE_ZONE_API_TOKEN</span><span class="o">=</span><span class="s1">&#39;&#39;</span></span></span></code></pre></td></tr></table>
</div>
</div>
                </div>
              </div>
            </div>
        
    
<h4 id="параметры">
  <a class="link-body-emphasis" href="#%d0%bf%d0%b0%d1%80%d0%b0%d0%bc%d0%b5%d1%82%d1%80%d1%8b">Параметры</a>
</h4><ul>
<li><code>ACME_SERVER</code> - сервер Let&rsquo;s Encrypt для заказа сертификата. По умолчанию указан тестовый сервер. Может принимать следующие значения:
<ul>
<li><code>https://acme-staging-v02.api.letsencrypt.org/directory</code> - сервер для тестирования получения проверочных сертификатов. Используется для проверки работы скрипта.</li>
<li><code>https://acme-v02.api.letsencrypt.org/directory</code> - сервер для получения настоящих сертификатов.</li>
</ul>
</li>
<li><code>ACME_EMAIL</code> - адрес электронной почты для регистрации и восстановления сертификата Let&rsquo;s Encrypt.</li>
<li><code>ACME_PATH</code> - путь к хранилищу сертификатов. По умолчанию: <code>/etc/ssl/acme</code>.</li>
<li><code>ACME_METHOD</code> - метод получения/обновления сертификата. По умолчанию <code>http</code>. Может принимать следующие значения:
<ul>
<li><code>dns</code> - получения сертификата методом <strong>DNS-01</strong>.</li>
<li><code>http</code> - получение сертификата методом <strong>HTTP-01</strong>.</li>
<li><code>tls</code> - получения сертификата методом <strong>TLS-ALPN-01</strong>.</li>
</ul>
</li>
<li><code>ACME_HTTP_PORT</code> - порт, который будет слушать LeGo при получении сертификата методом <strong>HTTP-01</strong>. По умолчанию: <code>:80</code>. Может принимать следующие значения:
<ul>
<li><code>interface:port</code> - слушать на конкретном интерфейсе и номере порта.</li>
<li><code>:port</code> - слушать на всех интерфейсах и конкретном порту.</li>
</ul>
</li>
<li><code>ACME_HTTP_PROXY_HEADER</code> - проверка по указанному заголовку, если LeGo находится за обратным proxy-сервером.</li>
<li><code>ACME_TLS_PORT</code> - порт, который будет слушать LeGo при получении сертификата методом <strong>TLS-ALPN-01</strong>. По умолчанию: <code>:443</code>. Может принимать следующие значения:
<ul>
<li><code>interface:port</code> - слушать на конкретном интерфейсе и номере порта.</li>
<li><code>:port</code> - слушать на всех интерфейсах и конкретном порту.</li>
</ul>
</li>
<li><code>ACME_KEY_TYPE</code> - тип приватного ключа сертификата. По умолчанию: <code>ec256</code>. Может принимать следующие значения:
<ul>
<li><code>rsa2048</code> - тип <strong>RSA-2048</strong>.</li>
<li><code>rsa3072</code> - тип <strong>RSA-3072</strong>.</li>
<li><code>rsa4096</code> - тип <strong>RSA-4096</strong>.</li>
<li><code>rsa8192</code> - тип <strong>RSA-8192</strong>.</li>
<li><code>ec256</code> - тип <strong>EC-256</strong>.</li>
<li><code>ec384</code> - тип <strong>EC-384</strong>.</li>
</ul>
</li>
<li><code>ACME_PFX_PASSWORD</code> - пароль для контейнера PFX.</li>
<li><code>ACME_PFX_FORMAT</code> - формат контейнера PFX. По умолчанию: <code>RC2</code>. Может принимать следующие значения:
<ul>
<li><code>RC2</code> - формат <strong>RC2</strong>.</li>
<li><code>DES</code> - формат <strong>DES</strong>.</li>
<li><code>SHA256</code> - формат <strong>SHA256</strong>.</li>
</ul>
</li>
<li><code>ACME_CRT_TIMEOUT</code> - время ожидания сертификата в секундах. По умолчанию: <code>30</code> секунд. Используется только при получении нового сертификата.</li>
<li><code>ACME_DAYS</code> - количество дней, оставшихся у сертификата для его продления.</li>
<li><code>ACME_SERVICES</code> - сервисы, которые необходимо перезапустить после обновления сертификата. Каждый из сервисов проверяется на наличие в системе.</li>
<li><code>ACME_DNS_PROVIDER</code> - выбор DNS-провайдера для получения сертификата методом <strong>DNS-01</strong>.</li>
<li><code>ACME_DNS_RESOLVERS</code> - Адреса DNS-резолверов. По умолчанию: <code>8.8.8.8</code> и <code>8.8.4.4</code>. Может принимать следующие значения:
<ul>
<li><code>host:port</code> - название хоста и номер порта.</li>
</ul>
</li>
</ul>
<h3 id="конфигурация-домена">
  <a class="link-body-emphasis" href="#%d0%ba%d0%be%d0%bd%d1%84%d0%b8%d0%b3%d1%83%d1%80%d0%b0%d1%86%d0%b8%d1%8f-%d0%b4%d0%be%d0%bc%d0%b5%d0%bd%d0%b0">Конфигурация домена</a>
</h3><p>Файл с индивидуальной конфигурацией для каждого домена. Название файла должно строиться по шаблону <code>app.acme.lego.[domain.com].conf</code>. Этот файл подключается после файла с общими параметрами и позволяет переопределять их.</p>

    

    
        
            
            <div class="shortcode shortcode-file mb-3">
              <div class="card overflow-hidden" data-bs-theme="dark">
                <div class="card-header">
                  <div class="d-flex align-items-center">
                    <div class="flex-shrink-0">
                      <i class="far fa-file-code fa-fw"></i>
                    </div>
                    <div class="flex-grow-1 mx-2 text-truncate">
                      <code>app.acme.lego.example.com.conf</code>
                    </div>
                    <div class="flex-shrink-0">
                      <ul class="list-inline mb-0">
                        <li class="list-inline-item" title='Копировать'>
                          <a class="text-body" href="#"
                             data-fn="clipboard" data-clipboard-target="#cp-e2353bd9e629ae67fbdd72c1c0b98f95"
                             role="button" aria-label='Копировать'>
                            <i class="fas fa-copy fa-fw"></i>
                          </a>
                        </li>
                        <li class="list-inline-item" title='Скачать'>
                          <a class="text-body" href="/ru/2024/11/1f5924fa-7a3d-574e-a15d-8a41208fe10d/app.acme.lego.example.com.conf" download
                             role="button" aria-label='Скачать'>
                            <i class="fas fa-download fa-fw"></i>
                          </a>
                        </li>
                        <li class="list-inline-item" title='Открыть'>
                          <a class="text-body" href="/ru/2024/11/1f5924fa-7a3d-574e-a15d-8a41208fe10d/app.acme.lego.example.com.conf" target="_blank"
                             role="button" aria-label='Открыть'>
                            <i class="fas fa-arrow-up-right-from-square fa-fw"></i>
                          </a>
                        </li>
                      </ul>
                    </div>
                  </div>
                </div>
                <div class="card-body p-0 overflow-auto" id="cp-e2353bd9e629ae67fbdd72c1c0b98f95">
                    
                    <div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="nv">ACME_DOMAINS</span><span class="o">=(</span>
</span></span><span class="line"><span class="cl">  <span class="s1">&#39;example.com&#39;</span>
</span></span><span class="line"><span class="cl">  <span class="s1">&#39;mail.example.com&#39;</span>
</span></span><span class="line"><span class="cl"><span class="o">)</span>
</span></span><span class="line"><span class="cl"><span class="nv">ACME_HTTP_WEBROOT</span><span class="o">=</span><span class="s1">&#39;/var/www/html&#39;</span></span></span></code></pre></td></tr></table>
</div>
</div>
                </div>
              </div>
            </div>
        
    
<h4 id="параметры-1">
  <a class="link-body-emphasis" href="#%d0%bf%d0%b0%d1%80%d0%b0%d0%bc%d0%b5%d1%82%d1%80%d1%8b-1">Параметры</a>
</h4><ul>
<li><code>ACME_DOMAINS</code> - список доменов для получения сертификата.</li>
<li><code>ACME_HTTP_WEBROOT</code> - WEB-директория сервера для интеграции директории идентификации <code>.well-known/acme-challenge</code>. Если параметр пустой, LeGo поднимает свой внутренний сервер для получения сертификата.</li>
</ul>
<h3 id="приложение">
  <a class="link-body-emphasis" href="#%d0%bf%d1%80%d0%b8%d0%bb%d0%be%d0%b6%d0%b5%d0%bd%d0%b8%d0%b5">Приложение</a>
</h3><p>Тело скрипта. Скрипт подключает файлы с основными параметрами и параметрами домена.</p>

    

    
        
            
            <div class="shortcode shortcode-file mb-3">
              <div class="card overflow-hidden" data-bs-theme="dark">
                <div class="card-header">
                  <div class="d-flex align-items-center">
                    <div class="flex-shrink-0">
                      <i class="far fa-file-code fa-fw"></i>
                    </div>
                    <div class="flex-grow-1 mx-2 text-truncate">
                      <code>app.acme.lego.sh</code>
                    </div>
                    <div class="flex-shrink-0">
                      <ul class="list-inline mb-0">
                        <li class="list-inline-item" title='Копировать'>
                          <a class="text-body" href="#"
                             data-fn="clipboard" data-clipboard-target="#cp-de18cb2e556f5ff3607217b68162a356"
                             role="button" aria-label='Копировать'>
                            <i class="fas fa-copy fa-fw"></i>
                          </a>
                        </li>
                        <li class="list-inline-item" title='Скачать'>
                          <a class="text-body" href="/ru/2024/11/1f5924fa-7a3d-574e-a15d-8a41208fe10d/app.acme.lego.sh" download
                             role="button" aria-label='Скачать'>
                            <i class="fas fa-download fa-fw"></i>
                          </a>
                        </li>
                        <li class="list-inline-item" title='Открыть'>
                          <a class="text-body" href="/ru/2024/11/1f5924fa-7a3d-574e-a15d-8a41208fe10d/app.acme.lego.sh" target="_blank"
                             role="button" aria-label='Открыть'>
                            <i class="fas fa-arrow-up-right-from-square fa-fw"></i>
                          </a>
                        </li>
                      </ul>
                    </div>
                  </div>
                </div>
                <div class="card-body p-0 overflow-auto" id="cp-de18cb2e556f5ff3607217b68162a356">
                    
                        
                    
                    <div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">  1
</span><span class="lnt">  2
</span><span class="lnt">  3
</span><span class="lnt">  4
</span><span class="lnt">  5
</span><span class="lnt">  6
</span><span class="lnt">  7
</span><span class="lnt">  8
</span><span class="lnt">  9
</span><span class="lnt"> 10
</span><span class="lnt"> 11
</span><span class="lnt"> 12
</span><span class="lnt"> 13
</span><span class="lnt"> 14
</span><span class="lnt"> 15
</span><span class="lnt"> 16
</span><span class="lnt"> 17
</span><span class="lnt"> 18
</span><span class="lnt"> 19
</span><span class="lnt"> 20
</span><span class="lnt"> 21
</span><span class="lnt"> 22
</span><span class="lnt"> 23
</span><span class="lnt"> 24
</span><span class="lnt"> 25
</span><span class="lnt"> 26
</span><span class="lnt"> 27
</span><span class="lnt"> 28
</span><span class="lnt"> 29
</span><span class="lnt"> 30
</span><span class="lnt"> 31
</span><span class="lnt"> 32
</span><span class="lnt"> 33
</span><span class="lnt"> 34
</span><span class="lnt"> 35
</span><span class="lnt"> 36
</span><span class="lnt"> 37
</span><span class="lnt"> 38
</span><span class="lnt"> 39
</span><span class="lnt"> 40
</span><span class="lnt"> 41
</span><span class="lnt"> 42
</span><span class="lnt"> 43
</span><span class="lnt"> 44
</span><span class="lnt"> 45
</span><span class="lnt"> 46
</span><span class="lnt"> 47
</span><span class="lnt"> 48
</span><span class="lnt"> 49
</span><span class="lnt"> 50
</span><span class="lnt"> 51
</span><span class="lnt"> 52
</span><span class="lnt"> 53
</span><span class="lnt"> 54
</span><span class="lnt"> 55
</span><span class="lnt"> 56
</span><span class="lnt"> 57
</span><span class="lnt"> 58
</span><span class="lnt"> 59
</span><span class="lnt"> 60
</span><span class="lnt"> 61
</span><span class="lnt"> 62
</span><span class="lnt"> 63
</span><span class="lnt"> 64
</span><span class="lnt"> 65
</span><span class="lnt"> 66
</span><span class="lnt"> 67
</span><span class="lnt"> 68
</span><span class="lnt"> 69
</span><span class="lnt"> 70
</span><span class="lnt"> 71
</span><span class="lnt"> 72
</span><span class="lnt"> 73
</span><span class="lnt"> 74
</span><span class="lnt"> 75
</span><span class="lnt"> 76
</span><span class="lnt"> 77
</span><span class="lnt"> 78
</span><span class="lnt"> 79
</span><span class="lnt"> 80
</span><span class="lnt"> 81
</span><span class="lnt"> 82
</span><span class="lnt"> 83
</span><span class="lnt"> 84
</span><span class="lnt"> 85
</span><span class="lnt"> 86
</span><span class="lnt"> 87
</span><span class="lnt"> 88
</span><span class="lnt"> 89
</span><span class="lnt"> 90
</span><span class="lnt"> 91
</span><span class="lnt"> 92
</span><span class="lnt"> 93
</span><span class="lnt"> 94
</span><span class="lnt"> 95
</span><span class="lnt"> 96
</span><span class="lnt"> 97
</span><span class="lnt"> 98
</span><span class="lnt"> 99
</span><span class="lnt">100
</span><span class="lnt">101
</span><span class="lnt">102
</span><span class="lnt">103
</span><span class="lnt">104
</span><span class="lnt">105
</span><span class="lnt">106
</span><span class="lnt">107
</span><span class="lnt">108
</span><span class="lnt">109
</span><span class="lnt">110
</span><span class="lnt">111
</span><span class="lnt">112
</span><span class="lnt">113
</span><span class="lnt">114
</span><span class="lnt">115
</span><span class="lnt">116
</span><span class="lnt">117
</span><span class="lnt">118
</span><span class="lnt">119
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sh" data-lang="sh"><span class="line"><span class="cl"><span class="cp">#!/usr/bin/env -S bash -eu
</span></span></span><span class="line"><span class="cl"><span class="cp"></span><span class="c1"># -------------------------------------------------------------------------------------------------------------------- #</span>
</span></span><span class="line"><span class="cl"><span class="c1"># ACME: CERTIFICATE</span>
</span></span><span class="line"><span class="cl"><span class="c1"># Script for generating a certificate using Lego.</span>
</span></span><span class="line"><span class="cl"><span class="c1"># -------------------------------------------------------------------------------------------------------------------- #</span>
</span></span><span class="line"><span class="cl"><span class="c1"># @package    Bash</span>
</span></span><span class="line"><span class="cl"><span class="c1"># @author     Kai Kimera</span>
</span></span><span class="line"><span class="cl"><span class="c1"># @license    MIT</span>
</span></span><span class="line"><span class="cl"><span class="c1"># @version    0.1.0</span>
</span></span><span class="line"><span class="cl"><span class="c1"># @link       https://lib.onl/ru/2024/11/1f5924fa-7a3d-574e-a15d-8a41208fe10d/</span>
</span></span><span class="line"><span class="cl"><span class="c1"># -------------------------------------------------------------------------------------------------------------------- #</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="o">((</span> EUID !<span class="o">=</span> <span class="m">0</span> <span class="o">))</span> <span class="o">&amp;&amp;</span> <span class="o">{</span> <span class="nb">echo</span> &gt;<span class="p">&amp;</span><span class="m">2</span> <span class="s1">&#39;This script should be run as root!&#39;</span><span class="p">;</span> <span class="nb">exit</span> 1<span class="p">;</span> <span class="o">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Sources.</span>
</span></span><span class="line"><span class="cl"><span class="nv">SRC_DIR</span><span class="o">=</span><span class="s2">&#34;</span><span class="k">$(</span> <span class="nb">cd</span> <span class="s2">&#34;</span><span class="k">$(</span> dirname <span class="s2">&#34;</span><span class="si">${</span><span class="nv">BASH_SOURCE</span><span class="p">[0]</span><span class="si">}</span><span class="s2">&#34;</span> <span class="k">)</span><span class="s2">&#34;</span> <span class="p">&amp;</span>&gt; /dev/null <span class="o">&amp;&amp;</span> <span class="nb">pwd</span> -P <span class="k">)</span><span class="s2">&#34;</span><span class="p">;</span> <span class="nb">readonly</span> SRC_DIR <span class="c1"># Script directory.</span>
</span></span><span class="line"><span class="cl"><span class="nv">SRC_NAME</span><span class="o">=</span><span class="s2">&#34;</span><span class="k">$(</span> basename <span class="s2">&#34;</span><span class="k">$(</span> readlink -f <span class="s2">&#34;</span><span class="si">${</span><span class="nv">BASH_SOURCE</span><span class="p">[0]</span><span class="si">}</span><span class="s2">&#34;</span> <span class="k">)</span><span class="s2">&#34;</span> <span class="k">)</span><span class="s2">&#34;</span><span class="p">;</span> <span class="nb">readonly</span> SRC_NAME <span class="c1"># Script name.</span>
</span></span><span class="line"><span class="cl"><span class="nv">SRC_DOMAIN</span><span class="o">=</span><span class="s2">&#34;</span><span class="si">${</span><span class="nv">1</span><span class="p">:?</span><span class="si">}</span><span class="s2">&#34;</span><span class="p">;</span> <span class="nb">readonly</span> SRC_DOMAIN <span class="c1"># Domain name.</span>
</span></span><span class="line"><span class="cl"><span class="c1"># shellcheck source=/dev/null</span>
</span></span><span class="line"><span class="cl">. <span class="s2">&#34;</span><span class="si">${</span><span class="nv">SRC_DIR</span><span class="si">}</span><span class="s2">/</span><span class="si">${</span><span class="nv">SRC_NAME</span><span class="p">%.*</span><span class="si">}</span><span class="s2">.conf&#34;</span> <span class="c1"># Loading main configuration file.</span>
</span></span><span class="line"><span class="cl"><span class="c1"># shellcheck source=/dev/null</span>
</span></span><span class="line"><span class="cl">. <span class="s2">&#34;</span><span class="si">${</span><span class="nv">SRC_DIR</span><span class="si">}</span><span class="s2">/</span><span class="si">${</span><span class="nv">SRC_NAME</span><span class="p">%.*</span><span class="si">}</span><span class="s2">.</span><span class="si">${</span><span class="nv">SRC_DOMAIN</span><span class="si">}</span><span class="s2">.conf&#34;</span> <span class="c1"># Loading domain configuration file.</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Environment variables.</span>
</span></span><span class="line"><span class="cl"><span class="nb">export</span> <span class="nv">LEGO_PATH</span><span class="o">=</span><span class="s2">&#34;</span><span class="si">${</span><span class="nv">SRC_DIR</span><span class="p">:?</span><span class="si">}</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl"><span class="nb">export</span> <span class="nv">LEGO_SERVER</span><span class="o">=</span><span class="s2">&#34;</span><span class="si">${</span><span class="nv">ACME_SERVER</span><span class="p">:?</span><span class="si">}</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl"><span class="nb">export</span> <span class="nv">LEGO_PFX_PASSWORD</span><span class="o">=</span><span class="s2">&#34;</span><span class="si">${</span><span class="nv">ACME_PFX_PASSWORD</span><span class="p">:?</span><span class="si">}</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl"><span class="nb">export</span> <span class="nv">LEGO_PFX_FORMAT</span><span class="o">=</span><span class="s2">&#34;</span><span class="si">${</span><span class="nv">ACME_PFX_FORMAT</span><span class="p">:?</span><span class="si">}</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Parameters.</span>
</span></span><span class="line"><span class="cl"><span class="nv">ACME_CMD</span><span class="o">=</span><span class="s2">&#34;</span><span class="si">${</span><span class="nv">2</span><span class="p">:?</span><span class="si">}</span><span class="s2">&#34;</span><span class="p">;</span> <span class="nb">readonly</span> ACME_CMD<span class="p">;</span> <span class="o">[[</span> ! <span class="s2">&#34;</span><span class="si">${</span><span class="nv">ACME_CMD</span><span class="si">}</span><span class="s2">&#34;</span> <span class="o">=</span>~ ^<span class="o">(</span>run<span class="p">|</span>renew<span class="o">)</span>$ <span class="o">]]</span> <span class="o">&amp;&amp;</span> <span class="nb">exit</span> <span class="m">1</span>
</span></span><span class="line"><span class="cl"><span class="nv">ACME_EMAIL</span><span class="o">=</span><span class="s2">&#34;</span><span class="si">${</span><span class="nv">ACME_EMAIL</span><span class="p">:?</span><span class="si">}</span><span class="s2">&#34;</span><span class="p">;</span> <span class="nb">readonly</span> ACME_EMAIL
</span></span><span class="line"><span class="cl"><span class="nv">ACME_PATH</span><span class="o">=</span><span class="s2">&#34;</span><span class="si">${</span><span class="nv">ACME_PATH</span><span class="p">:?</span><span class="si">}</span><span class="s2">&#34;</span><span class="p">;</span> <span class="nb">readonly</span> ACME_PATH
</span></span><span class="line"><span class="cl"><span class="nv">ACME_METHOD</span><span class="o">=</span><span class="s2">&#34;</span><span class="si">${</span><span class="nv">ACME_METHOD</span><span class="p">:?</span><span class="si">}</span><span class="s2">&#34;</span><span class="p">;</span> <span class="nb">readonly</span> ACME_METHOD
</span></span><span class="line"><span class="cl"><span class="nv">ACME_HTTP_PORT</span><span class="o">=</span><span class="s2">&#34;</span><span class="si">${</span><span class="nv">ACME_HTTP_PORT</span><span class="p">:?</span><span class="si">}</span><span class="s2">&#34;</span><span class="p">;</span> <span class="nb">readonly</span> ACME_HTTP_PORT
</span></span><span class="line"><span class="cl"><span class="nv">ACME_HTTP_PROXY_HEADER</span><span class="o">=</span><span class="s2">&#34;</span><span class="si">${</span><span class="nv">ACME_HTTP_PROXY_HEADER</span><span class="p">:?</span><span class="si">}</span><span class="s2">&#34;</span><span class="p">;</span> <span class="nb">readonly</span> ACME_HTTP_PROXY_HEADER
</span></span><span class="line"><span class="cl"><span class="nv">ACME_HTTP_WEBROOT</span><span class="o">=</span><span class="s2">&#34;</span><span class="si">${</span><span class="nv">ACME_HTTP_WEBROOT</span><span class="p">?</span><span class="si">}</span><span class="s2">&#34;</span><span class="p">;</span> <span class="nb">readonly</span> ACME_HTTP_WEBROOT
</span></span><span class="line"><span class="cl"><span class="nv">ACME_TLS_PORT</span><span class="o">=</span><span class="s2">&#34;</span><span class="si">${</span><span class="nv">ACME_TLS_PORT</span><span class="p">:?</span><span class="si">}</span><span class="s2">&#34;</span><span class="p">;</span> <span class="nb">readonly</span> ACME_TLS_PORT
</span></span><span class="line"><span class="cl"><span class="nv">ACME_KEY_TYPE</span><span class="o">=</span><span class="s2">&#34;</span><span class="si">${</span><span class="nv">ACME_KEY_TYPE</span><span class="p">:?</span><span class="si">}</span><span class="s2">&#34;</span><span class="p">;</span> <span class="nb">readonly</span> ACME_KEY_TYPE
</span></span><span class="line"><span class="cl"><span class="nv">ACME_CRT_TIMEOUT</span><span class="o">=</span><span class="s2">&#34;</span><span class="si">${</span><span class="nv">ACME_CRT_TIMEOUT</span><span class="p">:?</span><span class="si">}</span><span class="s2">&#34;</span><span class="p">;</span> <span class="nb">readonly</span> ACME_CRT_TIMEOUT
</span></span><span class="line"><span class="cl"><span class="nv">ACME_DAYS</span><span class="o">=</span><span class="s2">&#34;</span><span class="si">${</span><span class="nv">ACME_DAYS</span><span class="p">:?</span><span class="si">}</span><span class="s2">&#34;</span><span class="p">;</span> <span class="nb">readonly</span> ACME_DAYS
</span></span><span class="line"><span class="cl"><span class="nv">ACME_SERVICES</span><span class="o">=(</span><span class="s2">&#34;</span><span class="si">${</span><span class="nv">ACME_SERVICES</span><span class="p">[@]:?</span><span class="si">}</span><span class="s2">&#34;</span><span class="o">)</span><span class="p">;</span> <span class="nb">readonly</span> ACME_SERVICES
</span></span><span class="line"><span class="cl"><span class="nv">ACME_DOMAINS</span><span class="o">=(</span><span class="s2">&#34;</span><span class="si">${</span><span class="nv">ACME_DOMAINS</span><span class="p">[@]:?</span><span class="si">}</span><span class="s2">&#34;</span><span class="o">)</span><span class="p">;</span> <span class="nb">readonly</span> ACME_DOMAINS
</span></span><span class="line"><span class="cl"><span class="nv">ACME_DNS_PROVIDER</span><span class="o">=</span><span class="s2">&#34;</span><span class="si">${</span><span class="nv">ACME_DNS_PROVIDER</span><span class="p">:?</span><span class="si">}</span><span class="s2">&#34;</span><span class="p">;</span> <span class="nb">readonly</span> ACME_DNS_PROVIDER
</span></span><span class="line"><span class="cl"><span class="nv">ACME_DNS_RESOLVERS</span><span class="o">=(</span><span class="s2">&#34;</span><span class="si">${</span><span class="nv">ACME_DNS_RESOLVERS</span><span class="p">[@]:?</span><span class="si">}</span><span class="s2">&#34;</span><span class="o">)</span><span class="p">;</span> <span class="nb">readonly</span> ACME_DNS_RESOLVERS
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># -------------------------------------------------------------------------------------------------------------------- #</span>
</span></span><span class="line"><span class="cl"><span class="c1"># INITIALIZATION</span>
</span></span><span class="line"><span class="cl"><span class="c1"># -------------------------------------------------------------------------------------------------------------------- #</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">run<span class="o">()</span> <span class="o">{</span> lego<span class="p">;</span> <span class="o">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># -------------------------------------------------------------------------------------------------------------------- #</span>
</span></span><span class="line"><span class="cl"><span class="c1"># LEGO</span>
</span></span><span class="line"><span class="cl"><span class="c1"># Let&#39;s Encrypt client and ACME library written in Go.</span>
</span></span><span class="line"><span class="cl"><span class="c1"># -------------------------------------------------------------------------------------------------------------------- #</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">lego<span class="o">()</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">  <span class="nb">local</span> cmd<span class="p">;</span> <span class="nv">cmd</span><span class="o">=(</span><span class="s2">&#34;</span><span class="si">${</span><span class="nv">ACME_CMD</span><span class="si">}</span><span class="s2">&#34;</span><span class="o">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="k">case</span> <span class="s2">&#34;</span><span class="si">${</span><span class="nv">ACME_CMD</span><span class="si">}</span><span class="s2">&#34;</span> in
</span></span><span class="line"><span class="cl">    <span class="s1">&#39;renew&#39;</span><span class="o">)</span>
</span></span><span class="line"><span class="cl">      <span class="nv">cmd</span><span class="o">+=(</span><span class="s1">&#39;--days&#39;</span> <span class="s2">&#34;</span><span class="si">${</span><span class="nv">ACME_DAYS</span><span class="si">}</span><span class="s2">&#34;</span><span class="o">)</span>
</span></span><span class="line"><span class="cl">      <span class="p">;;</span>
</span></span><span class="line"><span class="cl">  <span class="k">esac</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="nb">local</span> opts
</span></span><span class="line"><span class="cl">  <span class="nv">opts</span><span class="o">=(</span>
</span></span><span class="line"><span class="cl">    <span class="s1">&#39;--accept-tos&#39;</span>
</span></span><span class="line"><span class="cl">    <span class="s1">&#39;--key-type&#39;</span> <span class="s2">&#34;</span><span class="si">${</span><span class="nv">ACME_KEY_TYPE</span><span class="si">}</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="s1">&#39;--email&#39;</span> <span class="s2">&#34;</span><span class="si">${</span><span class="nv">ACME_EMAIL</span><span class="si">}</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="s1">&#39;--cert.timeout&#39;</span> <span class="s2">&#34;</span><span class="si">${</span><span class="nv">ACME_CRT_TIMEOUT</span><span class="si">}</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="s1">&#39;--pem&#39;</span>
</span></span><span class="line"><span class="cl">    <span class="s1">&#39;--pfx&#39;</span>
</span></span><span class="line"><span class="cl">  <span class="o">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="k">case</span> <span class="s2">&#34;</span><span class="si">${</span><span class="nv">ACME_METHOD</span><span class="si">}</span><span class="s2">&#34;</span> in
</span></span><span class="line"><span class="cl">    <span class="s1">&#39;dns&#39;</span><span class="o">)</span>
</span></span><span class="line"><span class="cl">      <span class="nv">opts</span><span class="o">+=(</span><span class="s1">&#39;--dns&#39;</span> <span class="s2">&#34;</span><span class="si">${</span><span class="nv">ACME_DNS_PROVIDER</span><span class="si">}</span><span class="s2">&#34;</span><span class="o">)</span>
</span></span><span class="line"><span class="cl">      <span class="k">for</span> i in <span class="s2">&#34;</span><span class="si">${</span><span class="nv">ACME_DNS_RESOLVERS</span><span class="p">[@]</span><span class="si">}</span><span class="s2">&#34;</span><span class="p">;</span> <span class="k">do</span> <span class="nv">opts</span><span class="o">+=(</span><span class="s1">&#39;--dns.resolvers&#39;</span> <span class="s2">&#34;</span><span class="si">${</span><span class="nv">i</span><span class="si">}</span><span class="s2">&#34;</span><span class="o">)</span><span class="p">;</span> <span class="k">done</span>
</span></span><span class="line"><span class="cl">      <span class="p">;;</span>
</span></span><span class="line"><span class="cl">    <span class="s1">&#39;http&#39;</span><span class="o">)</span>
</span></span><span class="line"><span class="cl">      <span class="nv">opts</span><span class="o">+=(</span><span class="s1">&#39;--http&#39;</span> <span class="s1">&#39;--http.port&#39;</span> <span class="s2">&#34;</span><span class="si">${</span><span class="nv">ACME_HTTP_PORT</span><span class="si">}</span><span class="s2">&#34;</span> <span class="s1">&#39;--http.proxy-header&#39;</span> <span class="s2">&#34;</span><span class="si">${</span><span class="nv">ACME_HTTP_PROXY_HEADER</span><span class="si">}</span><span class="s2">&#34;</span><span class="o">)</span>
</span></span><span class="line"><span class="cl">      <span class="o">[[</span> -n <span class="s2">&#34;</span><span class="si">${</span><span class="nv">ACME_HTTP_WEBROOT</span><span class="si">}</span><span class="s2">&#34;</span> <span class="o">]]</span> <span class="o">&amp;&amp;</span> <span class="nv">opts</span><span class="o">+=(</span><span class="s1">&#39;--http.webroot&#39;</span> <span class="s2">&#34;</span><span class="si">${</span><span class="nv">ACME_HTTP_WEBROOT</span><span class="si">}</span><span class="s2">&#34;</span><span class="o">)</span>
</span></span><span class="line"><span class="cl">      <span class="p">;;</span>
</span></span><span class="line"><span class="cl">    <span class="s1">&#39;tls&#39;</span><span class="o">)</span>
</span></span><span class="line"><span class="cl">      <span class="nv">opts</span><span class="o">+=(</span><span class="s1">&#39;--tls&#39;</span> <span class="s1">&#39;--tls.port&#39;</span> <span class="s2">&#34;</span><span class="si">${</span><span class="nv">ACME_TLS_PORT</span><span class="si">}</span><span class="s2">&#34;</span><span class="o">)</span>
</span></span><span class="line"><span class="cl">      <span class="p">;;</span>
</span></span><span class="line"><span class="cl">    *<span class="o">)</span>
</span></span><span class="line"><span class="cl">      <span class="nb">echo</span> <span class="s1">&#39;ACME_METHOD is not supported!&#39;</span><span class="p">;</span> <span class="nb">exit</span> <span class="m">1</span>
</span></span><span class="line"><span class="cl">      <span class="p">;;</span>
</span></span><span class="line"><span class="cl">  <span class="k">esac</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="k">for</span> i in <span class="s2">&#34;</span><span class="si">${</span><span class="nv">ACME_DOMAINS</span><span class="p">[@]</span><span class="si">}</span><span class="s2">&#34;</span><span class="p">;</span> <span class="k">do</span> <span class="nv">opts</span><span class="o">+=(</span><span class="s1">&#39;--domains&#39;</span> <span class="s2">&#34;</span><span class="si">${</span><span class="nv">i</span><span class="si">}</span><span class="s2">&#34;</span><span class="o">)</span><span class="p">;</span> <span class="k">done</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="k">if</span> <span class="s2">&#34;</span><span class="si">${</span><span class="nv">SRC_DIR</span><span class="si">}</span><span class="s2">/lego&#34;</span> <span class="s2">&#34;</span><span class="si">${</span><span class="nv">opts</span><span class="p">[@]</span><span class="si">}</span><span class="s2">&#34;</span> <span class="s2">&#34;</span><span class="si">${</span><span class="nv">cmd</span><span class="p">[@]</span><span class="si">}</span><span class="s2">&#34;</span><span class="p">;</span> <span class="k">then</span>
</span></span><span class="line"><span class="cl">    <span class="o">[[</span> ! -d <span class="s2">&#34;</span><span class="si">${</span><span class="nv">ACME_PATH</span><span class="si">}</span><span class="s2">&#34;</span> <span class="o">]]</span> <span class="o">&amp;&amp;</span> mkdir -p <span class="s2">&#34;</span><span class="si">${</span><span class="nv">ACME_PATH</span><span class="si">}</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl">    cp -f <span class="s2">&#34;</span><span class="si">${</span><span class="nv">LEGO_PATH</span><span class="si">}</span><span class="s2">/certificates/&#34;</span><span class="o">{</span>*.crt,*.key,*.pem,*.pfx<span class="o">}</span> <span class="s2">&#34;</span><span class="si">${</span><span class="nv">ACME_PATH</span><span class="si">}</span><span class="s2">&#34;</span> <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>      <span class="o">&amp;&amp;</span> chmod <span class="m">644</span> <span class="s2">&#34;</span><span class="si">${</span><span class="nv">ACME_PATH</span><span class="si">}</span><span class="s2">/&#34;</span><span class="o">{</span>*.crt,*.key,*.pem,*.pfx<span class="o">}</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> s in <span class="s2">&#34;</span><span class="si">${</span><span class="nv">ACME_SERVICES</span><span class="p">[@]</span><span class="si">}</span><span class="s2">&#34;</span><span class="p">;</span> <span class="k">do</span> _if_service <span class="s2">&#34;</span><span class="si">${</span><span class="nv">s</span><span class="si">}</span><span class="s2">&#34;</span> <span class="o">&amp;&amp;</span> systemctl reload <span class="s2">&#34;</span><span class="si">${</span><span class="nv">s</span><span class="si">}</span><span class="s2">&#34;</span><span class="p">;</span> <span class="k">done</span>
</span></span><span class="line"><span class="cl">  <span class="k">fi</span>
</span></span><span class="line"><span class="cl"><span class="o">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># -------------------------------------------------------------------------------------------------------------------- #</span>
</span></span><span class="line"><span class="cl"><span class="c1"># ------------------------------------------------&lt; COMMON FUNCTIONS &gt;------------------------------------------------ #</span>
</span></span><span class="line"><span class="cl"><span class="c1"># -------------------------------------------------------------------------------------------------------------------- #</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Checking service availability.</span>
</span></span><span class="line"><span class="cl">_if_service<span class="o">()</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">  <span class="nb">local</span> s<span class="p">;</span> <span class="nv">s</span><span class="o">=</span><span class="s2">&#34;</span><span class="si">${</span><span class="nv">1</span><span class="si">}</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl">  <span class="k">if</span> systemctl list-units --full -all <span class="p">|</span> grep -Fq <span class="s2">&#34;</span><span class="si">${</span><span class="nv">s</span><span class="si">}</span><span class="s2">&#34;</span><span class="p">;</span> <span class="k">then</span> <span class="k">return</span> 0<span class="p">;</span> <span class="k">fi</span>
</span></span><span class="line"><span class="cl">  <span class="k">return</span> <span class="m">1</span>
</span></span><span class="line"><span class="cl"><span class="o">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># -------------------------------------------------------------------------------------------------------------------- #</span>
</span></span><span class="line"><span class="cl"><span class="c1"># -------------------------------------------------&lt; RUNNING SCRIPT &gt;------------------------------------------------- #</span>
</span></span><span class="line"><span class="cl"><span class="c1"># -------------------------------------------------------------------------------------------------------------------- #</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">run <span class="o">&amp;&amp;</span> <span class="nb">exit</span> <span class="m">0</span> <span class="o">||</span> <span class="nb">exit</span> <span class="m">1</span></span></span></code></pre></td></tr></table>
</div>
</div>
                </div>
              </div>
            </div>
        
    
<h3 id="задача">
  <a class="link-body-emphasis" href="#%d0%b7%d0%b0%d0%b4%d0%b0%d1%87%d0%b0">Задача</a>
</h3><p>Файл задачи размещается в директории <code>/etc/cron.d/</code>. Задача запускает скрипт каждый день для проверки состояния сертификатов.</p>

    

    
        
            
            <div class="shortcode shortcode-file mb-3">
              <div class="card overflow-hidden" data-bs-theme="dark">
                <div class="card-header">
                  <div class="d-flex align-items-center">
                    <div class="flex-shrink-0">
                      <i class="far fa-file-code fa-fw"></i>
                    </div>
                    <div class="flex-grow-1 mx-2 text-truncate">
                      <code>app_acme_lego</code>
                    </div>
                    <div class="flex-shrink-0">
                      <ul class="list-inline mb-0">
                        <li class="list-inline-item" title='Копировать'>
                          <a class="text-body" href="#"
                             data-fn="clipboard" data-clipboard-target="#cp-f680cf71b66cf83e0de8c4e4ccec4449"
                             role="button" aria-label='Копировать'>
                            <i class="fas fa-copy fa-fw"></i>
                          </a>
                        </li>
                        <li class="list-inline-item" title='Скачать'>
                          <a class="text-body" href="/ru/2024/11/1f5924fa-7a3d-574e-a15d-8a41208fe10d/app_acme_lego" download
                             role="button" aria-label='Скачать'>
                            <i class="fas fa-download fa-fw"></i>
                          </a>
                        </li>
                        <li class="list-inline-item" title='Открыть'>
                          <a class="text-body" href="/ru/2024/11/1f5924fa-7a3d-574e-a15d-8a41208fe10d/app_acme_lego" target="_blank"
                             role="button" aria-label='Открыть'>
                            <i class="fas fa-arrow-up-right-from-square fa-fw"></i>
                          </a>
                        </li>
                      </ul>
                    </div>
                  </div>
                </div>
                <div class="card-body p-0 overflow-auto" id="cp-f680cf71b66cf83e0de8c4e4ccec4449">
                    
                    <div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="nv">SHELL</span><span class="o">=</span>/bin/bash
</span></span><span class="line"><span class="cl"><span class="nv">PATH</span><span class="o">=</span>/bin:/sbin:/usr/bin:/usr/sbin:/usr/local/bin:/usr/local/sbin
</span></span><span class="line"><span class="cl"><span class="nv">HOME</span><span class="o">=</span>/root
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="m">0</span> <span class="m">0</span> * * * root <span class="s2">&#34;</span><span class="si">${</span><span class="nv">HOME</span><span class="si">}</span><span class="s2">/apps/acme/app.acme.lego.sh&#34;</span> <span class="s1">&#39;example.com&#39;</span> <span class="s1">&#39;renew&#39;</span> &gt; /dev/null 2&gt;<span class="p">&amp;</span><span class="m">1</span></span></span></code></pre></td></tr></table>
</div>
</div>
                </div>
              </div>
            </div>
        
    
<h4 id="параметры-2">
  <a class="link-body-emphasis" href="#%d0%bf%d0%b0%d1%80%d0%b0%d0%bc%d0%b5%d1%82%d1%80%d1%8b-2">Параметры</a>
</h4><ul>
<li><code>example.com</code> - название домена для загрузки файла с его параметрами.</li>
<li><code>renew</code> - команда LeGo для проверки и обновления сертификатов.</li>
</ul>]]></turbo:content></item><item turbo="true"><title>Jigasi: "The following addresses failed: RFC 6120 A/AAAA Endpoint"</title><link>https://lib.onl/ru/2024/11/45ffdbeb-37ec-5ed2-b3cd-347df5e3d07b/</link><pubDate>Wed, 06 Nov 2024 10:16:13 +0000</pubDate><dc:creator>Kai Kimera</dc:creator><category>Linux</category><category>Сеть</category><yandex:related><link url="https://lib.onl/ru/2024/10/0a633c87-935c-54ba-bedf-9c95152b6b51/">Автоматическое закрытие конференц-комнаты в Asterisk</link><link url="https://lib.onl/ru/2024/06/b29b331d-ac93-5193-83ef-beab5a0f8dff/">Linux: Пользователи и группы</link><link url="https://lib.onl/ru/2024/03/6c7a038f-f41e-5a45-a285-b99fdacf82d4/">Работа с ZFS</link><link url="https://lib.onl/ru/2021/09/581804b8-0613-52a8-a5c4-fdae90e7bc8a/">Чёрный экран с курсором при старте GDM</link><link url="https://lib.onl/ru/2021/09/ff829d15-4a19-52e3-a3aa-ad70aa38854a/">Debian: Wired Networks are Unmanaged</link><link url="https://lib.onl/ru/2021/03/0a815547-4f18-52a0-9a99-c463421872ca/">Monero Unit</link></yandex:related><turbo:extendedHtml>true</turbo:extendedHtml><turbo:source>https://lib.onl/ru/2024/11/45ffdbeb-37ec-5ed2-b3cd-347df5e3d07b/</turbo:source><turbo:topic>Jigasi: "The following addresses failed: RFC 6120 A/AAAA Endpoint"</turbo:topic><turbo:content><![CDATA[<p>Решение ошибки, связанной с раннем запуском сервиса <span class="shortcode shortcode-tag"><a href="/ru/tags/jigasi/" target="_blank">#Jigasi</a></span>.</p>
<p>После перезагрузки сервера, <span class="shortcode shortcode-tag"><a href="/ru/tags/jigasi/" target="_blank">#Jigasi</a></span> не может приглашать локальные телефоны. Появляется следующая ошибка:</p>











<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-0 shortcode-codeblock-terminal
shortcode-codeblock-terminal-linux
shortcode-codeblock-terminal-linux-user">
  <div class="card overflow-hidden" data-bs-theme="dark">
    <div class="card-header">
      <div class="d-flex align-items-center">
        <div class="flex-shrink-0 ">
          <i class="fas fa-terminal fa-fw"></i>
        </div>
        <div class="flex-grow-1 mx-2">
          <h5 class="mb-0">Терминал</h5>
        </div>
        <div class="flex-shrink-0">
          <ul class="list-inline mb-0">
            <li class="list-inline-item" title='Копировать'>
              <a class="text-body" href="#"
                 data-fn="clipboard" data-clipboard-target="#cp-0b40c25341837f3ce56e34d56c0373a8"
                 role="button" aria-label='Копировать'>
                <i class="fas fa-copy fa-fw"></i>
              </a>
            </li>
          </ul>
        </div>
      </div>
    </div>
    <div class="card-body p-0 overflow-auto" id="cp-0b40c25341837f3ce56e34d56c0373a8"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-plaintext" data-lang="plaintext"><span class="line"><span class="cl">cat /var/log/jitsi/jicofo.log
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">2024-11-05 11:36:06.116 INFO: [33] SipGateway.registrationStateChanged#120: REG STATE CHANGE ProtocolProviderServiceSipImpl(SIP:1234@192.168.1.2) -&gt; RegistrationStateChangeEvent[ oldState=Unregistered; newState=RegistrationState=Registering; userRequest=false; reasonCode=-1; reason=null]
</span></span><span class="line"><span class="cl">2024-11-05 11:36:06.179 INFO: [43] SipGateway.registrationStateChanged#120: REG STATE CHANGE ProtocolProviderServiceSipImpl(SIP:1234@192.168.1.2) -&gt; RegistrationStateChangeEvent[ oldState=Registering; newState=RegistrationState=Registered; userRequest=false; reasonCode=-1; reason=null]
</span></span><span class="line"><span class="cl">2024-11-05 11:36:06.180 WARNING: [43] SipHealthPeriodicChecker.create#170: No health check started, no HEALTH_CHECK_SIP_URI prop.
</span></span><span class="line"><span class="cl">2024-11-05 11:36:06.231 SEVERE: [40] net.java.sip.communicator.impl.protocol.jabber.ProtocolProviderServiceJabberImpl.connectAndLogin: Failed to connect to XMPP service for:ProtocolProviderServiceJabberImpl(Jabber:jigasi@auth.cf.vpostal.ru)
</span></span><span class="line"><span class="cl">org.jivesoftware.smack.SmackException$EndpointConnectionException: The following addresses failed: &#39;RFC 6120 A/AAAA Endpoint + [127.0.0.1/127.0.0.1:5222] (127.0.0.1/127.0.0.1:5222)&#39; failed because: java.net.ConnectException: Connection refused
</span></span><span class="line"><span class="cl">        at org.jivesoftware.smack.SmackException$EndpointConnectionException.from(SmackException.java:334)
</span></span><span class="line"><span class="cl">        at org.jivesoftware.smack.tcp.XMPPTCPConnection.connectUsingConfiguration(XMPPTCPConnection.java:664)
</span></span><span class="line"><span class="cl">        at org.jivesoftware.smack.tcp.XMPPTCPConnection.connectInternal(XMPPTCPConnection.java:849)
</span></span><span class="line"><span class="cl">        at org.jivesoftware.smack.AbstractXMPPConnection.connect(AbstractXMPPConnection.java:525)
</span></span><span class="line"><span class="cl">        at net.java.sip.communicator.impl.protocol.jabber.ProtocolProviderServiceJabberImpl.connectAndLogin(ProtocolProviderServiceJabberImpl.java:1307)
</span></span><span class="line"><span class="cl">        at net.java.sip.communicator.impl.protocol.jabber.ProtocolProviderServiceJabberImpl.connectAndLogin(ProtocolProviderServiceJabberImpl.java:967)
</span></span><span class="line"><span class="cl">        at net.java.sip.communicator.impl.protocol.jabber.ProtocolProviderServiceJabberImpl.initializeConnectAndLogin(ProtocolProviderServiceJabberImpl.java:792)
</span></span><span class="line"><span class="cl">        at net.java.sip.communicator.impl.protocol.jabber.ProtocolProviderServiceJabberImpl.register(ProtocolProviderServiceJabberImpl.java:494)
</span></span><span class="line"><span class="cl">        at org.jitsi.jigasi.util.RegisterThread.run(RegisterThread.java:59)
</span></span><span class="line"><span class="cl">2024-11-05 11:36:36.255 WARNING: [14] org.jivesoftware.smackx.ping.PingManager.pingServerIfNecessary: XMPPTCPConnection[not-authenticated] (0) was not authenticated</span></span></code></pre></td></tr></table>
</div>
</div></div>
  </div>
</div>
<p>Возможно, <span class="shortcode shortcode-tag"><a href="/ru/tags/jigasi/" target="_blank">#Jigasi</a></span> запускается раньше других сервисов. Чтобы <span class="shortcode shortcode-tag"><a href="/ru/tags/jigasi/" target="_blank">#Jigasi</a></span> запустился в необходимое время, надо переопределить зависимости запуска стандартной конфигурации <strong>systemd</strong>. Для этого создаём файл <code>/etc/systemd/system/jigasi.service.d/override.conf</code> со строками:</p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-1
shortcode-codeblock-ini">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-2e2ab8fc4e1d1ab91970a48804b85336" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-ini" data-lang="ini"><span class="line"><span class="cl"><span class="k">[Unit]</span>
</span></span><span class="line"><span class="cl"><span class="na">After</span><span class="o">=</span><span class="s">jitsi-videobridge2.service</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-2e2ab8fc4e1d1ab91970a48804b85336"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<p>Таким образом, переменную <code>After</code> из стандартной конфигурации <span class="shortcode shortcode-tag"><a href="/ru/tags/jigasi/" target="_blank">#Jigasi</a></span> мы переопределяем на свою и говорим <span class="shortcode shortcode-tag"><a href="/ru/tags/jigasi/" target="_blank">#Jigasi</a></span>, чтобы та ждала загрузки unit&rsquo;а <code>jitsi-videobridge2.service</code> и только после этого сама запускалась.</p>
<p>Сам же unit <code>jitsi-videobridge2.service</code> содержит такие строки:</p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-2
shortcode-codeblock-ini">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-ff21b7393d385b730faae453888bf920" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-ini" data-lang="ini"><span class="line"><span class="cl"><span class="k">[Unit]</span>
</span></span><span class="line"><span class="cl"><span class="na">Description</span><span class="o">=</span><span class="s">Jitsi Videobridge</span>
</span></span><span class="line"><span class="cl"><span class="na">After</span><span class="o">=</span><span class="s">network-online.target</span>
</span></span><span class="line"><span class="cl"><span class="na">Wants</span><span class="o">=</span><span class="s">network-online.target</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-ff21b7393d385b730faae453888bf920"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<p>Согласно переменным <code>After=network-online.target</code> и <code>Wants=network-online.target</code>, unit ждёт активности сети и после этого загружается.</p>
<p>Объединив всё это, получаем цепочку последовательных, зависимых друг от друга, запусков:</p>
<ol>
<li>Активность сети.</li>
<li>Модуль <code>jitsi-videobridge2.service</code>.</li>
<li>Модуль <code>jigasi.service</code>.</li>
</ol>
<p>Команда для создания переопределения unit&rsquo;а одной строчкой:</p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-3
shortcode-codeblock-bash">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-f02e81d8e5c9d55841f238cc854e6563" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="nv">d</span><span class="o">=</span><span class="s1">&#39;/etc/systemd/system/jigasi.service.d&#39;</span><span class="p">;</span> mkdir -p <span class="s2">&#34;</span><span class="si">${</span><span class="nv">d</span><span class="si">}</span><span class="s2">&#34;</span> <span class="o">&amp;&amp;</span> <span class="nb">echo</span> -e <span class="s2">&#34;[Unit]\nAfter=jitsi-videobridge2.service&#34;</span> &gt; <span class="s2">&#34;</span><span class="si">${</span><span class="nv">d</span><span class="si">}</span><span class="s2">/override.conf&#34;</span> <span class="o">&amp;&amp;</span> systemctl daemon-reload <span class="o">&amp;&amp;</span> systemctl restart <span class="s1">&#39;jigasi.service&#39;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-f02e81d8e5c9d55841f238cc854e6563"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>]]></turbo:content></item><item turbo="true"><title>Как включить параметр Check Gateway для маршрута, полученного по DHCP?</title><link>https://lib.onl/ru/2024/10/4f371edb-90bc-537e-a5c9-d43b47fe1a59/</link><pubDate>Sun, 13 Oct 2024 20:49:17 +0000</pubDate><dc:creator>Kai Kimera</dc:creator><category>Mikrotik</category><turbo:extendedHtml>true</turbo:extendedHtml><turbo:source>https://lib.onl/ru/2024/10/4f371edb-90bc-537e-a5c9-d43b47fe1a59/</turbo:source><turbo:topic>Как включить параметр Check Gateway для маршрута, полученного по DHCP?</turbo:topic><turbo:content><![CDATA[<p>Mikrotik получает маршрут <code>0.0.0.0/0 &lt;- 89.208.234.1</code> от провайдера по DHCP. Как включить проверку шлюза <code>89.208.234.1</code> при помощи параметра <strong>Check Gateway</strong>?</p>]]></turbo:content></item><item turbo="true"><title>Автоматическое закрытие конференц-комнаты в Asterisk</title><link>https://lib.onl/ru/2024/10/0a633c87-935c-54ba-bedf-9c95152b6b51/</link><pubDate>Tue, 01 Oct 2024 08:40:04 +0000</pubDate><dc:creator>Kai Kimera</dc:creator><category>Скрипты</category><category>Linux</category><yandex:related><link url="https://lib.onl/ru/2024/04/2e00b43b-b0da-59c2-ae92-60dcf2ba1d52/">Установка и настройка Asterisk</link><link url="https://lib.onl/ru/2024/06/b29b331d-ac93-5193-83ef-beab5a0f8dff/">Linux: Пользователи и группы</link><link url="https://lib.onl/ru/2024/03/6c7a038f-f41e-5a45-a285-b99fdacf82d4/">Работа с ZFS</link></yandex:related><turbo:extendedHtml>true</turbo:extendedHtml><turbo:source>https://lib.onl/ru/2024/10/0a633c87-935c-54ba-bedf-9c95152b6b51/</turbo:source><turbo:topic>Автоматическое закрытие конференц-комнаты в Asterisk</turbo:topic><turbo:content><![CDATA[<p>Скрипт закрывающий конференц-комнату при условии, что в ней остаётся один конкретный номер участника.</p>
<p>Поставлена задача, когда генеральный директор остаётся один в конференц-комнате, конференц-комната должна сама закрываться. Написал небольшой скрипт, который анализирует конференц-комнату на наличие определённых номеров и количества участников в конференц-комнате, и при обнаружении конкретного номера без других участников, закрывает конференц-комнату.</p>
<h2 id="установка">
  <a class="link-body-emphasis" href="#%d1%83%d1%81%d1%82%d0%b0%d0%bd%d0%be%d0%b2%d0%ba%d0%b0">Установка</a>
</h2><ul>
<li>Скопировать файлы <code>app.asterisk.room-close.conf</code> и <code>app.asterisk.room-close.sh</code> в директорию <code>/root/apps/asterisk/</code>.</li>
<li>Указать бит выполнения для <code>*.sh</code> скриптов: <code>chmod +x /root/apps/asterisk/*.sh</code>.</li>
<li>Скопировать файл <code>app_asterisk_room-close</code> в директорию <code>/etc/cron.d/</code>.</li>
<li>Настроить параметры скрипта в файле <code>app.asterisk.room-close.conf</code>.</li>
</ul>
<h2 id="скрипт">
  <a class="link-body-emphasis" href="#%d1%81%d0%ba%d1%80%d0%b8%d0%bf%d1%82">Скрипт</a>
</h2><p>Скрипт состоит из трёх компонентов:</p>
<ul>
<li>Файл с настройками.</li>
<li>Приложение.</li>
<li>Задача для CRON.</li>
</ul>
<h3 id="настройка">
  <a class="link-body-emphasis" href="#%d0%bd%d0%b0%d1%81%d1%82%d1%80%d0%be%d0%b9%d0%ba%d0%b0">Настройка</a>
</h3>
    

    
        
            
            <div class="shortcode shortcode-file mb-3">
              <div class="card overflow-hidden" data-bs-theme="dark">
                <div class="card-header">
                  <div class="d-flex align-items-center">
                    <div class="flex-shrink-0">
                      <i class="far fa-file-code fa-fw"></i>
                    </div>
                    <div class="flex-grow-1 mx-2 text-truncate">
                      <code>app.asterisk.room-close.conf</code>
                    </div>
                    <div class="flex-shrink-0">
                      <ul class="list-inline mb-0">
                        <li class="list-inline-item" title='Копировать'>
                          <a class="text-body" href="#"
                             data-fn="clipboard" data-clipboard-target="#cp-56dcc296de513815cb936c169667ea65"
                             role="button" aria-label='Копировать'>
                            <i class="fas fa-copy fa-fw"></i>
                          </a>
                        </li>
                        <li class="list-inline-item" title='Скачать'>
                          <a class="text-body" href="/ru/2024/10/0a633c87-935c-54ba-bedf-9c95152b6b51/app.asterisk.room-close.conf" download
                             role="button" aria-label='Скачать'>
                            <i class="fas fa-download fa-fw"></i>
                          </a>
                        </li>
                        <li class="list-inline-item" title='Открыть'>
                          <a class="text-body" href="/ru/2024/10/0a633c87-935c-54ba-bedf-9c95152b6b51/app.asterisk.room-close.conf" target="_blank"
                             role="button" aria-label='Открыть'>
                            <i class="fas fa-arrow-up-right-from-square fa-fw"></i>
                          </a>
                        </li>
                      </ul>
                    </div>
                  </div>
                </div>
                <div class="card-body p-0 overflow-auto" id="cp-56dcc296de513815cb936c169667ea65">
                    
                    <div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="nv">PHONES</span><span class="o">=(</span>
</span></span><span class="line"><span class="cl">  <span class="s1">&#39;1234&#39;</span>
</span></span><span class="line"><span class="cl">  <span class="s1">&#39;4567&#39;</span>
</span></span><span class="line"><span class="cl">  <span class="s1">&#39;7890&#39;</span>
</span></span><span class="line"><span class="cl"><span class="o">)</span></span></span></code></pre></td></tr></table>
</div>
</div>
                </div>
              </div>
            </div>
        
    
<h4 id="параметры">
  <a class="link-body-emphasis" href="#%d0%bf%d0%b0%d1%80%d0%b0%d0%bc%d0%b5%d1%82%d1%80%d1%8b">Параметры</a>
</h4><ul>
<li><code>PHONES</code> - массив, в котором содержаться номера телефонов. Если один из указанных номеров телефонов остаётся в конференции без остальных участников, то конференция закрывается.</li>
</ul>
<h3 id="приложение">
  <a class="link-body-emphasis" href="#%d0%bf%d1%80%d0%b8%d0%bb%d0%be%d0%b6%d0%b5%d0%bd%d0%b8%d0%b5">Приложение</a>
</h3><p>Приложение забирает параметры из файла настроек и обрабатывает значения.</p>

    

    
        
            
            <div class="shortcode shortcode-file mb-3">
              <div class="card overflow-hidden" data-bs-theme="dark">
                <div class="card-header">
                  <div class="d-flex align-items-center">
                    <div class="flex-shrink-0">
                      <i class="far fa-file-code fa-fw"></i>
                    </div>
                    <div class="flex-grow-1 mx-2 text-truncate">
                      <code>app.asterisk.room-close.sh</code>
                    </div>
                    <div class="flex-shrink-0">
                      <ul class="list-inline mb-0">
                        <li class="list-inline-item" title='Копировать'>
                          <a class="text-body" href="#"
                             data-fn="clipboard" data-clipboard-target="#cp-ed56eb22247e6912dd564b7749c3efc0"
                             role="button" aria-label='Копировать'>
                            <i class="fas fa-copy fa-fw"></i>
                          </a>
                        </li>
                        <li class="list-inline-item" title='Скачать'>
                          <a class="text-body" href="/ru/2024/10/0a633c87-935c-54ba-bedf-9c95152b6b51/app.asterisk.room-close.sh" download
                             role="button" aria-label='Скачать'>
                            <i class="fas fa-download fa-fw"></i>
                          </a>
                        </li>
                        <li class="list-inline-item" title='Открыть'>
                          <a class="text-body" href="/ru/2024/10/0a633c87-935c-54ba-bedf-9c95152b6b51/app.asterisk.room-close.sh" target="_blank"
                             role="button" aria-label='Открыть'>
                            <i class="fas fa-arrow-up-right-from-square fa-fw"></i>
                          </a>
                        </li>
                      </ul>
                    </div>
                  </div>
                </div>
                <div class="card-body p-0 overflow-auto" id="cp-ed56eb22247e6912dd564b7749c3efc0">
                    
                        
                    
                    <div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sh" data-lang="sh"><span class="line"><span class="cl"><span class="cp">#!/usr/bin/env -S bash -eu
</span></span></span><span class="line"><span class="cl"><span class="cp"></span><span class="c1"># -------------------------------------------------------------------------------------------------------------------- #</span>
</span></span><span class="line"><span class="cl"><span class="c1"># ASTERISK: CLOSING ROOM</span>
</span></span><span class="line"><span class="cl"><span class="c1"># If there is only 1 user left in the room, the room is closed.</span>
</span></span><span class="line"><span class="cl"><span class="c1"># -------------------------------------------------------------------------------------------------------------------- #</span>
</span></span><span class="line"><span class="cl"><span class="c1"># @package    Bash</span>
</span></span><span class="line"><span class="cl"><span class="c1"># @author     Kai Kimera</span>
</span></span><span class="line"><span class="cl"><span class="c1"># @license    MIT</span>
</span></span><span class="line"><span class="cl"><span class="c1"># @version    0.1.0</span>
</span></span><span class="line"><span class="cl"><span class="c1"># @link       https://lib.onl/ru/2024/10/0a633c87-935c-54ba-bedf-9c95152b6b51/</span>
</span></span><span class="line"><span class="cl"><span class="c1"># -------------------------------------------------------------------------------------------------------------------- #</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="o">((</span> EUID !<span class="o">=</span> <span class="m">0</span> <span class="o">))</span> <span class="o">&amp;&amp;</span> <span class="o">{</span> <span class="nb">echo</span> &gt;<span class="p">&amp;</span><span class="m">2</span> <span class="s1">&#39;This script should be run as root!&#39;</span><span class="p">;</span> <span class="nb">exit</span> 1<span class="p">;</span> <span class="o">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Sources.</span>
</span></span><span class="line"><span class="cl"><span class="nv">SRC_DIR</span><span class="o">=</span><span class="s2">&#34;</span><span class="k">$(</span> <span class="nb">cd</span> <span class="s2">&#34;</span><span class="k">$(</span> dirname <span class="s2">&#34;</span><span class="si">${</span><span class="nv">BASH_SOURCE</span><span class="p">[0]</span><span class="si">}</span><span class="s2">&#34;</span> <span class="k">)</span><span class="s2">&#34;</span> <span class="p">&amp;</span>&gt; /dev/null <span class="o">&amp;&amp;</span> <span class="nb">pwd</span> -P <span class="k">)</span><span class="s2">&#34;</span> <span class="c1"># Source directory.</span>
</span></span><span class="line"><span class="cl"><span class="nv">SRC_NAME</span><span class="o">=</span><span class="s2">&#34;</span><span class="k">$(</span> basename <span class="s2">&#34;</span><span class="k">$(</span> readlink -f <span class="s2">&#34;</span><span class="si">${</span><span class="nv">BASH_SOURCE</span><span class="p">[0]</span><span class="si">}</span><span class="s2">&#34;</span> <span class="k">)</span><span class="s2">&#34;</span> <span class="k">)</span><span class="s2">&#34;</span> <span class="c1"># Source name.</span>
</span></span><span class="line"><span class="cl"><span class="c1"># shellcheck source=/dev/null</span>
</span></span><span class="line"><span class="cl">. <span class="s2">&#34;</span><span class="si">${</span><span class="nv">SRC_DIR</span><span class="si">}</span><span class="s2">/</span><span class="si">${</span><span class="nv">SRC_NAME</span><span class="p">%.*</span><span class="si">}</span><span class="s2">.conf&#34;</span> <span class="c1"># Loading configuration file.</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Parameters.</span>
</span></span><span class="line"><span class="cl"><span class="nv">PHONES</span><span class="o">=(</span><span class="s2">&#34;</span><span class="si">${</span><span class="nv">PHONES</span><span class="p">[@]:?</span><span class="si">}</span><span class="s2">&#34;</span><span class="o">)</span><span class="p">;</span> <span class="nb">readonly</span> PHONES
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Variables.</span>
</span></span><span class="line"><span class="cl">mapfile -t ROOMS &lt; &lt;<span class="o">(</span> grep <span class="s1">&#39;^conf =&gt;&#39;</span> <span class="s1">&#39;/etc/asterisk/meetme.conf&#39;</span> <span class="p">|</span> cut -d <span class="s1">&#39; &#39;</span> -f <span class="m">3</span> <span class="o">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># -------------------------------------------------------------------------------------------------------------------- #</span>
</span></span><span class="line"><span class="cl"><span class="c1"># INITIALIZATION</span>
</span></span><span class="line"><span class="cl"><span class="c1"># -------------------------------------------------------------------------------------------------------------------- #</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">run<span class="o">()</span> <span class="o">{</span> close<span class="p">;</span> <span class="o">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># -------------------------------------------------------------------------------------------------------------------- #</span>
</span></span><span class="line"><span class="cl"><span class="c1"># ROOM CLOSE</span>
</span></span><span class="line"><span class="cl"><span class="c1"># -------------------------------------------------------------------------------------------------------------------- #</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">close<span class="o">()</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">  <span class="k">for</span> room in <span class="s2">&#34;</span><span class="si">${</span><span class="nv">ROOMS</span><span class="p">[@]</span><span class="si">}</span><span class="s2">&#34;</span><span class="p">;</span> <span class="k">do</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> phone in <span class="s2">&#34;</span><span class="si">${</span><span class="nv">PHONES</span><span class="p">[@]</span><span class="si">}</span><span class="s2">&#34;</span><span class="p">;</span> <span class="k">do</span>
</span></span><span class="line"><span class="cl">      <span class="nb">local</span> users<span class="p">;</span> <span class="nv">users</span><span class="o">=</span><span class="k">$(</span> asterisk -x <span class="s2">&#34;meetme list </span><span class="si">${</span><span class="nv">room</span><span class="si">}</span><span class="s2">&#34;</span> <span class="p">|</span> head -n -1 <span class="p">|</span> awk <span class="s1">&#39;{ print NR }&#39;</span> <span class="k">)</span>
</span></span><span class="line"><span class="cl">      <span class="nb">local</span> last<span class="p">;</span> <span class="nv">last</span><span class="o">=</span><span class="k">$(</span> asterisk -x <span class="s2">&#34;meetme list </span><span class="si">${</span><span class="nv">room</span><span class="si">}</span><span class="s2">&#34;</span> <span class="p">|</span> grep <span class="s2">&#34;</span><span class="si">${</span><span class="nv">phone</span><span class="si">}</span><span class="s2">&#34;</span> <span class="p">|</span> awk <span class="s1">&#39;{ print $4 }&#39;</span> <span class="k">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">      <span class="k">case</span> <span class="si">${</span><span class="nv">users</span><span class="si">}</span> in
</span></span><span class="line"><span class="cl">        1<span class="o">)</span> <span class="o">[[</span> <span class="si">${</span><span class="nv">phone</span><span class="si">}</span> -eq <span class="si">${</span><span class="nv">last</span><span class="si">}</span> <span class="o">]]</span> <span class="o">&amp;&amp;</span> asterisk -x <span class="s2">&#34;meetme kick </span><span class="si">${</span><span class="nv">room</span><span class="si">}</span><span class="s2"> all&#34;</span> <span class="p">;;</span>
</span></span><span class="line"><span class="cl">        *<span class="o">)</span> <span class="k">continue</span> <span class="p">;;</span>
</span></span><span class="line"><span class="cl">      <span class="k">esac</span>
</span></span><span class="line"><span class="cl">    <span class="k">done</span>
</span></span><span class="line"><span class="cl">  <span class="k">done</span>
</span></span><span class="line"><span class="cl"><span class="o">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># -------------------------------------------------------------------------------------------------------------------- #</span>
</span></span><span class="line"><span class="cl"><span class="c1"># -------------------------------------------------&lt; RUNNING SCRIPT &gt;------------------------------------------------- #</span>
</span></span><span class="line"><span class="cl"><span class="c1"># -------------------------------------------------------------------------------------------------------------------- #</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">run <span class="o">&amp;&amp;</span> <span class="nb">exit</span> <span class="m">0</span> <span class="o">||</span> <span class="nb">exit</span> <span class="m">1</span></span></span></code></pre></td></tr></table>
</div>
</div>
                </div>
              </div>
            </div>
        
    
<h3 id="задача">
  <a class="link-body-emphasis" href="#%d0%b7%d0%b0%d0%b4%d0%b0%d1%87%d0%b0">Задача</a>
</h3><p>Задача запускает скрипт каждые 10 секунд для проверки конференц-комнат.</p>

    

    
        
            
            <div class="shortcode shortcode-file mb-3">
              <div class="card overflow-hidden" data-bs-theme="dark">
                <div class="card-header">
                  <div class="d-flex align-items-center">
                    <div class="flex-shrink-0">
                      <i class="far fa-file-code fa-fw"></i>
                    </div>
                    <div class="flex-grow-1 mx-2 text-truncate">
                      <code>app_asterisk_room-close</code>
                    </div>
                    <div class="flex-shrink-0">
                      <ul class="list-inline mb-0">
                        <li class="list-inline-item" title='Копировать'>
                          <a class="text-body" href="#"
                             data-fn="clipboard" data-clipboard-target="#cp-daf94fe2c4390312f6d0739001f317e0"
                             role="button" aria-label='Копировать'>
                            <i class="fas fa-copy fa-fw"></i>
                          </a>
                        </li>
                        <li class="list-inline-item" title='Скачать'>
                          <a class="text-body" href="/ru/2024/10/0a633c87-935c-54ba-bedf-9c95152b6b51/app_asterisk_room-close" download
                             role="button" aria-label='Скачать'>
                            <i class="fas fa-download fa-fw"></i>
                          </a>
                        </li>
                        <li class="list-inline-item" title='Открыть'>
                          <a class="text-body" href="/ru/2024/10/0a633c87-935c-54ba-bedf-9c95152b6b51/app_asterisk_room-close" target="_blank"
                             role="button" aria-label='Открыть'>
                            <i class="fas fa-arrow-up-right-from-square fa-fw"></i>
                          </a>
                        </li>
                      </ul>
                    </div>
                  </div>
                </div>
                <div class="card-body p-0 overflow-auto" id="cp-daf94fe2c4390312f6d0739001f317e0">
                    
                    <div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="nv">SHELL</span><span class="o">=</span>/bin/bash
</span></span><span class="line"><span class="cl"><span class="nv">PATH</span><span class="o">=</span>/bin:/sbin:/usr/bin:/usr/sbin:/usr/local/bin:/usr/local/sbin
</span></span><span class="line"><span class="cl"><span class="nv">HOME</span><span class="o">=</span>/root
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">* * * * * root <span class="k">for</span> i in <span class="o">{</span>1..6<span class="o">}</span><span class="p">;</span> <span class="k">do</span> <span class="s2">&#34;</span><span class="si">${</span><span class="nv">HOME</span><span class="si">}</span><span class="s2">/apps/asterisk/app.asterisk.room-close.sh&#34;</span> &gt; /dev/null 2&gt;<span class="p">&amp;</span><span class="m">1</span> <span class="p">&amp;</span> sleep 10<span class="p">;</span> <span class="k">done</span></span></span></code></pre></td></tr></table>
</div>
</div>
                </div>
              </div>
            </div>]]></turbo:content></item><item turbo="true"><title>Как найти и копировать письма между почтовыми ящиками в MS Exchange?</title><link>https://lib.onl/ru/2024/09/2b00140a-22a3-58ec-9741-6d1d180d60f6/</link><pubDate>Tue, 24 Sep 2024 13:29:25 +0000</pubDate><dc:creator>Kai Kimera</dc:creator><category>Exchange</category><category>Powershell</category><category>Mail</category><category>Search</category><yandex:related><link url="https://lib.onl/ru/2024/09/2d6ca7ec-235c-51ee-a732-eeb8f6e780c2/">Как мигрировать DHCP между двумя Windows Server?</link><link url="https://lib.onl/ru/2023/11/e153bb1d-7cea-5bd8-acce-2dbe63b26c91/">Как переименовать компьютер в PowerShell?</link><link url="https://lib.onl/ru/2023/11/8c2e7adc-9431-5bb7-a9b6-e9397b1116b3/">Как переключить PowerShell в кодировку UTF-8?</link><link url="https://lib.onl/ru/2023/10/edf74517-3e6e-5e1c-aa6b-8ee0335670b4/">Многоточие в выводе PowerShell в табличном формате. Как исправить?</link></yandex:related><turbo:extendedHtml>true</turbo:extendedHtml><turbo:source>https://lib.onl/ru/2024/09/2b00140a-22a3-58ec-9741-6d1d180d60f6/</turbo:source><turbo:topic>Как найти и копировать письма между почтовыми ящиками в MS Exchange?</turbo:topic><turbo:content><![CDATA[<p>В почтовом ящике <code>user@domain.com</code> пропало часть писем. Но этим письма есть на резервном ящике <code>recovery@domain.com</code>. Как копировать письма из резервного ящика в основной?</p>]]></turbo:content></item><item turbo="true"><title>Как мигрировать DHCP между двумя Windows Server?</title><link>https://lib.onl/ru/2024/09/2d6ca7ec-235c-51ee-a732-eeb8f6e780c2/</link><pubDate>Tue, 24 Sep 2024 10:34:31 +0000</pubDate><dc:creator>Kai Kimera</dc:creator><category>Windows</category><category>Powershell</category><category>Dhcp</category><yandex:related><link url="https://lib.onl/ru/2023/11/e153bb1d-7cea-5bd8-acce-2dbe63b26c91/">Как переименовать компьютер в PowerShell?</link><link url="https://lib.onl/ru/2023/11/8c2e7adc-9431-5bb7-a9b6-e9397b1116b3/">Как переключить PowerShell в кодировку UTF-8?</link><link url="https://lib.onl/ru/2023/10/edf74517-3e6e-5e1c-aa6b-8ee0335670b4/">Многоточие в выводе PowerShell в табличном формате. Как исправить?</link></yandex:related><turbo:extendedHtml>true</turbo:extendedHtml><turbo:source>https://lib.onl/ru/2024/09/2d6ca7ec-235c-51ee-a732-eeb8f6e780c2/</turbo:source><turbo:topic>Как мигрировать DHCP между двумя Windows Server?</turbo:topic><turbo:content>&lt;p>Необходим перенос настроек DHCP со старого сервера на новый. Сервера под управлением Windows Server 2022. Как это сделать?&lt;/p></turbo:content></item><item turbo="true"><title>Как переместить VM на новый ESXi?</title><link>https://lib.onl/ru/2024/09/8ed324cb-7d1f-5da0-8773-9c08a08664cd/</link><pubDate>Wed, 18 Sep 2024 09:39:06 +0000</pubDate><dc:creator>Kai Kimera</dc:creator><category>Vm</category><category>Vmware</category><category>Esxi</category><turbo:extendedHtml>true</turbo:extendedHtml><turbo:source>https://lib.onl/ru/2024/09/8ed324cb-7d1f-5da0-8773-9c08a08664cd/</turbo:source><turbo:topic>Как переместить VM на новый ESXi?</turbo:topic><turbo:content>&lt;p>Встала задача переместить виртуальную машину со старого VMware ESXi на новый. Как это сделать?&lt;/p></turbo:content></item><item turbo="true"><title>Уведомления от Windows Server Backup</title><link>https://lib.onl/ru/2024/09/40539e36-4656-5532-b920-8975c97d4dc5/</link><pubDate>Tue, 17 Sep 2024 20:47:31 +0000</pubDate><dc:creator>Kai Kimera</dc:creator><category>Скрипты</category><category>MS Windows</category><category>Терминал</category><turbo:extendedHtml>true</turbo:extendedHtml><turbo:source>https://lib.onl/ru/2024/09/40539e36-4656-5532-b920-8975c97d4dc5/</turbo:source><turbo:topic>Уведомления от Windows Server Backup</turbo:topic><turbo:content><![CDATA[<p>Windows Server Backup хороша в качестве компонента резервного копирования, встроенного в ОС. Но работу этого компонента неплохо было бы отслеживать.</p>
<p>Я написал небольшой скрипт, позволяющий по крону отслеживать системный журнал и находить записи по работе <strong>Windows Server Backup</strong>.</p>
<h2 id="скрипт">
  <a class="link-body-emphasis" href="#%d1%81%d0%ba%d1%80%d0%b8%d0%bf%d1%82">Скрипт</a>
</h2><p>Скрипт анализирует системный журнал и фиксирует записи, принадлежащие <span class="shortcode shortcode-tag"><a href="/ru/tags/windows/" target="_blank">#Windows</a></span> Server Backup. Скрипт состоит из файла настроек, к которому можно ограничить доступ, приложения и двух задач.</p>
<h3 id="установка">
  <a class="link-body-emphasis" href="#%d1%83%d1%81%d1%82%d0%b0%d0%bd%d0%be%d0%b2%d0%ba%d0%b0">Установка</a>
</h3><ul>
<li>Скопировать файлы <code>app.backup.wsb.mail.ps1</code> и <code>app.backup.wsb.mail.ini</code> в директорию <code>C:\Scripts\</code>.</li>
<li>Импортировать задания <code>task.backup.wsb.mail.error.xml</code> и <code>task.backup.wsb.mail.success.xml</code> в <strong>Windows Task Scheduler</strong> и откорректировать параметры вызова скрипта.</li>
<li>Изменить параметры скрипта в файле <code>app.backup.wsb.mail.ini</code>.</li>
</ul>
<h3 id="настройка">
  <a class="link-body-emphasis" href="#%d0%bd%d0%b0%d1%81%d1%82%d1%80%d0%be%d0%b9%d0%ba%d0%b0">Настройка</a>
</h3><p>Файл настройки представляет собой простой файл <code>.ini</code>, содержащий в себе приватные параметры.</p>

    

    
        
            
            <div class="shortcode shortcode-file mb-3">
              <div class="card overflow-hidden" data-bs-theme="dark">
                <div class="card-header">
                  <div class="d-flex align-items-center">
                    <div class="flex-shrink-0">
                      <i class="far fa-file-code fa-fw"></i>
                    </div>
                    <div class="flex-grow-1 mx-2 text-truncate">
                      <code>app.backup.wsb.mail.ini</code>
                    </div>
                    <div class="flex-shrink-0">
                      <ul class="list-inline mb-0">
                        <li class="list-inline-item" title='Копировать'>
                          <a class="text-body" href="#"
                             data-fn="clipboard" data-clipboard-target="#cp-d03303325a53cf2a3b65cbe1fc8f8aad"
                             role="button" aria-label='Копировать'>
                            <i class="fas fa-copy fa-fw"></i>
                          </a>
                        </li>
                        <li class="list-inline-item" title='Скачать'>
                          <a class="text-body" href="/ru/2024/09/40539e36-4656-5532-b920-8975c97d4dc5/app.backup.wsb.mail.ini" download
                             role="button" aria-label='Скачать'>
                            <i class="fas fa-download fa-fw"></i>
                          </a>
                        </li>
                        <li class="list-inline-item" title='Открыть'>
                          <a class="text-body" href="/ru/2024/09/40539e36-4656-5532-b920-8975c97d4dc5/app.backup.wsb.mail.ini" target="_blank"
                             role="button" aria-label='Открыть'>
                            <i class="fas fa-arrow-up-right-from-square fa-fw"></i>
                          </a>
                        </li>
                      </ul>
                    </div>
                  </div>
                </div>
                <div class="card-body p-0 overflow-auto" id="cp-d03303325a53cf2a3b65cbe1fc8f8aad">
                    
                        
                    
                    <div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-ini" data-lang="ini"><span class="line"><span class="cl"><span class="na">From</span><span class="o">=</span><span class="s">mail@domain.com</span>
</span></span><span class="line"><span class="cl"><span class="na">To</span><span class="o">=</span><span class="s">mail@domain.org</span>
</span></span><span class="line"><span class="cl"><span class="na">Server</span><span class="o">=</span><span class="s">192.168.11.22</span>
</span></span><span class="line"><span class="cl"><span class="na">Port</span><span class="o">=</span><span class="s">25</span>
</span></span><span class="line"><span class="cl"><span class="na">User</span><span class="o">=</span><span class="s">smtp_user</span>
</span></span><span class="line"><span class="cl"><span class="na">Password</span><span class="o">=</span><span class="s">smtp_password</span></span></span></code></pre></td></tr></table>
</div>
</div>
                </div>
              </div>
            </div>
        
    
<h4 id="параметры">
  <a class="link-body-emphasis" href="#%d0%bf%d0%b0%d1%80%d0%b0%d0%bc%d0%b5%d1%82%d1%80%d1%8b">Параметры</a>
</h4><ul>
<li><code>From</code> - адрес email, с которого будет отправлено сообщение.</li>
<li><code>To</code> - адрес email, на который будет отправлено сообщение.</li>
<li><code>Server</code> - IP-адрес SMTP-сервера.</li>
<li><code>Port</code> - порт SMTP-сервера.</li>
<li><code>User</code> - имя пользователя в SMTP-сервере.</li>
<li><code>Password</code> - пароль пользователя в SMTP-сервере.</li>
</ul>
<h3 id="приложение">
  <a class="link-body-emphasis" href="#%d0%bf%d1%80%d0%b8%d0%bb%d0%be%d0%b6%d0%b5%d0%bd%d0%b8%d0%b5">Приложение</a>
</h3>
    

    
        
            
            <div class="shortcode shortcode-file mb-3">
              <div class="card overflow-hidden" data-bs-theme="dark">
                <div class="card-header">
                  <div class="d-flex align-items-center">
                    <div class="flex-shrink-0">
                      <i class="far fa-file-code fa-fw"></i>
                    </div>
                    <div class="flex-grow-1 mx-2 text-truncate">
                      <code>app.backup.wsb.mail.ps1</code>
                    </div>
                    <div class="flex-shrink-0">
                      <ul class="list-inline mb-0">
                        <li class="list-inline-item" title='Копировать'>
                          <a class="text-body" href="#"
                             data-fn="clipboard" data-clipboard-target="#cp-2a9045fca7a3abe0c8cfaf3493788934"
                             role="button" aria-label='Копировать'>
                            <i class="fas fa-copy fa-fw"></i>
                          </a>
                        </li>
                        <li class="list-inline-item" title='Скачать'>
                          <a class="text-body" href="/ru/2024/09/40539e36-4656-5532-b920-8975c97d4dc5/app.backup.wsb.mail.ps1" download
                             role="button" aria-label='Скачать'>
                            <i class="fas fa-download fa-fw"></i>
                          </a>
                        </li>
                        <li class="list-inline-item" title='Открыть'>
                          <a class="text-body" href="/ru/2024/09/40539e36-4656-5532-b920-8975c97d4dc5/app.backup.wsb.mail.ps1" target="_blank"
                             role="button" aria-label='Открыть'>
                            <i class="fas fa-arrow-up-right-from-square fa-fw"></i>
                          </a>
                        </li>
                      </ul>
                    </div>
                  </div>
                </div>
                <div class="card-body p-0 overflow-auto" id="cp-2a9045fca7a3abe0c8cfaf3493788934">
                    
                        
                    
                    <div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">  1
</span><span class="lnt">  2
</span><span class="lnt">  3
</span><span class="lnt">  4
</span><span class="lnt">  5
</span><span class="lnt">  6
</span><span class="lnt">  7
</span><span class="lnt">  8
</span><span class="lnt">  9
</span><span class="lnt"> 10
</span><span class="lnt"> 11
</span><span class="lnt"> 12
</span><span class="lnt"> 13
</span><span class="lnt"> 14
</span><span class="lnt"> 15
</span><span class="lnt"> 16
</span><span class="lnt"> 17
</span><span class="lnt"> 18
</span><span class="lnt"> 19
</span><span class="lnt"> 20
</span><span class="lnt"> 21
</span><span class="lnt"> 22
</span><span class="lnt"> 23
</span><span class="lnt"> 24
</span><span class="lnt"> 25
</span><span class="lnt"> 26
</span><span class="lnt"> 27
</span><span class="lnt"> 28
</span><span class="lnt"> 29
</span><span class="lnt"> 30
</span><span class="lnt"> 31
</span><span class="lnt"> 32
</span><span class="lnt"> 33
</span><span class="lnt"> 34
</span><span class="lnt"> 35
</span><span class="lnt"> 36
</span><span class="lnt"> 37
</span><span class="lnt"> 38
</span><span class="lnt"> 39
</span><span class="lnt"> 40
</span><span class="lnt"> 41
</span><span class="lnt"> 42
</span><span class="lnt"> 43
</span><span class="lnt"> 44
</span><span class="lnt"> 45
</span><span class="lnt"> 46
</span><span class="lnt"> 47
</span><span class="lnt"> 48
</span><span class="lnt"> 49
</span><span class="lnt"> 50
</span><span class="lnt"> 51
</span><span class="lnt"> 52
</span><span class="lnt"> 53
</span><span class="lnt"> 54
</span><span class="lnt"> 55
</span><span class="lnt"> 56
</span><span class="lnt"> 57
</span><span class="lnt"> 58
</span><span class="lnt"> 59
</span><span class="lnt"> 60
</span><span class="lnt"> 61
</span><span class="lnt"> 62
</span><span class="lnt"> 63
</span><span class="lnt"> 64
</span><span class="lnt"> 65
</span><span class="lnt"> 66
</span><span class="lnt"> 67
</span><span class="lnt"> 68
</span><span class="lnt"> 69
</span><span class="lnt"> 70
</span><span class="lnt"> 71
</span><span class="lnt"> 72
</span><span class="lnt"> 73
</span><span class="lnt"> 74
</span><span class="lnt"> 75
</span><span class="lnt"> 76
</span><span class="lnt"> 77
</span><span class="lnt"> 78
</span><span class="lnt"> 79
</span><span class="lnt"> 80
</span><span class="lnt"> 81
</span><span class="lnt"> 82
</span><span class="lnt"> 83
</span><span class="lnt"> 84
</span><span class="lnt"> 85
</span><span class="lnt"> 86
</span><span class="lnt"> 87
</span><span class="lnt"> 88
</span><span class="lnt"> 89
</span><span class="lnt"> 90
</span><span class="lnt"> 91
</span><span class="lnt"> 92
</span><span class="lnt"> 93
</span><span class="lnt"> 94
</span><span class="lnt"> 95
</span><span class="lnt"> 96
</span><span class="lnt"> 97
</span><span class="lnt"> 98
</span><span class="lnt"> 99
</span><span class="lnt">100
</span><span class="lnt">101
</span><span class="lnt">102
</span><span class="lnt">103
</span><span class="lnt">104
</span><span class="lnt">105
</span><span class="lnt">106
</span><span class="lnt">107
</span><span class="lnt">108
</span><span class="lnt">109
</span><span class="lnt">110
</span><span class="lnt">111
</span><span class="lnt">112
</span><span class="lnt">113
</span><span class="lnt">114
</span><span class="lnt">115
</span><span class="lnt">116
</span><span class="lnt">117
</span><span class="lnt">118
</span><span class="lnt">119
</span><span class="lnt">120
</span><span class="lnt">121
</span><span class="lnt">122
</span><span class="lnt">123
</span><span class="lnt">124
</span><span class="lnt">125
</span><span class="lnt">126
</span><span class="lnt">127
</span><span class="lnt">128
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-ps1" data-lang="ps1"><span class="line"><span class="cl"><span class="cm">&lt;#PSScriptInfo
</span></span></span><span class="line"><span class="cl"><span class="cm">.VERSION      0.1.0
</span></span></span><span class="line"><span class="cl"><span class="cm">.GUID         18c25998-a474-425e-a59f-e32f79c8431d
</span></span></span><span class="line"><span class="cl"><span class="cm">.AUTHOR       Kai Kimera
</span></span></span><span class="line"><span class="cl"><span class="cm">.AUTHOREMAIL  mail@kai.kim
</span></span></span><span class="line"><span class="cl"><span class="cm">.COMPANYNAME  Library Online
</span></span></span><span class="line"><span class="cl"><span class="cm">.COPYRIGHT    2024 Library Online. All rights reserved.
</span></span></span><span class="line"><span class="cl"><span class="cm">.TAGS         windows server backup mail
</span></span></span><span class="line"><span class="cl"><span class="cm">.LICENSEURI   https://choosealicense.com/licenses/mit/
</span></span></span><span class="line"><span class="cl"><span class="cm">.PROJECTURI   https://lib.onl/ru/2024/09/40539e36-4656-5532-b920-8975c97d4dc5/
</span></span></span><span class="line"><span class="cl"><span class="cm">#&gt;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="cm">&lt;#
</span></span></span><span class="line"><span class="cl"><span class="cm">.</span><span class="sd">SYNOPSIS</span><span class="cm">
</span></span></span><span class="line"><span class="cl"><span class="cm">Script for sending messages about backup status.
</span></span></span><span class="line"><span class="cl"><span class="cm">
</span></span></span><span class="line"><span class="cl"><span class="cm">.</span><span class="sd">DESCRIPTION</span><span class="cm">
</span></span></span><span class="line"><span class="cl"><span class="cm">The script sends messages to the specified address for further analysis.
</span></span></span><span class="line"><span class="cl"><span class="cm">The messages contain the host ID and notification type.
</span></span></span><span class="line"><span class="cl"><span class="cm">
</span></span></span><span class="line"><span class="cl"><span class="cm">.</span><span class="sd">EXAMPLE</span><span class="cm">
</span></span></span><span class="line"><span class="cl"><span class="cm">.\app.backup.wsb.mail.ps1 -Type &#39;error&#39; [-SSL]
</span></span></span><span class="line"><span class="cl"><span class="cm">
</span></span></span><span class="line"><span class="cl"><span class="cm">.</span><span class="sd">EXAMPLE</span><span class="cm">
</span></span></span><span class="line"><span class="cl"><span class="cm">.\app.backup.wsb.mail.ps1 -Type &#39;success&#39; [-SSL]
</span></span></span><span class="line"><span class="cl"><span class="cm">
</span></span></span><span class="line"><span class="cl"><span class="cm">.</span><span class="sd">LINK</span><span class="cm">
</span></span></span><span class="line"><span class="cl"><span class="cm">https://lib.onl/ru/2024/09/40539e36-4656-5532-b920-8975c97d4dc5/
</span></span></span><span class="line"><span class="cl"><span class="cm">#&gt;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c"># -------------------------------------------------------------------------------------------------------------------- #</span>
</span></span><span class="line"><span class="cl"><span class="c"># CONFIGURATION</span>
</span></span><span class="line"><span class="cl"><span class="c"># -------------------------------------------------------------------------------------------------------------------- #</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">param</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">  <span class="p">[</span><span class="nb">Parameter</span><span class="p">(</span><span class="na">HelpMessage</span><span class="p">=</span><span class="s1">&#39;Message type.&#39;</span><span class="p">)]</span>
</span></span><span class="line"><span class="cl">  <span class="p">[</span><span class="nb">ValidateSet</span><span class="p">(</span><span class="s1">&#39;error&#39;</span><span class="p">,</span> <span class="s1">&#39;success&#39;</span><span class="p">)]</span>
</span></span><span class="line"><span class="cl">  <span class="p">[</span><span class="no">string</span><span class="p">]</span><span class="nv">$Type</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">  <span class="p">[</span><span class="nb">Parameter</span><span class="p">(</span><span class="na">HelpMessage</span><span class="p">=</span><span class="s1">&#39;Enable or disable encrypted connection.&#39;</span><span class="p">)]</span>
</span></span><span class="line"><span class="cl">  <span class="p">[</span><span class="no">switch</span><span class="p">]</span><span class="nv">$SSL</span> <span class="p">=</span> <span class="vm">$false</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">  <span class="p">[</span><span class="nb">Alias</span><span class="p">(</span><span class="s1">&#39;Host&#39;</span><span class="p">)][</span><span class="no">string</span><span class="p">]</span><span class="nv">$Hostname</span> <span class="p">=</span> <span class="p">([</span><span class="no">System.Net.Dns</span><span class="p">]::</span><span class="n">GetHostByName</span><span class="p">([</span><span class="no">string</span><span class="p">]</span><span class="s1">&#39;localhost&#39;</span><span class="p">).</span><span class="n">HostName</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c"># Loading configuration data.</span>
</span></span><span class="line"><span class="cl"><span class="nv">$S</span> <span class="p">=</span> <span class="p">((</span><span class="nb">Get-Item</span> <span class="s2">&#34;</span><span class="nv">${PSCommandPath}</span><span class="s2">&#34;</span><span class="p">).</span><span class="py">Basename</span> <span class="p">+</span> <span class="s1">&#39;.ini&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nv">$P</span> <span class="p">=</span> <span class="p">(</span><span class="nb">Get-Content</span> <span class="n">-Path</span> <span class="s2">&#34;</span><span class="nv">${PSScriptRoot}</span><span class="s2">\</span><span class="nv">${S}</span><span class="s2">&#34;</span> <span class="p">|</span> <span class="nb">ConvertFrom-StringData</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c"># Generating HostID (HID).</span>
</span></span><span class="line"><span class="cl"><span class="nv">$UUID</span> <span class="p">=</span> <span class="p">(</span><span class="nb">Get-CimInstance</span> <span class="s1">&#39;Win32_ComputerSystemProduct&#39;</span> <span class="p">|</span> <span class="nb">Select-Object</span> <span class="n">-ExpandProperty</span> <span class="s1">&#39;UUID&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nv">$HID</span> <span class="p">=</span> <span class="p">((${</span><span class="n">Hostname</span><span class="p">}</span> <span class="p">+</span> <span class="s1">&#39;:&#39;</span> <span class="p">+</span> <span class="p">${</span><span class="n">UUID</span><span class="p">}).</span><span class="py">ToUpper</span><span class="p">())</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c"># -------------------------------------------------------------------------------------------------------------------- #</span>
</span></span><span class="line"><span class="cl"><span class="c"># INITIALIZATION</span>
</span></span><span class="line"><span class="cl"><span class="c"># -------------------------------------------------------------------------------------------------------------------- #</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kd">function</span><span class="w"> </span><span class="nb">Start-Script</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="k">switch</span> <span class="p">(</span><span class="s2">&#34;</span><span class="nv">${Type}</span><span class="s2">&#34;</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="s1">&#39;error&#39;</span>   <span class="p">{</span> <span class="nb">Send-BackupError</span> <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="s1">&#39;success&#39;</span> <span class="p">{</span> <span class="nb">Send-BackupSuccess</span> <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="k">default</span>   <span class="p">{</span> <span class="n">exit</span> <span class="p">}</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c"># -------------------------------------------------------------------------------------------------------------------- #</span>
</span></span><span class="line"><span class="cl"><span class="c"># BACKUP: ERROR</span>
</span></span><span class="line"><span class="cl"><span class="c"># Sending an email after a failed backup.</span>
</span></span><span class="line"><span class="cl"><span class="c"># -------------------------------------------------------------------------------------------------------------------- #</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kd">function</span><span class="w"> </span><span class="nb">Send-BackupError</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="nv">$Subject</span> <span class="p">=</span> <span class="s2">&#34;Windows Server Backup: </span><span class="nv">${Hostname}</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl">  <span class="nv">$Body</span> <span class="p">=</span> <span class="sh">@&#34;
</span></span></span><span class="line"><span class="cl"><span class="sh">Windows Server Backup failed: </span><span class="nv">${Hostname}</span><span class="sh">.
</span></span></span><span class="line"><span class="cl"><span class="sh">Please check server backup!
</span></span></span><span class="line"><span class="cl"><span class="sh">
</span></span></span><span class="line"><span class="cl"><span class="sh">Host: </span><span class="nv">${Hostname}</span><span class="sh">
</span></span></span><span class="line"><span class="cl"><span class="sh">Status: ERROR
</span></span></span><span class="line"><span class="cl"><span class="sh">
</span></span></span><span class="line"><span class="cl"><span class="sh">-- 
</span></span></span><span class="line"><span class="cl"><span class="sh">#ID:</span><span class="nv">${HID}</span><span class="sh">
</span></span></span><span class="line"><span class="cl"><span class="sh">#TYPE:BACKUP:ERROR
</span></span></span><span class="line"><span class="cl"><span class="sh">&#34;@</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="nb">Start-Smtp</span> <span class="n">-S</span> <span class="s2">&#34;</span><span class="nv">${Subject}</span><span class="s2">&#34;</span> <span class="n">-B</span> <span class="s2">&#34;</span><span class="nv">${Body}</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c"># -------------------------------------------------------------------------------------------------------------------- #</span>
</span></span><span class="line"><span class="cl"><span class="c"># BACKUP: SUCCESS</span>
</span></span><span class="line"><span class="cl"><span class="c"># Sending an email after a successful backup.</span>
</span></span><span class="line"><span class="cl"><span class="c"># -------------------------------------------------------------------------------------------------------------------- #</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kd">function</span><span class="w"> </span><span class="nb">Send-BackupSuccess</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="nv">$Subject</span> <span class="p">=</span> <span class="s2">&#34;Windows Server Backup: </span><span class="nv">${Hostname}</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl">  <span class="nv">$Body</span> <span class="p">=</span> <span class="sh">@&#34;
</span></span></span><span class="line"><span class="cl"><span class="sh">Windows Server Backup completed successfully!
</span></span></span><span class="line"><span class="cl"><span class="sh">
</span></span></span><span class="line"><span class="cl"><span class="sh">Host: </span><span class="nv">${Hostname}</span><span class="sh">
</span></span></span><span class="line"><span class="cl"><span class="sh">Status: SUCCESS
</span></span></span><span class="line"><span class="cl"><span class="sh">
</span></span></span><span class="line"><span class="cl"><span class="sh">-- 
</span></span></span><span class="line"><span class="cl"><span class="sh">#ID:</span><span class="nv">${HID}</span><span class="sh">
</span></span></span><span class="line"><span class="cl"><span class="sh">#TYPE:BACKUP:SUCCESS
</span></span></span><span class="line"><span class="cl"><span class="sh">&#34;@</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="nb">Start-Smtp</span> <span class="n">-S</span> <span class="s2">&#34;</span><span class="nv">${Subject}</span><span class="s2">&#34;</span> <span class="n">-B</span> <span class="s2">&#34;</span><span class="nv">${Body}</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c"># -------------------------------------------------------------------------------------------------------------------- #</span>
</span></span><span class="line"><span class="cl"><span class="c"># SMTP</span>
</span></span><span class="line"><span class="cl"><span class="c"># SMTP configuration.</span>
</span></span><span class="line"><span class="cl"><span class="c"># -------------------------------------------------------------------------------------------------------------------- #</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kd">function</span><span class="w"> </span><span class="nb">Start-Smtp</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="k">param</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">    <span class="p">[</span><span class="nb">Alias</span><span class="p">(</span><span class="s1">&#39;S&#39;</span><span class="p">)][</span><span class="no">string</span><span class="p">]</span><span class="nv">$Subject</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="p">[</span><span class="nb">Alias</span><span class="p">(</span><span class="s1">&#39;B&#39;</span><span class="p">)][</span><span class="no">string</span><span class="p">]</span><span class="nv">$Body</span>
</span></span><span class="line"><span class="cl">  <span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="nv">$SmtpClient</span> <span class="p">=</span> <span class="nb">New-Object</span> <span class="n">Net</span><span class="p">.</span><span class="py">Mail</span><span class="p">.</span><span class="py">SmtpClient</span><span class="p">(</span><span class="s2">&#34;</span><span class="p">$(</span><span class="nv">$P</span><span class="p">.</span><span class="n">Server</span><span class="p">)</span><span class="s2">&#34;</span><span class="p">,</span> <span class="s2">&#34;</span><span class="p">$(</span><span class="nv">$P</span><span class="p">.</span><span class="n">Port</span><span class="p">)</span><span class="s2">&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="nv">$SmtpClient</span><span class="p">.</span><span class="py">EnableSsl</span> <span class="p">=</span> <span class="nv">$SSL</span>
</span></span><span class="line"><span class="cl">  <span class="nv">$SmtpClient</span><span class="p">.</span><span class="py">Credentials</span> <span class="p">=</span> <span class="nb">New-Object</span> <span class="n">System</span><span class="p">.</span><span class="py">Net</span><span class="p">.</span><span class="py">NetworkCredential</span><span class="p">(</span><span class="s2">&#34;</span><span class="p">$(</span><span class="nv">$P</span><span class="p">.</span><span class="n">User</span><span class="p">)</span><span class="s2">&#34;</span><span class="p">,</span> <span class="s2">&#34;</span><span class="p">$(</span><span class="nv">$P</span><span class="p">.</span><span class="n">Password</span><span class="p">)</span><span class="s2">&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="nv">$SmtpClient</span><span class="p">.</span><span class="py">Send</span><span class="p">(</span><span class="s2">&#34;</span><span class="p">$(</span><span class="nv">$P</span><span class="p">.</span><span class="n">From</span><span class="p">)</span><span class="s2">&#34;</span><span class="p">,</span> <span class="s2">&#34;</span><span class="p">$(</span><span class="nv">$P</span><span class="p">.</span><span class="n">To</span><span class="p">)</span><span class="s2">&#34;</span><span class="p">,</span> <span class="s2">&#34;</span><span class="nv">${Subject}</span><span class="s2">&#34;</span><span class="p">,</span> <span class="s2">&#34;</span><span class="nv">${Body}</span><span class="s2">&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c"># -------------------------------------------------------------------------------------------------------------------- #</span>
</span></span><span class="line"><span class="cl"><span class="c"># -------------------------------------------------&lt; RUNNING SCRIPT &gt;------------------------------------------------- #</span>
</span></span><span class="line"><span class="cl"><span class="c"># -------------------------------------------------------------------------------------------------------------------- #</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nb">Start-Script</span></span></span></code></pre></td></tr></table>
</div>
</div>
                </div>
              </div>
            </div>
        
    
<h4 id="параметры-1">
  <a class="link-body-emphasis" href="#%d0%bf%d0%b0%d1%80%d0%b0%d0%bc%d0%b5%d1%82%d1%80%d1%8b-1">Параметры</a>
</h4><ul>
<li><code>Type</code> - тип сообщения.
<ul>
<li><code>success</code> - задание <span class="shortcode shortcode-tag"><a href="/ru/tags/windows/" target="_blank">#Windows</a></span> Server Backup успешно выполнено.</li>
<li><code>error</code> - задание <span class="shortcode shortcode-tag"><a href="/ru/tags/windows/" target="_blank">#Windows</a></span> Server Backup не выполнено или выполнено с ошибками.</li>
</ul>
</li>
</ul>
<h3 id="задачи">
  <a class="link-body-emphasis" href="#%d0%b7%d0%b0%d0%b4%d0%b0%d1%87%d0%b8">Задачи</a>
</h3><p>Задачи делятся на два типа: <em><strong>ошибка</strong></em> и <em><strong>успешное выполнение</strong></em>. Каждая из задач будет искать записи <span class="shortcode shortcode-tag"><a href="/ru/tags/windows/" target="_blank">#Windows</a></span> Server Backup в журнале и запускаться в зависимости от идентификатора события (<code>EventID</code>).</p>
<h4 id="ошибка">
  <a class="link-body-emphasis" href="#%d0%be%d1%88%d0%b8%d0%b1%d0%ba%d0%b0">Ошибка</a>
</h4><p>Задача присылает уведомление в том случае, когда в журнале событий появляется запись об ошибке выполнения <span class="shortcode shortcode-tag"><a href="/ru/tags/windows/" target="_blank">#Windows</a></span> Server Backup.</p>

    

    
        
            
            <div class="shortcode shortcode-file mb-3">
              <div class="card overflow-hidden" data-bs-theme="dark">
                <div class="card-header">
                  <div class="d-flex align-items-center">
                    <div class="flex-shrink-0">
                      <i class="far fa-file-code fa-fw"></i>
                    </div>
                    <div class="flex-grow-1 mx-2 text-truncate">
                      <code>task.backup.wsb.mail.error.xml</code>
                    </div>
                    <div class="flex-shrink-0">
                      <ul class="list-inline mb-0">
                        <li class="list-inline-item" title='Копировать'>
                          <a class="text-body" href="#"
                             data-fn="clipboard" data-clipboard-target="#cp-7e033519d0f00252efebcf56dc77262d"
                             role="button" aria-label='Копировать'>
                            <i class="fas fa-copy fa-fw"></i>
                          </a>
                        </li>
                        <li class="list-inline-item" title='Скачать'>
                          <a class="text-body" href="/ru/2024/09/40539e36-4656-5532-b920-8975c97d4dc5/task.backup.wsb.mail.error.xml" download
                             role="button" aria-label='Скачать'>
                            <i class="fas fa-download fa-fw"></i>
                          </a>
                        </li>
                        <li class="list-inline-item" title='Открыть'>
                          <a class="text-body" href="/ru/2024/09/40539e36-4656-5532-b920-8975c97d4dc5/task.backup.wsb.mail.error.xml" target="_blank"
                             role="button" aria-label='Открыть'>
                            <i class="fas fa-arrow-up-right-from-square fa-fw"></i>
                          </a>
                        </li>
                      </ul>
                    </div>
                  </div>
                </div>
                <div class="card-body p-0 overflow-auto" id="cp-7e033519d0f00252efebcf56dc77262d">
                    
                        
                    
                    <div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-xml" data-lang="xml"><span class="line"><span class="cl"><span class="cp">&lt;?xml version=&#34;1.0&#34; encoding=&#34;UTF-16&#34;?&gt;</span>
</span></span><span class="line"><span class="cl"><span class="nt">&lt;Task</span> <span class="na">version=</span><span class="s">&#34;1.2&#34;</span> <span class="na">xmlns=</span><span class="s">&#34;http://schemas.microsoft.com/windows/2004/02/mit/task&#34;</span><span class="nt">&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="nt">&lt;RegistrationInfo&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;Description&gt;</span>Notifies backup admin of scheduled backup failure.<span class="nt">&lt;/Description&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="nt">&lt;/RegistrationInfo&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="nt">&lt;Triggers&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;EventTrigger&gt;</span>
</span></span><span class="line"><span class="cl">      <span class="nt">&lt;Enabled&gt;</span>true<span class="nt">&lt;/Enabled&gt;</span>
</span></span><span class="line"><span class="cl">      <span class="nt">&lt;Subscription&gt;</span><span class="ni">&amp;lt;</span>QueryList<span class="ni">&amp;gt;&amp;lt;</span>Query Id=&#34;0&#34; Path=&#34;Microsoft-Windows-Backup&#34;<span class="ni">&amp;gt;&amp;lt;</span>Select Path=&#34;Microsoft-Windows-Backup&#34;<span class="ni">&amp;gt;</span>*[System[Provider[@Name=&#39;Microsoft-Windows-Backup&#39;] and (EventID=5 or EventID=8 or EventID=9 or  (EventID <span class="ni">&amp;amp;</span>gt;= 17 and EventID <span class="ni">&amp;amp;</span>lt;= 22)  or EventID=49 or EventID=50 or EventID=52 or EventID=100 or EventID=517 or EventID=518 or EventID=521 or EventID=527 or EventID=528 or EventID=544 or EventID=545 or EventID=546 or EventID=561 or EventID=564 or EventID=612)]]<span class="ni">&amp;lt;</span>/Select<span class="ni">&amp;gt;&amp;lt;</span>/Query<span class="ni">&amp;gt;&amp;lt;</span>/QueryList<span class="ni">&amp;gt;</span><span class="nt">&lt;/Subscription&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;/EventTrigger&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="nt">&lt;/Triggers&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="nt">&lt;Settings&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;MultipleInstancesPolicy&gt;</span>IgnoreNew<span class="nt">&lt;/MultipleInstancesPolicy&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;DisallowStartIfOnBatteries&gt;</span>true<span class="nt">&lt;/DisallowStartIfOnBatteries&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;StopIfGoingOnBatteries&gt;</span>true<span class="nt">&lt;/StopIfGoingOnBatteries&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;AllowHardTerminate&gt;</span>true<span class="nt">&lt;/AllowHardTerminate&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;StartWhenAvailable&gt;</span>false<span class="nt">&lt;/StartWhenAvailable&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;RunOnlyIfNetworkAvailable&gt;</span>false<span class="nt">&lt;/RunOnlyIfNetworkAvailable&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;IdleSettings&gt;</span>
</span></span><span class="line"><span class="cl">      <span class="nt">&lt;StopOnIdleEnd&gt;</span>true<span class="nt">&lt;/StopOnIdleEnd&gt;</span>
</span></span><span class="line"><span class="cl">      <span class="nt">&lt;RestartOnIdle&gt;</span>false<span class="nt">&lt;/RestartOnIdle&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;/IdleSettings&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;AllowStartOnDemand&gt;</span>true<span class="nt">&lt;/AllowStartOnDemand&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;Enabled&gt;</span>true<span class="nt">&lt;/Enabled&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;Hidden&gt;</span>false<span class="nt">&lt;/Hidden&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;RunOnlyIfIdle&gt;</span>false<span class="nt">&lt;/RunOnlyIfIdle&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;WakeToRun&gt;</span>false<span class="nt">&lt;/WakeToRun&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="nt">&lt;/Settings&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="nt">&lt;Actions</span> <span class="na">Context=</span><span class="s">&#34;Author&#34;</span><span class="nt">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;Exec&gt;</span>
</span></span><span class="line"><span class="cl">      <span class="nt">&lt;Command&gt;</span>powershell<span class="nt">&lt;/Command&gt;</span>
</span></span><span class="line"><span class="cl">      <span class="nt">&lt;Arguments&gt;</span>&#34;C:\Scripts\app.backup.wsb.mail.ps1&#34; -Type &#39;error&#39;<span class="nt">&lt;/Arguments&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;/Exec&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="nt">&lt;/Actions&gt;</span>
</span></span><span class="line"><span class="cl"><span class="nt">&lt;/Task&gt;</span></span></span></code></pre></td></tr></table>
</div>
</div>
                </div>
              </div>
            </div>
        
    
<h4 id="успешно">
  <a class="link-body-emphasis" href="#%d1%83%d1%81%d0%bf%d0%b5%d1%88%d0%bd%d0%be">Успешно</a>
</h4><p>Задача присылает уведомление в том случае, когда в журнале событий появляется запись об успешном выполнении <span class="shortcode shortcode-tag"><a href="/ru/tags/windows/" target="_blank">#Windows</a></span> Server Backup.</p>

    

    
        
            
            <div class="shortcode shortcode-file mb-3">
              <div class="card overflow-hidden" data-bs-theme="dark">
                <div class="card-header">
                  <div class="d-flex align-items-center">
                    <div class="flex-shrink-0">
                      <i class="far fa-file-code fa-fw"></i>
                    </div>
                    <div class="flex-grow-1 mx-2 text-truncate">
                      <code>task.backup.wsb.mail.success.xml</code>
                    </div>
                    <div class="flex-shrink-0">
                      <ul class="list-inline mb-0">
                        <li class="list-inline-item" title='Копировать'>
                          <a class="text-body" href="#"
                             data-fn="clipboard" data-clipboard-target="#cp-2b28d4ea8195c4709fb6d3e57ad55b79"
                             role="button" aria-label='Копировать'>
                            <i class="fas fa-copy fa-fw"></i>
                          </a>
                        </li>
                        <li class="list-inline-item" title='Скачать'>
                          <a class="text-body" href="/ru/2024/09/40539e36-4656-5532-b920-8975c97d4dc5/task.backup.wsb.mail.success.xml" download
                             role="button" aria-label='Скачать'>
                            <i class="fas fa-download fa-fw"></i>
                          </a>
                        </li>
                        <li class="list-inline-item" title='Открыть'>
                          <a class="text-body" href="/ru/2024/09/40539e36-4656-5532-b920-8975c97d4dc5/task.backup.wsb.mail.success.xml" target="_blank"
                             role="button" aria-label='Открыть'>
                            <i class="fas fa-arrow-up-right-from-square fa-fw"></i>
                          </a>
                        </li>
                      </ul>
                    </div>
                  </div>
                </div>
                <div class="card-body p-0 overflow-auto" id="cp-2b28d4ea8195c4709fb6d3e57ad55b79">
                    
                        
                    
                    <div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-xml" data-lang="xml"><span class="line"><span class="cl"><span class="cp">&lt;?xml version=&#34;1.0&#34; encoding=&#34;UTF-16&#34;?&gt;</span>
</span></span><span class="line"><span class="cl"><span class="nt">&lt;Task</span> <span class="na">version=</span><span class="s">&#34;1.2&#34;</span> <span class="na">xmlns=</span><span class="s">&#34;http://schemas.microsoft.com/windows/2004/02/mit/task&#34;</span><span class="nt">&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="nt">&lt;RegistrationInfo&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;Description&gt;</span>Notifies backup admin of scheduled backup successful completion.<span class="nt">&lt;/Description&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="nt">&lt;/RegistrationInfo&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="nt">&lt;Triggers&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;EventTrigger&gt;</span>
</span></span><span class="line"><span class="cl">      <span class="nt">&lt;Enabled&gt;</span>true<span class="nt">&lt;/Enabled&gt;</span>
</span></span><span class="line"><span class="cl">      <span class="nt">&lt;Subscription&gt;</span><span class="ni">&amp;lt;</span>QueryList<span class="ni">&amp;gt;&amp;lt;</span>Query Id=&#34;0&#34; Path=&#34;Microsoft-Windows-Backup&#34;<span class="ni">&amp;gt;&amp;lt;</span>Select Path=&#34;Microsoft-Windows-Backup&#34;<span class="ni">&amp;gt;</span>*[System[Provider[@Name=&#39;Microsoft-Windows-Backup&#39;] and (EventID=4)]]<span class="ni">&amp;lt;</span>/Select<span class="ni">&amp;gt;&amp;lt;</span>/Query<span class="ni">&amp;gt;&amp;lt;</span>/QueryList<span class="ni">&amp;gt;</span><span class="nt">&lt;/Subscription&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;/EventTrigger&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="nt">&lt;/Triggers&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="nt">&lt;Settings&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;MultipleInstancesPolicy&gt;</span>IgnoreNew<span class="nt">&lt;/MultipleInstancesPolicy&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;DisallowStartIfOnBatteries&gt;</span>true<span class="nt">&lt;/DisallowStartIfOnBatteries&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;StopIfGoingOnBatteries&gt;</span>true<span class="nt">&lt;/StopIfGoingOnBatteries&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;AllowHardTerminate&gt;</span>true<span class="nt">&lt;/AllowHardTerminate&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;StartWhenAvailable&gt;</span>false<span class="nt">&lt;/StartWhenAvailable&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;RunOnlyIfNetworkAvailable&gt;</span>false<span class="nt">&lt;/RunOnlyIfNetworkAvailable&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;IdleSettings&gt;</span>
</span></span><span class="line"><span class="cl">      <span class="nt">&lt;StopOnIdleEnd&gt;</span>true<span class="nt">&lt;/StopOnIdleEnd&gt;</span>
</span></span><span class="line"><span class="cl">      <span class="nt">&lt;RestartOnIdle&gt;</span>false<span class="nt">&lt;/RestartOnIdle&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;/IdleSettings&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;AllowStartOnDemand&gt;</span>true<span class="nt">&lt;/AllowStartOnDemand&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;Enabled&gt;</span>true<span class="nt">&lt;/Enabled&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;Hidden&gt;</span>false<span class="nt">&lt;/Hidden&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;RunOnlyIfIdle&gt;</span>false<span class="nt">&lt;/RunOnlyIfIdle&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;WakeToRun&gt;</span>false<span class="nt">&lt;/WakeToRun&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="nt">&lt;/Settings&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="nt">&lt;Actions</span> <span class="na">Context=</span><span class="s">&#34;Author&#34;</span><span class="nt">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;Exec&gt;</span>
</span></span><span class="line"><span class="cl">      <span class="nt">&lt;Command&gt;</span>powershell<span class="nt">&lt;/Command&gt;</span>
</span></span><span class="line"><span class="cl">      <span class="nt">&lt;Arguments&gt;</span>&#34;C:\Scripts\app.backup.wsb.mail.ps1&#34; -Type &#39;success&#39;<span class="nt">&lt;/Arguments&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;/Exec&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="nt">&lt;/Actions&gt;</span>
</span></span><span class="line"><span class="cl"><span class="nt">&lt;/Task&gt;</span></span></span></code></pre></td></tr></table>
</div>
</div>
                </div>
              </div>
            </div>]]></turbo:content></item><item turbo="true"><title>Удаление временных данных ОС Windows</title><link>https://lib.onl/ru/2024/09/aaef951a-9caf-5765-8189-c91f3f305821/</link><pubDate>Tue, 17 Sep 2024 20:15:52 +0000</pubDate><dc:creator>Kai Kimera</dc:creator><category>Скрипты</category><category>MS Windows</category><category>Терминал</category><yandex:related><link url="https://lib.onl/ru/2023/10/430b916d-fd5c-5d44-8c24-8b98f41e0355/">Работа с сетевыми интерфейсами в PowerShell</link><link url="https://lib.onl/ru/2023/10/1f062637-3227-56d7-93e3-126d1c80f5a8/">Работа с переменной среды окружения PATH</link><link url="https://lib.onl/ru/2023/10/fb64d665-3e56-5fa5-a9eb-2e2e251949d8/">Автоматическая настройка Windows Server 2022 под рабочую станцию</link><link url="https://lib.onl/ru/2023/10/38fc94dd-8d37-5f9e-b556-676304976a9f/">Восстановление доверительных отношений между PC и Active Directory</link><link url="https://lib.onl/ru/2023/10/616da78a-eb16-575a-9119-65f0c0c7baee/">Изменение порта RDP</link><link url="https://lib.onl/ru/2023/10/c6e32349-8fc2-53f9-9a42-790878a64076/">PowerShell: Полезные функции</link><link url="https://lib.onl/ru/2023/10/52d75b90-0637-5ba6-91d6-b1bff40e1d67/">PowerShell: Стирание диска</link><link url="https://lib.onl/ru/2023/10/2a73410a-6611-570c-9ab4-dc8cc8998146/">PowerShell: Сжатие видео при помощи FFmpeg</link><link url="https://lib.onl/ru/2023/10/0028821e-c96c-5014-a1dd-8963c161b170/">PowerShell: Определение разрядности ОС Windows</link><link url="https://lib.onl/ru/2023/10/4c7aba7c-f5a6-589a-9975-fdb16f2e2862/">PowerShell Vault</link><link url="https://lib.onl/ru/2023/10/eb39e3f7-b194-53d4-8bad-01edf9fdac47/">Дефрагментация в ОС Windows</link><link url="https://lib.onl/ru/2023/10/75075788-9308-56b7-b531-2008cb35f7d0/">Установка сертификата НУЦ Минцифры</link><link url="https://lib.onl/ru/2022/05/36058650-3f35-5ed5-9565-0aa7d8800c28/">Windows Server 2022 для рабочей станции</link></yandex:related><turbo:extendedHtml>true</turbo:extendedHtml><turbo:source>https://lib.onl/ru/2024/09/aaef951a-9caf-5765-8189-c91f3f305821/</turbo:source><turbo:topic>Удаление временных данных ОС Windows</turbo:topic><turbo:content><![CDATA[<p>Для экономии места на дисках, можно автоматически очищать ОС от временных данных.</p>
<p>Написал небольшой скрипт, который удаляет временные данные ОС с системного диска и профилей пользователей.</p>
<h2 id="скрипт">
  <a class="link-body-emphasis" href="#%d1%81%d0%ba%d1%80%d0%b8%d0%bf%d1%82">Скрипт</a>
</h2><p>Скрипт представляет собой комплект приложения и задачи для импорта в планировщик задач ОС <span class="shortcode shortcode-tag"><a href="/ru/tags/windows/" target="_blank">#Windows</a></span>.</p>
<h3 id="установка">
  <a class="link-body-emphasis" href="#%d1%83%d1%81%d1%82%d0%b0%d0%bd%d0%be%d0%b2%d0%ba%d0%b0">Установка</a>
</h3><ul>
<li>Скопировать файл <code>app.temp.cleanup.ps1</code> в директорию <code>C:\Scripts\</code>.</li>
<li>Импортировать задания <code>task.temp.cleanup.xml</code> в <strong>Windows Task Scheduler</strong>, откорректировать параметры задачи.</li>
</ul>
<h3 id="приложение">
  <a class="link-body-emphasis" href="#%d0%bf%d1%80%d0%b8%d0%bb%d0%be%d0%b6%d0%b5%d0%bd%d0%b8%d0%b5">Приложение</a>
</h3><p>Скрипт забирает список профилей пользователей из реестра и удаляет в них временные данные. Следующие переменные можно откорректировать под задачу:</p>
<ul>
<li><code>$SystemTemp</code> - системные директории с временными данными.</li>
<li><code>$ProfileTemp</code> - директории с временными данными в профилях пользователей.</li>
<li><code>$ProfileExclude</code> - исключить профили пользователей из сканирования.</li>
</ul>

    

    
        
            
            <div class="shortcode shortcode-file mb-3">
              <div class="card overflow-hidden" data-bs-theme="dark">
                <div class="card-header">
                  <div class="d-flex align-items-center">
                    <div class="flex-shrink-0">
                      <i class="far fa-file-code fa-fw"></i>
                    </div>
                    <div class="flex-grow-1 mx-2 text-truncate">
                      <code>app.temp.cleanup.ps1</code>
                    </div>
                    <div class="flex-shrink-0">
                      <ul class="list-inline mb-0">
                        <li class="list-inline-item" title='Копировать'>
                          <a class="text-body" href="#"
                             data-fn="clipboard" data-clipboard-target="#cp-45b531e3a381f7c401249e1da3250864"
                             role="button" aria-label='Копировать'>
                            <i class="fas fa-copy fa-fw"></i>
                          </a>
                        </li>
                        <li class="list-inline-item" title='Скачать'>
                          <a class="text-body" href="/ru/2024/09/aaef951a-9caf-5765-8189-c91f3f305821/app.temp.cleanup.ps1" download
                             role="button" aria-label='Скачать'>
                            <i class="fas fa-download fa-fw"></i>
                          </a>
                        </li>
                        <li class="list-inline-item" title='Открыть'>
                          <a class="text-body" href="/ru/2024/09/aaef951a-9caf-5765-8189-c91f3f305821/app.temp.cleanup.ps1" target="_blank"
                             role="button" aria-label='Открыть'>
                            <i class="fas fa-arrow-up-right-from-square fa-fw"></i>
                          </a>
                        </li>
                      </ul>
                    </div>
                  </div>
                </div>
                <div class="card-body p-0 overflow-auto" id="cp-45b531e3a381f7c401249e1da3250864">
                    
                        
                    
                    <div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">  1
</span><span class="lnt">  2
</span><span class="lnt">  3
</span><span class="lnt">  4
</span><span class="lnt">  5
</span><span class="lnt">  6
</span><span class="lnt">  7
</span><span class="lnt">  8
</span><span class="lnt">  9
</span><span class="lnt"> 10
</span><span class="lnt"> 11
</span><span class="lnt"> 12
</span><span class="lnt"> 13
</span><span class="lnt"> 14
</span><span class="lnt"> 15
</span><span class="lnt"> 16
</span><span class="lnt"> 17
</span><span class="lnt"> 18
</span><span class="lnt"> 19
</span><span class="lnt"> 20
</span><span class="lnt"> 21
</span><span class="lnt"> 22
</span><span class="lnt"> 23
</span><span class="lnt"> 24
</span><span class="lnt"> 25
</span><span class="lnt"> 26
</span><span class="lnt"> 27
</span><span class="lnt"> 28
</span><span class="lnt"> 29
</span><span class="lnt"> 30
</span><span class="lnt"> 31
</span><span class="lnt"> 32
</span><span class="lnt"> 33
</span><span class="lnt"> 34
</span><span class="lnt"> 35
</span><span class="lnt"> 36
</span><span class="lnt"> 37
</span><span class="lnt"> 38
</span><span class="lnt"> 39
</span><span class="lnt"> 40
</span><span class="lnt"> 41
</span><span class="lnt"> 42
</span><span class="lnt"> 43
</span><span class="lnt"> 44
</span><span class="lnt"> 45
</span><span class="lnt"> 46
</span><span class="lnt"> 47
</span><span class="lnt"> 48
</span><span class="lnt"> 49
</span><span class="lnt"> 50
</span><span class="lnt"> 51
</span><span class="lnt"> 52
</span><span class="lnt"> 53
</span><span class="lnt"> 54
</span><span class="lnt"> 55
</span><span class="lnt"> 56
</span><span class="lnt"> 57
</span><span class="lnt"> 58
</span><span class="lnt"> 59
</span><span class="lnt"> 60
</span><span class="lnt"> 61
</span><span class="lnt"> 62
</span><span class="lnt"> 63
</span><span class="lnt"> 64
</span><span class="lnt"> 65
</span><span class="lnt"> 66
</span><span class="lnt"> 67
</span><span class="lnt"> 68
</span><span class="lnt"> 69
</span><span class="lnt"> 70
</span><span class="lnt"> 71
</span><span class="lnt"> 72
</span><span class="lnt"> 73
</span><span class="lnt"> 74
</span><span class="lnt"> 75
</span><span class="lnt"> 76
</span><span class="lnt"> 77
</span><span class="lnt"> 78
</span><span class="lnt"> 79
</span><span class="lnt"> 80
</span><span class="lnt"> 81
</span><span class="lnt"> 82
</span><span class="lnt"> 83
</span><span class="lnt"> 84
</span><span class="lnt"> 85
</span><span class="lnt"> 86
</span><span class="lnt"> 87
</span><span class="lnt"> 88
</span><span class="lnt"> 89
</span><span class="lnt"> 90
</span><span class="lnt"> 91
</span><span class="lnt"> 92
</span><span class="lnt"> 93
</span><span class="lnt"> 94
</span><span class="lnt"> 95
</span><span class="lnt"> 96
</span><span class="lnt"> 97
</span><span class="lnt"> 98
</span><span class="lnt"> 99
</span><span class="lnt">100
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-ps1" data-lang="ps1"><span class="line"><span class="cl"><span class="cm">&lt;#PSScriptInfo
</span></span></span><span class="line"><span class="cl"><span class="cm">.VERSION      0.1.0
</span></span></span><span class="line"><span class="cl"><span class="cm">.GUID         f5e8380e-4e2f-4c58-972e-a60ace8dee8e
</span></span></span><span class="line"><span class="cl"><span class="cm">.AUTHOR       Kai Kimera
</span></span></span><span class="line"><span class="cl"><span class="cm">.AUTHOREMAIL  mail@kai.kim
</span></span></span><span class="line"><span class="cl"><span class="cm">.COMPANYNAME  Library Online
</span></span></span><span class="line"><span class="cl"><span class="cm">.COPYRIGHT    2024 Library Online. All rights reserved.
</span></span></span><span class="line"><span class="cl"><span class="cm">.TAGS         windows temp cleanup
</span></span></span><span class="line"><span class="cl"><span class="cm">.LICENSEURI   https://choosealicense.com/licenses/mit/
</span></span></span><span class="line"><span class="cl"><span class="cm">.PROJECTURI   https://lib.onl/ru/2024/09/aaef951a-9caf-5765-8189-c91f3f305821/
</span></span></span><span class="line"><span class="cl"><span class="cm">#&gt;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="cm">&lt;#
</span></span></span><span class="line"><span class="cl"><span class="cm">.</span><span class="sd">SYNOPSIS</span><span class="cm">
</span></span></span><span class="line"><span class="cl"><span class="cm">Script for deleting temporary data.
</span></span></span><span class="line"><span class="cl"><span class="cm">
</span></span></span><span class="line"><span class="cl"><span class="cm">.</span><span class="sd">DESCRIPTION</span><span class="cm">
</span></span></span><span class="line"><span class="cl"><span class="cm">The script deletes data in the specified directories.
</span></span></span><span class="line"><span class="cl"><span class="cm">
</span></span></span><span class="line"><span class="cl"><span class="cm">.</span><span class="sd">EXAMPLE</span><span class="cm">
</span></span></span><span class="line"><span class="cl"><span class="cm">.\app.temp.cleanup.ps1
</span></span></span><span class="line"><span class="cl"><span class="cm">
</span></span></span><span class="line"><span class="cl"><span class="cm">.</span><span class="sd">LINK</span><span class="cm">
</span></span></span><span class="line"><span class="cl"><span class="cm">https://lib.onl/ru/2024/09/aaef951a-9caf-5765-8189-c91f3f305821/
</span></span></span><span class="line"><span class="cl"><span class="cm">#&gt;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c"># -------------------------------------------------------------------------------------------------------------------- #</span>
</span></span><span class="line"><span class="cl"><span class="c"># CONFIGURATION</span>
</span></span><span class="line"><span class="cl"><span class="c"># -------------------------------------------------------------------------------------------------------------------- #</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nv">$SystemTemp</span> <span class="p">=</span> <span class="vm">@</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">  <span class="s2">&#34;C:\Windows\Temp\*&#34;</span>
</span></span><span class="line"><span class="cl"><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nv">$ProfileTemp</span> <span class="p">=</span> <span class="vm">@</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">  <span class="s2">&#34;AppData\Local\Temp\*&#34;</span>
</span></span><span class="line"><span class="cl">  <span class="s2">&#34;AppData\Local\Mozilla\Firefox\Profiles\*.default-release\cache2\entries\*&#34;</span>
</span></span><span class="line"><span class="cl">  <span class="s2">&#34;AppData\Local\Microsoft\Windows\Explorer\*&#34;</span>
</span></span><span class="line"><span class="cl">  <span class="s2">&#34;AppData\Roaming\Mozilla\Firefox\Profiles\*.default-release\storage\default\*&#34;</span>
</span></span><span class="line"><span class="cl">  <span class="s2">&#34;AppData\Local\Google\Chrome\User Data\Default\Service Worker\CacheStorage\*&#34;</span>
</span></span><span class="line"><span class="cl">  <span class="s2">&#34;AppData\Local\Google\Chrome\User Data\Default\Cache\Cache_Data\*&#34;</span>
</span></span><span class="line"><span class="cl">  <span class="s2">&#34;AppData\Local\Google\Chrome\User Data\Default\Code Cache\js\*&#34;</span>
</span></span><span class="line"><span class="cl">  <span class="s2">&#34;AppData\LocalLow\Adobe\Acrobat\DC\ConnectorIcons\*&#34;</span>
</span></span><span class="line"><span class="cl">  <span class="s2">&#34;AppData\Local\Microsoft\Windows\INetCache\Content.Outlook\*&#34;</span>
</span></span><span class="line"><span class="cl"><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nv">$ProfileExclude</span> <span class="p">=</span> <span class="vm">@</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">  <span class="s1">&#39;Администратор&#39;</span>
</span></span><span class="line"><span class="cl">  <span class="s1">&#39;Administrator&#39;</span>
</span></span><span class="line"><span class="cl">  <span class="s1">&#39;Setup&#39;</span>
</span></span><span class="line"><span class="cl">  <span class="s1">&#39;Public&#39;</span>
</span></span><span class="line"><span class="cl">  <span class="s1">&#39;All Users&#39;</span>
</span></span><span class="line"><span class="cl">  <span class="s1">&#39;Default User&#39;</span>
</span></span><span class="line"><span class="cl"><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nv">$ProfileList</span> <span class="p">=</span> <span class="s1">&#39;HKLM:\SOFTWARE\Microsoft\Windows NT\CurrentVersion\ProfileList&#39;</span>
</span></span><span class="line"><span class="cl"><span class="nv">$Profiles</span> <span class="p">=</span> <span class="nb">Get-ChildItem</span> <span class="p">(</span><span class="nb">Get-ItemProperty</span> <span class="n">-Path</span> <span class="s2">&#34;</span><span class="nv">${ProfileList}</span><span class="s2">&#34;</span><span class="p">).</span><span class="py">ProfilesDirectory</span> <span class="n">-Exclude</span> <span class="nv">$ProfileExclude</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c"># -------------------------------------------------------------------------------------------------------------------- #</span>
</span></span><span class="line"><span class="cl"><span class="c"># INITIALIZATION</span>
</span></span><span class="line"><span class="cl"><span class="c"># -------------------------------------------------------------------------------------------------------------------- #</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kd">function</span><span class="w"> </span><span class="nb">Start-Script</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="nb">Start-CleanUp</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c"># -------------------------------------------------------------------------------------------------------------------- #</span>
</span></span><span class="line"><span class="cl"><span class="c"># CLEANUP</span>
</span></span><span class="line"><span class="cl"><span class="c"># -------------------------------------------------------------------------------------------------------------------- #</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kd">function</span><span class="w"> </span><span class="nb">Start-CleanUp</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="k">ForEach</span> <span class="p">(</span><span class="nv">$Path</span> <span class="k">in</span> <span class="nv">$SystemTemp</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nb">Remove-Data</span> <span class="n">-Path</span> <span class="s2">&#34;</span><span class="nv">${Path}</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="k">ForEach</span> <span class="p">(</span><span class="nv">$Profile</span> <span class="k">in</span> <span class="nv">$Profiles</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">ForEach</span> <span class="p">(</span><span class="nv">$Path</span> <span class="k">in</span> <span class="nv">$ProfileTemp</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="nv">$Path</span> <span class="p">=</span> <span class="p">(</span><span class="nb">Join-Path</span> <span class="n">-Path</span> <span class="s2">&#34;</span><span class="nv">${Profile}</span><span class="s2">&#34;</span> <span class="n">-ChildPath</span> <span class="s2">&#34;</span><span class="nv">${Path}</span><span class="s2">&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">      <span class="k">if</span> <span class="p">(</span><span class="nb">Test-Path</span> <span class="n">-Path</span> <span class="s2">&#34;</span><span class="nv">${Path}</span><span class="s2">&#34;</span><span class="p">)</span> <span class="p">{</span> <span class="nb">Remove-Data</span> <span class="n">-Path</span> <span class="s2">&#34;</span><span class="nv">${Path}</span><span class="s2">&#34;</span> <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c"># -------------------------------------------------------------------------------------------------------------------- #</span>
</span></span><span class="line"><span class="cl"><span class="c"># ------------------------------------------------&lt; COMMON FUNCTIONS &gt;------------------------------------------------ #</span>
</span></span><span class="line"><span class="cl"><span class="c"># -------------------------------------------------------------------------------------------------------------------- #</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kd">function</span><span class="w"> </span><span class="nb">Remove-Data</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="k">param</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">    <span class="p">[</span><span class="no">string</span><span class="p">]</span><span class="nv">$Path</span>
</span></span><span class="line"><span class="cl">  <span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="nb">Remove-Item</span> <span class="n">-Path</span> <span class="s2">&#34;</span><span class="nv">${Path}</span><span class="s2">&#34;</span> <span class="n">-Recurse</span> <span class="n">-Force</span> <span class="n">-ErrorAction</span> <span class="s1">&#39;SilentlyContinue&#39;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c"># -------------------------------------------------------------------------------------------------------------------- #</span>
</span></span><span class="line"><span class="cl"><span class="c"># -------------------------------------------------&lt; RUNNING SCRIPT &gt;------------------------------------------------- #</span>
</span></span><span class="line"><span class="cl"><span class="c"># -------------------------------------------------------------------------------------------------------------------- #</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nb">Start-Script</span></span></span></code></pre></td></tr></table>
</div>
</div>
                </div>
              </div>
            </div>
        
    
<h3 id="задача">
  <a class="link-body-emphasis" href="#%d0%b7%d0%b0%d0%b4%d0%b0%d1%87%d0%b0">Задача</a>
</h3><p>Для того, чтобы скрипт выполнялся автоматически по расписанию, я сделал XML-файл задачи. Его необходимо импортировать в планировщик задач Windows и откорректировать под свои требования:</p>

    

    
        
            
            <div class="shortcode shortcode-file mb-3">
              <div class="card overflow-hidden" data-bs-theme="dark">
                <div class="card-header">
                  <div class="d-flex align-items-center">
                    <div class="flex-shrink-0">
                      <i class="far fa-file-code fa-fw"></i>
                    </div>
                    <div class="flex-grow-1 mx-2 text-truncate">
                      <code>task.temp.cleanup.xml</code>
                    </div>
                    <div class="flex-shrink-0">
                      <ul class="list-inline mb-0">
                        <li class="list-inline-item" title='Копировать'>
                          <a class="text-body" href="#"
                             data-fn="clipboard" data-clipboard-target="#cp-fd5999ddaa31edc6c993da10eefe6a08"
                             role="button" aria-label='Копировать'>
                            <i class="fas fa-copy fa-fw"></i>
                          </a>
                        </li>
                        <li class="list-inline-item" title='Скачать'>
                          <a class="text-body" href="/ru/2024/09/aaef951a-9caf-5765-8189-c91f3f305821/task.temp.cleanup.xml" download
                             role="button" aria-label='Скачать'>
                            <i class="fas fa-download fa-fw"></i>
                          </a>
                        </li>
                        <li class="list-inline-item" title='Открыть'>
                          <a class="text-body" href="/ru/2024/09/aaef951a-9caf-5765-8189-c91f3f305821/task.temp.cleanup.xml" target="_blank"
                             role="button" aria-label='Открыть'>
                            <i class="fas fa-arrow-up-right-from-square fa-fw"></i>
                          </a>
                        </li>
                      </ul>
                    </div>
                  </div>
                </div>
                <div class="card-body p-0 overflow-auto" id="cp-fd5999ddaa31edc6c993da10eefe6a08">
                    
                        
                    
                    <div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-xml" data-lang="xml"><span class="line"><span class="cl"><span class="cp">&lt;?xml version=&#34;1.0&#34; encoding=&#34;UTF-16&#34;?&gt;</span>
</span></span><span class="line"><span class="cl"><span class="nt">&lt;Task</span> <span class="na">version=</span><span class="s">&#34;1.2&#34;</span> <span class="na">xmlns=</span><span class="s">&#34;http://schemas.microsoft.com/windows/2004/02/mit/task&#34;</span><span class="nt">&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="nt">&lt;RegistrationInfo&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;Description&gt;</span>Script for deleting temporary data.<span class="nt">&lt;/Description&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="nt">&lt;/RegistrationInfo&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="nt">&lt;Triggers&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;CalendarTrigger&gt;</span>
</span></span><span class="line"><span class="cl">      <span class="nt">&lt;StartBoundary&gt;</span>2024-09-09T00:15:00<span class="nt">&lt;/StartBoundary&gt;</span>
</span></span><span class="line"><span class="cl">      <span class="nt">&lt;Enabled&gt;</span>true<span class="nt">&lt;/Enabled&gt;</span>
</span></span><span class="line"><span class="cl">      <span class="nt">&lt;ScheduleByWeek&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&lt;DaysOfWeek&gt;</span>
</span></span><span class="line"><span class="cl">          <span class="nt">&lt;Sunday</span> <span class="nt">/&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&lt;/DaysOfWeek&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&lt;WeeksInterval&gt;</span>1<span class="nt">&lt;/WeeksInterval&gt;</span>
</span></span><span class="line"><span class="cl">      <span class="nt">&lt;/ScheduleByWeek&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;/CalendarTrigger&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="nt">&lt;/Triggers&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="nt">&lt;Settings&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;MultipleInstancesPolicy&gt;</span>IgnoreNew<span class="nt">&lt;/MultipleInstancesPolicy&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;DisallowStartIfOnBatteries&gt;</span>true<span class="nt">&lt;/DisallowStartIfOnBatteries&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;StopIfGoingOnBatteries&gt;</span>true<span class="nt">&lt;/StopIfGoingOnBatteries&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;AllowHardTerminate&gt;</span>true<span class="nt">&lt;/AllowHardTerminate&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;StartWhenAvailable&gt;</span>false<span class="nt">&lt;/StartWhenAvailable&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;RunOnlyIfNetworkAvailable&gt;</span>false<span class="nt">&lt;/RunOnlyIfNetworkAvailable&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;IdleSettings&gt;</span>
</span></span><span class="line"><span class="cl">      <span class="nt">&lt;StopOnIdleEnd&gt;</span>true<span class="nt">&lt;/StopOnIdleEnd&gt;</span>
</span></span><span class="line"><span class="cl">      <span class="nt">&lt;RestartOnIdle&gt;</span>false<span class="nt">&lt;/RestartOnIdle&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;/IdleSettings&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;AllowStartOnDemand&gt;</span>true<span class="nt">&lt;/AllowStartOnDemand&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;Enabled&gt;</span>true<span class="nt">&lt;/Enabled&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;Hidden&gt;</span>false<span class="nt">&lt;/Hidden&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;RunOnlyIfIdle&gt;</span>false<span class="nt">&lt;/RunOnlyIfIdle&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;WakeToRun&gt;</span>false<span class="nt">&lt;/WakeToRun&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="nt">&lt;/Settings&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="nt">&lt;Actions</span> <span class="na">Context=</span><span class="s">&#34;Author&#34;</span><span class="nt">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;Exec&gt;</span>
</span></span><span class="line"><span class="cl">      <span class="nt">&lt;Command&gt;</span>powershell<span class="nt">&lt;/Command&gt;</span>
</span></span><span class="line"><span class="cl">      <span class="nt">&lt;Arguments&gt;</span>&#34;C:\Scripts\app.temp.cleanup.ps1&#34;<span class="nt">&lt;/Arguments&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;/Exec&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="nt">&lt;/Actions&gt;</span>
</span></span><span class="line"><span class="cl"><span class="nt">&lt;/Task&gt;</span></span></span></code></pre></td></tr></table>
</div>
</div>
                </div>
              </div>
            </div>]]></turbo:content></item><item turbo="true"><title>Как обновить SSL-сертификат Proxmox?</title><link>https://lib.onl/ru/2024/09/ffca78db-eb62-5e14-91c1-1142a8a3b8a6/</link><pubDate>Sat, 14 Sep 2024 22:22:06 +0000</pubDate><dc:creator>Kai Kimera</dc:creator><category>Proxmox</category><category>Ssl</category><yandex:related><link url="https://lib.onl/ru/2024/05/ffbb2491-6784-510a-a067-2f08cc76c221/">Как изменить IP-адрес в Proxmox VE?</link></yandex:related><turbo:extendedHtml>true</turbo:extendedHtml><turbo:source>https://lib.onl/ru/2024/09/ffca78db-eb62-5e14-91c1-1142a8a3b8a6/</turbo:source><turbo:topic>Как обновить SSL-сертификат Proxmox?</turbo:topic><turbo:content>&lt;p>Поменялся IP-адрес сервера Proxmox. Старый IP остался в само-заверенном SSL-сертификате. Как обновить сертификат?&lt;/p></turbo:content></item><item turbo="true"><title>Как отключить новый интерфейс Acrobat Reader для всех пользователей?</title><link>https://lib.onl/ru/2024/06/39aad3f7-08a5-5b25-a860-be8a8673979c/</link><pubDate>Fri, 07 Jun 2024 15:36:34 +0000</pubDate><dc:creator>Kai Kimera</dc:creator><category>Adobe</category><category>Acrobat</category><category>Reader</category><category>Pdf</category><category>Ui</category><turbo:extendedHtml>true</turbo:extendedHtml><turbo:source>https://lib.onl/ru/2024/06/39aad3f7-08a5-5b25-a860-be8a8673979c/</turbo:source><turbo:topic>Как отключить новый интерфейс Acrobat Reader для всех пользователей?</turbo:topic><turbo:content>&lt;p>Пользователи терминального сервера жалуются на подвисания нового интерфейса Acrobat Reader. Как можно его отключить для всех пользователей?&lt;/p></turbo:content></item><item turbo="true"><title>Создание расширяемого хранилища LVM</title><link>https://lib.onl/ru/2024/06/2b75198c-776c-5ed9-9037-976c6d3021f9/</link><pubDate>Mon, 03 Jun 2024 15:24:00 +0000</pubDate><dc:creator>Kai Kimera</dc:creator><category>Linux</category><category>Терминал</category><turbo:extendedHtml>true</turbo:extendedHtml><turbo:source>https://lib.onl/ru/2024/06/2b75198c-776c-5ed9-9037-976c6d3021f9/</turbo:source><turbo:topic>Создание расширяемого хранилища LVM</turbo:topic><turbo:content><![CDATA[<p>Рассматриваем работу с LVM, управлением логическими томами. Вкратце описываю процессы и привожу полноценные команды для создания, изменения и удаления LVM.</p>




    








    
    






<div class="shortcode shortcode-alert">
  <div class="alert alert-warning d-flex overflow-hidden" role="alert">
    <div class="flex-shrink-0 align-self-center">
      <i class="fas fa-exclamation-triangle fa-fw fa-2x"></i>
    </div>
    <div class="flex-grow-1 ms-3 overflow-hidden">
        <p>Все команды в статье предполагают предварительные настройки по каждому отдельному хосту. Будьте аккуратными!</p>

    </div>
  </div>
</div>

<h2 id="экспорт-параметров">
  <a class="link-body-emphasis" href="#%d1%8d%d0%ba%d1%81%d0%bf%d0%be%d1%80%d1%82-%d0%bf%d0%b0%d1%80%d0%b0%d0%bc%d0%b5%d1%82%d1%80%d0%be%d0%b2">Экспорт параметров</a>
</h2><p>Для начала экспортируем заранее подготовленные параметры в переменные окружения:</p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-0
shortcode-codeblock-bash">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-05b24631e7a8c673490c265ce1221570" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="nb">export</span> <span class="nv">PV</span><span class="o">=</span><span class="s1">&#39;/dev/sdb&#39;</span><span class="p">;</span> <span class="nb">export</span> <span class="nv">VG</span><span class="o">=</span><span class="s1">&#39;data&#39;</span><span class="p">;</span> <span class="nb">export</span> <span class="nv">LV</span><span class="o">=</span><span class="s1">&#39;storage&#39;</span><span class="p">;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-05b24631e7a8c673490c265ce1221570"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<p>Где:</p>
<ul>
<li><code>PV='/dev/sdb'</code> - диск, который будет использоваться в качестве физического тома для LVM.</li>
<li><code>VG='data'</code> - имя группы томов (VG).</li>
<li><code>LV='storage'</code> - имя логического тома (LV).</li>
</ul>
<h2 id="создание-lvm">
  <a class="link-body-emphasis" href="#%d1%81%d0%be%d0%b7%d0%b4%d0%b0%d0%bd%d0%b8%d0%b5-lvm">Создание LVM</a>
</h2><p>Чтобы создать LVM, необходимо:</p>
<ol>
<li>Создать физический том <strong>PV</strong> на диске.</li>
<li>Создать группу логических томов <strong>VG</strong>.</li>
<li>Создать логические тома <strong>LV</strong>.</li>
</ol>
<p>Команда для создания LVM с одним логическим томом <code>storage</code> 100% размера:</p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-1
shortcode-codeblock-bash">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-2f6f731e4a17788081081b0a9aba6133" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">pvcreate <span class="s2">&#34;</span><span class="si">${</span><span class="nv">PV</span><span class="si">}</span><span class="s2">&#34;</span> <span class="o">&amp;&amp;</span> vgcreate <span class="s2">&#34;</span><span class="si">${</span><span class="nv">VG</span><span class="si">}</span><span class="s2">&#34;</span> <span class="s2">&#34;</span><span class="si">${</span><span class="nv">PV</span><span class="si">}</span><span class="s2">&#34;</span> <span class="o">&amp;&amp;</span> lvcreate -l 100%FREE -n <span class="s2">&#34;</span><span class="si">${</span><span class="nv">LV</span><span class="si">}</span><span class="s2">&#34;</span> <span class="s2">&#34;</span><span class="si">${</span><span class="nv">VG</span><span class="si">}</span><span class="s2">&#34;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-2f6f731e4a17788081081b0a9aba6133"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<h3 id="форматирование-lv">
  <a class="link-body-emphasis" href="#%d1%84%d0%be%d1%80%d0%bc%d0%b0%d1%82%d0%b8%d1%80%d0%be%d0%b2%d0%b0%d0%bd%d0%b8%d0%b5-lv">Форматирование LV</a>
</h3><p>Форматирование логического тома <strong>LV</strong> в файловую систему <strong>EXT4</strong>:</p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-2
shortcode-codeblock-bash">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-99c2d23863fd3997785c9130afe7d878" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">mkfs.ext4 <span class="s2">&#34;/dev/</span><span class="si">${</span><span class="nv">VG</span><span class="si">}</span><span class="s2">/</span><span class="si">${</span><span class="nv">LV</span><span class="si">}</span><span class="s2">&#34;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-99c2d23863fd3997785c9130afe7d878"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<p>Форматирование логического тома <strong>LV</strong> в файловую систему <strong>XFS</strong>:</p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-3
shortcode-codeblock-bash">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-7f094e6fe007aac4cb078c8dbf8f15f0" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">mkfs.xfs <span class="s2">&#34;/dev/</span><span class="si">${</span><span class="nv">VG</span><span class="si">}</span><span class="s2">/</span><span class="si">${</span><span class="nv">LV</span><span class="si">}</span><span class="s2">&#34;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-7f094e6fe007aac4cb078c8dbf8f15f0"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<h3 id="монтирование-lv">
  <a class="link-body-emphasis" href="#%d0%bc%d0%be%d0%bd%d1%82%d0%b8%d1%80%d0%be%d0%b2%d0%b0%d0%bd%d0%b8%d0%b5-lv">Монтирование LV</a>
</h3><p>Создание точки монтирования и монтирование логического тома <strong>LV</strong> в директорию <code>/home/storage</code> с файловой системой <strong>EXT4</strong>:</p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-4
shortcode-codeblock-bash">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-73fe75c59c15ad0be25a681ba8541148" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">mkdir <span class="s1">&#39;/home/storage&#39;</span> <span class="o">&amp;&amp;</span> <span class="nb">echo</span> <span class="s2">&#34;/dev/</span><span class="si">${</span><span class="nv">VG</span><span class="si">}</span><span class="s2">/</span><span class="si">${</span><span class="nv">LV</span><span class="si">}</span><span class="s2"> /home/storage ext4 defaults 0 0&#34;</span> &gt;&gt; <span class="s1">&#39;/etc/fstab&#39;</span> <span class="o">&amp;&amp;</span> mount <span class="s2">&#34;/dev/</span><span class="si">${</span><span class="nv">VG</span><span class="si">}</span><span class="s2">/</span><span class="si">${</span><span class="nv">LV</span><span class="si">}</span><span class="s2">&#34;</span> <span class="s1">&#39;/home/storage&#39;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-73fe75c59c15ad0be25a681ba8541148"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<p>Создание точки монтирования и монтирование логического тома <strong>LV</strong> в директорию <code>/home/storage</code> с файловой системой <strong>XFS</strong>:</p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-5
shortcode-codeblock-bash">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-81417cb8fc3d775d22a7b40c8e830b7c" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">mkdir <span class="s1">&#39;/home/storage&#39;</span> <span class="o">&amp;&amp;</span> <span class="nb">echo</span> <span class="s2">&#34;/dev/</span><span class="si">${</span><span class="nv">VG</span><span class="si">}</span><span class="s2">/</span><span class="si">${</span><span class="nv">LV</span><span class="si">}</span><span class="s2"> /home/storage xfs defaults 0 0&#34;</span> &gt;&gt; <span class="s1">&#39;/etc/fstab&#39;</span> <span class="o">&amp;&amp;</span> mount <span class="s2">&#34;/dev/</span><span class="si">${</span><span class="nv">VG</span><span class="si">}</span><span class="s2">/</span><span class="si">${</span><span class="nv">LV</span><span class="si">}</span><span class="s2">&#34;</span> <span class="s1">&#39;/home/storage&#39;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-81417cb8fc3d775d22a7b40c8e830b7c"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<h2 id="расширение-lvm">
  <a class="link-body-emphasis" href="#%d1%80%d0%b0%d1%81%d1%88%d0%b8%d1%80%d0%b5%d0%bd%d0%b8%d0%b5-lvm">Расширение LVM</a>
</h2><p>Для того, чтобы расширить логический том <strong>LV</strong>, необходимо:</p>
<ol>
<li>Указать системе провести повторное сканирование указанного устройства на предмет изменённых параметров (в данном случае, размер диска).</li>
<li>Расширить физический том <strong>PV</strong>.</li>
<li>Расширить логические тома <strong>LV</strong>.</li>
<li>Расширить файловую систему.</li>
</ol>
<p>Команда в одну строку для расширения логического тома <strong>LV</strong>:</p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-6
shortcode-codeblock-bash">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-4d3ebdececf1fbaddc73af9a02b1a6b6" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="nb">echo</span> <span class="m">1</span> &gt; <span class="s2">&#34;/sys/block/</span><span class="si">${</span><span class="nv">PV</span><span class="p">##*/</span><span class="si">}</span><span class="s2">/device/rescan&#34;</span> <span class="o">&amp;&amp;</span> pvresize <span class="s2">&#34;</span><span class="si">${</span><span class="nv">PV</span><span class="si">}</span><span class="s2">&#34;</span> <span class="o">&amp;&amp;</span> lvextend -l +100%FREE <span class="s2">&#34;/dev/</span><span class="si">${</span><span class="nv">VG</span><span class="si">}</span><span class="s2">/</span><span class="si">${</span><span class="nv">LV</span><span class="si">}</span><span class="s2">&#34;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-4d3ebdececf1fbaddc73af9a02b1a6b6"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<h3 id="расширение-фс">
  <a class="link-body-emphasis" href="#%d1%80%d0%b0%d1%81%d1%88%d0%b8%d1%80%d0%b5%d0%bd%d0%b8%d0%b5-%d1%84%d1%81">Расширение ФС</a>
</h3><p>Расширить файловую систему <strong>EXT4</strong>:</p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-7
shortcode-codeblock-bash">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-0bbdd7c1670869a9d7628eca6be0b8e1" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">resize2fs <span class="s2">&#34;/dev/</span><span class="si">${</span><span class="nv">VG</span><span class="si">}</span><span class="s2">/</span><span class="si">${</span><span class="nv">LV</span><span class="si">}</span><span class="s2">&#34;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-0bbdd7c1670869a9d7628eca6be0b8e1"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<p>Расширить файловую систему <strong>XFS</strong>:</p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-8
shortcode-codeblock-bash">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-16f263c23af89b90a82d60ef31daeca8" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">xfs_growfs -d <span class="s2">&#34;/dev/</span><span class="si">${</span><span class="nv">VG</span><span class="si">}</span><span class="s2">/</span><span class="si">${</span><span class="nv">LV</span><span class="si">}</span><span class="s2">&#34;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-16f263c23af89b90a82d60ef31daeca8"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<h2 id="удаление-lvm">
  <a class="link-body-emphasis" href="#%d1%83%d0%b4%d0%b0%d0%bb%d0%b5%d0%bd%d0%b8%d0%b5-lvm">Удаление LVM</a>
</h2><p>Для удаления LVM, необходимо:</p>
<ol>
<li>Удалить логические тома <strong>LV</strong>.</li>
<li>Удалить группу томов <strong>VG</strong>.</li>
<li>Удалить физический том <strong>PV</strong>.</li>
</ol>
<p>Для удаления LVM, нужно выполнить команду:</p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-9
shortcode-codeblock-bash">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-e82d0263814d68900a83ce1b38f41dbf" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">lvremove <span class="s2">&#34;/dev/</span><span class="si">${</span><span class="nv">VG</span><span class="si">}</span><span class="s2">/</span><span class="si">${</span><span class="nv">LV</span><span class="si">}</span><span class="s2">&#34;</span> <span class="o">&amp;&amp;</span> vgremove <span class="s2">&#34;</span><span class="si">${</span><span class="nv">VG</span><span class="si">}</span><span class="s2">&#34;</span> <span class="o">&amp;&amp;</span> pvremove <span class="s2">&#34;</span><span class="si">${</span><span class="nv">PV</span><span class="si">}</span><span class="s2">&#34;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-e82d0263814d68900a83ce1b38f41dbf"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<h2 id="информация-по-lvm">
  <a class="link-body-emphasis" href="#%d0%b8%d0%bd%d1%84%d0%be%d1%80%d0%bc%d0%b0%d1%86%d0%b8%d1%8f-%d0%bf%d0%be-lvm">Информация по LVM</a>
</h2><p>Отображение информации о физическом томе <strong>PV</strong>:</p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-10
shortcode-codeblock-bash">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-6683501cb420b58a53c154528cdbf956" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">pvdisplay</span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-6683501cb420b58a53c154528cdbf956"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<p>Отображение информации о группе логических томов <strong>VG</strong>:</p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-11
shortcode-codeblock-bash">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-50037e6ee200f261d4fb89559e085fcb" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">vgdisplay</span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-50037e6ee200f261d4fb89559e085fcb"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<p>Отображение информации о логических томах <strong>LV</strong>:</p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-12
shortcode-codeblock-bash">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-092ff9ba51fe03e9a5c313db490f28f7" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">lvdisplay</span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-092ff9ba51fe03e9a5c313db490f28f7"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>]]></turbo:content></item><item turbo="true"><title>Linux: Пользователи и группы</title><link>https://lib.onl/ru/2024/06/b29b331d-ac93-5193-83ef-beab5a0f8dff/</link><pubDate>Mon, 03 Jun 2024 10:59:22 +0000</pubDate><dc:creator>Kai Kimera</dc:creator><category>Linux</category><category>Терминал</category><yandex:related><link url="https://lib.onl/ru/2024/06/eea13ebc-7ca9-5721-b017-d911a8f6354d/">FreeBSD: Пользователи и группы</link><link url="https://lib.onl/ru/2024/03/6c7a038f-f41e-5a45-a285-b99fdacf82d4/">Работа с ZFS</link></yandex:related><turbo:extendedHtml>true</turbo:extendedHtml><turbo:source>https://lib.onl/ru/2024/06/b29b331d-ac93-5193-83ef-beab5a0f8dff/</turbo:source><turbo:topic>Linux: Пользователи и группы</turbo:topic><turbo:content><![CDATA[<p>Набор команд для работы с группами и пользователями в <span class="shortcode shortcode-tag"><a href="/ru/tags/linux/" target="_blank">#Linux</a></span>.</p>
<p>В отличие от <span class="shortcode shortcode-tag"><a href="/ru/tags/freebsd/" target="_blank">#FreeBSD</a></span>, в <span class="shortcode shortcode-tag"><a href="/ru/tags/linux/" target="_blank">#Linux</a></span> можно пользоваться стандартными инструментами <code>useradd</code>, <code>usermod</code> и <code>userdel</code>.</p>
<h2 id="создать-пользователя">
  <a class="link-body-emphasis" href="#%d1%81%d0%be%d0%b7%d0%b4%d0%b0%d1%82%d1%8c-%d0%bf%d0%be%d0%bb%d1%8c%d0%b7%d0%be%d0%b2%d0%b0%d1%82%d0%b5%d0%bb%d1%8f">Создать пользователя</a>
</h2><ul>
<li>Создать пользователя <code>username</code>, добавить его в группу <code>sudo</code>, указать комментарий <code>User username</code> и задать пароль:</li>
</ul>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-0
shortcode-codeblock-bash">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-10307d479a4528de6662f2153136add9" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="nv">u</span><span class="o">=</span><span class="s1">&#39;username&#39;</span><span class="p">;</span> useradd -m -G sudo -c <span class="s2">&#34;User </span><span class="si">${</span><span class="nv">u</span><span class="si">}</span><span class="s2">&#34;</span> <span class="s2">&#34;</span><span class="si">${</span><span class="nv">u</span><span class="si">}</span><span class="s2">&#34;</span> <span class="o">&amp;&amp;</span> passwd <span class="s2">&#34;</span><span class="si">${</span><span class="nv">u</span><span class="si">}</span><span class="s2">&#34;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-10307d479a4528de6662f2153136add9"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<h2 id="переименовать-пользователя">
  <a class="link-body-emphasis" href="#%d0%bf%d0%b5%d1%80%d0%b5%d0%b8%d0%bc%d0%b5%d0%bd%d0%be%d0%b2%d0%b0%d1%82%d1%8c-%d0%bf%d0%be%d0%bb%d1%8c%d0%b7%d0%be%d0%b2%d0%b0%d1%82%d0%b5%d0%bb%d1%8f">Переименовать пользователя</a>
</h2><ul>
<li>Переименовать домашнюю директорию пользователя, переименовать пользователя и его группу:</li>
</ul>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-1
shortcode-codeblock-bash">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-95c7633b9621eb7988896c9e52be8b25" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="nv">u_old</span><span class="o">=</span><span class="s1">&#39;username_old&#39;</span><span class="p">;</span> <span class="nv">u_new</span><span class="o">=</span><span class="s1">&#39;username_new&#39;</span><span class="p">;</span> usermod -l <span class="s2">&#34;</span><span class="si">${</span><span class="nv">u_new</span><span class="si">}</span><span class="s2">&#34;</span> -d <span class="s2">&#34;/home/</span><span class="si">${</span><span class="nv">u_new</span><span class="si">}</span><span class="s2">&#34;</span> -m <span class="s2">&#34;</span><span class="si">${</span><span class="nv">u_old</span><span class="si">}</span><span class="s2">&#34;</span> <span class="o">&amp;&amp;</span> groupmod -n <span class="s2">&#34;</span><span class="si">${</span><span class="nv">u_new</span><span class="si">}</span><span class="s2">&#34;</span> <span class="s2">&#34;</span><span class="si">${</span><span class="nv">u_old</span><span class="si">}</span><span class="s2">&#34;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-95c7633b9621eb7988896c9e52be8b25"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<h2 id="удалить-пользователя">
  <a class="link-body-emphasis" href="#%d1%83%d0%b4%d0%b0%d0%bb%d0%b8%d1%82%d1%8c-%d0%bf%d0%be%d0%bb%d1%8c%d0%b7%d0%be%d0%b2%d0%b0%d1%82%d0%b5%d0%bb%d1%8f">Удалить пользователя</a>
</h2><ul>
<li>Удалить пользователя <code>username</code> и его домашнюю директорию (<code>-r</code>):</li>
</ul>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-2
shortcode-codeblock-bash">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-fc9b0d5fb6af11bb7dd12e1e49d66f76" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="nv">u</span><span class="o">=</span><span class="s1">&#39;username&#39;</span><span class="p">;</span> userdel -r <span class="s2">&#34;</span><span class="si">${</span><span class="nv">u</span><span class="si">}</span><span class="s2">&#34;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-fc9b0d5fb6af11bb7dd12e1e49d66f76"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<h2 id="заблокировать-пользователя">
  <a class="link-body-emphasis" href="#%d0%b7%d0%b0%d0%b1%d0%bb%d0%be%d0%ba%d0%b8%d1%80%d0%be%d0%b2%d0%b0%d1%82%d1%8c-%d0%bf%d0%be%d0%bb%d1%8c%d0%b7%d0%be%d0%b2%d0%b0%d1%82%d0%b5%d0%bb%d1%8f">Заблокировать пользователя</a>
</h2><ul>
<li>Заблокировать пользователя <code>username</code>:</li>
</ul>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-3
shortcode-codeblock-bash">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-61cf024277eaae647f51ccfca4fb5088" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="nv">u</span><span class="o">=</span><span class="s1">&#39;username&#39;</span><span class="p">;</span> usermod -L <span class="s2">&#34;</span><span class="si">${</span><span class="nv">u</span><span class="si">}</span><span class="s2">&#34;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-61cf024277eaae647f51ccfca4fb5088"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<h2 id="разблокировать-пользователя">
  <a class="link-body-emphasis" href="#%d1%80%d0%b0%d0%b7%d0%b1%d0%bb%d0%be%d0%ba%d0%b8%d1%80%d0%be%d0%b2%d0%b0%d1%82%d1%8c-%d0%bf%d0%be%d0%bb%d1%8c%d0%b7%d0%be%d0%b2%d0%b0%d1%82%d0%b5%d0%bb%d1%8f">Разблокировать пользователя</a>
</h2><ul>
<li>Разблокировать пользователя <code>username</code>:</li>
</ul>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-4
shortcode-codeblock-bash">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-b9b44762beb3b9cc258f5b5098edd4c0" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="nv">u</span><span class="o">=</span><span class="s1">&#39;username&#39;</span><span class="p">;</span> usermod -U <span class="s2">&#34;</span><span class="si">${</span><span class="nv">u</span><span class="si">}</span><span class="s2">&#34;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-b9b44762beb3b9cc258f5b5098edd4c0"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<h2 id="добавить-пользователя-в-дополнительную-группу">
  <a class="link-body-emphasis" href="#%d0%b4%d0%be%d0%b1%d0%b0%d0%b2%d0%b8%d1%82%d1%8c-%d0%bf%d0%be%d0%bb%d1%8c%d0%b7%d0%be%d0%b2%d0%b0%d1%82%d0%b5%d0%bb%d1%8f-%d0%b2-%d0%b4%d0%be%d0%bf%d0%be%d0%bb%d0%bd%d0%b8%d1%82%d0%b5%d0%bb%d1%8c%d0%bd%d1%83%d1%8e-%d0%b3%d1%80%d1%83%d0%bf%d0%bf%d1%83">Добавить пользователя в дополнительную группу</a>
</h2><ul>
<li>Добавить пользователя <code>username</code> в группу <code>www</code>:</li>
</ul>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-5
shortcode-codeblock-bash">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-9bf9d27522d0e4045b5a8e3b3b00d281" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="nv">u</span><span class="o">=</span><span class="s1">&#39;username&#39;</span><span class="p">;</span> usermod -aG www <span class="s2">&#34;</span><span class="si">${</span><span class="nv">u</span><span class="si">}</span><span class="s2">&#34;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-9bf9d27522d0e4045b5a8e3b3b00d281"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<h2 id="удалить-пользователя-из-дополнительной-группы">
  <a class="link-body-emphasis" href="#%d1%83%d0%b4%d0%b0%d0%bb%d0%b8%d1%82%d1%8c-%d0%bf%d0%be%d0%bb%d1%8c%d0%b7%d0%be%d0%b2%d0%b0%d1%82%d0%b5%d0%bb%d1%8f-%d0%b8%d0%b7-%d0%b4%d0%be%d0%bf%d0%be%d0%bb%d0%bd%d0%b8%d1%82%d0%b5%d0%bb%d1%8c%d0%bd%d0%be%d0%b9-%d0%b3%d1%80%d1%83%d0%bf%d0%bf%d1%8b">Удалить пользователя из дополнительной группы</a>
</h2><ul>
<li>Удалить пользователя <code>username</code> из группы <code>www</code>:</li>
</ul>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-6
shortcode-codeblock-bash">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-3fd0d49c31a0ac91a32a5af280545ce9" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="nv">u</span><span class="o">=</span><span class="s1">&#39;username&#39;</span><span class="p">;</span> gpasswd -d <span class="s2">&#34;</span><span class="si">${</span><span class="nv">u</span><span class="si">}</span><span class="s2">&#34;</span> www</span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-3fd0d49c31a0ac91a32a5af280545ce9"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<h2 id="изменить-основную-группу-пользователя">
  <a class="link-body-emphasis" href="#%d0%b8%d0%b7%d0%bc%d0%b5%d0%bd%d0%b8%d1%82%d1%8c-%d0%be%d1%81%d0%bd%d0%be%d0%b2%d0%bd%d1%83%d1%8e-%d0%b3%d1%80%d1%83%d0%bf%d0%bf%d1%83-%d0%bf%d0%be%d0%bb%d1%8c%d0%b7%d0%be%d0%b2%d0%b0%d1%82%d0%b5%d0%bb%d1%8f">Изменить основную группу пользователя</a>
</h2><ul>
<li>Изменить основную группу пользователя <code>username</code> на группу <code>www</code>:</li>
</ul>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-7
shortcode-codeblock-bash">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-58ed91028e60a98f4a3788c6c6b1391a" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="nv">u</span><span class="o">=</span><span class="s1">&#39;username&#39;</span><span class="p">;</span> usermod -g www <span class="s2">&#34;</span><span class="si">${</span><span class="nv">u</span><span class="si">}</span><span class="s2">&#34;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-58ed91028e60a98f4a3788c6c6b1391a"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<h2 id="заменить-у-пользователя-дополнительные-группы">
  <a class="link-body-emphasis" href="#%d0%b7%d0%b0%d0%bc%d0%b5%d0%bd%d0%b8%d1%82%d1%8c-%d1%83-%d0%bf%d0%be%d0%bb%d1%8c%d0%b7%d0%be%d0%b2%d0%b0%d1%82%d0%b5%d0%bb%d1%8f-%d0%b4%d0%be%d0%bf%d0%be%d0%bb%d0%bd%d0%b8%d1%82%d0%b5%d0%bb%d1%8c%d0%bd%d1%8b%d0%b5-%d0%b3%d1%80%d1%83%d0%bf%d0%bf%d1%8b">Заменить у пользователя дополнительные группы</a>
</h2><ul>
<li>Заменить у пользователя <code>username</code> все дополнительные группы на группу <code>www</code>:</li>
</ul>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-8
shortcode-codeblock-bash">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-d8f48ed1ae3894aa8c59cc2b0a301ff2" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="nv">u</span><span class="o">=</span><span class="s1">&#39;username&#39;</span><span class="p">;</span> usermod -G www <span class="s2">&#34;</span><span class="si">${</span><span class="nv">u</span><span class="si">}</span><span class="s2">&#34;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-d8f48ed1ae3894aa8c59cc2b0a301ff2"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>]]></turbo:content></item><item turbo="true"><title>RHEL: Статический IP-адрес</title><link>https://lib.onl/ru/2024/06/66e74163-ecd3-51a3-bec4-aa91d3bf9da5/</link><pubDate>Mon, 03 Jun 2024 10:19:22 +0000</pubDate><dc:creator>Kai Kimera</dc:creator><category>Терминал</category><category>Linux</category><category>Сеть</category><category>В доработке</category><yandex:related><link url="https://lib.onl/ru/2021/05/ee559a6c-5cde-5166-9d2d-3ceb55878eb8/">Debian: Статический IP-адрес</link><link url="https://lib.onl/ru/2024/03/bd4f198b-907e-5c14-90c6-a7c032891ce0/">Проверка DNS-записей домена</link><link url="https://lib.onl/ru/2022/08/badb30a9-0471-5dab-a422-85422c0ac611/">Включение DNS over TLS (DoT) в OPNsense</link></yandex:related><turbo:extendedHtml>true</turbo:extendedHtml><turbo:source>https://lib.onl/ru/2024/06/66e74163-ecd3-51a3-bec4-aa91d3bf9da5/</turbo:source><turbo:topic>RHEL: Статический IP-адрес</turbo:topic><turbo:content><![CDATA[<p>Настройка статического IP-адреса в RHEL-based дистрибутивах.</p>
<h2 id="вводные-данные">
  <a class="link-body-emphasis" href="#%d0%b2%d0%b2%d0%be%d0%b4%d0%bd%d1%8b%d0%b5-%d0%b4%d0%b0%d0%bd%d0%bd%d1%8b%d0%b5">Вводные данные</a>
</h2><ul>
<li>Интерфейс: <code>eth0</code>.</li>
<li>IP-адрес: <code>192.168.10.55/24</code>.</li>
<li>Маска подсети: <code>192.168.10.0/24</code>.</li>
<li>Шлюз: <code>192.168.10.1</code>.</li>
<li>DNS-серверы:
<ul>
<li><code>192.168.10.2</code>.</li>
<li><code>192.168.10.3</code>.</li>
</ul>
</li>
</ul>
<h2 id="настройка-статического-ip-адреса">
  <a class="link-body-emphasis" href="#%d0%bd%d0%b0%d1%81%d1%82%d1%80%d0%be%d0%b9%d0%ba%d0%b0-%d1%81%d1%82%d0%b0%d1%82%d0%b8%d1%87%d0%b5%d1%81%d0%ba%d0%be%d0%b3%d0%be-ip-%d0%b0%d0%b4%d1%80%d0%b5%d1%81%d0%b0">Настройка статического IP-адреса</a>
</h2><h3 id="установка-ip-адреса">
  <a class="link-body-emphasis" href="#%d1%83%d1%81%d1%82%d0%b0%d0%bd%d0%be%d0%b2%d0%ba%d0%b0-ip-%d0%b0%d0%b4%d1%80%d0%b5%d1%81%d0%b0">Установка IP-адреса</a>
</h3>








  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-0
shortcode-codeblock-bash">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-94dd4ce180f323f1e3bedc3e031a0480" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">nmcli con modify eth0 ipv4.addresses <span class="s1">&#39;192.168.10.55/24&#39;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-94dd4ce180f323f1e3bedc3e031a0480"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<p>Где:</p>
<ul>
<li><code>eth0</code> - название интерфейса.</li>
<li><code>ipv4.addresses</code> - IP-адрес интерфейса.</li>
</ul>
<h3 id="установка-шлюза">
  <a class="link-body-emphasis" href="#%d1%83%d1%81%d1%82%d0%b0%d0%bd%d0%be%d0%b2%d0%ba%d0%b0-%d1%88%d0%bb%d1%8e%d0%b7%d0%b0">Установка шлюза</a>
</h3>








  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-1
shortcode-codeblock-bash">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-57f8c93dfa4ac61bc4b10e13d61cc1ff" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">nmcli con modify eth0 ipv4.gateway <span class="s1">&#39;192.168.10.1&#39;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-57f8c93dfa4ac61bc4b10e13d61cc1ff"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<p>Где:</p>
<ul>
<li><code>eth0</code> - название интерфейса.</li>
<li><code>ipv4.gateway</code> - шлюз.</li>
</ul>
<h3 id="установка-dns">
  <a class="link-body-emphasis" href="#%d1%83%d1%81%d1%82%d0%b0%d0%bd%d0%be%d0%b2%d0%ba%d0%b0-dns">Установка DNS</a>
</h3>








  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-2
shortcode-codeblock-bash">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-8f519eb7bf71061ab0ca77aaddbea950" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">nmcli con modify eth0 ipv4.dns <span class="s1">&#39;192.168.10.2,192.168.10.3&#39;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-8f519eb7bf71061ab0ca77aaddbea950"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<p>Где:</p>
<ul>
<li><code>eth0</code> - название интерфейса.</li>
<li><code>ipv4.dns</code> - IP-адрес DNS-сервера.</li>
</ul>
<h3 id="установка-статических-настроек">
  <a class="link-body-emphasis" href="#%d1%83%d1%81%d1%82%d0%b0%d0%bd%d0%be%d0%b2%d0%ba%d0%b0-%d1%81%d1%82%d0%b0%d1%82%d0%b8%d1%87%d0%b5%d1%81%d0%ba%d0%b8%d1%85-%d0%bd%d0%b0%d1%81%d1%82%d1%80%d0%be%d0%b5%d0%ba">Установка статических настроек</a>
</h3>








  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-3
shortcode-codeblock-bash">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-179f9a0373eeacf02a49e3130d77a46e" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">nmcli con modify eth0 ipv4.method manual</span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-179f9a0373eeacf02a49e3130d77a46e"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<p>Где:</p>
<ul>
<li><code>eth0</code> - название интерфейса.</li>
<li><code>ipv4.method</code> - тип настроек сети.
<ul>
<li><code>manual</code> - использовать статические настройки.</li>
<li><code>auto</code> - использовать настройки от DHCP-сервера.</li>
</ul>
</li>
</ul>
<h3 id="перезапуск-интерфейса">
  <a class="link-body-emphasis" href="#%d0%bf%d0%b5%d1%80%d0%b5%d0%b7%d0%b0%d0%bf%d1%83%d1%81%d0%ba-%d0%b8%d0%bd%d1%82%d0%b5%d1%80%d1%84%d0%b5%d0%b9%d1%81%d0%b0">Перезапуск интерфейса</a>
</h3>








  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-4
shortcode-codeblock-bash">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-d03507b03866c944aab056392174d195" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">nmcli con down eth0 <span class="o">&amp;&amp;</span> nmcli con up eth0</span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-d03507b03866c944aab056392174d195"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<p>Где:</p>
<ul>
<li><code>down</code> - отключить интерфейс.</li>
<li><code>up</code> - включить интерфейс.</li>
<li><code>eth0</code> - название интерфейса.</li>
</ul>
<h3 id="проверка-параметров">
  <a class="link-body-emphasis" href="#%d0%bf%d1%80%d0%be%d0%b2%d0%b5%d1%80%d0%ba%d0%b0-%d0%bf%d0%b0%d1%80%d0%b0%d0%bc%d0%b5%d1%82%d1%80%d0%be%d0%b2">Проверка параметров</a>
</h3>








  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-5
shortcode-codeblock-bash">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-4fc1851783afc7fd533c77a3a9d01fc1" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">nmcli device show eth0</span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-4fc1851783afc7fd533c77a3a9d01fc1"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<p>Где:</p>
<ul>
<li><code>eth0</code> - название интерфейса.</li>
</ul>]]></turbo:content></item><item turbo="true"><title>FreeBSD: Пользователи и группы</title><link>https://lib.onl/ru/2024/06/eea13ebc-7ca9-5721-b017-d911a8f6354d/</link><pubDate>Sun, 02 Jun 2024 09:33:30 +0000</pubDate><dc:creator>Kai Kimera</dc:creator><category>BSD</category><category>Терминал</category><yandex:related><link url="https://lib.onl/ru/2024/03/6c7a038f-f41e-5a45-a285-b99fdacf82d4/">Работа с ZFS</link><link url="https://lib.onl/ru/2024/02/f97dc310-9a6a-52f7-8441-bf7eb02087c2/">Первичная настройка FreeBSD</link></yandex:related><turbo:extendedHtml>true</turbo:extendedHtml><turbo:source>https://lib.onl/ru/2024/06/eea13ebc-7ca9-5721-b017-d911a8f6354d/</turbo:source><turbo:topic>FreeBSD: Пользователи и группы</turbo:topic><turbo:content><![CDATA[<p>Набор команд для работы с группами и пользователями в <span class="shortcode shortcode-tag"><a href="/ru/tags/freebsd/" target="_blank">#FreeBSD</a></span>.</p>
<p>Во <span class="shortcode shortcode-tag"><a href="/ru/tags/freebsd/" target="_blank">#FreeBSD</a></span> для работы с пользователями и группами, можно использовать несколько инструментов. Я использую мощную утилиту <code>pw</code>. Конфигурация утилиты <code>pw</code> находится в файле <code>/etc/pw.conf</code>.</p>
<h2 id="создать-пользователя">
  <a class="link-body-emphasis" href="#%d1%81%d0%be%d0%b7%d0%b4%d0%b0%d1%82%d1%8c-%d0%bf%d0%be%d0%bb%d1%8c%d0%b7%d0%be%d0%b2%d0%b0%d1%82%d0%b5%d0%bb%d1%8f">Создать пользователя</a>
</h2><ul>
<li>Создать пользователя <code>username</code>, добавить его в группу <code>wheel</code>, указать комментарий <code>User username</code> и задать пароль:</li>
</ul>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-0
shortcode-codeblock-bash">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-8b5c059528333c2a6fed9475fe2e156a" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="nv">u</span><span class="o">=</span><span class="s1">&#39;username&#39;</span><span class="p">;</span> pw adduser <span class="s2">&#34;</span><span class="si">${</span><span class="nv">u</span><span class="si">}</span><span class="s2">&#34;</span> -m -G wheel -c <span class="s2">&#34;User </span><span class="si">${</span><span class="nv">u</span><span class="si">}</span><span class="s2">&#34;</span> <span class="o">&amp;&amp;</span> passwd <span class="s2">&#34;</span><span class="si">${</span><span class="nv">u</span><span class="si">}</span><span class="s2">&#34;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-8b5c059528333c2a6fed9475fe2e156a"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<h2 id="переименовать-пользователя">
  <a class="link-body-emphasis" href="#%d0%bf%d0%b5%d1%80%d0%b5%d0%b8%d0%bc%d0%b5%d0%bd%d0%be%d0%b2%d0%b0%d1%82%d1%8c-%d0%bf%d0%be%d0%bb%d1%8c%d0%b7%d0%be%d0%b2%d0%b0%d1%82%d0%b5%d0%bb%d1%8f">Переименовать пользователя</a>
</h2><ul>
<li>Переименовать домашнюю директорию пользователя, переименовать пользователя и его группу:</li>
</ul>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-1
shortcode-codeblock-bash">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-172fb603e8d9bd5e7ebf4f82791e0020" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="nv">u_old</span><span class="o">=</span><span class="s1">&#39;username_old&#39;</span><span class="p">;</span> <span class="nv">u_new</span><span class="o">=</span><span class="s1">&#39;username_new&#39;</span><span class="p">;</span> mv <span class="s2">&#34;/home/</span><span class="si">${</span><span class="nv">u_old</span><span class="si">}</span><span class="s2">&#34;</span> <span class="s2">&#34;/home/</span><span class="si">${</span><span class="nv">u_new</span><span class="si">}</span><span class="s2">&#34;</span> <span class="o">&amp;&amp;</span> pw usermod -n <span class="s2">&#34;</span><span class="si">${</span><span class="nv">u_old</span><span class="si">}</span><span class="s2">&#34;</span> -l <span class="s2">&#34;</span><span class="si">${</span><span class="nv">u_new</span><span class="si">}</span><span class="s2">&#34;</span> -d <span class="s2">&#34;/home/</span><span class="si">${</span><span class="nv">u_new</span><span class="si">}</span><span class="s2">&#34;</span> <span class="o">&amp;&amp;</span> pw groupmod -n <span class="s2">&#34;</span><span class="si">${</span><span class="nv">u_old</span><span class="si">}</span><span class="s2">&#34;</span> -l <span class="s2">&#34;</span><span class="si">${</span><span class="nv">u_new</span><span class="si">}</span><span class="s2">&#34;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-172fb603e8d9bd5e7ebf4f82791e0020"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<h2 id="удалить-пользователя">
  <a class="link-body-emphasis" href="#%d1%83%d0%b4%d0%b0%d0%bb%d0%b8%d1%82%d1%8c-%d0%bf%d0%be%d0%bb%d1%8c%d0%b7%d0%be%d0%b2%d0%b0%d1%82%d0%b5%d0%bb%d1%8f">Удалить пользователя</a>
</h2><ul>
<li>Удалить пользователя <code>username</code> и его домашнюю директорию (<code>-r</code>):</li>
</ul>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-2
shortcode-codeblock-bash">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-723fbc0bf63ae6de2a0e79026eb4b073" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="nv">u</span><span class="o">=</span><span class="s1">&#39;username&#39;</span><span class="p">;</span> pw userdel <span class="s2">&#34;</span><span class="si">${</span><span class="nv">u</span><span class="si">}</span><span class="s2">&#34;</span> -r</span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-723fbc0bf63ae6de2a0e79026eb4b073"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<h2 id="заблокировать-пользователя">
  <a class="link-body-emphasis" href="#%d0%b7%d0%b0%d0%b1%d0%bb%d0%be%d0%ba%d0%b8%d1%80%d0%be%d0%b2%d0%b0%d1%82%d1%8c-%d0%bf%d0%be%d0%bb%d1%8c%d0%b7%d0%be%d0%b2%d0%b0%d1%82%d0%b5%d0%bb%d1%8f">Заблокировать пользователя</a>
</h2><ul>
<li>Заблокировать пользователя <code>username</code>:</li>
</ul>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-3
shortcode-codeblock-bash">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-0ef8d7bf8fd8114b99e54808f52ef914" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="nv">u</span><span class="o">=</span><span class="s1">&#39;username&#39;</span><span class="p">;</span> pw lock <span class="s2">&#34;</span><span class="si">${</span><span class="nv">u</span><span class="si">}</span><span class="s2">&#34;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-0ef8d7bf8fd8114b99e54808f52ef914"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<h2 id="разблокировать-пользователя">
  <a class="link-body-emphasis" href="#%d1%80%d0%b0%d0%b7%d0%b1%d0%bb%d0%be%d0%ba%d0%b8%d1%80%d0%be%d0%b2%d0%b0%d1%82%d1%8c-%d0%bf%d0%be%d0%bb%d1%8c%d0%b7%d0%be%d0%b2%d0%b0%d1%82%d0%b5%d0%bb%d1%8f">Разблокировать пользователя</a>
</h2><ul>
<li>Разблокировать пользователя <code>username</code>:</li>
</ul>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-4
shortcode-codeblock-bash">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-a059ed67f6288b4056c30224e44f1bf6" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="nv">u</span><span class="o">=</span><span class="s1">&#39;username&#39;</span><span class="p">;</span> pw unlock <span class="s2">&#34;</span><span class="si">${</span><span class="nv">u</span><span class="si">}</span><span class="s2">&#34;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-a059ed67f6288b4056c30224e44f1bf6"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<h2 id="добавить-пользователя-в-дополнительную-группу">
  <a class="link-body-emphasis" href="#%d0%b4%d0%be%d0%b1%d0%b0%d0%b2%d0%b8%d1%82%d1%8c-%d0%bf%d0%be%d0%bb%d1%8c%d0%b7%d0%be%d0%b2%d0%b0%d1%82%d0%b5%d0%bb%d1%8f-%d0%b2-%d0%b4%d0%be%d0%bf%d0%be%d0%bb%d0%bd%d0%b8%d1%82%d0%b5%d0%bb%d1%8c%d0%bd%d1%83%d1%8e-%d0%b3%d1%80%d1%83%d0%bf%d0%bf%d1%83">Добавить пользователя в дополнительную группу</a>
</h2><ul>
<li>Добавить пользователя <code>username</code> в группу <code>www</code>:</li>
</ul>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-5
shortcode-codeblock-bash">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-03721774a2804abba9059e8366b24fca" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="nv">u</span><span class="o">=</span><span class="s1">&#39;username&#39;</span><span class="p">;</span> pw groupmod www -m <span class="s2">&#34;</span><span class="si">${</span><span class="nv">u</span><span class="si">}</span><span class="s2">&#34;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-03721774a2804abba9059e8366b24fca"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<ul>
<li>Заменить все текущие группы пользователя <code>username</code> на группы <code>wheel</code> и <code>devels</code>:</li>
</ul>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-6
shortcode-codeblock-bash">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-e74e78fcbfbd8e82e517fc56fb19c34b" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="nv">u</span><span class="o">=</span><span class="s1">&#39;username&#39;</span><span class="p">;</span> pw usermod <span class="s2">&#34;</span><span class="si">${</span><span class="nv">u</span><span class="si">}</span><span class="s2">&#34;</span> -G wheel,devels</span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-e74e78fcbfbd8e82e517fc56fb19c34b"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<h2 id="удалить-пользователя-из-дополнительной-группы">
  <a class="link-body-emphasis" href="#%d1%83%d0%b4%d0%b0%d0%bb%d0%b8%d1%82%d1%8c-%d0%bf%d0%be%d0%bb%d1%8c%d0%b7%d0%be%d0%b2%d0%b0%d1%82%d0%b5%d0%bb%d1%8f-%d0%b8%d0%b7-%d0%b4%d0%be%d0%bf%d0%be%d0%bb%d0%bd%d0%b8%d1%82%d0%b5%d0%bb%d1%8c%d0%bd%d0%be%d0%b9-%d0%b3%d1%80%d1%83%d0%bf%d0%bf%d1%8b">Удалить пользователя из дополнительной группы</a>
</h2><ul>
<li>Удалить пользователя <code>username</code> из группы <code>www</code>:</li>
</ul>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-7
shortcode-codeblock-bash">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-ff69ab8a7c9f0d5a98cefed86cdbcd16" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="nv">u</span><span class="o">=</span><span class="s1">&#39;username&#39;</span><span class="p">;</span> pw groupmod www -d <span class="s2">&#34;</span><span class="si">${</span><span class="nv">u</span><span class="si">}</span><span class="s2">&#34;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-ff69ab8a7c9f0d5a98cefed86cdbcd16"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<h2 id="посмотреть-информацию-о-пользователе">
  <a class="link-body-emphasis" href="#%d0%bf%d0%be%d1%81%d0%bc%d0%be%d1%82%d1%80%d0%b5%d1%82%d1%8c-%d0%b8%d0%bd%d1%84%d0%be%d1%80%d0%bc%d0%b0%d1%86%d0%b8%d1%8e-%d0%be-%d0%bf%d0%be%d0%bb%d1%8c%d0%b7%d0%be%d0%b2%d0%b0%d1%82%d0%b5%d0%bb%d0%b5">Посмотреть информацию о пользователе</a>
</h2><ul>
<li>Посмотреть информацию о пользователе <code>username</code>:</li>
</ul>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-8
shortcode-codeblock-bash">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-4c32c16c6c4f471fde66302fa13b05e3" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="nv">u</span><span class="o">=</span><span class="s1">&#39;username&#39;</span><span class="p">;</span> pw show user <span class="s2">&#34;</span><span class="si">${</span><span class="nv">u</span><span class="si">}</span><span class="s2">&#34;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-4c32c16c6c4f471fde66302fa13b05e3"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>]]></turbo:content></item><item turbo="true"><title>iRedMail: Управление белым и чёрным списками</title><link>https://lib.onl/ru/2024/05/27b4071a-6d32-5517-83c7-dd77ee740e87/</link><pubDate>Sat, 25 May 2024 06:02:49 +0000</pubDate><dc:creator>Kai Kimera</dc:creator><category>Linux</category><category>Безопасность</category><category>Терминал</category><turbo:extendedHtml>true</turbo:extendedHtml><turbo:source>https://lib.onl/ru/2024/05/27b4071a-6d32-5517-83c7-dd77ee740e87/</turbo:source><turbo:topic>iRedMail: Управление белым и чёрным списками</turbo:topic><turbo:content><![CDATA[<p>Белый и чёрный списки являются списками фильтрации входящих электронных писем на уровне сервера.</p>
<p>Чёрный список позволяет заблокировать поступление электронных писем от определённого абонента, белый список, напротив, разрешить поступление электронных писем от отправителя вне зависимости от их содержания и дополнительных проверок почтовым сервером.</p>
<p>В <span class="shortcode shortcode-tag"><a href="/ru/tags/iredmail/" target="_blank">#iRedMail</a></span> чёрный и белый списки контролируются плагином <code>amavisd_wblist</code> (<code>/opt/iredapd/plugins/amavisd_wblist.py</code>). Самим же плагином можно управлять при помощи скрипта <code>wblist_admin.py</code> (<code>/opt/iredapd/tools/wblist_admin.py</code>).</p>
<h2 id="форматы-адресов">
  <a class="link-body-emphasis" href="#%d1%84%d0%be%d1%80%d0%bc%d0%b0%d1%82%d1%8b-%d0%b0%d0%b4%d1%80%d0%b5%d1%81%d0%be%d0%b2">Форматы адресов</a>
</h2><p>Допустимые форматы адресов для белого и чёрного списков:</p>
<ul>
<li><code>user@domain.com</code> - один пользователь.</li>
<li><code>@domain.com</code> / <code>@sub.domain.com</code> - один домен.</li>
<li><code>@.domain.com</code> - домен и все его суб-домены.</li>
<li><code>@.</code> - любой домен.</li>
<li><code>@.com</code> / <code>@.org</code> / <code>@.info</code> - домен верхнего уровня.</li>
<li><code>192.168.1.2</code> - один IP-адрес.</li>
<li><code>192.168.1.0/24</code> - Сеть CIDR.</li>
</ul>
<h2 id="примеры-для-белого-списка">
  <a class="link-body-emphasis" href="#%d0%bf%d1%80%d0%b8%d0%bc%d0%b5%d1%80%d1%8b-%d0%b4%d0%bb%d1%8f-%d0%b1%d0%b5%d0%bb%d0%be%d0%b3%d0%be-%d1%81%d0%bf%d0%b8%d1%81%d0%ba%d0%b0">Примеры для белого списка</a>
</h2><ul>
<li>Показать записи из белого списка:</li>
</ul>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-0
shortcode-codeblock-bash">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-44195b209e3de7a4b681d479ac6e033d" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">python3 <span class="s1">&#39;/opt/iredapd/tools/wblist_admin.py&#39;</span> --list --whitelist</span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-44195b209e3de7a4b681d479ac6e033d"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<ul>
<li>Добавить в белый список IP-адрес, email, домен и суб-домен:</li>
</ul>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-1
shortcode-codeblock-bash">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-7ad608018cf44fb664a0f1f90d7e7d97" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">python3 <span class="s1">&#39;/opt/iredapd/tools/wblist_admin.py&#39;</span> --add --whitelist <span class="s1">&#39;192.168.1.10&#39;</span> <span class="s1">&#39;user@domain.com&#39;</span> <span class="s1">&#39;@iredmail.org&#39;</span> <span class="s1">&#39;@.example.com&#39;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-7ad608018cf44fb664a0f1f90d7e7d97"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<ul>
<li>Создать для локального почтового домена <code>@domain.com</code> белый список и внести в него IP-адрес <code>192.168.1.10</code> и email <code>user@example.com</code>:</li>
</ul>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-2
shortcode-codeblock-bash">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-44a984bf26f5cb5f9756adb7b9a8ed13" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">python3 <span class="s1">&#39;/opt/iredapd/tools/wblist_admin.py&#39;</span> --account <span class="s1">&#39;@domain.com&#39;</span> --add --whitelist <span class="s1">&#39;192.168.1.10&#39;</span> <span class="s1">&#39;user@example.com&#39;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-44a984bf26f5cb5f9756adb7b9a8ed13"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<ul>
<li>Создать для локального почтового домена <code>@domain.com</code> и всех его суб-доменов белый список и внести в него IP-адрес <code>192.168.1.10</code> и email <code>user@example.com</code>:</li>
</ul>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-3
shortcode-codeblock-bash">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-1feee2bd1d5fb2c45e9ec26882bc0cc5" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">python3 <span class="s1">&#39;/opt/iredapd/tools/wblist_admin.py&#39;</span> --account <span class="s1">&#39;@.domain.com&#39;</span> --add --whitelist <span class="s1">&#39;192.168.1.10&#39;</span> <span class="s1">&#39;user@example.com&#39;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-1feee2bd1d5fb2c45e9ec26882bc0cc5"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<ul>
<li>Создать для локального пользователя <code>user@domain.com</code> белый список и внести в него IP-адрес <code>192.168.1.10</code> и email <code>user@example.com</code>:</li>
</ul>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-4
shortcode-codeblock-bash">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-04a0d13a6f46a6db2b3285112d297e29" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">python3 <span class="s1">&#39;/opt/iredapd/tools/wblist_admin.py&#39;</span> --account <span class="s1">&#39;user@domain.com&#39;</span> --add --whitelist <span class="s1">&#39;192.168.1.10&#39;</span> <span class="s1">&#39;user@example.com&#39;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-04a0d13a6f46a6db2b3285112d297e29"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<ul>
<li>Показать записи из белого списка для локального почтового домена <code>@domain.com</code>:</li>
</ul>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-5
shortcode-codeblock-bash">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-cecbaa11ac8a2813111e7ed6a044cb10" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">python3 <span class="s1">&#39;/opt/iredapd/tools/wblist_admin.py&#39;</span> --account <span class="s1">&#39;@domain.com&#39;</span> --list --whitelist</span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-cecbaa11ac8a2813111e7ed6a044cb10"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<ul>
<li>Показать записи из белого списка для локального пользователя <code>user@domain.com</code>:</li>
</ul>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-6
shortcode-codeblock-bash">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-a28b2dc2b4d98de2711a032d9207f2bd" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">python3 <span class="s1">&#39;/opt/iredapd/tools/wblist_admin.py&#39;</span> --account <span class="s1">&#39;user@domain.com&#39;</span> --list --whitelist</span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-a28b2dc2b4d98de2711a032d9207f2bd"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<h2 id="примеры-для-чёрного-списка">
  <a class="link-body-emphasis" href="#%d0%bf%d1%80%d0%b8%d0%bc%d0%b5%d1%80%d1%8b-%d0%b4%d0%bb%d1%8f-%d1%87%d1%91%d1%80%d0%bd%d0%be%d0%b3%d0%be-%d1%81%d0%bf%d0%b8%d1%81%d0%ba%d0%b0">Примеры для чёрного списка</a>
</h2><ul>
<li>Показать записи из чёрного списка:</li>
</ul>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-7
shortcode-codeblock-bash">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-af9115d708cb30f34d083c317208fbd2" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">python3 <span class="s1">&#39;/opt/iredapd/tools/wblist_admin.py&#39;</span> --list --blacklist</span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-af9115d708cb30f34d083c317208fbd2"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<ul>
<li>Добавить в чёрный список IP-адрес, email, домен и суб-домен:</li>
</ul>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-8
shortcode-codeblock-bash">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-dcddf4f865814cdaf16a27a32a4c1477" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">python3 <span class="s1">&#39;/opt/iredapd/tools/wblist_admin.py&#39;</span> --add --blacklist <span class="s1">&#39;202.96.134.133&#39;</span> <span class="s1">&#39;bad-user@domain.com&#39;</span> <span class="s1">&#39;@bad-domain.com&#39;</span> <span class="s1">&#39;@.sub-domain.com&#39;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-dcddf4f865814cdaf16a27a32a4c1477"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<ul>
<li>Создать для локального почтового домена <code>@domain.com</code> чёрный список и внести в него IP-адрес <code>172.16.1.10</code> и email <code>bad-user@example.com</code>:</li>
</ul>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-9
shortcode-codeblock-bash">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-6eacba8418625629812aaca64f7d3fc9" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">python3 <span class="s1">&#39;/opt/iredapd/tools/wblist_admin.py&#39;</span> --account <span class="s1">&#39;@domain.com&#39;</span> --add --blacklist <span class="s1">&#39;172.16.1.10&#39;</span> <span class="s1">&#39;bad-user@example.com&#39;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-6eacba8418625629812aaca64f7d3fc9"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<ul>
<li>Создать для локального почтового домена <code>@domain.com</code> и всех его суб-доменов чёрный список и внести в него IP-адрес <code>172.16.1.10</code> и email <code>bad-user@example.com</code>:</li>
</ul>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-10
shortcode-codeblock-bash">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-4e2e43bd93e659601ba6a3a2506a5d5e" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">python3 <span class="s1">&#39;/opt/iredapd/tools/wblist_admin.py&#39;</span> --account <span class="s1">&#39;@.domain.com&#39;</span> --add --blacklist <span class="s1">&#39;172.16.1.10&#39;</span> <span class="s1">&#39;bad-user@example.com&#39;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-4e2e43bd93e659601ba6a3a2506a5d5e"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<ul>
<li>Создать для локального пользователя <code>user@domain.com</code> чёрный список и внести в него IP-адрес <code>172.16.1.10</code> и email <code>bad-user@example.com</code>:</li>
</ul>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-11
shortcode-codeblock-bash">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-fdd578e3425a36708b31cb1540d34879" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">python3 <span class="s1">&#39;/opt/iredapd/tools/wblist_admin.py&#39;</span> --account <span class="s1">&#39;user@domain.com&#39;</span> --add --blacklist <span class="s1">&#39;172.16.1.10&#39;</span> <span class="s1">&#39;bad-user@example.com&#39;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-fdd578e3425a36708b31cb1540d34879"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<ul>
<li>Показать записи из чёрного списка для локального пользователя <code>user@domain.com</code>:</li>
</ul>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-12
shortcode-codeblock-bash">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-8d9118a0a41c0d3d53be2c962021c0f6" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">python3 <span class="s1">&#39;/opt/iredapd/tools/wblist_admin.py&#39;</span> --account <span class="s1">&#39;user@domain.com&#39;</span> --list --blacklist</span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-8d9118a0a41c0d3d53be2c962021c0f6"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<h2 id="серый-список">
  <a class="link-body-emphasis" href="#%d1%81%d0%b5%d1%80%d1%8b%d0%b9-%d1%81%d0%bf%d0%b8%d1%81%d0%be%d0%ba">Серый список</a>
</h2><p>За серый список отвечает плагин <code>greylisting</code> (<code>/opt/iredapd/plugins/greylisting.py</code>). Этим плагином можно управлять при помощи скрипта <code>greylisting_admin.py</code> (<code>/opt/iredapd/tools/greylisting_admin.py</code>).</p>
<h3 id="примеры-для-серого-списка">
  <a class="link-body-emphasis" href="#%d0%bf%d1%80%d0%b8%d0%bc%d0%b5%d1%80%d1%8b-%d0%b4%d0%bb%d1%8f-%d1%81%d0%b5%d1%80%d0%be%d0%b3%d0%be-%d1%81%d0%bf%d0%b8%d1%81%d0%ba%d0%b0">Примеры для серого списка</a>
</h3><ul>
<li>Отключить глобальный серый список:</li>
</ul>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-13
shortcode-codeblock-bash">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-966244f59cc70d4db9626d01fdf3ae8f" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">python3 <span class="s1">&#39;/opt/iredapd/tools/greylisting_admin.py&#39;</span> --disable --from <span class="s1">&#39;@.&#39;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-966244f59cc70d4db9626d01fdf3ae8f"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<ul>
<li>Показать все настройки серого списка:</li>
</ul>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-14
shortcode-codeblock-bash">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-e8d200ba568022382769412900a9f057" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">python3 <span class="s1">&#39;/opt/iredapd/tools/greylisting_admin.py&#39;</span> --list</span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-e8d200ba568022382769412900a9f057"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<ul>
<li>Показать все доменные имена отправителей из белого списка:</li>
</ul>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-15
shortcode-codeblock-bash">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-b6bc8c956a746733408a9cd1e408c505" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">python3 <span class="s1">&#39;/opt/iredapd/tools/greylisting_admin.py&#39;</span> --list-whitelist-domains</span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-b6bc8c956a746733408a9cd1e408c505"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<ul>
<li>Показать все адреса отправителей из белого списка:</li>
</ul>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-16
shortcode-codeblock-bash">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-89560d7768aa1ef5bf0c0236b227ba98" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">python3 <span class="s1">&#39;/opt/iredapd/tools/greylisting_admin.py&#39;</span> --list-whitelists</span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-89560d7768aa1ef5bf0c0236b227ba98"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<ul>
<li>Добавить домен отправителя <code>@example.com</code> в белый список:</li>
</ul>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-17
shortcode-codeblock-bash">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-00c8e3d51edd1d1562f3dfd93a087bba" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">python3 <span class="s1">&#39;/opt/iredapd/tools/greylisting_admin.py&#39;</span> --whitelist-domain --from <span class="s1">&#39;@example.com&#39;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-00c8e3d51edd1d1562f3dfd93a087bba"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<ul>
<li>Удалить домен отправителя <code>@example.com</code> из белого списка:</li>
</ul>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-18
shortcode-codeblock-bash">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-0a7638ffcd7a06b084ed0950612525fd" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">python3 <span class="s1">&#39;/opt/iredapd/tools/greylisting_admin.py&#39;</span> --remove-whitelist-domain --from <span class="s1">&#39;@example.com&#39;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-0a7638ffcd7a06b084ed0950612525fd"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<ul>
<li>Включить серый список для локального почтового домена <code>@example.com</code>:</li>
</ul>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-19
shortcode-codeblock-bash">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-3777b785ff4739705c6152d5cbcdeca6" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">python3 <span class="s1">&#39;/opt/iredapd/tools/greylisting_admin.py&#39;</span> --enable --to <span class="s1">&#39;@example.com&#39;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-3777b785ff4739705c6152d5cbcdeca6"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<ul>
<li>Отключить серый список для локального пользователя <code>user@example.com</code>:</li>
</ul>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-20
shortcode-codeblock-bash">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-cbedd47e1f6da71e1e08a9d1e59eeb53" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">python3 <span class="s1">&#39;/opt/iredapd/tools/greylisting_admin.py&#39;</span> --disable --to <span class="s1">&#39;user@example.com&#39;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-cbedd47e1f6da71e1e08a9d1e59eeb53"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<ul>
<li>Отключить серый список для писем, отправленных с домена <code>@gmail.com</code> локальному пользователю <code>user@example.com</code>:</li>
</ul>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-21
shortcode-codeblock-bash">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-a2469235e7ca4d8e375a4cff053f2d64" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">python3 <span class="s1">&#39;/opt/iredapd/tools/greylisting_admin.py&#39;</span> --disable --from <span class="s1">&#39;@gmail.com&#39;</span> --to <span class="s1">&#39;user@example.com&#39;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-a2469235e7ca4d8e375a4cff053f2d64"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<ul>
<li>Отключить серый список для писем, отправленных с IP-адреса <code>45.56.127.226</code>:</li>
</ul>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-22
shortcode-codeblock-bash">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-33b01a46c1aecef6d547e95b0b1b8bef" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">python3 <span class="s1">&#39;/opt/iredapd/tools/greylisting_admin.py&#39;</span> --disable --from <span class="s1">&#39;45.56.127.226&#39;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-33b01a46c1aecef6d547e95b0b1b8bef"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<ul>
<li>Удалить настройки серого списка для локального домена <code>@test.com</code>:</li>
</ul>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-23
shortcode-codeblock-bash">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-0f0fc84f463e2e43860a73e969bec49e" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">python3 <span class="s1">&#39;/opt/iredapd/tools/greylisting_admin.py&#39;</span> --delete --to <span class="s1">&#39;@test.com&#39;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-0f0fc84f463e2e43860a73e969bec49e"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>]]></turbo:content></item><item turbo="true"><title>Как изменить IP-адрес в Proxmox VE?</title><link>https://lib.onl/ru/2024/05/ffbb2491-6784-510a-a067-2f08cc76c221/</link><pubDate>Sat, 11 May 2024 12:43:38 +0000</pubDate><dc:creator>Kai Kimera</dc:creator><category>Proxmox</category><category>Ip</category><turbo:extendedHtml>true</turbo:extendedHtml><turbo:source>https://lib.onl/ru/2024/05/ffbb2491-6784-510a-a067-2f08cc76c221/</turbo:source><turbo:topic>Как изменить IP-адрес в Proxmox VE?</turbo:topic><turbo:content><![CDATA[<p>Есть несколько серверов на <span class="shortcode shortcode-tag"><a href="/ru/tags/proxmox/" target="_blank">#Proxmox</a></span> VE. Сейчас идёт реструктуризация сети. Необходимо поменять IP-адреса на серверах <span class="shortcode shortcode-tag"><a href="/ru/tags/proxmox/" target="_blank">#Proxmox</a></span> VE. Как это сделать?</p>]]></turbo:content></item><item turbo="true"><title>Cisco: Туннель GRE/IPsec (Site-to-Site) + OSPF</title><link>https://lib.onl/ru/2024/05/7b3bb6b3-c7db-550c-abf6-9d88c66a8a74/</link><pubDate>Fri, 03 May 2024 07:48:22 +0000</pubDate><dc:creator>Kai Kimera</dc:creator><category>Сеть</category><category>В доработке</category><yandex:related><link url="https://lib.onl/ru/2024/04/326618af-d950-5001-8114-57c66bb8a5af/">MikroTik: Туннель GRE/IPsec (Site-to-Site)</link><link url="https://lib.onl/ru/2024/03/b81f9cca-d723-5b72-929a-b88be9d329f9/">Cisco: Обновление IOS</link><link url="https://lib.onl/ru/2024/04/9538d25f-c145-5a84-8583-65f3a2ed4c84/">Cisco: Установка лицензий</link><link url="https://lib.onl/ru/2024/03/54a2b39f-38b4-5f0c-9b54-310f853da38f/">MikroTik: Туннель IPsec (Site-to-Site)</link><link url="https://lib.onl/ru/2024/03/4a7addb9-eff3-5482-902c-791fbe49899f/">Cisco: Загрузка и выгрузка конфигурации</link><link url="https://lib.onl/ru/2024/03/fc67eb74-8f7c-5de3-bd1e-2d823208eae2/">Cisco: Сброс пароля</link></yandex:related><turbo:extendedHtml>true</turbo:extendedHtml><turbo:source>https://lib.onl/ru/2024/05/7b3bb6b3-c7db-550c-abf6-9d88c66a8a74/</turbo:source><turbo:topic>Cisco: Туннель GRE/IPsec (Site-to-Site) + OSPF</turbo:topic><turbo:content><![CDATA[<p>Инструкция по созданию туннеля <span class="shortcode shortcode-tag"><a href="/ru/tags/gre/" target="_blank">#GRE</a></span> с шифрованием <span class="shortcode shortcode-tag"><a href="/ru/tags/ipsec/" target="_blank">#IPsec</a></span> на <span class="shortcode shortcode-tag"><a href="/ru/tags/cisco/" target="_blank">#Cisco</a></span>.</p>
<h2 id="вводные-данные">
  <a class="link-body-emphasis" href="#%d0%b2%d0%b2%d0%be%d0%b4%d0%bd%d1%8b%d0%b5-%d0%b4%d0%b0%d0%bd%d0%bd%d1%8b%d0%b5">Вводные данные</a>
</h2><ul>
<li>Маршрутизатор <code>R1</code>:
<ul>
<li>WAN IP: <code>1.1.1.1</code>.</li>
<li>LAN IP: <code>10.1.0.1</code>.</li>
<li>Network: <code>10.1.0.0/16</code>.</li>
<li>TUN0 IP: <code>10.255.255.1/24</code>.</li>
</ul>
</li>
<li>Маршрутизатор <code>R2</code>:
<ul>
<li>WAN IP: <code>2.2.2.2</code>.</li>
<li>LAN IP: <code>10.2.0.1</code>.</li>
<li>Network: <code>10.2.0.0/16</code>.</li>
<li>TUN0 IP: <code>10.255.255.2/24</code>.</li>
</ul>
</li>
</ul>
<h2 id="настройки-маршрутизаторов">
  <a class="link-body-emphasis" href="#%d0%bd%d0%b0%d1%81%d1%82%d1%80%d0%be%d0%b9%d0%ba%d0%b8-%d0%bc%d0%b0%d1%80%d1%88%d1%80%d1%83%d1%82%d0%b8%d0%b7%d0%b0%d1%82%d0%be%d1%80%d0%be%d0%b2">Настройки маршрутизаторов</a>
</h2><h3 id="router-1">
  <a class="link-body-emphasis" href="#router-1">Router #1</a>
</h3><ul>
<li>Создаём политику <span class="shortcode shortcode-tag"><a href="/ru/tags/ipsec/" target="_blank">#IPsec</a></span>:
<ul>
<li>Метод шифрования для <strong>Phase 1</strong>: <code>encr aes 256</code>.</li>
<li>Использование общего ключа для проверки подлинности: <code>authentication pre-share</code>.</li>
<li>Группа Diffie–Hellman: <code>group 2</code>.</li>
</ul>
</li>
</ul>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-0
shortcode-codeblock-plaintext">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-cd8183fb8adc85c37237a895d328d25f" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-plaintext" data-lang="plaintext"><span class="line"><span class="cl">crypto isakmp policy 5
</span></span><span class="line"><span class="cl">  encr aes 256
</span></span><span class="line"><span class="cl">  authentication pre-share
</span></span><span class="line"><span class="cl">  group 2</span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-cd8183fb8adc85c37237a895d328d25f"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<ul>
<li>Указываем общий ключ:
<ul>
<li>Общий ключ: <code>PassWord</code>.</li>
<li>IP-адрес удалённого маршрутизатора <code>R2</code>: <code>2.2.2.2</code>.</li>
</ul>
</li>
</ul>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-1
shortcode-codeblock-plaintext">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-eb5e7d5cbdecd3373cd78034f29b44fb" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-plaintext" data-lang="plaintext"><span class="line"><span class="cl">crypto isakmp key PassWord address 2.2.2.2</span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-eb5e7d5cbdecd3373cd78034f29b44fb"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<ul>
<li>Настраиваем набор преобразований для защиты данных:
<ul>
<li>Название набора преобразований: <code>GRE-TS</code>.</li>
<li>Метод шифрования: <code>esp-aes 256</code>.</li>
<li>Алгоритм хеширования: <code>esp-sha-hmac</code>.</li>
</ul>
</li>
</ul>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-2
shortcode-codeblock-plaintext">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-b27fc1bbfc33db7a5595d5d421fd5140" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-plaintext" data-lang="plaintext"><span class="line"><span class="cl">crypto ipsec transform-set GRE-TS esp-aes 256 esp-sha-hmac</span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-b27fc1bbfc33db7a5595d5d421fd5140"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<ul>
<li>Создаём профиль <span class="shortcode shortcode-tag"><a href="/ru/tags/ipsec/" target="_blank">#IPsec</a></span>:
<ul>
<li>Название туннеля: <code>GRE-STS</code>.</li>
<li>Название набора преобразований: <code>GRE-TS</code>.</li>
<li>Алгоритм Diffie–Hellman&rsquo;а (1024 бита): <code>pfs group2</code>. Использование данной опции позволяет повысить уровень защищенности трафика - при создании каждого IPsec SA производится выработка новых сессионных ключей.</li>
</ul>
</li>
</ul>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-3
shortcode-codeblock-plaintext">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-55d968deed1002908487aa70f491aa8a" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-plaintext" data-lang="plaintext"><span class="line"><span class="cl">crypto ipsec profile GRE-STS
</span></span><span class="line"><span class="cl">  set transform-set GRE-TS
</span></span><span class="line"><span class="cl">  set pfs group2</span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-55d968deed1002908487aa70f491aa8a"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<ul>
<li>Создаём туннель:
<ul>
<li>Название интерфейса: <code>Tunnel0</code>.</li>
<li>IP-адрес и маска интерфейса: <code>10.255.255.1 255.255.255.0</code>.</li>
<li>MTU: <code>1400</code>.</li>
<li>MSS: <code>1360</code>.</li>
<li>WAN IP-адрес локального маршрутизатора <code>R1</code>: <code>1.1.1.1</code>.</li>
<li>WAN IP-адрес удалённого маршрутизатора <code>R2</code>: <code>2.2.2.2</code>.</li>
<li>Профиль <span class="shortcode shortcode-tag"><a href="/ru/tags/ipsec/" target="_blank">#IPsec</a></span>: <code>GRE-STS</code>.</li>
</ul>
</li>
</ul>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-4
shortcode-codeblock-plaintext">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-62147508ca70bd4f2935aec832b526ae" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-plaintext" data-lang="plaintext"><span class="line"><span class="cl">interface Tunnel0
</span></span><span class="line"><span class="cl">  ip address 10.255.255.1 255.255.255.0
</span></span><span class="line"><span class="cl">  tunnel source 1.1.1.1
</span></span><span class="line"><span class="cl">  tunnel destination 2.2.2.2
</span></span><span class="line"><span class="cl">  tunnel protection ipsec profile GRE-STS</span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-62147508ca70bd4f2935aec832b526ae"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<ul>
<li>Прописываем маршрут до удалённого роутера <code>R2</code>:
<ul>
<li>Сеть удалённого роутера <code>R2</code>: <code>10.2.0.0</code>.</li>
<li>Маска подсети удалённого роутера <code>R2</code>: <code>255.255.0.0</code>.</li>
<li>IP-адрес шлюза удалённого роутера <code>R2</code>: <code>10.255.255.2</code>.</li>
</ul>
</li>
</ul>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-5
shortcode-codeblock-plaintext">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-93d4e2e0d19a6b66d81367d94a260c83" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-plaintext" data-lang="plaintext"><span class="line"><span class="cl">ip route 10.2.0.0 255.255.0.0 10.255.255.2</span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-93d4e2e0d19a6b66d81367d94a260c83"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<ul>
<li>Настройка <span class="shortcode shortcode-tag"><a href="/ru/tags/ospf/" target="_blank">#OSPF</a></span>:
<ul>
<li>Указание ID маршрутизатора: <code>router-id 10.1.0.1</code>.</li>
<li>Отключение HELLO-пакетов на всех интерфейсах: <code>passive-interface default</code>.</li>
<li>Включение HELLO-пакетов на интерфейсе <code>Tunnel0</code>: <code>no passive-interface Tunnel0</code>.</li>
<li>Анонсирование сети <code>10.1.0.0/16</code> в <span class="shortcode shortcode-tag"><a href="/ru/tags/ospf/" target="_blank">#OSPF</a></span>: <code>network 10.1.0.0 0.0.255.255 area 0</code>.</li>
</ul>
</li>
</ul>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-6
shortcode-codeblock-plaintext">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-8c25dfbb548ce6c1c898c7c9817f38f4" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-plaintext" data-lang="plaintext"><span class="line"><span class="cl">router ospf 5
</span></span><span class="line"><span class="cl">  router-id 10.1.0.1
</span></span><span class="line"><span class="cl">  passive-interface default
</span></span><span class="line"><span class="cl">  no passive-interface Tunnel0
</span></span><span class="line"><span class="cl">  network 10.1.0.0 0.0.255.255 area 0</span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-8c25dfbb548ce6c1c898c7c9817f38f4"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<h3 id="router-2">
  <a class="link-body-emphasis" href="#router-2">Router #2</a>
</h3><ul>
<li>Создаём политику <span class="shortcode shortcode-tag"><a href="/ru/tags/ipsec/" target="_blank">#IPsec</a></span>:
<ul>
<li>Метод шифрования для <strong>Phase 1</strong>: <code>encr aes 256</code>.</li>
<li>Использование общего ключа для проверки подлинности: <code>authentication pre-share</code>.</li>
<li>Группа Diffie–Hellman: <code>group 2</code>.</li>
</ul>
</li>
</ul>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-7
shortcode-codeblock-plaintext">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-41bd080816b0cbad7ef539cb9c6da6b6" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-plaintext" data-lang="plaintext"><span class="line"><span class="cl">crypto isakmp policy 5
</span></span><span class="line"><span class="cl">  encr aes 256
</span></span><span class="line"><span class="cl">  authentication pre-share
</span></span><span class="line"><span class="cl">  group 2</span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-41bd080816b0cbad7ef539cb9c6da6b6"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<ul>
<li>Указываем общий ключ:
<ul>
<li>Общий ключ: <code>PassWord</code>.</li>
<li>IP адрес удалённого маршрутизатора <code>R1</code>: <code>1.1.1.1</code>.</li>
</ul>
</li>
</ul>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-8
shortcode-codeblock-plaintext">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-8f896345395dae3b221b3846c649dfe4" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-plaintext" data-lang="plaintext"><span class="line"><span class="cl">crypto isakmp key PassWord address 1.1.1.1</span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-8f896345395dae3b221b3846c649dfe4"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<ul>
<li>Настраиваем набор преобразований для защиты данных:
<ul>
<li>Название набора преобразований: <code>GRE-TS</code>.</li>
<li>Метод шифрования: <code>esp-aes 256</code>.</li>
<li>Алгоритм хеширования: <code>esp-sha-hmac</code>.</li>
</ul>
</li>
</ul>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-9
shortcode-codeblock-plaintext">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-6fdb53606eb4168cd71ff0ba8ea705cc" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-plaintext" data-lang="plaintext"><span class="line"><span class="cl">crypto ipsec transform-set GRE-TS esp-aes 256 esp-sha-hmac</span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-6fdb53606eb4168cd71ff0ba8ea705cc"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<ul>
<li>Создаём профиль <span class="shortcode shortcode-tag"><a href="/ru/tags/ipsec/" target="_blank">#IPsec</a></span>:
<ul>
<li>Название туннеля: <code>GRE-STS</code>.</li>
<li>Название набора преобразований: <code>GRE-TS</code>.</li>
<li>Алгоритм Diffie–Hellman&rsquo;а (1024 бита): <code>pfs group2</code>. Использование данной опции позволяет повысить уровень защищенности трафика - при создании каждого IPsec SA производится выработка новых сессионных ключей.</li>
</ul>
</li>
</ul>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-10
shortcode-codeblock-plaintext">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-a56f8cb09f79560692730fc24401046a" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-plaintext" data-lang="plaintext"><span class="line"><span class="cl">crypto ipsec profile GRE-STS
</span></span><span class="line"><span class="cl">  set transform-set GRE-TS
</span></span><span class="line"><span class="cl">  set pfs group2</span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-a56f8cb09f79560692730fc24401046a"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<ul>
<li>Создаём туннель:
<ul>
<li>Название интерфейса: <code>Tunnel0</code>.</li>
<li>IP-адрес и маска интерфейса: <code>10.255.255.2 255.255.255.0</code>.</li>
<li>MTU: <code>1400</code>.</li>
<li>MSS: <code>1360</code>.</li>
<li>WAN IP-адрес локального маршрутизатора <code>R2</code>: <code>2.2.2.2</code>.</li>
<li>WAN IP-адрес удалённого маршрутизатора <code>R1</code>: <code>1.1.1.1</code>.</li>
<li>Профиль <span class="shortcode shortcode-tag"><a href="/ru/tags/ipsec/" target="_blank">#IPsec</a></span>: <code>GRE-STS</code>.</li>
</ul>
</li>
</ul>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-11
shortcode-codeblock-plaintext">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-3b2e5753a733b587a2b0523878b0708d" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-plaintext" data-lang="plaintext"><span class="line"><span class="cl">interface Tunnel0
</span></span><span class="line"><span class="cl">  ip address 10.255.255.2 255.255.255.0
</span></span><span class="line"><span class="cl">  tunnel source 2.2.2.2
</span></span><span class="line"><span class="cl">  tunnel destination 1.1.1.1
</span></span><span class="line"><span class="cl">  tunnel protection ipsec profile GRE-STS</span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-3b2e5753a733b587a2b0523878b0708d"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<ul>
<li>Прописываем маршрут до удалённого роутера <code>R1</code>:
<ul>
<li>Сеть удалённого роутера <code>R1</code>: <code>10.1.0.0</code>.</li>
<li>Маска подсети удалённого роутера <code>R1</code>: <code>255.255.0.0</code>.</li>
<li>IP-адрес шлюза удалённого роутера <code>R1</code>: <code>10.255.255.1</code>.</li>
</ul>
</li>
</ul>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-12
shortcode-codeblock-plaintext">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-b9c6f7815092c5eaa8fe868c86766e75" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-plaintext" data-lang="plaintext"><span class="line"><span class="cl">ip route 10.1.0.0 255.255.0.0 10.255.255.1</span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-b9c6f7815092c5eaa8fe868c86766e75"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<ul>
<li>Настройка <span class="shortcode shortcode-tag"><a href="/ru/tags/ospf/" target="_blank">#OSPF</a></span>:
<ul>
<li>Указание ID маршрутизатора: <code>router-id 10.2.0.1</code>.</li>
<li>Отключение HELLO-пакетов на всех интерфейсах: <code>passive-interface default</code>.</li>
<li>Включение HELLO-пакетов на интерфейсе <code>Tunnel0</code>: <code>no passive-interface Tunnel0</code>.</li>
<li>Анонсирование сети <code>10.1.0.0/16</code> в <span class="shortcode shortcode-tag"><a href="/ru/tags/ospf/" target="_blank">#OSPF</a></span>: <code>network 10.2.0.0 0.0.255.255 area 0</code>.</li>
</ul>
</li>
</ul>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-13
shortcode-codeblock-plaintext">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-48586cc04a5fef44ed376614f3024274" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-plaintext" data-lang="plaintext"><span class="line"><span class="cl">router ospf 5
</span></span><span class="line"><span class="cl">  router-id 10.2.0.1
</span></span><span class="line"><span class="cl">  passive-interface default
</span></span><span class="line"><span class="cl">  no passive-interface Tunnel0
</span></span><span class="line"><span class="cl">  network 10.2.0.0 0.0.255.255 area 0</span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-48586cc04a5fef44ed376614f3024274"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>]]></turbo:content></item><item turbo="true"><title>Cisco: Базовая настройка</title><link>https://lib.onl/ru/2024/04/8caf49e3-8f13-5145-90ab-8ba1f2cb1c37/</link><pubDate>Thu, 25 Apr 2024 19:16:43 +0000</pubDate><dc:creator>Kai Kimera</dc:creator><category>В доработке</category><category>Сеть</category><yandex:related><link url="https://lib.onl/ru/2024/05/7b3bb6b3-c7db-550c-abf6-9d88c66a8a74/">Cisco: Туннель GRE/IPsec (Site-to-Site) + OSPF</link><link url="https://lib.onl/ru/2024/03/b81f9cca-d723-5b72-929a-b88be9d329f9/">Cisco: Обновление IOS</link><link url="https://lib.onl/ru/2024/04/9538d25f-c145-5a84-8583-65f3a2ed4c84/">Cisco: Установка лицензий</link><link url="https://lib.onl/ru/2024/03/4a7addb9-eff3-5482-902c-791fbe49899f/">Cisco: Загрузка и выгрузка конфигурации</link><link url="https://lib.onl/ru/2024/03/fc67eb74-8f7c-5de3-bd1e-2d823208eae2/">Cisco: Сброс пароля</link></yandex:related><turbo:extendedHtml>true</turbo:extendedHtml><turbo:source>https://lib.onl/ru/2024/04/8caf49e3-8f13-5145-90ab-8ba1f2cb1c37/</turbo:source><turbo:topic>Cisco: Базовая настройка</turbo:topic><turbo:content><![CDATA[<p>Представлю базовый конфигурационный файл для маршрутизатора <span class="shortcode shortcode-tag"><a href="/ru/tags/cisco/" target="_blank">#Cisco</a></span>. При помощи него можно быстро запустить маршрутизатор, предварительно подставив свои значения.</p>
<h2 id="параметры-конфигурации">
  <a class="link-body-emphasis" href="#%d0%bf%d0%b0%d1%80%d0%b0%d0%bc%d0%b5%d1%82%d1%80%d1%8b-%d0%ba%d0%be%d0%bd%d1%84%d0%b8%d0%b3%d1%83%d1%80%d0%b0%d1%86%d0%b8%d0%b8">Параметры конфигурации</a>
</h2><ul>
<li>Пароль администратора (<code>enable</code>): <code>qwerty-en</code>.</li>
<li>Пользователи:
<ul>
<li><code>admin:qwerty-admin</code>.</li>
</ul>
</li>
<li>Интерфейсы:
<ul>
<li><code>FastEthernet0/0</code>:
<ul>
<li>IP: <code>DHCP</code>.</li>
</ul>
</li>
<li><code>FastEthernet0/1</code>:
<ul>
<li>IP: <code>10.88.0.1/16</code>.</li>
</ul>
</li>
<li><code>Loopback0</code>:
<ul>
<li>IP: <code>10.90.10.1/32</code>.</li>
</ul>
</li>
<li><code>Loopback1</code>:
<ul>
<li>IP: <code>10.90.20.1/32</code>.</li>
</ul>
</li>
</ul>
</li>
<li>Локальная сеть:
<ul>
<li>Маска: <code>10.88.0.0/16</code>.</li>
<li>Домен: <code>home.lan</code>.</li>
</ul>
</li>
</ul>
<h3 id="сервисы">
  <a class="link-body-emphasis" href="#%d1%81%d0%b5%d1%80%d0%b2%d0%b8%d1%81%d1%8b">Сервисы</a>
</h3><ul>
<li><code>service password-encryption</code> - включить шифрования паролей в консоли, терминале и конфигурации.</li>
<li><code>service timestamps debug datetime msec localtime show-timezone</code> - установить местное время в режиме отладки.</li>
<li><code>service timestamps log datetime msec localtime show-timezone</code> - установить местное время в режиме логирования.</li>
<li><code>service tcp-keepalives-in</code> и <code>service tcp-keepalives-out</code> - включить поддержку активности сеансов TCP для входящих и исходящих подключений. Эти параметры позволяют проверять доступность удалённого устройства при помощи специальных keepalive-пакетов, а полуоткрытые и потерянные соединения убудут удалены с локального устройства Cisco.</li>
<li><code>service sequence-numbers</code> - включить нумерование сообщений при логировании событий. Параметр позволяет выяснить потерянные сообщения из-за <code>rate-limit</code> на Cisco или когда эти сообщения передаются по сети с использованием syslog по протоколу UDP.</li>
<li><code>no service pad</code> - отключить сервис PAD (X.25).</li>
<li><code>no service udp-small-servers</code> и <code>no service tcp-small-servers</code> - отключить использование небольших TCP &amp; UDP серверов.</li>
<li><code>no service finger</code> - отключить протокол Finger.</li>
</ul>
<h3 id="основные-настройки">
  <a class="link-body-emphasis" href="#%d0%be%d1%81%d0%bd%d0%be%d0%b2%d0%bd%d1%8b%d0%b5-%d0%bd%d0%b0%d1%81%d1%82%d1%80%d0%be%d0%b9%d0%ba%d0%b8">Основные настройки</a>
</h3><ul>
<li><code>clock timezone UTC 3</code> и <code>clock update-calendar</code> - установить часовой пояс <code>+3</code> и обновить встроенные часы Cisco согласно пользовательским настройкам.</li>
<li><code>hostname gw1</code> - установить имя хоста в Cisco.</li>
<li><code>logging buffered 4096</code> - зарезервировать в оперативной памяти 4096 КБ для записи логов. При заполнении буфера, старые сообщения будут перезаписаны новыми.</li>
<li><code>logging console critical</code> - включить отображение в консоли (RS-232) только критических сообщений.</li>
<li><code>ip cef</code> - включить Cisco Express Forwarding (CEF). Cisco Express Forwarding (CEF) - технология высокоскоростной маршрутизации/коммутации пакетов, использующаяся в маршрутизаторах и коммутаторах третьего уровня фирмы Cisco Systems, и позволяющая добиться более быстрой и эффективной обработки транзитного трафика.</li>
<li><code>ip multicast-routing</code> - включить пересылку multicast-пакетов.</li>
<li><code>ip tcp path-mtu-discovery</code> - включить функцию обнаружения пути TCP MTU для соединений TCP, инициированных маршрутизаторами (например, BGP и Telnet).</li>
<li><code>ip tcp selective-ack</code> - повысить производительность TCP на каналах, где есть потери пакетов. Если в пределах окна было потеряно несколько пакетов, SACK позволяет повторно отправить только потерянные пакеты, а не все пакеты. <a title="" href="http://www.ietf.org/rfc/rfc2018.txt" target="_blank"
   rel="noopener noreferrer">RFC2018</a>.</li>
<li><code>ip tcp timestamp</code> - включить более точное измерение RTT для повышения производительности TCP. <a title="" href="http://www.ietf.org/rfc/rfc1323.txt" target="_blank"
   rel="noopener noreferrer">RFC1323</a>.</li>
<li><code>no ip source-route</code> - отключить функцию указания отдельными пакетами маршрута. В современных сетях эта функция не используется и является небезопасной.</li>
<li><code>no ip bootp server</code> - отключить Bootstrap Protocol (BOOTP). BootP это сетевой протокол прикладного уровня, используемый для автоматического получения клиентом IP-адреса.</li>
<li><code>memory reserve critical 4096</code> - зарезервировать в оперативной памяти 4096 КБ для отображения критических уведомлений. Этот объём памяти не может превышать 25% от общего объёма оперативной памяти. По умолчанию: 100 КБ.</li>
<li><code>memory reserve console 512</code> - зарезервировать в оперативной памяти 512 КБ для доступа к консоли. Увеличение памяти обеспечивает доступ к консоли для устранения неполадок или других административных задач и поддерживает оптимальный уровень производительности. По умолчанию: 256 КБ.</li>
</ul>
<h3 id="аккаунты">
  <a class="link-body-emphasis" href="#%d0%b0%d0%ba%d0%ba%d0%b0%d1%83%d0%bd%d1%82%d1%8b">Аккаунты</a>
</h3><ul>
<li><code>aaa new-model</code> - включение новой модели системы аутентификации авторизации и учета событий, встроенная в операционную систему <span class="shortcode shortcode-tag"><a href="/ru/tags/cisco/" target="_blank">#Cisco</a></span> IOS.</li>
<li><code>aaa authentication login default local</code> - база логинов и паролей хранится на устройстве <span class="shortcode shortcode-tag"><a href="/ru/tags/cisco/" target="_blank">#Cisco</a></span>.</li>
<li><code>aaa authentication ppp default local</code> - локальная аутентификация для сеансов PPP.</li>
<li><code>enable password qwerty-en</code> - пароль для режима <code>enable</code>.</li>
<li><code>username admin privilege 15 password qwerty-admin</code> - добавление нового пользователя <code>admin</code>.
<ul>
<li><code>admin</code> - имя нового пользователя.</li>
<li><code>privilege 15</code> - уровень привилегий (15 - максимальный).</li>
<li><code>qwerty-admin</code> - пароль нового пользователя.</li>
</ul>
</li>
</ul>
<h3 id="терминал">
  <a class="link-body-emphasis" href="#%d1%82%d0%b5%d1%80%d0%bc%d0%b8%d0%bd%d0%b0%d0%bb">Терминал</a>
</h3><ul>
<li><code>line con 0</code>
<ul>
<li><code>logging synchronous</code></li>
<li><code>exec-timeout 60 0</code></li>
</ul>
</li>
<li><code>line vty 0 4</code>
<ul>
<li><code>access-class ACL_VTY in</code></li>
<li><code>logging synchronous</code></li>
<li><code>privilege level 15</code></li>
<li><code>transport input telnet ssh</code></li>
<li><code>exec-timeout 60 0</code></li>
</ul>
</li>
<li><code>line aux 0</code>
<ul>
<li><code>transport input none</code></li>
<li><code>transport output none</code></li>
<li><code>no exec</code></li>
<li><code>exec-timeout 0 1</code></li>
<li><code>no password</code></li>
</ul>
</li>
</ul>
<h3 id="ssh">
  <a class="link-body-emphasis" href="#ssh">SSH</a>
</h3><ul>
<li><code>ip ssh authentication-retries 5</code> - установить 5 попыток аутентификации на локальном SSH-сервере Cisco.</li>
<li><code>ip ssh version 2</code> - явно указать использование SSH версии 2.</li>
</ul>
<h3 id="snmp">
  <a class="link-body-emphasis" href="#snmp">SNMP</a>
</h3><ul>
<li><code>snmp-server community CISCO_ID ro ACL_SNMP_RO</code> - разрешить хостам из <code>ACL_SNMP_RO</code> получать информацию от SNMP-сервера Cisco с идентификатором <code>CISCO_ID</code>.
<ul>
<li><code>CISCO_ID</code> - идентификатор SNMP Cisco.</li>
<li><code>ro</code> - доступ только на чтение.</li>
<li><code>ACL_SNMP_RO</code> - лист доступа для подключения к SNMP Cisco.</li>
</ul>
</li>
<li><code>snmp-server location Petrovka 37, 2 floor, room 220</code> - указать информацию по местонахождению устройства в SNMP-сервере Cisco.
<ul>
<li><code>Petrovka 37, 2 floor, room 220</code> - адрес устройства Cisco.</li>
</ul>
</li>
<li><code>snmp-server contact mail@example.com</code> - указать контактную информацию в SNMP-сервере Cisco.
<ul>
<li><code>mail@example.com</code> - контактный адрес электронной почты.</li>
</ul>
</li>
</ul>
<h3 id="интерфейсы">
  <a class="link-body-emphasis" href="#%d0%b8%d0%bd%d1%82%d0%b5%d1%80%d1%84%d0%b5%d0%b9%d1%81%d1%8b">Интерфейсы</a>
</h3><ul>
<li><code>interface FastEthernet0/0</code> - внешний интерфейс <code>FastEthernet0/0</code>.
<ul>
<li><code>ip address dhcp</code> - включение получения IP-адреса от DHCP-сервера.</li>
<li><code>ip nat outside</code> - определение интерфейса в качестве внешнего.</li>
</ul>
</li>
<li><code>interface FastEthernet0/1</code> - внутренний интерфейс <code>FastEthernet0/1</code>.
<ul>
<li><code>ip address 10.88.0.1 255.255.0.0</code> - IP-адрес интерфейса и маска подсети.</li>
<li><code>ip nat inside</code> - определение интерфейса в качестве внутреннего.</li>
</ul>
</li>
<li><code>interface Loopback0</code> - loopback-интерфейс <code>Loopback0</code>.
<ul>
<li><code>ip address 10.90.10.1 255.255.255.255</code> - IP-адрес интерфейса и маска подсети.</li>
</ul>
</li>
<li><code>interface Loopback1</code> - loopback-интерфейс <code>Loopback1</code>.
<ul>
<li><code>ip address 10.90.20.1 255.255.255.255</code> - IP-адрес интерфейса и маска подсети.</li>
</ul>
</li>
<li><code>no ip http server</code> - отключить встроенный HTTP-сервер.</li>
<li><code>no ip http secure-server</code> - отключить встроенный HTTPS-сервер.</li>
</ul>
<h3 id="ntp">
  <a class="link-body-emphasis" href="#ntp">NTP</a>
</h3><ul>
<li><code>ntp update-calendar</code> - обновить встроенные часы Cisco согласно настройкам NTP.</li>
<li><code>ntp server 194.190.168.1</code> - сервер NTP.
<ul>
<li><code>194.190.168.1</code> - IP-адрес сервера NTP.</li>
</ul>
</li>
</ul>
<h3 id="dns">
  <a class="link-body-emphasis" href="#dns">DNS</a>
</h3><ul>
<li><code>ip domain timeout 2</code> - число попыток отрезолвить хост.</li>
<li><code>ip domain name home.lan</code> - имя домена по умолчанию. Используется для определения имени домена, которое будет использоваться для дополнения неполных имен хостов (имен, состоящих только из имени хоста).</li>
<li><code>ip name-server 1.1.1.1</code> - внешний DNS-сервер #1.
<ul>
<li><code>1.1.1.1</code> - IP-адрес внешнего DNS-сервера #1.</li>
</ul>
</li>
<li><code>ip name-server 8.8.8.8</code> - внешний DNS-сервер #1.
<ul>
<li><code>8.8.8.8</code> - IP-адрес внешнего DNS-сервера #2.</li>
</ul>
</li>
<li><code>ip dns server</code> - включить локальный DNS-сервер Cisco.</li>
</ul>
<h3 id="dhcp">
  <a class="link-body-emphasis" href="#dhcp">DHCP</a>
</h3><ul>
<li><code>service dhcp FastEthernet0/1</code> - включить локальный DHCP-сервер только на интерфейсе <code>FastEthernet0/1</code>.</li>
<li><code>ip dhcp excluded-address 10.88.0.1</code> - исключить адрес <code>10.88.0.1</code> из пула адресов локального DHCP-сервера.</li>
<li><code>ip dhcp excluded-address 10.88.0.2 10.88.200.0</code> - исключить диапазон от <code>10.88.0.2</code> до <code>10.88.200.0</code> из пула адресов локального DHCP-сервера.</li>
<li><code>ip dhcp pool LAN</code> - конфигурация локального DHCP-сервера.
<ul>
<li><code>network 10.88.0.0 255.255.0.0</code> - адрес локальной сети.</li>
<li><code>default-router 10.88.0.1</code> - шлюз по умолчанию.</li>
<li><code>domain-name home.lan</code> - домен локальной сети.</li>
<li><code>dns-server 10.88.0.1</code> - DNS-сервер локальной сети.</li>
</ul>
</li>
</ul>
<h3 id="nat">
  <a class="link-body-emphasis" href="#nat">NAT</a>
</h3><ul>
<li><code>ip nat inside source route-map MAP_ETH_00 interface FastEthernet0/0 overload</code></li>
</ul>
<h3 id="листы-доступа">
  <a class="link-body-emphasis" href="#%d0%bb%d0%b8%d1%81%d1%82%d1%8b-%d0%b4%d0%be%d1%81%d1%82%d1%83%d0%bf%d0%b0">Листы доступа</a>
</h3><ul>
<li><code>ip access-list standard ACL_VTY</code> - список хостов для доступа к терминалу.</li>
<li><code>ip access-list standard ACL_NAT</code> - список хостов за NAT. Разрешить эти адреса из локальной сети транслировать во внешний мир.</li>
</ul>
<h2 id="скрипт-конфигурации">
  <a class="link-body-emphasis" href="#%d1%81%d0%ba%d1%80%d0%b8%d0%bf%d1%82-%d0%ba%d0%be%d0%bd%d1%84%d0%b8%d0%b3%d1%83%d1%80%d0%b0%d1%86%d0%b8%d0%b8">Скрипт конфигурации</a>
</h2>
    

    
        
            
            <div class="shortcode shortcode-file mb-3">
              <div class="card overflow-hidden" data-bs-theme="dark">
                <div class="card-header">
                  <div class="d-flex align-items-center">
                    <div class="flex-shrink-0">
                      <i class="far fa-file-code fa-fw"></i>
                    </div>
                    <div class="flex-grow-1 mx-2 text-truncate">
                      <code>cisco.router.ios</code>
                    </div>
                    <div class="flex-shrink-0">
                      <ul class="list-inline mb-0">
                        <li class="list-inline-item" title='Копировать'>
                          <a class="text-body" href="#"
                             data-fn="clipboard" data-clipboard-target="#cp-386eea5c5498ce901f561cdf302acda3"
                             role="button" aria-label='Копировать'>
                            <i class="fas fa-copy fa-fw"></i>
                          </a>
                        </li>
                        <li class="list-inline-item" title='Скачать'>
                          <a class="text-body" href="/ru/2024/04/8caf49e3-8f13-5145-90ab-8ba1f2cb1c37/cisco.router.ios" download
                             role="button" aria-label='Скачать'>
                            <i class="fas fa-download fa-fw"></i>
                          </a>
                        </li>
                        <li class="list-inline-item" title='Открыть'>
                          <a class="text-body" href="/ru/2024/04/8caf49e3-8f13-5145-90ab-8ba1f2cb1c37/cisco.router.ios" target="_blank"
                             role="button" aria-label='Открыть'>
                            <i class="fas fa-arrow-up-right-from-square fa-fw"></i>
                          </a>
                        </li>
                      </ul>
                    </div>
                  </div>
                </div>
                <div class="card-body p-0 overflow-auto" id="cp-386eea5c5498ce901f561cdf302acda3">
                    
                    <div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">  1
</span><span class="lnt">  2
</span><span class="lnt">  3
</span><span class="lnt">  4
</span><span class="lnt">  5
</span><span class="lnt">  6
</span><span class="lnt">  7
</span><span class="lnt">  8
</span><span class="lnt">  9
</span><span class="lnt"> 10
</span><span class="lnt"> 11
</span><span class="lnt"> 12
</span><span class="lnt"> 13
</span><span class="lnt"> 14
</span><span class="lnt"> 15
</span><span class="lnt"> 16
</span><span class="lnt"> 17
</span><span class="lnt"> 18
</span><span class="lnt"> 19
</span><span class="lnt"> 20
</span><span class="lnt"> 21
</span><span class="lnt"> 22
</span><span class="lnt"> 23
</span><span class="lnt"> 24
</span><span class="lnt"> 25
</span><span class="lnt"> 26
</span><span class="lnt"> 27
</span><span class="lnt"> 28
</span><span class="lnt"> 29
</span><span class="lnt"> 30
</span><span class="lnt"> 31
</span><span class="lnt"> 32
</span><span class="lnt"> 33
</span><span class="lnt"> 34
</span><span class="lnt"> 35
</span><span class="lnt"> 36
</span><span class="lnt"> 37
</span><span class="lnt"> 38
</span><span class="lnt"> 39
</span><span class="lnt"> 40
</span><span class="lnt"> 41
</span><span class="lnt"> 42
</span><span class="lnt"> 43
</span><span class="lnt"> 44
</span><span class="lnt"> 45
</span><span class="lnt"> 46
</span><span class="lnt"> 47
</span><span class="lnt"> 48
</span><span class="lnt"> 49
</span><span class="lnt"> 50
</span><span class="lnt"> 51
</span><span class="lnt"> 52
</span><span class="lnt"> 53
</span><span class="lnt"> 54
</span><span class="lnt"> 55
</span><span class="lnt"> 56
</span><span class="lnt"> 57
</span><span class="lnt"> 58
</span><span class="lnt"> 59
</span><span class="lnt"> 60
</span><span class="lnt"> 61
</span><span class="lnt"> 62
</span><span class="lnt"> 63
</span><span class="lnt"> 64
</span><span class="lnt"> 65
</span><span class="lnt"> 66
</span><span class="lnt"> 67
</span><span class="lnt"> 68
</span><span class="lnt"> 69
</span><span class="lnt"> 70
</span><span class="lnt"> 71
</span><span class="lnt"> 72
</span><span class="lnt"> 73
</span><span class="lnt"> 74
</span><span class="lnt"> 75
</span><span class="lnt"> 76
</span><span class="lnt"> 77
</span><span class="lnt"> 78
</span><span class="lnt"> 79
</span><span class="lnt"> 80
</span><span class="lnt"> 81
</span><span class="lnt"> 82
</span><span class="lnt"> 83
</span><span class="lnt"> 84
</span><span class="lnt"> 85
</span><span class="lnt"> 86
</span><span class="lnt"> 87
</span><span class="lnt"> 88
</span><span class="lnt"> 89
</span><span class="lnt"> 90
</span><span class="lnt"> 91
</span><span class="lnt"> 92
</span><span class="lnt"> 93
</span><span class="lnt"> 94
</span><span class="lnt"> 95
</span><span class="lnt"> 96
</span><span class="lnt"> 97
</span><span class="lnt"> 98
</span><span class="lnt"> 99
</span><span class="lnt">100
</span><span class="lnt">101
</span><span class="lnt">102
</span><span class="lnt">103
</span><span class="lnt">104
</span><span class="lnt">105
</span><span class="lnt">106
</span><span class="lnt">107
</span><span class="lnt">108
</span><span class="lnt">109
</span><span class="lnt">110
</span><span class="lnt">111
</span><span class="lnt">112
</span><span class="lnt">113
</span><span class="lnt">114
</span><span class="lnt">115
</span><span class="lnt">116
</span><span class="lnt">117
</span><span class="lnt">118
</span><span class="lnt">119
</span><span class="lnt">120
</span><span class="lnt">121
</span><span class="lnt">122
</span><span class="lnt">123
</span><span class="lnt">124
</span><span class="lnt">125
</span><span class="lnt">126
</span><span class="lnt">127
</span><span class="lnt">128
</span><span class="lnt">129
</span><span class="lnt">130
</span><span class="lnt">131
</span><span class="lnt">132
</span><span class="lnt">133
</span><span class="lnt">134
</span><span class="lnt">135
</span><span class="lnt">136
</span><span class="lnt">137
</span><span class="lnt">138
</span><span class="lnt">139
</span><span class="lnt">140
</span><span class="lnt">141
</span><span class="lnt">142
</span><span class="lnt">143
</span><span class="lnt">144
</span><span class="lnt">145
</span><span class="lnt">146
</span><span class="lnt">147
</span><span class="lnt">148
</span><span class="lnt">149
</span><span class="lnt">150
</span><span class="lnt">151
</span><span class="lnt">152
</span><span class="lnt">153
</span><span class="lnt">154
</span><span class="lnt">155
</span><span class="lnt">156
</span><span class="lnt">157
</span><span class="lnt">158
</span><span class="lnt">159
</span><span class="lnt">160
</span><span class="lnt">161
</span><span class="lnt">162
</span><span class="lnt">163
</span><span class="lnt">164
</span><span class="lnt">165
</span><span class="lnt">166
</span><span class="lnt">167
</span><span class="lnt">168
</span><span class="lnt">169
</span><span class="lnt">170
</span><span class="lnt">171
</span><span class="lnt">172
</span><span class="lnt">173
</span><span class="lnt">174
</span><span class="lnt">175
</span><span class="lnt">176
</span><span class="lnt">177
</span><span class="lnt">178
</span><span class="lnt">179
</span><span class="lnt">180
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-properties" data-lang="properties"><span class="line"><span class="cl"><span class="c1">! @package    Cisco / IOS</span>
</span></span><span class="line"><span class="cl"><span class="c1">! @author     Kai Kimera &lt;mail@kai.kim&gt;</span>
</span></span><span class="line"><span class="cl"><span class="c1">! @copyright  2024 Library Online</span>
</span></span><span class="line"><span class="cl"><span class="c1">! @license    MIT</span>
</span></span><span class="line"><span class="cl"><span class="c1">! @version    0.1.0</span>
</span></span><span class="line"><span class="cl"><span class="c1">! @link       https://lib.onl/ru/2024/04/8caf49e3-8f13-5145-90ab-8ba1f2cb1c37/</span>
</span></span><span class="line"><span class="cl"><span class="c1">! -------------------------------------------------------------------------------------------------------------------- !</span>
</span></span><span class="line"><span class="cl"><span class="c1">!</span>
</span></span><span class="line"><span class="cl"><span class="c1">! -------------------------------------------------------------------------------------------------------------------- !</span>
</span></span><span class="line"><span class="cl"><span class="c1">! SERVICES.</span>
</span></span><span class="line"><span class="cl"><span class="c1">! -------------------------------------------------------------------------------------------------------------------- !</span>
</span></span><span class="line"><span class="cl"><span class="na">service</span> <span class="s">password-encryption</span>
</span></span><span class="line"><span class="cl"><span class="na">service</span> <span class="s">timestamps debug datetime msec localtime show-timezone</span>
</span></span><span class="line"><span class="cl"><span class="na">service</span> <span class="s">timestamps log datetime msec localtime show-timezone</span>
</span></span><span class="line"><span class="cl"><span class="na">service</span> <span class="s">tcp-keepalives-in</span>
</span></span><span class="line"><span class="cl"><span class="na">service</span> <span class="s">tcp-keepalives-out</span>
</span></span><span class="line"><span class="cl"><span class="na">service</span> <span class="s">sequence-numbers</span>
</span></span><span class="line"><span class="cl"><span class="na">no</span> <span class="s">service pad</span>
</span></span><span class="line"><span class="cl"><span class="na">no</span> <span class="s">service udp-small-servers</span>
</span></span><span class="line"><span class="cl"><span class="na">no</span> <span class="s">service tcp-small-servers</span>
</span></span><span class="line"><span class="cl"><span class="na">no</span> <span class="s">service finger</span>
</span></span><span class="line"><span class="cl"><span class="c1">! -------------------------------------------------------------------------------------------------------------------- !</span>
</span></span><span class="line"><span class="cl"><span class="c1">! GENERAL.</span>
</span></span><span class="line"><span class="cl"><span class="c1">! -------------------------------------------------------------------------------------------------------------------- !</span>
</span></span><span class="line"><span class="cl"><span class="na">clock</span> <span class="s">timezone UTC 3</span>
</span></span><span class="line"><span class="cl"><span class="c1">!clock update-calendar</span>
</span></span><span class="line"><span class="cl"><span class="na">hostname</span> <span class="s">gw1</span>
</span></span><span class="line"><span class="cl"><span class="na">logging</span> <span class="s">buffered 4096</span>
</span></span><span class="line"><span class="cl"><span class="na">logging</span> <span class="s">console critical</span>
</span></span><span class="line"><span class="cl"><span class="na">ip</span> <span class="s">cef</span>
</span></span><span class="line"><span class="cl"><span class="na">ip</span> <span class="s">multicast-routing</span>
</span></span><span class="line"><span class="cl"><span class="na">ip</span> <span class="s">tcp path-mtu-discovery</span>
</span></span><span class="line"><span class="cl"><span class="na">ip</span> <span class="s">tcp selective-ack</span>
</span></span><span class="line"><span class="cl"><span class="na">ip</span> <span class="s">tcp timestamp</span>
</span></span><span class="line"><span class="cl"><span class="na">no</span> <span class="s">ip source-route</span>
</span></span><span class="line"><span class="cl"><span class="na">no</span> <span class="s">ip bootp server</span>
</span></span><span class="line"><span class="cl"><span class="na">memory</span> <span class="s">reserve critical 4096</span>
</span></span><span class="line"><span class="cl"><span class="c1">!memory reserve console 512</span>
</span></span><span class="line"><span class="cl"><span class="c1">! -------------------------------------------------------------------------------------------------------------------- !</span>
</span></span><span class="line"><span class="cl"><span class="c1">! Authentication, Authorization, and Accounting (AAA).</span>
</span></span><span class="line"><span class="cl"><span class="c1">! -------------------------------------------------------------------------------------------------------------------- !</span>
</span></span><span class="line"><span class="cl"><span class="na">aaa</span> <span class="s">new-model</span>
</span></span><span class="line"><span class="cl"><span class="na">aaa</span> <span class="s">authentication login default local</span>
</span></span><span class="line"><span class="cl"><span class="na">aaa</span> <span class="s">authentication ppp default local</span>
</span></span><span class="line"><span class="cl"><span class="na">enable</span> <span class="s">password qwerty-en</span>
</span></span><span class="line"><span class="cl"><span class="na">username</span> <span class="s">admin privilege 15 password qwerty-admin</span>
</span></span><span class="line"><span class="cl"><span class="c1">! -------------------------------------------------------------------------------------------------------------------- !</span>
</span></span><span class="line"><span class="cl"><span class="c1">! LOGIN.</span>
</span></span><span class="line"><span class="cl"><span class="c1">! -------------------------------------------------------------------------------------------------------------------- !</span>
</span></span><span class="line"><span class="cl"><span class="c1">!login block-for 60 attempts 3 within 10</span>
</span></span><span class="line"><span class="cl"><span class="c1">!login delay 5</span>
</span></span><span class="line"><span class="cl"><span class="c1">!login quiet-mode access-class 10</span>
</span></span><span class="line"><span class="cl"><span class="c1">!login on-failure log every 5</span>
</span></span><span class="line"><span class="cl"><span class="c1">!login on-success log every 3</span>
</span></span><span class="line"><span class="cl"><span class="c1">! -------------------------------------------------------------------------------------------------------------------- !</span>
</span></span><span class="line"><span class="cl"><span class="c1">! TERMINAL.</span>
</span></span><span class="line"><span class="cl"><span class="c1">! -------------------------------------------------------------------------------------------------------------------- !</span>
</span></span><span class="line"><span class="cl"><span class="na">line</span> <span class="s">con 0</span>
</span></span><span class="line"><span class="cl">  <span class="na">logging</span> <span class="s">synchronous</span>
</span></span><span class="line"><span class="cl">  <span class="na">exec-timeout</span> <span class="s">60 0</span>
</span></span><span class="line"><span class="cl"><span class="na">line</span> <span class="s">vty 0 4</span>
</span></span><span class="line"><span class="cl">  <span class="na">access-class</span> <span class="s">ACL_VTY in</span>
</span></span><span class="line"><span class="cl">  <span class="na">logging</span> <span class="s">synchronous</span>
</span></span><span class="line"><span class="cl">  <span class="na">privilege</span> <span class="s">level 15</span>
</span></span><span class="line"><span class="cl">  <span class="na">transport</span> <span class="s">input telnet ssh</span>
</span></span><span class="line"><span class="cl">  <span class="na">exec-timeout</span> <span class="s">60 0</span>
</span></span><span class="line"><span class="cl"><span class="na">line</span> <span class="s">aux 0</span>
</span></span><span class="line"><span class="cl">  <span class="na">transport</span> <span class="s">input none</span>
</span></span><span class="line"><span class="cl">  <span class="na">transport</span> <span class="s">output none</span>
</span></span><span class="line"><span class="cl">  <span class="na">no</span> <span class="s">exec</span>
</span></span><span class="line"><span class="cl">  <span class="na">exec-timeout</span> <span class="s">0 1</span>
</span></span><span class="line"><span class="cl">  <span class="na">no</span> <span class="s">password</span>
</span></span><span class="line"><span class="cl"><span class="c1">! -------------------------------------------------------------------------------------------------------------------- !</span>
</span></span><span class="line"><span class="cl"><span class="c1">! SSH.</span>
</span></span><span class="line"><span class="cl"><span class="c1">! Generate RSA key pairs for SSH Public-Key Authentication:</span>
</span></span><span class="line"><span class="cl"><span class="c1">! - crypto key generate rsa modulus 2048</span>
</span></span><span class="line"><span class="cl"><span class="c1">! -------------------------------------------------------------------------------------------------------------------- !</span>
</span></span><span class="line"><span class="cl"><span class="na">ip</span> <span class="s">ssh authentication-retries 5</span>
</span></span><span class="line"><span class="cl"><span class="na">ip</span> <span class="s">ssh version 2</span>
</span></span><span class="line"><span class="cl"><span class="c1">! -------------------------------------------------------------------------------------------------------------------- !</span>
</span></span><span class="line"><span class="cl"><span class="c1">! SNMP server.</span>
</span></span><span class="line"><span class="cl"><span class="c1">! -------------------------------------------------------------------------------------------------------------------- !</span>
</span></span><span class="line"><span class="cl"><span class="na">snmp-server</span> <span class="s">community CISCO_ID ro ACL_SNMP_RO</span>
</span></span><span class="line"><span class="cl"><span class="na">snmp-server</span> <span class="s">location Petrovka 37, 2 floor, room 220</span>
</span></span><span class="line"><span class="cl"><span class="na">snmp-server</span> <span class="s">contact mail@example.com</span>
</span></span><span class="line"><span class="cl"><span class="c1">!</span>
</span></span><span class="line"><span class="cl"><span class="na">ip</span> <span class="s">access-list standard ACL_SNMP_RO</span>
</span></span><span class="line"><span class="cl">  <span class="na">remark</span> <span class="s">Hosts permitted to read SNMP MIBs.</span>
</span></span><span class="line"><span class="cl">  <span class="na">permit</span> <span class="s">host 10.88.10.22</span>
</span></span><span class="line"><span class="cl"><span class="c1">! -------------------------------------------------------------------------------------------------------------------- !</span>
</span></span><span class="line"><span class="cl"><span class="c1">! INTERFACES.</span>
</span></span><span class="line"><span class="cl"><span class="c1">! -------------------------------------------------------------------------------------------------------------------- !</span>
</span></span><span class="line"><span class="cl"><span class="na">interface</span> <span class="s">FastEthernet0/0</span>
</span></span><span class="line"><span class="cl">  <span class="na">ip</span> <span class="s">address dhcp</span>
</span></span><span class="line"><span class="cl">  <span class="na">ip</span> <span class="s">nat outside</span>
</span></span><span class="line"><span class="cl"><span class="na">interface</span> <span class="s">FastEthernet0/1</span>
</span></span><span class="line"><span class="cl">  <span class="na">ip</span> <span class="s">address 10.88.0.1 255.255.0.0</span>
</span></span><span class="line"><span class="cl">  <span class="na">ip</span> <span class="s">nat inside</span>
</span></span><span class="line"><span class="cl"><span class="na">interface</span> <span class="s">Loopback0</span>
</span></span><span class="line"><span class="cl">  <span class="na">ip</span> <span class="s">address 10.90.10.1 255.255.255.255</span>
</span></span><span class="line"><span class="cl"><span class="na">interface</span> <span class="s">Loopback1</span>
</span></span><span class="line"><span class="cl">  <span class="na">ip</span> <span class="s">address 10.90.20.1 255.255.255.255</span>
</span></span><span class="line"><span class="cl"><span class="na">no</span> <span class="s">ip http server</span>
</span></span><span class="line"><span class="cl"><span class="na">no</span> <span class="s">ip http secure-server</span>
</span></span><span class="line"><span class="cl"><span class="c1">! -------------------------------------------------------------------------------------------------------------------- !</span>
</span></span><span class="line"><span class="cl"><span class="c1">! NTP.</span>
</span></span><span class="line"><span class="cl"><span class="c1">! -------------------------------------------------------------------------------------------------------------------- !</span>
</span></span><span class="line"><span class="cl"><span class="na">ntp</span> <span class="s">update-calendar</span>
</span></span><span class="line"><span class="cl"><span class="na">ntp</span> <span class="s">server 194.190.168.1</span>
</span></span><span class="line"><span class="cl"><span class="c1">! -------------------------------------------------------------------------------------------------------------------- !</span>
</span></span><span class="line"><span class="cl"><span class="c1">! DNS.</span>
</span></span><span class="line"><span class="cl"><span class="c1">! -------------------------------------------------------------------------------------------------------------------- !</span>
</span></span><span class="line"><span class="cl"><span class="na">ip</span> <span class="s">domain timeout 2</span>
</span></span><span class="line"><span class="cl"><span class="na">ip</span> <span class="s">domain name home.lan</span>
</span></span><span class="line"><span class="cl"><span class="na">ip</span> <span class="s">name-server 1.1.1.1</span>
</span></span><span class="line"><span class="cl"><span class="na">ip</span> <span class="s">name-server 8.8.8.8</span>
</span></span><span class="line"><span class="cl"><span class="na">ip</span> <span class="s">dns server</span>
</span></span><span class="line"><span class="cl"><span class="c1">! -------------------------------------------------------------------------------------------------------------------- !</span>
</span></span><span class="line"><span class="cl"><span class="c1">! DHCP.</span>
</span></span><span class="line"><span class="cl"><span class="c1">! -------------------------------------------------------------------------------------------------------------------- !</span>
</span></span><span class="line"><span class="cl"><span class="na">service</span> <span class="s">dhcp FastEthernet0/1</span>
</span></span><span class="line"><span class="cl"><span class="na">ip</span> <span class="s">dhcp excluded-address 10.88.0.1</span>
</span></span><span class="line"><span class="cl"><span class="na">ip</span> <span class="s">dhcp excluded-address 10.88.0.2 10.88.200.0</span>
</span></span><span class="line"><span class="cl"><span class="na">ip</span> <span class="s">dhcp pool LAN</span>
</span></span><span class="line"><span class="cl">  <span class="na">network</span> <span class="s">10.88.0.0 255.255.0.0</span>
</span></span><span class="line"><span class="cl">  <span class="na">default-router</span> <span class="s">10.88.0.1</span>
</span></span><span class="line"><span class="cl">  <span class="na">domain-name</span> <span class="s">home.lan</span>
</span></span><span class="line"><span class="cl">  <span class="na">dns-server</span> <span class="s">10.88.0.1</span>
</span></span><span class="line"><span class="cl"><span class="c1">! -------------------------------------------------------------------------------------------------------------------- !</span>
</span></span><span class="line"><span class="cl"><span class="c1">! NAT.</span>
</span></span><span class="line"><span class="cl"><span class="c1">! -------------------------------------------------------------------------------------------------------------------- !</span>
</span></span><span class="line"><span class="cl"><span class="na">ip</span> <span class="s">nat inside source route-map RM_NAT_ISP0 interface FastEthernet0/0 overload</span>
</span></span><span class="line"><span class="cl"><span class="c1">!ip nat inside source route-map RM_NAT_ISP1 interface FastEthernet0/1 overload</span>
</span></span><span class="line"><span class="cl"><span class="c1">! -------------------------------------------------------------------------------------------------------------------- !</span>
</span></span><span class="line"><span class="cl"><span class="c1">! ACL.</span>
</span></span><span class="line"><span class="cl"><span class="c1">! -------------------------------------------------------------------------------------------------------------------- !</span>
</span></span><span class="line"><span class="cl"><span class="na">ip</span> <span class="s">access-list standard ACL_VTY</span>
</span></span><span class="line"><span class="cl">  <span class="na">remark</span> <span class="s">Hosts permitted to VTY.</span>
</span></span><span class="line"><span class="cl">  <span class="na">permit</span> <span class="s">10.0.0.0 0.255.255.255</span>
</span></span><span class="line"><span class="cl">  <span class="na">permit</span> <span class="s">172.16.0.0 0.15.255.255</span>
</span></span><span class="line"><span class="cl">  <span class="na">permit</span> <span class="s">192.168.0.0 0.0.255.255</span>
</span></span><span class="line"><span class="cl"><span class="na">ip</span> <span class="s">access-list standard ACL_NAT</span>
</span></span><span class="line"><span class="cl">  <span class="na">remark</span> <span class="s">Hosts permitted to NAT.</span>
</span></span><span class="line"><span class="cl">  <span class="na">permit</span> <span class="s">10.88.0.0 0.0.255.255</span>
</span></span><span class="line"><span class="cl"><span class="c1">! -------------------------------------------------------------------------------------------------------------------- !</span>
</span></span><span class="line"><span class="cl"><span class="c1">! ROUTE MAPS.</span>
</span></span><span class="line"><span class="cl"><span class="c1">! -------------------------------------------------------------------------------------------------------------------- !</span>
</span></span><span class="line"><span class="cl"><span class="c1">! Internet Service Provider #0.</span>
</span></span><span class="line"><span class="cl"><span class="na">route-map</span> <span class="s">RM_NAT_ISP0 permit 10</span>
</span></span><span class="line"><span class="cl">  <span class="na">match</span> <span class="s">ip address ACL_NAT</span>
</span></span><span class="line"><span class="cl">  <span class="na">match</span> <span class="s">interface FastEthernet0/0</span>
</span></span><span class="line"><span class="cl"><span class="c1">! Internet Service Provider #1.</span>
</span></span><span class="line"><span class="cl"><span class="c1">!route-map RM_NAT_ISP1 permit 20</span>
</span></span><span class="line"><span class="cl"><span class="c1">!  match ip address ACL_NAT</span>
</span></span><span class="line"><span class="cl"><span class="c1">!  match interface FastEthernet0/1</span>
</span></span><span class="line"><span class="cl"><span class="c1">! -------------------------------------------------------------------------------------------------------------------- !</span>
</span></span><span class="line"><span class="cl"><span class="c1">! SLA.</span>
</span></span><span class="line"><span class="cl"><span class="c1">! -------------------------------------------------------------------------------------------------------------------- !</span>
</span></span><span class="line"><span class="cl"><span class="na">ip</span> <span class="s">sla 100</span>
</span></span><span class="line"><span class="cl">  <span class="na">icmp-echo</span> <span class="s">8.8.8.8 source-interface FastEthernet0/0</span>
</span></span><span class="line"><span class="cl">  <span class="na">threshold</span> <span class="s">1000</span>
</span></span><span class="line"><span class="cl">  <span class="na">timeout</span> <span class="s">1000</span>
</span></span><span class="line"><span class="cl">  <span class="na">frequency</span> <span class="s">10</span>
</span></span><span class="line"><span class="cl"><span class="na">ip</span> <span class="s">sla schedule 100 life forever start-time now</span>
</span></span><span class="line"><span class="cl"><span class="na">ip</span> <span class="s">sla 101</span>
</span></span><span class="line"><span class="cl">  <span class="na">icmp-echo</span> <span class="s">77.88.8.8 source-interface FastEthernet0/0</span>
</span></span><span class="line"><span class="cl">  <span class="na">threshold</span> <span class="s">1000</span>
</span></span><span class="line"><span class="cl">  <span class="na">timeout</span> <span class="s">1000</span>
</span></span><span class="line"><span class="cl">  <span class="na">frequency</span> <span class="s">10</span>
</span></span><span class="line"><span class="cl"><span class="na">ip</span> <span class="s">sla schedule 101 life forever start-time now</span>
</span></span><span class="line"><span class="cl"><span class="c1">! -------------------------------------------------------------------------------------------------------------------- !</span>
</span></span><span class="line"><span class="cl"><span class="c1">! TRACKs.</span>
</span></span><span class="line"><span class="cl"><span class="c1">! -------------------------------------------------------------------------------------------------------------------- !</span>
</span></span><span class="line"><span class="cl"><span class="na">track</span> <span class="s">100 ip sla 100 reachability</span>
</span></span><span class="line"><span class="cl"><span class="na">track</span> <span class="s">101 ip sla 101 reachability</span>
</span></span><span class="line"><span class="cl"><span class="na">track</span> <span class="s">105 list boolean or</span>
</span></span><span class="line"><span class="cl">  <span class="na">object</span> <span class="s">100</span>
</span></span><span class="line"><span class="cl">  <span class="na">object</span> <span class="s">101</span>
</span></span><span class="line"><span class="cl"><span class="c1">!</span>
</span></span><span class="line"><span class="cl"><span class="na">end</span></span></span></code></pre></td></tr></table>
</div>
</div>
                </div>
              </div>
            </div>]]></turbo:content></item><item turbo="true"><title>Cisco: Установка лицензий</title><link>https://lib.onl/ru/2024/04/9538d25f-c145-5a84-8583-65f3a2ed4c84/</link><pubDate>Sat, 13 Apr 2024 19:45:46 +0000</pubDate><dc:creator>Kai Kimera</dc:creator><category>Сеть</category><category>Терминал</category><yandex:related><link url="https://lib.onl/ru/2024/03/b81f9cca-d723-5b72-929a-b88be9d329f9/">Cisco: Обновление IOS</link><link url="https://lib.onl/ru/2024/03/4a7addb9-eff3-5482-902c-791fbe49899f/">Cisco: Загрузка и выгрузка конфигурации</link><link url="https://lib.onl/ru/2024/03/fc67eb74-8f7c-5de3-bd1e-2d823208eae2/">Cisco: Сброс пароля</link></yandex:related><turbo:extendedHtml>true</turbo:extendedHtml><turbo:source>https://lib.onl/ru/2024/04/9538d25f-c145-5a84-8583-65f3a2ed4c84/</turbo:source><turbo:topic>Cisco: Установка лицензий</turbo:topic><turbo:content><![CDATA[<p>Рассмотрим этапы установки лицензии на оборудование <span class="shortcode shortcode-tag"><a href="/ru/tags/cisco/" target="_blank">#Cisco</a></span>, а также экспортирование уже установленных лицензий в специальный файл.</p>
<p>Лицензия привязывается к уникальному идентификатору устройства (<strong>U</strong>nique <strong>D</strong>evice <strong>I</strong>dentifier). <strong>UDI</strong> представляет собой строку, состоящую из <strong>PID</strong> (идентификатор продукта) и <strong>SN</strong> (серийный номер). Посмотреть UDI можно командой:</p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-0
shortcode-codeblock-plaintext">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-a18afda23f0ec5b0979596a997a0a7e9" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-plaintext" data-lang="plaintext"><span class="line"><span class="cl"># show license udi</span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-a18afda23f0ec5b0979596a997a0a7e9"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<h2 id="импортирование-лицензий">
  <a class="link-body-emphasis" href="#%d0%b8%d0%bc%d0%bf%d0%be%d1%80%d1%82%d0%b8%d1%80%d0%be%d0%b2%d0%b0%d0%bd%d0%b8%d0%b5-%d0%bb%d0%b8%d1%86%d0%b5%d0%bd%d0%b7%d0%b8%d0%b9">Импортирование лицензий</a>
</h2><p>Необходимо предварительно настроить сетевой интерфейс компьютера со следующими параметрами:</p>
<ul>
<li>IP-адрес: <code>192.168.1.2</code>.</li>
<li>Маска подсети: <code>255.255.255.0</code>.</li>
<li>Шлюз: <code>192.168.1.1</code>.</li>
<li>DNS: <code>8.8.8.8</code>.</li>
</ul>
<p>Теперь настроим сетевой интерфейс <code>FE0/1</code> на <span class="shortcode shortcode-tag"><a href="/ru/tags/cisco/" target="_blank">#Cisco</a></span>:</p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-1
shortcode-codeblock-plaintext">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-3faae2beb706d190d8a7397237e7760f" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-plaintext" data-lang="plaintext"><span class="line"><span class="cl"># conf t
</span></span><span class="line"><span class="cl">(config)# int fa0/1
</span></span><span class="line"><span class="cl">(config-if)# ip address 192.168.1.1 255.255.255.0
</span></span><span class="line"><span class="cl">(config-if)# no shutdown
</span></span><span class="line"><span class="cl">(config-if)# exit
</span></span><span class="line"><span class="cl">(config)# exit
</span></span><span class="line"><span class="cl">#</span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-3faae2beb706d190d8a7397237e7760f"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<p>После предварительных настроек, подключим сетевой интерфейс компьютера к сетевому интерфейсу <span class="shortcode shortcode-tag"><a href="/ru/tags/cisco/" target="_blank">#Cisco</a></span> <code>FE0/1</code> и запустим TFTP-сервер на компьютере c IP <code>192.168.1.2</code>.</p>
<h3 id="установка-лицензий">
  <a class="link-body-emphasis" href="#%d1%83%d1%81%d1%82%d0%b0%d0%bd%d0%be%d0%b2%d0%ba%d0%b0-%d0%bb%d0%b8%d1%86%d0%b5%d0%bd%d0%b7%d0%b8%d0%b9">Установка лицензий</a>
</h3><p>Загружаем файл лицензии <code>LICENSE_FILE.lic</code> на флэш-карту <span class="shortcode shortcode-tag"><a href="/ru/tags/cisco/" target="_blank">#Cisco</a></span>:</p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-2
shortcode-codeblock-plaintext">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-939f7e196d9c760e3575dd8d3baa8490" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-plaintext" data-lang="plaintext"><span class="line"><span class="cl"># copy tftp://192.168.1.2/LICENSE_FILE.lic flash:</span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-939f7e196d9c760e3575dd8d3baa8490"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<p>Импортируем файл лицензии <code>LICENSE_FILE.lic</code> с флэш-карты в память <span class="shortcode shortcode-tag"><a href="/ru/tags/cisco/" target="_blank">#Cisco</a></span>:</p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-3
shortcode-codeblock-plaintext">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-76197b7233a16f10b38e3a930389db1e" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-plaintext" data-lang="plaintext"><span class="line"><span class="cl"># license install flash:LICENSE_FILE.lic</span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-76197b7233a16f10b38e3a930389db1e"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<p>И перезапускаем оборудование:</p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-4
shortcode-codeblock-plaintext">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-0d9f2d5d2ad9a31389567bbd12ef38ed" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-plaintext" data-lang="plaintext"><span class="line"><span class="cl"># reload</span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-0d9f2d5d2ad9a31389567bbd12ef38ed"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<p>После перезапуска, <span class="shortcode shortcode-tag"><a href="/ru/tags/cisco/" target="_blank">#Cisco</a></span> включит дополнительные функции согласно установленным лицензиям.</p>
<h3 id="информация-о-лицензиях">
  <a class="link-body-emphasis" href="#%d0%b8%d0%bd%d1%84%d0%be%d1%80%d0%bc%d0%b0%d1%86%d0%b8%d1%8f-%d0%be-%d0%bb%d0%b8%d1%86%d0%b5%d0%bd%d0%b7%d0%b8%d1%8f%d1%85">Информация о лицензиях</a>
</h3><p>Посмотреть версию оборудования и установленные лицензии можно следующей командой:</p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-5
shortcode-codeblock-plaintext">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-3aacf28fc34d4f2b062cfc57023295a9" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-plaintext" data-lang="plaintext"><span class="line"><span class="cl"># show version</span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-3aacf28fc34d4f2b062cfc57023295a9"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<ul>
<li>В столбце <code>Type</code> должно быть указано <code>Permanent</code>.</li>
</ul>
<p>Более подробную информацию о лицензиях на оборудовании можно посмотреть следующей командой:</p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-6
shortcode-codeblock-plaintext">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-d17d11139e8cad42e6ab045c30d7d7d7" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-plaintext" data-lang="plaintext"><span class="line"><span class="cl"># show license</span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-d17d11139e8cad42e6ab045c30d7d7d7"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<p>При корректно установленной лицензии, в её параметрах должны быть следующие сведения:</p>
<ul>
<li>В строке <code>Period left</code> должно быть указано <code>Life time</code>.</li>
<li>в строке <code>License Type</code> должно быть указано <code>Permanent</code>.</li>
</ul>
<h2 id="экспортирование-лицензий">
  <a class="link-body-emphasis" href="#%d1%8d%d0%ba%d1%81%d0%bf%d0%be%d1%80%d1%82%d0%b8%d1%80%d0%be%d0%b2%d0%b0%d0%bd%d0%b8%d0%b5-%d0%bb%d0%b8%d1%86%d0%b5%d0%bd%d0%b7%d0%b8%d0%b9">Экспортирование лицензий</a>
</h2>



    








    
    






<div class="shortcode shortcode-alert">
  <div class="alert alert-warning d-flex overflow-hidden" role="alert">
    <div class="flex-shrink-0 align-self-center">
      <i class="fas fa-exclamation-triangle fa-fw fa-2x"></i>
    </div>
    <div class="flex-grow-1 ms-3 overflow-hidden">
        <p>Файл с лицензиями следует сохранить в надёжном месте!</p>

    </div>
  </div>
</div>

<p>Если потребуется заменить флэш-карту или сдать оборудование в ремонт, можно экспортировать существующие лицензии в файл:</p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-7
shortcode-codeblock-plaintext">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-ff365003c7f4513642f46e486ac8b545" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-plaintext" data-lang="plaintext"><span class="line"><span class="cl"># license save flash:ALL_LICENSE.lic</span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-ff365003c7f4513642f46e486ac8b545"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<p>Где:</p>
<ul>
<li><code>ALL_LICENSE.lic</code> - название создаваемого файла с лицензиями.</li>
</ul>]]></turbo:content></item><item turbo="true"><title>MikroTik: Туннель GRE/IPsec (Site-to-Site)</title><link>https://lib.onl/ru/2024/04/326618af-d950-5001-8114-57c66bb8a5af/</link><pubDate>Mon, 08 Apr 2024 10:04:21 +0000</pubDate><dc:creator>Kai Kimera</dc:creator><category>Сеть</category><category>Скрипты</category><yandex:related><link url="https://lib.onl/ru/2024/03/54a2b39f-38b4-5f0c-9b54-310f853da38f/">MikroTik: Туннель IPsec (Site-to-Site)</link><link url="https://lib.onl/ru/2024/04/146e83d5-f571-5273-9a29-172bf5dc10fe/">MikroTik: Туннель WireGuard (Site-to-Site) + OSPF</link><link url="https://lib.onl/ru/2023/10/cc13623b-970c-5950-867e-168f9ba9025a/">MikroTik: Добавление корневых сертификатов в RouterOS</link><link url="https://lib.onl/ru/2020/07/ff2ae66e-8e14-5c4a-baa6-0cd2e59f6517/">MikroTik и CloudFlare: Динамический IP для домена</link><link url="https://lib.onl/ru/2023/12/b6c7c5cd-1b0d-5fcd-8dd2-f28f87a5064c/">MikroTik: Настройка DoH</link></yandex:related><turbo:extendedHtml>true</turbo:extendedHtml><turbo:source>https://lib.onl/ru/2024/04/326618af-d950-5001-8114-57c66bb8a5af/</turbo:source><turbo:topic>MikroTik: Туннель GRE/IPsec (Site-to-Site)</turbo:topic><turbo:content><![CDATA[<p>Продолжаем серию статей по настройке туннеля между двумя маршрутизаторами. На этот раз создадим <span class="shortcode shortcode-tag"><a href="/ru/tags/gre/" target="_blank">#GRE</a></span> туннель.</p>
<p>На обоих маршрутизаторах у меня используются динамические WAN IP. <span class="shortcode shortcode-tag"><a href="/ru/tags/gre/" target="_blank">#GRE</a></span> предпочитает только статические IP-адреса. Чтобы обойти данное ограничение, я использую скрипт из статьи <span class="shortcode shortcode-uuid"><a href="/ru/2020/07/ff2ae66e-8e14-5c4a-baa6-0cd2e59f6517/">MikroTik и CloudFlare: Динамический IP для домена</a></span>, который обновляет IP-адреса маршрутизаторов в суб-доменах, далее скриптом в конце статьи я забираю актуальные IP-адреса суб-доменов и обновляю их в настройках интерфейса <span class="shortcode shortcode-tag"><a href="/ru/tags/gre/" target="_blank">#GRE</a></span>.</p>
<h2 id="вводные-данные">
  <a class="link-body-emphasis" href="#%d0%b2%d0%b2%d0%be%d0%b4%d0%bd%d1%8b%d0%b5-%d0%b4%d0%b0%d0%bd%d0%bd%d1%8b%d0%b5">Вводные данные</a>
</h2><ul>
<li>Маршрутизатор <code>R1</code>:
<ul>
<li>WAN IP: <code>gw1.example.com</code>.</li>
<li>LAN IP: <code>10.1.0.1</code>.</li>
<li>Network: <code>10.1.0.0/16</code>.</li>
</ul>
</li>
<li>Маршрутизатор <code>R2</code>:
<ul>
<li>WAN IP: <code>gw2.example.com</code>.</li>
<li>LAN IP: <code>10.2.0.1</code>.</li>
<li>Network: <code>10.2.0.0/16</code>.</li>
</ul>
</li>
</ul>
<h2 id="настройка-маршрутизаторов">
  <a class="link-body-emphasis" href="#%d0%bd%d0%b0%d1%81%d1%82%d1%80%d0%be%d0%b9%d0%ba%d0%b0-%d0%bc%d0%b0%d1%80%d1%88%d1%80%d1%83%d1%82%d0%b8%d0%b7%d0%b0%d1%82%d0%be%d1%80%d0%be%d0%b2">Настройка маршрутизаторов</a>
</h2>



    






    
    








<div class="shortcode shortcode-alert">
  <div class="alert alert-info d-flex overflow-hidden" role="alert">
    <div class="flex-shrink-0 align-self-center">
      <i class="fas fa-info fa-fw fa-2x"></i>
    </div>
    <div class="flex-grow-1 ms-3 overflow-hidden">
        <p>В моём случае, первоначальные адреса WAN IP маршрутизаторов не имею значения. Они всё равно будут обновлены скриптом на актуальные, взятые у суб-доменов.</p>

    </div>
  </div>
</div>

<h3 id="router-1">
  <a class="link-body-emphasis" href="#router-1">Router #1</a>
</h3><ul>
<li>Создаём интерфейс <span class="shortcode shortcode-tag"><a href="/ru/tags/gre/" target="_blank">#GRE</a></span>:
<ul>
<li>Имя интерфейса: <code>gre-sts</code>.</li>
<li>Секретная фраза для IPsec: <code>PassWord</code>.</li>
<li>WAN IP-адрес локального маршрутизатора <code>R1</code>: <code>1.1.1.1</code>.</li>
<li>WAN IP-адрес удалённого маршрутизатора <code>R2</code>: <code>2.2.2.2</code>.</li>
<li>Комментарий: <code>HOST: gw2.example.com</code>.</li>
</ul>
</li>
</ul>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-0
shortcode-codeblock-text">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-91ce21719a639152c15baa7622dc8104" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-text" data-lang="text"><span class="line"><span class="cl">/interface gre
</span></span><span class="line"><span class="cl">add allow-fast-path=no ipsec-secret=&#34;PassWord&#34; name=&#34;gre-sts&#34; remote-address=2.2.2.2 comment=&#34;HOST: gw2.example.com&#34;</span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-91ce21719a639152c15baa7622dc8104"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<ul>
<li>Прописываем интерфейсу IP-адрес <code>10.255.255.1/24</code>:
<ul>
<li>Адрес интерфейса: <code>10.255.255.1/24</code>.</li>
<li>Интерфейс: <code>gre-sts</code>.</li>
<li>Комментарий: <code>[GRE] GRE-STS</code>.</li>
</ul>
</li>
</ul>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-1
shortcode-codeblock-text">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-9ada56fb78a392dd3a403a389abab1ec" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-text" data-lang="text"><span class="line"><span class="cl">/ip address
</span></span><span class="line"><span class="cl">add address=10.255.255.1/24 interface=&#34;gre-sts&#34; comment=&#34;[GRE] GRE-STS&#34;</span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-9ada56fb78a392dd3a403a389abab1ec"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<ul>
<li>Указываем маршрут до удалённой сети <code>R2</code>:
<ul>
<li>Адрес удалённой сети <code>R2</code>: <code>10.2.0.0/16</code>.</li>
<li>Шлюз <code>R2</code>: <code>10.255.255.2</code>.</li>
<li>Комментарий: <code>[GRE] GW2</code>.</li>
</ul>
</li>
</ul>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-2
shortcode-codeblock-text">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-355b96feab3240029361c610e142521b" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-text" data-lang="text"><span class="line"><span class="cl">/ip route
</span></span><span class="line"><span class="cl">add distance=1 dst-address=10.2.0.0/16 gateway=10.255.255.2 comment=&#34;[GRE] GW2&#34;</span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-355b96feab3240029361c610e142521b"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<h3 id="router-2">
  <a class="link-body-emphasis" href="#router-2">Router #2</a>
</h3><ul>
<li>Создаём интерфейс <span class="shortcode shortcode-tag"><a href="/ru/tags/gre/" target="_blank">#GRE</a></span>:
<ul>
<li>Имя интерфейса: <code>gre-sts</code>.</li>
<li>Секретная фраза для IPsec: <code>PassWord</code>.</li>
<li>WAN IP-адрес локального маршрутизатора <code>R2</code>: <code>2.2.2.2</code>.</li>
<li>WAN IP-адрес удалённого маршрутизатора <code>R1</code>: <code>1.1.1.1</code>.</li>
<li>Комментарий: <code>HOST: gw1.example.com</code>.</li>
</ul>
</li>
</ul>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-3
shortcode-codeblock-text">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-9f67c24fe3ed885a38f0f952fc0f0f95" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-text" data-lang="text"><span class="line"><span class="cl">/interface gre
</span></span><span class="line"><span class="cl">add allow-fast-path=no ipsec-secret=&#34;PassWord&#34; name=&#34;gre-sts&#34; remote-address=1.1.1.1 comment=&#34;HOST: gw1.example.com&#34;</span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-9f67c24fe3ed885a38f0f952fc0f0f95"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<ul>
<li>Прописываем интерфейсу IP-адрес <code>10.255.255.2/24</code>:
<ul>
<li>Адрес интерфейса: <code>10.255.255.2/24</code>.</li>
<li>Интерфейс: <code>gre-sts</code>.</li>
<li>Комментарий: <code>[GRE] GRE-STS</code>.</li>
</ul>
</li>
</ul>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-4
shortcode-codeblock-text">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-45e421fa06e6d3f176b4c5b2a4199585" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-text" data-lang="text"><span class="line"><span class="cl">/ip address
</span></span><span class="line"><span class="cl">add address=10.255.255.2/24 interface=&#34;gre-sts&#34; comment=&#34;[GRE] GRE-STS&#34;</span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-45e421fa06e6d3f176b4c5b2a4199585"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<ul>
<li>Указываем маршрут до удалённой сети <code>R1</code>:
<ul>
<li>Адрес удалённой сети <code>R1</code>: <code>10.1.0.0/16</code>.</li>
<li>Шлюз <code>R1</code>: <code>10.255.255.1</code>.</li>
<li>Комментарий: <code>[GRE] GW1</code>.</li>
</ul>
</li>
</ul>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-5
shortcode-codeblock-text">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-7819e1a8a0d26beee1b459c89c202e5e" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-text" data-lang="text"><span class="line"><span class="cl">/ip route
</span></span><span class="line"><span class="cl">add distance=1 dst-address=10.1.0.0/16 gateway=10.255.255.1 comment=&#34;[GRE] GW1&#34;</span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-7819e1a8a0d26beee1b459c89c202e5e"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<h2 id="скрипт-для-динамического-ip">
  <a class="link-body-emphasis" href="#%d1%81%d0%ba%d1%80%d0%b8%d0%bf%d1%82-%d0%b4%d0%bb%d1%8f-%d0%b4%d0%b8%d0%bd%d0%b0%d0%bc%d0%b8%d1%87%d0%b5%d1%81%d0%ba%d0%be%d0%b3%d0%be-ip">Скрипт для динамического IP</a>
</h2><p>К сожалению, <span class="shortcode shortcode-tag"><a href="/ru/tags/mikrotik/" target="_blank">#MikroTik</a></span> для интерфейса <span class="shortcode shortcode-tag"><a href="/ru/tags/gre/" target="_blank">#GRE</a></span> использует только IP-адреса, нельзя указать имя суб-домена. Но на форуме <span class="shortcode shortcode-tag"><a href="/ru/tags/mikrotik/" target="_blank">#MikroTik</a></span> я нашёл скрипт, который парсит доменное имя удалённого маршрутизатора в специально составленном комментарии (<code>HOST: sub.example.com</code>) к интерфейсу и запрашивает IP-адрес этого домена. Этот IP-адрес автоматически вставляется в поле <code>remote-address</code> интерфейса <span class="shortcode shortcode-tag"><a href="/ru/tags/gre/" target="_blank">#GRE</a></span>.</p>
<h3 id="приложение">
  <a class="link-body-emphasis" href="#%d0%bf%d1%80%d0%b8%d0%bb%d0%be%d0%b6%d0%b5%d0%bd%d0%b8%d0%b5">Приложение</a>
</h3>
    

    
        
            
            <div class="shortcode shortcode-file mb-3">
              <div class="card overflow-hidden" data-bs-theme="dark">
                <div class="card-header">
                  <div class="d-flex align-items-center">
                    <div class="flex-shrink-0">
                      <i class="far fa-file-code fa-fw"></i>
                    </div>
                    <div class="flex-grow-1 mx-2 text-truncate">
                      <code>ros.gre.ip.rsc</code>
                    </div>
                    <div class="flex-shrink-0">
                      <ul class="list-inline mb-0">
                        <li class="list-inline-item" title='Копировать'>
                          <a class="text-body" href="#"
                             data-fn="clipboard" data-clipboard-target="#cp-c7fbe839d905a6b570b7a2987c76e059"
                             role="button" aria-label='Копировать'>
                            <i class="fas fa-copy fa-fw"></i>
                          </a>
                        </li>
                        <li class="list-inline-item" title='Скачать'>
                          <a class="text-body" href="/ru/2024/04/326618af-d950-5001-8114-57c66bb8a5af/ros.gre.ip.rsc" download
                             role="button" aria-label='Скачать'>
                            <i class="fas fa-download fa-fw"></i>
                          </a>
                        </li>
                        <li class="list-inline-item" title='Открыть'>
                          <a class="text-body" href="/ru/2024/04/326618af-d950-5001-8114-57c66bb8a5af/ros.gre.ip.rsc" target="_blank"
                             role="button" aria-label='Открыть'>
                            <i class="fas fa-arrow-up-right-from-square fa-fw"></i>
                          </a>
                        </li>
                      </ul>
                    </div>
                  </div>
                </div>
                <div class="card-body p-0 overflow-auto" id="cp-c7fbe839d905a6b570b7a2987c76e059">
                    
                    <div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-text" data-lang="text"><span class="line"><span class="cl"># GRE DYNAMIC IP
</span></span><span class="line"><span class="cl"># -------------------------------------------------------------------------------------------------------------------- #
</span></span><span class="line"><span class="cl"># @package    RouterOS
</span></span><span class="line"><span class="cl"># @author     Kai Kimera &lt;mail@kai.kim&gt;
</span></span><span class="line"><span class="cl"># @copyright  2024 Library Online
</span></span><span class="line"><span class="cl"># @license    MIT
</span></span><span class="line"><span class="cl"># @version    0.1.0
</span></span><span class="line"><span class="cl"># @policy     read, write, test
</span></span><span class="line"><span class="cl"># @schedule:  00:15:00
</span></span><span class="line"><span class="cl"># @link       https://lib.onl/ru/articles/2024/04/326618af-d950-5001-8114-57c66bb8a5af/
</span></span><span class="line"><span class="cl"># -------------------------------------------------------------------------------------------------------------------- #
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">:local wanInterface &#34;ether1&#34;
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"># -------------------------------------------------------------------------------------------------------------------- #
</span></span><span class="line"><span class="cl"># -----------------------------------------------------&lt; SCRIPT &gt;----------------------------------------------------- #
</span></span><span class="line"><span class="cl"># -------------------------------------------------------------------------------------------------------------------- #
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">:local wanAddress [/ip address get [find interface=$wanInterface] address]
</span></span><span class="line"><span class="cl">:set wanAddress [:pick $wanAddress 0 [:find $wanAddress &#34;/&#34;]]
</span></span><span class="line"><span class="cl">:local greComment
</span></span><span class="line"><span class="cl">:local greHost
</span></span><span class="line"><span class="cl">:local greRemoteAddrNew
</span></span><span class="line"><span class="cl">:local greRemoteAddrOld
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">:foreach i in=[/interface gre find where comment~&#34;^HOST: &#34;] do={
</span></span><span class="line"><span class="cl">  :set greComment [/interface gre get $i comment]
</span></span><span class="line"><span class="cl">  :set greHost [:pick $greComment 6 [:len $greComment]]
</span></span><span class="line"><span class="cl">  :set greRemoteAddrOld [/interface gre get $i remote-address]
</span></span><span class="line"><span class="cl">  :set greRemoteAddrNew [:resolve $greHost]
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  :if ($greRemoteAddrNew != $greRemoteAddrOld) do={
</span></span><span class="line"><span class="cl">    /interface gre set $i remote-address=$greRemoteAddrNew
</span></span><span class="line"><span class="cl">    :log info (&#34;GRE: Updating remote address ($greHost) from $greRemoteAddrOld to $greRemoteAddrNew.&#34;)
</span></span><span class="line"><span class="cl">  }
</span></span><span class="line"><span class="cl">}</span></span></code></pre></td></tr></table>
</div>
</div>
                </div>
              </div>
            </div>
        
    
<h4 id="параметры">
  <a class="link-body-emphasis" href="#%d0%bf%d0%b0%d1%80%d0%b0%d0%bc%d0%b5%d1%82%d1%80%d1%8b">Параметры</a>
</h4><ul>
<li><code>wanInterface</code> - название WAN-интерфейса.</li>
</ul>
<h3 id="установка">
  <a class="link-body-emphasis" href="#%d1%83%d1%81%d1%82%d0%b0%d0%bd%d0%be%d0%b2%d0%ba%d0%b0">Установка</a>
</h3><p>После настройки скрипта, его нужно добавить в репозиторий скриптов <span class="shortcode shortcode-tag"><a href="/ru/tags/routeros/" target="_blank">#RouterOS</a></span>. Находится репозиторий в System / Scripts. При добавлении скрипта, необходимо выбрать политики <code>read</code>, <code>write</code>, <code>test</code>.</p>
<h3 id="планировщик">
  <a class="link-body-emphasis" href="#%d0%bf%d0%bb%d0%b0%d0%bd%d0%b8%d1%80%d0%be%d0%b2%d1%89%d0%b8%d0%ba">Планировщик</a>
</h3><p>Скрипт должен переодически запускаться для проверки и синхронизации IP адресов интерфейсов и домена. В этом поможет планировщик <span class="shortcode shortcode-tag"><a href="/ru/tags/routeros/" target="_blank">#RouterOS</a></span>. Заходим в System / Scheduler и создаём задачу с политиками <code>read</code>, <code>write</code>, <code>test</code>. В поле <strong>On Event</strong> вписываем точное название скрипта, ранее добавленного в репозиторий <span class="shortcode shortcode-tag"><a href="/ru/tags/routeros/" target="_blank">#RouterOS</a></span>.</p>]]></turbo:content></item><item turbo="true"><title>MikroTik: Туннель WireGuard (Site-to-Site) + OSPF</title><link>https://lib.onl/ru/2024/04/146e83d5-f571-5273-9a29-172bf5dc10fe/</link><pubDate>Sat, 06 Apr 2024 09:27:28 +0000</pubDate><dc:creator>Kai Kimera</dc:creator><category>Сеть</category><category>Скрипты</category><yandex:related><link url="https://lib.onl/ru/2024/03/54a2b39f-38b4-5f0c-9b54-310f853da38f/">MikroTik: Туннель IPsec (Site-to-Site)</link><link url="https://lib.onl/ru/2023/10/cc13623b-970c-5950-867e-168f9ba9025a/">MikroTik: Добавление корневых сертификатов в RouterOS</link><link url="https://lib.onl/ru/2020/07/ff2ae66e-8e14-5c4a-baa6-0cd2e59f6517/">MikroTik и CloudFlare: Динамический IP для домена</link><link url="https://lib.onl/ru/2023/12/b6c7c5cd-1b0d-5fcd-8dd2-f28f87a5064c/">MikroTik: Настройка DoH</link></yandex:related><turbo:extendedHtml>true</turbo:extendedHtml><turbo:source>https://lib.onl/ru/2024/04/146e83d5-f571-5273-9a29-172bf5dc10fe/</turbo:source><turbo:topic>MikroTik: Туннель WireGuard (Site-to-Site) + OSPF</turbo:topic><turbo:content><![CDATA[<p>Объединение двух маршрутизаторов между собой при помощи туннеля <span class="shortcode shortcode-tag"><a href="/ru/tags/wireguard/" target="_blank">#WireGuard</a></span>. При этом, обмениваться маршрутами эти маршрутизаторы будут через протокол <span class="shortcode shortcode-tag"><a href="/ru/tags/ospf/" target="_blank">#OSPF</a></span>.</p>
<p>В качестве WAN IP я использую суб-домены. <span class="shortcode shortcode-tag"><a href="/ru/tags/wireguard/" target="_blank">#WireGuard</a></span> позволяет использовать суб-домены как EndPoint&rsquo;ы, а уже к суб-доменам приписываются IP-адреса маршрутизаторов. Подобная схема наиболее универсальная, так как не в каждом случае имеется внешний статический IP-адрес, но при использовании скрипта из статьи <span class="shortcode shortcode-uuid"><a href="/ru/2020/07/ff2ae66e-8e14-5c4a-baa6-0cd2e59f6517/">MikroTik и CloudFlare: Динамический IP для домена</a></span> любой адрес маршрутизатора можно превратить в статический через суб-домен.</p>
<h2 id="вводные-данные">
  <a class="link-body-emphasis" href="#%d0%b2%d0%b2%d0%be%d0%b4%d0%bd%d1%8b%d0%b5-%d0%b4%d0%b0%d0%bd%d0%bd%d1%8b%d0%b5">Вводные данные</a>
</h2><ul>
<li>Маршрутизатор <code>R1</code>:
<ul>
<li>WAN IP: <code>gw1.example.com</code>.</li>
<li>LAN IP: <code>10.1.0.1</code>.</li>
<li>Network: <code>10.1.0.0/16</code>.</li>
</ul>
</li>
<li>Маршрутизатор <code>R2</code>:
<ul>
<li>WAN IP: <code>gw2.example.com</code>.</li>
<li>LAN IP: <code>10.2.0.1</code>.</li>
<li>Network: <code>10.2.0.0/16</code>.</li>
</ul>
</li>
</ul>
<h2 id="настройка-маршрутизаторов">
  <a class="link-body-emphasis" href="#%d0%bd%d0%b0%d1%81%d1%82%d1%80%d0%be%d0%b9%d0%ba%d0%b0-%d0%bc%d0%b0%d1%80%d1%88%d1%80%d1%83%d1%82%d0%b8%d0%b7%d0%b0%d1%82%d0%be%d1%80%d0%be%d0%b2">Настройка маршрутизаторов</a>
</h2><h3 id="router-1">
  <a class="link-body-emphasis" href="#router-1">Router #1</a>
</h3><ul>
<li>Создаём интерфейс <span class="shortcode shortcode-tag"><a href="/ru/tags/wireguard/" target="_blank">#WireGuard</a></span>:
<ul>
<li>Номер порта: <code>51820</code>.</li>
<li>Название интерфейса: <code>wireguard-sts</code>.</li>
<li>Комментарий: <code>WireGuard (Site-to-Site)</code>.</li>
</ul>
</li>
</ul>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-0
shortcode-codeblock-text">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-2a999bc07cb85b71ee0c8e739131bc02" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-text" data-lang="text"><span class="line"><span class="cl">/interface wireguard
</span></span><span class="line"><span class="cl">add listen-port=51820 name=wireguard-sts comment=&#34;WireGuard (Site-to-Site)&#34;</span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-2a999bc07cb85b71ee0c8e739131bc02"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<ul>
<li>Прописываем интерфейсу IP-адрес <code>10.255.255.1/24</code>:
<ul>
<li>Адрес интерфейса: <code>10.255.255.1/24</code>.</li>
<li>Интерфейс: <code>wireguard-sts</code>.</li>
<li>Комментарий: <code>[WG] WireGuard (Site-to-Site)</code>.</li>
</ul>
</li>
</ul>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-1
shortcode-codeblock-text">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-7ddb6f43253a13abd0bb38d4e760ca82" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-text" data-lang="text"><span class="line"><span class="cl">/ip address
</span></span><span class="line"><span class="cl">add address=10.255.255.1/24 interface=wireguard-sts comment=&#34;[WG] WireGuard (Site-to-Site)&#34;</span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-7ddb6f43253a13abd0bb38d4e760ca82"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<ul>
<li>Указываем маршрут до удалённой сети <code>R2</code>:
<ul>
<li>Адрес удалённой сети <code>R2</code>: <code>10.2.0.0/16</code>.</li>
<li>Шлюз <code>R2</code>: <code>10.255.255.2</code>.</li>
<li>Комментарий: <code>[WG] GW1-GW2</code>.</li>
</ul>
</li>
</ul>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-2
shortcode-codeblock-text">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-b81df63790603f1ddaf1bdb2b2d43404" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-text" data-lang="text"><span class="line"><span class="cl">/ip route
</span></span><span class="line"><span class="cl">add dst-address=10.2.0.0/16 gateway=10.255.255.2 comment=&#34;[WG] GW1-GW2&#34;</span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-b81df63790603f1ddaf1bdb2b2d43404"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<ul>
<li>Настраиваем фильтры брандмауэра:
<ul>
<li>Открыть порт <code>51820</code>.</li>
<li>Разрешить трафик из удалённой сети <code>R2</code> <code>10.2.0.0/16</code> в локальную сеть <code>R1</code> <code>10.1.0.0/16</code>.</li>
<li>Разрешить трафик из локальной сети <code>R1</code> <code>10.1.0.0/16</code> в удалённую сеть <code>R2</code> <code>10.2.0.0/16</code>.</li>
</ul>
</li>
</ul>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-3
shortcode-codeblock-text">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-c130a2b67ea03a1dd405d1f4ed56b0ce" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-text" data-lang="text"><span class="line"><span class="cl">/ip firewall filter
</span></span><span class="line"><span class="cl">add action=accept chain=input dst-port=51820 in-interface-list=WAN protocol=udp comment=&#34;[WG] WireGuard (Site-to-Site)&#34;
</span></span><span class="line"><span class="cl">add action=accept chain=forward src-address=10.2.0.0/16 dst-address=10.1.0.0/16 comment=&#34;[WG] GW2-GW1&#34;
</span></span><span class="line"><span class="cl">add action=accept chain=forward src-address=10.1.0.0/16 dst-address=10.2.0.0/16 comment=&#34;[WG] GW1-GW2&#34;</span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-c130a2b67ea03a1dd405d1f4ed56b0ce"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<h3 id="router-2">
  <a class="link-body-emphasis" href="#router-2">Router #2</a>
</h3><ul>
<li>Создаём интерфейс <span class="shortcode shortcode-tag"><a href="/ru/tags/wireguard/" target="_blank">#WireGuard</a></span>:
<ul>
<li>Номер порта: <code>51820</code>.</li>
<li>Название интерфейса: <code>wireguard-sts</code>.</li>
<li>Комментарий: <code>WireGuard (Site-to-Site)</code>.</li>
</ul>
</li>
</ul>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-4
shortcode-codeblock-text">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-5634f1a49be1985b02752ac4584a5cda" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-text" data-lang="text"><span class="line"><span class="cl">/interface wireguard
</span></span><span class="line"><span class="cl">add listen-port=51820 name=wireguard-sts comment=&#34;WireGuard (Site-to-Site)&#34;</span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-5634f1a49be1985b02752ac4584a5cda"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<ul>
<li>Прописываем интерфейсу IP-адрес <code>10.255.255.2/24</code>:
<ul>
<li>Адрес интерфейса: <code>10.255.255.2/24</code>.</li>
<li>Интерфейс: <code>wireguard-sts</code>.</li>
<li>Комментарий: <code>[WG] WireGuard (Site-to-Site)</code>.</li>
</ul>
</li>
</ul>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-5
shortcode-codeblock-text">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-6b2fca1bf3f906d71830f65ef4f97e52" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-text" data-lang="text"><span class="line"><span class="cl">/ip address
</span></span><span class="line"><span class="cl">add address=10.255.255.2/24 interface=wireguard-sts comment=&#34;WireGuard (Site-to-Site)&#34;</span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-6b2fca1bf3f906d71830f65ef4f97e52"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<ul>
<li>Указываем маршрут до удалённой сети <code>R1</code>:
<ul>
<li>Адрес удалённой сети <code>R1</code>: <code>10.1.0.0/16</code>.</li>
<li>Шлюз <code>R1</code>: <code>10.255.255.1</code>.</li>
<li>Комментарий: <code>[WG] GW2-GW1</code>.</li>
</ul>
</li>
</ul>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-6
shortcode-codeblock-text">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-e7eef2b74efef350908a283e3b6d6efc" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-text" data-lang="text"><span class="line"><span class="cl">/ip route
</span></span><span class="line"><span class="cl">add dst-address=10.1.0.0/16 gateway=10.255.255.1 comment=&#34;[WG] GW2-GW1&#34;</span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-e7eef2b74efef350908a283e3b6d6efc"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<ul>
<li>Настраиваем фильтры брандмауэра:
<ul>
<li>Открыть порт <code>51820</code>.</li>
<li>Разрешить трафик из удалённой сети <code>R1</code> <code>10.1.0.0/16</code> в локальную сеть <code>R2</code> <code>10.2.0.0/16</code>.</li>
<li>Разрешить трафик из локальной сети <code>R2</code> <code>10.2.0.0/16</code> в удалённую сеть <code>R1</code> <code>10.1.0.0/16</code>.</li>
</ul>
</li>
</ul>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-7
shortcode-codeblock-text">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-cbb3943f7f669294a558358af47e7eff" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-text" data-lang="text"><span class="line"><span class="cl">/ip firewall filter
</span></span><span class="line"><span class="cl">add action=accept chain=input dst-port=51820 in-interface-list=WAN protocol=udp comment=&#34;[WG] WireGuard (Site-to-Site)&#34;
</span></span><span class="line"><span class="cl">add action=accept chain=forward src-address=10.1.0.0/16 dst-address=10.2.0.0/16 comment=&#34;[WG] GW1-GW2&#34;
</span></span><span class="line"><span class="cl">add action=accept chain=forward src-address=10.2.0.0/16 dst-address=10.1.0.0/16 comment=&#34;[WG] GW2-GW1&#34;</span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-cbb3943f7f669294a558358af47e7eff"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<h3 id="автоматизация">
  <a class="link-body-emphasis" href="#%d0%b0%d0%b2%d1%82%d0%be%d0%bc%d0%b0%d1%82%d0%b8%d0%b7%d0%b0%d1%86%d0%b8%d1%8f">Автоматизация</a>
</h3><p>Написал небольшой сценарий для разворачивания интерфейса WireGuard на маршрутизаторах. Настройки сценария, естественно, разные под каждый из маршрутизаторов. А вот добавлять peer&rsquo;ы придётся вручную.</p>

    

    
        
            
            <div class="shortcode shortcode-file mb-3">
              <div class="card overflow-hidden" data-bs-theme="dark">
                <div class="card-header">
                  <div class="d-flex align-items-center">
                    <div class="flex-shrink-0">
                      <i class="far fa-file-code fa-fw"></i>
                    </div>
                    <div class="flex-grow-1 mx-2 text-truncate">
                      <code>ros.wg.rsc</code>
                    </div>
                    <div class="flex-shrink-0">
                      <ul class="list-inline mb-0">
                        <li class="list-inline-item" title='Копировать'>
                          <a class="text-body" href="#"
                             data-fn="clipboard" data-clipboard-target="#cp-4ab64eec6602f4d6c7fd30e5f2484cae"
                             role="button" aria-label='Копировать'>
                            <i class="fas fa-copy fa-fw"></i>
                          </a>
                        </li>
                        <li class="list-inline-item" title='Скачать'>
                          <a class="text-body" href="/ru/2024/04/146e83d5-f571-5273-9a29-172bf5dc10fe/ros.wg.rsc" download
                             role="button" aria-label='Скачать'>
                            <i class="fas fa-download fa-fw"></i>
                          </a>
                        </li>
                        <li class="list-inline-item" title='Открыть'>
                          <a class="text-body" href="/ru/2024/04/146e83d5-f571-5273-9a29-172bf5dc10fe/ros.wg.rsc" target="_blank"
                             role="button" aria-label='Открыть'>
                            <i class="fas fa-arrow-up-right-from-square fa-fw"></i>
                          </a>
                        </li>
                      </ul>
                    </div>
                  </div>
                </div>
                <div class="card-body p-0 overflow-auto" id="cp-4ab64eec6602f4d6c7fd30e5f2484cae">
                    
                    <div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span><span class="lnt">56
</span><span class="lnt">57
</span><span class="lnt">58
</span><span class="lnt">59
</span><span class="lnt">60
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-text" data-lang="text"><span class="line"><span class="cl"># @package    MikroTik / RouterOS / WireGuard
</span></span><span class="line"><span class="cl"># @author     Kai Kimera &lt;mail@kai.kim&gt;
</span></span><span class="line"><span class="cl"># @copyright  2024 Library Online
</span></span><span class="line"><span class="cl"># @license    MIT
</span></span><span class="line"><span class="cl"># @version    0.1.0
</span></span><span class="line"><span class="cl"># @link       https://lib.onl/ru/2024/04/146e83d5-f571-5273-9a29-172bf5dc10fe/
</span></span><span class="line"><span class="cl"># -------------------------------------------------------------------------------------------------------------------- #
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"># WireGuard interface name.
</span></span><span class="line"><span class="cl">:local wgName &#34;wireguard-sts&#34;
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"># WireGuard interface IP address.
</span></span><span class="line"><span class="cl">:local wgIp &#34;10.255.255.1/24&#34;
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"># WireGuard port number.
</span></span><span class="line"><span class="cl">:local wgPort &#34;51820&#34;
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"># -------------------------------------------------------------------------------------------------------------------- #
</span></span><span class="line"><span class="cl"># Local router.
</span></span><span class="line"><span class="cl"># -------------------------------------------------------------------------------------------------------------------- #
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"># Local router name.
</span></span><span class="line"><span class="cl">:local wgLocalName &#34;GW1&#34;
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"># Local network address.
</span></span><span class="line"><span class="cl">:local wgLocalNetwork &#34;10.1.0.0/16&#34;
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"># -------------------------------------------------------------------------------------------------------------------- #
</span></span><span class="line"><span class="cl"># Remote router.
</span></span><span class="line"><span class="cl"># -------------------------------------------------------------------------------------------------------------------- #
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"># Remote router name.
</span></span><span class="line"><span class="cl">:local wgRemoteName &#34;GW2&#34;
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"># Remote network address.
</span></span><span class="line"><span class="cl">:local wgRemoteNetwork &#34;10.2.0.0/16&#34;
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"># -------------------------------------------------------------------------------------------------------------------- #
</span></span><span class="line"><span class="cl"># -----------------------------------------------------&lt; SCRIPT &gt;----------------------------------------------------- #
</span></span><span class="line"><span class="cl"># -------------------------------------------------------------------------------------------------------------------- #
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">/interface wireguard
</span></span><span class="line"><span class="cl">add listen-port=$wgPort name=$wgName \
</span></span><span class="line"><span class="cl">  comment=&#34;[WG] $wgName:$wgPort&#34;
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">/ip address
</span></span><span class="line"><span class="cl">add address=$wgIp interface=$wgName \
</span></span><span class="line"><span class="cl">  comment=&#34;[WG] $wgName:$wgPort&#34;
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">/ip route
</span></span><span class="line"><span class="cl">add dst-address=$wgRemoteNetwork gateway=$wgName \
</span></span><span class="line"><span class="cl">  comment=&#34;[WG] $wgLocalName-$wgRemoteName&#34;
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">/ip firewall filter
</span></span><span class="line"><span class="cl">add action=accept chain=input dst-port=$wgPort in-interface-list=WAN protocol=udp \
</span></span><span class="line"><span class="cl">  comment=&#34;[WG] $wgName:$wgPort&#34;
</span></span><span class="line"><span class="cl">add action=accept chain=forward src-address=$wgRemoteNetwork dst-address=$wgLocalNetwork \
</span></span><span class="line"><span class="cl">  comment=&#34;[WG] $wgRemoteName-$wgLocalName&#34;
</span></span><span class="line"><span class="cl">add action=accept chain=forward src-address=$wgLocalNetwork dst-address=$wgRemoteNetwork \
</span></span><span class="line"><span class="cl">  comment=&#34;[WG] $wgLocalName-$wgRemoteName&#34;</span></span></code></pre></td></tr></table>
</div>
</div>
                </div>
              </div>
            </div>
        
    
<h2 id="добавление-peerов">
  <a class="link-body-emphasis" href="#%d0%b4%d0%be%d0%b1%d0%b0%d0%b2%d0%bb%d0%b5%d0%bd%d0%b8%d0%b5-peer%d0%be%d0%b2">Добавление peer&rsquo;ов</a>
</h2><h3 id="router-1-1">
  <a class="link-body-emphasis" href="#router-1-1">Router #1</a>
</h3><ul>
<li>Добавить маршрутизатор <code>R2</code> в <strong>Peers</strong>:
<ul>
<li>Интерфейс: <code>wireguard-sts</code>.</li>
<li>Публичный ключ маршрутизатора <code>R2</code>: <code>&lt;public-key&gt;</code>.<br>
<em>Публичный ключ берём от маршрутизатора <code>R2</code>.</em></li>
<li>Адрес EndPoint маршрутизатора <code>R2</code>: <code>gw2.example.com</code>.</li>
<li>Порт EndPoint маршрутизатора <code>R2</code>: <code>51820</code>.</li>
<li>Разрешённые адреса:
<ul>
<li><code>10.2.0.0/16</code> - адрес удалённой сети маршрутизатора <code>R2</code>.</li>
<li><code>10.255.255.0/24</code> - общий адрес интерфейсов <code>wireguard-sts</code> обоих маршрутизаторов.</li>
<li><code>224.0.0.5/32</code> - мультикастовый адрес протокола <span class="shortcode shortcode-tag"><a href="/ru/tags/ospf/" target="_blank">#OSPF</a></span>.<br>
<em>Без этого параметра не будет работать протокол <span class="shortcode shortcode-tag"><a href="/ru/tags/ospf/" target="_blank">#OSPF</a></span>.</em></li>
</ul>
</li>
<li>Комментарий: <code>[WG] GW2</code>.</li>
</ul>
</li>
</ul>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-8
shortcode-codeblock-text">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-272bf8afd063c74fbb0585fa351766f1" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-text" data-lang="text"><span class="line"><span class="cl">/interface wireguard peers
</span></span><span class="line"><span class="cl">add allowed-address=10.2.0.0/16,10.255.255.0/24,224.0.0.5/32 endpoint-address=gw2.example.com endpoint-port=51820 interface=wireguard-sts public-key=&#34;&lt;public-key&gt;&#34; comment=&#34;[WG] GW2&#34;</span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-272bf8afd063c74fbb0585fa351766f1"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<h3 id="router-2-1">
  <a class="link-body-emphasis" href="#router-2-1">Router #2</a>
</h3><ul>
<li>Добавить маршрутизатор <code>R1</code> в <strong>Peers</strong>:
<ul>
<li>Интерфейс: <code>wireguard-sts</code>.</li>
<li>Публичный ключ маршрутизатора <code>R1</code>: <code>&lt;public-key&gt;</code>.<br>
<em>Публичный ключ берём от маршрутизатора <code>R1</code>.</em></li>
<li>Адрес EndPoint маршрутизатора <code>R1</code>: <code>gw1.example.com</code>.</li>
<li>Порт EndPoint маршрутизатора <code>R1</code>: <code>51820</code>.</li>
<li>Разрешённые адреса:
<ul>
<li><code>10.1.0.0/16</code> - адрес удалённой сети маршрутизатора <code>R1</code>.</li>
<li><code>10.255.255.0/24</code> - общий адрес интерфейсов <code>wireguard-sts</code> обоих маршрутизаторов.</li>
<li><code>224.0.0.5/32</code> - мультикастовый адрес протокола <span class="shortcode shortcode-tag"><a href="/ru/tags/ospf/" target="_blank">#OSPF</a></span>.<br>
<em>Без этого параметра не будет работать протокол <span class="shortcode shortcode-tag"><a href="/ru/tags/ospf/" target="_blank">#OSPF</a></span>.</em></li>
</ul>
</li>
<li>Комментарий: <code>[WG] GW1</code>.</li>
</ul>
</li>
</ul>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-9
shortcode-codeblock-text">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-89ad79892ede14b7057ffee69a42aabf" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-text" data-lang="text"><span class="line"><span class="cl">/interface wireguard peers
</span></span><span class="line"><span class="cl">add allowed-address=10.1.0.0/16,10.255.255.0/24,224.0.0.5/32 endpoint-address=gw1.example.com endpoint-port=51820 interface=wireguard-sts public-key=&#34;&lt;public-key&gt;&#34; comment=&#34;[WG] GW1&#34;</span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-89ad79892ede14b7057ffee69a42aabf"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<h2 id="настройка-ospf">
  <a class="link-body-emphasis" href="#%d0%bd%d0%b0%d1%81%d1%82%d1%80%d0%be%d0%b9%d0%ba%d0%b0-ospf">Настройка OSPF</a>
</h2>



    






    
    








<div class="shortcode shortcode-alert">
  <div class="alert alert-info d-flex overflow-hidden" role="alert">
    <div class="flex-shrink-0 align-self-center">
      <i class="fas fa-info fa-fw fa-2x"></i>
    </div>
    <div class="flex-grow-1 ms-3 overflow-hidden">
        <p>На каждом маршрутизаторе настройки полностью идентичные.</p>

    </div>
  </div>
</div>

<ul>
<li>Создаём инстанс:
<ul>
<li>Название: <code>ospf-instance-wg</code>.</li>
</ul>
</li>
</ul>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-10
shortcode-codeblock-text">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-ad881f3e464696cf457522dd14d5f03b" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-text" data-lang="text"><span class="line"><span class="cl">/routing ospf instance
</span></span><span class="line"><span class="cl">add name=ospf-instance-wg</span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-ad881f3e464696cf457522dd14d5f03b"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<ul>
<li>Добавляем Area:
<ul>
<li>Название Area: <code>backbone</code>.</li>
<li>Название инстанса: <code>ospf-instance-wg</code>.</li>
</ul>
</li>
</ul>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-11
shortcode-codeblock-text">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-2b18e92bbec41cf6df06a656a1c7520b" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-text" data-lang="text"><span class="line"><span class="cl">/routing ospf area
</span></span><span class="line"><span class="cl">add instance=ospf-instance-wg name=backbone</span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-2b18e92bbec41cf6df06a656a1c7520b"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<ul>
<li>Настраиваем шаблоны:
<ul>
<li>Интерфейс <code>bridge1</code>.
<ul>
<li>Area: <code>backbone</code>.</li>
</ul>
</li>
<li>Интерфейс <code>wireguard-sts</code>.
<ul>
<li>Area: <code>backbone</code>.</li>
<li>Type: <code>PTP</code> (Point-to-Point).</li>
</ul>
</li>
</ul>
</li>
</ul>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-12
shortcode-codeblock-text">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-8ee30e0d5fd331aa3436cd4cb83f3381" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-text" data-lang="text"><span class="line"><span class="cl">/routing ospf interface-template
</span></span><span class="line"><span class="cl">add area=backbone interfaces=bridge1
</span></span><span class="line"><span class="cl">add area=backbone interfaces=wireguard-sts type=ptp</span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-8ee30e0d5fd331aa3436cd4cb83f3381"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<ul>
<li>Настраиваем фильтры брандмауэра:
<ul>
<li>Разрешить протокол <span class="shortcode shortcode-tag"><a href="/ru/tags/ospf/" target="_blank">#OSPF</a></span> на интерфейсе <code>wireguard-sts</code>.</li>
</ul>
</li>
</ul>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-13
shortcode-codeblock-text">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-51229694b22a3f4da1c0a1393cb94ce2" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-text" data-lang="text"><span class="line"><span class="cl">/ip firewall filter
</span></span><span class="line"><span class="cl">add action=accept chain=input in-interface=wireguard-sts protocol=ospf comment=&#34;[WG] OSPF&#34;</span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-51229694b22a3f4da1c0a1393cb94ce2"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>]]></turbo:content></item><item turbo="true"><title>Установка и настройка Asterisk</title><link>https://lib.onl/ru/2024/04/2e00b43b-b0da-59c2-ae92-60dcf2ba1d52/</link><pubDate>Thu, 04 Apr 2024 11:44:11 +0000</pubDate><dc:creator>Kai Kimera</dc:creator><category>В доработке</category><category>Сеть</category><yandex:related><link url="https://lib.onl/ru/2023/11/4dfa15a8-44f0-5590-a04d-f940dac12aad/">Переход Debian между релизами</link><link url="https://lib.onl/ru/2022/01/06ef2fab-2ae2-5356-9154-7ca1e486d27d/">Установка ядра XanMod в Debian</link><link url="https://lib.onl/ru/2022/01/ddddd243-d182-5e26-a161-d2ea7812214a/">Установка Vivaldi в Debian</link><link url="https://lib.onl/ru/2021/09/581804b8-0613-52a8-a5c4-fdae90e7bc8a/">Чёрный экран с курсором при старте GDM</link><link url="https://lib.onl/ru/2021/09/1cf305cd-85d0-5e02-aabb-e01346bfee0f/">Proxmox VE: Установка на Debian 11 (Bullseye)</link><link url="https://lib.onl/ru/2021/09/ff829d15-4a19-52e3-a3aa-ad70aa38854a/">Debian: Wired Networks are Unmanaged</link><link url="https://lib.onl/ru/2021/09/b2caccc7-92bf-57ed-970f-136c546f18e2/">Распаковка пакетов DEB / RPM</link><link url="https://lib.onl/ru/2021/09/43b40b92-c29a-504b-87fa-5eac368dcf95/">Отключение установки дополнительных пакетов в Debian APT</link><link url="https://lib.onl/ru/2021/09/aeed7c90-003a-532a-b2c4-3807aaee88fa/">dhclient отправляет 36-значный идентификатор вместо MAC</link><link url="https://lib.onl/ru/2021/05/ee559a6c-5cde-5166-9d2d-3ceb55878eb8/">Debian: Статический IP-адрес</link></yandex:related><turbo:extendedHtml>true</turbo:extendedHtml><turbo:source>https://lib.onl/ru/2024/04/2e00b43b-b0da-59c2-ae92-60dcf2ba1d52/</turbo:source><turbo:topic>Установка и настройка Asterisk</turbo:topic><turbo:content><![CDATA[<p>Устанавливаем <span class="shortcode shortcode-tag"><a href="/ru/tags/asterisk/" target="_blank">#Asterisk</a></span> на ОС <span class="shortcode shortcode-tag"><a href="/ru/tags/debian/" target="_blank">#Debian</a></span> и создаём под него отдельного пользователя.</p>
<h2 id="обновление-ос-и-установка-пакетов">
  <a class="link-body-emphasis" href="#%d0%be%d0%b1%d0%bd%d0%be%d0%b2%d0%bb%d0%b5%d0%bd%d0%b8%d0%b5-%d0%be%d1%81-%d0%b8-%d1%83%d1%81%d1%82%d0%b0%d0%bd%d0%be%d0%b2%d0%ba%d0%b0-%d0%bf%d0%b0%d0%ba%d0%b5%d1%82%d0%be%d0%b2">Обновление ОС и установка пакетов</a>
</h2><p>Перед сборкой <span class="shortcode shortcode-tag"><a href="/ru/tags/asterisk/" target="_blank">#Asterisk</a></span> необходимо обновить пакеты ОС <span class="shortcode shortcode-tag"><a href="/ru/tags/debian/" target="_blank">#Debian</a></span>:</p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-0
shortcode-codeblock-bash">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-ebf106cace8137b6d94920e309901df4" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">apt update <span class="o">&amp;&amp;</span> apt --yes full-upgrade</span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-ebf106cace8137b6d94920e309901df4"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<h2 id="установка-asterisk">
  <a class="link-body-emphasis" href="#%d1%83%d1%81%d1%82%d0%b0%d0%bd%d0%be%d0%b2%d0%ba%d0%b0-asterisk">Установка Asterisk</a>
</h2><p>Сборку <span class="shortcode shortcode-tag"><a href="/ru/tags/asterisk/" target="_blank">#Asterisk</a></span> необходимо выполнять находясь в его директории.</p>
<h3 id="установка-компонентов">
  <a class="link-body-emphasis" href="#%d1%83%d1%81%d1%82%d0%b0%d0%bd%d0%be%d0%b2%d0%ba%d0%b0-%d0%ba%d0%be%d0%bc%d0%bf%d0%be%d0%bd%d0%b5%d0%bd%d1%82%d0%be%d0%b2">Установка компонентов</a>
</h3><p>Добавляем возможность использования MP3 и устанавливаем все зависимости для сборки:</p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-1
shortcode-codeblock-bash">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-34eeaf7d2f73fc933db19fe23a9e2ff5" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">bash ./contrib/scripts/get_mp3_source.sh <span class="o">&amp;&amp;</span> bash ./contrib/scripts/install_prereq install</span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-34eeaf7d2f73fc933db19fe23a9e2ff5"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<h3 id="конфигурация-сборки">
  <a class="link-body-emphasis" href="#%d0%ba%d0%be%d0%bd%d1%84%d0%b8%d0%b3%d1%83%d1%80%d0%b0%d1%86%d0%b8%d1%8f-%d1%81%d0%b1%d0%be%d1%80%d0%ba%d0%b8">Конфигурация сборки</a>
</h3><p>Выполняем конфигурирование и настройку компонентов:</p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-2
shortcode-codeblock-bash">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-497e2afc5313cc3f1a69b7c2cd810c2c" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">./configure <span class="o">&amp;&amp;</span> make menuselect.makeopts <span class="o">&amp;&amp;</span> menuselect/menuselect --enable app_macro --enable chan_ooh323 --enable format_mp3 --enable codec_opus --enable CORE-SOUNDS-EN-WAV --enable CORE-SOUNDS-EN-ULAW --enable CORE-SOUNDS-EN-ALAW --enable CORE-SOUNDS-EN-GSM --enable CORE-SOUNDS-RU-WAV --enable CORE-SOUNDS-RU-ULAW --enable CORE-SOUNDS-RU-ALAW --enable CORE-SOUNDS-RU-GSM menuselect.makeopts</span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-497e2afc5313cc3f1a69b7c2cd810c2c"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<p>Устанавливаются следующие компоненты:</p>
<ul>
<li><code>app_macro</code></li>
<li><code>chan_ooh323</code></li>
<li><code>format_mp3</code></li>
<li><code>codec_opus</code></li>
<li><code>CORE-SOUNDS-EN-WAV</code></li>
<li><code>CORE-SOUNDS-EN-ULAW</code></li>
<li><code>CORE-SOUNDS-EN-ALAW</code></li>
<li><code>CORE-SOUNDS-EN-GSM</code></li>
<li><code>CORE-SOUNDS-RU-WAV</code></li>
<li><code>CORE-SOUNDS-RU-ULAW</code></li>
<li><code>CORE-SOUNDS-RU-ALAW</code></li>
<li><code>CORE-SOUNDS-RU-GSM</code></li>
</ul>
<h3 id="сборка-и-установка-asterisk">
  <a class="link-body-emphasis" href="#%d1%81%d0%b1%d0%be%d1%80%d0%ba%d0%b0-%d0%b8-%d1%83%d1%81%d1%82%d0%b0%d0%bd%d0%be%d0%b2%d0%ba%d0%b0-asterisk">Сборка и установка Asterisk</a>
</h3><p>После конфигурирования, начинаем сборку:</p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-3
shortcode-codeblock-bash">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-1e5e37d40ff7d24f11ae1ba60393e92d" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">make <span class="o">&amp;&amp;</span> make install <span class="o">&amp;&amp;</span> make basic-pbx <span class="o">&amp;&amp;</span> make config <span class="o">&amp;&amp;</span> ldconfig</span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-1e5e37d40ff7d24f11ae1ba60393e92d"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<h2 id="настройка-asterisk">
  <a class="link-body-emphasis" href="#%d0%bd%d0%b0%d1%81%d1%82%d1%80%d0%be%d0%b9%d0%ba%d0%b0-asterisk">Настройка Asterisk</a>
</h2><h3 id="настройка-пользователя">
  <a class="link-body-emphasis" href="#%d0%bd%d0%b0%d1%81%d1%82%d1%80%d0%be%d0%b9%d0%ba%d0%b0-%d0%bf%d0%be%d0%bb%d1%8c%d0%b7%d0%be%d0%b2%d0%b0%d1%82%d0%b5%d0%bb%d1%8f">Настройка пользователя</a>
</h3><p>По умолчанию, <span class="shortcode shortcode-tag"><a href="/ru/tags/asterisk/" target="_blank">#Asterisk</a></span> использует пользователя <code>root</code> для работы. Это немного не правильно, сделаем так, чтобы <span class="shortcode shortcode-tag"><a href="/ru/tags/asterisk/" target="_blank">#Asterisk</a></span> работал под своим пользователем. Создаём пользователя:</p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-4
shortcode-codeblock-bash">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-3329e3be2901f0eb340a1d891e4daead" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="nv">u</span><span class="o">=</span><span class="s1">&#39;asterisk&#39;</span><span class="p">;</span> groupadd <span class="si">${</span><span class="nv">u</span><span class="si">}</span> <span class="o">&amp;&amp;</span> useradd -r -d /var/lib/<span class="si">${</span><span class="nv">u</span><span class="si">}</span> -g <span class="si">${</span><span class="nv">u</span><span class="si">}</span> <span class="si">${</span><span class="nv">u</span><span class="si">}</span> <span class="o">&amp;&amp;</span> usermod -aG audio,dialout <span class="si">${</span><span class="nv">u</span><span class="si">}</span> <span class="o">&amp;&amp;</span> chown -R <span class="si">${</span><span class="nv">u</span><span class="si">}</span>:<span class="si">${</span><span class="nv">u</span><span class="si">}</span> /etc/<span class="si">${</span><span class="nv">u</span><span class="si">}</span> <span class="o">&amp;&amp;</span> chown -R <span class="si">${</span><span class="nv">u</span><span class="si">}</span>:<span class="si">${</span><span class="nv">u</span><span class="si">}</span> /var/<span class="o">{</span>lib,log,spool<span class="o">}</span>/<span class="si">${</span><span class="nv">u</span><span class="si">}</span> <span class="o">&amp;&amp;</span> chown -R <span class="si">${</span><span class="nv">u</span><span class="si">}</span>:<span class="si">${</span><span class="nv">u</span><span class="si">}</span> /usr/lib/<span class="si">${</span><span class="nv">u</span><span class="si">}</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-3329e3be2901f0eb340a1d891e4daead"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<p>После создания пользователя, необходимо отредактировать конфигурационные файлы, чтобы указать Asterisk&rsquo;у под каким пользователем осуществлять запуск:</p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-5
shortcode-codeblock-bash">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-66db425c9cf2f5d598482f863b775d22" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">sed -i -e <span class="s1">&#39;s|#AST_USER=&#34;asterisk&#34;|AST_USER=&#34;asterisk&#34;|g&#39;</span> -e <span class="s1">&#39;s|#AST_GROUP=&#34;asterisk&#34;|AST_GROUP=&#34;asterisk&#34;|g&#39;</span> <span class="s1">&#39;/etc/default/asterisk&#39;</span> <span class="o">&amp;&amp;</span> sed -i -e <span class="s1">&#39;s|;runuser = asterisk|runuser = asterisk|g&#39;</span> -e <span class="s1">&#39;s|;rungroup = asterisk|rungroup = asterisk|g&#39;</span> <span class="s1">&#39;/etc/asterisk/asterisk.conf&#39;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-66db425c9cf2f5d598482f863b775d22"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<h2 id="запуск-asterisk">
  <a class="link-body-emphasis" href="#%d0%b7%d0%b0%d0%bf%d1%83%d1%81%d0%ba-asterisk">Запуск Asterisk</a>
</h2><p>Указываем автоматический запуск службы <span class="shortcode shortcode-tag"><a href="/ru/tags/asterisk/" target="_blank">#Asterisk</a></span>:</p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-6
shortcode-codeblock-bash">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-02c83355f2a7177ad0272319308c872f" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">systemctl <span class="nb">enable</span> --now asterisk</span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-02c83355f2a7177ad0272319308c872f"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<p>Проверяем:</p>











<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-7 shortcode-codeblock-terminal
shortcode-codeblock-terminal-linux
shortcode-codeblock-terminal-linux-root">
  <div class="card overflow-hidden" data-bs-theme="dark">
    <div class="card-header">
      <div class="d-flex align-items-center">
        <div class="flex-shrink-0 text-danger">
          <i class="fas fa-terminal fa-fw"></i>
        </div>
        <div class="flex-grow-1 mx-2">
          <h5 class="mb-0">Терминал</h5>
        </div>
        <div class="flex-shrink-0">
          <ul class="list-inline mb-0">
            <li class="list-inline-item" title='Копировать'>
              <a class="text-body" href="#"
                 data-fn="clipboard" data-clipboard-target="#cp-538232a820c0d3c75269e8ee229576bd"
                 role="button" aria-label='Копировать'>
                <i class="fas fa-copy fa-fw"></i>
              </a>
            </li>
          </ul>
        </div>
      </div>
    </div>
    <div class="card-body p-0 overflow-auto" id="cp-538232a820c0d3c75269e8ee229576bd"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-plaintext" data-lang="plaintext"><span class="line"><span class="cl">systemctl status asterisk
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">● asterisk.service - LSB: Asterisk PBX
</span></span><span class="line"><span class="cl">     Loaded: loaded (/etc/init.d/asterisk; generated)
</span></span><span class="line"><span class="cl">     Active: active (running) since Thu 2024-04-04 11:51:43 UTC; 2h 5min ago
</span></span><span class="line"><span class="cl">       Docs: man:systemd-sysv-generator(8)
</span></span><span class="line"><span class="cl">    Process: 791 ExecStart=/etc/init.d/asterisk start (code=exited, status=0/SUCCESS)
</span></span><span class="line"><span class="cl">      Tasks: 35 (limit: 1013)
</span></span><span class="line"><span class="cl">     Memory: 61.1M
</span></span><span class="line"><span class="cl">        CPU: 36.239s
</span></span><span class="line"><span class="cl">     CGroup: /system.slice/asterisk.service
</span></span><span class="line"><span class="cl">             └─871 /usr/sbin/asterisk -U asterisk -G asterisk
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Apr 04 11:51:42 phone systemd[1]: Starting LSB: Asterisk PBX...
</span></span><span class="line"><span class="cl">Apr 04 11:51:43 phone asterisk[791]:  * Starting Asterisk PBX: asterisk
</span></span><span class="line"><span class="cl">Apr 04 11:51:43 phone asterisk[791]:    ...done.
</span></span><span class="line"><span class="cl">Apr 04 11:51:43 phone systemd[1]: Started LSB: Asterisk PBX.</span></span></code></pre></td></tr></table>
</div>
</div></div>
  </div>
</div>
<p>Заходим в консоль <span class="shortcode shortcode-tag"><a href="/ru/tags/asterisk/" target="_blank">#Asterisk</a></span> и проверяем работу:</p>











<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-8 shortcode-codeblock-terminal
shortcode-codeblock-terminal-linux
shortcode-codeblock-terminal-linux-root">
  <div class="card overflow-hidden" data-bs-theme="dark">
    <div class="card-header">
      <div class="d-flex align-items-center">
        <div class="flex-shrink-0 text-danger">
          <i class="fas fa-terminal fa-fw"></i>
        </div>
        <div class="flex-grow-1 mx-2">
          <h5 class="mb-0">Терминал</h5>
        </div>
        <div class="flex-shrink-0">
          <ul class="list-inline mb-0">
            <li class="list-inline-item" title='Копировать'>
              <a class="text-body" href="#"
                 data-fn="clipboard" data-clipboard-target="#cp-3b4c18d12ee787fe61d7cf4a80510b02"
                 role="button" aria-label='Копировать'>
                <i class="fas fa-copy fa-fw"></i>
              </a>
            </li>
          </ul>
        </div>
      </div>
    </div>
    <div class="card-body p-0 overflow-auto" id="cp-3b4c18d12ee787fe61d7cf4a80510b02"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-plaintext" data-lang="plaintext"><span class="line"><span class="cl">asterisk -rvv
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Asterisk 20.7.0, Copyright (C) 1999 - 2022, Sangoma Technologies Corporation and others.
</span></span><span class="line"><span class="cl">Created by Mark Spencer &lt;markster@digium.com&gt;
</span></span><span class="line"><span class="cl">Asterisk comes with ABSOLUTELY NO WARRANTY; type &#39;core show warranty&#39; for details.
</span></span><span class="line"><span class="cl">This is free software, with components licensed under the GNU General Public
</span></span><span class="line"><span class="cl">License version 2 and other licenses; you are welcome to redistribute it under
</span></span><span class="line"><span class="cl">certain conditions. Type &#39;core show license&#39; for details.
</span></span><span class="line"><span class="cl">=========================================================================
</span></span><span class="line"><span class="cl">Running as user &#39;asterisk&#39;
</span></span><span class="line"><span class="cl">Running under group &#39;asterisk&#39;
</span></span><span class="line"><span class="cl">Connected to Asterisk 20.7.0 currently running on phone (pid = 871)
</span></span><span class="line"><span class="cl">phone*CLI&gt;</span></span></code></pre></td></tr></table>
</div>
</div></div>
  </div>
</div>
<h2 id="tls">
  <a class="link-body-emphasis" href="#tls">TLS</a>
</h2>








  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-9
shortcode-codeblock-bash">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-b03028375e4df511d4afe06b790cfd6d" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">mkdir /etc/asterisk/keys</span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-b03028375e4df511d4afe06b790cfd6d"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>











  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-10
shortcode-codeblock-bash">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-0be878fd000914dc32884fa1ab2a22f9" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">nano /etc/asterisk/pjsip.conf</span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-0be878fd000914dc32884fa1ab2a22f9"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>











  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-11
shortcode-codeblock-ini">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-ed7f6b759e8dc3d3676874e4f65ea191" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-ini" data-lang="ini"><span class="line"><span class="cl"><span class="k">[transport-tls]</span>
</span></span><span class="line"><span class="cl"><span class="na">type</span><span class="o">=</span><span class="s">transport</span>
</span></span><span class="line"><span class="cl"><span class="na">protocol</span><span class="o">=</span><span class="s">tls</span>
</span></span><span class="line"><span class="cl"><span class="na">bind</span><span class="o">=</span><span class="s">0.0.0.0:5061</span>
</span></span><span class="line"><span class="cl"><span class="na">cert_file</span><span class="o">=</span><span class="s">/etc/asterisk/keys/asterisk.crt</span>
</span></span><span class="line"><span class="cl"><span class="na">priv_key_file</span><span class="o">=</span><span class="s">/etc/asterisk/keys/asterisk.key</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-ed7f6b759e8dc3d3676874e4f65ea191"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>]]></turbo:content></item><item turbo="true"><title>MikroTik: Туннель IPsec (Site-to-Site)</title><link>https://lib.onl/ru/2024/03/54a2b39f-38b4-5f0c-9b54-310f853da38f/</link><pubDate>Sun, 31 Mar 2024 20:46:24 +0000</pubDate><dc:creator>Kai Kimera</dc:creator><category>Сеть</category><category>Скрипты</category><yandex:related><link url="https://lib.onl/ru/2023/10/cc13623b-970c-5950-867e-168f9ba9025a/">MikroTik: Добавление корневых сертификатов в RouterOS</link><link url="https://lib.onl/ru/2020/07/ff2ae66e-8e14-5c4a-baa6-0cd2e59f6517/">MikroTik и CloudFlare: Динамический IP для домена</link><link url="https://lib.onl/ru/2023/12/b6c7c5cd-1b0d-5fcd-8dd2-f28f87a5064c/">MikroTik: Настройка DoH</link></yandex:related><turbo:extendedHtml>true</turbo:extendedHtml><turbo:source>https://lib.onl/ru/2024/03/54a2b39f-38b4-5f0c-9b54-310f853da38f/</turbo:source><turbo:topic>MikroTik: Туннель IPsec (Site-to-Site)</turbo:topic><turbo:content><![CDATA[<p>Объединение двух маршрутизаторов между собой при помощи туннеля <span class="shortcode shortcode-tag"><a href="/ru/tags/ipsec/" target="_blank">#IPsec</a></span>.</p>
<p>В WAN IP у меня используются суб-домены. К суб-доменам через A-запись в <span class="shortcode shortcode-tag"><a href="/ru/tags/dns/" target="_blank">#DNS</a></span> прописаны внешние IP-адреса маршрутизаторов. При помощи скрипта из статьи <span class="shortcode shortcode-uuid"><a href="/ru/2020/07/ff2ae66e-8e14-5c4a-baa6-0cd2e59f6517/">MikroTik и CloudFlare: Динамический IP для домена</a></span> у меня каждый маршрутизатор имеет актуальный IP-адрес в суб-домене.</p>
<h2 id="вводные-данные">
  <a class="link-body-emphasis" href="#%d0%b2%d0%b2%d0%be%d0%b4%d0%bd%d1%8b%d0%b5-%d0%b4%d0%b0%d0%bd%d0%bd%d1%8b%d0%b5">Вводные данные</a>
</h2><ul>
<li>Маршрутизатор <code>R1</code>:
<ul>
<li>WAN IP: <code>gw1.example.com</code>.</li>
<li>LAN IP: <code>10.1.0.1</code>.</li>
<li>Network: <code>10.1.0.0/16</code>.</li>
</ul>
</li>
<li>Маршрутизатор <code>R2</code>:
<ul>
<li>WAN IP: <code>gw2.example.com</code>.</li>
<li>LAN IP: <code>10.2.0.1</code>.</li>
<li>Network: <code>10.2.0.0/16</code>.</li>
</ul>
</li>
</ul>
<h2 id="настройка-маршрутизаторов">
  <a class="link-body-emphasis" href="#%d0%bd%d0%b0%d1%81%d1%82%d1%80%d0%be%d0%b9%d0%ba%d0%b0-%d0%bc%d0%b0%d1%80%d1%88%d1%80%d1%83%d1%82%d0%b8%d0%b7%d0%b0%d1%82%d0%be%d1%80%d0%be%d0%b2">Настройка маршрутизаторов</a>
</h2><h3 id="router-1">
  <a class="link-body-emphasis" href="#router-1">Router #1</a>
</h3><ul>
<li>Добавляем профиль <span class="shortcode shortcode-tag"><a href="/ru/tags/ipsec/" target="_blank">#IPsec</a></span>:
<ul>
<li>Имя профиля: <code>ipsec-sts</code>.</li>
<li>Группа Diffie-Hellman (стойкость шифрования): <code>ecp384</code>.</li>
<li>Алгоритм шифрования: <code>aes-256</code>.</li>
</ul>
</li>
</ul>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-0
shortcode-codeblock-text">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-f71dea2e59882b7ae1ec59833ff36d87" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-text" data-lang="text"><span class="line"><span class="cl">/ip ipsec profile
</span></span><span class="line"><span class="cl">add dh-group=ecp384 enc-algorithm=aes-256 name=ipsec-sts</span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-f71dea2e59882b7ae1ec59833ff36d87"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<ul>
<li>Добавляем представление <span class="shortcode shortcode-tag"><a href="/ru/tags/ipsec/" target="_blank">#IPsec</a></span>:
<ul>
<li>Имя представления: <code>ipsec-sts</code>.</li>
<li>Алгоритм аутентификации: <code>sha256</code>.</li>
<li>Алгоритм шифрования: <code>aes-256-cbc</code>.</li>
<li>Группа Diffie-Hellman (стойкость шифрования): <code>ecp384</code>.</li>
</ul>
</li>
</ul>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-1
shortcode-codeblock-text">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-459850626cf5d4aa2cc02485f56da492" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-text" data-lang="text"><span class="line"><span class="cl">/ip ipsec proposal
</span></span><span class="line"><span class="cl">add auth-algorithms=sha256 enc-algorithms=aes-256-cbc name=ipsec-sts pfs-group=ecp384</span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-459850626cf5d4aa2cc02485f56da492"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<ul>
<li>Добавляем <span class="shortcode shortcode-tag"><a href="/ru/tags/ipsec/" target="_blank">#IPsec</a></span> peer:
<ul>
<li>Имя peer&rsquo;а: <code>GW2</code>.</li>
<li>Внешний адрес <code>R2</code>: <code>gw2.example.com</code>.</li>
<li>Профиль: <code>ipsec-sts</code>.</li>
<li>Режим обмена: <code>ike2</code>.</li>
<li>Комментарий: <code>GW2</code>.</li>
</ul>
</li>
</ul>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-2
shortcode-codeblock-text">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-0c99185c6c2a75158df34a188923c9c2" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-text" data-lang="text"><span class="line"><span class="cl">/ip ipsec peer
</span></span><span class="line"><span class="cl">add address=&#34;gw2.example.com&#34; exchange-mode=ike2 name=GW2 profile=ipsec-sts comment=&#34;GW2&#34;</span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-0c99185c6c2a75158df34a188923c9c2"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<ul>
<li>Добавляем идентификацию:
<ul>
<li>Peer: <code>GW2</code>.</li>
<li>Секретная фраза: <code>PassWord</code>.<br>
<em>Секретная фраза должна быть одинаковой на обоих маршрутизаторах.</em></li>
<li>Комментарий: <code>GW2</code>.</li>
</ul>
</li>
</ul>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-3
shortcode-codeblock-text">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-d20c5ceb0ebca572fa74d523c086e9a9" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-text" data-lang="text"><span class="line"><span class="cl">/ip ipsec identity
</span></span><span class="line"><span class="cl">add peer=GW2 secret=&#34;PassWord&#34; comment=&#34;GW2&#34;</span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-d20c5ceb0ebca572fa74d523c086e9a9"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<ul>
<li>Добавляем политику <span class="shortcode shortcode-tag"><a href="/ru/tags/ipsec/" target="_blank">#IPsec</a></span>:
<ul>
<li>Peer: <code>GW2</code>.</li>
<li>Туннель: <code>yes</code>.</li>
<li>Адрес локальной сети <code>R1</code>: <code>10.1.0.0/16</code>.</li>
<li>Адрес удалённой сети <code>R2</code>: <code>10.2.0.0/16</code>.</li>
<li>Действие: <code>encrypt</code>.</li>
<li>Представление: <code>ipsec-sts</code>.</li>
<li>Комментарий: <code>GW1-GW2</code>.</li>
</ul>
</li>
</ul>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-4
shortcode-codeblock-text">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-4922d6eaba6efaea4fb2b01410ddc5bb" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-text" data-lang="text"><span class="line"><span class="cl">/ip ipsec policy
</span></span><span class="line"><span class="cl">add src-address=10.1.0.0/16 dst-address=10.2.0.0/16 tunnel=yes action=encrypt proposal=ipsec-sts peer=GW2 comment=&#34;GW1-GW2&#34;</span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-4922d6eaba6efaea4fb2b01410ddc5bb"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<ul>
<li>Исключаем обработку трафика <span class="shortcode shortcode-tag"><a href="/ru/tags/ipsec/" target="_blank">#IPsec</a></span>:
<ul>
<li>Адрес локальной сети <code>R1</code>: <code>10.1.0.0/16</code>.</li>
<li>Адрес удалённой сети <code>R2</code>: <code>10.2.0.0/16</code>.</li>
<li>Комментарий: <code>[IPsec] GW1-GW2</code>.</li>
</ul>
</li>
</ul>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-5
shortcode-codeblock-text">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-d54e137d6cb040ca5a42446e5ca7d12a" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-text" data-lang="text"><span class="line"><span class="cl">/ip firewall nat
</span></span><span class="line"><span class="cl">add chain=srcnat action=accept src-address=10.1.0.0/16 dst-address=10.2.0.0/16 place-before=0 comment=&#34;[IPsec] GW1-GW2&#34;</span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-d54e137d6cb040ca5a42446e5ca7d12a"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<ul>
<li>Настраивает фильтры брандмауэра:
<ul>
<li>Открыть порты <code>500</code> и <code>4500</code> по протоколу <code>UDP</code>.</li>
<li>Разрешить трафик по протоколу <code>ipsec-esp</code>.</li>
</ul>
</li>
</ul>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-6
shortcode-codeblock-text">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-3eb81566399ce1cd9c2296728ad73a7b" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-text" data-lang="text"><span class="line"><span class="cl">/ip firewall filter
</span></span><span class="line"><span class="cl">add action=accept chain=input dst-port=500,4500 in-interface-list=WAN protocol=udp comment=&#34;[ROS] IPsec&#34;
</span></span><span class="line"><span class="cl">add action=accept chain=input in-interface-list=WAN protocol=ipsec-esp comment=&#34;[ROS] IPsec&#34;</span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-3eb81566399ce1cd9c2296728ad73a7b"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<ul>
<li>Настраиваем обход отслеживания соединений <span class="shortcode shortcode-tag"><a href="/ru/tags/ipsec/" target="_blank">#IPsec</a></span> для снижения нагрузки на CPU маршрутизатора:
<ul>
<li>Пакеты из удалённой сети <code>R2</code> <code>10.2.0.0/16</code> в локальную сеть <code>R1</code> <code>10.1.0.0/16</code>.</li>
<li>Пакеты из локальной сети <code>R1</code> <code>10.1.0.0/16</code> в удалённую сеть <code>R2</code> <code>10.2.0.0/16</code>.</li>
</ul>
</li>
</ul>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-7
shortcode-codeblock-text">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-4075faf3a107af96322483406f363e8b" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-text" data-lang="text"><span class="line"><span class="cl">/ip firewall raw
</span></span><span class="line"><span class="cl">add action=notrack chain=prerouting src-address=10.2.0.0/16 dst-address=10.1.0.0/16 comment=&#34;[IPsec] GW2-GW1&#34;
</span></span><span class="line"><span class="cl">add action=notrack chain=prerouting src-address=10.1.0.0/16 dst-address=10.2.0.0/16 comment=&#34;[IPsec] GW1-GW2&#34;</span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-4075faf3a107af96322483406f363e8b"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<h3 id="router-2">
  <a class="link-body-emphasis" href="#router-2">Router #2</a>
</h3><ul>
<li>Добавляем профиль <span class="shortcode shortcode-tag"><a href="/ru/tags/ipsec/" target="_blank">#IPsec</a></span>:
<ul>
<li>Имя профиля: <code>ipsec-sts</code>.</li>
<li>Группа Diffie-Hellman (стойкость шифрования): <code>ecp384</code>.</li>
<li>Алгоритм шифрования: <code>aes-256</code>.</li>
</ul>
</li>
</ul>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-8
shortcode-codeblock-text">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-407e39a486a44a39a6f674a3ffc409a1" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-text" data-lang="text"><span class="line"><span class="cl">/ip ipsec profile
</span></span><span class="line"><span class="cl">add dh-group=ecp384 enc-algorithm=aes-256 name=ipsec-sts</span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-407e39a486a44a39a6f674a3ffc409a1"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<ul>
<li>Добавляем представление <span class="shortcode shortcode-tag"><a href="/ru/tags/ipsec/" target="_blank">#IPsec</a></span>:
<ul>
<li>Имя представления: <code>ipsec-sts</code>.</li>
<li>Алгоритм аутентификации: <code>sha256</code>.</li>
<li>Алгоритм шифрования: <code>aes-256-cbc</code>.</li>
<li>Группа Diffie-Hellman (стойкость шифрования): <code>ecp384</code>.</li>
</ul>
</li>
</ul>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-9
shortcode-codeblock-text">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-087cbee4af894b9275f9273d0eca347f" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-text" data-lang="text"><span class="line"><span class="cl">/ip ipsec proposal
</span></span><span class="line"><span class="cl">add auth-algorithms=sha256 enc-algorithms=aes-256-cbc name=ipsec-sts pfs-group=ecp384</span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-087cbee4af894b9275f9273d0eca347f"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<ul>
<li>Добавляем <span class="shortcode shortcode-tag"><a href="/ru/tags/ipsec/" target="_blank">#IPsec</a></span> peer:
<ul>
<li>Имя peer&rsquo;а: <code>GW1</code>.</li>
<li>Внешний адрес <code>R1</code>: <code>gw1.example.com</code>.</li>
<li>Профиль: <code>ipsec-sts</code>.</li>
<li>Режим обмена: <code>ike2</code>.</li>
<li>Комментарий: <code>GW1</code>.</li>
</ul>
</li>
</ul>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-10
shortcode-codeblock-text">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-b29c5877c9b1b7a5adfb3776e9264492" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-text" data-lang="text"><span class="line"><span class="cl">/ip ipsec peer
</span></span><span class="line"><span class="cl">add address=&#34;gw1.example.com&#34; exchange-mode=ike2 name=GW1 profile=ipsec-sts comment=&#34;GW1&#34;</span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-b29c5877c9b1b7a5adfb3776e9264492"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<ul>
<li>Добавляем идентификацию:
<ul>
<li>Peer: <code>GW1</code>.</li>
<li>Секретная фраза: <code>PassWord</code>.<br>
<em>Секретная фраза должна быть одинаковой на обоих маршрутизаторах.</em></li>
<li>Комментарий: <code>GW1</code>.</li>
</ul>
</li>
</ul>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-11
shortcode-codeblock-text">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-2a4c00039db6ad46723f69b8aab0fc87" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-text" data-lang="text"><span class="line"><span class="cl">/ip ipsec identity
</span></span><span class="line"><span class="cl">add peer=GW1 secret=&#34;PassWord&#34; comment=&#34;GW1&#34;</span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-2a4c00039db6ad46723f69b8aab0fc87"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<ul>
<li>Добавляем политику <span class="shortcode shortcode-tag"><a href="/ru/tags/ipsec/" target="_blank">#IPsec</a></span>:
<ul>
<li>Peer: <code>GW1</code>.</li>
<li>Туннель: <code>yes</code>.</li>
<li>Адрес локальной сети <code>R2</code>: <code>10.2.0.0/16</code>.</li>
<li>Адрес удалённой сети <code>R1</code>: <code>10.1.0.0/16</code>.</li>
<li>Действие: <code>encrypt</code>.</li>
<li>Представление: <code>ipsec-sts</code>.</li>
<li>Комментарий: <code>GW2-GW1</code>.</li>
</ul>
</li>
</ul>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-12
shortcode-codeblock-text">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-925dcd123a0e083e9ce62834684e3159" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-text" data-lang="text"><span class="line"><span class="cl">/ip ipsec policy
</span></span><span class="line"><span class="cl">add src-address=10.2.0.0/16 dst-address=10.1.0.0/16 tunnel=yes action=encrypt proposal=ipsec-sts peer=GW1 comment=&#34;GW2-GW1&#34;</span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-925dcd123a0e083e9ce62834684e3159"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<ul>
<li>Исключаем обработку трафика <span class="shortcode shortcode-tag"><a href="/ru/tags/ipsec/" target="_blank">#IPsec</a></span>:
<ul>
<li>Адрес локальной сети <code>R2</code>: <code>10.2.0.0/16</code>.</li>
<li>Адрес удалённой сети <code>R1</code>: <code>10.1.0.0/16</code>.</li>
<li>Комментарий: <code>[IPsec] GW2-GW1</code>.</li>
</ul>
</li>
</ul>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-13
shortcode-codeblock-text">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-ae76f4b8ec86b6fab5a3c5d0bf45e9a6" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-text" data-lang="text"><span class="line"><span class="cl">/ip firewall nat
</span></span><span class="line"><span class="cl">add chain=srcnat action=accept src-address=10.2.0.0/16 dst-address=10.1.0.0/16 place-before=0 comment=&#34;[IPsec] GW2-GW1&#34;</span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-ae76f4b8ec86b6fab5a3c5d0bf45e9a6"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<ul>
<li>Настраивает фильтры брандмауэра:
<ul>
<li>Открыть порты <code>500</code> и <code>4500</code> по протоколу <code>UDP</code>.</li>
<li>Разрешить трафик по протоколу <code>ipsec-esp</code>.</li>
</ul>
</li>
</ul>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-14
shortcode-codeblock-text">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-b7742e07c90d90b9a86d9dfa351202b7" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-text" data-lang="text"><span class="line"><span class="cl">/ip firewall filter
</span></span><span class="line"><span class="cl">add action=accept chain=input dst-port=500,4500 in-interface-list=WAN protocol=udp comment=&#34;[ROS] IPsec&#34;
</span></span><span class="line"><span class="cl">add action=accept chain=input in-interface-list=WAN protocol=ipsec-esp comment=&#34;[ROS] IPsec&#34;</span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-b7742e07c90d90b9a86d9dfa351202b7"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<ul>
<li>Настраиваем обход отслеживания соединений <span class="shortcode shortcode-tag"><a href="/ru/tags/ipsec/" target="_blank">#IPsec</a></span> для снижения нагрузки на CPU маршрутизатора:
<ul>
<li>Пакеты из удалённой сети <code>R1</code> <code>10.1.0.0/16</code> в локальную сеть <code>R2</code> <code>10.2.0.0/16</code>.</li>
<li>Пакеты из локальной сети <code>R2</code> <code>10.2.0.0/16</code> в удалённую сеть <code>R1</code> <code>10.1.0.0/16</code>.</li>
</ul>
</li>
</ul>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-15
shortcode-codeblock-text">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-a0a7695c701f0bf596b5417356dcd908" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-text" data-lang="text"><span class="line"><span class="cl">/ip firewall raw
</span></span><span class="line"><span class="cl">add action=notrack chain=prerouting src-address=10.1.0.0/16 dst-address=10.2.0.0/16 comment=&#34;[IPsec] GW1-GW2&#34;
</span></span><span class="line"><span class="cl">add action=notrack chain=prerouting src-address=10.2.0.0/16 dst-address=10.1.0.0/16 comment=&#34;[IPsec] GW2-GW1&#34;</span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-a0a7695c701f0bf596b5417356dcd908"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<h2 id="автоматизация">
  <a class="link-body-emphasis" href="#%d0%b0%d0%b2%d1%82%d0%be%d0%bc%d0%b0%d1%82%d0%b8%d0%b7%d0%b0%d1%86%d0%b8%d1%8f">Автоматизация</a>
</h2><p>Сделал небольшой скрипт, который позволяет быстро развернуть туннель между двумя маршрутизаторами. Скрипт запускается отдельно на каждом из маршрутизаторов со своими настройками.</p>

    

    
        
            
            <div class="shortcode shortcode-file mb-3">
              <div class="card overflow-hidden" data-bs-theme="dark">
                <div class="card-header">
                  <div class="d-flex align-items-center">
                    <div class="flex-shrink-0">
                      <i class="far fa-file-code fa-fw"></i>
                    </div>
                    <div class="flex-grow-1 mx-2 text-truncate">
                      <code>ros.ipsec.rsc</code>
                    </div>
                    <div class="flex-shrink-0">
                      <ul class="list-inline mb-0">
                        <li class="list-inline-item" title='Копировать'>
                          <a class="text-body" href="#"
                             data-fn="clipboard" data-clipboard-target="#cp-fa0710341bca83d2af35cfde64688bd0"
                             role="button" aria-label='Копировать'>
                            <i class="fas fa-copy fa-fw"></i>
                          </a>
                        </li>
                        <li class="list-inline-item" title='Скачать'>
                          <a class="text-body" href="/ru/2024/03/54a2b39f-38b4-5f0c-9b54-310f853da38f/ros.ipsec.rsc" download
                             role="button" aria-label='Скачать'>
                            <i class="fas fa-download fa-fw"></i>
                          </a>
                        </li>
                        <li class="list-inline-item" title='Открыть'>
                          <a class="text-body" href="/ru/2024/03/54a2b39f-38b4-5f0c-9b54-310f853da38f/ros.ipsec.rsc" target="_blank"
                             role="button" aria-label='Открыть'>
                            <i class="fas fa-arrow-up-right-from-square fa-fw"></i>
                          </a>
                        </li>
                      </ul>
                    </div>
                  </div>
                </div>
                <div class="card-body p-0 overflow-auto" id="cp-fa0710341bca83d2af35cfde64688bd0">
                    
                    <div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span><span class="lnt">56
</span><span class="lnt">57
</span><span class="lnt">58
</span><span class="lnt">59
</span><span class="lnt">60
</span><span class="lnt">61
</span><span class="lnt">62
</span><span class="lnt">63
</span><span class="lnt">64
</span><span class="lnt">65
</span><span class="lnt">66
</span><span class="lnt">67
</span><span class="lnt">68
</span><span class="lnt">69
</span><span class="lnt">70
</span><span class="lnt">71
</span><span class="lnt">72
</span><span class="lnt">73
</span><span class="lnt">74
</span><span class="lnt">75
</span><span class="lnt">76
</span><span class="lnt">77
</span><span class="lnt">78
</span><span class="lnt">79
</span><span class="lnt">80
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-text" data-lang="text"><span class="line"><span class="cl"># @package    MikroTik / RouterOS / IPsec
</span></span><span class="line"><span class="cl"># @author     Kai Kimera &lt;mail@kai.kim&gt;
</span></span><span class="line"><span class="cl"># @copyright  2024 Library Online
</span></span><span class="line"><span class="cl"># @license    MIT
</span></span><span class="line"><span class="cl"># @version    0.1.0
</span></span><span class="line"><span class="cl"># @link       https://lib.onl/ru/2024/03/54a2b39f-38b4-5f0c-9b54-310f853da38f/
</span></span><span class="line"><span class="cl"># -------------------------------------------------------------------------------------------------------------------- #
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"># IPsec secret phrase.
</span></span><span class="line"><span class="cl">:local ipsSecret &#34;PassWord&#34;
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"># IPsec external interface.
</span></span><span class="line"><span class="cl">:local ipsInterface &#34;WAN&#34;
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"># IPsec profile name.
</span></span><span class="line"><span class="cl">:local ipsProfileName &#34;ipsec-sts&#34;
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"># -------------------------------------------------------------------------------------------------------------------- #
</span></span><span class="line"><span class="cl"># Local router.
</span></span><span class="line"><span class="cl"># -------------------------------------------------------------------------------------------------------------------- #
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"># Local router name.
</span></span><span class="line"><span class="cl">:local ipsLocalName &#34;GW1&#34;
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"># Local network address.
</span></span><span class="line"><span class="cl">:local ipsLocalNetwork &#34;10.1.0.0/16&#34;
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"># -------------------------------------------------------------------------------------------------------------------- #
</span></span><span class="line"><span class="cl"># Remote router.
</span></span><span class="line"><span class="cl"># -------------------------------------------------------------------------------------------------------------------- #
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"># Remote router name.
</span></span><span class="line"><span class="cl">:local ipsRemoteName &#34;GW2&#34;
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"># Remote network address.
</span></span><span class="line"><span class="cl">:local ipsRemoteNetwork &#34;10.2.0.0/16&#34;
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"># Remote external IP address.
</span></span><span class="line"><span class="cl">:local ipsRemoteWanIp &#34;gw2.example.com&#34;
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"># -------------------------------------------------------------------------------------------------------------------- #
</span></span><span class="line"><span class="cl"># -----------------------------------------------------&lt; SCRIPT &gt;----------------------------------------------------- #
</span></span><span class="line"><span class="cl"># -------------------------------------------------------------------------------------------------------------------- #
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">/ip ipsec profile
</span></span><span class="line"><span class="cl">add dh-group=ecp384 enc-algorithm=aes-256 name=$ipsProfileName
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">/ip ipsec proposal
</span></span><span class="line"><span class="cl">add auth-algorithms=sha256 enc-algorithms=aes-256-cbc pfs-group=ecp384 name=$ipsProfileName
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">/ip ipsec peer
</span></span><span class="line"><span class="cl">add address=$ipsRemoteWanIp exchange-mode=ike2 name=$ipsRemoteName profile=$ipsProfileName \
</span></span><span class="line"><span class="cl">  comment=&#34;$ipsRemoteName&#34;
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">/ip ipsec identity
</span></span><span class="line"><span class="cl">add peer=$ipsRemoteName secret=&#34;$ipsSecret&#34; \
</span></span><span class="line"><span class="cl">  comment=&#34;$ipsRemoteName&#34;
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">/ip ipsec policy
</span></span><span class="line"><span class="cl">add src-address=$ipsLocalNetwork dst-address=$ipsRemoteNetwork tunnel=yes action=encrypt \
</span></span><span class="line"><span class="cl">  proposal=$ipsProfileName peer=$ipsRemoteName \
</span></span><span class="line"><span class="cl">  comment=&#34;$ipsLocalName-$ipsRemoteName&#34;
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">/ip firewall nat
</span></span><span class="line"><span class="cl">add chain=srcnat action=accept src-address=$ipsLocalNetwork dst-address=$ipsRemoteNetwork place-before=0 \
</span></span><span class="line"><span class="cl">  comment=&#34;[IPsec] $ipsLocalName-$ipsRemoteName&#34;
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">/ip firewall filter
</span></span><span class="line"><span class="cl">add action=accept chain=input dst-port=500,4500 in-interface-list=$ipsWan protocol=udp \
</span></span><span class="line"><span class="cl">  comment=&#34;[ROS] IPsec&#34;
</span></span><span class="line"><span class="cl">add action=accept chain=input in-interface-list=$ipsWan protocol=ipsec-esp \
</span></span><span class="line"><span class="cl">  comment=&#34;[ROS] IPsec&#34;
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"># Use IP/Firewall/Raw to bypass connection tracking, that way eliminating need of filter rules and reducing load on CPU
</span></span><span class="line"><span class="cl"># by approximately 30%.
</span></span><span class="line"><span class="cl">/ip firewall raw
</span></span><span class="line"><span class="cl">add action=notrack chain=prerouting src-address=$ipsRemoteNetwork dst-address=$ipsLocalNetwork \
</span></span><span class="line"><span class="cl">  comment=&#34;[IPsec] $ipsRemoteName-$ipsLocalName&#34;
</span></span><span class="line"><span class="cl">add action=notrack chain=prerouting src-address=$ipsLocalNetwork dst-address=$ipsRemoteNetwork \
</span></span><span class="line"><span class="cl">  comment=&#34;[IPsec] $ipsLocalName-$ipsRemoteName&#34;</span></span></code></pre></td></tr></table>
</div>
</div>
                </div>
              </div>
            </div>]]></turbo:content></item><item turbo="true"><title>Cisco: Обновление IOS</title><link>https://lib.onl/ru/2024/03/b81f9cca-d723-5b72-929a-b88be9d329f9/</link><pubDate>Wed, 27 Mar 2024 18:41:49 +0000</pubDate><dc:creator>Kai Kimera</dc:creator><category>Сеть</category><category>Терминал</category><yandex:related><link url="https://lib.onl/ru/2024/03/4a7addb9-eff3-5482-902c-791fbe49899f/">Cisco: Загрузка и выгрузка конфигурации</link><link url="https://lib.onl/ru/2024/03/fc67eb74-8f7c-5de3-bd1e-2d823208eae2/">Cisco: Сброс пароля</link><link url="https://lib.onl/ru/2021/05/0acd3f9d-07b7-52b8-9fac-b5cb1cc579e0/">Обновление Fedora Linux до актуальной версии</link></yandex:related><turbo:extendedHtml>true</turbo:extendedHtml><turbo:source>https://lib.onl/ru/2024/03/b81f9cca-d723-5b72-929a-b88be9d329f9/</turbo:source><turbo:topic>Cisco: Обновление IOS</turbo:topic><turbo:content><![CDATA[<p>Инструкция по резервному копированию и обновлению <span class="shortcode shortcode-tag"><a href="/ru/tags/cisco/" target="_blank">#Cisco</a></span> <span class="shortcode shortcode-tag"><a href="/ru/tags/ios/" target="_blank">#IOS</a></span>.</p>
<h2 id="общая-настройка">
  <a class="link-body-emphasis" href="#%d0%be%d0%b1%d1%89%d0%b0%d1%8f-%d0%bd%d0%b0%d1%81%d1%82%d1%80%d0%be%d0%b9%d0%ba%d0%b0">Общая настройка</a>
</h2><p>Необходимо предварительно настроить сетевой интерфейс компьютера со следующими параметрами:</p>
<ul>
<li>IP-адрес: <code>192.168.1.2</code>.</li>
<li>Маска подсети: <code>255.255.255.0</code>.</li>
<li>Шлюз: <code>192.168.1.1</code>.</li>
<li>DNS: <code>8.8.8.8</code>.</li>
</ul>
<p>Теперь настроим сетевой интерфейс <code>FE0/1</code> на <span class="shortcode shortcode-tag"><a href="/ru/tags/cisco/" target="_blank">#Cisco</a></span>:</p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-0
shortcode-codeblock-plaintext">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-9058b16d2f4d9c60e90d6aec57e3ce81" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-plaintext" data-lang="plaintext"><span class="line"><span class="cl"># conf t
</span></span><span class="line"><span class="cl">(config)# int fa0/1
</span></span><span class="line"><span class="cl">(config-if)# ip address 192.168.1.1 255.255.255.0
</span></span><span class="line"><span class="cl">(config-if)# no shutdown
</span></span><span class="line"><span class="cl">(config-if)# exit
</span></span><span class="line"><span class="cl">(config)# exit
</span></span><span class="line"><span class="cl">#</span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-9058b16d2f4d9c60e90d6aec57e3ce81"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<p>После предварительных настроек, подключим сетевой интерфейс компьютера к сетевому интерфейсу <span class="shortcode shortcode-tag"><a href="/ru/tags/cisco/" target="_blank">#Cisco</a></span> <code>FE0/1</code> и запустим TFTP-сервер на компьютере c IP <code>192.168.1.2</code>.</p>
<h2 id="резервное-копирование-текущего-образа-ios">
  <a class="link-body-emphasis" href="#%d1%80%d0%b5%d0%b7%d0%b5%d1%80%d0%b2%d0%bd%d0%be%d0%b5-%d0%ba%d0%be%d0%bf%d0%b8%d1%80%d0%be%d0%b2%d0%b0%d0%bd%d0%b8%d0%b5-%d1%82%d0%b5%d0%ba%d1%83%d1%89%d0%b5%d0%b3%d0%be-%d0%be%d0%b1%d1%80%d0%b0%d0%b7%d0%b0-ios">Резервное копирование текущего образа IOS</a>
</h2><p>Смотрим текущую версию <span class="shortcode shortcode-tag"><a href="/ru/tags/ios/" target="_blank">#IOS</a></span>:</p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-1
shortcode-codeblock-plaintext">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-b4a1bbc96d3e844f4d92adc1627dee1b" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-plaintext" data-lang="plaintext"><span class="line"><span class="cl"># show version</span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-b4a1bbc96d3e844f4d92adc1627dee1b"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<p>На всякий случай, делаем резервную копию текущего образа <span class="shortcode shortcode-tag"><a href="/ru/tags/ios/" target="_blank">#IOS</a></span> на TFTP-сервер:</p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-2
shortcode-codeblock-plaintext">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-ae7f5100d6d2dafb61f455513842c4a2" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-plaintext" data-lang="plaintext"><span class="line"><span class="cl"># show flash: | include .bin
</span></span><span class="line"><span class="cl"># copy flash:IOS_FW.bin tftp://192.168.1.2</span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-ae7f5100d6d2dafb61f455513842c4a2"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<p>Где:</p>
<ul>
<li><code>flash:IOS_FW.bin</code> - источник, файл текущего образа <span class="shortcode shortcode-tag"><a href="/ru/tags/ios/" target="_blank">#IOS</a></span> на flash-карте (<code>IOS_FW.bin</code>).</li>
<li><code>tftp://192.168.1.2</code> - назначение, IP-адрес TFTP-сервера.</li>
</ul>
<h2 id="загрузка-нового-образа-ios">
  <a class="link-body-emphasis" href="#%d0%b7%d0%b0%d0%b3%d1%80%d1%83%d0%b7%d0%ba%d0%b0-%d0%bd%d0%be%d0%b2%d0%be%d0%b3%d0%be-%d0%be%d0%b1%d1%80%d0%b0%d0%b7%d0%b0-ios">Загрузка нового образа IOS</a>
</h2><p>Загружаем на флэш-карту новый образ <span class="shortcode shortcode-tag"><a href="/ru/tags/ios/" target="_blank">#IOS</a></span>:</p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-3
shortcode-codeblock-plaintext">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-6e9f5128cfafca47fcebc05ce6570c3b" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-plaintext" data-lang="plaintext"><span class="line"><span class="cl"># copy tftp://192.168.1.2/IOS_FW.bin flash:</span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-6e9f5128cfafca47fcebc05ce6570c3b"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<p>Где:</p>
<ul>
<li><code>tftp://192.168.1.2/IOS_FW.bin</code> - источник, адрес TFTP-сервера и путь к файлу с образом <span class="shortcode shortcode-tag"><a href="/ru/tags/ios/" target="_blank">#IOS</a></span> (<code>IOS_FW.bin</code>).</li>
<li><code>flash:</code> - назначение, flash-карта.</li>
</ul>
<h2 id="верификация-нового-образа-ios">
  <a class="link-body-emphasis" href="#%d0%b2%d0%b5%d1%80%d0%b8%d1%84%d0%b8%d0%ba%d0%b0%d1%86%d0%b8%d1%8f-%d0%bd%d0%be%d0%b2%d0%be%d0%b3%d0%be-%d0%be%d0%b1%d1%80%d0%b0%d0%b7%d0%b0-ios">Верификация нового образа IOS</a>
</h2><p>Проверяем контрольную сумму загруженного образа <span class="shortcode shortcode-tag"><a href="/ru/tags/ios/" target="_blank">#IOS</a></span>:</p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-4
shortcode-codeblock-plaintext">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-a5ff0a751d25ee3b6282cb351b2d6435" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-plaintext" data-lang="plaintext"><span class="line"><span class="cl"># show flash: | include .bin
</span></span><span class="line"><span class="cl"># verify /md5 flash:IOS_FW.bin</span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-a5ff0a751d25ee3b6282cb351b2d6435"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<p>Где:</p>
<ul>
<li><code>flash:IOS_FW.bin</code> - образ <span class="shortcode shortcode-tag"><a href="/ru/tags/ios/" target="_blank">#IOS</a></span> (<code>IOS_FW.bin</code>) на flash-карте.</li>
</ul>
<h2 id="обновление-ios">
  <a class="link-body-emphasis" href="#%d0%be%d0%b1%d0%bd%d0%be%d0%b2%d0%bb%d0%b5%d0%bd%d0%b8%d0%b5-ios">Обновление IOS</a>
</h2>



    








    
    






<div class="shortcode shortcode-alert">
  <div class="alert alert-warning d-flex overflow-hidden" role="alert">
    <div class="flex-shrink-0 align-self-center">
      <i class="fas fa-exclamation-triangle fa-fw fa-2x"></i>
    </div>
    <div class="flex-grow-1 ms-3 overflow-hidden">
        <p>Перед обновлением рекомендуется сделать резервную копию лицензий:</p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-0
shortcode-codeblock-plaintext">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-6224622b4ef5fd1b7330dd271427f30a" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-plaintext" data-lang="plaintext"><span class="line"><span class="cl"># license save flash:ALL_LICENSE.lic</span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-6224622b4ef5fd1b7330dd271427f30a"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>



    </div>
  </div>
</div>

<p>Прописываем в конфигурации <span class="shortcode shortcode-tag"><a href="/ru/tags/cisco/" target="_blank">#Cisco</a></span> загрузку нового образа <span class="shortcode shortcode-tag"><a href="/ru/tags/ios/" target="_blank">#IOS</a></span> и перезагружаем оборудование:</p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-5
shortcode-codeblock-plaintext">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-2b933a59269901e180edb483547a34e4" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-plaintext" data-lang="plaintext"><span class="line"><span class="cl"># conf t
</span></span><span class="line"><span class="cl">(config)# boot system flash IOS_FW.bin
</span></span><span class="line"><span class="cl">(config)# exit
</span></span><span class="line"><span class="cl"># reload</span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-2b933a59269901e180edb483547a34e4"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<p>Где:</p>
<ul>
<li><code>flash:IOS_FW.bin</code> - образ <span class="shortcode shortcode-tag"><a href="/ru/tags/ios/" target="_blank">#IOS</a></span> (<code>IOS_FW.bin</code>) на flash-карте.</li>
</ul>
<h2 id="проверка-новой-версии-ios">
  <a class="link-body-emphasis" href="#%d0%bf%d1%80%d0%be%d0%b2%d0%b5%d1%80%d0%ba%d0%b0-%d0%bd%d0%be%d0%b2%d0%be%d0%b9-%d0%b2%d0%b5%d1%80%d1%81%d0%b8%d0%b8-ios">Проверка новой версии IOS</a>
</h2><p>После перезагрузки смотрим версию <span class="shortcode shortcode-tag"><a href="/ru/tags/ios/" target="_blank">#IOS</a></span>:</p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-6
shortcode-codeblock-plaintext">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-870ebc07f6c5fbc8d0f8274767d9eeca" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-plaintext" data-lang="plaintext"><span class="line"><span class="cl"># show version</span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-870ebc07f6c5fbc8d0f8274767d9eeca"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<p>Готово!</p>]]></turbo:content></item><item turbo="true"><title>Проверка DNS-записей домена</title><link>https://lib.onl/ru/2024/03/bd4f198b-907e-5c14-90c6-a7c032891ce0/</link><pubDate>Wed, 27 Mar 2024 14:25:34 +0000</pubDate><dc:creator>Kai Kimera</dc:creator><category>Сеть</category><category>Linux</category><category>MS Windows</category><yandex:related><link url="https://lib.onl/ru/2022/08/badb30a9-0471-5dab-a422-85422c0ac611/">Включение DNS over TLS (DoT) в OPNsense</link><link url="https://lib.onl/ru/2021/05/ee559a6c-5cde-5166-9d2d-3ceb55878eb8/">Debian: Статический IP-адрес</link></yandex:related><turbo:extendedHtml>true</turbo:extendedHtml><turbo:source>https://lib.onl/ru/2024/03/bd4f198b-907e-5c14-90c6-a7c032891ce0/</turbo:source><turbo:topic>Проверка DNS-записей домена</turbo:topic><turbo:content><![CDATA[<p>Когда требуется узнать информацию о домене, можно воспользоваться локальными утилитами для диагностики его DNS-записей.</p>
<h2 id="общая-информация">
  <a class="link-body-emphasis" href="#%d0%be%d0%b1%d1%89%d0%b0%d1%8f-%d0%b8%d0%bd%d1%84%d0%be%d1%80%d0%bc%d0%b0%d1%86%d0%b8%d1%8f">Общая информация</a>
</h2><p>Рассмотрим запросы общей информации по доменам.</p>
<h3 id="dig">
  <a class="link-body-emphasis" href="#dig">Dig</a>
</h3><p>Получить общую информацию по домену в <code>Dig</code>:</p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-0
shortcode-codeblock-bash">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-edfaa216aa55292184d9229a0be27baf" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">dig example.com</span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-edfaa216aa55292184d9229a0be27baf"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<p>Результат запроса:</p>











<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-1 shortcode-codeblock-terminal
shortcode-codeblock-terminal-linux
shortcode-codeblock-terminal-linux-user">
  <div class="card overflow-hidden" data-bs-theme="dark">
    <div class="card-header">
      <div class="d-flex align-items-center">
        <div class="flex-shrink-0 ">
          <i class="fas fa-terminal fa-fw"></i>
        </div>
        <div class="flex-grow-1 mx-2">
          <h5 class="mb-0">Терминал</h5>
        </div>
        <div class="flex-shrink-0">
          <ul class="list-inline mb-0">
            <li class="list-inline-item" title='Копировать'>
              <a class="text-body" href="#"
                 data-fn="clipboard" data-clipboard-target="#cp-0cac88db7af34df3db4d2d7c78936a0d"
                 role="button" aria-label='Копировать'>
                <i class="fas fa-copy fa-fw"></i>
              </a>
            </li>
          </ul>
        </div>
      </div>
    </div>
    <div class="card-body p-0 overflow-auto" id="cp-0cac88db7af34df3db4d2d7c78936a0d"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-dns" data-lang="dns"><span class="line"><span class="cl"><span class="nc">dig</span><span class="w"> </span><span class="nc">google.com</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c">; &lt;&lt;&gt;&gt; DiG 9.18.24-1-Debian &lt;&lt;&gt;&gt; google.com</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c">;; global options: +cmd</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c">;; Got answer:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c">;; -&gt;&gt;HEADER&lt;&lt;- opcode: QUERY, status: NOERROR, id: 19217</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c">;; flags: qr rd ra; QUERY: 1, ANSWER: 6, AUTHORITY: 0, ADDITIONAL: 1</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c">;; OPT PSEUDOSECTION:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c">; EDNS: version: 0, flags:; udp: 4000</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c">;; QUESTION SECTION:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c">;google.com.                    IN      A</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c">;; ANSWER SECTION:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="py">google.com. </span><span class="w">            </span><span class="sc">112</span><span class="w">     </span><span class="k">IN</span><span class="w">      </span><span class="k">A</span><span class="w">       </span><span class="mi">173.194.222.101</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="py">google.com. </span><span class="w">            </span><span class="sc">112</span><span class="w">     </span><span class="k">IN</span><span class="w">      </span><span class="k">A</span><span class="w">       </span><span class="mi">173.194.222.139</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="py">google.com. </span><span class="w">            </span><span class="sc">112</span><span class="w">     </span><span class="k">IN</span><span class="w">      </span><span class="k">A</span><span class="w">       </span><span class="mi">173.194.222.113</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="py">google.com. </span><span class="w">            </span><span class="sc">112</span><span class="w">     </span><span class="k">IN</span><span class="w">      </span><span class="k">A</span><span class="w">       </span><span class="mi">173.194.222.138</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="py">google.com. </span><span class="w">            </span><span class="sc">112</span><span class="w">     </span><span class="k">IN</span><span class="w">      </span><span class="k">A</span><span class="w">       </span><span class="mi">173.194.222.100</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="py">google.com. </span><span class="w">            </span><span class="sc">112</span><span class="w">     </span><span class="k">IN</span><span class="w">      </span><span class="k">A</span><span class="w">       </span><span class="mi">173.194.222.102</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c">;; Query time: 4 msec</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c">;; SERVER: 172.16.18.22#53(172.16.18.22) (UDP)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c">;; WHEN: Mon Apr 15 09:14:51 UTC 2024</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c">;; MSG SIZE  rcvd: 135</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
  </div>
</div>
<p>Где:</p>
<ul>
<li><code>;; SERVER: 172.16.18.22#53(172.16.18.22) (UDP)</code> - сервер DNS, с которого пришёл ответ.</li>
</ul>
<h3 id="drill">
  <a class="link-body-emphasis" href="#drill">Drill</a>
</h3><p>Получить общую информацию по домену в <code>Drill</code>:</p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-2
shortcode-codeblock-bash">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-f0bc95be09cbdc975996689a3e9fd6ce" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">drill example.com</span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-f0bc95be09cbdc975996689a3e9fd6ce"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<p>Результат запроса:</p>











<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-3 shortcode-codeblock-terminal
shortcode-codeblock-terminal-linux
shortcode-codeblock-terminal-linux-user">
  <div class="card overflow-hidden" data-bs-theme="dark">
    <div class="card-header">
      <div class="d-flex align-items-center">
        <div class="flex-shrink-0 ">
          <i class="fas fa-terminal fa-fw"></i>
        </div>
        <div class="flex-grow-1 mx-2">
          <h5 class="mb-0">Терминал</h5>
        </div>
        <div class="flex-shrink-0">
          <ul class="list-inline mb-0">
            <li class="list-inline-item" title='Копировать'>
              <a class="text-body" href="#"
                 data-fn="clipboard" data-clipboard-target="#cp-ef7a6ab97b7805a7f2273a8f5f1b7319"
                 role="button" aria-label='Копировать'>
                <i class="fas fa-copy fa-fw"></i>
              </a>
            </li>
          </ul>
        </div>
      </div>
    </div>
    <div class="card-body p-0 overflow-auto" id="cp-ef7a6ab97b7805a7f2273a8f5f1b7319"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-dns" data-lang="dns"><span class="line"><span class="cl"><span class="nc">drill</span><span class="w"> </span><span class="nc">google.com</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c">;; -&gt;&gt;HEADER&lt;&lt;- opcode: QUERY, rcode: NOERROR, id: 45117</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c">;; flags: qr rd ra ; QUERY: 1, ANSWER: 1, AUTHORITY: 0, ADDITIONAL: 0</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c">;; QUESTION SECTION:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c">;; google.com.  IN      A</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c">;; ANSWER SECTION:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="py">google.com. </span><span class="w">    </span><span class="sc">184</span><span class="w">     </span><span class="k">IN</span><span class="w">      </span><span class="k">A</span><span class="w">       </span><span class="mi">216.58.210.142</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c">;; AUTHORITY SECTION:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c">;; ADDITIONAL SECTION:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c">;; Query time: 3 msec</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c">;; SERVER: 10.1.0.1</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c">;; WHEN: Wed Mar 27 17:41:27 2024</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c">;; MSG SIZE  rcvd: 44</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
  </div>
</div>
<p>Где:</p>
<ul>
<li><code>;; SERVER: 172.16.18.22#53(172.16.18.22) (UDP)</code> - сервер DNS, с которого пришёл ответ.</li>
</ul>
<h3 id="nslookup">
  <a class="link-body-emphasis" href="#nslookup">NSLookUp</a>
</h3><p>Получить общую информацию по домену в <code>NSLookUp</code>:</p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-4
shortcode-codeblock-bash">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-491bc6ca7c4645f720410405f8343a15" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">nslookup example.com</span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-491bc6ca7c4645f720410405f8343a15"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<p>Результат запроса:</p>











<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-5 shortcode-codeblock-terminal
shortcode-codeblock-terminal-linux
shortcode-codeblock-terminal-linux-user">
  <div class="card overflow-hidden" data-bs-theme="dark">
    <div class="card-header">
      <div class="d-flex align-items-center">
        <div class="flex-shrink-0 ">
          <i class="fas fa-terminal fa-fw"></i>
        </div>
        <div class="flex-grow-1 mx-2">
          <h5 class="mb-0">Терминал</h5>
        </div>
        <div class="flex-shrink-0">
          <ul class="list-inline mb-0">
            <li class="list-inline-item" title='Копировать'>
              <a class="text-body" href="#"
                 data-fn="clipboard" data-clipboard-target="#cp-84304c5e257727337b0ee75c5267f570"
                 role="button" aria-label='Копировать'>
                <i class="fas fa-copy fa-fw"></i>
              </a>
            </li>
          </ul>
        </div>
      </div>
    </div>
    <div class="card-body p-0 overflow-auto" id="cp-84304c5e257727337b0ee75c5267f570"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-dns" data-lang="dns"><span class="line"><span class="cl"><span class="nc">nslookup</span><span class="w"> </span><span class="nc">google.com</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nc">Server</span><span class="err">:</span><span class="w">         </span><span class="mi">172.16.18.22</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nc">Address</span><span class="err">:</span><span class="w">        </span><span class="mi">172.16.18.22</span><span class="err">#</span><span class="sc">53</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nc">Non-authoritative</span><span class="w"> </span><span class="err">answer:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nc">Name</span><span class="err">:</span><span class="w">   </span><span class="nc">google.com</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nc">Address</span><span class="err">:</span><span class="w"> </span><span class="mi">173.194.222.138</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nc">Name</span><span class="err">:</span><span class="w">   </span><span class="nc">google.com</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nc">Address</span><span class="err">:</span><span class="w"> </span><span class="mi">173.194.222.101</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nc">Name</span><span class="err">:</span><span class="w">   </span><span class="nc">google.com</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nc">Address</span><span class="err">:</span><span class="w"> </span><span class="mi">173.194.222.100</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nc">Name</span><span class="err">:</span><span class="w">   </span><span class="nc">google.com</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nc">Address</span><span class="err">:</span><span class="w"> </span><span class="mi">173.194.222.102</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nc">Name</span><span class="err">:</span><span class="w">   </span><span class="nc">google.com</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nc">Address</span><span class="err">:</span><span class="w"> </span><span class="mi">173.194.222.113</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nc">Name</span><span class="err">:</span><span class="w">   </span><span class="nc">google.com</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nc">Address</span><span class="err">:</span><span class="w"> </span><span class="mi">173.194.222.139</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nc">Name</span><span class="err">:</span><span class="w">   </span><span class="nc">google.com</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nc">Address</span><span class="err">:</span><span class="w"> </span><span class="il">2a00:1450:4010:c0b::71</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nc">Name</span><span class="err">:</span><span class="w">   </span><span class="nc">google.com</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nc">Address</span><span class="err">:</span><span class="w"> </span><span class="il">2a00:1450:4010:c0b::66</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nc">Name</span><span class="err">:</span><span class="w">   </span><span class="nc">google.com</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nc">Address</span><span class="err">:</span><span class="w"> </span><span class="il">2a00:1450:4010:c0b::64</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nc">Name</span><span class="err">:</span><span class="w">   </span><span class="nc">google.com</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nc">Address</span><span class="err">:</span><span class="w"> </span><span class="il">2a00:1450:4010:c0b::65</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
  </div>
</div>
<p>Где:</p>
<ul>
<li><code>Server: 172.16.18.22</code> - сервер DNS, с которого пришёл ответ.</li>
</ul>
<h2 id="информация-по-dns-записям">
  <a class="link-body-emphasis" href="#%d0%b8%d0%bd%d1%84%d0%be%d1%80%d0%bc%d0%b0%d1%86%d0%b8%d1%8f-%d0%bf%d0%be-dns-%d0%b7%d0%b0%d0%bf%d0%b8%d1%81%d1%8f%d0%bc">Информация по DNS-записям</a>
</h2><p>В отдельных случаях требуется получить информацию по конкретным DNS-записям домена.</p>
<h3 id="dig-1">
  <a class="link-body-emphasis" href="#dig-1">Dig</a>
</h3><p>Получить информацию по MX-записи домена в <code>Dig</code>:</p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-6
shortcode-codeblock-bash">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-52557b62992b5940ad59674eafb73e27" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">dig mx example.com</span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-52557b62992b5940ad59674eafb73e27"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<p>Результат запроса:</p>











<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-7 shortcode-codeblock-terminal
shortcode-codeblock-terminal-linux
shortcode-codeblock-terminal-linux-user">
  <div class="card overflow-hidden" data-bs-theme="dark">
    <div class="card-header">
      <div class="d-flex align-items-center">
        <div class="flex-shrink-0 ">
          <i class="fas fa-terminal fa-fw"></i>
        </div>
        <div class="flex-grow-1 mx-2">
          <h5 class="mb-0">Терминал</h5>
        </div>
        <div class="flex-shrink-0">
          <ul class="list-inline mb-0">
            <li class="list-inline-item" title='Копировать'>
              <a class="text-body" href="#"
                 data-fn="clipboard" data-clipboard-target="#cp-922a64b1d55ad88c57a09420db279eaa"
                 role="button" aria-label='Копировать'>
                <i class="fas fa-copy fa-fw"></i>
              </a>
            </li>
          </ul>
        </div>
      </div>
    </div>
    <div class="card-body p-0 overflow-auto" id="cp-922a64b1d55ad88c57a09420db279eaa"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-dns" data-lang="dns"><span class="line"><span class="cl"><span class="nc">dig</span><span class="w"> </span><span class="err">mx</span><span class="w"> </span><span class="nc">google.com</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c">; &lt;&lt;&gt;&gt; DiG 9.18.24-1-Debian &lt;&lt;&gt;&gt; mx google.com</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c">;; global options: +cmd</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c">;; Got answer:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c">;; -&gt;&gt;HEADER&lt;&lt;- opcode: QUERY, status: NOERROR, id: 61308</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c">;; flags: qr rd ra; QUERY: 1, ANSWER: 1, AUTHORITY: 0, ADDITIONAL: 10</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c">;; OPT PSEUDOSECTION:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c">; EDNS: version: 0, flags:; udp: 4000</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c">;; QUESTION SECTION:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c">;google.com.                    IN      MX</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c">;; ANSWER SECTION:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="py">google.com. </span><span class="w">            </span><span class="sc">300</span><span class="w">     </span><span class="k">IN</span><span class="w">      </span><span class="k">MX</span><span class="w">      </span><span class="sc">10</span><span class="w"> </span><span class="py">smtp.google.com.</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c">;; ADDITIONAL SECTION:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="py">smtp.google.com. </span><span class="w">       </span><span class="sc">300</span><span class="w">     </span><span class="k">IN</span><span class="w">      </span><span class="k">A</span><span class="w">       </span><span class="mi">64.233.161.26</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="py">smtp.google.com. </span><span class="w">       </span><span class="sc">300</span><span class="w">     </span><span class="k">IN</span><span class="w">      </span><span class="k">A</span><span class="w">       </span><span class="mi">64.233.162.27</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="py">smtp.google.com. </span><span class="w">       </span><span class="sc">300</span><span class="w">     </span><span class="k">IN</span><span class="w">      </span><span class="k">A</span><span class="w">       </span><span class="mi">64.233.163.26</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="py">smtp.google.com. </span><span class="w">       </span><span class="sc">300</span><span class="w">     </span><span class="k">IN</span><span class="w">      </span><span class="k">A</span><span class="w">       </span><span class="mi">64.233.163.27</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="py">smtp.google.com. </span><span class="w">       </span><span class="sc">300</span><span class="w">     </span><span class="k">IN</span><span class="w">      </span><span class="k">A</span><span class="w">       </span><span class="mi">173.194.220.26</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="py">smtp.google.com. </span><span class="w">       </span><span class="sc">300</span><span class="w">     </span><span class="k">IN</span><span class="w">      </span><span class="k">AAAA</span><span class="w">    </span><span class="il">2a00:1450:4010:c01::1b</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="py">smtp.google.com. </span><span class="w">       </span><span class="sc">300</span><span class="w">     </span><span class="k">IN</span><span class="w">      </span><span class="k">AAAA</span><span class="w">    </span><span class="il">2a00:1450:4010:c05::1b</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="py">smtp.google.com. </span><span class="w">       </span><span class="sc">300</span><span class="w">     </span><span class="k">IN</span><span class="w">      </span><span class="k">AAAA</span><span class="w">    </span><span class="il">2a00:1450:4010:c06::1a</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="py">smtp.google.com. </span><span class="w">       </span><span class="sc">300</span><span class="w">     </span><span class="k">IN</span><span class="w">      </span><span class="k">AAAA</span><span class="w">    </span><span class="il">2a00:1450:4010:c06::1b</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c">;; Query time: 48 msec</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c">;; SERVER: 172.16.18.22#53(172.16.18.22) (UDP)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c">;; WHEN: Mon Apr 15 09:17:29 UTC 2024</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c">;; MSG SIZE  rcvd: 252</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
  </div>
</div>
<p>Где:</p>
<ul>
<li><code>google.com. 300 IN MX 10 smtp.google.com.</code> - MX-запись домена <code>google.com</code>.</li>
</ul>
<h3 id="drill-1">
  <a class="link-body-emphasis" href="#drill-1">Drill</a>
</h3><p>Получить информацию по MX-записи домена в <code>Drill</code>:</p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-8
shortcode-codeblock-bash">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-ea4f03171d778a5774f2d3a990b481fa" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">drill mx example.com</span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-ea4f03171d778a5774f2d3a990b481fa"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<p>Результат запроса:</p>











<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-9 shortcode-codeblock-terminal
shortcode-codeblock-terminal-linux
shortcode-codeblock-terminal-linux-user">
  <div class="card overflow-hidden" data-bs-theme="dark">
    <div class="card-header">
      <div class="d-flex align-items-center">
        <div class="flex-shrink-0 ">
          <i class="fas fa-terminal fa-fw"></i>
        </div>
        <div class="flex-grow-1 mx-2">
          <h5 class="mb-0">Терминал</h5>
        </div>
        <div class="flex-shrink-0">
          <ul class="list-inline mb-0">
            <li class="list-inline-item" title='Копировать'>
              <a class="text-body" href="#"
                 data-fn="clipboard" data-clipboard-target="#cp-08fc00c48eaa860b5b6ecf362affcdb1"
                 role="button" aria-label='Копировать'>
                <i class="fas fa-copy fa-fw"></i>
              </a>
            </li>
          </ul>
        </div>
      </div>
    </div>
    <div class="card-body p-0 overflow-auto" id="cp-08fc00c48eaa860b5b6ecf362affcdb1"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-dns" data-lang="dns"><span class="line"><span class="cl"><span class="nc">drill</span><span class="w"> </span><span class="err">mx</span><span class="w"> </span><span class="nc">google.com</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c">;; -&gt;&gt;HEADER&lt;&lt;- opcode: QUERY, rcode: NOERROR, id: 51703</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c">;; flags: qr rd ra ; QUERY: 1, ANSWER: 1, AUTHORITY: 0, ADDITIONAL: 5</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c">;; QUESTION SECTION:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c">;; google.com.  IN      MX</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c">;; ANSWER SECTION:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="py">google.com. </span><span class="w">    </span><span class="sc">30</span><span class="w">      </span><span class="k">IN</span><span class="w">      </span><span class="k">MX</span><span class="w">      </span><span class="sc">10</span><span class="w"> </span><span class="py">smtp.google.com.</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c">;; AUTHORITY SECTION:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c">;; ADDITIONAL SECTION:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="py">smtp.google.com. </span><span class="w">       </span><span class="sc">30</span><span class="w">      </span><span class="k">IN</span><span class="w">      </span><span class="k">A</span><span class="w">       </span><span class="mi">142.250.150.27</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="py">smtp.google.com. </span><span class="w">       </span><span class="sc">30</span><span class="w">      </span><span class="k">IN</span><span class="w">      </span><span class="k">A</span><span class="w">       </span><span class="mi">64.233.161.27</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="py">smtp.google.com. </span><span class="w">       </span><span class="sc">30</span><span class="w">      </span><span class="k">IN</span><span class="w">      </span><span class="k">A</span><span class="w">       </span><span class="mi">64.233.161.26</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="py">smtp.google.com. </span><span class="w">       </span><span class="sc">30</span><span class="w">      </span><span class="k">IN</span><span class="w">      </span><span class="k">A</span><span class="w">       </span><span class="mi">64.233.162.27</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="py">smtp.google.com. </span><span class="w">       </span><span class="sc">30</span><span class="w">      </span><span class="k">IN</span><span class="w">      </span><span class="k">A</span><span class="w">       </span><span class="mi">142.250.150.26</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c">;; Query time: 4 msec</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c">;; SERVER: 10.1.0.1</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c">;; WHEN: Wed Mar 27 17:41:53 2024</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c">;; MSG SIZE  rcvd: 136</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
  </div>
</div>
<p>Где:</p>
<ul>
<li><code>google.com. 300 IN MX 10 smtp.google.com.</code> - MX-запись домена <code>google.com</code>.</li>
</ul>
<h3 id="nslookup-1">
  <a class="link-body-emphasis" href="#nslookup-1">NSLookUp</a>
</h3><p>Получить информацию по MX-записи домена в <code>NSLookUp</code>:</p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-10
shortcode-codeblock-bash">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-7fa1f202cc432995721781e3a8ace5ab" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">nslookup -type<span class="o">=</span>mx example.com</span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-7fa1f202cc432995721781e3a8ace5ab"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<p>Результат запроса:</p>











<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-11 shortcode-codeblock-terminal
shortcode-codeblock-terminal-linux
shortcode-codeblock-terminal-linux-user">
  <div class="card overflow-hidden" data-bs-theme="dark">
    <div class="card-header">
      <div class="d-flex align-items-center">
        <div class="flex-shrink-0 ">
          <i class="fas fa-terminal fa-fw"></i>
        </div>
        <div class="flex-grow-1 mx-2">
          <h5 class="mb-0">Терминал</h5>
        </div>
        <div class="flex-shrink-0">
          <ul class="list-inline mb-0">
            <li class="list-inline-item" title='Копировать'>
              <a class="text-body" href="#"
                 data-fn="clipboard" data-clipboard-target="#cp-4dd4993b450585d7d1b20c273af0f423"
                 role="button" aria-label='Копировать'>
                <i class="fas fa-copy fa-fw"></i>
              </a>
            </li>
          </ul>
        </div>
      </div>
    </div>
    <div class="card-body p-0 overflow-auto" id="cp-4dd4993b450585d7d1b20c273af0f423"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-dns" data-lang="dns"><span class="line"><span class="cl"><span class="nc">nslookup</span><span class="w"> </span><span class="err">-type=mx</span><span class="w"> </span><span class="nc">google.com</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nc">Server</span><span class="err">:</span><span class="w">  </span><span class="nc">gw1.lan</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nc">Address</span><span class="err">:</span><span class="w">  </span><span class="mi">10.1.0.1</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nc">Non-authoritative</span><span class="w"> </span><span class="err">answer:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nc">google.com</span><span class="w">      </span><span class="k">MX</span><span class="w"> </span><span class="err">preference</span><span class="w"> </span><span class="err">=</span><span class="w"> </span><span class="sc">10</span><span class="err">,</span><span class="w"> </span><span class="err">mail</span><span class="w"> </span><span class="err">exchanger</span><span class="w"> </span><span class="err">=</span><span class="w"> </span><span class="nc">smtp.google.com</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nc">smtp.google.com</span><span class="w"> </span><span class="err">internet</span><span class="w"> </span><span class="err">address</span><span class="w"> </span><span class="err">=</span><span class="w"> </span><span class="mi">173.194.221.27</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nc">smtp.google.com</span><span class="w"> </span><span class="err">internet</span><span class="w"> </span><span class="err">address</span><span class="w"> </span><span class="err">=</span><span class="w"> </span><span class="mi">173.194.222.27</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nc">smtp.google.com</span><span class="w"> </span><span class="err">internet</span><span class="w"> </span><span class="err">address</span><span class="w"> </span><span class="err">=</span><span class="w"> </span><span class="mi">173.194.222.26</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nc">smtp.google.com</span><span class="w"> </span><span class="err">internet</span><span class="w"> </span><span class="err">address</span><span class="w"> </span><span class="err">=</span><span class="w"> </span><span class="mi">74.125.205.27</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nc">smtp.google.com</span><span class="w"> </span><span class="err">internet</span><span class="w"> </span><span class="err">address</span><span class="w"> </span><span class="err">=</span><span class="w"> </span><span class="mi">173.194.220.26</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
  </div>
</div>
<p>Где:</p>
<ul>
<li><code>google.com MX preference = 10, mail exchanger = smtp.google.com</code> - MX-запись домена <code>google.com</code>.</li>
</ul>
<h2 id="трассировка">
  <a class="link-body-emphasis" href="#%d1%82%d1%80%d0%b0%d1%81%d1%81%d0%b8%d1%80%d0%be%d0%b2%d0%ba%d0%b0">Трассировка</a>
</h2><p>Трассировка запросов к домену.</p>
<h3 id="dig-2">
  <a class="link-body-emphasis" href="#dig-2">Dig</a>
</h3><p>Получить информацию по трассировке запросов к домену в <code>Dig</code>:</p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-12
shortcode-codeblock-bash">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-23e66be62ee9475a968bde4b106ca3b5" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">dig +trace example.com</span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-23e66be62ee9475a968bde4b106ca3b5"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<p>Результат запроса:</p>











<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-13 shortcode-codeblock-terminal
shortcode-codeblock-terminal-linux
shortcode-codeblock-terminal-linux-user">
  <div class="card overflow-hidden" data-bs-theme="dark">
    <div class="card-header">
      <div class="d-flex align-items-center">
        <div class="flex-shrink-0 ">
          <i class="fas fa-terminal fa-fw"></i>
        </div>
        <div class="flex-grow-1 mx-2">
          <h5 class="mb-0">Терминал</h5>
        </div>
        <div class="flex-shrink-0">
          <ul class="list-inline mb-0">
            <li class="list-inline-item" title='Копировать'>
              <a class="text-body" href="#"
                 data-fn="clipboard" data-clipboard-target="#cp-42820deab0357d1b6426ef7b36b9e169"
                 role="button" aria-label='Копировать'>
                <i class="fas fa-copy fa-fw"></i>
              </a>
            </li>
          </ul>
        </div>
      </div>
    </div>
    <div class="card-body p-0 overflow-auto" id="cp-42820deab0357d1b6426ef7b36b9e169"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-dns" data-lang="dns"><span class="line"><span class="cl"><span class="nc">dig</span><span class="w"> </span><span class="err">+trace</span><span class="w"> </span><span class="nc">google.com</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c">; &lt;&lt;&gt;&gt; DiG 9.18.24-1-Debian &lt;&lt;&gt;&gt; +trace google.com</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c">;; global options: +cmd</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="err">.</span><span class="w">                       </span><span class="sc">86400</span><span class="w">   </span><span class="k">IN</span><span class="w">      </span><span class="k">NS</span><span class="w">      </span><span class="py">k.root-servers.net.</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="err">.</span><span class="w">                       </span><span class="sc">86400</span><span class="w">   </span><span class="k">IN</span><span class="w">      </span><span class="k">NS</span><span class="w">      </span><span class="py">d.root-servers.net.</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="err">.</span><span class="w">                       </span><span class="sc">86400</span><span class="w">   </span><span class="k">IN</span><span class="w">      </span><span class="k">NS</span><span class="w">      </span><span class="py">h.root-servers.net.</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="err">.</span><span class="w">                       </span><span class="sc">86400</span><span class="w">   </span><span class="k">IN</span><span class="w">      </span><span class="k">NS</span><span class="w">      </span><span class="py">f.root-servers.net.</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="err">.</span><span class="w">                       </span><span class="sc">86400</span><span class="w">   </span><span class="k">IN</span><span class="w">      </span><span class="k">NS</span><span class="w">      </span><span class="py">g.root-servers.net.</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="err">.</span><span class="w">                       </span><span class="sc">86400</span><span class="w">   </span><span class="k">IN</span><span class="w">      </span><span class="k">NS</span><span class="w">      </span><span class="py">l.root-servers.net.</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="err">.</span><span class="w">                       </span><span class="sc">86400</span><span class="w">   </span><span class="k">IN</span><span class="w">      </span><span class="k">NS</span><span class="w">      </span><span class="py">j.root-servers.net.</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="err">.</span><span class="w">                       </span><span class="sc">86400</span><span class="w">   </span><span class="k">IN</span><span class="w">      </span><span class="k">NS</span><span class="w">      </span><span class="py">e.root-servers.net.</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="err">.</span><span class="w">                       </span><span class="sc">86400</span><span class="w">   </span><span class="k">IN</span><span class="w">      </span><span class="k">NS</span><span class="w">      </span><span class="py">a.root-servers.net.</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="err">.</span><span class="w">                       </span><span class="sc">86400</span><span class="w">   </span><span class="k">IN</span><span class="w">      </span><span class="k">NS</span><span class="w">      </span><span class="py">b.root-servers.net.</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="err">.</span><span class="w">                       </span><span class="sc">86400</span><span class="w">   </span><span class="k">IN</span><span class="w">      </span><span class="k">NS</span><span class="w">      </span><span class="py">m.root-servers.net.</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="err">.</span><span class="w">                       </span><span class="sc">86400</span><span class="w">   </span><span class="k">IN</span><span class="w">      </span><span class="k">NS</span><span class="w">      </span><span class="py">c.root-servers.net.</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="err">.</span><span class="w">                       </span><span class="sc">86400</span><span class="w">   </span><span class="k">IN</span><span class="w">      </span><span class="k">NS</span><span class="w">      </span><span class="py">i.root-servers.net.</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c">;; Received 824 bytes from 172.16.18.22#53(172.16.18.22) in 4 ms</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="py">com. </span><span class="w">                   </span><span class="sc">172800</span><span class="w">  </span><span class="k">IN</span><span class="w">      </span><span class="k">NS</span><span class="w">      </span><span class="py">a.gtld-servers.net.</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="py">com. </span><span class="w">                   </span><span class="sc">172800</span><span class="w">  </span><span class="k">IN</span><span class="w">      </span><span class="k">NS</span><span class="w">      </span><span class="py">b.gtld-servers.net.</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="py">com. </span><span class="w">                   </span><span class="sc">172800</span><span class="w">  </span><span class="k">IN</span><span class="w">      </span><span class="k">NS</span><span class="w">      </span><span class="py">c.gtld-servers.net.</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="py">com. </span><span class="w">                   </span><span class="sc">172800</span><span class="w">  </span><span class="k">IN</span><span class="w">      </span><span class="k">NS</span><span class="w">      </span><span class="py">d.gtld-servers.net.</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="py">com. </span><span class="w">                   </span><span class="sc">172800</span><span class="w">  </span><span class="k">IN</span><span class="w">      </span><span class="k">NS</span><span class="w">      </span><span class="py">e.gtld-servers.net.</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="py">com. </span><span class="w">                   </span><span class="sc">172800</span><span class="w">  </span><span class="k">IN</span><span class="w">      </span><span class="k">NS</span><span class="w">      </span><span class="py">f.gtld-servers.net.</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="py">com. </span><span class="w">                   </span><span class="sc">172800</span><span class="w">  </span><span class="k">IN</span><span class="w">      </span><span class="k">NS</span><span class="w">      </span><span class="py">g.gtld-servers.net.</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="py">com. </span><span class="w">                   </span><span class="sc">172800</span><span class="w">  </span><span class="k">IN</span><span class="w">      </span><span class="k">NS</span><span class="w">      </span><span class="py">h.gtld-servers.net.</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="py">com. </span><span class="w">                   </span><span class="sc">172800</span><span class="w">  </span><span class="k">IN</span><span class="w">      </span><span class="k">NS</span><span class="w">      </span><span class="py">i.gtld-servers.net.</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="py">com. </span><span class="w">                   </span><span class="sc">172800</span><span class="w">  </span><span class="k">IN</span><span class="w">      </span><span class="k">NS</span><span class="w">      </span><span class="py">j.gtld-servers.net.</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="py">com. </span><span class="w">                   </span><span class="sc">172800</span><span class="w">  </span><span class="k">IN</span><span class="w">      </span><span class="k">NS</span><span class="w">      </span><span class="py">k.gtld-servers.net.</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="py">com. </span><span class="w">                   </span><span class="sc">172800</span><span class="w">  </span><span class="k">IN</span><span class="w">      </span><span class="k">NS</span><span class="w">      </span><span class="py">l.gtld-servers.net.</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="py">com. </span><span class="w">                   </span><span class="sc">172800</span><span class="w">  </span><span class="k">IN</span><span class="w">      </span><span class="k">NS</span><span class="w">      </span><span class="py">m.gtld-servers.net.</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="py">com. </span><span class="w">                   </span><span class="sc">86400</span><span class="w">   </span><span class="k">IN</span><span class="w">      </span><span class="k">DS</span><span class="w">      </span><span class="sc">19718</span><span class="w"> </span><span class="sc">13</span><span class="w"> </span><span class="sc">2</span><span class="w"> </span><span class="sc">8</span><span class="err">ACBB0CD28F41250A80A491389424D341522D946B0DA0C0291F2D3D7</span><span class="w"> </span><span class="sc">71</span><span class="err">D7805A</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="py">com. </span><span class="w">                   </span><span class="sc">86400</span><span class="w">   </span><span class="k">IN</span><span class="w">      </span><span class="k">RRSIG</span><span class="w">   </span><span class="k">DS</span><span class="w"> </span><span class="sc">8</span><span class="w"> </span><span class="sc">1</span><span class="w"> </span><span class="sc">86400</span><span class="w"> </span><span class="sc">20240428050000</span><span class="w"> </span><span class="sc">20240415040000</span><span class="w"> </span><span class="sc">5613</span><span class="w"> </span><span class="err">.</span><span class="w"> </span><span class="err">B5vi45DiEHj1RSe0d4ZMvighZNLSPj6ORov+tN+g4MASLSudADHgjP9i</span><span class="w"> </span><span class="sc">32</span><span class="err">HBqh6IyFeK8aIR3Jvuvk61Z+</span><span class="sc">2</span><span class="err">Z0oKjX6rUisVxf9RcQ3/uYZEBYUlp</span><span class="w"> </span><span class="err">JD32jNFY1qFXRfWiijTFhq8detfDVvczcwv0v6Lln0fcRIYDnzgHkqQV</span><span class="w"> </span><span class="sc">38</span><span class="err">LonWnfWLuOOjt6drrmsc6NqMvzBNM62ctqdajOd1SYFduk5JadzLZa</span><span class="w"> </span><span class="err">YhUooeLpfTNmBQtPjsrZeXVE9UUpLrOVW9Up3NV+kfusBCG5iBkepw/p</span><span class="w"> </span><span class="err">daza94/</span><span class="sc">0</span><span class="err">N5Q2xqTVCoHHUnaPmdZwp78AsLdpeJ347OyJQ/gO+pIz8WYT</span><span class="w"> </span><span class="err">aNi7FA==</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c">;; Received 1170 bytes from 193.0.14.129#53(k.root-servers.net) in 68 ms</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="py">google.com. </span><span class="w">            </span><span class="sc">172800</span><span class="w">  </span><span class="k">IN</span><span class="w">      </span><span class="k">NS</span><span class="w">      </span><span class="py">ns2.google.com.</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="py">google.com. </span><span class="w">            </span><span class="sc">172800</span><span class="w">  </span><span class="k">IN</span><span class="w">      </span><span class="k">NS</span><span class="w">      </span><span class="py">ns1.google.com.</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="py">google.com. </span><span class="w">            </span><span class="sc">172800</span><span class="w">  </span><span class="k">IN</span><span class="w">      </span><span class="k">NS</span><span class="w">      </span><span class="py">ns3.google.com.</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="py">google.com. </span><span class="w">            </span><span class="sc">172800</span><span class="w">  </span><span class="k">IN</span><span class="w">      </span><span class="k">NS</span><span class="w">      </span><span class="py">ns4.google.com.</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="py">CK0POJMG874LJREF7EFN8430QVIT8BSM.com. </span><span class="sc">86400</span><span class="w"> </span><span class="k">IN</span><span class="w"> </span><span class="k">NSEC3</span><span class="w"> </span><span class="sc">1</span><span class="w"> </span><span class="sc">1</span><span class="w"> </span><span class="sc">0</span><span class="w"> </span><span class="err">-</span><span class="w"> </span><span class="err">CK0Q2D6NI4I7EQH8NA30NS61O48UL8G5</span><span class="w"> </span><span class="k">NS</span><span class="w"> </span><span class="k">SOA</span><span class="w"> </span><span class="k">RRSIG</span><span class="w"> </span><span class="k">DNSKEY</span><span class="w"> </span><span class="k">NSEC3PARAM</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="py">CK0POJMG874LJREF7EFN8430QVIT8BSM.com. </span><span class="sc">86400</span><span class="w"> </span><span class="k">IN</span><span class="w"> </span><span class="k">RRSIG</span><span class="w"> </span><span class="k">NSEC3</span><span class="w"> </span><span class="sc">13</span><span class="w"> </span><span class="sc">2</span><span class="w"> </span><span class="sc">86400</span><span class="w"> </span><span class="sc">20240422042504</span><span class="w"> </span><span class="sc">20240415031504</span><span class="w"> </span><span class="sc">4534</span><span class="w"> </span><span class="py">com. </span><span class="err">ecgUBNoIjF0/</span><span class="sc">2</span><span class="err">NK5qbLLoESdr1gCp2UQeruasASkce/</span><span class="sc">2</span><span class="err">OC1+tbNorpx2</span><span class="w"> </span><span class="err">zr2HsO8bFW7BEvnN11MdmPyQBU3Csg==</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="py">S84BKCIBC38P58340AKVNFN5KR9O59QC.com. </span><span class="sc">86400</span><span class="w"> </span><span class="k">IN</span><span class="w"> </span><span class="k">NSEC3</span><span class="w"> </span><span class="sc">1</span><span class="w"> </span><span class="sc">1</span><span class="w"> </span><span class="sc">0</span><span class="w"> </span><span class="err">-</span><span class="w"> </span><span class="err">S84BR9CIB2A20L3ETR1M2415ENPP99L8</span><span class="w"> </span><span class="k">NS</span><span class="w"> </span><span class="k">DS</span><span class="w"> </span><span class="k">RRSIG</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="py">S84BKCIBC38P58340AKVNFN5KR9O59QC.com. </span><span class="sc">86400</span><span class="w"> </span><span class="k">IN</span><span class="w"> </span><span class="k">RRSIG</span><span class="w"> </span><span class="k">NSEC3</span><span class="w"> </span><span class="sc">13</span><span class="w"> </span><span class="sc">2</span><span class="w"> </span><span class="sc">86400</span><span class="w"> </span><span class="sc">20240419042537</span><span class="w"> </span><span class="sc">20240412031537</span><span class="w"> </span><span class="sc">4534</span><span class="w"> </span><span class="py">com. </span><span class="sc">5</span><span class="err">lFoSTkTYKY8oMvoj3TJbMvg72dB8RNZ3hvC5xkh9u6iZtqSZS+</span><span class="sc">7</span><span class="err">bjJH</span><span class="w"> </span><span class="err">nVL6cstRpACJKNLpTaWmI1NE9WsPWg==</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c">;; Received 644 bytes from 192.42.93.30#53(g.gtld-servers.net) in 44 ms</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="py">google.com. </span><span class="w">            </span><span class="sc">300</span><span class="w">     </span><span class="k">IN</span><span class="w">      </span><span class="k">A</span><span class="w">       </span><span class="mi">74.125.131.139</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="py">google.com. </span><span class="w">            </span><span class="sc">300</span><span class="w">     </span><span class="k">IN</span><span class="w">      </span><span class="k">A</span><span class="w">       </span><span class="mi">74.125.131.102</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="py">google.com. </span><span class="w">            </span><span class="sc">300</span><span class="w">     </span><span class="k">IN</span><span class="w">      </span><span class="k">A</span><span class="w">       </span><span class="mi">74.125.131.100</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="py">google.com. </span><span class="w">            </span><span class="sc">300</span><span class="w">     </span><span class="k">IN</span><span class="w">      </span><span class="k">A</span><span class="w">       </span><span class="mi">74.125.131.113</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="py">google.com. </span><span class="w">            </span><span class="sc">300</span><span class="w">     </span><span class="k">IN</span><span class="w">      </span><span class="k">A</span><span class="w">       </span><span class="mi">74.125.131.138</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="py">google.com. </span><span class="w">            </span><span class="sc">300</span><span class="w">     </span><span class="k">IN</span><span class="w">      </span><span class="k">A</span><span class="w">       </span><span class="mi">74.125.131.101</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c">;; Received 135 bytes from 216.239.36.10#53(ns3.google.com) in 20 ms</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
  </div>
</div>
<h3 id="drill-2">
  <a class="link-body-emphasis" href="#drill-2">Drill</a>
</h3><p>Получить информацию по трассировке запросов к домену в <code>Drill</code>:</p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-14
shortcode-codeblock-bash">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-681966037d0d4d273adf4bc3fa010791" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">drill -T example.com</span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-681966037d0d4d273adf4bc3fa010791"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<p>Результат запроса:</p>











<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-15 shortcode-codeblock-terminal
shortcode-codeblock-terminal-linux
shortcode-codeblock-terminal-linux-user">
  <div class="card overflow-hidden" data-bs-theme="dark">
    <div class="card-header">
      <div class="d-flex align-items-center">
        <div class="flex-shrink-0 ">
          <i class="fas fa-terminal fa-fw"></i>
        </div>
        <div class="flex-grow-1 mx-2">
          <h5 class="mb-0">Терминал</h5>
        </div>
        <div class="flex-shrink-0">
          <ul class="list-inline mb-0">
            <li class="list-inline-item" title='Копировать'>
              <a class="text-body" href="#"
                 data-fn="clipboard" data-clipboard-target="#cp-d167698db325b97fa2225f84e3f7b1d1"
                 role="button" aria-label='Копировать'>
                <i class="fas fa-copy fa-fw"></i>
              </a>
            </li>
          </ul>
        </div>
      </div>
    </div>
    <div class="card-body p-0 overflow-auto" id="cp-d167698db325b97fa2225f84e3f7b1d1"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-dns" data-lang="dns"><span class="line"><span class="cl"><span class="nc">drill</span><span class="w"> </span><span class="err">-T</span><span class="w"> </span><span class="nc">google.com</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="err">.</span><span class="w">       </span><span class="sc">518400</span><span class="w">  </span><span class="k">IN</span><span class="w">      </span><span class="k">NS</span><span class="w">      </span><span class="py">a.root-servers.net.</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="err">.</span><span class="w">       </span><span class="sc">518400</span><span class="w">  </span><span class="k">IN</span><span class="w">      </span><span class="k">NS</span><span class="w">      </span><span class="py">b.root-servers.net.</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="err">.</span><span class="w">       </span><span class="sc">518400</span><span class="w">  </span><span class="k">IN</span><span class="w">      </span><span class="k">NS</span><span class="w">      </span><span class="py">c.root-servers.net.</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="err">.</span><span class="w">       </span><span class="sc">518400</span><span class="w">  </span><span class="k">IN</span><span class="w">      </span><span class="k">NS</span><span class="w">      </span><span class="py">d.root-servers.net.</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="err">.</span><span class="w">       </span><span class="sc">518400</span><span class="w">  </span><span class="k">IN</span><span class="w">      </span><span class="k">NS</span><span class="w">      </span><span class="py">e.root-servers.net.</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="err">.</span><span class="w">       </span><span class="sc">518400</span><span class="w">  </span><span class="k">IN</span><span class="w">      </span><span class="k">NS</span><span class="w">      </span><span class="py">f.root-servers.net.</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="err">.</span><span class="w">       </span><span class="sc">518400</span><span class="w">  </span><span class="k">IN</span><span class="w">      </span><span class="k">NS</span><span class="w">      </span><span class="py">g.root-servers.net.</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="err">.</span><span class="w">       </span><span class="sc">518400</span><span class="w">  </span><span class="k">IN</span><span class="w">      </span><span class="k">NS</span><span class="w">      </span><span class="py">h.root-servers.net.</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="err">.</span><span class="w">       </span><span class="sc">518400</span><span class="w">  </span><span class="k">IN</span><span class="w">      </span><span class="k">NS</span><span class="w">      </span><span class="py">i.root-servers.net.</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="err">.</span><span class="w">       </span><span class="sc">518400</span><span class="w">  </span><span class="k">IN</span><span class="w">      </span><span class="k">NS</span><span class="w">      </span><span class="py">j.root-servers.net.</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="err">.</span><span class="w">       </span><span class="sc">518400</span><span class="w">  </span><span class="k">IN</span><span class="w">      </span><span class="k">NS</span><span class="w">      </span><span class="py">k.root-servers.net.</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="err">.</span><span class="w">       </span><span class="sc">518400</span><span class="w">  </span><span class="k">IN</span><span class="w">      </span><span class="k">NS</span><span class="w">      </span><span class="py">l.root-servers.net.</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="err">.</span><span class="w">       </span><span class="sc">518400</span><span class="w">  </span><span class="k">IN</span><span class="w">      </span><span class="k">NS</span><span class="w">      </span><span class="py">m.root-servers.net.</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="py">com. </span><span class="w">   </span><span class="sc">172800</span><span class="w">  </span><span class="k">IN</span><span class="w">      </span><span class="k">NS</span><span class="w">      </span><span class="py">m.gtld-servers.net.</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="py">com. </span><span class="w">   </span><span class="sc">172800</span><span class="w">  </span><span class="k">IN</span><span class="w">      </span><span class="k">NS</span><span class="w">      </span><span class="py">j.gtld-servers.net.</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="py">com. </span><span class="w">   </span><span class="sc">172800</span><span class="w">  </span><span class="k">IN</span><span class="w">      </span><span class="k">NS</span><span class="w">      </span><span class="py">f.gtld-servers.net.</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="py">com. </span><span class="w">   </span><span class="sc">172800</span><span class="w">  </span><span class="k">IN</span><span class="w">      </span><span class="k">NS</span><span class="w">      </span><span class="py">l.gtld-servers.net.</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="py">com. </span><span class="w">   </span><span class="sc">172800</span><span class="w">  </span><span class="k">IN</span><span class="w">      </span><span class="k">NS</span><span class="w">      </span><span class="py">g.gtld-servers.net.</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="py">com. </span><span class="w">   </span><span class="sc">172800</span><span class="w">  </span><span class="k">IN</span><span class="w">      </span><span class="k">NS</span><span class="w">      </span><span class="py">c.gtld-servers.net.</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="py">com. </span><span class="w">   </span><span class="sc">172800</span><span class="w">  </span><span class="k">IN</span><span class="w">      </span><span class="k">NS</span><span class="w">      </span><span class="py">k.gtld-servers.net.</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="py">com. </span><span class="w">   </span><span class="sc">172800</span><span class="w">  </span><span class="k">IN</span><span class="w">      </span><span class="k">NS</span><span class="w">      </span><span class="py">b.gtld-servers.net.</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="py">com. </span><span class="w">   </span><span class="sc">172800</span><span class="w">  </span><span class="k">IN</span><span class="w">      </span><span class="k">NS</span><span class="w">      </span><span class="py">d.gtld-servers.net.</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="py">com. </span><span class="w">   </span><span class="sc">172800</span><span class="w">  </span><span class="k">IN</span><span class="w">      </span><span class="k">NS</span><span class="w">      </span><span class="py">h.gtld-servers.net.</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="py">com. </span><span class="w">   </span><span class="sc">172800</span><span class="w">  </span><span class="k">IN</span><span class="w">      </span><span class="k">NS</span><span class="w">      </span><span class="py">a.gtld-servers.net.</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="py">com. </span><span class="w">   </span><span class="sc">172800</span><span class="w">  </span><span class="k">IN</span><span class="w">      </span><span class="k">NS</span><span class="w">      </span><span class="py">i.gtld-servers.net.</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="py">com. </span><span class="w">   </span><span class="sc">172800</span><span class="w">  </span><span class="k">IN</span><span class="w">      </span><span class="k">NS</span><span class="w">      </span><span class="py">e.gtld-servers.net.</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="py">google.com. </span><span class="w">    </span><span class="sc">172800</span><span class="w">  </span><span class="k">IN</span><span class="w">      </span><span class="k">NS</span><span class="w">      </span><span class="py">ns2.google.com.</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="py">google.com. </span><span class="w">    </span><span class="sc">172800</span><span class="w">  </span><span class="k">IN</span><span class="w">      </span><span class="k">NS</span><span class="w">      </span><span class="py">ns1.google.com.</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="py">google.com. </span><span class="w">    </span><span class="sc">172800</span><span class="w">  </span><span class="k">IN</span><span class="w">      </span><span class="k">NS</span><span class="w">      </span><span class="py">ns3.google.com.</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="py">google.com. </span><span class="w">    </span><span class="sc">172800</span><span class="w">  </span><span class="k">IN</span><span class="w">      </span><span class="k">NS</span><span class="w">      </span><span class="py">ns4.google.com.</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="py">google.com. </span><span class="w">    </span><span class="sc">300</span><span class="w">     </span><span class="k">IN</span><span class="w">      </span><span class="k">A</span><span class="w">       </span><span class="mi">108.177.14.139</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="py">google.com. </span><span class="w">    </span><span class="sc">300</span><span class="w">     </span><span class="k">IN</span><span class="w">      </span><span class="k">A</span><span class="w">       </span><span class="mi">108.177.14.102</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="py">google.com. </span><span class="w">    </span><span class="sc">300</span><span class="w">     </span><span class="k">IN</span><span class="w">      </span><span class="k">A</span><span class="w">       </span><span class="mi">108.177.14.138</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="py">google.com. </span><span class="w">    </span><span class="sc">300</span><span class="w">     </span><span class="k">IN</span><span class="w">      </span><span class="k">A</span><span class="w">       </span><span class="mi">108.177.14.100</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="py">google.com. </span><span class="w">    </span><span class="sc">300</span><span class="w">     </span><span class="k">IN</span><span class="w">      </span><span class="k">A</span><span class="w">       </span><span class="mi">108.177.14.101</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="py">google.com. </span><span class="w">    </span><span class="sc">300</span><span class="w">     </span><span class="k">IN</span><span class="w">      </span><span class="k">A</span><span class="w">       </span><span class="mi">108.177.14.113</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
  </div>
</div>
<h2 id="ptr-запись-домена">
  <a class="link-body-emphasis" href="#ptr-%d0%b7%d0%b0%d0%bf%d0%b8%d1%81%d1%8c-%d0%b4%d0%be%d0%bc%d0%b5%d0%bd%d0%b0">PTR-запись домена</a>
</h2><h3 id="dig-3">
  <a class="link-body-emphasis" href="#dig-3">Dig</a>
</h3><p>Получить информацию по PTR-записи домена в <code>Dig</code>:</p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-16
shortcode-codeblock-bash">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-c9e87eed32b8d124c7135d81b54be5e9" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">dig -x IP_ADDRESS</span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-c9e87eed32b8d124c7135d81b54be5e9"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<p>Результат запроса:</p>











<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-17 shortcode-codeblock-terminal
shortcode-codeblock-terminal-linux
shortcode-codeblock-terminal-linux-user">
  <div class="card overflow-hidden" data-bs-theme="dark">
    <div class="card-header">
      <div class="d-flex align-items-center">
        <div class="flex-shrink-0 ">
          <i class="fas fa-terminal fa-fw"></i>
        </div>
        <div class="flex-grow-1 mx-2">
          <h5 class="mb-0">Терминал</h5>
        </div>
        <div class="flex-shrink-0">
          <ul class="list-inline mb-0">
            <li class="list-inline-item" title='Копировать'>
              <a class="text-body" href="#"
                 data-fn="clipboard" data-clipboard-target="#cp-3c031e9f942452f335c0d1a73d9681e6"
                 role="button" aria-label='Копировать'>
                <i class="fas fa-copy fa-fw"></i>
              </a>
            </li>
          </ul>
        </div>
      </div>
    </div>
    <div class="card-body p-0 overflow-auto" id="cp-3c031e9f942452f335c0d1a73d9681e6"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-dns" data-lang="dns"><span class="line"><span class="cl"><span class="nc">dig</span><span class="w"> </span><span class="err">-x</span><span class="w"> </span><span class="mi">108.177.14.100</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c">; &lt;&lt;&gt;&gt; DiG 9.18.24-1-Debian &lt;&lt;&gt;&gt; -x 108.177.14.100</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c">;; global options: +cmd</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c">;; Got answer:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c">;; -&gt;&gt;HEADER&lt;&lt;- opcode: QUERY, status: NOERROR, id: 649</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c">;; flags: qr rd ra; QUERY: 1, ANSWER: 1, AUTHORITY: 0, ADDITIONAL: 1</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c">;; OPT PSEUDOSECTION:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c">; EDNS: version: 0, flags:; udp: 4000</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c">;; QUESTION SECTION:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c">;100.14.177.108.in-addr.arpa.   IN      PTR</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c">;; ANSWER SECTION:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="mi">100.14.177.108</span><span class="py">.in-addr.arpa. </span><span class="sc">815</span><span class="w"> </span><span class="k">IN</span><span class="w">     </span><span class="k">PTR</span><span class="w">     </span><span class="py">lt-in-f100.1e100.net.</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c">;; Query time: 0 msec</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c">;; SERVER: 172.16.18.22#53(172.16.18.22) (UDP)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c">;; WHEN: Mon Apr 15 09:21:53 UTC 2024</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c">;; MSG SIZE  rcvd: 90</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
  </div>
</div>
<h3 id="drill-3">
  <a class="link-body-emphasis" href="#drill-3">Drill</a>
</h3><p>Получить информацию по PTR-записи домена в <code>Drill</code>:</p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-18
shortcode-codeblock-bash">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-c66a1de52f1be57b5581448b27062f9a" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">drill -x IP_ADDRESS</span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-c66a1de52f1be57b5581448b27062f9a"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<p>Результат запроса:</p>











<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-19 shortcode-codeblock-terminal
shortcode-codeblock-terminal-linux
shortcode-codeblock-terminal-linux-user">
  <div class="card overflow-hidden" data-bs-theme="dark">
    <div class="card-header">
      <div class="d-flex align-items-center">
        <div class="flex-shrink-0 ">
          <i class="fas fa-terminal fa-fw"></i>
        </div>
        <div class="flex-grow-1 mx-2">
          <h5 class="mb-0">Терминал</h5>
        </div>
        <div class="flex-shrink-0">
          <ul class="list-inline mb-0">
            <li class="list-inline-item" title='Копировать'>
              <a class="text-body" href="#"
                 data-fn="clipboard" data-clipboard-target="#cp-57865db4b7af2b442973af03adbe3b0e"
                 role="button" aria-label='Копировать'>
                <i class="fas fa-copy fa-fw"></i>
              </a>
            </li>
          </ul>
        </div>
      </div>
    </div>
    <div class="card-body p-0 overflow-auto" id="cp-57865db4b7af2b442973af03adbe3b0e"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-dns" data-lang="dns"><span class="line"><span class="cl"><span class="nc">drill</span><span class="w"> </span><span class="err">-x</span><span class="w"> </span><span class="mi">108.177.14.100</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c">;; -&gt;&gt;HEADER&lt;&lt;- opcode: QUERY, rcode: NOERROR, id: 55533</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c">;; flags: qr rd ra ; QUERY: 1, ANSWER: 1, AUTHORITY: 0, ADDITIONAL: 0</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c">;; QUESTION SECTION:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c">;; 100.14.177.108.in-addr.arpa. IN      PTR</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c">;; ANSWER SECTION:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="mi">100.14.177.108</span><span class="py">.in-addr.arpa. </span><span class="w">   </span><span class="sc">14366</span><span class="w">   </span><span class="k">IN</span><span class="w">      </span><span class="k">PTR</span><span class="w">     </span><span class="py">lt-in-f100.1e100.net.</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c">;; AUTHORITY SECTION:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c">;; ADDITIONAL SECTION:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c">;; Query time: 3 msec</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c">;; SERVER: 10.1.0.1</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c">;; WHEN: Wed Mar 27 17:44:49 2024</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c">;; MSG SIZE  rcvd: 79</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
  </div>
</div>
<h3 id="nslookup-2">
  <a class="link-body-emphasis" href="#nslookup-2">NSLookUp</a>
</h3><p>Получить информацию по PTR-записи домена в <code>NSLookUp</code>:</p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-20
shortcode-codeblock-bash">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-343d328432fd99e9ade815a936291a28" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">nslookup -debug IP_ADDRESS</span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-343d328432fd99e9ade815a936291a28"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<p>Результат запроса:</p>











<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-21 shortcode-codeblock-terminal
shortcode-codeblock-terminal-linux
shortcode-codeblock-terminal-linux-user">
  <div class="card overflow-hidden" data-bs-theme="dark">
    <div class="card-header">
      <div class="d-flex align-items-center">
        <div class="flex-shrink-0 ">
          <i class="fas fa-terminal fa-fw"></i>
        </div>
        <div class="flex-grow-1 mx-2">
          <h5 class="mb-0">Терминал</h5>
        </div>
        <div class="flex-shrink-0">
          <ul class="list-inline mb-0">
            <li class="list-inline-item" title='Копировать'>
              <a class="text-body" href="#"
                 data-fn="clipboard" data-clipboard-target="#cp-ab3946ed451046f3ef187d59f7c08f69"
                 role="button" aria-label='Копировать'>
                <i class="fas fa-copy fa-fw"></i>
              </a>
            </li>
          </ul>
        </div>
      </div>
    </div>
    <div class="card-body p-0 overflow-auto" id="cp-ab3946ed451046f3ef187d59f7c08f69"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-dns" data-lang="dns"><span class="line"><span class="cl"><span class="nc">nslookup</span><span class="w"> </span><span class="err">-debug</span><span class="w"> </span><span class="mi">108.177.14.100</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nc">------------</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nc">Got</span><span class="w"> </span><span class="err">answer:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="err">HEADER:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="err">opcode</span><span class="w"> </span><span class="err">=</span><span class="w"> </span><span class="err">QUERY,</span><span class="w"> </span><span class="err">id</span><span class="w"> </span><span class="err">=</span><span class="w"> </span><span class="sc">1</span><span class="err">,</span><span class="w"> </span><span class="err">rcode</span><span class="w"> </span><span class="err">=</span><span class="w"> </span><span class="err">NOERROR</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="err">header</span><span class="w"> </span><span class="err">flags:</span><span class="w">  </span><span class="err">response,</span><span class="w"> </span><span class="err">want</span><span class="w"> </span><span class="err">recursion,</span><span class="w"> </span><span class="err">recursion</span><span class="w"> </span><span class="py">avail.</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="err">questions</span><span class="w"> </span><span class="err">=</span><span class="w"> </span><span class="sc">1</span><span class="err">,</span><span class="w">  </span><span class="err">answers</span><span class="w"> </span><span class="err">=</span><span class="w"> </span><span class="sc">1</span><span class="err">,</span><span class="w">  </span><span class="err">authority</span><span class="w"> </span><span class="err">records</span><span class="w"> </span><span class="err">=</span><span class="w"> </span><span class="sc">0</span><span class="err">,</span><span class="w">  </span><span class="err">additional</span><span class="w"> </span><span class="err">=</span><span class="w"> </span><span class="sc">1</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="err">QUESTIONS:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="mi">1.0.1.10</span><span class="nc">.in-addr.arpa</span><span class="err">,</span><span class="w"> </span><span class="err">type</span><span class="w"> </span><span class="err">=</span><span class="w"> </span><span class="k">PTR</span><span class="err">,</span><span class="w"> </span><span class="err">class</span><span class="w"> </span><span class="err">=</span><span class="w"> </span><span class="k">IN</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="err">ANSWERS:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="err">-&gt;</span><span class="w">  </span><span class="mi">1.0.1.10</span><span class="nc">.in-addr.arpa</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="err">name</span><span class="w"> </span><span class="err">=</span><span class="w"> </span><span class="nc">gw1.lan</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="err">ttl</span><span class="w"> </span><span class="err">=</span><span class="w"> </span><span class="sc">86400</span><span class="w"> </span><span class="p">(</span><span class="sc">1</span><span class="w"> </span><span class="err">day</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="err">ADDITIONAL</span><span class="w"> </span><span class="err">RECORDS:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="err">-&gt;</span><span class="w">  </span><span class="nc">gw1.lan</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="err">internet</span><span class="w"> </span><span class="err">address</span><span class="w"> </span><span class="err">=</span><span class="w"> </span><span class="mi">10.1.0.1</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="err">ttl</span><span class="w"> </span><span class="err">=</span><span class="w"> </span><span class="sc">86400</span><span class="w"> </span><span class="p">(</span><span class="sc">1</span><span class="w"> </span><span class="err">day</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nc">------------</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nc">Server</span><span class="err">:</span><span class="w">  </span><span class="nc">gw1.lan</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nc">Address</span><span class="err">:</span><span class="w">  </span><span class="mi">10.1.0.1</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nc">------------</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nc">Got</span><span class="w"> </span><span class="err">answer:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="err">HEADER:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="err">opcode</span><span class="w"> </span><span class="err">=</span><span class="w"> </span><span class="err">QUERY,</span><span class="w"> </span><span class="err">id</span><span class="w"> </span><span class="err">=</span><span class="w"> </span><span class="sc">2</span><span class="err">,</span><span class="w"> </span><span class="err">rcode</span><span class="w"> </span><span class="err">=</span><span class="w"> </span><span class="err">NOERROR</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="err">header</span><span class="w"> </span><span class="err">flags:</span><span class="w">  </span><span class="err">response,</span><span class="w"> </span><span class="err">want</span><span class="w"> </span><span class="err">recursion,</span><span class="w"> </span><span class="err">recursion</span><span class="w"> </span><span class="py">avail.</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="err">questions</span><span class="w"> </span><span class="err">=</span><span class="w"> </span><span class="sc">1</span><span class="err">,</span><span class="w">  </span><span class="err">answers</span><span class="w"> </span><span class="err">=</span><span class="w"> </span><span class="sc">1</span><span class="err">,</span><span class="w">  </span><span class="err">authority</span><span class="w"> </span><span class="err">records</span><span class="w"> </span><span class="err">=</span><span class="w"> </span><span class="sc">0</span><span class="err">,</span><span class="w">  </span><span class="err">additional</span><span class="w"> </span><span class="err">=</span><span class="w"> </span><span class="sc">0</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="err">QUESTIONS:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="mi">100.14.177.108</span><span class="nc">.in-addr.arpa</span><span class="err">,</span><span class="w"> </span><span class="err">type</span><span class="w"> </span><span class="err">=</span><span class="w"> </span><span class="k">PTR</span><span class="err">,</span><span class="w"> </span><span class="err">class</span><span class="w"> </span><span class="err">=</span><span class="w"> </span><span class="k">IN</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="err">ANSWERS:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="err">-&gt;</span><span class="w">  </span><span class="mi">100.14.177.108</span><span class="nc">.in-addr.arpa</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="err">name</span><span class="w"> </span><span class="err">=</span><span class="w"> </span><span class="nc">lt-in-f100.1e100.net</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="err">ttl</span><span class="w"> </span><span class="err">=</span><span class="w"> </span><span class="sc">14305</span><span class="w"> </span><span class="p">(</span><span class="sc">3</span><span class="w"> </span><span class="err">hours</span><span class="w"> </span><span class="sc">58</span><span class="w"> </span><span class="err">mins</span><span class="w"> </span><span class="sc">25</span><span class="w"> </span><span class="err">secs</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nc">------------</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nc">Name</span><span class="err">:</span><span class="w">    </span><span class="nc">lt-in-f100.1e100.net</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nc">Address</span><span class="err">:</span><span class="w">  </span><span class="mi">108.177.14.100</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
  </div>
</div>]]></turbo:content></item><item turbo="true"><title>Как проверить PTR-запись?</title><link>https://lib.onl/ru/2024/03/4db553f9-8a24-5807-bce0-bbbcc59fb4e1/</link><pubDate>Wed, 27 Mar 2024 13:49:08 +0000</pubDate><dc:creator>Kai Kimera</dc:creator><category>Dns</category><category>Ptr</category><category>Nslookup</category><turbo:extendedHtml>true</turbo:extendedHtml><turbo:source>https://lib.onl/ru/2024/03/4db553f9-8a24-5807-bce0-bbbcc59fb4e1/</turbo:source><turbo:topic>Как проверить PTR-запись?</turbo:topic><turbo:content>&lt;p>Как проверить запись PTR у домена?&lt;/p></turbo:content></item><item turbo="true"><title>Cisco: Загрузка и выгрузка конфигурации</title><link>https://lib.onl/ru/2024/03/4a7addb9-eff3-5482-902c-791fbe49899f/</link><pubDate>Tue, 26 Mar 2024 13:00:25 +0000</pubDate><dc:creator>Kai Kimera</dc:creator><category>Сеть</category><category>Терминал</category><yandex:related><link url="https://lib.onl/ru/2024/03/fc67eb74-8f7c-5de3-bd1e-2d823208eae2/">Cisco: Сброс пароля</link></yandex:related><turbo:extendedHtml>true</turbo:extendedHtml><turbo:source>https://lib.onl/ru/2024/03/4a7addb9-eff3-5482-902c-791fbe49899f/</turbo:source><turbo:topic>Cisco: Загрузка и выгрузка конфигурации</turbo:topic><turbo:content><![CDATA[<p>Рассмотрим способ загрузки и выгрузки (backup) конфигурации на устройствах <span class="shortcode shortcode-tag"><a href="/ru/tags/cisco/" target="_blank">#Cisco</a></span>.</p>
<h2 id="общая-настройка">
  <a class="link-body-emphasis" href="#%d0%be%d0%b1%d1%89%d0%b0%d1%8f-%d0%bd%d0%b0%d1%81%d1%82%d1%80%d0%be%d0%b9%d0%ba%d0%b0">Общая настройка</a>
</h2><p>Необходимо предварительно настроить сетевой интерфейс компьютера со следующими параметрами:</p>
<ul>
<li>IP-адрес: <code>192.168.1.2</code>.</li>
<li>Маска подсети: <code>255.255.255.0</code>.</li>
<li>Шлюз: <code>192.168.1.1</code>.</li>
<li>DNS: <code>8.8.8.8</code>.</li>
</ul>
<p>Теперь настроим сетевой интерфейс <code>FE0/1</code> на <span class="shortcode shortcode-tag"><a href="/ru/tags/cisco/" target="_blank">#Cisco</a></span>:</p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-0
shortcode-codeblock-plaintext">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-72ec3a6ae984012ebe3f62ceb98203cc" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-plaintext" data-lang="plaintext"><span class="line"><span class="cl"># conf t
</span></span><span class="line"><span class="cl">(config)# int fa0/1
</span></span><span class="line"><span class="cl">(config-if)# ip address 192.168.1.1 255.255.255.0
</span></span><span class="line"><span class="cl">(config-if)# no shutdown
</span></span><span class="line"><span class="cl">(config-if)# exit
</span></span><span class="line"><span class="cl">(config)# exit
</span></span><span class="line"><span class="cl">#</span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-72ec3a6ae984012ebe3f62ceb98203cc"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<p>После предварительных настроек, подключим сетевой интерфейс компьютера к сетевому интерфейсу <span class="shortcode shortcode-tag"><a href="/ru/tags/cisco/" target="_blank">#Cisco</a></span> <code>FE0/1</code> и запустим TFTP-сервер на компьютере c IP <code>192.168.1.2</code>.</p>
<h2 id="загрузка-конфигурации">
  <a class="link-body-emphasis" href="#%d0%b7%d0%b0%d0%b3%d1%80%d1%83%d0%b7%d0%ba%d0%b0-%d0%ba%d0%be%d0%bd%d1%84%d0%b8%d0%b3%d1%83%d1%80%d0%b0%d1%86%d0%b8%d0%b8">Загрузка конфигурации</a>
</h2><p>Для того, чтобы загрузить конфигурацию с TFTP-сервера, необходимо выполнить следующую команду:</p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-1
shortcode-codeblock-plaintext">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-4d9f8a7ac9dac9b3f4a03ac90e256303" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-plaintext" data-lang="plaintext"><span class="line"><span class="cl"># copy tftp://192.168.1.2/BACKUP_CONF_FILE startup-config</span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-4d9f8a7ac9dac9b3f4a03ac90e256303"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<p>Где:</p>
<ul>
<li><code>tftp://192.168.1.2/BACKUP_CONF_FILE</code> - источник, адрес TFTP-сервера и путь к файлу конфигурации.</li>
<li><code>startup-config</code> - назначение, хранилище стартовой конфигурации.</li>
</ul>
<h2 id="выгрузка-конфигурации">
  <a class="link-body-emphasis" href="#%d0%b2%d1%8b%d0%b3%d1%80%d1%83%d0%b7%d0%ba%d0%b0-%d0%ba%d0%be%d0%bd%d1%84%d0%b8%d0%b3%d1%83%d1%80%d0%b0%d1%86%d0%b8%d0%b8">Выгрузка конфигурации</a>
</h2><p>Для выгрузки конфигурации <span class="shortcode shortcode-tag"><a href="/ru/tags/cisco/" target="_blank">#Cisco</a></span> на внешний TFTP-сервер, можно воспользоваться следующей командой:</p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-2
shortcode-codeblock-plaintext">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-5ffb3b50e95f82c3cf9cf4f744139db4" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-plaintext" data-lang="plaintext"><span class="line"><span class="cl"># copy startup-config tftp://192.168.1.2/BACKUP_CONF_FILE</span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-5ffb3b50e95f82c3cf9cf4f744139db4"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<p>Где:</p>
<ul>
<li><code>startup-config</code> - источник, хранилище стартовой конфигурации.</li>
<li><code>tftp://192.168.1.2/BACKUP_CONF_FILE</code> - назначение, адрес TFTP-сервера и название файла конфигурации.</li>
</ul>]]></turbo:content></item><item turbo="true"><title>Cisco: Сброс пароля</title><link>https://lib.onl/ru/2024/03/fc67eb74-8f7c-5de3-bd1e-2d823208eae2/</link><pubDate>Tue, 26 Mar 2024 12:07:17 +0000</pubDate><dc:creator>Kai Kimera</dc:creator><category>Сеть</category><category>Терминал</category><turbo:extendedHtml>true</turbo:extendedHtml><turbo:source>https://lib.onl/ru/2024/03/fc67eb74-8f7c-5de3-bd1e-2d823208eae2/</turbo:source><turbo:topic>Cisco: Сброс пароля</turbo:topic><turbo:content><![CDATA[<p>Инструкция по сбросу пароля администратора в готовой конфигурации на устройствах <span class="shortcode shortcode-tag"><a href="/ru/tags/cisco/" target="_blank">#Cisco</a></span>.</p>
<ol>
<li>Подключиться к COM-порту <span class="shortcode shortcode-tag"><a href="/ru/tags/cisco/" target="_blank">#Cisco</a></span>.</li>
<li>Загрузиться в <strong>ROMMON</strong> (при старте <span class="shortcode shortcode-tag"><a href="/ru/tags/cisco/" target="_blank">#Cisco</a></span> нажать клавишу <span class="shortcode shortcode-key d-inline-block"><kbd>Break</kbd></span>).</li>
</ol>
<p>Далее, необходимо переключить регистр с <code>0x2102</code> на <code>0x2142</code> и перезагрузить оборудование:</p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-0
shortcode-codeblock-plaintext">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-f37b8f5bf8b064dadef91b4d09a13827" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-plaintext" data-lang="plaintext"><span class="line"><span class="cl">rommon&gt; confreg 0x2142
</span></span><span class="line"><span class="cl">rommon&gt; reset</span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-f37b8f5bf8b064dadef91b4d09a13827"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<p>После перезагрузки оборудования, можно сбросить пароль. Переходим  режим конфигурирования:</p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-1
shortcode-codeblock-plaintext">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-c85496e652f80c7e6028548804183c63" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-plaintext" data-lang="plaintext"><span class="line"><span class="cl">&gt; en</span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-c85496e652f80c7e6028548804183c63"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<p>Импортируем стартовую конфигурацию в текущую:</p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-2
shortcode-codeblock-plaintext">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-86ceedffe9a8152016dfbf628b5502a8" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-plaintext" data-lang="plaintext"><span class="line"><span class="cl"># copy startup-config running-config</span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-86ceedffe9a8152016dfbf628b5502a8"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<p>Отлично. Сейчас мы находимся в режиме полного контроля и в конфигурации, к которой ранее не было доступа. Теперь сбрасываем пароль у необходимого пользователя:</p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-3
shortcode-codeblock-plaintext">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-47d760b1e02cb7d4e2e8c8982df1ce28" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-plaintext" data-lang="plaintext"><span class="line"><span class="cl"># config t
</span></span><span class="line"><span class="cl">(config)# en secret PassWord
</span></span><span class="line"><span class="cl">(config)# username USER privilege 15 secret PassWord</span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-47d760b1e02cb7d4e2e8c8982df1ce28"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<p>Далее, нужно не забыть переключить регистр обратно, с <code>0x2142</code> на <code>0x2102</code>:</p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-4
shortcode-codeblock-plaintext">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-cbb38348518cf06087b74e01071d1022" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-plaintext" data-lang="plaintext"><span class="line"><span class="cl">(config)# config-register 0x2102
</span></span><span class="line"><span class="cl">(config)# exit</span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-cbb38348518cf06087b74e01071d1022"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<p>Теперь экспортируем текущую конфигурацию обратно в стартовую:</p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-5
shortcode-codeblock-plaintext">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-d670ec9d5ecbb2ebae9e7b41cac54e88" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-plaintext" data-lang="plaintext"><span class="line"><span class="cl"># copy running-config startup-config
</span></span><span class="line"><span class="cl"># reload</span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-d670ec9d5ecbb2ebae9e7b41cac54e88"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<p>Таким образом мы &ldquo;обманули&rdquo; Cisco. Мы загрузились в чистую конфигурацию под администратором и импортировали в неё стартовую конфигурацию, к которой у нас не было доступа. Поменяли пароль и экспортировали текущую конфигурацию обратно в стартовую.</p>
<p>Готово!</p>]]></turbo:content></item><item turbo="true"><title>Работа с ZFS</title><link>https://lib.onl/ru/2024/03/6c7a038f-f41e-5a45-a285-b99fdacf82d4/</link><pubDate>Fri, 08 Mar 2024 10:29:06 +0000</pubDate><dc:creator>Kai Kimera</dc:creator><category>BSD</category><category>Linux</category><category>В доработке</category><yandex:related><link url="https://lib.onl/ru/2024/02/f97dc310-9a6a-52f7-8441-bf7eb02087c2/">Первичная настройка FreeBSD</link></yandex:related><turbo:extendedHtml>true</turbo:extendedHtml><turbo:source>https://lib.onl/ru/2024/03/6c7a038f-f41e-5a45-a285-b99fdacf82d4/</turbo:source><turbo:topic>Работа с ZFS</turbo:topic><turbo:content><![CDATA[<p>Я всё чаще стал использовать файловую систему <span class="shortcode shortcode-tag"><a href="/ru/tags/zfs/" target="_blank">#ZFS</a></span> и для себя составил шпаргалку по работе с ней. Может быть, кому то ещё пригодится.</p>
<h2 id="вводные-данные">
  <a class="link-body-emphasis" href="#%d0%b2%d0%b2%d0%be%d0%b4%d0%bd%d1%8b%d0%b5-%d0%b4%d0%b0%d0%bd%d0%bd%d1%8b%d0%b5">Вводные данные</a>
</h2><p>В работе с <span class="shortcode shortcode-tag"><a href="/ru/tags/zfs/" target="_blank">#ZFS</a></span> я использую ОС <span class="shortcode shortcode-tag"><a href="/ru/tags/debian/" target="_blank">#Debian</a></span> и пути к дискам (<code>by-path</code>). Если кто-то захочет использовать идентификаторы (<code>by-id</code>) дисков, то просто замените в командах пути на идентификаторы.</p>
<p>В командах этой статьи я работаю в пулом под названием <code>data</code>. Все вводные переменные я выношу за пределы команды и объявляю отдельно. Не знаю откуда у меня возникла такая привычка. <span class="shortcode shortcode-emoji">😄</span></p>
<h3 id="список-дисков-и-их-расположение">
  <a class="link-body-emphasis" href="#%d1%81%d0%bf%d0%b8%d1%81%d0%be%d0%ba-%d0%b4%d0%b8%d1%81%d0%ba%d0%be%d0%b2-%d0%b8-%d0%b8%d1%85-%d1%80%d0%b0%d1%81%d0%bf%d0%be%d0%bb%d0%be%d0%b6%d0%b5%d0%bd%d0%b8%d0%b5">Список дисков и их расположение</a>
</h3><p>Вывести список дисков и их расположение (путь) в системе:</p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-0
shortcode-codeblock-bash">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-cd541743a09190ed22ac4bfd1fa48965" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">ls -l <span class="s1">&#39;/dev/disk/by-path/&#39;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-cd541743a09190ed22ac4bfd1fa48965"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<h3 id="список-дисков-и-их-идентификаторы">
  <a class="link-body-emphasis" href="#%d1%81%d0%bf%d0%b8%d1%81%d0%be%d0%ba-%d0%b4%d0%b8%d1%81%d0%ba%d0%be%d0%b2-%d0%b8-%d0%b8%d1%85-%d0%b8%d0%b4%d0%b5%d0%bd%d1%82%d0%b8%d1%84%d0%b8%d0%ba%d0%b0%d1%82%d0%be%d1%80%d1%8b">Список дисков и их идентификаторы</a>
</h3><p>Вывести список дисков и их идентификаторы в системе:</p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-1
shortcode-codeblock-bash">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-867c8890f8b64a0156f14a3e14f309fb" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">ls -l <span class="s1">&#39;/dev/disk/by-id/&#39;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-867c8890f8b64a0156f14a3e14f309fb"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<h2 id="пулы">
  <a class="link-body-emphasis" href="#%d0%bf%d1%83%d0%bb%d1%8b">Пулы</a>
</h2><p>Рассмотрим различные варианты работы с пулами <span class="shortcode shortcode-tag"><a href="/ru/tags/zfs/" target="_blank">#ZFS</a></span>.</p>
<h3 id="создание-пула">
  <a class="link-body-emphasis" href="#%d1%81%d0%be%d0%b7%d0%b4%d0%b0%d0%bd%d0%b8%d0%b5-%d0%bf%d1%83%d0%bb%d0%b0">Создание пула</a>
</h3><p>Создание обычного пула <code>data</code> из одного диска <code>pci-0000:01:00.0-scsi-0:1:0:0</code>:</p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-2
shortcode-codeblock-bash">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-4073262b90a0e8f50f6b15aaf44c8ecd" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="nv">p</span><span class="o">=</span><span class="s1">&#39;data&#39;</span><span class="p">;</span> zpool create -o <span class="s1">&#39;ashift=12&#39;</span> -O <span class="s1">&#39;atime=off&#39;</span> <span class="s2">&#34;</span><span class="si">${</span><span class="nv">p</span><span class="si">}</span><span class="s2">&#34;</span> <span class="s1">&#39;pci-0000:01:00.0-scsi-0:1:0:0&#39;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-4073262b90a0e8f50f6b15aaf44c8ecd"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<h3 id="расширение-пула">
  <a class="link-body-emphasis" href="#%d1%80%d0%b0%d1%81%d1%88%d0%b8%d1%80%d0%b5%d0%bd%d0%b8%d0%b5-%d0%bf%d1%83%d0%bb%d0%b0">Расширение пула</a>
</h3><p>Расширение пула происходит путём добавления дополнительного диска или увеличением размера виртуального диска.</p>
<h4 id="добавление-диска-в-пул">
  <a class="link-body-emphasis" href="#%d0%b4%d0%be%d0%b1%d0%b0%d0%b2%d0%bb%d0%b5%d0%bd%d0%b8%d0%b5-%d0%b4%d0%b8%d1%81%d0%ba%d0%b0-%d0%b2-%d0%bf%d1%83%d0%bb">Добавление диска в пул</a>
</h4><p>Добавление диска <code>pci-0000:01:00.0-scsi-0:1:1:0</code> в пул <code>data</code>:</p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-3
shortcode-codeblock-bash">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-6828bb8d3823f4d724f3437b25ec2284" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="nv">p</span><span class="o">=</span><span class="s1">&#39;data&#39;</span><span class="p">;</span> zpool add <span class="s2">&#34;</span><span class="si">${</span><span class="nv">p</span><span class="si">}</span><span class="s2">&#34;</span> <span class="s1">&#39;pci-0000:01:00.0-scsi-0:1:1:0&#39;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-6828bb8d3823f4d724f3437b25ec2284"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<h4 id="расширение-диска-в-пуле">
  <a class="link-body-emphasis" href="#%d1%80%d0%b0%d1%81%d1%88%d0%b8%d1%80%d0%b5%d0%bd%d0%b8%d0%b5-%d0%b4%d0%b8%d1%81%d0%ba%d0%b0-%d0%b2-%d0%bf%d1%83%d0%bb%d0%b5">Расширение диска в пуле</a>
</h4><p>Расширение существующего диска <code>pci-0000:03:00.0-scsi-0:1:0:0</code> в пуле <code>data</code>:</p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-4
shortcode-codeblock-bash">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-35b0d4b821433b0aee8699deaf553a2d" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="nv">p</span><span class="o">=</span><span class="s1">&#39;data&#39;</span><span class="p">;</span> zpool online -e <span class="s2">&#34;</span><span class="si">${</span><span class="nv">p</span><span class="si">}</span><span class="s2">&#34;</span> <span class="s1">&#39;pci-0000:03:00.0-scsi-0:1:0:0&#39;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-35b0d4b821433b0aee8699deaf553a2d"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<p>Включение автоматического расширения пула <code>data</code>:</p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-5
shortcode-codeblock-bash">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-995cbb135c3e4f1fdc43755f6e6204ba" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="nv">p</span><span class="o">=</span><span class="s1">&#39;data&#39;</span><span class="p">;</span> zpool <span class="nb">set</span> <span class="s1">&#39;autoexpand=on&#39;</span> <span class="s2">&#34;</span><span class="si">${</span><span class="nv">p</span><span class="si">}</span><span class="s2">&#34;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-995cbb135c3e4f1fdc43755f6e6204ba"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<h3 id="подключение-и-отключение-дисков">
  <a class="link-body-emphasis" href="#%d0%bf%d0%be%d0%b4%d0%ba%d0%bb%d1%8e%d1%87%d0%b5%d0%bd%d0%b8%d0%b5-%d0%b8-%d0%be%d1%82%d0%ba%d0%bb%d1%8e%d1%87%d0%b5%d0%bd%d0%b8%d0%b5-%d0%b4%d0%b8%d1%81%d0%ba%d0%be%d0%b2">Подключение и отключение дисков</a>
</h3><p>Подключение и отключение дисков осуществляются командами <code>attach</code> и <code>detach</code>, соответственно.</p>
<h4 id="подключение-второго-диска-для-создания-зеркала">
  <a class="link-body-emphasis" href="#%d0%bf%d0%be%d0%b4%d0%ba%d0%bb%d1%8e%d1%87%d0%b5%d0%bd%d0%b8%d0%b5-%d0%b2%d1%82%d0%be%d1%80%d0%be%d0%b3%d0%be-%d0%b4%d0%b8%d1%81%d0%ba%d0%b0-%d0%b4%d0%bb%d1%8f-%d1%81%d0%be%d0%b7%d0%b4%d0%b0%d0%bd%d0%b8%d1%8f-%d0%b7%d0%b5%d1%80%d0%ba%d0%b0%d0%bb%d0%b0">Подключение второго диска (для создания зеркала)</a>
</h4><p>Подключение нового диска <code>pci-0000:03:00.0-scsi-0:1:1:0</code> к существующему диску <code>pci-0000:03:00.0-scsi-0:1:0:0</code> в пуле <code>data</code> для создания зеркала:</p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-6
shortcode-codeblock-bash">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-a2849dbbb03f2d9e6d8e29638d8cc6d0" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="nv">p</span><span class="o">=</span><span class="s1">&#39;data&#39;</span><span class="p">;</span> zpool attach <span class="s2">&#34;</span><span class="si">${</span><span class="nv">p</span><span class="si">}</span><span class="s2">&#34;</span> <span class="s1">&#39;pci-0000:03:00.0-scsi-0:1:0:0&#39;</span> <span class="s1">&#39;pci-0000:03:00.0-scsi-0:1:1:0&#39;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-a2849dbbb03f2d9e6d8e29638d8cc6d0"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<h4 id="отключение-второго-диска">
  <a class="link-body-emphasis" href="#%d0%be%d1%82%d0%ba%d0%bb%d1%8e%d1%87%d0%b5%d0%bd%d0%b8%d0%b5-%d0%b2%d1%82%d0%be%d1%80%d0%be%d0%b3%d0%be-%d0%b4%d0%b8%d1%81%d0%ba%d0%b0">Отключение второго диска</a>
</h4><p>Отключение нового диска <code>pci-0000:03:00.0-scsi-0:1:1:0</code> в пуле <code>data</code>:</p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-7
shortcode-codeblock-bash">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-82ee27750ac98841dafab22193a7a559" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="nv">p</span><span class="o">=</span><span class="s1">&#39;data&#39;</span><span class="p">;</span> zpool detach <span class="s2">&#34;</span><span class="si">${</span><span class="nv">p</span><span class="si">}</span><span class="s2">&#34;</span> <span class="s1">&#39;pci-0000:03:00.0-scsi-0:1:1:0&#39;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-82ee27750ac98841dafab22193a7a559"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<h3 id="импортирование-пула">
  <a class="link-body-emphasis" href="#%d0%b8%d0%bc%d0%bf%d0%be%d1%80%d1%82%d0%b8%d1%80%d0%be%d0%b2%d0%b0%d0%bd%d0%b8%d0%b5-%d0%bf%d1%83%d0%bb%d0%b0">Импортирование пула</a>
</h3><p>Импортировать пул <code>data</code>, состоящий из дисков <code>pci-0000:01:00.0-scsi-0:1:0:0</code> и <code>pci-0000:01:00.0-scsi-0:1:1:0</code>:</p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-8
shortcode-codeblock-bash">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-8c588491463aa81ee356fe4ca6dff7b1" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="nv">p</span><span class="o">=</span><span class="s1">&#39;data&#39;</span><span class="p">;</span> zpool import -d <span class="s1">&#39;pci-0000:01:00.0-scsi-0:1:0:0&#39;</span> -d <span class="s1">&#39;pci-0000:01:00.0-scsi-0:1:1:0&#39;</span> <span class="s2">&#34;</span><span class="si">${</span><span class="nv">p</span><span class="si">}</span><span class="s2">&#34;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-8c588491463aa81ee356fe4ca6dff7b1"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<p>Или можно разрешить <span class="shortcode shortcode-tag"><a href="/ru/tags/zfs/" target="_blank">#ZFS</a></span> автоматически поискать диски пула <code>data</code>:</p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-9
shortcode-codeblock-bash">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-c2ec58b77368c2e9318f8085cd8a502f" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="nv">p</span><span class="o">=</span><span class="s1">&#39;data&#39;</span><span class="p">;</span> zpool import -d <span class="s1">&#39;/dev/disk/by-path/&#39;</span> <span class="s2">&#34;</span><span class="si">${</span><span class="nv">p</span><span class="si">}</span><span class="s2">&#34;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-c2ec58b77368c2e9318f8085cd8a502f"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<h3 id="переименования-пула">
  <a class="link-body-emphasis" href="#%d0%bf%d0%b5%d1%80%d0%b5%d0%b8%d0%bc%d0%b5%d0%bd%d0%be%d0%b2%d0%b0%d0%bd%d0%b8%d1%8f-%d0%bf%d1%83%d0%bb%d0%b0">Переименования пула</a>
</h3><p>Для переименования пула, необходимо сначала его экспортировать:</p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-10
shortcode-codeblock-bash">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-8bc58b87ff23550dcf67efeb15041dde" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="nv">p</span><span class="o">=</span><span class="s1">&#39;data&#39;</span><span class="p">;</span> zpool <span class="nb">export</span> <span class="s2">&#34;</span><span class="si">${</span><span class="nv">p</span><span class="si">}</span><span class="s2">&#34;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-8bc58b87ff23550dcf67efeb15041dde"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<p>И импортировать с новым именем:</p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-11
shortcode-codeblock-bash">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-033e541e47bbb47788bae31da4b64a97" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="nv">p</span><span class="o">=</span><span class="s1">&#39;data_old&#39;</span><span class="p">;</span> <span class="nv">n</span><span class="o">=</span><span class="s1">&#39;data_new&#39;</span><span class="p">;</span> zpool import <span class="s2">&#34;</span><span class="si">${</span><span class="nv">p</span><span class="si">}</span><span class="s2">&#34;</span> <span class="s2">&#34;</span><span class="si">${</span><span class="nv">n</span><span class="si">}</span><span class="s2">&#34;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-033e541e47bbb47788bae31da4b64a97"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<h3 id="обновление-пула">
  <a class="link-body-emphasis" href="#%d0%be%d0%b1%d0%bd%d0%be%d0%b2%d0%bb%d0%b5%d0%bd%d0%b8%d0%b5-%d0%bf%d1%83%d0%bb%d0%b0">Обновление пула</a>
</h3><p>Проверим необходимость обновления пула:</p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-12
shortcode-codeblock-bash">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-40d14f6faf7bf6b0e38fd61984857a2b" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">zpool status -v</span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-40d14f6faf7bf6b0e38fd61984857a2b"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<p>Если появится надпись <code>status: Some supported features are not enabled on the pool...</code>, то можно начать обновление пула <code>data</code>:</p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-13
shortcode-codeblock-bash">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-ca490754ba07610a9b43add5a3e93def" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="nv">p</span><span class="o">=</span><span class="s1">&#39;data&#39;</span><span class="p">;</span> zpool upgrade <span class="s2">&#34;</span><span class="si">${</span><span class="nv">p</span><span class="si">}</span><span class="s2">&#34;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-ca490754ba07610a9b43add5a3e93def"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<p>Или обновить сразу все пулы:</p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-14
shortcode-codeblock-bash">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-fda78291c78c087a95c96b58b12c1510" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">zpool upgrade -a</span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-fda78291c78c087a95c96b58b12c1510"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<h3 id="удаление-пула">
  <a class="link-body-emphasis" href="#%d1%83%d0%b4%d0%b0%d0%bb%d0%b5%d0%bd%d0%b8%d0%b5-%d0%bf%d1%83%d0%bb%d0%b0">Удаление пула</a>
</h3><p>Если пул <code>data</code> стал не нужен, его можно удалить:</p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-15
shortcode-codeblock-bash">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-039389d16fefa9e4e9b4911d4ca5562a" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="nv">p</span><span class="o">=</span><span class="s1">&#39;data&#39;</span><span class="p">;</span> zpool destroy <span class="s2">&#34;</span><span class="si">${</span><span class="nv">p</span><span class="si">}</span><span class="s2">&#34;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-039389d16fefa9e4e9b4911d4ca5562a"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<h3 id="список-пулов">
  <a class="link-body-emphasis" href="#%d1%81%d0%bf%d0%b8%d1%81%d0%be%d0%ba-%d0%bf%d1%83%d0%bb%d0%be%d0%b2">Список пулов</a>
</h3><p>Вывести список всех пулов в системе:</p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-16
shortcode-codeblock-bash">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-2e582a9c465c1ef1619d99a67cad00b4" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">zpool list</span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-2e582a9c465c1ef1619d99a67cad00b4"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<h3 id="статус-пула">
  <a class="link-body-emphasis" href="#%d1%81%d1%82%d0%b0%d1%82%d1%83%d1%81-%d0%bf%d1%83%d0%bb%d0%b0">Статус пула</a>
</h3><p>Проверить статус пула <code>data</code>:</p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-17
shortcode-codeblock-bash">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-2200a5b7089945f1cfd61c477755285e" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="nv">p</span><span class="o">=</span><span class="s1">&#39;data&#39;</span><span class="p">;</span> zpool status -v <span class="s2">&#34;</span><span class="si">${</span><span class="nv">p</span><span class="si">}</span><span class="s2">&#34;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-2200a5b7089945f1cfd61c477755285e"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<h3 id="работа-с-raid">
  <a class="link-body-emphasis" href="#%d1%80%d0%b0%d0%b1%d0%be%d1%82%d0%b0-%d1%81-raid">Работа с RAID</a>
</h3><p>Рассмотрим команды создания пула <span class="shortcode shortcode-tag"><a href="/ru/tags/zfs/" target="_blank">#ZFS</a></span> из нескольких дисков.</p>
<h4 id="stripe-raid0">
  <a class="link-body-emphasis" href="#stripe-raid0">Stripe (RAID0)</a>
</h4><p>Создать <strong>RAID-0</strong> из дисков <code>pci-0000:01:00.0-scsi-0:1:0:0</code> и <code>pci-0000:01:00.0-scsi-0:1:1:0</code>:</p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-18
shortcode-codeblock-bash">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-c9b4d4767fc1e6021739e94873db05f6" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="nv">p</span><span class="o">=</span><span class="s1">&#39;data&#39;</span><span class="p">;</span> zpool create -o <span class="s1">&#39;ashift=12&#39;</span> -O <span class="s1">&#39;atime=off&#39;</span> <span class="s2">&#34;</span><span class="si">${</span><span class="nv">p</span><span class="si">}</span><span class="s2">&#34;</span> <span class="s1">&#39;pci-0000:01:00.0-scsi-0:1:0:0&#39;</span> <span class="s1">&#39;pci-0000:01:00.0-scsi-0:1:1:0&#39;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-c9b4d4767fc1e6021739e94873db05f6"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<h4 id="mirror-raid1">
  <a class="link-body-emphasis" href="#mirror-raid1">Mirror (RAID1)</a>
</h4><p>Создать зеркало (<strong>RAID-1</strong>) из дисков <code>pci-0000:01:00.0-scsi-0:1:0:0</code> и <code>pci-0000:01:00.0-scsi-0:1:1:0</code>:</p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-19
shortcode-codeblock-bash">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-0d20e7f42e6a9c90d042d76c8bf7f3ce" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="nv">p</span><span class="o">=</span><span class="s1">&#39;data&#39;</span><span class="p">;</span> zpool create -o <span class="s1">&#39;ashift=12&#39;</span> -O <span class="s1">&#39;atime=off&#39;</span> <span class="s2">&#34;</span><span class="si">${</span><span class="nv">p</span><span class="si">}</span><span class="s2">&#34;</span> mirror <span class="s1">&#39;pci-0000:01:00.0-scsi-0:1:0:0&#39;</span> <span class="s1">&#39;pci-0000:01:00.0-scsi-0:1:1:0&#39;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-0d20e7f42e6a9c90d042d76c8bf7f3ce"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<h4 id="raid10">
  <a class="link-body-emphasis" href="#raid10">RAID10</a>
</h4><p>Создать <strong>RAID-10</strong> из дисков <code>pci-0000:01:00.0-scsi-0:1:0:0</code>, <code>pci-0000:01:00.0-scsi-0:1:1:0</code>, <code>pci-0000:01:00.0-scsi-0:1:2:0</code> и <code>pci-0000:01:00.0-scsi-0:1:3:0</code>:</p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-20
shortcode-codeblock-bash">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-56182a27ff5eca1a51f9152c1a7e0cfc" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="nv">p</span><span class="o">=</span><span class="s1">&#39;data&#39;</span><span class="p">;</span> zpool create -o <span class="s1">&#39;ashift=12&#39;</span> -O <span class="s1">&#39;atime=off&#39;</span> <span class="s2">&#34;</span><span class="si">${</span><span class="nv">p</span><span class="si">}</span><span class="s2">&#34;</span> mirror <span class="s1">&#39;pci-0000:01:00.0-scsi-0:1:0:0&#39;</span> <span class="s1">&#39;pci-0000:01:00.0-scsi-0:1:1:0&#39;</span> mirror <span class="s1">&#39;pci-0000:01:00.0-scsi-0:1:2:0&#39;</span> <span class="s1">&#39;pci-0000:01:00.0-scsi-0:1:3:0&#39;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-56182a27ff5eca1a51f9152c1a7e0cfc"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<h4 id="raidz-1-raid5">
  <a class="link-body-emphasis" href="#raidz-1-raid5">RAIDZ-1 (RAID5)</a>
</h4><p>Создать <strong>RAID-5</strong> из дисков <code>pci-0000:01:00.0-scsi-0:1:0:0</code>, <code>pci-0000:01:00.0-scsi-0:1:1:0</code> и <code>pci-0000:01:00.0-scsi-0:1:2:0</code>:</p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-21
shortcode-codeblock-bash">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-260b50dcf9fc74e061a1abf6a49080df" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="nv">p</span><span class="o">=</span><span class="s1">&#39;data&#39;</span><span class="p">;</span> zpool create -o <span class="s1">&#39;ashift=12&#39;</span> -O <span class="s1">&#39;atime=off&#39;</span> <span class="s2">&#34;</span><span class="si">${</span><span class="nv">p</span><span class="si">}</span><span class="s2">&#34;</span> raidz <span class="s1">&#39;pci-0000:01:00.0-scsi-0:1:0:0&#39;</span> <span class="s1">&#39;pci-0000:01:00.0-scsi-0:1:1:0&#39;</span> <span class="s1">&#39;pci-0000:01:00.0-scsi-0:1:2:0&#39;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-260b50dcf9fc74e061a1abf6a49080df"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<h4 id="raidz-2-raid6">
  <a class="link-body-emphasis" href="#raidz-2-raid6">RAIDZ-2 (RAID6)</a>
</h4><p>Создать <strong>RAID-6</strong> из дисков <code>pci-0000:01:00.0-scsi-0:1:0:0</code>, <code>pci-0000:01:00.0-scsi-0:1:1:0</code>, <code>pci-0000:01:00.0-scsi-0:1:2:0</code> и <code>pci-0000:01:00.0-scsi-0:1:3:0</code></p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-22
shortcode-codeblock-bash">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-7a380304443440fc382654be031f7c11" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="nv">p</span><span class="o">=</span><span class="s1">&#39;data&#39;</span><span class="p">;</span> zpool create -o <span class="s1">&#39;ashift=12&#39;</span> -O <span class="s1">&#39;atime=off&#39;</span> <span class="s2">&#34;</span><span class="si">${</span><span class="nv">p</span><span class="si">}</span><span class="s2">&#34;</span> raidz2 <span class="s1">&#39;pci-0000:01:00.0-scsi-0:1:0:0&#39;</span> <span class="s1">&#39;pci-0000:01:00.0-scsi-0:1:1:0&#39;</span> <span class="s1">&#39;pci-0000:01:00.0-scsi-0:1:2:0&#39;</span> <span class="s1">&#39;pci-0000:01:00.0-scsi-0:1:3:0&#39;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-7a380304443440fc382654be031f7c11"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<h4 id="raidz-3">
  <a class="link-body-emphasis" href="#raidz-3">RAIDZ-3</a>
</h4><p>Создать <strong>RAIDZ-3</strong> из дисков <code>pci-0000:01:00.0-scsi-0:1:0:0</code> <code>pci-0000:01:00.0-scsi-0:1:1:0</code> <code>pci-0000:01:00.0-scsi-0:1:2:0</code> <code>pci-0000:01:00.0-scsi-0:1:3:0</code> и <code>pci-0000:01:00.0-scsi-0:1:4:0</code>:</p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-23
shortcode-codeblock-bash">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-33e54e73c1739f71ac51abe34a7b156f" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="nv">p</span><span class="o">=</span><span class="s1">&#39;data&#39;</span><span class="p">;</span> zpool create -o <span class="s1">&#39;ashift=12&#39;</span> -O <span class="s1">&#39;atime=off&#39;</span> <span class="s2">&#34;</span><span class="si">${</span><span class="nv">p</span><span class="si">}</span><span class="s2">&#34;</span> raidz3 <span class="s1">&#39;pci-0000:01:00.0-scsi-0:1:0:0&#39;</span> <span class="s1">&#39;pci-0000:01:00.0-scsi-0:1:1:0&#39;</span> <span class="s1">&#39;pci-0000:01:00.0-scsi-0:1:2:0&#39;</span> <span class="s1">&#39;pci-0000:01:00.0-scsi-0:1:3:0&#39;</span> <span class="s1">&#39;pci-0000:01:00.0-scsi-0:1:4:0&#39;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-33e54e73c1739f71ac51abe34a7b156f"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<h3 id="работа-с-arc-и-zil">
  <a class="link-body-emphasis" href="#%d1%80%d0%b0%d0%b1%d0%be%d1%82%d0%b0-%d1%81-arc-%d0%b8-zil">Работа с ARC и ZIL</a>
</h3><p>Добавляем отдельные устройства для работы с <strong>ARC</strong> и <strong>ZIL</strong>.</p>
<h4 id="arc">
  <a class="link-body-emphasis" href="#arc">ARC</a>
</h4><p>Добавить отдельный диск (<strong>L2ARC</strong>) <code>pci-0000:01:00.0-scsi-0:1:4:0</code> для работы с <strong>ARC</strong> в пул <code>data</code>:</p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-24
shortcode-codeblock-bash">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-d2148fc52a7c20c81e3fd946223a4edf" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="nv">p</span><span class="o">=</span><span class="s1">&#39;data&#39;</span><span class="p">;</span> zpool add <span class="s2">&#34;</span><span class="si">${</span><span class="nv">p</span><span class="si">}</span><span class="s2">&#34;</span> cache <span class="s1">&#39;pci-0000:01:00.0-scsi-0:1:4:0&#39;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-d2148fc52a7c20c81e3fd946223a4edf"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<h4 id="zil">
  <a class="link-body-emphasis" href="#zil">ZIL</a>
</h4><p>Добавить отдельный диск (<strong>SLOG</strong>) <code>pci-0000:01:00.0-scsi-0:1:5:0</code> для работы с <strong>ZIL</strong>  в пул <code>data</code>:</p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-25
shortcode-codeblock-bash">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-8a05a897322f0aa63b53fc1fb2bac0df" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="nv">p</span><span class="o">=</span><span class="s1">&#39;data&#39;</span><span class="p">;</span> zpool add <span class="s2">&#34;</span><span class="si">${</span><span class="nv">p</span><span class="si">}</span><span class="s2">&#34;</span> log <span class="s1">&#39;pci-0000:01:00.0-scsi-0:1:5:0&#39;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-8a05a897322f0aa63b53fc1fb2bac0df"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<h2 id="тома">
  <a class="link-body-emphasis" href="#%d1%82%d0%be%d0%bc%d0%b0">Тома</a>
</h2><h3 id="создание-тома">
  <a class="link-body-emphasis" href="#%d1%81%d0%be%d0%b7%d0%b4%d0%b0%d0%bd%d0%b8%d0%b5-%d1%82%d0%be%d0%bc%d0%b0">Создание тома</a>
</h3><p>Создать том <code>cloud</code> в пуле <code>data</code>:</p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-26
shortcode-codeblock-bash">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-7992eb5f59722362254ef213543f0fc7" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="nv">p</span><span class="o">=</span><span class="s1">&#39;data&#39;</span><span class="p">;</span> <span class="nv">v</span><span class="o">=</span><span class="s1">&#39;cloud&#39;</span><span class="p">;</span> zfs create <span class="s2">&#34;</span><span class="si">${</span><span class="nv">p</span><span class="si">}</span><span class="s2">/</span><span class="si">${</span><span class="nv">v</span><span class="si">}</span><span class="s2">&#34;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-7992eb5f59722362254ef213543f0fc7"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<p>Создать том <code>cloud</code> в пуле <code>data</code> и с точкой монтирования <code>/opt/cloud</code>:</p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-27
shortcode-codeblock-bash">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-12478ba50d6b34058c09882f78d3d815" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="nv">p</span><span class="o">=</span><span class="s1">&#39;data&#39;</span><span class="p">;</span> <span class="nv">v</span><span class="o">=</span><span class="s1">&#39;cloud&#39;</span><span class="p">;</span> zfs create -o <span class="s2">&#34;mountpoint=/opt/</span><span class="si">${</span><span class="nv">v</span><span class="si">}</span><span class="s2">&#34;</span> <span class="s2">&#34;</span><span class="si">${</span><span class="nv">p</span><span class="si">}</span><span class="s2">/</span><span class="si">${</span><span class="nv">v</span><span class="si">}</span><span class="s2">&#34;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-12478ba50d6b34058c09882f78d3d815"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<p>Создать том <code>cloud</code> в пуле <code>data</code> и с алгоритмом компрессии <code>zstd</code>:</p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-28
shortcode-codeblock-bash">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-269767dd971bdba9318b30df07a8863a" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="nv">p</span><span class="o">=</span><span class="s1">&#39;data&#39;</span><span class="p">;</span> <span class="nv">v</span><span class="o">=</span><span class="s1">&#39;cloud&#39;</span><span class="p">;</span> zfs create -o <span class="s1">&#39;compression=zstd&#39;</span> <span class="s2">&#34;</span><span class="si">${</span><span class="nv">p</span><span class="si">}</span><span class="s2">/</span><span class="si">${</span><span class="nv">v</span><span class="si">}</span><span class="s2">&#34;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-269767dd971bdba9318b30df07a8863a"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<p>Создать том <code>cloud</code> в пуле <code>data</code> с алгоритмом компрессии <code>zstd</code> и точкой монтирования <code>/opt/cloud</code>:</p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-29
shortcode-codeblock-bash">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-125142b93888ce13ff169e899e282b5f" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="nv">p</span><span class="o">=</span><span class="s1">&#39;data&#39;</span><span class="p">;</span> <span class="nv">v</span><span class="o">=</span><span class="s1">&#39;cloud&#39;</span><span class="p">;</span> zfs create -o <span class="s1">&#39;compression=zstd&#39;</span> -o <span class="s2">&#34;mountpoint=/opt/</span><span class="si">${</span><span class="nv">v</span><span class="si">}</span><span class="s2">&#34;</span> <span class="s2">&#34;</span><span class="si">${</span><span class="nv">p</span><span class="si">}</span><span class="s2">/</span><span class="si">${</span><span class="nv">v</span><span class="si">}</span><span class="s2">&#34;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-125142b93888ce13ff169e899e282b5f"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<h3 id="удаление-тома">
  <a class="link-body-emphasis" href="#%d1%83%d0%b4%d0%b0%d0%bb%d0%b5%d0%bd%d0%b8%d0%b5-%d1%82%d0%be%d0%bc%d0%b0">Удаление тома</a>
</h3><p>Удалить том <code>cloud</code> в пуле <code>data</code>:</p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-30
shortcode-codeblock-bash">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-3b2c8240eee6c924fbe34de7720290c8" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="nv">p</span><span class="o">=</span><span class="s1">&#39;data&#39;</span><span class="p">;</span> <span class="nv">v</span><span class="o">=</span><span class="s1">&#39;cloud&#39;</span><span class="p">;</span> zfs destroy <span class="s2">&#34;</span><span class="si">${</span><span class="nv">p</span><span class="si">}</span><span class="s2">/</span><span class="si">${</span><span class="nv">v</span><span class="si">}</span><span class="s2">&#34;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-3b2c8240eee6c924fbe34de7720290c8"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<h3 id="создание-зашифрованного-тома">
  <a class="link-body-emphasis" href="#%d1%81%d0%be%d0%b7%d0%b4%d0%b0%d0%bd%d0%b8%d0%b5-%d0%b7%d0%b0%d1%88%d0%b8%d1%84%d1%80%d0%be%d0%b2%d0%b0%d0%bd%d0%bd%d0%be%d0%b3%d0%be-%d1%82%d0%be%d0%bc%d0%b0">Создание зашифрованного тома</a>
</h3><p>Создать том <code>secret</code> в пуле <code>data</code> и зашифровать его парольной фразой:</p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-31
shortcode-codeblock-bash">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-7d06196f438f27de5267586d660dc909" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="nv">p</span><span class="o">=</span><span class="s1">&#39;data&#39;</span><span class="p">;</span> <span class="nv">v</span><span class="o">=</span><span class="s1">&#39;secret&#39;</span><span class="p">;</span> zfs create -o <span class="s1">&#39;encryption=on&#39;</span> -o <span class="s1">&#39;keyformat=passphrase&#39;</span> <span class="s2">&#34;</span><span class="si">${</span><span class="nv">p</span><span class="si">}</span><span class="s2">/</span><span class="si">${</span><span class="nv">v</span><span class="si">}</span><span class="s2">&#34;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-7d06196f438f27de5267586d660dc909"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<p>Где:</p>
<ul>
<li><code>encryption=on</code> - включение шифрования.</li>
<li><code>keyformat=passphrase</code> - тип шифрования &ldquo;парольная фраза&rdquo;.</li>
</ul>
<p>При создании тома <code>secret</code>, <span class="shortcode shortcode-tag"><a href="/ru/tags/zfs/" target="_blank">#ZFS</a></span> попросит ввести парольную фразу для шифрования данных.</p>
<h2 id="снимки">
  <a class="link-body-emphasis" href="#%d1%81%d0%bd%d0%b8%d0%bc%d0%ba%d0%b8">Снимки</a>
</h2><h3 id="список-снимков">
  <a class="link-body-emphasis" href="#%d1%81%d0%bf%d0%b8%d1%81%d0%be%d0%ba-%d1%81%d0%bd%d0%b8%d0%bc%d0%ba%d0%be%d0%b2">Список снимков</a>
</h3><p>Показать список всех снимков:</p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-32
shortcode-codeblock-bash">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-617e71d3e0ae9d7badc48ba7a5b016cc" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">zfs list -t <span class="s1">&#39;snapshot&#39;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-617e71d3e0ae9d7badc48ba7a5b016cc"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<p>Показать список снимков тома <code>cloud</code> в пуле <code>data</code>:</p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-33
shortcode-codeblock-bash">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-f56aa7fcd640d70cb35729b0de8f55a6" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="nv">p</span><span class="o">=</span><span class="s1">&#39;data&#39;</span><span class="p">;</span> <span class="nv">v</span><span class="o">=</span><span class="s1">&#39;cloud&#39;</span><span class="p">;</span> zfs list -r -t <span class="s1">&#39;snapshot&#39;</span> -o <span class="s1">&#39;name,creation&#39;</span> <span class="s2">&#34;</span><span class="si">${</span><span class="nv">p</span><span class="si">}</span><span class="s2">/</span><span class="si">${</span><span class="nv">v</span><span class="si">}</span><span class="s2">&#34;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-f56aa7fcd640d70cb35729b0de8f55a6"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<h3 id="создание-снимков">
  <a class="link-body-emphasis" href="#%d1%81%d0%be%d0%b7%d0%b4%d0%b0%d0%bd%d0%b8%d0%b5-%d1%81%d0%bd%d0%b8%d0%bc%d0%ba%d0%be%d0%b2">Создание снимков</a>
</h3><p>Создать снимок <code>2024-08-21.19-32-02</code> тома <code>cloud</code> в пуле <code>data</code>:</p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-34
shortcode-codeblock-bash">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-ad3802fc0787dd937dfc2ac6ce107e9c" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="nv">p</span><span class="o">=</span><span class="s1">&#39;data&#39;</span><span class="p">;</span> <span class="nv">v</span><span class="o">=</span><span class="s1">&#39;cloud&#39;</span><span class="p">;</span> <span class="nv">s</span><span class="o">=</span><span class="k">$(</span> date <span class="s1">&#39;+%F.%H-%M-%S&#39;</span> <span class="k">)</span><span class="p">;</span> zfs snapshot <span class="s2">&#34;</span><span class="si">${</span><span class="nv">p</span><span class="si">}</span><span class="s2">/</span><span class="si">${</span><span class="nv">v</span><span class="si">}</span><span class="s2">@</span><span class="si">${</span><span class="nv">s</span><span class="si">}</span><span class="s2">&#34;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-ad3802fc0787dd937dfc2ac6ce107e9c"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<p>Создать снимок <code>2024-08-21.19-32-02</code> тома <code>cloud</code> и всех его дочерних томов в пуле <code>data</code>:</p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-35
shortcode-codeblock-bash">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-54dba7ec5fca9dae24b0e57d288b2965" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="nv">p</span><span class="o">=</span><span class="s1">&#39;data&#39;</span><span class="p">;</span> <span class="nv">v</span><span class="o">=</span><span class="s1">&#39;cloud&#39;</span><span class="p">;</span> <span class="nv">s</span><span class="o">=</span><span class="k">$(</span> date <span class="s1">&#39;+%F.%H-%M-%S&#39;</span> <span class="k">)</span><span class="p">;</span> zfs snapshot -r <span class="s2">&#34;</span><span class="si">${</span><span class="nv">p</span><span class="si">}</span><span class="s2">/</span><span class="si">${</span><span class="nv">v</span><span class="si">}</span><span class="s2">@</span><span class="si">${</span><span class="nv">s</span><span class="si">}</span><span class="s2">&#34;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-54dba7ec5fca9dae24b0e57d288b2965"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<h3 id="переименование-снимков">
  <a class="link-body-emphasis" href="#%d0%bf%d0%b5%d1%80%d0%b5%d0%b8%d0%bc%d0%b5%d0%bd%d0%be%d0%b2%d0%b0%d0%bd%d0%b8%d0%b5-%d1%81%d0%bd%d0%b8%d0%bc%d0%ba%d0%be%d0%b2">Переименование снимков</a>
</h3><p>Переименовать снимок <code>name_OLD</code> тома <code>cloud</code> в пуле <code>data</code>:</p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-36
shortcode-codeblock-bash">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-a4061323247dfdb205cdaa5bc6990abb" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="nv">p</span><span class="o">=</span><span class="s1">&#39;data&#39;</span><span class="p">;</span> <span class="nv">v</span><span class="o">=</span><span class="s1">&#39;cloud&#39;</span><span class="p">;</span> zfs rename <span class="s2">&#34;</span><span class="si">${</span><span class="nv">p</span><span class="si">}</span><span class="s2">/</span><span class="si">${</span><span class="nv">v</span><span class="si">}</span><span class="s2">@name_OLD&#34;</span> <span class="s1">&#39;name_NEW&#39;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-a4061323247dfdb205cdaa5bc6990abb"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<p>Переименовать снимок <code>name_OLD</code> тома <code>cloud</code> и во всех его дочерних томов в пуле <code>data</code>:</p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-37
shortcode-codeblock-bash">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-216aff75e5890b63bc5f413ce3491d9f" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="nv">p</span><span class="o">=</span><span class="s1">&#39;data&#39;</span><span class="p">;</span> <span class="nv">v</span><span class="o">=</span><span class="s1">&#39;cloud&#39;</span><span class="p">;</span> zfs rename -r <span class="s2">&#34;</span><span class="si">${</span><span class="nv">p</span><span class="si">}</span><span class="s2">/</span><span class="si">${</span><span class="nv">v</span><span class="si">}</span><span class="s2">@name_OLD&#34;</span> <span class="s1">&#39;name_NEW&#39;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-216aff75e5890b63bc5f413ce3491d9f"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<h3 id="откат-данных-к-снимку">
  <a class="link-body-emphasis" href="#%d0%be%d1%82%d0%ba%d0%b0%d1%82-%d0%b4%d0%b0%d0%bd%d0%bd%d1%8b%d1%85-%d0%ba-%d1%81%d0%bd%d0%b8%d0%bc%d0%ba%d1%83">Откат данных к снимку</a>
</h3><p>Выполнить откат данных к снимку <code>2024-08-21.19-32-02</code> тома <code>cloud</code> в пуле <code>data</code>:</p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-38
shortcode-codeblock-bash">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-8c5f68b98c18d30a59f004222c50f55d" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="nv">p</span><span class="o">=</span><span class="s1">&#39;data&#39;</span><span class="p">;</span> <span class="nv">v</span><span class="o">=</span><span class="s1">&#39;cloud&#39;</span><span class="p">;</span> zfs rollback <span class="s2">&#34;</span><span class="si">${</span><span class="nv">p</span><span class="si">}</span><span class="s2">/</span><span class="si">${</span><span class="nv">v</span><span class="si">}</span><span class="s2">@2024-08-21.19-32-02&#34;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-8c5f68b98c18d30a59f004222c50f55d"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<h3 id="удаление-снимков">
  <a class="link-body-emphasis" href="#%d1%83%d0%b4%d0%b0%d0%bb%d0%b5%d0%bd%d0%b8%d0%b5-%d1%81%d0%bd%d0%b8%d0%bc%d0%ba%d0%be%d0%b2">Удаление снимков</a>
</h3><p>Удалить снимок <code>2024-08-21.19-32-02</code> тома <code>cloud</code> в пуле <code>data</code>:</p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-39
shortcode-codeblock-bash">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-7cc3aa1777f914d7d7a4c5f13561ade2" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="nv">p</span><span class="o">=</span><span class="s1">&#39;data&#39;</span><span class="p">;</span> <span class="nv">v</span><span class="o">=</span><span class="s1">&#39;cloud&#39;</span><span class="p">;</span> zfs destroy <span class="s2">&#34;</span><span class="si">${</span><span class="nv">p</span><span class="si">}</span><span class="s2">/</span><span class="si">${</span><span class="nv">v</span><span class="si">}</span><span class="s2">@2024-08-21.19-32-02&#34;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-7cc3aa1777f914d7d7a4c5f13561ade2"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<h2 id="оптимизации">
  <a class="link-body-emphasis" href="#%d0%be%d0%bf%d1%82%d0%b8%d0%bc%d0%b8%d0%b7%d0%b0%d1%86%d0%b8%d0%b8">Оптимизации</a>
</h2><p>Специализированные настройки <span class="shortcode shortcode-tag"><a href="/ru/tags/zfs/" target="_blank">#ZFS</a></span> под конкретные задачи.</p>
<h3 id="postgresql">
  <a class="link-body-emphasis" href="#postgresql">PostgreSQL</a>
</h3><p>Создать основной том <code>pgsql</code> с алгоритмом компрессии <code>zstd</code>:</p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-40
shortcode-codeblock-bash">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-9b8883777d0b158419b91ab5b80541c2" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="nv">p</span><span class="o">=</span><span class="s1">&#39;data&#39;</span><span class="p">;</span> <span class="nv">v</span><span class="o">=</span><span class="s1">&#39;pgsql&#39;</span><span class="p">;</span> zfs create -o <span class="s1">&#39;compression=zstd&#39;</span> <span class="s2">&#34;</span><span class="si">${</span><span class="nv">p</span><span class="si">}</span><span class="s2">/</span><span class="si">${</span><span class="nv">v</span><span class="si">}</span><span class="s2">&#34;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-9b8883777d0b158419b91ab5b80541c2"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<p>Создать специальный том <code>pgsql/main</code> с алгоритмом компрессии <code>zstd</code> и размером блока <code>32K</code> для баз данных:</p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-41
shortcode-codeblock-bash">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-245e71a15a5c4c148a065c6471d5b8df" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="nv">p</span><span class="o">=</span><span class="s1">&#39;data&#39;</span><span class="p">;</span> <span class="nv">v</span><span class="o">=</span><span class="s1">&#39;pgsql/main&#39;</span><span class="p">;</span> zfs create -o <span class="s1">&#39;recordsize=32K&#39;</span> <span class="s2">&#34;</span><span class="si">${</span><span class="nv">p</span><span class="si">}</span><span class="s2">/</span><span class="si">${</span><span class="nv">v</span><span class="si">}</span><span class="s2">&#34;</span> <span class="o">&amp;&amp;</span> chmod <span class="m">700</span> <span class="s2">&#34;/</span><span class="si">${</span><span class="nv">p</span><span class="si">}</span><span class="s2">/</span><span class="si">${</span><span class="nv">v</span><span class="si">}</span><span class="s2">&#34;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-245e71a15a5c4c148a065c6471d5b8df"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<p>Создать специальный том <code>pgsql/wal</code> с алгоритмом компрессии <code>zstd</code> и размером блока <code>32K</code> для WAL:</p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-42
shortcode-codeblock-bash">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-4562e1eae423d71f55e03b1116d06b19" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="nv">p</span><span class="o">=</span><span class="s1">&#39;data&#39;</span><span class="p">;</span> <span class="nv">v</span><span class="o">=</span><span class="s1">&#39;pgsql/wal&#39;</span><span class="p">;</span> zfs create -o <span class="s1">&#39;recordsize=32K&#39;</span> <span class="s2">&#34;</span><span class="si">${</span><span class="nv">p</span><span class="si">}</span><span class="s2">/</span><span class="si">${</span><span class="nv">v</span><span class="si">}</span><span class="s2">&#34;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-4562e1eae423d71f55e03b1116d06b19"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<p>Откорректировать настройки <span class="shortcode shortcode-tag"><a href="/ru/tags/postgresql/" target="_blank">#PostgreSQL</a></span>:</p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-43
shortcode-codeblock-ini">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-05d91f58dd86bdf8a1c06b8d4aa88776" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-ini" data-lang="ini"><span class="line"><span class="cl"><span class="na">data_directory</span> <span class="o">=</span> <span class="s">&#39;/data/pgsql/main&#39;</span>
</span></span><span class="line"><span class="cl"><span class="na">full_page_writes</span> <span class="o">=</span> <span class="s">off</span>
</span></span><span class="line"><span class="cl"><span class="na">wal_init_zero</span> <span class="o">=</span> <span class="s">off</span>
</span></span><span class="line"><span class="cl"><span class="na">wal_recycle</span> <span class="o">=</span> <span class="s">off</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-05d91f58dd86bdf8a1c06b8d4aa88776"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<h3 id="mysql">
  <a class="link-body-emphasis" href="#mysql">MySQL</a>
</h3><p>Создать основной том <code>mysql</code> с алгоритмом компрессии <code>zstd</code>:</p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-44
shortcode-codeblock-bash">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-86e82ad295f31258be03ef3c3cdc3616" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="nv">p</span><span class="o">=</span><span class="s1">&#39;data&#39;</span><span class="p">;</span> <span class="nv">v</span><span class="o">=</span><span class="s1">&#39;mysql&#39;</span><span class="p">;</span> zfs create -o <span class="s1">&#39;compression=zstd&#39;</span> <span class="s2">&#34;</span><span class="si">${</span><span class="nv">p</span><span class="si">}</span><span class="s2">/</span><span class="si">${</span><span class="nv">v</span><span class="si">}</span><span class="s2">&#34;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-86e82ad295f31258be03ef3c3cdc3616"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<p>Создать специальный том <code>mysql/main</code> с алгоритмом компрессии <code>zstd</code> и размером блока <code>16K</code> для баз данных:</p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-45
shortcode-codeblock-bash">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-a152d2c7c73302572849e1302332d265" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="nv">p</span><span class="o">=</span><span class="s1">&#39;data&#39;</span><span class="p">;</span> <span class="nv">v</span><span class="o">=</span><span class="s1">&#39;mysql/main&#39;</span><span class="p">;</span> zfs create -o <span class="s1">&#39;recordsize=16K&#39;</span> <span class="s2">&#34;</span><span class="si">${</span><span class="nv">p</span><span class="si">}</span><span class="s2">/</span><span class="si">${</span><span class="nv">v</span><span class="si">}</span><span class="s2">&#34;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-a152d2c7c73302572849e1302332d265"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<p>Создать специальный том <code>mysql/log</code> с алгоритмом компрессии <code>zstd</code> для логирования:</p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-46
shortcode-codeblock-bash">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-c5adfe6a1769ba34dcdf11dc0c45d498" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="nv">p</span><span class="o">=</span><span class="s1">&#39;data&#39;</span><span class="p">;</span> <span class="nv">v</span><span class="o">=</span><span class="s1">&#39;mysql/log&#39;</span><span class="p">;</span> zfs create <span class="s2">&#34;</span><span class="si">${</span><span class="nv">p</span><span class="si">}</span><span class="s2">/</span><span class="si">${</span><span class="nv">v</span><span class="si">}</span><span class="s2">&#34;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-c5adfe6a1769ba34dcdf11dc0c45d498"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<p>Откорректировать настройки <span class="shortcode shortcode-tag"><a href="/ru/tags/mysql/" target="_blank">#MySQL</a></span>:</p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-47
shortcode-codeblock-ini">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-2a878e09103f204cbf7d8ac03d63ddf3" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-ini" data-lang="ini"><span class="line"><span class="cl"><span class="na">datadir</span> <span class="o">=</span> <span class="s">&#39;data/mysql/main&#39;</span>
</span></span><span class="line"><span class="cl"><span class="na">innodb_doublewrite</span> <span class="o">=</span> <span class="s">0</span>
</span></span><span class="line"><span class="cl"><span class="na">innodb_use_native_aio</span> <span class="o">=</span> <span class="s">0</span>
</span></span><span class="line"><span class="cl"><span class="na">innodb_use_atomic_writes</span> <span class="o">=</span> <span class="s">0</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-2a878e09103f204cbf7d8ac03d63ddf3"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>]]></turbo:content></item><item turbo="true"><title>Как скрыть листинг директории, при этом разрешить просмотр содержимого файлов?</title><link>https://lib.onl/ru/2024/02/0a853441-d526-52ab-b5b2-48a57be6c33f/</link><pubDate>Fri, 16 Feb 2024 13:28:52 +0000</pubDate><dc:creator>Kai Kimera</dc:creator><category>Linux</category><category>Freebsd</category><category>Listing</category><category>Chmod</category><category>Permissions</category><yandex:related><link url="https://lib.onl/ru/2024/02/2589b2dc-ae2a-53a0-91d8-b3475c10401e/">Как создать директорию с общим доступом в Linux?</link><link url="https://lib.onl/ru/2024/02/936da675-3366-5344-a14a-5963d84c136d/">Как исправить ошибки сетевой карты Realtek в FreeBSD?</link></yandex:related><turbo:extendedHtml>true</turbo:extendedHtml><turbo:source>https://lib.onl/ru/2024/02/0a853441-d526-52ab-b5b2-48a57be6c33f/</turbo:source><turbo:topic>Как скрыть листинг директории, при этом разрешить просмотр содержимого файлов?</turbo:topic><turbo:content>&lt;p>Как скрыть содержимое директории от просмотра, но разрешить читать содержимое её файлов?&lt;/p></turbo:content></item><item turbo="true"><title>Как создать директорию с общим доступом в Linux?</title><link>https://lib.onl/ru/2024/02/2589b2dc-ae2a-53a0-91d8-b3475c10401e/</link><pubDate>Tue, 13 Feb 2024 12:47:40 +0000</pubDate><dc:creator>Kai Kimera</dc:creator><category>Linux</category><category>Freebsd</category><category>Chmod</category><category>Groupadd</category><category>Usermod</category><category>Chgrp</category><category>Permissions</category><yandex:related><link url="https://lib.onl/ru/2024/02/936da675-3366-5344-a14a-5963d84c136d/">Как исправить ошибки сетевой карты Realtek в FreeBSD?</link></yandex:related><turbo:extendedHtml>true</turbo:extendedHtml><turbo:source>https://lib.onl/ru/2024/02/2589b2dc-ae2a-53a0-91d8-b3475c10401e/</turbo:source><turbo:topic>Как создать директорию с общим доступом в Linux?</turbo:topic><turbo:content><![CDATA[<p>Нужна директория, в которой пользователи могут создавать общие файлы и папки в <span class="shortcode shortcode-tag"><a href="/ru/tags/linux/" target="_blank">#Linux</a></span> (<span class="shortcode shortcode-tag"><a href="/ru/tags/freebsd/" target="_blank">#FreeBSD</a></span>). Как такое можно сделать?</p>]]></turbo:content></item><item turbo="true"><title>Как проверить сервер Postfix?</title><link>https://lib.onl/ru/2024/02/404156e2-2ffb-535a-9b83-e40e1890f36a/</link><pubDate>Tue, 13 Feb 2024 02:49:47 +0000</pubDate><dc:creator>Kai Kimera</dc:creator><category>Postfix</category><category>Telnet</category><turbo:extendedHtml>true</turbo:extendedHtml><turbo:source>https://lib.onl/ru/2024/02/404156e2-2ffb-535a-9b83-e40e1890f36a/</turbo:source><turbo:topic>Как проверить сервер Postfix?</turbo:topic><turbo:content><![CDATA[<p>У меня есть почтовый сервер на базе <span class="shortcode shortcode-tag"><a href="/ru/tags/postfix/" target="_blank">#Postfix</a></span>. Как мне проверить его работоспособность?</p>]]></turbo:content></item><item turbo="true"><title>Как исправить ошибки сетевой карты Realtek в FreeBSD?</title><link>https://lib.onl/ru/2024/02/936da675-3366-5344-a14a-5963d84c136d/</link><pubDate>Sun, 11 Feb 2024 12:27:09 +0000</pubDate><dc:creator>Kai Kimera</dc:creator><category>Freebsd</category><category>Realtek</category><yandex:related><link url="https://lib.onl/ru/2024/02/a87c514f-4a5e-52e3-ad76-4dd11218c6d1/">Как исправить ошибки сетевой карты Realtek в OPNsense?</link></yandex:related><turbo:extendedHtml>true</turbo:extendedHtml><turbo:source>https://lib.onl/ru/2024/02/936da675-3366-5344-a14a-5963d84c136d/</turbo:source><turbo:topic>Как исправить ошибки сетевой карты Realtek в FreeBSD?</turbo:topic><turbo:content><![CDATA[<p>Сетевая карта <span class="shortcode shortcode-tag"><a href="/ru/tags/realtek/" target="_blank">#Realtek</a></span> в <span class="shortcode shortcode-tag"><a href="/ru/tags/freebsd/" target="_blank">#FreeBSD</a></span> работает не совсем корректно. Почему?</p>]]></turbo:content></item><item turbo="true"><title>Как исправить ошибки сетевой карты Realtek в OPNsense?</title><link>https://lib.onl/ru/2024/02/a87c514f-4a5e-52e3-ad76-4dd11218c6d1/</link><pubDate>Sun, 11 Feb 2024 12:12:57 +0000</pubDate><dc:creator>Kai Kimera</dc:creator><category>Opnsense</category><category>Realtek</category><category>Nat</category><turbo:extendedHtml>true</turbo:extendedHtml><turbo:source>https://lib.onl/ru/2024/02/a87c514f-4a5e-52e3-ad76-4dd11218c6d1/</turbo:source><turbo:topic>Как исправить ошибки сетевой карты Realtek в OPNsense?</turbo:topic><turbo:content><![CDATA[<p>Сетевая карта <span class="shortcode shortcode-tag"><a href="/ru/tags/realtek/" target="_blank">#Realtek</a></span> в <span class="shortcode shortcode-tag"><a href="/ru/tags/opnsense/" target="_blank">#OPNsense</a></span> ведёт себя странно: разрывает соединение или понижает скорость передачи данных. В чём проблема?</p>]]></turbo:content></item><item turbo="true"><title>Как правильно настроить PuTTY?</title><link>https://lib.onl/ru/2024/02/fa01d796-4d5e-51f8-968a-9937c299b86c/</link><pubDate>Sun, 11 Feb 2024 12:08:56 +0000</pubDate><dc:creator>Kai Kimera</dc:creator><category>Putty</category><category>Kitty</category><turbo:extendedHtml>true</turbo:extendedHtml><turbo:source>https://lib.onl/ru/2024/02/fa01d796-4d5e-51f8-968a-9937c299b86c/</turbo:source><turbo:topic>Как правильно настроить PuTTY?</turbo:topic><turbo:content><![CDATA[<p>У меня <span class="shortcode shortcode-tag"><a href="/ru/tags/putty/" target="_blank">#PuTTY</a></span> / <span class="shortcode shortcode-tag"><a href="/ru/tags/kitty/" target="_blank">#KiTTY</a></span> неправильно отображает шрифт и некорректно рисует интерфейсы. Как это исправить?</p>]]></turbo:content></item><item turbo="true"><title>Первичная настройка FreeBSD</title><link>https://lib.onl/ru/2024/02/f97dc310-9a6a-52f7-8441-bf7eb02087c2/</link><pubDate>Thu, 08 Feb 2024 08:59:09 +0000</pubDate><dc:creator>Kai Kimera</dc:creator><category>BSD</category><turbo:extendedHtml>true</turbo:extendedHtml><turbo:source>https://lib.onl/ru/2024/02/f97dc310-9a6a-52f7-8441-bf7eb02087c2/</turbo:source><turbo:topic>Первичная настройка FreeBSD</turbo:topic><turbo:content><![CDATA[<p>Надумал я как-то на днях изучить ОС <span class="shortcode shortcode-tag"><a href="/ru/tags/freebsd/" target="_blank">#FreeBSD</a></span>. Система обладает своими особенностями, но кто работает в <span class="shortcode shortcode-tag"><a href="/ru/tags/linux/" target="_blank">#Linux</a></span>, тот легко разберётся в FreeBSD.</p>
<h2 id="обновление-системы">
  <a class="link-body-emphasis" href="#%d0%be%d0%b1%d0%bd%d0%be%d0%b2%d0%bb%d0%b5%d0%bd%d0%b8%d0%b5-%d1%81%d0%b8%d1%81%d1%82%d0%b5%d0%bc%d1%8b">Обновление системы</a>
</h2><p>После установки базовой системы, рекомендуется запустить обновление.</p>
<ol>
<li>Запросить и применить обновления:</li>
</ol>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-0
shortcode-codeblock-bash">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-e2a20a1e6a99c0a49b3395535e9e2d5f" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">freebsd-update fetch <span class="o">&amp;&amp;</span> freebsd-update install</span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-e2a20a1e6a99c0a49b3395535e9e2d5f"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<h2 id="обновление-пакетов">
  <a class="link-body-emphasis" href="#%d0%be%d0%b1%d0%bd%d0%be%d0%b2%d0%bb%d0%b5%d0%bd%d0%b8%d0%b5-%d0%bf%d0%b0%d0%ba%d0%b5%d1%82%d0%be%d0%b2">Обновление пакетов</a>
</h2><ol>
<li>Запросить и применить обновления пакетов:</li>
</ol>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-1
shortcode-codeblock-bash">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-c63bedb192f6f5af8a57ac95bd5b99c4" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">pkg update -f <span class="o">&amp;&amp;</span> pkg upgrade --yes</span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-c63bedb192f6f5af8a57ac95bd5b99c4"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<h2 id="переключение-ветки-пакетов">
  <a class="link-body-emphasis" href="#%d0%bf%d0%b5%d1%80%d0%b5%d0%ba%d0%bb%d1%8e%d1%87%d0%b5%d0%bd%d0%b8%d0%b5-%d0%b2%d0%b5%d1%82%d0%ba%d0%b8-%d0%bf%d0%b0%d0%ba%d0%b5%d1%82%d0%be%d0%b2">Переключение ветки пакетов</a>
</h2><p>По умолчанию, <span class="shortcode shortcode-tag"><a href="/ru/tags/freebsd/" target="_blank">#FreeBSD</a></span> берёт обновления пакетов из квартальной (<code>quarterly</code>) ветки. Если хочется получить свежие пакеты здесь и сейчас, то нужно переключить ветку на <code>latest</code>.</p>
<ol>
<li>Создать файл <code>/usr/local/etc/pkg/repos/FreeBSD.conf</code>:</li>
</ol>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-2
shortcode-codeblock-bash">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-fb9b80b9e6bf5df71e919b5c271b8f95" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">mkdir -p /usr/local/etc/pkg/repos <span class="o">&amp;&amp;</span> <span class="nb">echo</span> <span class="s1">&#39;FreeBSD: { url: &#34;pkg+http://pkg.FreeBSD.org/${ABI}/latest&#34; }&#39;</span> &gt; /usr/local/etc/pkg/repos/FreeBSD.conf</span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-fb9b80b9e6bf5df71e919b5c271b8f95"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<ol start="2">
<li>Обновить базу данных пакетов и обновить пакеты:</li>
</ol>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-3
shortcode-codeblock-bash">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-b65c52616c43d0e5f5cb70a25d7fc61a" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">pkg update -f <span class="o">&amp;&amp;</span> pkg upgrade --yes</span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-b65c52616c43d0e5f5cb70a25d7fc61a"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<h2 id="установка-пакетов">
  <a class="link-body-emphasis" href="#%d1%83%d1%81%d1%82%d0%b0%d0%bd%d0%be%d0%b2%d0%ba%d0%b0-%d0%bf%d0%b0%d0%ba%d0%b5%d1%82%d0%be%d0%b2">Установка пакетов</a>
</h2><p>Для установки пакетов используется пакетный менеджер <code>pkg</code>. В интернете есть информация о том, что не рекомендуется смешивать пакеты и порты. То есть, если вы уже начали использовать пакеты, то надо продолжать только ими пользоваться.</p>
<h3 id="установка-сервиса-обновления-микрокода-cpu">
  <a class="link-body-emphasis" href="#%d1%83%d1%81%d1%82%d0%b0%d0%bd%d0%be%d0%b2%d0%ba%d0%b0-%d1%81%d0%b5%d1%80%d0%b2%d0%b8%d1%81%d0%b0-%d0%be%d0%b1%d0%bd%d0%be%d0%b2%d0%bb%d0%b5%d0%bd%d0%b8%d1%8f-%d0%bc%d0%b8%d0%ba%d1%80%d0%be%d0%ba%d0%be%d0%b4%d0%b0-cpu">Установка сервиса обновления микрокода CPU</a>
</h3><ol>
<li>Установить пакет.</li>
<li>Добавить в <code>rc.conf</code> автозапуск сервиса.</li>
<li>Запустить сервис.</li>
</ol>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-4
shortcode-codeblock-bash">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-869d9b4fba7ba6ebc64ce13c90c142bc" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">pkg install cpu-microcode <span class="o">&amp;&amp;</span> sysrc <span class="nv">microcode_update_enable</span><span class="o">=</span>YES <span class="o">&amp;&amp;</span> service microcode_update start</span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-869d9b4fba7ba6ebc64ce13c90c142bc"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<h3 id="установка-дополнительных-пакетов">
  <a class="link-body-emphasis" href="#%d1%83%d1%81%d1%82%d0%b0%d0%bd%d0%be%d0%b2%d0%ba%d0%b0-%d0%b4%d0%be%d0%bf%d0%be%d0%bb%d0%bd%d0%b8%d1%82%d0%b5%d0%bb%d1%8c%d0%bd%d1%8b%d1%85-%d0%bf%d0%b0%d0%ba%d0%b5%d1%82%d0%be%d0%b2">Установка дополнительных пакетов</a>
</h3><p>Для работы на сервере, я устанавливаю следующие пакеты:</p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-5
shortcode-codeblock-bash">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-812b0992ddc3afb358933eed044716ee" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">pkg install bash ca_root_nss curl git gnupg htop mc nano smartmontools wget zsh</span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-812b0992ddc3afb358933eed044716ee"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<h2 id="настройка-ядра">
  <a class="link-body-emphasis" href="#%d0%bd%d0%b0%d1%81%d1%82%d1%80%d0%be%d0%b9%d0%ba%d0%b0-%d1%8f%d0%b4%d1%80%d0%b0">Настройка ядра</a>
</h2><h3 id="увеличение-числа-дескрипторов-файлов">
  <a class="link-body-emphasis" href="#%d1%83%d0%b2%d0%b5%d0%bb%d0%b8%d1%87%d0%b5%d0%bd%d0%b8%d0%b5-%d1%87%d0%b8%d1%81%d0%bb%d0%b0-%d0%b4%d0%b5%d1%81%d0%ba%d1%80%d0%b8%d0%bf%d1%82%d0%be%d1%80%d0%be%d0%b2-%d1%84%d0%b0%d0%b9%d0%bb%d0%be%d0%b2">Увеличение числа дескрипторов файлов</a>
</h3><p>У меня используется синхронизация данных при помощи <span class="shortcode shortcode-tag"><a href="/ru/tags/syncthing/" target="_blank">#Syncthing</a></span>, данных много. Иногда случается ступор из-за лимита на дескрипторы файлов. Открываем <code>/etc/sysctl.conf</code>, добавляем:</p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-6
shortcode-codeblock-ini">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-d122845c5e202731e7f78badd3c6ead4" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-ini" data-lang="ini"><span class="line"><span class="cl"><span class="na">kern.maxfiles</span><span class="o">=</span><span class="s">500000</span>
</span></span><span class="line"><span class="cl"><span class="na">kern.maxfilesperproc</span><span class="o">=</span><span class="s">500000</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-d122845c5e202731e7f78badd3c6ead4"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<p>Перезагружаем систему:</p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-7
shortcode-codeblock-bash">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-5b04cd8f3dbd9284b88b8053771340f4" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">shutdown -r now</span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-5b04cd8f3dbd9284b88b8053771340f4"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<h2 id="настройка-терминала">
  <a class="link-body-emphasis" href="#%d0%bd%d0%b0%d1%81%d1%82%d1%80%d0%be%d0%b9%d0%ba%d0%b0-%d1%82%d0%b5%d1%80%d0%bc%d0%b8%d0%bd%d0%b0%d0%bb%d0%b0">Настройка терминала</a>
</h2><p>В своей работе я предпочитаю <span class="shortcode shortcode-tag"><a href="/ru/tags/zsh/" target="_blank">#Zsh</a></span>.</p>
<h3 id="установка-zsh-для-пользователей">
  <a class="link-body-emphasis" href="#%d1%83%d1%81%d1%82%d0%b0%d0%bd%d0%be%d0%b2%d0%ba%d0%b0-zsh-%d0%b4%d0%bb%d1%8f-%d0%bf%d0%be%d0%bb%d1%8c%d0%b7%d0%be%d0%b2%d0%b0%d1%82%d0%b5%d0%bb%d0%b5%d0%b9">Установка Zsh для пользователей</a>
</h3><ol>
<li>Изменить стандартную оболочку на <span class="shortcode shortcode-tag"><a href="/ru/tags/zsh/" target="_blank">#Zsh</a></span> для <strong>root</strong>:</li>
</ol>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-8
shortcode-codeblock-bash">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-bc4169a3c6fc36b6b569ea5157f7b3ff" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">chsh -s zsh root</span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-bc4169a3c6fc36b6b569ea5157f7b3ff"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<ol start="2">
<li>Изменить стандартную оболочку на <span class="shortcode shortcode-tag"><a href="/ru/tags/zsh/" target="_blank">#Zsh</a></span> для <strong>обычного пользователя</strong>:</li>
</ol>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-9
shortcode-codeblock-bash">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-82229f9f77a14084846b32c40ba94b26" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">chsh -s zsh user</span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-82229f9f77a14084846b32c40ba94b26"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<p>Где:</p>
<ul>
<li><code>user</code> - логин пользователя.</li>
</ul>
<h3 id="конфигурация-zsh">
  <a class="link-body-emphasis" href="#%d0%ba%d0%be%d0%bd%d1%84%d0%b8%d0%b3%d1%83%d1%80%d0%b0%d1%86%d0%b8%d1%8f-zsh">Конфигурация Zsh</a>
</h3><p>Использую конфигурацию от <span class="shortcode shortcode-tag">GRML</span>.</p>
<ol>
<li>Скачиваем конфигурацию:</li>
</ol>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-10
shortcode-codeblock-bash">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-8ea6b4e360bfd6ff5f6d68f5d61f18d2" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">wget -O ~/.zshrc.grml https://git.grml.org/f/grml-etc-core/etc/zsh/zshrc</span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-8ea6b4e360bfd6ff5f6d68f5d61f18d2"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<ol start="2">
<li>Открываем файл <code>~/.zshrc</code> и добавляем следующие строки:</li>
</ol>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-11
shortcode-codeblock-bash">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-617f516770d4102d146df6cc64ecc817" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">. <span class="s2">&#34;</span><span class="si">${</span><span class="nv">HOME</span><span class="si">}</span><span class="s2">/.zshrc.grml&#34;</span>
</span></span><span class="line"><span class="cl"><span class="nb">export</span> <span class="nv">GPG_TTY</span><span class="o">=</span><span class="k">$(</span>tty<span class="k">)</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-617f516770d4102d146df6cc64ecc817"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<p>Я работаю на ОС Windows и к серверам подключаюсь через <span class="shortcode shortcode-tag"><a href="/ru/tags/kitty/" target="_blank">#KiTTY</a></span>. При работе с <span class="shortcode shortcode-tag"><a href="/ru/tags/gpg/" target="_blank">#GPG</a></span>, она иногда не понимает куда ей выбрасывать запрос на парольную фразу. Поэтому, у меня здесь добавлен фикс <code>export GPG_TTY=$(tty)</code>.</p>
<h2 id="настройка-файловой-системы">
  <a class="link-body-emphasis" href="#%d0%bd%d0%b0%d1%81%d1%82%d1%80%d0%be%d0%b9%d0%ba%d0%b0-%d1%84%d0%b0%d0%b9%d0%bb%d0%be%d0%b2%d0%be%d0%b9-%d1%81%d0%b8%d1%81%d1%82%d0%b5%d0%bc%d1%8b">Настройка файловой системы</a>
</h2><h3 id="отключение-atime">
  <a class="link-body-emphasis" href="#%d0%be%d1%82%d0%ba%d0%bb%d1%8e%d1%87%d0%b5%d0%bd%d0%b8%d0%b5-atime">Отключение <code>atime</code></a>
</h3><p><code>atime</code> это время доступа к файлу. В обычной работе такая метрика бесполезна. На диск могут быть тысячи файлов и для каждого файла ядро ОС будет фиксировать и обновлять время доступа. Подобная операция весьма дорогая.</p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-12
shortcode-codeblock-bash">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-b9e2c9f9687f0e997a988460c249b57e" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">zfs <span class="nb">set</span> <span class="nv">atime</span><span class="o">=</span>off zroot</span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-b9e2c9f9687f0e997a988460c249b57e"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<p>Где:</p>
<ul>
<li><code>zroot</code> - пул файловой системы <span class="shortcode shortcode-tag"><a href="/ru/tags/zfs/" target="_blank">#ZFS</a></span>.</li>
</ul>]]></turbo:content></item><item turbo="true"><title>MikroTik: Настройка DoH</title><link>https://lib.onl/ru/2023/12/b6c7c5cd-1b0d-5fcd-8dd2-f28f87a5064c/</link><pubDate>Wed, 27 Dec 2023 08:07:16 +0000</pubDate><dc:creator>Kai Kimera</dc:creator><category>Сеть</category><category>Безопасность</category><yandex:related><link url="https://lib.onl/ru/2023/10/cc13623b-970c-5950-867e-168f9ba9025a/">MikroTik: Добавление корневых сертификатов в RouterOS</link><link url="https://lib.onl/ru/2020/07/ff2ae66e-8e14-5c4a-baa6-0cd2e59f6517/">MikroTik и CloudFlare: Динамический IP для домена</link></yandex:related><turbo:extendedHtml>true</turbo:extendedHtml><turbo:source>https://lib.onl/ru/2023/12/b6c7c5cd-1b0d-5fcd-8dd2-f28f87a5064c/</turbo:source><turbo:topic>MikroTik: Настройка DoH</turbo:topic><turbo:content><![CDATA[<p>Небольшая заметка по настройке DNS over HTTPS (<span class="shortcode shortcode-tag"><a href="/ru/tags/doh/" target="_blank">#DoH</a></span>) на <span class="shortcode shortcode-tag"><a href="/ru/tags/mikrotik/" target="_blank">#MikroTik</a></span>.</p>
<h2 id="установка-набора-сертификатов">
  <a class="link-body-emphasis" href="#%d1%83%d1%81%d1%82%d0%b0%d0%bd%d0%be%d0%b2%d0%ba%d0%b0-%d0%bd%d0%b0%d0%b1%d0%be%d1%80%d0%b0-%d1%81%d0%b5%d1%80%d1%82%d0%b8%d1%84%d0%b8%d0%ba%d0%b0%d1%82%d0%be%d0%b2">Установка набора сертификатов</a>
</h2><p>Для работы DoH необходимо наличие сертификатов в базе MikroTik. Пакет сертификатов я беру с сайта <code>curl.se</code>:</p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-0
shortcode-codeblock-text">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-71a7643ab450083b3a59704a75f04123" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-text" data-lang="text"><span class="line"><span class="cl">/tool fetch url=&#34;https://curl.se/ca/cacert.pem&#34; dst-path=&#34;ros.cacert.pem&#34;</span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-71a7643ab450083b3a59704a75f04123"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<p>Импортируем сертификаты:</p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-1
shortcode-codeblock-text">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-5ecc01bc21b1dc7f48023d5ad4e49449" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-text" data-lang="text"><span class="line"><span class="cl">/certificate import file-name=&#34;ros.cacert.pem&#34; passphrase=&#34;&#34; name=&#34;CA&#34;</span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-5ecc01bc21b1dc7f48023d5ad4e49449"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<h2 id="настройка-doh">
  <a class="link-body-emphasis" href="#%d0%bd%d0%b0%d1%81%d1%82%d1%80%d0%be%d0%b9%d0%ba%d0%b0-doh">Настройка DoH</a>
</h2><p>После установки сертификатов, приступаем к настройке DoH.</p>
<h3 id="стандартные-dns">
  <a class="link-body-emphasis" href="#%d1%81%d1%82%d0%b0%d0%bd%d0%b4%d0%b0%d1%80%d1%82%d0%bd%d1%8b%d0%b5-dns">Стандартные DNS</a>
</h3>








  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-2
shortcode-codeblock-text">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-9260ff3ba39bbcfe0f2be2f2ab9812bc" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-text" data-lang="text"><span class="line"><span class="cl">/ip dns set allow-remote-requests=yes servers=1.1.1.1,1.0.0.1 use-doh-server=&#34;https://cloudflare-dns.com/dns-query&#34; verify-doh-cert=yes</span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-9260ff3ba39bbcfe0f2be2f2ab9812bc"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<p>В этой команде присутствуют следующие параметры:</p>
<ul>
<li>DNS 01: <code>1.1.1.1</code>.</li>
<li>DNS 02: <code>1.0.0.1</code>.</li>
<li>Сервер DoH: <code>https://cloudflare-dns.com/dns-query</code>.</li>
</ul>
<h3 id="dns-с-блокировкой-вредоносного-по">
  <a class="link-body-emphasis" href="#dns-%d1%81-%d0%b1%d0%bb%d0%be%d0%ba%d0%b8%d1%80%d0%be%d0%b2%d0%ba%d0%be%d0%b9-%d0%b2%d1%80%d0%b5%d0%b4%d0%be%d0%bd%d0%be%d1%81%d0%bd%d0%be%d0%b3%d0%be-%d0%bf%d0%be">DNS с блокировкой вредоносного ПО</a>
</h3>








  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-3
shortcode-codeblock-text">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-86222c001edfee5e10f9e5802d081c9a" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-text" data-lang="text"><span class="line"><span class="cl">/ip dns set allow-remote-requests=yes servers=1.1.1.2,1.0.0.2 use-doh-server=&#34;https://security.cloudflare-dns.com/dns-query&#34; verify-doh-cert=yes</span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-86222c001edfee5e10f9e5802d081c9a"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<p>В этой команде присутствуют следующие параметры:</p>
<ul>
<li>DNS 01: <code>1.1.1.2</code>.</li>
<li>DNS 02: <code>1.0.0.2</code>.</li>
<li>Сервер DoH: <code>https://security.cloudflare-dns.com/dns-query</code>.</li>
</ul>
<h3 id="dns-с-блокировкой-вредоносного-по-и-контента-для-взрослых">
  <a class="link-body-emphasis" href="#dns-%d1%81-%d0%b1%d0%bb%d0%be%d0%ba%d0%b8%d1%80%d0%be%d0%b2%d0%ba%d0%be%d0%b9-%d0%b2%d1%80%d0%b5%d0%b4%d0%be%d0%bd%d0%be%d1%81%d0%bd%d0%be%d0%b3%d0%be-%d0%bf%d0%be-%d0%b8-%d0%ba%d0%be%d0%bd%d1%82%d0%b5%d0%bd%d1%82%d0%b0-%d0%b4%d0%bb%d1%8f-%d0%b2%d0%b7%d1%80%d0%be%d1%81%d0%bb%d1%8b%d1%85">DNS с блокировкой вредоносного ПО и контента для взрослых</a>
</h3>








  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-4
shortcode-codeblock-text">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-9367cbc53540e2aef9be5c720364e625" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-text" data-lang="text"><span class="line"><span class="cl">/ip dns set allow-remote-requests=yes servers=1.1.1.3,1.0.0.3 use-doh-server=&#34;https://family.cloudflare-dns.com/dns-query&#34; verify-doh-cert=yes</span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-9367cbc53540e2aef9be5c720364e625"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<p>В этой команде присутствуют следующие параметры:</p>
<ul>
<li>DNS 01: <code>1.1.1.3</code>.</li>
<li>DNS 02: <code>1.0.0.3</code>.</li>
<li>Сервер DoH: <code>https://family.cloudflare-dns.com/dns-query</code>.</li>
</ul>]]></turbo:content></item><item turbo="true"><title>MikroTik: Базовая настройка</title><link>https://lib.onl/ru/2023/12/0f3478b3-9fde-59aa-a424-ff160431fa35/</link><pubDate>Wed, 20 Dec 2023 06:53:34 +0000</pubDate><dc:creator>Kai Kimera</dc:creator><category>Сеть</category><category>Скрипты</category><category>В доработке</category><yandex:related><link url="https://lib.onl/ru/2023/10/cc13623b-970c-5950-867e-168f9ba9025a/">MikroTik: Добавление корневых сертификатов в RouterOS</link><link url="https://lib.onl/ru/2024/04/326618af-d950-5001-8114-57c66bb8a5af/">MikroTik: Туннель GRE/IPsec (Site-to-Site)</link><link url="https://lib.onl/ru/2024/04/146e83d5-f571-5273-9a29-172bf5dc10fe/">MikroTik: Туннель WireGuard (Site-to-Site) + OSPF</link><link url="https://lib.onl/ru/2024/03/54a2b39f-38b4-5f0c-9b54-310f853da38f/">MikroTik: Туннель IPsec (Site-to-Site)</link><link url="https://lib.onl/ru/2020/07/ff2ae66e-8e14-5c4a-baa6-0cd2e59f6517/">MikroTik и CloudFlare: Динамический IP для домена</link><link url="https://lib.onl/ru/2023/12/b6c7c5cd-1b0d-5fcd-8dd2-f28f87a5064c/">MikroTik: Настройка DoH</link></yandex:related><turbo:extendedHtml>true</turbo:extendedHtml><turbo:source>https://lib.onl/ru/2023/12/0f3478b3-9fde-59aa-a424-ff160431fa35/</turbo:source><turbo:topic>MikroTik: Базовая настройка</turbo:topic><turbo:content><![CDATA[<p>После покупки <span class="shortcode shortcode-tag"><a href="/ru/tags/mikrotik/" target="_blank">#MikroTik</a></span> советуют обнулить все его настройки и начать конфигурацию с чистого листа.</p>
<p>Я написал небольший скрип для автоматизации действий по базовой настройки маршрутизатора. В скрипте есть параметры, которые необходимо предварительно настроить под себя.</p>
<h2 id="настройка-основного-роутера">
  <a class="link-body-emphasis" href="#%d0%bd%d0%b0%d1%81%d1%82%d1%80%d0%be%d0%b9%d0%ba%d0%b0-%d0%be%d1%81%d0%bd%d0%be%d0%b2%d0%bd%d0%be%d0%b3%d0%be-%d1%80%d0%be%d1%83%d1%82%d0%b5%d1%80%d0%b0">Настройка основного роутера</a>
</h2><ul>
<li>Загрузить скрипт в память <span class="shortcode shortcode-tag"><a href="/ru/tags/mikrotik/" target="_blank">#MikroTik</a></span>, предварительно настроив параметры скрипта под себя.</li>
<li>Зайти в <strong>Terminal</strong> и выполнить следующую команду:</li>
</ul>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-0
shortcode-codeblock-text">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-194c7ec866b24f475544a13b3b0970ee" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-text" data-lang="text"><span class="line"><span class="cl">/system reset-configuration no-defaults=yes skip-backup=yes run-after-reset=&#34;ros.router.rsc&#34;</span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-194c7ec866b24f475544a13b3b0970ee"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<h3 id="параметры-конфигурации">
  <a class="link-body-emphasis" href="#%d0%bf%d0%b0%d1%80%d0%b0%d0%bc%d0%b5%d1%82%d1%80%d1%8b-%d0%ba%d0%be%d0%bd%d1%84%d0%b8%d0%b3%d1%83%d1%80%d0%b0%d1%86%d0%b8%d0%b8">Параметры конфигурации</a>
</h3><ul>
<li>Пароль администратора: <code>PassWord</code>.</li>
<li>Мост:
<ul>
<li>Имя: <code>bridge1</code>.</li>
<li>Порты: <code>2-5</code>.</li>
</ul>
</li>
<li>Шлюз:
<ul>
<li>Название: <code>GW1</code>.</li>
<li>IP: <code>10.1.0.1</code>.</li>
<li>Домен: <code>gw1.lan</code>.</li>
</ul>
</li>
<li>Подсеть:
<ul>
<li>Маска: <code>10.1.0.0/16</code>.</li>
<li>Домен: <code>home.lan</code>.</li>
<li>Адресация DHCP: <code>10.1.200.1-10.1.200.254</code>.</li>
</ul>
</li>
<li>Порты:
<ul>
<li>SSH: <code>22022</code>.</li>
<li>Winbox: <code>9090</code>.</li>
</ul>
</li>
</ul>
<h3 id="скрипт-конфигурации">
  <a class="link-body-emphasis" href="#%d1%81%d0%ba%d1%80%d0%b8%d0%bf%d1%82-%d0%ba%d0%be%d0%bd%d1%84%d0%b8%d0%b3%d1%83%d1%80%d0%b0%d1%86%d0%b8%d0%b8">Скрипт конфигурации</a>
</h3>
    

    
        
            
            <div class="shortcode shortcode-file mb-3">
              <div class="card overflow-hidden" data-bs-theme="dark">
                <div class="card-header">
                  <div class="d-flex align-items-center">
                    <div class="flex-shrink-0">
                      <i class="far fa-file-code fa-fw"></i>
                    </div>
                    <div class="flex-grow-1 mx-2 text-truncate">
                      <code>mt.router.rsc</code>
                    </div>
                    <div class="flex-shrink-0">
                      <ul class="list-inline mb-0">
                        <li class="list-inline-item" title='Копировать'>
                          <a class="text-body" href="#"
                             data-fn="clipboard" data-clipboard-target="#cp-3b8eebb30434a08c27817a97b4e9d7e3"
                             role="button" aria-label='Копировать'>
                            <i class="fas fa-copy fa-fw"></i>
                          </a>
                        </li>
                        <li class="list-inline-item" title='Скачать'>
                          <a class="text-body" href="/ru/2023/12/0f3478b3-9fde-59aa-a424-ff160431fa35/mt.router.rsc" download
                             role="button" aria-label='Скачать'>
                            <i class="fas fa-download fa-fw"></i>
                          </a>
                        </li>
                        <li class="list-inline-item" title='Открыть'>
                          <a class="text-body" href="/ru/2023/12/0f3478b3-9fde-59aa-a424-ff160431fa35/mt.router.rsc" target="_blank"
                             role="button" aria-label='Открыть'>
                            <i class="fas fa-arrow-up-right-from-square fa-fw"></i>
                          </a>
                        </li>
                      </ul>
                    </div>
                  </div>
                </div>
                <div class="card-body p-0 overflow-auto" id="cp-3b8eebb30434a08c27817a97b4e9d7e3">
                    
                    <div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">  1
</span><span class="lnt">  2
</span><span class="lnt">  3
</span><span class="lnt">  4
</span><span class="lnt">  5
</span><span class="lnt">  6
</span><span class="lnt">  7
</span><span class="lnt">  8
</span><span class="lnt">  9
</span><span class="lnt"> 10
</span><span class="lnt"> 11
</span><span class="lnt"> 12
</span><span class="lnt"> 13
</span><span class="lnt"> 14
</span><span class="lnt"> 15
</span><span class="lnt"> 16
</span><span class="lnt"> 17
</span><span class="lnt"> 18
</span><span class="lnt"> 19
</span><span class="lnt"> 20
</span><span class="lnt"> 21
</span><span class="lnt"> 22
</span><span class="lnt"> 23
</span><span class="lnt"> 24
</span><span class="lnt"> 25
</span><span class="lnt"> 26
</span><span class="lnt"> 27
</span><span class="lnt"> 28
</span><span class="lnt"> 29
</span><span class="lnt"> 30
</span><span class="lnt"> 31
</span><span class="lnt"> 32
</span><span class="lnt"> 33
</span><span class="lnt"> 34
</span><span class="lnt"> 35
</span><span class="lnt"> 36
</span><span class="lnt"> 37
</span><span class="lnt"> 38
</span><span class="lnt"> 39
</span><span class="lnt"> 40
</span><span class="lnt"> 41
</span><span class="lnt"> 42
</span><span class="lnt"> 43
</span><span class="lnt"> 44
</span><span class="lnt"> 45
</span><span class="lnt"> 46
</span><span class="lnt"> 47
</span><span class="lnt"> 48
</span><span class="lnt"> 49
</span><span class="lnt"> 50
</span><span class="lnt"> 51
</span><span class="lnt"> 52
</span><span class="lnt"> 53
</span><span class="lnt"> 54
</span><span class="lnt"> 55
</span><span class="lnt"> 56
</span><span class="lnt"> 57
</span><span class="lnt"> 58
</span><span class="lnt"> 59
</span><span class="lnt"> 60
</span><span class="lnt"> 61
</span><span class="lnt"> 62
</span><span class="lnt"> 63
</span><span class="lnt"> 64
</span><span class="lnt"> 65
</span><span class="lnt"> 66
</span><span class="lnt"> 67
</span><span class="lnt"> 68
</span><span class="lnt"> 69
</span><span class="lnt"> 70
</span><span class="lnt"> 71
</span><span class="lnt"> 72
</span><span class="lnt"> 73
</span><span class="lnt"> 74
</span><span class="lnt"> 75
</span><span class="lnt"> 76
</span><span class="lnt"> 77
</span><span class="lnt"> 78
</span><span class="lnt"> 79
</span><span class="lnt"> 80
</span><span class="lnt"> 81
</span><span class="lnt"> 82
</span><span class="lnt"> 83
</span><span class="lnt"> 84
</span><span class="lnt"> 85
</span><span class="lnt"> 86
</span><span class="lnt"> 87
</span><span class="lnt"> 88
</span><span class="lnt"> 89
</span><span class="lnt"> 90
</span><span class="lnt"> 91
</span><span class="lnt"> 92
</span><span class="lnt"> 93
</span><span class="lnt"> 94
</span><span class="lnt"> 95
</span><span class="lnt"> 96
</span><span class="lnt"> 97
</span><span class="lnt"> 98
</span><span class="lnt"> 99
</span><span class="lnt">100
</span><span class="lnt">101
</span><span class="lnt">102
</span><span class="lnt">103
</span><span class="lnt">104
</span><span class="lnt">105
</span><span class="lnt">106
</span><span class="lnt">107
</span><span class="lnt">108
</span><span class="lnt">109
</span><span class="lnt">110
</span><span class="lnt">111
</span><span class="lnt">112
</span><span class="lnt">113
</span><span class="lnt">114
</span><span class="lnt">115
</span><span class="lnt">116
</span><span class="lnt">117
</span><span class="lnt">118
</span><span class="lnt">119
</span><span class="lnt">120
</span><span class="lnt">121
</span><span class="lnt">122
</span><span class="lnt">123
</span><span class="lnt">124
</span><span class="lnt">125
</span><span class="lnt">126
</span><span class="lnt">127
</span><span class="lnt">128
</span><span class="lnt">129
</span><span class="lnt">130
</span><span class="lnt">131
</span><span class="lnt">132
</span><span class="lnt">133
</span><span class="lnt">134
</span><span class="lnt">135
</span><span class="lnt">136
</span><span class="lnt">137
</span><span class="lnt">138
</span><span class="lnt">139
</span><span class="lnt">140
</span><span class="lnt">141
</span><span class="lnt">142
</span><span class="lnt">143
</span><span class="lnt">144
</span><span class="lnt">145
</span><span class="lnt">146
</span><span class="lnt">147
</span><span class="lnt">148
</span><span class="lnt">149
</span><span class="lnt">150
</span><span class="lnt">151
</span><span class="lnt">152
</span><span class="lnt">153
</span><span class="lnt">154
</span><span class="lnt">155
</span><span class="lnt">156
</span><span class="lnt">157
</span><span class="lnt">158
</span><span class="lnt">159
</span><span class="lnt">160
</span><span class="lnt">161
</span><span class="lnt">162
</span><span class="lnt">163
</span><span class="lnt">164
</span><span class="lnt">165
</span><span class="lnt">166
</span><span class="lnt">167
</span><span class="lnt">168
</span><span class="lnt">169
</span><span class="lnt">170
</span><span class="lnt">171
</span><span class="lnt">172
</span><span class="lnt">173
</span><span class="lnt">174
</span><span class="lnt">175
</span><span class="lnt">176
</span><span class="lnt">177
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-text" data-lang="text"><span class="line"><span class="cl"># @package    MikroTik / RouterOS
</span></span><span class="line"><span class="cl"># @author     Kai Kimera &lt;mail@kai.kim&gt;
</span></span><span class="line"><span class="cl"># @copyright  2023 Library Online
</span></span><span class="line"><span class="cl"># @license    MIT
</span></span><span class="line"><span class="cl"># @version    0.1.0
</span></span><span class="line"><span class="cl"># @link       https://lib.onl/ru/2023/12/0f3478b3-9fde-59aa-a424-ff160431fa35/
</span></span><span class="line"><span class="cl"># -------------------------------------------------------------------------------------------------------------------- #
</span></span><span class="line"><span class="cl"># Set MAC:
</span></span><span class="line"><span class="cl"># /interface ethernet set [find default-name=&#34;ether1&#34;] mac-address=&#34;00:00:00:00:00:00&#34;
</span></span><span class="line"><span class="cl"># -------------------------------------------------------------------------------------------------------------------- #
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"># Administrator password.
</span></span><span class="line"><span class="cl">:local rosAdminPassword &#34;PassWord&#34;
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"># Bridge.
</span></span><span class="line"><span class="cl">:local rosBridgeName &#34;bridge1&#34;
</span></span><span class="line"><span class="cl">:local rosBridgeMinPort 2
</span></span><span class="line"><span class="cl">:local rosBridgeMaxPort 5
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"># Router name.
</span></span><span class="line"><span class="cl">:local rosRouterName &#34;GW1&#34;
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"># Static gateway name.
</span></span><span class="line"><span class="cl">:local rosGwDomain &#34;gw1.lan&#34;
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"># Network domain name.
</span></span><span class="line"><span class="cl">:local rosNwDomain &#34;home.lan&#34;
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"># Port knocking.
</span></span><span class="line"><span class="cl">:local rosIcmpKnockSize 100
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"># -------------------------------------------------------------------------------------------------------------------- #
</span></span><span class="line"><span class="cl"># -----------------------------------------------------&lt; SCRIPT &gt;----------------------------------------------------- #
</span></span><span class="line"><span class="cl"># -------------------------------------------------------------------------------------------------------------------- #
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">/interface bridge
</span></span><span class="line"><span class="cl">add name=$rosBridgeName
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">/interface list
</span></span><span class="line"><span class="cl">add name=WAN
</span></span><span class="line"><span class="cl">add name=LAN
</span></span><span class="line"><span class="cl">add name=GRE
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">/interface bridge port
</span></span><span class="line"><span class="cl">:for i from=$rosBridgeMinPort to=$rosBridgeMaxPort do={
</span></span><span class="line"><span class="cl">  add bridge=$rosBridgeName interface=(&#34;ether&#34; . $i)
</span></span><span class="line"><span class="cl">}
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">/interface list member
</span></span><span class="line"><span class="cl">add interface=ether1 list=WAN
</span></span><span class="line"><span class="cl">add interface=$rosBridgeName list=LAN
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">/ipv6 settings
</span></span><span class="line"><span class="cl">set disable-ipv6=yes
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">/ip ipsec profile
</span></span><span class="line"><span class="cl">set [find default=yes] dh-group=ecp384 enc-algorithm=aes-256 hash-algorithm=sha256
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">/ip ipsec proposal
</span></span><span class="line"><span class="cl">set [find default=yes] auth-algorithms=sha256 enc-algorithms=aes-256-cbc pfs-group=ecp384
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">/ip pool
</span></span><span class="line"><span class="cl">add name=dhcp ranges=10.1.200.1-10.1.200.254
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">/ip dhcp-server
</span></span><span class="line"><span class="cl">add address-pool=dhcp interface=$rosBridgeName name=dhcp1
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">/ip neighbor discovery-settings
</span></span><span class="line"><span class="cl">set discover-interface-list=LAN
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">/ip address
</span></span><span class="line"><span class="cl">add address=10.1.0.1/16 interface=$rosBridgeName network=10.1.0.0
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">/ip dhcp-client
</span></span><span class="line"><span class="cl">add interface=ether1
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">/ip dhcp-server lease
</span></span><span class="line"><span class="cl"># add address=10.1.0.40 mac-address=00:00:00:00:00:00 comment=&#34;SERVER01&#34;
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">/ip dhcp-server network
</span></span><span class="line"><span class="cl">add address=10.1.0.0/16 dns-server=10.1.0.1 domain=$rosNwDomain gateway=10.1.0.1 ntp-server=10.1.0.1
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">/ip dns
</span></span><span class="line"><span class="cl">set allow-remote-requests=yes servers=1.1.1.1,8.8.8.8,77.88.8.8
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">/ip dns static
</span></span><span class="line"><span class="cl">add address=10.1.0.1 name=$rosGwDomain
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">/ip firewall filter
</span></span><span class="line"><span class="cl">add action=accept chain=input connection-state=established,related,untracked \
</span></span><span class="line"><span class="cl">  comment=&#34;[ROS] Established, Related, Untracked&#34;
</span></span><span class="line"><span class="cl">add action=drop chain=input connection-state=invalid \
</span></span><span class="line"><span class="cl">  comment=&#34;[ROS] Invalid&#34;
</span></span><span class="line"><span class="cl">add action=add-src-to-address-list address-list=&#34;AdminCP&#34; address-list-timeout=30m chain=input in-interface-list=WAN \
</span></span><span class="line"><span class="cl">  packet-size=($rosIcmpKnockSize + 28) protocol=icmp \
</span></span><span class="line"><span class="cl">  comment=&#34;[ROS] ICMP port knocking for AdminCP&#34;
</span></span><span class="line"><span class="cl">add action=accept chain=input protocol=icmp \
</span></span><span class="line"><span class="cl">  comment=&#34;[ROS] ICMP&#34;
</span></span><span class="line"><span class="cl">add action=accept chain=input in-interface-list=GRE protocol=ospf disabled=yes \
</span></span><span class="line"><span class="cl">  comment=&#34;[ROS] OSPF&#34;
</span></span><span class="line"><span class="cl">add action=accept chain=input dst-port=53 in-interface-list=GRE protocol=udp disabled=yes \
</span></span><span class="line"><span class="cl">  comment=&#34;[ROS] DNS&#34;
</span></span><span class="line"><span class="cl">add action=accept chain=input dst-port=9090,22022 protocol=tcp src-address-list=&#34;AdminCP&#34; \
</span></span><span class="line"><span class="cl">  comment=&#34;[ROS] WinBox and SSH&#34;
</span></span><span class="line"><span class="cl">add action=accept chain=input dst-port=9090,22022 in-interface-list=GRE protocol=tcp disabled=yes \
</span></span><span class="line"><span class="cl">  comment=&#34;[ROS] WinBox and SSH&#34;
</span></span><span class="line"><span class="cl">add action=drop chain=input in-interface-list=!LAN \
</span></span><span class="line"><span class="cl">  comment=&#34;[ROS] All not coming from LAN&#34;
</span></span><span class="line"><span class="cl">add action=accept chain=forward ipsec-policy=in,ipsec disabled=yes \
</span></span><span class="line"><span class="cl">  comment=&#34;[ROS] In IPsec policy&#34;
</span></span><span class="line"><span class="cl">add action=accept chain=forward ipsec-policy=out,ipsec disabled=yes \
</span></span><span class="line"><span class="cl">  comment=&#34;[ROS] Out IPsec policy&#34;
</span></span><span class="line"><span class="cl">add action=fasttrack-connection chain=forward connection-state=established,related \
</span></span><span class="line"><span class="cl">  comment=&#34;[ROS] FastTrack&#34;
</span></span><span class="line"><span class="cl">add action=accept chain=forward connection-state=established,related,untracked \
</span></span><span class="line"><span class="cl">  comment=&#34;[ROS] FastTrack&#34;
</span></span><span class="line"><span class="cl">add action=drop chain=forward connection-state=invalid \
</span></span><span class="line"><span class="cl">  comment=&#34;[ROS] Invalid&#34;
</span></span><span class="line"><span class="cl">add action=drop chain=forward connection-nat-state=!dstnat connection-state=new in-interface-list=WAN \
</span></span><span class="line"><span class="cl">  comment=&#34;[ROS] All from WAN not DSTNATed&#34;
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">/ip firewall nat
</span></span><span class="line"><span class="cl">add action=masquerade chain=srcnat ipsec-policy=out,none out-interface-list=WAN \
</span></span><span class="line"><span class="cl">  comment=&#34;[ROS] Masquerade&#34;
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">/ip service
</span></span><span class="line"><span class="cl">set telnet disabled=yes
</span></span><span class="line"><span class="cl">set ftp disabled=yes
</span></span><span class="line"><span class="cl">set www disabled=yes
</span></span><span class="line"><span class="cl">set ssh port=22022
</span></span><span class="line"><span class="cl">set api disabled=yes
</span></span><span class="line"><span class="cl">set winbox port=9090
</span></span><span class="line"><span class="cl">set api-ssl disabled=yes
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">/system clock
</span></span><span class="line"><span class="cl">set time-zone-name=Europe/Moscow
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">/system identity
</span></span><span class="line"><span class="cl">set name=$rosRouterName
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">/system ntp client
</span></span><span class="line"><span class="cl">set enabled=yes
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">/system ntp server
</span></span><span class="line"><span class="cl">set enabled=yes manycast=yes multicast=yes
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">/system ntp client servers
</span></span><span class="line"><span class="cl">add address=&#34;0.ru.pool.ntp.org&#34;
</span></span><span class="line"><span class="cl">add address=&#34;1.ru.pool.ntp.org&#34;
</span></span><span class="line"><span class="cl">add address=&#34;time.google.com&#34;
</span></span><span class="line"><span class="cl">add address=&#34;time.cloudflare.com&#34;
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">/system routerboard settings
</span></span><span class="line"><span class="cl">set silent-boot=yes
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">/system watchdog
</span></span><span class="line"><span class="cl">set automatic-supout=no
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">/tool bandwidth-server
</span></span><span class="line"><span class="cl">set enabled=no
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">/tool mac-server
</span></span><span class="line"><span class="cl">set allowed-interface-list=none
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">/tool mac-server ping
</span></span><span class="line"><span class="cl">set enabled=no
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">/user
</span></span><span class="line"><span class="cl">set [find name=&#34;admin&#34;] password=&#34;$rosAdminPassword&#34;
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"># -------------------------------------------------------------------------------------------------------------------- #
</span></span><span class="line"><span class="cl"># Router ID.
</span></span><span class="line"><span class="cl"># -------------------------------------------------------------------------------------------------------------------- #
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">/routing id
</span></span><span class="line"><span class="cl">add id=10.1.0.1 name=lo select-dynamic-id=only-loopback \
</span></span><span class="line"><span class="cl">  comment=&#34;[ROS] Router ID (Loopback)&#34;</span></span></code></pre></td></tr></table>
</div>
</div>
                </div>
              </div>
            </div>]]></turbo:content></item><item turbo="true"><title>Переход Debian между релизами</title><link>https://lib.onl/ru/2023/11/4dfa15a8-44f0-5590-a04d-f940dac12aad/</link><pubDate>Sat, 25 Nov 2023 18:31:16 +0000</pubDate><dc:creator>Kai Kimera</dc:creator><category>Linux</category><category>Терминал</category><yandex:related><link url="https://lib.onl/ru/2023/10/6733cb51-62a0-5ed9-b421-8f08c4e0cb18/">Создание сертификатов при помощи OpenSSL</link><link url="https://lib.onl/ru/2023/10/75075788-9308-56b7-b531-2008cb35f7d0/">Установка сертификата НУЦ Минцифры</link><link url="https://lib.onl/ru/2022/01/06ef2fab-2ae2-5356-9154-7ca1e486d27d/">Установка ядра XanMod в Debian</link><link url="https://lib.onl/ru/2022/01/ddddd243-d182-5e26-a161-d2ea7812214a/">Установка Vivaldi в Debian</link><link url="https://lib.onl/ru/2021/09/581804b8-0613-52a8-a5c4-fdae90e7bc8a/">Чёрный экран с курсором при старте GDM</link><link url="https://lib.onl/ru/2021/09/1cf305cd-85d0-5e02-aabb-e01346bfee0f/">Proxmox VE: Установка на Debian 11 (Bullseye)</link><link url="https://lib.onl/ru/2021/09/ff829d15-4a19-52e3-a3aa-ad70aa38854a/">Debian: Wired Networks are Unmanaged</link><link url="https://lib.onl/ru/2021/09/b2caccc7-92bf-57ed-970f-136c546f18e2/">Распаковка пакетов DEB / RPM</link><link url="https://lib.onl/ru/2021/09/43b40b92-c29a-504b-87fa-5eac368dcf95/">Отключение установки дополнительных пакетов в Debian APT</link><link url="https://lib.onl/ru/2021/09/aeed7c90-003a-532a-b2c4-3807aaee88fa/">dhclient отправляет 36-значный идентификатор вместо MAC</link><link url="https://lib.onl/ru/2021/08/ca744dce-e607-52e6-9952-8ae04e052a5b/">Скрипт автоматического удаления устаревших файлов</link><link url="https://lib.onl/ru/2021/05/ee559a6c-5cde-5166-9d2d-3ceb55878eb8/">Debian: Статический IP-адрес</link></yandex:related><turbo:extendedHtml>true</turbo:extendedHtml><turbo:source>https://lib.onl/ru/2023/11/4dfa15a8-44f0-5590-a04d-f940dac12aad/</turbo:source><turbo:topic>Переход Debian между релизами</turbo:topic><turbo:content><![CDATA[<p><span class="shortcode shortcode-tag"><a href="/ru/tags/debian/" target="_blank">#Debian</a></span> позволяет выполнять обновление системы между релизами, и для успешного выполнения этого процесса, необходимо выполнять команды строго в определённом порядке.</p>
<h2 id="обновление-пакетов-в-текущей-системе">
  <a class="link-body-emphasis" href="#%d0%be%d0%b1%d0%bd%d0%be%d0%b2%d0%bb%d0%b5%d0%bd%d0%b8%d0%b5-%d0%bf%d0%b0%d0%ba%d0%b5%d1%82%d0%be%d0%b2-%d0%b2-%d1%82%d0%b5%d0%ba%d1%83%d1%89%d0%b5%d0%b9-%d1%81%d0%b8%d1%81%d1%82%d0%b5%d0%bc%d0%b5">Обновление пакетов в текущей системе</a>
</h2><p>Перед переходом на новый релиз, необходимо обновить все пакеты на текущей системе. Для этого выполняем последовательно ниже приведённые команды.</p>
<ol>
<li>Обновление базы пакетов, пакетов и системы в целом:</li>
</ol>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-0
shortcode-codeblock-bash">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-a10c05bbfa24ac5c9fbbf8ed84641389" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">apt update <span class="o">&amp;&amp;</span> apt upgrade <span class="o">&amp;&amp;</span> apt full-upgrade</span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-a10c05bbfa24ac5c9fbbf8ed84641389"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<ol start="2">
<li>Удаление не используемых пакетов:</li>
</ol>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-1
shortcode-codeblock-bash">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-f49ed9cbce15f781c22beff622539c6e" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">apt --purge autoremove</span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-f49ed9cbce15f781c22beff622539c6e"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<h2 id="обновление-файла-sourceslist">
  <a class="link-body-emphasis" href="#%d0%be%d0%b1%d0%bd%d0%be%d0%b2%d0%bb%d0%b5%d0%bd%d0%b8%d0%b5-%d1%84%d0%b0%d0%b9%d0%bb%d0%b0-sourceslist">Обновление файла <code>sources.list</code></a>
</h2><p>После завершения полного обновления пакетов, нужно перезаписать пути к репозиториям, указав имя нового релиза:</p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-2
shortcode-codeblock-bash">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-a1182ec473ac6597bc8f654c654f9a38" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">sed -i <span class="s1">&#39;s|RELEASE_OLD|RELEASE_NEW|g&#39;</span> <span class="s1">&#39;/etc/apt/sources.list&#39;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-a1182ec473ac6597bc8f654c654f9a38"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<p>Где:</p>
<ul>
<li><code>RELEASE_OLD</code> - старое имя релиза.</li>
<li><code>RELEASE_NEW</code> - новое имя релиза.</li>
</ul>
<h2 id="обновление-системны-на-новую-версию">
  <a class="link-body-emphasis" href="#%d0%be%d0%b1%d0%bd%d0%be%d0%b2%d0%bb%d0%b5%d0%bd%d0%b8%d0%b5-%d1%81%d0%b8%d1%81%d1%82%d0%b5%d0%bc%d0%bd%d1%8b-%d0%bd%d0%b0-%d0%bd%d0%be%d0%b2%d1%83%d1%8e-%d0%b2%d0%b5%d1%80%d1%81%d0%b8%d1%8e">Обновление системны на новую версию</a>
</h2><p>Теперь пришло время перейти на новый релиз. Выполняем шаги последовательно.</p>
<ol>
<li>Обновление базы пакетов и обновление пакетов в минимальном варианте:</li>
</ol>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-3
shortcode-codeblock-bash">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-13271860470a4b8a9b514e54e0b450b9" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">apt update <span class="o">&amp;&amp;</span> apt upgrade --without-new-pkgs</span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-13271860470a4b8a9b514e54e0b450b9"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<p>На запрос &ldquo;Restart services during package upgrades without asking?&rdquo; отвечаем <span class="shortcode shortcode-btn d-inline-block"><kbd class="bg-primary">Yes</kbd></span>.</p>
<ol start="2">
<li>Обновление всей системы:</li>
</ol>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-4
shortcode-codeblock-bash">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-a8f60f57d4087c6e7d83c4eb89a47bac" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">apt full-upgrade</span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-a8f60f57d4087c6e7d83c4eb89a47bac"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<ol start="3">
<li>Проверка обновлённого релиза:</li>
</ol>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-5
shortcode-codeblock-bash">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-18f46a4ead9d1e05ed43a3d1557953bf" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">cat /etc/debian_version</span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-18f46a4ead9d1e05ed43a3d1557953bf"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>]]></turbo:content></item><item turbo="true"><title>Как при помощи AWK разбить строку на поля?</title><link>https://lib.onl/ru/2023/11/632ccab2-18e6-550d-bd8e-0374dc9025f4/</link><pubDate>Sat, 04 Nov 2023 21:54:09 +0000</pubDate><dc:creator>Kai Kimera</dc:creator><category>Bash</category><category>Awk</category><turbo:extendedHtml>true</turbo:extendedHtml><turbo:source>https://lib.onl/ru/2023/11/632ccab2-18e6-550d-bd8e-0374dc9025f4/</turbo:source><turbo:topic>Как при помощи AWK разбить строку на поля?</turbo:topic><turbo:content>&lt;p>Нужно разделить строку в терминале на отдельные поля. Как для этого использовать AWK?&lt;/p></turbo:content></item><item turbo="true"><title>Как переименовать компьютер в PowerShell?</title><link>https://lib.onl/ru/2023/11/e153bb1d-7cea-5bd8-acce-2dbe63b26c91/</link><pubDate>Sat, 04 Nov 2023 06:06:25 +0000</pubDate><dc:creator>Kai Kimera</dc:creator><category>Powershell</category><yandex:related><link url="https://lib.onl/ru/2023/11/8c2e7adc-9431-5bb7-a9b6-e9397b1116b3/">Как переключить PowerShell в кодировку UTF-8?</link><link url="https://lib.onl/ru/2023/10/edf74517-3e6e-5e1c-aa6b-8ee0335670b4/">Многоточие в выводе PowerShell в табличном формате. Как исправить?</link></yandex:related><turbo:extendedHtml>true</turbo:extendedHtml><turbo:source>https://lib.onl/ru/2023/11/e153bb1d-7cea-5bd8-acce-2dbe63b26c91/</turbo:source><turbo:topic>Как переименовать компьютер в PowerShell?</turbo:topic><turbo:content>&lt;p>Хочу переименовать компьютер через терминал PowerShell. Как это сделать?&lt;/p></turbo:content></item><item turbo="true"><title>Как распаковать Intel SetupChipset.exe?</title><link>https://lib.onl/ru/2023/11/4531cb6d-5c3a-5b2d-8a53-6eccd8534dfa/</link><pubDate>Fri, 03 Nov 2023 14:48:08 +0000</pubDate><dc:creator>Kai Kimera</dc:creator><category>Intel</category><category>Chipset</category><category>Driver</category><category>Inf</category><turbo:extendedHtml>true</turbo:extendedHtml><turbo:source>https://lib.onl/ru/2023/11/4531cb6d-5c3a-5b2d-8a53-6eccd8534dfa/</turbo:source><turbo:topic>Как распаковать Intel SetupChipset.exe?</turbo:topic><turbo:content><![CDATA[<p>Нужно интегрировать драйверы чипсета Intel в дистрибутив ОС. Драйверы находятся в файле <code>SetupChipset.exe</code>. Как распаковать файл <code>SetupChipset.exe</code> для того, чтобы забрать драйверы чипсетов?</p>]]></turbo:content></item><item turbo="true"><title>Как переключить PowerShell в кодировку UTF-8?</title><link>https://lib.onl/ru/2023/11/8c2e7adc-9431-5bb7-a9b6-e9397b1116b3/</link><pubDate>Thu, 02 Nov 2023 20:50:36 +0000</pubDate><dc:creator>Kai Kimera</dc:creator><category>Powershell</category><yandex:related><link url="https://lib.onl/ru/2023/10/edf74517-3e6e-5e1c-aa6b-8ee0335670b4/">Многоточие в выводе PowerShell в табличном формате. Как исправить?</link></yandex:related><turbo:extendedHtml>true</turbo:extendedHtml><turbo:source>https://lib.onl/ru/2023/11/8c2e7adc-9431-5bb7-a9b6-e9397b1116b3/</turbo:source><turbo:topic>Как переключить PowerShell в кодировку UTF-8?</turbo:topic><turbo:content>&lt;p>Когда запускаю скрипт на PowerShell, кодировка ломается и вместо текста появляются нечитаемые символы. Это проблем кодировки, как включить поддержку символов UTF-8?&lt;/p></turbo:content></item><item turbo="true"><title>Многоточие в выводе PowerShell в табличном формате. Как исправить?</title><link>https://lib.onl/ru/2023/10/edf74517-3e6e-5e1c-aa6b-8ee0335670b4/</link><pubDate>Tue, 31 Oct 2023 19:52:35 +0000</pubDate><dc:creator>Kai Kimera</dc:creator><category>Powershell</category><turbo:extendedHtml>true</turbo:extendedHtml><turbo:source>https://lib.onl/ru/2023/10/edf74517-3e6e-5e1c-aa6b-8ee0335670b4/</turbo:source><turbo:topic>Многоточие в выводе PowerShell в табличном формате. Как исправить?</turbo:topic><turbo:content><![CDATA[<p>Когда PowerShell выводит информацию в табличном формате, некоторые строки не влезают в ширину столбца и происходит обрезание контента. Как сделать так, чтобы PowerShell подстраивал ширину столбца под размер контента?</p>











<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-0 shortcode-codeblock-terminal
shortcode-codeblock-terminal-windows
shortcode-codeblock-terminal-windows-user">
  <div class="card overflow-hidden" data-bs-theme="dark">
    <div class="card-header">
      <div class="d-flex align-items-center">
        <div class="flex-shrink-0 ">
          <i class="fas fa-terminal fa-fw"></i>
        </div>
        <div class="flex-grow-1 mx-2">
          <h5 class="mb-0">Терминал</h5>
        </div>
        <div class="flex-shrink-0">
          <ul class="list-inline mb-0">
            <li class="list-inline-item" title='Копировать'>
              <a class="text-body" href="#"
                 data-fn="clipboard" data-clipboard-target="#cp-871702ba5e606a730788b4e27f11a290"
                 role="button" aria-label='Копировать'>
                <i class="fas fa-copy fa-fw"></i>
              </a>
            </li>
          </ul>
        </div>
      </div>
    </div>
    <div class="card-body p-0 overflow-auto" id="cp-871702ba5e606a730788b4e27f11a290"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-plaintext" data-lang="plaintext"><span class="line"><span class="cl">Get-Service -DisplayName &#39;win*&#39;
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Status   Name               DisplayName
</span></span><span class="line"><span class="cl">------   ----               -----------
</span></span><span class="line"><span class="cl">Running  AudioEndpointBuil… Windows Audio Endpoint Builder
</span></span><span class="line"><span class="cl">Running  Audiosrv           Windows Audio
</span></span><span class="line"><span class="cl">Running  EventLog           Windows Event Log
</span></span><span class="line"><span class="cl">Running  FontCache          Windows Font Cache Service
</span></span><span class="line"><span class="cl">Stopped  FrameServer        Windows Camera Frame Server
</span></span><span class="line"><span class="cl">Stopped  FrameServerMonitor Windows Camera Frame Server Monitor
</span></span><span class="line"><span class="cl">Stopped  icssvc             Windows Mobile Hotspot Service
</span></span><span class="line"><span class="cl">Running  LicenseManager     Windows License Manager Service
</span></span><span class="line"><span class="cl">Stopped  MixedRealityOpenX… Windows Mixed Reality OpenXR Service
</span></span><span class="line"><span class="cl">Running  mpssvc             Windows Defender Firewall
</span></span><span class="line"><span class="cl">Stopped  msiserver          Windows Installer
</span></span><span class="line"><span class="cl">Stopped  perceptionsimulat… Windows Perception Simulation Service
</span></span><span class="line"><span class="cl">Stopped  PushToInstall      Windows PushToInstall Service
</span></span><span class="line"><span class="cl">Stopped  SDRSVC             Windows Backup
</span></span><span class="line"><span class="cl">Running  SecurityHealthSer… Windows Security Service</span></span></code></pre></td></tr></table>
</div>
</div></div>
  </div>
</div>]]></turbo:content></item><item turbo="true"><title>Работа с сетевыми интерфейсами в PowerShell</title><link>https://lib.onl/ru/2023/10/430b916d-fd5c-5d44-8c24-8b98f41e0355/</link><pubDate>Tue, 31 Oct 2023 17:16:31 +0000</pubDate><dc:creator>Kai Kimera</dc:creator><category>MS Windows</category><category>Терминал</category><category>Сеть</category><category>Скрипты</category><yandex:related><link url="https://lib.onl/ru/2023/10/1f062637-3227-56d7-93e3-126d1c80f5a8/">Работа с переменной среды окружения PATH</link><link url="https://lib.onl/ru/2023/10/fb64d665-3e56-5fa5-a9eb-2e2e251949d8/">Автоматическая настройка Windows Server 2022 под рабочую станцию</link><link url="https://lib.onl/ru/2023/10/38fc94dd-8d37-5f9e-b556-676304976a9f/">Восстановление доверительных отношений между PC и Active Directory</link><link url="https://lib.onl/ru/2023/10/616da78a-eb16-575a-9119-65f0c0c7baee/">Изменение порта RDP</link><link url="https://lib.onl/ru/2023/10/c6e32349-8fc2-53f9-9a42-790878a64076/">PowerShell: Полезные функции</link><link url="https://lib.onl/ru/2023/10/52d75b90-0637-5ba6-91d6-b1bff40e1d67/">PowerShell: Стирание диска</link><link url="https://lib.onl/ru/2023/10/2a73410a-6611-570c-9ab4-dc8cc8998146/">PowerShell: Сжатие видео при помощи FFmpeg</link><link url="https://lib.onl/ru/2023/10/0028821e-c96c-5014-a1dd-8963c161b170/">PowerShell: Определение разрядности ОС Windows</link><link url="https://lib.onl/ru/2023/10/4c7aba7c-f5a6-589a-9975-fdb16f2e2862/">PowerShell Vault</link><link url="https://lib.onl/ru/2023/10/eb39e3f7-b194-53d4-8bad-01edf9fdac47/">Дефрагментация в ОС Windows</link><link url="https://lib.onl/ru/2023/10/75075788-9308-56b7-b531-2008cb35f7d0/">Установка сертификата НУЦ Минцифры</link><link url="https://lib.onl/ru/2022/05/36058650-3f35-5ed5-9565-0aa7d8800c28/">Windows Server 2022 для рабочей станции</link></yandex:related><turbo:extendedHtml>true</turbo:extendedHtml><turbo:source>https://lib.onl/ru/2023/10/430b916d-fd5c-5d44-8c24-8b98f41e0355/</turbo:source><turbo:topic>Работа с сетевыми интерфейсами в PowerShell</turbo:topic><turbo:content><![CDATA[<p>Разберём основные команды, которые пригодятся нам при настройке сети в ОС <span class="shortcode shortcode-tag"><a href="/ru/tags/windows/" target="_blank">#Windows</a></span> через <span class="shortcode shortcode-tag"><a href="/ru/tags/powershell/" target="_blank">#PowerShell</a></span>.</p>
<h2 id="сетевые-адаптеры">
  <a class="link-body-emphasis" href="#%d1%81%d0%b5%d1%82%d0%b5%d0%b2%d1%8b%d0%b5-%d0%b0%d0%b4%d0%b0%d0%bf%d1%82%d0%b5%d1%80%d1%8b">Сетевые адаптеры</a>
</h2><p>Получить список сетевых адаптеров и их интерфейсов:</p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-0
shortcode-codeblock-powershell">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-1e61f5b650935e888139b0a8879a50ef" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-powershell" data-lang="powershell"><span class="line"><span class="cl"><span class="nb">Get-NetAdapter</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-1e61f5b650935e888139b0a8879a50ef"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<p>Получить список обычных и скрытых сетевых адаптеров:</p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-1
shortcode-codeblock-powershell">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-af6573e6e444d7982aa3470fd0782f6b" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-powershell" data-lang="powershell"><span class="line"><span class="cl"><span class="nb">Get-NetAdapter</span> <span class="err">–</span><span class="n">IncludeHidden</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-af6573e6e444d7982aa3470fd0782f6b"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<p>Получить конфигурацию по интерфейсу <code>5</code>:</p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-2
shortcode-codeblock-powershell">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-005617b7e3304b4d6fc72efbef971fc8" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-powershell" data-lang="powershell"><span class="line"><span class="cl"><span class="nb">Get-NetAdapter</span> <span class="n">-InterfaceIndex</span> <span class="mf">5</span> <span class="p">|</span> <span class="nb">Get-NetIPConfiguration</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-005617b7e3304b4d6fc72efbef971fc8"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<p>Получить детальную конфигурацию по интерфейсу <code>5</code>:</p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-3
shortcode-codeblock-powershell">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-48d0da601be1cfc1238632f7cd76eae9" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-powershell" data-lang="powershell"><span class="line"><span class="cl"><span class="nb">Get-NetAdapter</span> <span class="n">-InterfaceIndex</span> <span class="mf">5</span> <span class="p">|</span> <span class="nb">Get-NetIPConfiguration</span> <span class="n">-Detailed</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-48d0da601be1cfc1238632f7cd76eae9"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<p>Отключить адаптер с интерфейсом <code>5</code>:</p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-4
shortcode-codeblock-powershell">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-bc99fe223f823dc9b0e372fcfee8a73a" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-powershell" data-lang="powershell"><span class="line"><span class="cl"><span class="nb">Get-NetAdapter</span> <span class="n">-InterfaceIndex</span> <span class="mf">5</span> <span class="p">|</span> <span class="nb">Disable-NetAdapter</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-bc99fe223f823dc9b0e372fcfee8a73a"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<h2 id="сетевые-профили">
  <a class="link-body-emphasis" href="#%d1%81%d0%b5%d1%82%d0%b5%d0%b2%d1%8b%d0%b5-%d0%bf%d1%80%d0%be%d1%84%d0%b8%d0%bb%d0%b8">Сетевые профили</a>
</h2><p>Вывести информацию по текущим сетевым профилям:</p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-5
shortcode-codeblock-powershell">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-793099e6dbdf50828228ada78115a3a3" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-powershell" data-lang="powershell"><span class="line"><span class="cl"><span class="nb">Get-NetConnectionProfile</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-793099e6dbdf50828228ada78115a3a3"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<p>Получить информацию только по профилю сети интерфейса <code>5</code>:</p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-6
shortcode-codeblock-powershell">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-444a12c84fdeaa1a8d3001534458b6ac" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-powershell" data-lang="powershell"><span class="line"><span class="cl"><span class="nb">Get-NetAdapter</span> <span class="n">-InterfaceIndex</span> <span class="mf">5</span> <span class="p">|</span> <span class="nb">Get-NetConnectionProfile</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-444a12c84fdeaa1a8d3001534458b6ac"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<p>Изменить профиль сети интерфейса <code>5</code> на публичный (<code>Public</code>).</p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-7
shortcode-codeblock-powershell">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-8223e2aeb1be52b3d5bc8ce74619788d" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-powershell" data-lang="powershell"><span class="line"><span class="cl"><span class="nb">Get-NetAdapter</span> <span class="n">-InterfaceIndex</span> <span class="mf">5</span> <span class="p">|</span> <span class="nb">Set-NetConnectionProfile</span> <span class="n">-NetworkCategory</span> <span class="s1">&#39;Public&#39;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-8223e2aeb1be52b3d5bc8ce74619788d"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<p>Изменить профиль сети интерфейса <code>5</code> на приватный (<code>Private</code>).</p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-8
shortcode-codeblock-powershell">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-8c9d2fa0bd7ff1b947db23803727db95" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-powershell" data-lang="powershell"><span class="line"><span class="cl"><span class="nb">Get-NetAdapter</span> <span class="n">-InterfaceIndex</span> <span class="mf">5</span> <span class="p">|</span> <span class="nb">Set-NetConnectionProfile</span> <span class="n">-NetworkCategory</span> <span class="s1">&#39;Private&#39;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-8c9d2fa0bd7ff1b947db23803727db95"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<p>Изменить профиль сети интерфейса <code>5</code> на доменный (<code>DomainAuthenticated</code>).</p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-9
shortcode-codeblock-powershell">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-1c63b5eeeddc61d4921e1a121d78ff34" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-powershell" data-lang="powershell"><span class="line"><span class="cl"><span class="nb">Get-NetAdapter</span> <span class="n">-InterfaceIndex</span> <span class="mf">5</span> <span class="p">|</span> <span class="nb">Set-NetConnectionProfile</span> <span class="n">-NetworkCategory</span> <span class="s1">&#39;DomainAuthenticated&#39;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-1c63b5eeeddc61d4921e1a121d78ff34"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<h2 id="настройка-ip-адреса">
  <a class="link-body-emphasis" href="#%d0%bd%d0%b0%d1%81%d1%82%d1%80%d0%be%d0%b9%d0%ba%d0%b0-ip-%d0%b0%d0%b4%d1%80%d0%b5%d1%81%d0%b0">Настройка IP-адреса</a>
</h2><p>Отключить DHCP на интерфейсе <code>5</code>:</p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-10
shortcode-codeblock-powershell">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-15f90f6f0edf5f858f40890610e6ae37" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-powershell" data-lang="powershell"><span class="line"><span class="cl"><span class="nb">Get-NetAdapter</span> <span class="n">-InterfaceIndex</span> <span class="mf">5</span> <span class="p">|</span> <span class="nb">Set-NetIPInterface</span> <span class="n">-Dhcp</span> <span class="s1">&#39;Disabled&#39;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-15f90f6f0edf5f858f40890610e6ae37"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<p>Установить новый IP-адрес и шлюз на интерфейсе <code>5</code>:</p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-11
shortcode-codeblock-powershell">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-bcd0b983b7e13250838d01a107ade4ef" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-powershell" data-lang="powershell"><span class="line"><span class="cl"><span class="nb">Get-NetAdapter</span> <span class="n">-InterfaceIndex</span> <span class="mf">5</span> <span class="p">|</span> <span class="nb">New-NetIPAddress</span> <span class="err">–</span><span class="n">IPAddress</span> <span class="s1">&#39;192.168.0.10&#39;</span> <span class="n">-PrefixLength</span> <span class="s1">&#39;24&#39;</span> <span class="n">-DefaultGateway</span> <span class="s1">&#39;192.168.0.1&#39;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-bcd0b983b7e13250838d01a107ade4ef"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<p>Изменить IP-адрес на интерфейсе <code>5</code>:</p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-12
shortcode-codeblock-powershell">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-321dd340bd98b953cebfe6c7c1a777f2" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-powershell" data-lang="powershell"><span class="line"><span class="cl"><span class="nb">Get-NetAdapter</span> <span class="n">-InterfaceIndex</span> <span class="mf">5</span> <span class="p">|</span> <span class="nb">Set-NetIPAddress</span> <span class="n">-IPAddress</span> <span class="s1">&#39;192.168.0.12&#39;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-321dd340bd98b953cebfe6c7c1a777f2"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<p>Удалить IP-адрес на интерфейсе <code>5</code>:</p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-13
shortcode-codeblock-powershell">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-133d169dfc4195957860a7d343c528a0" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-powershell" data-lang="powershell"><span class="line"><span class="cl"><span class="nb">Get-NetAdapter</span> <span class="n">-InterfaceIndex</span> <span class="mf">5</span> <span class="p">|</span> <span class="nb">Remove-NetIPAddress</span> <span class="n">-Confirm:</span><span class="vm">$false</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-133d169dfc4195957860a7d343c528a0"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<p>Удаление шлюза на интерфейсе <code>5</code>:</p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-14
shortcode-codeblock-powershell">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-1b7e811a9d97df4078fc70883be93d5f" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-powershell" data-lang="powershell"><span class="line"><span class="cl"><span class="nb">Get-NetAdapter</span> <span class="n">-InterfaceIndex</span> <span class="mf">5</span> <span class="p">|</span> <span class="nb">Remove-NetRoute</span> <span class="n">-Confirm:</span><span class="vm">$false</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-1b7e811a9d97df4078fc70883be93d5f"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<h2 id="настройка-dns">
  <a class="link-body-emphasis" href="#%d0%bd%d0%b0%d1%81%d1%82%d1%80%d0%be%d0%b9%d0%ba%d0%b0-dns">Настройка DNS</a>
</h2><p>Установить IP-адреса серверов <span class="shortcode shortcode-tag"><a href="/ru/tags/dns/" target="_blank">#DNS</a></span> на интерфейсе <code>5</code>:</p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-15
shortcode-codeblock-powershell">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-4501941673d3c9bf5927f38be3fe90ea" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-powershell" data-lang="powershell"><span class="line"><span class="cl"><span class="nb">Get-NetAdapter</span> <span class="n">-InterfaceIndex</span> <span class="mf">5</span> <span class="p">|</span> <span class="nb">Set-DNSClientServerAddress</span> <span class="err">–</span><span class="n">ServerAddresses</span> <span class="p">(</span><span class="s1">&#39;192.168.0.2&#39;</span><span class="p">,</span><span class="s1">&#39;192.168.1.2&#39;</span><span class="p">)</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-4501941673d3c9bf5927f38be3fe90ea"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<p>Сбросить IP-адреса серверов DNS на параметры по умолчанию на интерфейсе <code>5</code>:</p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-16
shortcode-codeblock-powershell">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-b7671089345d5bb8c04bd8fecc3e5fc4" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-powershell" data-lang="powershell"><span class="line"><span class="cl"><span class="nb">Get-NetAdapter</span> <span class="n">-InterfaceIndex</span> <span class="mf">5</span> <span class="p">|</span> <span class="nb">Set-DnsClientServerAddress</span> <span class="n">-ResetServerAddresses</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-b7671089345d5bb8c04bd8fecc3e5fc4"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<p>Очистить кэш <span class="shortcode shortcode-tag"><a href="/ru/tags/dns/" target="_blank">#DNS</a></span>:</p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-17
shortcode-codeblock-powershell">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-2f329b0c36e2a41b060446212cdaa909" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-powershell" data-lang="powershell"><span class="line"><span class="cl"><span class="nb">Clear-DnsClientCache</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-2f329b0c36e2a41b060446212cdaa909"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<h2 id="настройка-dhcp">
  <a class="link-body-emphasis" href="#%d0%bd%d0%b0%d1%81%d1%82%d1%80%d0%be%d0%b9%d0%ba%d0%b0-dhcp">Настройка DHCP</a>
</h2><p>Включить <span class="shortcode shortcode-tag"><a href="/ru/tags/dhcp/" target="_blank">#DHCP</a></span> на интерфейсе <code>5</code>:</p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-18
shortcode-codeblock-powershell">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-232d3c8a35760393e3c52f8d53137e2f" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-powershell" data-lang="powershell"><span class="line"><span class="cl"><span class="nb">Get-NetAdapter</span> <span class="n">-InterfaceIndex</span> <span class="mf">5</span> <span class="p">|</span> <span class="nb">Set-NetIPInterface</span> <span class="n">-Dhcp</span> <span class="s1">&#39;Enabled&#39;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-232d3c8a35760393e3c52f8d53137e2f"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<p>Перезапустить интерфейс с именем <code>Ethernet</code> для получения параметров от <span class="shortcode shortcode-tag"><a href="/ru/tags/dhcp/" target="_blank">#DHCP</a></span>:</p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-19
shortcode-codeblock-powershell">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-01a293ef1ade7c7c286ff8c32ca66825" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-powershell" data-lang="powershell"><span class="line"><span class="cl"><span class="nb">Get-NetAdapter</span> <span class="n">-InterfaceIndex</span> <span class="mf">5</span> <span class="p">|</span> <span class="nb">Restart-NetAdapter</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-01a293ef1ade7c7c286ff8c32ca66825"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<h2 id="автоматизация">
  <a class="link-body-emphasis" href="#%d0%b0%d0%b2%d1%82%d0%be%d0%bc%d0%b0%d1%82%d0%b8%d0%b7%d0%b0%d1%86%d0%b8%d1%8f">Автоматизация</a>
</h2><p>Скрипт не имеет вводных параметров. Все параметры настраиваются вручную через редактирование скрипта. Далее, скрипт запускается и применяет указанные параметры.</p>

    

    
        
            
            <div class="shortcode shortcode-file mb-3">
              <div class="card overflow-hidden" data-bs-theme="dark">
                <div class="card-header">
                  <div class="d-flex align-items-center">
                    <div class="flex-shrink-0">
                      <i class="far fa-file-code fa-fw"></i>
                    </div>
                    <div class="flex-grow-1 mx-2 text-truncate">
                      <code>pwsh.set.ip.ps1</code>
                    </div>
                    <div class="flex-shrink-0">
                      <ul class="list-inline mb-0">
                        <li class="list-inline-item" title='Копировать'>
                          <a class="text-body" href="#"
                             data-fn="clipboard" data-clipboard-target="#cp-60483343a9ea95e92d9f7c001db67b1a"
                             role="button" aria-label='Копировать'>
                            <i class="fas fa-copy fa-fw"></i>
                          </a>
                        </li>
                        <li class="list-inline-item" title='Скачать'>
                          <a class="text-body" href="/ru/2023/10/430b916d-fd5c-5d44-8c24-8b98f41e0355/pwsh.set.ip.ps1" download
                             role="button" aria-label='Скачать'>
                            <i class="fas fa-download fa-fw"></i>
                          </a>
                        </li>
                        <li class="list-inline-item" title='Открыть'>
                          <a class="text-body" href="/ru/2023/10/430b916d-fd5c-5d44-8c24-8b98f41e0355/pwsh.set.ip.ps1" target="_blank"
                             role="button" aria-label='Открыть'>
                            <i class="fas fa-arrow-up-right-from-square fa-fw"></i>
                          </a>
                        </li>
                      </ul>
                    </div>
                  </div>
                </div>
                <div class="card-body p-0 overflow-auto" id="cp-60483343a9ea95e92d9f7c001db67b1a">
                    
                        
                    
                    <div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-ps1" data-lang="ps1"><span class="line"><span class="cl"><span class="cm">&lt;#PSScriptInfo
</span></span></span><span class="line"><span class="cl"><span class="cm">.VERSION      0.1.0
</span></span></span><span class="line"><span class="cl"><span class="cm">.GUID         b42524a4-c0d0-4402-951c-e97aa140698e
</span></span></span><span class="line"><span class="cl"><span class="cm">.AUTHOR       Kai Kimera
</span></span></span><span class="line"><span class="cl"><span class="cm">.AUTHOREMAIL  mail@kai.kim
</span></span></span><span class="line"><span class="cl"><span class="cm">.COMPANYNAME  Library Online
</span></span></span><span class="line"><span class="cl"><span class="cm">.COPYRIGHT    2023 Library Online. All rights reserved.
</span></span></span><span class="line"><span class="cl"><span class="cm">.LICENSEURI   https://choosealicense.com/licenses/mit/
</span></span></span><span class="line"><span class="cl"><span class="cm">.PROJECTURI   https://lib.onl/ru/2023/10/430b916d-fd5c-5d44-8c24-8b98f41e0355/
</span></span></span><span class="line"><span class="cl"><span class="cm">#&gt;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c">#</span><span class="k">Requires</span><span class="w"> </span><span class="kd">-Version</span><span class="na"> 7.2</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c">#</span><span class="k">Requires</span><span class="w"> </span><span class="kd">-RunAsAdministrator</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c"># -------------------------------------------------------------------------------------------------------------------- #</span>
</span></span><span class="line"><span class="cl"><span class="c"># CONFIGURATION</span>
</span></span><span class="line"><span class="cl"><span class="c"># -------------------------------------------------------------------------------------------------------------------- #</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nv">$Adapter</span> <span class="p">=</span> <span class="vm">@</span><span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="c"># Interface index.</span>
</span></span><span class="line"><span class="cl">  <span class="n">InterfaceIndex</span> <span class="p">=</span> <span class="mf">0</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nv">$IP</span> <span class="p">=</span> <span class="vm">@</span><span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="c"># IP address.</span>
</span></span><span class="line"><span class="cl">  <span class="n">IPAddress</span> <span class="p">=</span> <span class="s1">&#39;192.168.0.10&#39;</span>
</span></span><span class="line"><span class="cl">  <span class="c"># Subnet mask.</span>
</span></span><span class="line"><span class="cl">  <span class="n">PrefixLength</span> <span class="p">=</span> <span class="s1">&#39;24&#39;</span>
</span></span><span class="line"><span class="cl">  <span class="c"># Gateway.</span>
</span></span><span class="line"><span class="cl">  <span class="n">DefaultGateway</span> <span class="p">=</span> <span class="s1">&#39;192.168.0.1&#39;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nv">$DNS</span> <span class="p">=</span> <span class="vm">@</span><span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="c"># DNS servers.</span>
</span></span><span class="line"><span class="cl">  <span class="n">ServerAddresses</span> <span class="p">=</span> <span class="p">(</span>
</span></span><span class="line"><span class="cl">    <span class="s1">&#39;192.168.0.2&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="s1">&#39;192.168.1.2&#39;</span>
</span></span><span class="line"><span class="cl">  <span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c"># -------------------------------------------------------------------------------------------------------------------- #</span>
</span></span><span class="line"><span class="cl"><span class="c"># -------------------------------------------------&lt; RUNNING SCRIPT &gt;------------------------------------------------- #</span>
</span></span><span class="line"><span class="cl"><span class="c"># -------------------------------------------------------------------------------------------------------------------- #</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nb">Get-NetAdapter</span> <span class="nv">@Adapter</span> <span class="p">|</span> <span class="nb">Remove-NetIPAddress</span> <span class="n">-Confirm:</span><span class="vm">$false</span>   <span class="c"># Removing current IP address.</span>
</span></span><span class="line"><span class="cl"><span class="nb">Get-NetAdapter</span> <span class="nv">@Adapter</span> <span class="p">|</span> <span class="nb">Remove-NetRoute</span> <span class="n">-Confirm:</span><span class="vm">$false</span>       <span class="c"># Removing current gateway.</span>
</span></span><span class="line"><span class="cl"><span class="nb">Get-NetAdapter</span> <span class="nv">@Adapter</span> <span class="p">|</span> <span class="nb">New-NetIPAddress</span> <span class="nv">@IP</span>                  <span class="c"># Setting new IP address.</span>
</span></span><span class="line"><span class="cl"><span class="nb">Get-NetAdapter</span> <span class="nv">@Adapter</span> <span class="p">|</span> <span class="nb">Set-DNSClientServerAddress</span> <span class="nv">@DNS</span>       <span class="c"># Setting new DNS servers.</span></span></span></code></pre></td></tr></table>
</div>
</div>
                </div>
              </div>
            </div>]]></turbo:content></item><item turbo="true"><title>Как при помощи CloudFlare заменить в URL одну директорию на другую?</title><link>https://lib.onl/ru/2023/10/3c4c6709-69a6-54be-9404-e4b7ede6ab90/</link><pubDate>Tue, 31 Oct 2023 06:16:50 +0000</pubDate><dc:creator>Kai Kimera</dc:creator><category>Cloudflare</category><turbo:extendedHtml>true</turbo:extendedHtml><turbo:source>https://lib.onl/ru/2023/10/3c4c6709-69a6-54be-9404-e4b7ede6ab90/</turbo:source><turbo:topic>Как при помощи CloudFlare заменить в URL одну директорию на другую?</turbo:topic><turbo:content><![CDATA[<p>Здравствуйте! Страницы сайта переехали в другой раздел. Было <code>domain.com/[pages]/post_1</code>, стало <code>domain.com/[posts]/post_1</code>. Надо сделать перенаправление. Но как?</p>]]></turbo:content></item><item turbo="true"><title>Работа с правилами CloudFlare</title><link>https://lib.onl/ru/2023/10/e191797e-d558-5017-8ac4-c28c6e0871ff/</link><pubDate>Sun, 29 Oct 2023 06:55:05 +0000</pubDate><dc:creator>Kai Kimera</dc:creator><category>В доработке</category><category>Сеть</category><yandex:related><link url="https://lib.onl/ru/2020/07/ff2ae66e-8e14-5c4a-baa6-0cd2e59f6517/">MikroTik и CloudFlare: Динамический IP для домена</link></yandex:related><turbo:extendedHtml>true</turbo:extendedHtml><turbo:source>https://lib.onl/ru/2023/10/e191797e-d558-5017-8ac4-c28c6e0871ff/</turbo:source><turbo:topic>Работа с правилами CloudFlare</turbo:topic><turbo:content><![CDATA[<p><span class="shortcode shortcode-tag"><a href="/ru/tags/cloudflare/" target="_blank">#CloudFlare</a></span> предоставляет мощный инструмент по работе с различными правилами, зависящими от запросов клиентов. Разберём составление этих правил и приведём несколько примеров.</p>
<h2 id="настройки-правила">
  <a class="link-body-emphasis" href="#%d0%bd%d0%b0%d1%81%d1%82%d1%80%d0%be%d0%b9%d0%ba%d0%b8-%d0%bf%d1%80%d0%b0%d0%b2%d0%b8%d0%bb%d0%b0">Настройки правила</a>
</h2><p>Правила работаю на, так называемом, <a title="" href="https://developers.cloudflare.com/ruleset-engine/" target="_blank"
   rel="noopener noreferrer">Cloudflare Ruleset Engine</a> и позволяют максимально гибко себя конфигурировать при помощи специальных полей, условий и переменных.</p>
<p>Каждое правило состоит из двух этапов:</p>
<ol>
<li>If&hellip; - если.</li>
<li>Then&hellip; - тогда.</li>
</ol>
<p>Рассмотрим всё это дело подробнее&hellip;</p>
<h3 id="if">
  <a class="link-body-emphasis" href="#if">If&hellip;</a>
</h3><p>Этап &ldquo;Если&rdquo; означает условие, по которому будут фильтроваться клиенты. Этап состоит из поля, оператора сравнения и значения, которое будет участвовать в составленном условии.</p>
<h4 id="поля">
  <a class="link-body-emphasis" href="#%d0%bf%d0%be%d0%bb%d1%8f">Поля</a>
</h4><p>Поля это переменные, значения которых вычисляются из запроса, инициируемого клиентом. Ниже приведён частичный список полей, которые доступны из графического интерфейса. Полный список полей находится в <a title="" href="https://developers.cloudflare.com/ruleset-engine/rules-language/fields/" target="_blank"
   rel="noopener noreferrer">документации CloudFlare</a>.</p>
<ul>
<li>AS Num <code>ip.src.asnum</code>.<br>
16- или 32-разрядное целое число, представляющее номер автономной системы (AS), связанной с IP-адресом клиента. Это поле эквивалентно устаревшему <code>ip.geoip.asnum</code>.</li>
<li>Cookie <code>http.cookie</code>.<br>
Файл cookie в строке. Пример: <code>session=8521F670545D7865F79C3D7BEDC29CCE;-background=light</code>.</li>
<li>Country <code>ip.src.country</code>.<br>
Двухбуквенный код страны в формате ISO 3166-1 Alpha 2. Пример: GB. Это поле эквивалентно устаревшему <code>ip.geoip.country</code>.</li>
<li>Continent <code>ip.src.continent</code>.<br>
Код континента, связанный с IP-адресом клиента. Это поле эквивалентно устаревшему <code>ip.geoip.continent</code>.
<ul>
<li><code>AF</code> - Africa.</li>
<li><code>AN</code> - Antarctica.</li>
<li><code>AS</code> - Asia.</li>
<li><code>EU</code> - Europe.</li>
<li><code>NA</code> - North America.</li>
<li><code>OC</code> - Oceania.</li>
<li><code>SA</code> - South America.</li>
<li><code>T1</code> - Tor network.</li>
</ul>
</li>
<li>Hostname <code>http.host</code>.<br>
Имя хоста. Пример: <code>www.example.org</code>.</li>
<li>IP Source Address <code>ip.src</code>.<br>
IP-адрес клиента. Пример: <code>93.184.216.34</code>.</li>
<li>Referer <code>http.referer</code>.<br>
Заголовок запроса HTTP Referer, который содержит адрес веб-страницы, с которой пришёл запрос. Пример: <code>Referer: htt­ps://developer.example.org/en-US/docs/Web/JavaScript</code>.</li>
<li>Request Method <code>http.request.method</code>.<br>
Метод HTTP-запроса. Пример: <code>GET</code>.</li>
<li>SSL/HTTPS <code>ssl</code>.<br>
Возвращает <code>true</code>, когда используется зашифрованное соединение с клиентом.</li>
<li>URI Full <code>http.request.full_uri</code>.<br>
Весь URI, полученный сервером. Пример: <code>htt­ps://www.example.org/articles/index?section=539061&amp;expand=comments</code>.</li>
<li>URI <code>http.request.uri</code>.<br>
Путь URI и строка запроса. Пример: <code>/articles/index?section=539061&amp;expand=comments</code>.</li>
<li>URI Path <code>http.request.uri.path</code>.<br>
Путь URI. Пример: <code>/articles/index</code>.</li>
<li>URI Query String <code>http.request.uri.query</code>.<br>
Строка запроса без разделителя <code>?</code>. Пример: <code>section=539061&amp;expand=comments</code>.</li>
<li>HTTP Version <code>http.request.version</code>.<br>
Версия используемого протокола HTTP. Пример: <code>HTTP/1.1</code> или <code>HTTP/3</code>.</li>
<li>User Agent <code>http.user_agent</code>.<br>
User Agent клиента, строка, позволяющая идентифицировать клиентскую операционную систему и веб-браузер. Пример: <code>Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/65.0.3325.181 Safari/537.36</code>.</li>
<li>X-Forward-For <code>http.x_forwarded_for</code>.<br>
Заголовок X-Forwarded-For. Пример: <code>203.0.113.195, 70.41.3.18</code>.</li>
<li>Client Certificate Verified <code>cf.tls_client_auth.cert_verified</code>.<br>
Возвращает <code>true</code>, когда запрос предоставляет действительный сертификат клиента.</li>
</ul>
<h4 id="операторы">
  <a class="link-body-emphasis" href="#%d0%be%d0%bf%d0%b5%d1%80%d0%b0%d1%82%d0%be%d1%80%d1%8b">Операторы</a>
</h4><p>Операторы сравнения возвращают true, когда значение запроса клиента совпадает со значением в выражении. Подробнее в <a title="" href="https://developers.cloudflare.com/ruleset-engine/rules-language/operators/" target="_blank"
   rel="noopener noreferrer">документации</a>.</p>
<ul>
<li>equals <code>eq</code> - равно.</li>
<li>does not equal <code>ne</code> -  не равно.</li>
<li>greater than <code>gt</code> - больше чем.</li>
<li>less than <code>lt</code> - меньше чем.</li>
<li>greater than or equal to <code>ge</code> - больше или равно.</li>
<li>less than or equal to <code>le</code> - меньше или равно.</li>
<li>is in <code>in {}</code> - значение находится в массиве.</li>
<li>is not in <code>not &lt;field&gt; in {}</code> - значение не находится в массиве.</li>
</ul>
<h3 id="then">
  <a class="link-body-emphasis" href="#then">Then&hellip;</a>
</h3><p>Этап &ldquo;Тогда&rdquo; подразумевает под собой действие, которое будет применено к отфильтрованному клиенту.</p>
<h4 id="тип-поля-url">
  <a class="link-body-emphasis" href="#%d1%82%d0%b8%d0%bf-%d0%bf%d0%be%d0%bb%d1%8f-url">Тип поля URL</a>
</h4><ul>
<li>Dynamic - в поле URL содержит динамические параметры (переменные полей) и их необходимо вычислять и обрабатывать.</li>
<li>Static - в поле URL содержится обычные статические параметры.</li>
</ul>
<h4 id="коды-статуса">
  <a class="link-body-emphasis" href="#%d0%ba%d0%be%d0%b4%d1%8b-%d1%81%d1%82%d0%b0%d1%82%d1%83%d1%81%d0%b0">Коды статуса</a>
</h4><ul>
<li>301 (Moved Permanently).<br>
Запрошенный ресурс был окончательно перемещён в URL, указанный в заголовке <code>Location</code>. Браузер в случае такого ответа перенаправляется на эту страницу, а поисковые системы обновляют свои ссылки на ресурс (говоря языком SEO, вес страницы переносится на новый URL-адрес).</li>
<li>302 (Moved Temporarily).<br>
Запрошенный ресурс был временно перемещён по адресу, указанному в заголовке <code>Location</code>. Получив такой ответ браузер перенаправляется на новую страницу, но поисковые системы не обновляют свои ссылки на ресурс (в жаргоне SEO говорят, что вес ссылки (link-juice) не меняется и не отправляется на новый URL-адрес).</li>
<li>303 (See Other).<br>
Перенаправление производится не на новый (только что загруженный) ресурс, а на другую страницу, например, страницу подтверждения или страницу с результатами загрузки.</li>
<li>307 (Temporary Redirect).<br>
Запрошенный ресурс был временно перемещён в URL-адрес, указанный в заголовке <code>Location</code>. Единственное различие между 307 и 302 состоит в том, что 307 гарантирует, что метод и тело не будут изменены при выполнении перенаправленного запроса. В случае с кодом 302 некоторые старые клиенты неправильно меняли метод на <code>GET</code>, из-за чего поведение запросов с методом отличным от <code>GET</code> и ответа с кодом 302 непредсказуемо, тогда как поведение в случае ответа с кодом 307 предсказуемо. Для запросов <code>GET</code> поведение идентично.</li>
<li>308 (Permanent Redirect).<br>
Запрошенный ресурс был окончательно перемещён в URL-адрес, указанный в <code>Location</code>. Браузер перенаправляется на эту страницу, а поисковые системы обновляют свои ссылки на ресурс (в SEO-speak говорится, что link-juice отправляется на новый URL-адрес). Метод запроса и тело не будут изменены, тогда как 301 иногда может быть неправильно заменён на <code>GET</code> метод.</li>
</ul>
<p>В примерах я буду приводить шаблон, который вписывается в редактор выражения. Поэтому, можно не щёлкать по удобным кнопочкам, а сразу нажимать <span class="shortcode shortcode-btn d-inline-block"><kbd class="bg-primary">Edit expression</kbd></span> и вписывать нужный шаблон.</p>
<h2 id="переадресация">
  <a class="link-body-emphasis" href="#%d0%bf%d0%b5%d1%80%d0%b5%d0%b0%d0%b4%d1%80%d0%b5%d1%81%d0%b0%d1%86%d0%b8%d1%8f">Переадресация</a>
</h2><p>Самый часто используемый тип правил, это правила по работе с переадресацией. Привожу несколько примеров. Их можно брать готовыми и вставлять в редактор выражения, не забыв отредактировать под себя некоторые входные параметры, например, название домена или адрес куда переадресовывать клиентов.</p>
<h3 id="примеры">
  <a class="link-body-emphasis" href="#%d0%bf%d1%80%d0%b8%d0%bc%d0%b5%d1%80%d1%8b">Примеры</a>
</h3><p>Ниже я привёл примеры, которые позволяют реализовать наиболее популярные правила переадресации запросов.</p>
<h4 id="пути">
  <a class="link-body-emphasis" href="#%d0%bf%d1%83%d1%82%d0%b8">Пути</a>
</h4><p>Переадресация запроса с одного ресурса (или страницы) на другой ресурс (или страницу).</p>


<div class="accordion mb-3 shortcode shortcode-accordion" id="sc-a8ec36334fe29993bc73f5d4b48c1c5e">
    




    
    <div class="accordion-item">
      <div class="accordion-header">
        <a class="accordion-button collapsed" href="#" role="button" tabindex="0"
           data-bs-toggle="collapse" data-bs-target="#sc-a3badb2730452d145d121f6c230451bd"
           aria-expanded="false" aria-controls="sc-a3badb2730452d145d121f6c230451bd" aria-label="example.com | www.example.com">
            example.com | www.example.com
        </a>
      </div>
      <div class="accordion-collapse collapse" id="sc-a3badb2730452d145d121f6c230451bd" data-bs-parent="#sc-a8ec36334fe29993bc73f5d4b48c1c5e">
        <div class="accordion-body">
            <p><code>https://example.com</code> <code>-&gt;</code> <code>https://www.example.com</code></p>
<p><strong>When incoming requests match:</strong></p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-0
shortcode-codeblock-lua">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-b9f318368eefa179b9f8c230332013d2" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-lua" data-lang="lua"><span class="line"><span class="cl"><span class="p">(</span><span class="n">http.host</span> <span class="n">eq</span> <span class="s2">&#34;example.com&#34;</span><span class="p">)</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-b9f318368eefa179b9f8c230332013d2"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<p><strong>Then&hellip;</strong></p>
<ul>
<li>Type: <code>Dynamic</code></li>
<li>Status code: <code>301</code></li>
</ul>
<p><strong>URL:</strong></p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-1
shortcode-codeblock-lua">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-1c90ecc99f9481268b5ea65be2d1f843" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-lua" data-lang="lua"><span class="line"><span class="cl"><span class="n">concat</span><span class="p">(</span><span class="s2">&#34;https://www.&#34;</span><span class="p">,</span> <span class="n">http.host</span><span class="p">,</span> <span class="n">http.request</span><span class="p">.</span><span class="n">uri.path</span><span class="p">)</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-1c90ecc99f9481268b5ea65be2d1f843"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>



        </div>
      </div>
    </div>






    
    <div class="accordion-item">
      <div class="accordion-header">
        <a class="accordion-button collapsed" href="#" role="button" tabindex="0"
           data-bs-toggle="collapse" data-bs-target="#sc-07d163f664c565ec3ecc0b79e4232dba"
           aria-expanded="false" aria-controls="sc-07d163f664c565ec3ecc0b79e4232dba" aria-label="www.example.com | example.com">
            www.example.com | example.com
        </a>
      </div>
      <div class="accordion-collapse collapse" id="sc-07d163f664c565ec3ecc0b79e4232dba" data-bs-parent="#sc-a8ec36334fe29993bc73f5d4b48c1c5e">
        <div class="accordion-body">
            <p><code>https://www.example.com</code> <code>-&gt;</code> <code>https://example.com</code></p>
<p><strong>When incoming requests match:</strong></p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-0
shortcode-codeblock-lua">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-c8dbb90babe28832011b5ccf6e8ec049" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-lua" data-lang="lua"><span class="line"><span class="cl"><span class="p">(</span><span class="n">http.host</span> <span class="n">eq</span> <span class="s2">&#34;www.example.com&#34;</span><span class="p">)</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-c8dbb90babe28832011b5ccf6e8ec049"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<p><strong>Then&hellip;</strong></p>
<ul>
<li>Type: <code>Dynamic</code></li>
<li>Status code: <code>301</code></li>
</ul>
<p><strong>URL:</strong></p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-1
shortcode-codeblock-lua">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-a4d1003e47725d1fa957a0db601ca7c6" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-lua" data-lang="lua"><span class="line"><span class="cl"><span class="n">concat</span><span class="p">(</span><span class="s2">&#34;https://&#34;</span><span class="p">,</span> <span class="n">http.host</span><span class="p">,</span> <span class="n">http.request</span><span class="p">.</span><span class="n">uri.path</span><span class="p">)</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-a4d1003e47725d1fa957a0db601ca7c6"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>



        </div>
      </div>
    </div>






    
    <div class="accordion-item">
      <div class="accordion-header">
        <a class="accordion-button collapsed" href="#" role="button" tabindex="0"
           data-bs-toggle="collapse" data-bs-target="#sc-a80bc2be067542aa17562ceb8f5fd24c"
           aria-expanded="false" aria-controls="sc-a80bc2be067542aa17562ceb8f5fd24c" aria-label="example.com/path | example.org/path">
            example.com/path | example.org/path
        </a>
      </div>
      <div class="accordion-collapse collapse" id="sc-a80bc2be067542aa17562ceb8f5fd24c" data-bs-parent="#sc-a8ec36334fe29993bc73f5d4b48c1c5e">
        <div class="accordion-body">
            <p><code>https://example.com/path</code> <code>-&gt;</code> <code>https://example.org/path</code></p>
<p><strong>When incoming requests match:</strong></p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-0
shortcode-codeblock-lua">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-3b68f97e94dd1f59ac021fbf6837e4d8" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-lua" data-lang="lua"><span class="line"><span class="cl"><span class="p">(</span><span class="n">http.host</span> <span class="n">eq</span> <span class="s2">&#34;example.com&#34;</span><span class="p">)</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-3b68f97e94dd1f59ac021fbf6837e4d8"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<p><strong>Then&hellip;</strong></p>
<ul>
<li>Type: <code>Dynamic</code></li>
<li>Status code: <code>301</code></li>
</ul>
<p><strong>URL:</strong></p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-1
shortcode-codeblock-lua">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-26bd1f9d709e8eab9c1b2aa021a0361c" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-lua" data-lang="lua"><span class="line"><span class="cl"><span class="n">concat</span><span class="p">(</span><span class="s2">&#34;https://example.org&#34;</span><span class="p">,</span> <span class="n">http.request</span><span class="p">.</span><span class="n">uri.path</span><span class="p">)</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-26bd1f9d709e8eab9c1b2aa021a0361c"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>



        </div>
      </div>
    </div>






    
    <div class="accordion-item">
      <div class="accordion-header">
        <a class="accordion-button collapsed" href="#" role="button" tabindex="0"
           data-bs-toggle="collapse" data-bs-target="#sc-4d231804993ec2938f7fac587f8840d0"
           aria-expanded="false" aria-controls="sc-4d231804993ec2938f7fac587f8840d0" aria-label="example.com | example.org">
            example.com | example.org
        </a>
      </div>
      <div class="accordion-collapse collapse" id="sc-4d231804993ec2938f7fac587f8840d0" data-bs-parent="#sc-a8ec36334fe29993bc73f5d4b48c1c5e">
        <div class="accordion-body">
            <p><code>https://example.com</code> <code>-&gt;</code> <code>https://example.org</code></p>
<p><strong>When incoming requests match:</strong></p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-0
shortcode-codeblock-lua">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-7abe3fb8d3d85006d35155dc1ba5d106" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-lua" data-lang="lua"><span class="line"><span class="cl"><span class="p">(</span><span class="n">http.host</span> <span class="n">contains</span> <span class="s2">&#34;example.com&#34;</span><span class="p">)</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-7abe3fb8d3d85006d35155dc1ba5d106"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<p><strong>Then&hellip;</strong></p>
<ul>
<li>Type: <code>Static</code></li>
<li>Status code: <code>301</code></li>
</ul>
<p><strong>URL:</strong></p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-1
shortcode-codeblock-lua">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-1d084837a16c3a44cc8f39753728b465" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-lua" data-lang="lua"><span class="line"><span class="cl"><span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">example.org</span><span class="o">/</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-1d084837a16c3a44cc8f39753728b465"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>



        </div>
      </div>
    </div>






    
    <div class="accordion-item">
      <div class="accordion-header">
        <a class="accordion-button collapsed" href="#" role="button" tabindex="0"
           data-bs-toggle="collapse" data-bs-target="#sc-204c2bb1f4e78a4e81a0120e54ce6716"
           aria-expanded="false" aria-controls="sc-204c2bb1f4e78a4e81a0120e54ce6716" aria-label="sub.example.com | example.com/sub">
            sub.example.com | example.com/sub
        </a>
      </div>
      <div class="accordion-collapse collapse" id="sc-204c2bb1f4e78a4e81a0120e54ce6716" data-bs-parent="#sc-a8ec36334fe29993bc73f5d4b48c1c5e">
        <div class="accordion-body">
            <p><code>https://sub.example.com</code> <code>-&gt;</code> <code>https://example.com/sub</code></p>
<p><strong>When incoming requests match:</strong></p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-0
shortcode-codeblock-lua">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-e686254568dabaec5dabeb220e95ff51" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-lua" data-lang="lua"><span class="line"><span class="cl"><span class="p">(</span><span class="n">http.host</span> <span class="n">eq</span> <span class="s2">&#34;sub.example.com&#34;</span><span class="p">)</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-e686254568dabaec5dabeb220e95ff51"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<p><strong>Then&hellip;</strong></p>
<ul>
<li>Type: <code>Dynamic</code></li>
<li>Status code: <code>301</code></li>
</ul>
<p><strong>URL:</strong></p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-1
shortcode-codeblock-lua">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-e02ab785389bdf150ffa88e9223972d2" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-lua" data-lang="lua"><span class="line"><span class="cl"><span class="n">concat</span><span class="p">(</span><span class="s2">&#34;https://&#34;</span><span class="p">,</span> <span class="n">http.host</span><span class="p">,</span> <span class="s2">&#34;/sub&#34;</span><span class="p">,</span> <span class="n">http.request</span><span class="p">.</span><span class="n">uri.path</span><span class="p">)</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-e02ab785389bdf150ffa88e9223972d2"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>



        </div>
      </div>
    </div>






    
    <div class="accordion-item">
      <div class="accordion-header">
        <a class="accordion-button collapsed" href="#" role="button" tabindex="0"
           data-bs-toggle="collapse" data-bs-target="#sc-b9f9caba757a6c0607a48794292b50f0"
           aria-expanded="false" aria-controls="sc-b9f9caba757a6c0607a48794292b50f0" aria-label="example.com/sub | sub.example.com">
            example.com/sub | sub.example.com
        </a>
      </div>
      <div class="accordion-collapse collapse" id="sc-b9f9caba757a6c0607a48794292b50f0" data-bs-parent="#sc-a8ec36334fe29993bc73f5d4b48c1c5e">
        <div class="accordion-body">
            <p><code>https://example.com/sub</code> <code>-&gt;</code> <code>https://sub.example.com</code></p>
<p><strong>When incoming requests match:</strong></p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-0
shortcode-codeblock-lua">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-eb9cc50935d20c93cefb51b7b04ea9e3" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-lua" data-lang="lua"><span class="line"><span class="cl"><span class="p">(</span><span class="n">starts_with</span><span class="p">(</span><span class="n">http.request</span><span class="p">.</span><span class="n">uri.path</span><span class="p">,</span> <span class="s2">&#34;/sub/&#34;</span><span class="p">))</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-eb9cc50935d20c93cefb51b7b04ea9e3"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<p><strong>Then&hellip;</strong></p>
<ul>
<li>Type: <code>Dynamic</code></li>
<li>Status code: <code>301</code></li>
</ul>
<p><strong>URL:</strong></p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-1
shortcode-codeblock-lua">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-eb669baa0ac7cc4f7db8fa8279d58988" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-lua" data-lang="lua"><span class="line"><span class="cl"><span class="n">concat</span><span class="p">(</span><span class="s2">&#34;https://sub.&#34;</span><span class="p">,</span> <span class="n">http.host</span><span class="p">,</span> <span class="n">substring</span><span class="p">(</span><span class="n">http.request</span><span class="p">.</span><span class="n">uri.path</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-eb669baa0ac7cc4f7db8fa8279d58988"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<p>Число в функции <code>substring()</code> - это количество символов в названии директории <code>sub</code> + 1 символ.</p>

        </div>
      </div>
    </div>






    
    <div class="accordion-item">
      <div class="accordion-header">
        <a class="accordion-button collapsed" href="#" role="button" tabindex="0"
           data-bs-toggle="collapse" data-bs-target="#sc-e2c7cdbcf4b76157a488d51d25c34fe4"
           aria-expanded="false" aria-controls="sc-e2c7cdbcf4b76157a488d51d25c34fe4" aria-label="example.com/contact-us/ | example.com/contact/">
            example.com/contact-us/ | example.com/contact/
        </a>
      </div>
      <div class="accordion-collapse collapse" id="sc-e2c7cdbcf4b76157a488d51d25c34fe4" data-bs-parent="#sc-a8ec36334fe29993bc73f5d4b48c1c5e">
        <div class="accordion-body">
            <p><code>https://example.com/contact-us/</code> <code>-&gt;</code> <code>https://example.com/contact/</code></p>
<p><strong>When incoming requests match:</strong></p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-0
shortcode-codeblock-lua">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-79d20898a4c916f69fd330b0ef0fd62b" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-lua" data-lang="lua"><span class="line"><span class="cl"><span class="p">(</span><span class="n">http.request</span><span class="p">.</span><span class="n">uri.path</span> <span class="n">eq</span> <span class="s2">&#34;/contact-us/&#34;</span><span class="p">)</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-79d20898a4c916f69fd330b0ef0fd62b"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<p><strong>Then&hellip;</strong></p>
<ul>
<li>Type: <code>Static</code></li>
<li>Status code: <code>301</code></li>
</ul>
<p><strong>URL:</strong></p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-1
shortcode-codeblock-lua">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-fe83cf48f72da8b01fe559100da90807" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-lua" data-lang="lua"><span class="line"><span class="cl"><span class="o">/</span><span class="n">contacts</span><span class="o">/</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-fe83cf48f72da8b01fe559100da90807"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>



        </div>
      </div>
    </div>



</div>

<h4 id="порты">
  <a class="link-body-emphasis" href="#%d0%bf%d0%be%d1%80%d1%82%d1%8b">Порты</a>
</h4><p>Переадресация в зависимости от запроса, пришедшего на определённый порт.</p>


<div class="accordion mb-3 shortcode shortcode-accordion" id="sc-f219ae2813b1772c6cb60161e095a344">
    




    
    <div class="accordion-item">
      <div class="accordion-header">
        <a class="accordion-button collapsed" href="#" role="button" tabindex="0"
           data-bs-toggle="collapse" data-bs-target="#sc-a49196bca5401e8c53ef9b400eca3f26"
           aria-expanded="false" aria-controls="sc-a49196bca5401e8c53ef9b400eca3f26" aria-label="Переадресовать запрос к любым портам (кроме &#39;80&#39; и &#39;443&#39;) на порт &#39;443&#39; (HTTPS)">
            Переадресовать запрос к любым портам (кроме &#39;80&#39; и &#39;443&#39;) на порт &#39;443&#39; (HTTPS)
        </a>
      </div>
      <div class="accordion-collapse collapse" id="sc-a49196bca5401e8c53ef9b400eca3f26" data-bs-parent="#sc-f219ae2813b1772c6cb60161e095a344">
        <div class="accordion-body">
            <p><code>https://example.com:1212</code> <code>-&gt;</code> <code>https://example.com</code></p>
<p><strong>When incoming requests match:</strong></p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-0
shortcode-codeblock-lua">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-8f31ab23c0b224175bcd3f63bc98dc76" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-lua" data-lang="lua"><span class="line"><span class="cl"><span class="p">(</span><span class="ow">not</span> <span class="p">(</span><span class="n">cf.edge</span><span class="p">.</span><span class="n">server_port</span> <span class="kr">in</span> <span class="p">{</span><span class="mi">80</span> <span class="mi">443</span><span class="p">}))</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-8f31ab23c0b224175bcd3f63bc98dc76"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<p><strong>Then&hellip;</strong></p>
<ul>
<li>Type: <code>Dynamic</code></li>
<li>Status code: <code>301</code></li>
</ul>
<p><strong>URL:</strong></p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-1
shortcode-codeblock-lua">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-0a0103c057b5d2a92b2a60b694bfafec" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-lua" data-lang="lua"><span class="line"><span class="cl"><span class="n">concat</span><span class="p">(</span><span class="s2">&#34;https://&#34;</span><span class="p">,</span> <span class="n">http.host</span><span class="p">,</span> <span class="n">http.request</span><span class="p">.</span><span class="n">uri.path</span><span class="p">)</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-0a0103c057b5d2a92b2a60b694bfafec"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>



        </div>
      </div>
    </div>



</div>

<h4 id="страны">
  <a class="link-body-emphasis" href="#%d1%81%d1%82%d1%80%d0%b0%d0%bd%d1%8b">Страны</a>
</h4><p>Переадресация в зависимости от страны клиента.</p>


<div class="accordion mb-3 shortcode shortcode-accordion" id="sc-0987ff57b5bf0e6cf679bde17b1f2724">
    




    
    <div class="accordion-item">
      <div class="accordion-header">
        <a class="accordion-button collapsed" href="#" role="button" tabindex="0"
           data-bs-toggle="collapse" data-bs-target="#sc-a04a4ec8e2a55c5155044aa915210633"
           aria-expanded="false" aria-controls="sc-a04a4ec8e2a55c5155044aa915210633" aria-label="Переадресовать пользователей из стран RU/BY/UA в директорию &#39;/ru&#39;">
            Переадресовать пользователей из стран RU/BY/UA в директорию &#39;/ru&#39;
        </a>
      </div>
      <div class="accordion-collapse collapse" id="sc-a04a4ec8e2a55c5155044aa915210633" data-bs-parent="#sc-0987ff57b5bf0e6cf679bde17b1f2724">
        <div class="accordion-body">
            <p><code>https://example.com</code> <code>-&gt;</code> <code>https://example.com/ru/</code></p>
<p><strong>When incoming requests match:</strong></p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-0
shortcode-codeblock-lua">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-0052a6547612461daf7a6d0cd249495e" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-lua" data-lang="lua"><span class="line"><span class="cl"><span class="p">(((</span><span class="n">ip.src</span><span class="p">.</span><span class="n">country</span> <span class="n">eq</span> <span class="s2">&#34;RU&#34;</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="n">ip.src</span><span class="p">.</span><span class="n">country</span> <span class="n">eq</span> <span class="s2">&#34;BY&#34;</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="n">ip.src</span><span class="p">.</span><span class="n">country</span> <span class="n">eq</span> <span class="s2">&#34;UA&#34;</span><span class="p">))</span> <span class="ow">and</span> <span class="p">(</span><span class="n">http.request</span><span class="p">.</span><span class="n">uri.path</span> <span class="n">eq</span> <span class="s2">&#34;/&#34;</span><span class="p">))</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-0052a6547612461daf7a6d0cd249495e"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<p><strong>Then&hellip;</strong></p>
<ul>
<li>Type: <code>Dynamic</code></li>
<li>Status code: <code>301</code></li>
</ul>
<p><strong>URL:</strong></p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-1
shortcode-codeblock-lua">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-d819b1b1dad1ee241b5a61d18e8efad2" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-lua" data-lang="lua"><span class="line"><span class="cl"><span class="n">lower</span><span class="p">(</span><span class="n">concat</span><span class="p">(</span><span class="s2">&#34;https://&#34;</span><span class="p">,</span> <span class="n">http.host</span><span class="p">,</span> <span class="s2">&#34;/ru/&#34;</span><span class="p">))</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-d819b1b1dad1ee241b5a61d18e8efad2"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>



        </div>
      </div>
    </div>






    
    <div class="accordion-item">
      <div class="accordion-header">
        <a class="accordion-button collapsed" href="#" role="button" tabindex="0"
           data-bs-toggle="collapse" data-bs-target="#sc-0ebb5b3bdfa2908b30790d6d5d2d3317"
           aria-expanded="false" aria-controls="sc-0ebb5b3bdfa2908b30790d6d5d2d3317" aria-label="Переадресовать пользователей НЕ из стран RU/BY/UA в директорию &#39;/en&#39;">
            Переадресовать пользователей НЕ из стран RU/BY/UA в директорию &#39;/en&#39;
        </a>
      </div>
      <div class="accordion-collapse collapse" id="sc-0ebb5b3bdfa2908b30790d6d5d2d3317" data-bs-parent="#sc-0987ff57b5bf0e6cf679bde17b1f2724">
        <div class="accordion-body">
            <p><code>https://example.com</code> <code>-&gt;</code> <code>https://example.com/en/</code></p>
<p><strong>When incoming requests match:</strong></p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-0
shortcode-codeblock-lua">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-a0d0537f21def77f2651416bb1e0e081" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-lua" data-lang="lua"><span class="line"><span class="cl"><span class="p">(((</span><span class="n">ip.src</span><span class="p">.</span><span class="n">country</span> <span class="n">ne</span> <span class="s2">&#34;RU&#34;</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="n">ip.src</span><span class="p">.</span><span class="n">country</span> <span class="n">ne</span> <span class="s2">&#34;BY&#34;</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="n">ip.src</span><span class="p">.</span><span class="n">country</span> <span class="n">ne</span> <span class="s2">&#34;UA&#34;</span><span class="p">))</span> <span class="ow">and</span> <span class="p">(</span><span class="n">http.request</span><span class="p">.</span><span class="n">uri.path</span> <span class="n">eq</span> <span class="s2">&#34;/&#34;</span><span class="p">))</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-a0d0537f21def77f2651416bb1e0e081"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<p><strong>Then&hellip;</strong></p>
<ul>
<li>Type: <code>Dynamic</code></li>
<li>Status code: <code>301</code></li>
</ul>
<p><strong>URL:</strong></p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-1
shortcode-codeblock-lua">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-7d4b8fd37686ea002c6f79db566c4913" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-lua" data-lang="lua"><span class="line"><span class="cl"><span class="n">lower</span><span class="p">(</span><span class="n">concat</span><span class="p">(</span><span class="s2">&#34;https://&#34;</span><span class="p">,</span> <span class="n">http.host</span><span class="p">,</span> <span class="s2">&#34;/en/&#34;</span><span class="p">))</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-7d4b8fd37686ea002c6f79db566c4913"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>



        </div>
      </div>
    </div>



</div>]]></turbo:content></item><item turbo="true"><title>Работа с переменной среды окружения PATH</title><link>https://lib.onl/ru/2023/10/1f062637-3227-56d7-93e3-126d1c80f5a8/</link><pubDate>Sat, 28 Oct 2023 12:27:07 +0000</pubDate><dc:creator>Kai Kimera</dc:creator><category>MS Windows</category><category>Терминал</category><category>Скрипты</category><yandex:related><link url="https://lib.onl/ru/2023/10/eb39e3f7-b194-53d4-8bad-01edf9fdac47/">Дефрагментация в ОС Windows</link><link url="https://lib.onl/ru/2023/10/fb64d665-3e56-5fa5-a9eb-2e2e251949d8/">Автоматическая настройка Windows Server 2022 под рабочую станцию</link><link url="https://lib.onl/ru/2023/10/38fc94dd-8d37-5f9e-b556-676304976a9f/">Восстановление доверительных отношений между PC и Active Directory</link><link url="https://lib.onl/ru/2023/10/616da78a-eb16-575a-9119-65f0c0c7baee/">Изменение порта RDP</link><link url="https://lib.onl/ru/2023/10/c6e32349-8fc2-53f9-9a42-790878a64076/">PowerShell: Полезные функции</link><link url="https://lib.onl/ru/2023/10/52d75b90-0637-5ba6-91d6-b1bff40e1d67/">PowerShell: Стирание диска</link><link url="https://lib.onl/ru/2023/10/2a73410a-6611-570c-9ab4-dc8cc8998146/">PowerShell: Сжатие видео при помощи FFmpeg</link><link url="https://lib.onl/ru/2023/10/0028821e-c96c-5014-a1dd-8963c161b170/">PowerShell: Определение разрядности ОС Windows</link><link url="https://lib.onl/ru/2023/10/4c7aba7c-f5a6-589a-9975-fdb16f2e2862/">PowerShell Vault</link><link url="https://lib.onl/ru/2023/10/75075788-9308-56b7-b531-2008cb35f7d0/">Установка сертификата НУЦ Минцифры</link><link url="https://lib.onl/ru/2023/09/dd5a3e1a-596b-50d5-b070-b2a065f99f32/">Получение и установка MS Office 2021 LTSC</link><link url="https://lib.onl/ru/2022/05/862226e6-cbb1-58f8-bc8e-0cfef747f475/">Интеграция обновлений в дистрибутив ОС MS Windows</link><link url="https://lib.onl/ru/2022/05/36058650-3f35-5ed5-9565-0aa7d8800c28/">Windows Server 2022 для рабочей станции</link></yandex:related><turbo:extendedHtml>true</turbo:extendedHtml><turbo:source>https://lib.onl/ru/2023/10/1f062637-3227-56d7-93e3-126d1c80f5a8/</turbo:source><turbo:topic>Работа с переменной среды окружения PATH</turbo:topic><turbo:content><![CDATA[<p>Переменная <code>Path</code> является переменной среды окружения, при помощи которой ОС <span class="shortcode shortcode-tag"><a href="/ru/tags/windows/" target="_blank">#Windows</a></span> находит нужные приложения в терминале. Рассмотрим способы редактирования значений этой переменной.</p>
<p>Проще говоря, в переменную <code>Path</code> можно добавлять пути к директориям приложений, для того чтобы при работе в терминале не прописывать полные пути к исполняемым файлам этих приложений. Например, в терминале, чтобы вызвать <span class="shortcode shortcode-tag"><a href="/ru/tags/git/" target="_blank">#Git</a></span> и зафиксировать изменения нужно ввести <code>C:\Apps\Git\git.exe commit -m 'bla-bla'</code>. Но если добавить значение <code>C:\Apps\Git</code> в переменную <code>Path</code>, то в терминале можно просто писать <code>git.exe commit -m 'bla-bla'</code>, больше не нужно указывать полный путь к Git&rsquo;у.</p>
<h2 id="уровни-переменной-path">
  <a class="link-body-emphasis" href="#%d1%83%d1%80%d0%be%d0%b2%d0%bd%d0%b8-%d0%bf%d0%b5%d1%80%d0%b5%d0%bc%d0%b5%d0%bd%d0%bd%d0%be%d0%b9-path">Уровни переменной <code>Path</code></a>
</h2><p>Существует два уровня переменной <code>Path</code>:</p>
<ul>
<li>Системный - является глобальным и его значения доступны для каждого аккаунта пользователя.</li>
<li>Пользовательский - работает в контексте конкретного аккаунта и содержит значения только этого пользователя. Под другим аккаунтом, переменная на пользовательском уровне может содержать другие значения.</li>
</ul>
<p>В пределах аккаунта пользователя эти два уровня переменной <code>Path</code> объединяют свои значения.</p>
<h2 id="добавление-значений-в-переменную-path">
  <a class="link-body-emphasis" href="#%d0%b4%d0%be%d0%b1%d0%b0%d0%b2%d0%bb%d0%b5%d0%bd%d0%b8%d0%b5-%d0%b7%d0%bd%d0%b0%d1%87%d0%b5%d0%bd%d0%b8%d0%b9-%d0%b2-%d0%bf%d0%b5%d1%80%d0%b5%d0%bc%d0%b5%d0%bd%d0%bd%d1%83%d1%8e-path">Добавление значений в переменную <code>Path</code></a>
</h2><p>Добавить свои значения в переменную <code>Path</code> можно несколькими способами:</p>
<ul>
<li>Графический интерфейс ОС.</li>
<li>Команда в CMD при помощи утилиты <code>setx</code>.</li>
<li>Команда в PowerShell.</li>
</ul>
<p>Значения в переменной <code>Path</code> разделяются символом <code>;</code>.</p>
<p>Так как я приверженец работы в терминале и считаю, что каждый администратор должен уметь работать с командной строкой, то привожу только два последних способа.</p>
<h3 id="командная-строка-cmd">
  <a class="link-body-emphasis" href="#%d0%ba%d0%be%d0%bc%d0%b0%d0%bd%d0%b4%d0%bd%d0%b0%d1%8f-%d1%81%d1%82%d1%80%d0%be%d0%ba%d0%b0-cmd">Командная строка CMD</a>
</h3><p>Управление переменными среды окружения в <span class="shortcode shortcode-tag"><a href="/ru/tags/cmd/" target="_blank">#CMD</a></span> происходит при помощи утилиты <code>setx</code>.</p>
<h4 id="системный-уровень">
  <a class="link-body-emphasis" href="#%d1%81%d0%b8%d1%81%d1%82%d0%b5%d0%bc%d0%bd%d1%8b%d0%b9-%d1%83%d1%80%d0%be%d0%b2%d0%b5%d0%bd%d1%8c">Системный уровень</a>
</h4><p>Чтобы добавить свои значения в переменную <code>Path</code> на системном уровне, необходимо указать ключ <code>/m</code>:</p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-0
shortcode-codeblock-bat">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-11531d9ff4de41dec2917cc8cdeb6448" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bat" data-lang="bat"><span class="line"><span class="cl">setx /m Path <span class="s2">&#34;</span><span class="nv">%Path%</span><span class="s2">C:\Apps\App_01;C:\Apps\App_02&#34;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-11531d9ff4de41dec2917cc8cdeb6448"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>






    












    
    


<div class="shortcode shortcode-alert">
  <div class="alert alert-danger d-flex overflow-hidden" role="alert">
    <div class="flex-shrink-0 align-self-center">
      <i class="fas fa-circle-radiation fa-fw fa-2x"></i>
    </div>
    <div class="flex-grow-1 ms-3 overflow-hidden">
        <p>Ни в коем случае нельзя прописывать в <code>setx</code> свои значения БЕЗ вызова переменной <code>Path</code>: при такой команде утилита <code>setx</code> обнулит все существующие значения в <code>Path</code> и запишет указанные вами. А значения, добавленные программами, пропадут.</p>
<p>Правильная команда должны быть такой:</p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-0
shortcode-codeblock-bat">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-49f07bd7599d804e35046f500bab6f95" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bat" data-lang="bat"><span class="line"><span class="cl">setx /m Path <span class="s2">&#34;</span><span class="nv">%Path%</span><span class="s2">C:\MyCustomDir&#34;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-49f07bd7599d804e35046f500bab6f95"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<p>Здесь мы заранее вызываем переменную <code>Path</code> конструкцией <code>%Path%</code>, которая добавит существующие значения к вашим и всё это дело пропишется утилитой <code>setx</code> обратно в <code>Path</code>.</p>

    </div>
  </div>
</div>

<p>Необходимости в скрипте, который добавляет значения в переменную <code>Path</code> на системном уровне, нет. Но я всё же его написал, пусть будет.</p>

    

    
        
            
            <div class="shortcode shortcode-file mb-3">
              <div class="card overflow-hidden" data-bs-theme="dark">
                <div class="card-header">
                  <div class="d-flex align-items-center">
                    <div class="flex-shrink-0">
                      <i class="far fa-file-code fa-fw"></i>
                    </div>
                    <div class="flex-grow-1 mx-2 text-truncate">
                      <code>cmd.set.env.path.system.bat</code>
                    </div>
                    <div class="flex-shrink-0">
                      <ul class="list-inline mb-0">
                        <li class="list-inline-item" title='Копировать'>
                          <a class="text-body" href="#"
                             data-fn="clipboard" data-clipboard-target="#cp-7d604bad85885c9538032a06c0a0d34c"
                             role="button" aria-label='Копировать'>
                            <i class="fas fa-copy fa-fw"></i>
                          </a>
                        </li>
                        <li class="list-inline-item" title='Скачать'>
                          <a class="text-body" href="/ru/2023/10/1f062637-3227-56d7-93e3-126d1c80f5a8/cmd.set.env.path.system.bat" download
                             role="button" aria-label='Скачать'>
                            <i class="fas fa-download fa-fw"></i>
                          </a>
                        </li>
                        <li class="list-inline-item" title='Открыть'>
                          <a class="text-body" href="/ru/2023/10/1f062637-3227-56d7-93e3-126d1c80f5a8/cmd.set.env.path.system.bat" target="_blank"
                             role="button" aria-label='Открыть'>
                            <i class="fas fa-arrow-up-right-from-square fa-fw"></i>
                          </a>
                        </li>
                      </ul>
                    </div>
                  </div>
                </div>
                <div class="card-body p-0 overflow-auto" id="cp-7d604bad85885c9538032a06c0a0d34c">
                    
                        
                    
                    <div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bat" data-lang="bat"><span class="line"><span class="cl"><span class="c1">rem # Setting PATH variable for system.</span>
</span></span><span class="line"><span class="cl"><span class="c1">rem #</span>
</span></span><span class="line"><span class="cl"><span class="c1">rem # @package   CMD</span>
</span></span><span class="line"><span class="cl"><span class="c1">rem # @author    Kai Kimera &lt;mail@kai.kim&gt;</span>
</span></span><span class="line"><span class="cl"><span class="c1">rem # @copyright 2023 Library Online</span>
</span></span><span class="line"><span class="cl"><span class="c1">rem # @license   MIT</span>
</span></span><span class="line"><span class="cl"><span class="c1">rem # @version   0.1.0</span>
</span></span><span class="line"><span class="cl"><span class="c1">rem # @link      https://lib.onl/ru/2023/10/1f062637-3227-56d7-93e3-126d1c80f5a8/</span>
</span></span><span class="line"><span class="cl"><span class="c1">rem # ---------------------------------------------------------------------------------------------------------------- #</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="p">@</span><span class="k">echo</span> off
</span></span><span class="line"><span class="cl"><span class="k">setLocal</span> EnableDelayedExpansion
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">rem Custom PATH.</span>
</span></span><span class="line"><span class="cl"><span class="k">set</span> <span class="s2">&#34;pathArray=C:\Apps\App_01 C:\Apps\App_02 C:\Apps\App_03&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">rem Building a system PATH variable.</span>
</span></span><span class="line"><span class="cl"><span class="k">for</span> <span class="se">%%</span>p <span class="k">in</span> <span class="p">(</span> <span class="nv">%pathArray%</span> <span class="p">)</span> <span class="k">do</span> <span class="p">(</span> <span class="k">set</span> <span class="s2">&#34;pathCustom=</span><span class="se">%%</span><span class="s2">p;!pathCustom!&#34;</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">rem Setting a new PATH variable.</span>
</span></span><span class="line"><span class="cl">setx /m Path <span class="s2">&#34;</span><span class="nv">%Path%!pathCustom!</span><span class="s2">&#34;</span></span></span></code></pre></td></tr></table>
</div>
</div>
                </div>
              </div>
            </div>
        
    
<p>В переменной <code>pathArray</code> указывается массив из путей, которые необходимо добавить в <code>Path</code> на системном уровне.</p>
<h4 id="пользовательский-уровень">
  <a class="link-body-emphasis" href="#%d0%bf%d0%be%d0%bb%d1%8c%d0%b7%d0%be%d0%b2%d0%b0%d1%82%d0%b5%d0%bb%d1%8c%d1%81%d0%ba%d0%b8%d0%b9-%d1%83%d1%80%d0%be%d0%b2%d0%b5%d0%bd%d1%8c">Пользовательский уровень</a>
</h4><p>Добавить свои значения в переменную <code>Path</code> на пользовательском уровне:</p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-1
shortcode-codeblock-bat">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-199e6d66e7b241e172e0677dd51c05ce" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bat" data-lang="bat"><span class="line"><span class="cl">setx Path <span class="s2">&#34;</span><span class="nv">%Path%</span><span class="s2">C:\Apps\App_01;C:\Apps\App_02&#34;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-199e6d66e7b241e172e0677dd51c05ce"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<p>Но есть одна особенность: так как переменная <code>Path</code> объединяет значения системного и пользовательского уровней, то при такой команде, утилита <code>setx</code> пропишет в <code>Path</code> пользовательского уровня все значения из системного. Таким образом, получится дублирование содержимого <code>Path</code> системного уровня в пользовательском. Это не критично, но можно сделать более элегантно&hellip;</p>
<p>Для того, чтобы обойти вышеуказанную особенность, необходимо написать скрипт, который будет при вызове переменной <code>Path</code> вырезать из неё значения системного уровня. Собственно, скрипт я написал.</p>

    

    
        
            
            <div class="shortcode shortcode-file mb-3">
              <div class="card overflow-hidden" data-bs-theme="dark">
                <div class="card-header">
                  <div class="d-flex align-items-center">
                    <div class="flex-shrink-0">
                      <i class="far fa-file-code fa-fw"></i>
                    </div>
                    <div class="flex-grow-1 mx-2 text-truncate">
                      <code>cmd.set.env.path.user.bat</code>
                    </div>
                    <div class="flex-shrink-0">
                      <ul class="list-inline mb-0">
                        <li class="list-inline-item" title='Копировать'>
                          <a class="text-body" href="#"
                             data-fn="clipboard" data-clipboard-target="#cp-449c9a4932bfa48a49f6884fca98a60d"
                             role="button" aria-label='Копировать'>
                            <i class="fas fa-copy fa-fw"></i>
                          </a>
                        </li>
                        <li class="list-inline-item" title='Скачать'>
                          <a class="text-body" href="/ru/2023/10/1f062637-3227-56d7-93e3-126d1c80f5a8/cmd.set.env.path.user.bat" download
                             role="button" aria-label='Скачать'>
                            <i class="fas fa-download fa-fw"></i>
                          </a>
                        </li>
                        <li class="list-inline-item" title='Открыть'>
                          <a class="text-body" href="/ru/2023/10/1f062637-3227-56d7-93e3-126d1c80f5a8/cmd.set.env.path.user.bat" target="_blank"
                             role="button" aria-label='Открыть'>
                            <i class="fas fa-arrow-up-right-from-square fa-fw"></i>
                          </a>
                        </li>
                      </ul>
                    </div>
                  </div>
                </div>
                <div class="card-body p-0 overflow-auto" id="cp-449c9a4932bfa48a49f6884fca98a60d">
                    
                        
                    
                    <div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bat" data-lang="bat"><span class="line"><span class="cl"><span class="c1">rem # Setting PATH variable for user.</span>
</span></span><span class="line"><span class="cl"><span class="c1">rem #</span>
</span></span><span class="line"><span class="cl"><span class="c1">rem # @package   CMD</span>
</span></span><span class="line"><span class="cl"><span class="c1">rem # @author    Kai Kimera &lt;mail@kai.kim&gt;</span>
</span></span><span class="line"><span class="cl"><span class="c1">rem # @copyright 2023 Library Online</span>
</span></span><span class="line"><span class="cl"><span class="c1">rem # @license   MIT</span>
</span></span><span class="line"><span class="cl"><span class="c1">rem # @version   0.1.0</span>
</span></span><span class="line"><span class="cl"><span class="c1">rem # @link      https://lib.onl/ru/2023/10/1f062637-3227-56d7-93e3-126d1c80f5a8/</span>
</span></span><span class="line"><span class="cl"><span class="c1">rem # ---------------------------------------------------------------------------------------------------------------- #</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="p">@</span><span class="k">echo</span> off
</span></span><span class="line"><span class="cl"><span class="k">setLocal</span> EnableDelayedExpansion
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">rem Custom PATH.</span>
</span></span><span class="line"><span class="cl"><span class="k">set</span> <span class="s2">&#34;pathArray=C:\Apps\App_01 C:\Apps\App_02 C:\Apps\App_03&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">rem Getting the current PATH variable.</span>
</span></span><span class="line"><span class="cl"><span class="k">for</span> <span class="k">/f</span> <span class="s2">&#34;tokens=2,*&#34;</span> <span class="se">%%</span>a <span class="k">in</span> <span class="p">(</span> <span class="s1">&#39;reg query HKCU\Environment /v Path&#39;</span> <span class="p">)</span> <span class="k">do</span> <span class="p">(</span> <span class="k">set</span> <span class="s2">&#34;pathUser=</span><span class="se">%%</span><span class="s2">b&#34;</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">rem Building a user PATH variable.</span>
</span></span><span class="line"><span class="cl"><span class="k">for</span> <span class="se">%%</span>p <span class="k">in</span> <span class="p">(</span> <span class="nv">%pathArray%</span> <span class="p">)</span> <span class="k">do</span> <span class="p">(</span> <span class="k">set</span> <span class="s2">&#34;pathCustom=</span><span class="se">%%</span><span class="s2">p;!pathCustom!&#34;</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">rem Setting a new PATH variable.</span>
</span></span><span class="line"><span class="cl">setx Path <span class="s2">&#34;</span><span class="nv">!pathUser!!pathCustom!</span><span class="s2">&#34;</span></span></span></code></pre></td></tr></table>
</div>
</div>
                </div>
              </div>
            </div>
        
    
<p>В переменной <code>pathArray</code> указывается массив из путей, которые необходимо добавить в <code>Path</code> на пользовательском уровне. При этом, добавление значений из системного уровня не произойдёт. Наша переменная <code>Path</code> пользовательского уровня останется чистенькой и красивой.</p>
<h3 id="терминал-powershell">
  <a class="link-body-emphasis" href="#%d1%82%d0%b5%d1%80%d0%bc%d0%b8%d0%bd%d0%b0%d0%bb-powershell">Терминал PowerShell</a>
</h3><p>В <span class="shortcode shortcode-tag"><a href="/ru/tags/powershell/" target="_blank">#PowerShell</a></span> для управления переменными окружения существуют методы:</p>
<ul>
<li><code>[Environment]::GetEnvironmentVariables()</code> - получение значения переменной среды окружения.</li>
<li><code>[Environment]::SetEnvironmentVariable()</code> - установка значения переменной среды окружения.</li>
</ul>
<h4 id="системный-уровень-1">
  <a class="link-body-emphasis" href="#%d1%81%d0%b8%d1%81%d1%82%d0%b5%d0%bc%d0%bd%d1%8b%d0%b9-%d1%83%d1%80%d0%be%d0%b2%d0%b5%d0%bd%d1%8c-1">Системный уровень</a>
</h4><p>Для добавления значений в переменную <code>Path</code> на системном уровне, я написал небольшой скрипт.</p>

    

    
        
            
            <div class="shortcode shortcode-file mb-3">
              <div class="card overflow-hidden" data-bs-theme="dark">
                <div class="card-header">
                  <div class="d-flex align-items-center">
                    <div class="flex-shrink-0">
                      <i class="far fa-file-code fa-fw"></i>
                    </div>
                    <div class="flex-grow-1 mx-2 text-truncate">
                      <code>pwsh.set.env.path.system.ps1</code>
                    </div>
                    <div class="flex-shrink-0">
                      <ul class="list-inline mb-0">
                        <li class="list-inline-item" title='Копировать'>
                          <a class="text-body" href="#"
                             data-fn="clipboard" data-clipboard-target="#cp-3e5aa4623d9f0df1842526bc005f0630"
                             role="button" aria-label='Копировать'>
                            <i class="fas fa-copy fa-fw"></i>
                          </a>
                        </li>
                        <li class="list-inline-item" title='Скачать'>
                          <a class="text-body" href="/ru/2023/10/1f062637-3227-56d7-93e3-126d1c80f5a8/pwsh.set.env.path.system.ps1" download
                             role="button" aria-label='Скачать'>
                            <i class="fas fa-download fa-fw"></i>
                          </a>
                        </li>
                        <li class="list-inline-item" title='Открыть'>
                          <a class="text-body" href="/ru/2023/10/1f062637-3227-56d7-93e3-126d1c80f5a8/pwsh.set.env.path.system.ps1" target="_blank"
                             role="button" aria-label='Открыть'>
                            <i class="fas fa-arrow-up-right-from-square fa-fw"></i>
                          </a>
                        </li>
                      </ul>
                    </div>
                  </div>
                </div>
                <div class="card-body p-0 overflow-auto" id="cp-3e5aa4623d9f0df1842526bc005f0630">
                    
                        
                    
                    <div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-ps1" data-lang="ps1"><span class="line"><span class="cl"><span class="cm">&lt;#PSScriptInfo
</span></span></span><span class="line"><span class="cl"><span class="cm">.VERSION      0.1.0
</span></span></span><span class="line"><span class="cl"><span class="cm">.GUID         41643d28-3808-4a6f-a322-d87ed4384d5f
</span></span></span><span class="line"><span class="cl"><span class="cm">.AUTHOR       Kai Kimera
</span></span></span><span class="line"><span class="cl"><span class="cm">.AUTHOREMAIL  mail@kai.kim
</span></span></span><span class="line"><span class="cl"><span class="cm">.COMPANYNAME  Library Online
</span></span></span><span class="line"><span class="cl"><span class="cm">.COPYRIGHT    2023 Library Online. All rights reserved.
</span></span></span><span class="line"><span class="cl"><span class="cm">.LICENSEURI   https://choosealicense.com/licenses/mit/
</span></span></span><span class="line"><span class="cl"><span class="cm">.PROJECTURI   https://lib.onl/ru/2023/10/1f062637-3227-56d7-93e3-126d1c80f5a8/
</span></span></span><span class="line"><span class="cl"><span class="cm">#&gt;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c">#</span><span class="k">Requires</span><span class="w"> </span><span class="kd">-Version</span><span class="na"> 7.2</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c">#</span><span class="k">Requires</span><span class="w"> </span><span class="kd">-RunAsAdministrator</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="cm">&lt;#
</span></span></span><span class="line"><span class="cl"><span class="cm">.</span><span class="sd">SYNOPSIS</span><span class="cm">
</span></span></span><span class="line"><span class="cl"><span class="cm">Setting PATH variable for system.
</span></span></span><span class="line"><span class="cl"><span class="cm">
</span></span></span><span class="line"><span class="cl"><span class="cm">.</span><span class="sd">DESCRIPTION</span><span class="cm">
</span></span></span><span class="line"><span class="cl"><span class="cm">The script configures the PATH variable values for the system.
</span></span></span><span class="line"><span class="cl"><span class="cm">
</span></span></span><span class="line"><span class="cl"><span class="cm">.</span><span class="sd">EXAMPLE</span><span class="cm">
</span></span></span><span class="line"><span class="cl"><span class="cm">.\pwsh.set.env.path.system.ps1 -P &#39;C:\Apps\App_01&#39;, &#39;C:\Apps\App_02&#39;, &#39;C:\Apps\App_03&#39;
</span></span></span><span class="line"><span class="cl"><span class="cm">
</span></span></span><span class="line"><span class="cl"><span class="cm">.</span><span class="sd">LINK</span><span class="cm">
</span></span></span><span class="line"><span class="cl"><span class="cm">https://lib.onl/ru/2023/10/1f062637-3227-56d7-93e3-126d1c80f5a8/
</span></span></span><span class="line"><span class="cl"><span class="cm">#&gt;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">param</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">  <span class="p">[</span><span class="nb">Alias</span><span class="p">(</span><span class="s1">&#39;P&#39;</span><span class="p">)][</span><span class="no">string[]</span><span class="p">]</span><span class="nv">$Path</span>
</span></span><span class="line"><span class="cl"><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kd">function</span><span class="w"> </span><span class="nb">Set-EnvPathSystem</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="nv">$Path</span> <span class="p">|</span> <span class="nb">ForEach-Object</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="p">[</span><span class="no">Environment</span><span class="p">]::</span><span class="n">SetEnvironmentVariable</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">      <span class="s1">&#39;Path&#39;</span><span class="p">,</span> <span class="p">([</span><span class="no">Environment</span><span class="p">]::</span><span class="n">GetEnvironmentVariables</span><span class="p">(</span><span class="s1">&#39;Machine&#39;</span><span class="p">)).</span><span class="py">Path</span> <span class="p">+</span> <span class="s2">&#34;</span><span class="nv">${_}</span><span class="s2">&#34;</span> <span class="p">+</span> <span class="p">[</span><span class="no">IO.Path</span><span class="p">]::</span><span class="n">PathSeparator</span><span class="p">,</span> <span class="s1">&#39;Machine&#39;</span>
</span></span><span class="line"><span class="cl">    <span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nb">Set-EnvPathSystem</span></span></span></code></pre></td></tr></table>
</div>
</div>
                </div>
              </div>
            </div>
        
    
<p>Вызов скрипта осуществляется следующим образом:</p>











<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-2 shortcode-codeblock-terminal
shortcode-codeblock-terminal-windows
shortcode-codeblock-terminal-windows-root">
  <div class="card overflow-hidden" data-bs-theme="dark">
    <div class="card-header">
      <div class="d-flex align-items-center">
        <div class="flex-shrink-0 text-danger">
          <i class="fas fa-terminal fa-fw"></i>
        </div>
        <div class="flex-grow-1 mx-2">
          <h5 class="mb-0">Терминал</h5>
        </div>
        <div class="flex-shrink-0">
          <ul class="list-inline mb-0">
            <li class="list-inline-item" title='Копировать'>
              <a class="text-body" href="#"
                 data-fn="clipboard" data-clipboard-target="#cp-2c26340bd8565f3b40994c3344ec3589"
                 role="button" aria-label='Копировать'>
                <i class="fas fa-copy fa-fw"></i>
              </a>
            </li>
          </ul>
        </div>
      </div>
    </div>
    <div class="card-body p-0 overflow-auto" id="cp-2c26340bd8565f3b40994c3344ec3589"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-plaintext" data-lang="plaintext"><span class="line"><span class="cl">.\pwsh.set.env.path.system.ps1 -P &#39;C:\Apps\App_01&#39;, &#39;C:\Apps\App_02&#39;, &#39;C:\Apps\App_03&#39;</span></span></code></pre></td></tr></table>
</div>
</div></div>
  </div>
</div>
<p>В параметре <code>-P</code> указываются значения, которые необходимо добавить в переменную <code>Path</code> системного уровня.</p>
<h4 id="пользовательский-уровень-1">
  <a class="link-body-emphasis" href="#%d0%bf%d0%be%d0%bb%d1%8c%d0%b7%d0%be%d0%b2%d0%b0%d1%82%d0%b5%d0%bb%d1%8c%d1%81%d0%ba%d0%b8%d0%b9-%d1%83%d1%80%d0%be%d0%b2%d0%b5%d0%bd%d1%8c-1">Пользовательский уровень</a>
</h4><p>А здесь скрипт, который отвечает за добавление в переменную <code>Path</code> значений на пользовательском уровне.</p>

    

    
        
            
            <div class="shortcode shortcode-file mb-3">
              <div class="card overflow-hidden" data-bs-theme="dark">
                <div class="card-header">
                  <div class="d-flex align-items-center">
                    <div class="flex-shrink-0">
                      <i class="far fa-file-code fa-fw"></i>
                    </div>
                    <div class="flex-grow-1 mx-2 text-truncate">
                      <code>pwsh.set.env.path.user.ps1</code>
                    </div>
                    <div class="flex-shrink-0">
                      <ul class="list-inline mb-0">
                        <li class="list-inline-item" title='Копировать'>
                          <a class="text-body" href="#"
                             data-fn="clipboard" data-clipboard-target="#cp-42ae916c6c7fc4a39fcd540d810b40ed"
                             role="button" aria-label='Копировать'>
                            <i class="fas fa-copy fa-fw"></i>
                          </a>
                        </li>
                        <li class="list-inline-item" title='Скачать'>
                          <a class="text-body" href="/ru/2023/10/1f062637-3227-56d7-93e3-126d1c80f5a8/pwsh.set.env.path.user.ps1" download
                             role="button" aria-label='Скачать'>
                            <i class="fas fa-download fa-fw"></i>
                          </a>
                        </li>
                        <li class="list-inline-item" title='Открыть'>
                          <a class="text-body" href="/ru/2023/10/1f062637-3227-56d7-93e3-126d1c80f5a8/pwsh.set.env.path.user.ps1" target="_blank"
                             role="button" aria-label='Открыть'>
                            <i class="fas fa-arrow-up-right-from-square fa-fw"></i>
                          </a>
                        </li>
                      </ul>
                    </div>
                  </div>
                </div>
                <div class="card-body p-0 overflow-auto" id="cp-42ae916c6c7fc4a39fcd540d810b40ed">
                    
                        
                    
                    <div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-ps1" data-lang="ps1"><span class="line"><span class="cl"><span class="cm">&lt;#PSScriptInfo
</span></span></span><span class="line"><span class="cl"><span class="cm">.VERSION      0.1.0
</span></span></span><span class="line"><span class="cl"><span class="cm">.GUID         79f23918-308a-412c-8835-b1bb9c9193e3
</span></span></span><span class="line"><span class="cl"><span class="cm">.AUTHOR       Kai Kimera
</span></span></span><span class="line"><span class="cl"><span class="cm">.AUTHOREMAIL  mail@kai.kim
</span></span></span><span class="line"><span class="cl"><span class="cm">.COMPANYNAME  Library Online
</span></span></span><span class="line"><span class="cl"><span class="cm">.COPYRIGHT    2023 Library Online. All rights reserved.
</span></span></span><span class="line"><span class="cl"><span class="cm">.LICENSEURI   https://choosealicense.com/licenses/mit/
</span></span></span><span class="line"><span class="cl"><span class="cm">.PROJECTURI   https://lib.onl/ru/2023/10/1f062637-3227-56d7-93e3-126d1c80f5a8/
</span></span></span><span class="line"><span class="cl"><span class="cm">#&gt;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c">#</span><span class="k">Requires</span><span class="w"> </span><span class="kd">-Version</span><span class="na"> 7.2</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="cm">&lt;#
</span></span></span><span class="line"><span class="cl"><span class="cm">.</span><span class="sd">SYNOPSIS</span><span class="cm">
</span></span></span><span class="line"><span class="cl"><span class="cm">Setting PATH variable for user.
</span></span></span><span class="line"><span class="cl"><span class="cm">
</span></span></span><span class="line"><span class="cl"><span class="cm">.</span><span class="sd">DESCRIPTION</span><span class="cm">
</span></span></span><span class="line"><span class="cl"><span class="cm">The script configures the PATH variable values for the user.
</span></span></span><span class="line"><span class="cl"><span class="cm">
</span></span></span><span class="line"><span class="cl"><span class="cm">.</span><span class="sd">EXAMPLE</span><span class="cm">
</span></span></span><span class="line"><span class="cl"><span class="cm">.\pwsh.set.env.path.user.ps1 -P &#39;C:\Apps\App_01&#39;, &#39;C:\Apps\App_02&#39;, &#39;C:\Apps\App_03&#39;
</span></span></span><span class="line"><span class="cl"><span class="cm">
</span></span></span><span class="line"><span class="cl"><span class="cm">.</span><span class="sd">LINK</span><span class="cm">
</span></span></span><span class="line"><span class="cl"><span class="cm">https://lib.onl/ru/2023/10/1f062637-3227-56d7-93e3-126d1c80f5a8/
</span></span></span><span class="line"><span class="cl"><span class="cm">#&gt;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">param</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">  <span class="p">[</span><span class="nb">Alias</span><span class="p">(</span><span class="s1">&#39;P&#39;</span><span class="p">)][</span><span class="no">string[]</span><span class="p">]</span><span class="nv">$Path</span>
</span></span><span class="line"><span class="cl"><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kd">function</span><span class="w"> </span><span class="nb">Set-EnvPathUser</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="nv">$Path</span> <span class="p">|</span> <span class="nb">ForEach-Object</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="p">[</span><span class="no">Environment</span><span class="p">]::</span><span class="n">SetEnvironmentVariable</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">      <span class="s1">&#39;Path&#39;</span><span class="p">,</span> <span class="p">([</span><span class="no">Environment</span><span class="p">]::</span><span class="n">GetEnvironmentVariables</span><span class="p">(</span><span class="s1">&#39;User&#39;</span><span class="p">)).</span><span class="py">Path</span> <span class="p">+</span> <span class="s2">&#34;</span><span class="nv">${_}</span><span class="s2">&#34;</span> <span class="p">+</span> <span class="p">[</span><span class="no">IO.Path</span><span class="p">]::</span><span class="n">PathSeparator</span><span class="p">,</span> <span class="s1">&#39;User&#39;</span>
</span></span><span class="line"><span class="cl">    <span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nb">Set-EnvPathUser</span></span></span></code></pre></td></tr></table>
</div>
</div>
                </div>
              </div>
            </div>
        
    
<p>Вызов скрипта осуществляется следующим образом:</p>











<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-3 shortcode-codeblock-terminal
shortcode-codeblock-terminal-windows
shortcode-codeblock-terminal-windows-user">
  <div class="card overflow-hidden" data-bs-theme="dark">
    <div class="card-header">
      <div class="d-flex align-items-center">
        <div class="flex-shrink-0 ">
          <i class="fas fa-terminal fa-fw"></i>
        </div>
        <div class="flex-grow-1 mx-2">
          <h5 class="mb-0">Терминал</h5>
        </div>
        <div class="flex-shrink-0">
          <ul class="list-inline mb-0">
            <li class="list-inline-item" title='Копировать'>
              <a class="text-body" href="#"
                 data-fn="clipboard" data-clipboard-target="#cp-a72a6ccb4f184a184c1352d71717a881"
                 role="button" aria-label='Копировать'>
                <i class="fas fa-copy fa-fw"></i>
              </a>
            </li>
          </ul>
        </div>
      </div>
    </div>
    <div class="card-body p-0 overflow-auto" id="cp-a72a6ccb4f184a184c1352d71717a881"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-plaintext" data-lang="plaintext"><span class="line"><span class="cl">.\pwsh.set.env.path.user.ps1 -P &#39;C:\Apps\App_01&#39;, &#39;C:\Apps\App_02&#39;, &#39;C:\Apps\App_03&#39;</span></span></code></pre></td></tr></table>
</div>
</div></div>
  </div>
</div>
<p>В параметре <code>-P</code> указываются значения, которые необходимо добавить в переменную <code>Path</code> пользовательского уровня.</p>
<h4 id="общий-скрипт">
  <a class="link-body-emphasis" href="#%d0%be%d0%b1%d1%89%d0%b8%d0%b9-%d1%81%d0%ba%d1%80%d0%b8%d0%bf%d1%82">Общий скрипт</a>
</h4><p>Не знаю, почему я сразу не написал общий скрипт для всех уровней&hellip; Решил под завершение статьи реализовать подобную штуку.</p>

    

    
        
            
            <div class="shortcode shortcode-file mb-3">
              <div class="card overflow-hidden" data-bs-theme="dark">
                <div class="card-header">
                  <div class="d-flex align-items-center">
                    <div class="flex-shrink-0">
                      <i class="far fa-file-code fa-fw"></i>
                    </div>
                    <div class="flex-grow-1 mx-2 text-truncate">
                      <code>pwsh.set.env.path.ps1</code>
                    </div>
                    <div class="flex-shrink-0">
                      <ul class="list-inline mb-0">
                        <li class="list-inline-item" title='Копировать'>
                          <a class="text-body" href="#"
                             data-fn="clipboard" data-clipboard-target="#cp-ee646bf3c9aada5a50145b5e280d898c"
                             role="button" aria-label='Копировать'>
                            <i class="fas fa-copy fa-fw"></i>
                          </a>
                        </li>
                        <li class="list-inline-item" title='Скачать'>
                          <a class="text-body" href="/ru/2023/10/1f062637-3227-56d7-93e3-126d1c80f5a8/pwsh.set.env.path.ps1" download
                             role="button" aria-label='Скачать'>
                            <i class="fas fa-download fa-fw"></i>
                          </a>
                        </li>
                        <li class="list-inline-item" title='Открыть'>
                          <a class="text-body" href="/ru/2023/10/1f062637-3227-56d7-93e3-126d1c80f5a8/pwsh.set.env.path.ps1" target="_blank"
                             role="button" aria-label='Открыть'>
                            <i class="fas fa-arrow-up-right-from-square fa-fw"></i>
                          </a>
                        </li>
                      </ul>
                    </div>
                  </div>
                </div>
                <div class="card-body p-0 overflow-auto" id="cp-ee646bf3c9aada5a50145b5e280d898c">
                    
                        
                    
                    <div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-ps1" data-lang="ps1"><span class="line"><span class="cl"><span class="cm">&lt;#PSScriptInfo
</span></span></span><span class="line"><span class="cl"><span class="cm">.VERSION      0.1.0
</span></span></span><span class="line"><span class="cl"><span class="cm">.GUID         14efdc7d-1edd-4b40-b6d2-623288ce1659
</span></span></span><span class="line"><span class="cl"><span class="cm">.AUTHOR       Kai Kimera
</span></span></span><span class="line"><span class="cl"><span class="cm">.AUTHOREMAIL  mail@kai.kim
</span></span></span><span class="line"><span class="cl"><span class="cm">.COMPANYNAME  Library Online
</span></span></span><span class="line"><span class="cl"><span class="cm">.COPYRIGHT    2023 Library Online. All rights reserved.
</span></span></span><span class="line"><span class="cl"><span class="cm">.LICENSEURI   https://choosealicense.com/licenses/mit/
</span></span></span><span class="line"><span class="cl"><span class="cm">.PROJECTURI   https://lib.onl/ru/2023/10/1f062637-3227-56d7-93e3-126d1c80f5a8/
</span></span></span><span class="line"><span class="cl"><span class="cm">#&gt;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c">#</span><span class="k">Requires</span><span class="w"> </span><span class="kd">-Version</span><span class="na"> 7.2</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="cm">&lt;#
</span></span></span><span class="line"><span class="cl"><span class="cm">.</span><span class="sd">SYNOPSIS</span><span class="cm">
</span></span></span><span class="line"><span class="cl"><span class="cm">Setting the PATH variable.
</span></span></span><span class="line"><span class="cl"><span class="cm">
</span></span></span><span class="line"><span class="cl"><span class="cm">.</span><span class="sd">DESCRIPTION</span><span class="cm">
</span></span></span><span class="line"><span class="cl"><span class="cm">The script configures the PATH variable values.
</span></span></span><span class="line"><span class="cl"><span class="cm">
</span></span></span><span class="line"><span class="cl"><span class="cm">.</span><span class="sd">EXAMPLE</span><span class="cm">
</span></span></span><span class="line"><span class="cl"><span class="cm">.\pwsh.set.env.path.ps1 -P &#39;C:\Apps\App_01&#39;, &#39;C:\Apps\App_02&#39;, &#39;C:\Apps\App_03&#39; -T &#39;Machine&#39;
</span></span></span><span class="line"><span class="cl"><span class="cm">
</span></span></span><span class="line"><span class="cl"><span class="cm">.</span><span class="sd">EXAMPLE</span><span class="cm">
</span></span></span><span class="line"><span class="cl"><span class="cm">.\pwsh.set.env.path.ps1 -P &#39;C:\Apps\App_01&#39;, &#39;C:\Apps\App_02&#39;, &#39;C:\Apps\App_03&#39; -T &#39;User&#39;
</span></span></span><span class="line"><span class="cl"><span class="cm">
</span></span></span><span class="line"><span class="cl"><span class="cm">.</span><span class="sd">LINK</span><span class="cm">
</span></span></span><span class="line"><span class="cl"><span class="cm">https://lib.onl/ru/2023/10/1f062637-3227-56d7-93e3-126d1c80f5a8/
</span></span></span><span class="line"><span class="cl"><span class="cm">#&gt;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">param</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">  <span class="p">[</span><span class="nb">Alias</span><span class="p">(</span><span class="s1">&#39;P&#39;</span><span class="p">)][</span><span class="no">string[]</span><span class="p">]</span><span class="nv">$Path</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">  <span class="p">[</span><span class="nb">Parameter</span><span class="p">(</span><span class="na">Mandatory</span><span class="p">)][</span><span class="nb">ValidateSet</span><span class="p">(</span><span class="s1">&#39;Machine&#39;</span><span class="p">,</span> <span class="s1">&#39;User&#39;</span><span class="p">)][</span><span class="nb">Alias</span><span class="p">(</span><span class="s1">&#39;T&#39;</span><span class="p">)][</span><span class="no">string[]</span><span class="p">]</span><span class="nv">$Target</span>
</span></span><span class="line"><span class="cl"><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kd">function</span><span class="w"> </span><span class="nb">Set-EnvPath</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="nv">$Path</span> <span class="p">|</span> <span class="nb">ForEach-Object</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="p">[</span><span class="no">Environment</span><span class="p">]::</span><span class="n">SetEnvironmentVariable</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">      <span class="s1">&#39;Path&#39;</span><span class="p">,</span> <span class="p">([</span><span class="no">Environment</span><span class="p">]::</span><span class="n">GetEnvironmentVariables</span><span class="p">(</span><span class="s2">&#34;</span><span class="nv">${Target}</span><span class="s2">&#34;</span><span class="p">)).</span><span class="py">Path</span> <span class="p">+</span> <span class="s2">&#34;</span><span class="nv">${_}</span><span class="s2">&#34;</span> <span class="p">+</span> <span class="p">[</span><span class="no">IO.Path</span><span class="p">]::</span><span class="n">PathSeparator</span><span class="p">,</span> <span class="s2">&#34;</span><span class="nv">${Target}</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nb">Set-EnvPath</span></span></span></code></pre></td></tr></table>
</div>
</div>
                </div>
              </div>
            </div>
        
    
<p>Вызывается скрипт обычным способом:</p>











<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-4 shortcode-codeblock-terminal
shortcode-codeblock-terminal-windows
shortcode-codeblock-terminal-windows-user">
  <div class="card overflow-hidden" data-bs-theme="dark">
    <div class="card-header">
      <div class="d-flex align-items-center">
        <div class="flex-shrink-0 ">
          <i class="fas fa-terminal fa-fw"></i>
        </div>
        <div class="flex-grow-1 mx-2">
          <h5 class="mb-0">Терминал</h5>
        </div>
        <div class="flex-shrink-0">
          <ul class="list-inline mb-0">
            <li class="list-inline-item" title='Копировать'>
              <a class="text-body" href="#"
                 data-fn="clipboard" data-clipboard-target="#cp-e82c07c4eb38d1cfaff975c0cc943a09"
                 role="button" aria-label='Копировать'>
                <i class="fas fa-copy fa-fw"></i>
              </a>
            </li>
          </ul>
        </div>
      </div>
    </div>
    <div class="card-body p-0 overflow-auto" id="cp-e82c07c4eb38d1cfaff975c0cc943a09"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-plaintext" data-lang="plaintext"><span class="line"><span class="cl">.\pwsh.set.env.path.ps1 -P &#39;C:\Apps\App_01&#39;, &#39;C:\Apps\App_02&#39;, &#39;C:\Apps\App_03&#39; -T &#39;User&#39;</span></span></code></pre></td></tr></table>
</div>
</div></div>
  </div>
</div>
<p>Но отличается от выше приведённых скриптов дополнительным параметром <code>-T</code>, который указывает уровень переменной <code>Path</code> и может принимать следующие значения:</p>
<ul>
<li><code>Machine</code> - для системного уровня.</li>
<li><code>User</code> - для пользовательского уровня.</li>
</ul>]]></turbo:content></item><item turbo="true"><title>Автоматическая настройка Windows Server 2022 под рабочую станцию</title><link>https://lib.onl/ru/2023/10/fb64d665-3e56-5fa5-a9eb-2e2e251949d8/</link><pubDate>Fri, 27 Oct 2023 19:46:08 +0000</pubDate><dc:creator>Kai Kimera</dc:creator><category>MS Windows</category><category>Терминал</category><category>Скрипты</category><yandex:related><link url="https://lib.onl/ru/2022/05/36058650-3f35-5ed5-9565-0aa7d8800c28/">Windows Server 2022 для рабочей станции</link><link url="https://lib.onl/ru/2023/10/38fc94dd-8d37-5f9e-b556-676304976a9f/">Восстановление доверительных отношений между PC и Active Directory</link><link url="https://lib.onl/ru/2023/10/616da78a-eb16-575a-9119-65f0c0c7baee/">Изменение порта RDP</link><link url="https://lib.onl/ru/2023/10/c6e32349-8fc2-53f9-9a42-790878a64076/">PowerShell: Полезные функции</link><link url="https://lib.onl/ru/2023/10/52d75b90-0637-5ba6-91d6-b1bff40e1d67/">PowerShell: Стирание диска</link><link url="https://lib.onl/ru/2023/10/2a73410a-6611-570c-9ab4-dc8cc8998146/">PowerShell: Сжатие видео при помощи FFmpeg</link><link url="https://lib.onl/ru/2023/10/0028821e-c96c-5014-a1dd-8963c161b170/">PowerShell: Определение разрядности ОС Windows</link><link url="https://lib.onl/ru/2023/10/4c7aba7c-f5a6-589a-9975-fdb16f2e2862/">PowerShell Vault</link><link url="https://lib.onl/ru/2023/10/eb39e3f7-b194-53d4-8bad-01edf9fdac47/">Дефрагментация в ОС Windows</link><link url="https://lib.onl/ru/2023/10/75075788-9308-56b7-b531-2008cb35f7d0/">Установка сертификата НУЦ Минцифры</link></yandex:related><turbo:extendedHtml>true</turbo:extendedHtml><turbo:source>https://lib.onl/ru/2023/10/fb64d665-3e56-5fa5-a9eb-2e2e251949d8/</turbo:source><turbo:topic>Автоматическая настройка Windows Server 2022 под рабочую станцию</turbo:topic><turbo:content><![CDATA[<p>Ранее я уже публиковал инструкцию по превращению серверной ОС в ОС для рабочей станции. Но этот процесс можно автоматизировать при помощи <span class="shortcode shortcode-tag"><a href="/ru/tags/powershell/" target="_blank">#PowerShell</a></span>.</p>
<p>В статье <span class="shortcode shortcode-uuid"><a href="/ru/2022/05/36058650-3f35-5ed5-9565-0aa7d8800c28/">Windows Server 2022 для рабочей станции</a></span> рассматривалось ручная адаптация Windows Server 2022 под рабочую станцию. Я решил написать специальный скрипт, который берёт на себя часть действий. Но окончательная настройка, например, такая как редактирование <span class="shortcode shortcode-tag"><a href="/ru/tags/gpo/" target="_blank">#GPO</a></span> остаётся за пользователем.</p>
<h2 id="автоматизация">
  <a class="link-body-emphasis" href="#%d0%b0%d0%b2%d1%82%d0%be%d0%bc%d0%b0%d1%82%d0%b8%d0%b7%d0%b0%d1%86%d0%b8%d1%8f">Автоматизация</a>
</h2><p>Рассмотрим скрипт по адаптации серверной ОС под рабочую станцию.</p>
<h3 id="примеры">
  <a class="link-body-emphasis" href="#%d0%bf%d1%80%d0%b8%d0%bc%d0%b5%d1%80%d1%8b">Примеры</a>
</h3><p>Скрипт требует административных прав доступа, поэтому его необходимо запускать под аккаунтом администратора.</p>











<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-0 shortcode-codeblock-terminal
shortcode-codeblock-terminal-windows
shortcode-codeblock-terminal-windows-root">
  <div class="card overflow-hidden" data-bs-theme="dark">
    <div class="card-header">
      <div class="d-flex align-items-center">
        <div class="flex-shrink-0 text-danger">
          <i class="fas fa-terminal fa-fw"></i>
        </div>
        <div class="flex-grow-1 mx-2">
          <h5 class="mb-0">Терминал</h5>
        </div>
        <div class="flex-shrink-0">
          <ul class="list-inline mb-0">
            <li class="list-inline-item" title='Копировать'>
              <a class="text-body" href="#"
                 data-fn="clipboard" data-clipboard-target="#cp-c7cacad430022fb865ba42c318337cd3"
                 role="button" aria-label='Копировать'>
                <i class="fas fa-copy fa-fw"></i>
              </a>
            </li>
          </ul>
        </div>
      </div>
    </div>
    <div class="card-body p-0 overflow-auto" id="cp-c7cacad430022fb865ba42c318337cd3"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-plaintext" data-lang="plaintext"><span class="line"><span class="cl">.\pwsh.win.srv.ws.ps1</span></span></code></pre></td></tr></table>
</div>
</div></div>
  </div>
</div>
<h3 id="алгоритм-работы">
  <a class="link-body-emphasis" href="#%d0%b0%d0%bb%d0%b3%d0%be%d1%80%d0%b8%d1%82%d0%bc-%d1%80%d0%b0%d0%b1%d0%be%d1%82%d1%8b">Алгоритм работы</a>
</h3><ul>
<li>Включение дополнительных компонентов <span class="shortcode shortcode-tag"><a href="/ru/tags/windows/" target="_blank">#Windows</a></span>.</li>
<li>Настройка необходимых для рабочей станции служб.</li>
<li>Отключение <strong>IE Enhanced Security Configuration</strong> для аккаунтов администраторов и пользователей.</li>
<li>Переключение приоритета процессора в сторону приложений.</li>
<li>Настройка <strong>MMAgent</strong>.</li>
<li>Переключение <strong>DEP</strong> только на программы <span class="shortcode shortcode-tag"><a href="/ru/tags/windows/" target="_blank">#Windows</a></span> и службы.</li>
</ul>
<h3 id="скрипт">
  <a class="link-body-emphasis" href="#%d1%81%d0%ba%d1%80%d0%b8%d0%bf%d1%82">Скрипт</a>
</h3>
    

    
        
            
            <div class="shortcode shortcode-file mb-3">
              <div class="card overflow-hidden" data-bs-theme="dark">
                <div class="card-header">
                  <div class="d-flex align-items-center">
                    <div class="flex-shrink-0">
                      <i class="far fa-file-code fa-fw"></i>
                    </div>
                    <div class="flex-grow-1 mx-2 text-truncate">
                      <code>pwsh.win.srv.ws.ps1</code>
                    </div>
                    <div class="flex-shrink-0">
                      <ul class="list-inline mb-0">
                        <li class="list-inline-item" title='Копировать'>
                          <a class="text-body" href="#"
                             data-fn="clipboard" data-clipboard-target="#cp-ad17ee0247a5de73e86c8b6135cd471e"
                             role="button" aria-label='Копировать'>
                            <i class="fas fa-copy fa-fw"></i>
                          </a>
                        </li>
                        <li class="list-inline-item" title='Скачать'>
                          <a class="text-body" href="/ru/2023/10/fb64d665-3e56-5fa5-a9eb-2e2e251949d8/pwsh.win.srv.ws.ps1" download
                             role="button" aria-label='Скачать'>
                            <i class="fas fa-download fa-fw"></i>
                          </a>
                        </li>
                        <li class="list-inline-item" title='Открыть'>
                          <a class="text-body" href="/ru/2023/10/fb64d665-3e56-5fa5-a9eb-2e2e251949d8/pwsh.win.srv.ws.ps1" target="_blank"
                             role="button" aria-label='Открыть'>
                            <i class="fas fa-arrow-up-right-from-square fa-fw"></i>
                          </a>
                        </li>
                      </ul>
                    </div>
                  </div>
                </div>
                <div class="card-body p-0 overflow-auto" id="cp-ad17ee0247a5de73e86c8b6135cd471e">
                    
                        
                    
                    <div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">  1
</span><span class="lnt">  2
</span><span class="lnt">  3
</span><span class="lnt">  4
</span><span class="lnt">  5
</span><span class="lnt">  6
</span><span class="lnt">  7
</span><span class="lnt">  8
</span><span class="lnt">  9
</span><span class="lnt"> 10
</span><span class="lnt"> 11
</span><span class="lnt"> 12
</span><span class="lnt"> 13
</span><span class="lnt"> 14
</span><span class="lnt"> 15
</span><span class="lnt"> 16
</span><span class="lnt"> 17
</span><span class="lnt"> 18
</span><span class="lnt"> 19
</span><span class="lnt"> 20
</span><span class="lnt"> 21
</span><span class="lnt"> 22
</span><span class="lnt"> 23
</span><span class="lnt"> 24
</span><span class="lnt"> 25
</span><span class="lnt"> 26
</span><span class="lnt"> 27
</span><span class="lnt"> 28
</span><span class="lnt"> 29
</span><span class="lnt"> 30
</span><span class="lnt"> 31
</span><span class="lnt"> 32
</span><span class="lnt"> 33
</span><span class="lnt"> 34
</span><span class="lnt"> 35
</span><span class="lnt"> 36
</span><span class="lnt"> 37
</span><span class="lnt"> 38
</span><span class="lnt"> 39
</span><span class="lnt"> 40
</span><span class="lnt"> 41
</span><span class="lnt"> 42
</span><span class="lnt"> 43
</span><span class="lnt"> 44
</span><span class="lnt"> 45
</span><span class="lnt"> 46
</span><span class="lnt"> 47
</span><span class="lnt"> 48
</span><span class="lnt"> 49
</span><span class="lnt"> 50
</span><span class="lnt"> 51
</span><span class="lnt"> 52
</span><span class="lnt"> 53
</span><span class="lnt"> 54
</span><span class="lnt"> 55
</span><span class="lnt"> 56
</span><span class="lnt"> 57
</span><span class="lnt"> 58
</span><span class="lnt"> 59
</span><span class="lnt"> 60
</span><span class="lnt"> 61
</span><span class="lnt"> 62
</span><span class="lnt"> 63
</span><span class="lnt"> 64
</span><span class="lnt"> 65
</span><span class="lnt"> 66
</span><span class="lnt"> 67
</span><span class="lnt"> 68
</span><span class="lnt"> 69
</span><span class="lnt"> 70
</span><span class="lnt"> 71
</span><span class="lnt"> 72
</span><span class="lnt"> 73
</span><span class="lnt"> 74
</span><span class="lnt"> 75
</span><span class="lnt"> 76
</span><span class="lnt"> 77
</span><span class="lnt"> 78
</span><span class="lnt"> 79
</span><span class="lnt"> 80
</span><span class="lnt"> 81
</span><span class="lnt"> 82
</span><span class="lnt"> 83
</span><span class="lnt"> 84
</span><span class="lnt"> 85
</span><span class="lnt"> 86
</span><span class="lnt"> 87
</span><span class="lnt"> 88
</span><span class="lnt"> 89
</span><span class="lnt"> 90
</span><span class="lnt"> 91
</span><span class="lnt"> 92
</span><span class="lnt"> 93
</span><span class="lnt"> 94
</span><span class="lnt"> 95
</span><span class="lnt"> 96
</span><span class="lnt"> 97
</span><span class="lnt"> 98
</span><span class="lnt"> 99
</span><span class="lnt">100
</span><span class="lnt">101
</span><span class="lnt">102
</span><span class="lnt">103
</span><span class="lnt">104
</span><span class="lnt">105
</span><span class="lnt">106
</span><span class="lnt">107
</span><span class="lnt">108
</span><span class="lnt">109
</span><span class="lnt">110
</span><span class="lnt">111
</span><span class="lnt">112
</span><span class="lnt">113
</span><span class="lnt">114
</span><span class="lnt">115
</span><span class="lnt">116
</span><span class="lnt">117
</span><span class="lnt">118
</span><span class="lnt">119
</span><span class="lnt">120
</span><span class="lnt">121
</span><span class="lnt">122
</span><span class="lnt">123
</span><span class="lnt">124
</span><span class="lnt">125
</span><span class="lnt">126
</span><span class="lnt">127
</span><span class="lnt">128
</span><span class="lnt">129
</span><span class="lnt">130
</span><span class="lnt">131
</span><span class="lnt">132
</span><span class="lnt">133
</span><span class="lnt">134
</span><span class="lnt">135
</span><span class="lnt">136
</span><span class="lnt">137
</span><span class="lnt">138
</span><span class="lnt">139
</span><span class="lnt">140
</span><span class="lnt">141
</span><span class="lnt">142
</span><span class="lnt">143
</span><span class="lnt">144
</span><span class="lnt">145
</span><span class="lnt">146
</span><span class="lnt">147
</span><span class="lnt">148
</span><span class="lnt">149
</span><span class="lnt">150
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-ps1" data-lang="ps1"><span class="line"><span class="cl"><span class="cm">&lt;#PSScriptInfo
</span></span></span><span class="line"><span class="cl"><span class="cm">.VERSION      0.1.0
</span></span></span><span class="line"><span class="cl"><span class="cm">.GUID         c050355b-ecbd-4b13-b805-3a422dc0c995
</span></span></span><span class="line"><span class="cl"><span class="cm">.AUTHOR       Kai Kimera
</span></span></span><span class="line"><span class="cl"><span class="cm">.AUTHOREMAIL  mail@kai.kim
</span></span></span><span class="line"><span class="cl"><span class="cm">.COMPANYNAME  Library Online
</span></span></span><span class="line"><span class="cl"><span class="cm">.COPYRIGHT    2023 Library Online. All rights reserved.
</span></span></span><span class="line"><span class="cl"><span class="cm">.LICENSEURI   https://choosealicense.com/licenses/mit/
</span></span></span><span class="line"><span class="cl"><span class="cm">.PROJECTURI   https://lib.onl/ru/2023/10/fb64d665-3e56-5fa5-a9eb-2e2e251949d8/
</span></span></span><span class="line"><span class="cl"><span class="cm">#&gt;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c">#</span><span class="k">Requires</span><span class="w"> </span><span class="kd">-Version</span><span class="na"> 7.2</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c">#</span><span class="k">Requires</span><span class="w"> </span><span class="kd">-RunAsAdministrator</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="cm">&lt;#
</span></span></span><span class="line"><span class="cl"><span class="cm">.</span><span class="sd">SYNOPSIS</span><span class="cm">
</span></span></span><span class="line"><span class="cl"><span class="cm">Windows Server configuration script.
</span></span></span><span class="line"><span class="cl"><span class="cm">
</span></span></span><span class="line"><span class="cl"><span class="cm">.</span><span class="sd">DESCRIPTION</span><span class="cm">
</span></span></span><span class="line"><span class="cl"><span class="cm">The script allows you to set up Windows Server as a workstation.
</span></span></span><span class="line"><span class="cl"><span class="cm">
</span></span></span><span class="line"><span class="cl"><span class="cm">.</span><span class="sd">EXAMPLE</span><span class="cm">
</span></span></span><span class="line"><span class="cl"><span class="cm">.\pwsh.win.srv.ws.ps1
</span></span></span><span class="line"><span class="cl"><span class="cm">
</span></span></span><span class="line"><span class="cl"><span class="cm">.</span><span class="sd">LINK</span><span class="cm">
</span></span></span><span class="line"><span class="cl"><span class="cm">https://lib.onl/ru/2023/10/fb64d665-3e56-5fa5-a9eb-2e2e251949d8/
</span></span></span><span class="line"><span class="cl"><span class="cm">#&gt;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c"># -------------------------------------------------------------------------------------------------------------------- #</span>
</span></span><span class="line"><span class="cl"><span class="c"># INITIALIZATION</span>
</span></span><span class="line"><span class="cl"><span class="c"># -------------------------------------------------------------------------------------------------------------------- #</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kd">function</span><span class="w"> </span><span class="nb">Start-Script</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="nb">Start-FeatureConfig</span>
</span></span><span class="line"><span class="cl">  <span class="nb">Start-ServiceConfig</span>
</span></span><span class="line"><span class="cl">  <span class="nb">Start-IEConfig</span>
</span></span><span class="line"><span class="cl">  <span class="nb">Start-PriorityControlConfig</span>
</span></span><span class="line"><span class="cl">  <span class="nb">Start-MMAgentConfig</span>
</span></span><span class="line"><span class="cl">  <span class="nb">Start-DEPConfig</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c"># -------------------------------------------------------------------------------------------------------------------- #</span>
</span></span><span class="line"><span class="cl"><span class="c"># CONFIGURING FEATURES</span>
</span></span><span class="line"><span class="cl"><span class="c"># -------------------------------------------------------------------------------------------------------------------- #</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kd">function</span><span class="w"> </span><span class="nb">Start-FeatureConfig</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="nv">$Param</span> <span class="p">=</span> <span class="vm">@</span><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">Name</span> <span class="p">=</span> <span class="s1">&#39;Wireless-Networking&#39;</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="nb">Install-WindowsFeature</span> <span class="nv">@Param</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c"># -------------------------------------------------------------------------------------------------------------------- #</span>
</span></span><span class="line"><span class="cl"><span class="c"># CONFIGURING SERVICES</span>
</span></span><span class="line"><span class="cl"><span class="c"># -------------------------------------------------------------------------------------------------------------------- #</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kd">function</span><span class="w"> </span><span class="nb">Start-ServiceConfig</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="nv">$Name</span> <span class="p">=</span> <span class="vm">@</span><span class="p">(</span><span class="s1">&#39;Audiosrv&#39;</span><span class="p">,</span> <span class="s1">&#39;AudioEndpointBuilder&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="nv">$Name</span> <span class="p">|</span> <span class="nb">ForEach-Object</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nv">$Param</span> <span class="p">=</span> <span class="vm">@</span><span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="n">Name</span> <span class="p">=</span> <span class="s2">&#34;</span><span class="nv">${_}</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl">      <span class="n">StartupType</span> <span class="p">=</span> <span class="s1">&#39;Automatic&#39;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="nb">Set-Service</span> <span class="nv">@Param</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="nv">$WSearch</span> <span class="p">=</span> <span class="vm">@</span><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">Name</span> <span class="p">=</span> <span class="s1">&#39;WSearch&#39;</span>
</span></span><span class="line"><span class="cl">    <span class="n">StartupType</span> <span class="p">=</span> <span class="s1">&#39;AutomaticDelayedStart&#39;</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="nb">Set-Service</span> <span class="nv">@WSearch</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c"># -------------------------------------------------------------------------------------------------------------------- #</span>
</span></span><span class="line"><span class="cl"><span class="c"># DISABLE IE ENHANCED SECURITY CONFIGURATION (ESC)</span>
</span></span><span class="line"><span class="cl"><span class="c"># -------------------------------------------------------------------------------------------------------------------- #</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kd">function</span><span class="w"> </span><span class="nb">Start-IEConfig</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="nv">$Path</span> <span class="p">=</span> <span class="vm">@</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">    <span class="s1">&#39;HKLM:\SOFTWARE\Microsoft\Active Setup\Installed Components\{A509B1A7-37EF-4b3f-8CFC-4F3A74704073}&#39;</span>
</span></span><span class="line"><span class="cl">    <span class="s1">&#39;HKLM:\SOFTWARE\Microsoft\Active Setup\Installed Components\{A509B1A8-37EF-4b3f-8CFC-4F3A74704073}&#39;</span>
</span></span><span class="line"><span class="cl">  <span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="nv">$Path</span> <span class="p">|</span> <span class="nb">ForEach-Object</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nv">$Param</span> <span class="p">=</span> <span class="vm">@</span><span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="n">LiteralPath</span> <span class="p">=</span> <span class="s2">&#34;</span><span class="nv">${_}</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl">      <span class="n">Name</span> <span class="p">=</span> <span class="s1">&#39;IsInstalled&#39;</span>
</span></span><span class="line"><span class="cl">      <span class="n">Value</span> <span class="p">=</span> <span class="mf">0</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="p">(</span><span class="nb">Test-Path</span> <span class="n">-LiteralPath</span> <span class="s2">&#34;</span><span class="nv">${_}</span><span class="s2">&#34;</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="nb">Set-ItemProperty</span> <span class="nv">@Param</span>
</span></span><span class="line"><span class="cl">      <span class="nb">Write-Host</span> <span class="s1">&#39;IE Enhanced Security Configuration (ESC) has been disabled.&#39;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="nb">Write-Error</span> <span class="n">-Message</span> <span class="s2">&#34;&#39;</span><span class="nv">${_}</span><span class="s2">&#39; not found!&#34;</span> <span class="n">-ErrorAction</span> <span class="s1">&#39;Stop&#39;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c"># -------------------------------------------------------------------------------------------------------------------- #</span>
</span></span><span class="line"><span class="cl"><span class="c"># ADJUST PROCESSOR RESOURCES FOR BEST PERFORMANCE OF PROGRAMS</span>
</span></span><span class="line"><span class="cl"><span class="c"># -------------------------------------------------------------------------------------------------------------------- #</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kd">function</span><span class="w"> </span><span class="nb">Start-PriorityControlConfig</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="nv">$Path</span> <span class="p">=</span> <span class="s1">&#39;HKLM:\SYSTEM\CurrentControlSet\Control\PriorityControl&#39;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="nv">$Param</span> <span class="p">=</span> <span class="vm">@</span><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">LiteralPath</span> <span class="p">=</span> <span class="s2">&#34;</span><span class="nv">${Path}</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="n">Name</span> <span class="p">=</span> <span class="s1">&#39;Win32PrioritySeparation&#39;</span>
</span></span><span class="line"><span class="cl">    <span class="n">Value</span> <span class="p">=</span> <span class="mf">38</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="k">if</span> <span class="p">(</span><span class="nb">Test-Path</span> <span class="n">-LiteralPath</span> <span class="s2">&#34;</span><span class="nv">${Path}</span><span class="s2">&#34;</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nb">Set-ItemProperty</span> <span class="nv">@Param</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nb">Write-Error</span> <span class="n">-Message</span> <span class="s2">&#34;&#39;</span><span class="nv">${Path}</span><span class="s2">&#39; not found!&#34;</span> <span class="n">-ErrorAction</span> <span class="s1">&#39;Stop&#39;</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c"># -------------------------------------------------------------------------------------------------------------------- #</span>
</span></span><span class="line"><span class="cl"><span class="c"># CONFIGURING MMAGENT</span>
</span></span><span class="line"><span class="cl"><span class="c"># -------------------------------------------------------------------------------------------------------------------- #</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kd">function</span><span class="w"> </span><span class="nb">Start-MMAgentConfig</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="nv">$Param</span> <span class="p">=</span> <span class="vm">@</span><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">MemoryCompression</span> <span class="p">=</span> <span class="vm">$true</span>
</span></span><span class="line"><span class="cl">    <span class="n">OperationAPI</span> <span class="p">=</span> <span class="vm">$true</span>
</span></span><span class="line"><span class="cl">    <span class="n">PageCombining</span> <span class="p">=</span> <span class="vm">$true</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="nb">Enable-MMAgent</span> <span class="nv">@Param</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c"># -------------------------------------------------------------------------------------------------------------------- #</span>
</span></span><span class="line"><span class="cl"><span class="c"># CONFIGURING DEP</span>
</span></span><span class="line"><span class="cl"><span class="c"># -------------------------------------------------------------------------------------------------------------------- #</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kd">function</span><span class="w"> </span><span class="nb">Start-DEPConfig</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="n">cmd</span><span class="p">.</span><span class="py">exe</span> <span class="p">/</span><span class="n">c</span> <span class="s1">&#39;bcdedit.exe /set {current} nx OptIn&#39;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c"># -------------------------------------------------------------------------------------------------------------------- #</span>
</span></span><span class="line"><span class="cl"><span class="c"># -------------------------------------------------&lt; RUNNING SCRIPT &gt;------------------------------------------------- #</span>
</span></span><span class="line"><span class="cl"><span class="c"># -------------------------------------------------------------------------------------------------------------------- #</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nb">Start-Script</span></span></span></code></pre></td></tr></table>
</div>
</div>
                </div>
              </div>
            </div>]]></turbo:content></item><item turbo="true"><title>Восстановление доверительных отношений между PC и Active Directory</title><link>https://lib.onl/ru/2023/10/38fc94dd-8d37-5f9e-b556-676304976a9f/</link><pubDate>Fri, 27 Oct 2023 09:25:25 +0000</pubDate><dc:creator>Kai Kimera</dc:creator><category>MS Windows</category><category>Скрипты</category><category>Терминал</category><yandex:related><link url="https://lib.onl/ru/2023/10/616da78a-eb16-575a-9119-65f0c0c7baee/">Изменение порта RDP</link><link url="https://lib.onl/ru/2023/10/c6e32349-8fc2-53f9-9a42-790878a64076/">PowerShell: Полезные функции</link><link url="https://lib.onl/ru/2023/10/52d75b90-0637-5ba6-91d6-b1bff40e1d67/">PowerShell: Стирание диска</link><link url="https://lib.onl/ru/2023/10/2a73410a-6611-570c-9ab4-dc8cc8998146/">PowerShell: Сжатие видео при помощи FFmpeg</link><link url="https://lib.onl/ru/2023/10/0028821e-c96c-5014-a1dd-8963c161b170/">PowerShell: Определение разрядности ОС Windows</link><link url="https://lib.onl/ru/2023/10/4c7aba7c-f5a6-589a-9975-fdb16f2e2862/">PowerShell Vault</link><link url="https://lib.onl/ru/2023/10/eb39e3f7-b194-53d4-8bad-01edf9fdac47/">Дефрагментация в ОС Windows</link><link url="https://lib.onl/ru/2023/10/75075788-9308-56b7-b531-2008cb35f7d0/">Установка сертификата НУЦ Минцифры</link><link url="https://lib.onl/ru/2022/05/36058650-3f35-5ed5-9565-0aa7d8800c28/">Windows Server 2022 для рабочей станции</link></yandex:related><turbo:extendedHtml>true</turbo:extendedHtml><turbo:source>https://lib.onl/ru/2023/10/38fc94dd-8d37-5f9e-b556-676304976a9f/</turbo:source><turbo:topic>Восстановление доверительных отношений между PC и Active Directory</turbo:topic><turbo:content><![CDATA[<p>Рассмотрим способы решения распространённой проблемы потери доверительных отношений между рабочей станцией и доменом Active Directory (<span class="shortcode shortcode-tag"><a href="/ru/tags/ad/" target="_blank">#AD</a></span>). Из-за этой проблемы пользователь не может авторизоваться под своей учётной записью.</p>
<p>При попытке входа пользователя под доменной учётной записью, могут произойти следующие ошибки.</p>






    




<div class="shortcode shortcode-window">
  <div class="card text-bg-danger mb-3 overflow-hidden">
    <div class="card-header">
      <div class="d-flex align-items-center">
        <div class="flex-shrink-0">
          <i class="fas fa-computer fa-fw"></i>
        </div>
        <div class="flex-grow-1 mx-2">
          <h5 class="mb-0">Trust relationship</h5>
        </div>
        <div class="flex-shrink-0">
          <ul class="list-inline mb-0">
            <li class="list-inline-item"><i class="fas fa-circle fa-fw"></i></li>
            <li class="list-inline-item"><i class="fas fa-circle fa-fw"></i></li>
            <li class="list-inline-item"><i class="fas fa-circle fa-fw"></i></li>
          </ul>
        </div>
      </div>
    </div>
    <div class="card-body">
        <p>The trust relationship between this workstation and the primary domain failed.</p>
<p>(Не удалось восстановить доверительные отношения между рабочей станцией и доменом.)</p>

    </div>
  </div>
</div>







    




<div class="shortcode shortcode-window">
  <div class="card text-bg-danger mb-3 overflow-hidden">
    <div class="card-header">
      <div class="d-flex align-items-center">
        <div class="flex-shrink-0">
          <i class="fas fa-computer fa-fw"></i>
        </div>
        <div class="flex-grow-1 mx-2">
          <h5 class="mb-0">Security database</h5>
        </div>
        <div class="flex-shrink-0">
          <ul class="list-inline mb-0">
            <li class="list-inline-item"><i class="fas fa-circle fa-fw"></i></li>
            <li class="list-inline-item"><i class="fas fa-circle fa-fw"></i></li>
            <li class="list-inline-item"><i class="fas fa-circle fa-fw"></i></li>
          </ul>
        </div>
      </div>
    </div>
    <div class="card-body">
        <p>The security database on the server does not have a computer account for this workstation trust relationship.</p>
<p>(База данных диспетчера учетных записей на сервере не содержит записи для регистрации компьютера через доверительные отношения с этой рабочей станцией.)</p>

    </div>
  </div>
</div>

<p>Ошибка может возникнуть по различным факторам. Например, когда новый компьютер присоединился к домену под уже существующем именем другого компьютера, или когда виртуальная машина восстановилась с контрольной точки.</p>
<h2 id="ручной-способ">
  <a class="link-body-emphasis" href="#%d1%80%d1%83%d1%87%d0%bd%d0%be%d0%b9-%d1%81%d0%bf%d0%be%d1%81%d0%be%d0%b1">Ручной способ</a>
</h2><p>Для того, чтобы исправить ошибку, необходимо последовательно выполнить следующие пункты:</p>
<ol>
<li>Сбросить аккаунт компьютера в <span class="shortcode shortcode-tag"><a href="/ru/tags/ad/" target="_blank">#AD</a></span>.</li>
<li>На проблемном компьютере зайти под локальным администратором и вывести компьютер из домена в рабочую группу.</li>
<li>Перезагрузить компьютер.</li>
<li>Вывести компьютер из рабочей группы и ввести обратно в домен.</li>
<li>Еще раз перезагрузить компьютер.</li>
</ol>
<h2 id="автоматизация">
  <a class="link-body-emphasis" href="#%d0%b0%d0%b2%d1%82%d0%be%d0%bc%d0%b0%d1%82%d0%b8%d0%b7%d0%b0%d1%86%d0%b8%d1%8f">Автоматизация</a>
</h2><p>Как обычно, привожу скрипт по автоматизации восстановления доверительных отношений. Скрипт решит проблему быстро и без перезагрузок. Запускается под администратором.</p>
<h3 id="параметры">
  <a class="link-body-emphasis" href="#%d0%bf%d0%b0%d1%80%d0%b0%d0%bc%d0%b5%d1%82%d1%80%d1%8b">Параметры</a>
</h3><p>Параметр у скрипта один, это название сервера Domain Controller <span class="shortcode shortcode-tag">DC</span>.</p>
<ul>
<li><code>-S</code> <code>-P_Server</code> - название сервера DC (контроллера домена). Если параметр не задан, скрипт выбирает для операции контроллер домена по умолчанию.</li>
</ul>
<h3 id="примеры">
  <a class="link-body-emphasis" href="#%d0%bf%d1%80%d0%b8%d0%bc%d0%b5%d1%80%d1%8b">Примеры</a>
</h3><p>Восстановить доверительные отношения с доменом по умолчанию:</p>











<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-0 shortcode-codeblock-terminal
shortcode-codeblock-terminal-windows
shortcode-codeblock-terminal-windows-root">
  <div class="card overflow-hidden" data-bs-theme="dark">
    <div class="card-header">
      <div class="d-flex align-items-center">
        <div class="flex-shrink-0 text-danger">
          <i class="fas fa-terminal fa-fw"></i>
        </div>
        <div class="flex-grow-1 mx-2">
          <h5 class="mb-0">Терминал</h5>
        </div>
        <div class="flex-shrink-0">
          <ul class="list-inline mb-0">
            <li class="list-inline-item" title='Копировать'>
              <a class="text-body" href="#"
                 data-fn="clipboard" data-clipboard-target="#cp-ddce884a23ffa49ddc9148942d370e8c"
                 role="button" aria-label='Копировать'>
                <i class="fas fa-copy fa-fw"></i>
              </a>
            </li>
          </ul>
        </div>
      </div>
    </div>
    <div class="card-body p-0 overflow-auto" id="cp-ddce884a23ffa49ddc9148942d370e8c"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-plaintext" data-lang="plaintext"><span class="line"><span class="cl">.\pwsh.csc.repair.ps1</span></span></code></pre></td></tr></table>
</div>
</div></div>
  </div>
</div>
<p>Восстановить доверительные отношения с доменом <code>DC-server.domain.com</code>:</p>











<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-1 shortcode-codeblock-terminal
shortcode-codeblock-terminal-windows
shortcode-codeblock-terminal-windows-root">
  <div class="card overflow-hidden" data-bs-theme="dark">
    <div class="card-header">
      <div class="d-flex align-items-center">
        <div class="flex-shrink-0 text-danger">
          <i class="fas fa-terminal fa-fw"></i>
        </div>
        <div class="flex-grow-1 mx-2">
          <h5 class="mb-0">Терминал</h5>
        </div>
        <div class="flex-shrink-0">
          <ul class="list-inline mb-0">
            <li class="list-inline-item" title='Копировать'>
              <a class="text-body" href="#"
                 data-fn="clipboard" data-clipboard-target="#cp-4c5f1e09a4f04eca5c3b0e13da1bab0c"
                 role="button" aria-label='Копировать'>
                <i class="fas fa-copy fa-fw"></i>
              </a>
            </li>
          </ul>
        </div>
      </div>
    </div>
    <div class="card-body p-0 overflow-auto" id="cp-4c5f1e09a4f04eca5c3b0e13da1bab0c"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-plaintext" data-lang="plaintext"><span class="line"><span class="cl">.\pwsh.csc.repair.ps1 -DC &#39;DC-server.domain.com&#39;</span></span></code></pre></td></tr></table>
</div>
</div></div>
  </div>
</div>
<h3 id="алгоритм-работы">
  <a class="link-body-emphasis" href="#%d0%b0%d0%bb%d0%b3%d0%be%d1%80%d0%b8%d1%82%d0%bc-%d1%80%d0%b0%d0%b1%d0%be%d1%82%d1%8b">Алгоритм работы</a>
</h3><ul>
<li>Запускается проверка доверительных отношений при помощи cmdlet&rsquo;а <code>Test-ComputerSecureChannel</code>.</li>
<li>Если проверка пройдена, скрипт завершает работу.</li>
<li>Если проверка не пройдена, запускается цикл восстановления доверительных отношений с контроллером домена с временным интервалом в 5 секунд.</li>
</ul>
<h3 id="скрипт">
  <a class="link-body-emphasis" href="#%d1%81%d0%ba%d1%80%d0%b8%d0%bf%d1%82">Скрипт</a>
</h3>
    

    
        
            
            <div class="shortcode shortcode-file mb-3">
              <div class="card overflow-hidden" data-bs-theme="dark">
                <div class="card-header">
                  <div class="d-flex align-items-center">
                    <div class="flex-shrink-0">
                      <i class="far fa-file-code fa-fw"></i>
                    </div>
                    <div class="flex-grow-1 mx-2 text-truncate">
                      <code>pwsh.csc.repair.ps1</code>
                    </div>
                    <div class="flex-shrink-0">
                      <ul class="list-inline mb-0">
                        <li class="list-inline-item" title='Копировать'>
                          <a class="text-body" href="#"
                             data-fn="clipboard" data-clipboard-target="#cp-2ad232c539b64a683a3ef64ffe1f6c9a"
                             role="button" aria-label='Копировать'>
                            <i class="fas fa-copy fa-fw"></i>
                          </a>
                        </li>
                        <li class="list-inline-item" title='Скачать'>
                          <a class="text-body" href="/ru/2023/10/38fc94dd-8d37-5f9e-b556-676304976a9f/pwsh.csc.repair.ps1" download
                             role="button" aria-label='Скачать'>
                            <i class="fas fa-download fa-fw"></i>
                          </a>
                        </li>
                        <li class="list-inline-item" title='Открыть'>
                          <a class="text-body" href="/ru/2023/10/38fc94dd-8d37-5f9e-b556-676304976a9f/pwsh.csc.repair.ps1" target="_blank"
                             role="button" aria-label='Открыть'>
                            <i class="fas fa-arrow-up-right-from-square fa-fw"></i>
                          </a>
                        </li>
                      </ul>
                    </div>
                  </div>
                </div>
                <div class="card-body p-0 overflow-auto" id="cp-2ad232c539b64a683a3ef64ffe1f6c9a">
                    
                        
                    
                    <div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span><span class="lnt">56
</span><span class="lnt">57
</span><span class="lnt">58
</span><span class="lnt">59
</span><span class="lnt">60
</span><span class="lnt">61
</span><span class="lnt">62
</span><span class="lnt">63
</span><span class="lnt">64
</span><span class="lnt">65
</span><span class="lnt">66
</span><span class="lnt">67
</span><span class="lnt">68
</span><span class="lnt">69
</span><span class="lnt">70
</span><span class="lnt">71
</span><span class="lnt">72
</span><span class="lnt">73
</span><span class="lnt">74
</span><span class="lnt">75
</span><span class="lnt">76
</span><span class="lnt">77
</span><span class="lnt">78
</span><span class="lnt">79
</span><span class="lnt">80
</span><span class="lnt">81
</span><span class="lnt">82
</span><span class="lnt">83
</span><span class="lnt">84
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-ps1" data-lang="ps1"><span class="line"><span class="cl"><span class="cm">&lt;#PSScriptInfo
</span></span></span><span class="line"><span class="cl"><span class="cm">.VERSION      0.1.0
</span></span></span><span class="line"><span class="cl"><span class="cm">.GUID         52672f5d-e2c0-467a-ae1d-c0fc9009a1eb
</span></span></span><span class="line"><span class="cl"><span class="cm">.AUTHOR       Kai Kimera
</span></span></span><span class="line"><span class="cl"><span class="cm">.AUTHOREMAIL  mail@kai.kim
</span></span></span><span class="line"><span class="cl"><span class="cm">.COMPANYNAME  Library Online
</span></span></span><span class="line"><span class="cl"><span class="cm">.COPYRIGHT    2023 Library Online. All rights reserved.
</span></span></span><span class="line"><span class="cl"><span class="cm">.LICENSEURI   https://choosealicense.com/licenses/mit/
</span></span></span><span class="line"><span class="cl"><span class="cm">.PROJECTURI   https://lib.onl/ru/2023/10/38fc94dd-8d37-5f9e-b556-676304976a9f/
</span></span></span><span class="line"><span class="cl"><span class="cm">#&gt;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c">#</span><span class="k">Requires</span><span class="w"> </span><span class="kd">-Version</span><span class="na"> 7.2</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c">#</span><span class="k">Requires</span><span class="w"> </span><span class="kd">-RunAsAdministrator</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="cm">&lt;#
</span></span></span><span class="line"><span class="cl"><span class="cm">.</span><span class="sd">SYNOPSIS</span><span class="cm">
</span></span></span><span class="line"><span class="cl"><span class="cm">Testing and repairing the secure channel between the local computer and its domain.
</span></span></span><span class="line"><span class="cl"><span class="cm">
</span></span></span><span class="line"><span class="cl"><span class="cm">.</span><span class="sd">DESCRIPTION</span><span class="cm">
</span></span></span><span class="line"><span class="cl"><span class="cm">Verifying that the channel between the local computer and its domain is working correctly by checking the status of its trust relationships. If a connection fails, trying to restore it.
</span></span></span><span class="line"><span class="cl"><span class="cm">
</span></span></span><span class="line"><span class="cl"><span class="cm">.PARAMETER P_Server
</span></span></span><span class="line"><span class="cl"><span class="cm">Specifies the domain controller to run the command. If this parameter is not specified, this script selects a default domain controller for the operation.
</span></span></span><span class="line"><span class="cl"><span class="cm">
</span></span></span><span class="line"><span class="cl"><span class="cm">.PARAMETER P_Sleep
</span></span></span><span class="line"><span class="cl"><span class="cm">Sleep time (in seconds).
</span></span></span><span class="line"><span class="cl"><span class="cm">
</span></span></span><span class="line"><span class="cl"><span class="cm">.</span><span class="sd">EXAMPLE</span><span class="cm">
</span></span></span><span class="line"><span class="cl"><span class="cm">.\pwsh.csc.repair.ps1
</span></span></span><span class="line"><span class="cl"><span class="cm">
</span></span></span><span class="line"><span class="cl"><span class="cm">.</span><span class="sd">EXAMPLE</span><span class="cm">
</span></span></span><span class="line"><span class="cl"><span class="cm">.\pwsh.csc.repair.ps1 -DC &#39;DC-server.domain.com&#39;
</span></span></span><span class="line"><span class="cl"><span class="cm">
</span></span></span><span class="line"><span class="cl"><span class="cm">.</span><span class="sd">LINK</span><span class="cm">
</span></span></span><span class="line"><span class="cl"><span class="cm">https://lib.onl/ru/2023/10/38fc94dd-8d37-5f9e-b556-676304976a9f/
</span></span></span><span class="line"><span class="cl"><span class="cm">#&gt;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c"># -------------------------------------------------------------------------------------------------------------------- #</span>
</span></span><span class="line"><span class="cl"><span class="c"># CONFIGURATION</span>
</span></span><span class="line"><span class="cl"><span class="c"># -------------------------------------------------------------------------------------------------------------------- #</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">param</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">  <span class="p">[</span><span class="nb">Parameter</span><span class="p">(</span><span class="na">HelpMessage</span><span class="p">=</span><span class="s2">&#34;Specifies the domain controller to run the command.&#34;</span><span class="p">)]</span>
</span></span><span class="line"><span class="cl">  <span class="p">[</span><span class="nb">Alias</span><span class="p">(</span><span class="s1">&#39;DC&#39;</span><span class="p">)][</span><span class="no">string</span><span class="p">]</span><span class="nv">$P_Server</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="p">[</span><span class="nb">Parameter</span><span class="p">(</span><span class="na">HelpMessage</span><span class="p">=</span><span class="s2">&#34;Sleep time (in seconds).&#34;</span><span class="p">)]</span>
</span></span><span class="line"><span class="cl">  <span class="p">[</span><span class="nb">Alias</span><span class="p">(</span><span class="s1">&#39;S&#39;</span><span class="p">)][</span><span class="no">int</span><span class="p">]</span><span class="nv">$P_Sleep</span> <span class="p">=</span> <span class="mf">5</span>
</span></span><span class="line"><span class="cl"><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c"># -------------------------------------------------------------------------------------------------------------------- #</span>
</span></span><span class="line"><span class="cl"><span class="c"># INITIALIZATION</span>
</span></span><span class="line"><span class="cl"><span class="c"># -------------------------------------------------------------------------------------------------------------------- #</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kd">function</span><span class="w"> </span><span class="nb">Start-Script</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="nb">Start-CSCRepair</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c"># -------------------------------------------------------------------------------------------------------------------- #</span>
</span></span><span class="line"><span class="cl"><span class="c"># EDITING THE REGISTRY</span>
</span></span><span class="line"><span class="cl"><span class="c"># -------------------------------------------------------------------------------------------------------------------- #</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kd">function</span><span class="w"> </span><span class="nb">Start-CSCRepair</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="nv">$Param</span> <span class="p">=</span> <span class="vm">@</span><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">Server</span> <span class="p">=</span> <span class="s2">&#34;</span><span class="nv">${P_Server}</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="n">Repair</span> <span class="p">=</span> <span class="vm">$true</span>
</span></span><span class="line"><span class="cl">    <span class="n">Credential</span> <span class="p">=</span> <span class="p">(</span><span class="nb">Get-Credential</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="k">do</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="p">(</span><span class="nb">Test-ComputerSecureChannel</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="nb">Write-Host</span> <span class="s1">&#39;Connection successful. Everything is fine!&#39;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="nb">Write-Host</span> <span class="s1">&#39;Connection failed! The secure channel between the local computer and the domain is broken. Removing and then rebuilds the channel established by the NetLogon service...&#39;</span>
</span></span><span class="line"><span class="cl">      <span class="nb">Test-ComputerSecureChannel</span> <span class="nv">@Param</span>
</span></span><span class="line"><span class="cl">      <span class="nb">Start-Sleep</span> <span class="n">-s</span> <span class="nv">$P_Sleep</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span> <span class="k">until</span> <span class="p">(</span><span class="nb">Test-ComputerSecureChannel</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c"># -------------------------------------------------------------------------------------------------------------------- #</span>
</span></span><span class="line"><span class="cl"><span class="c"># -------------------------------------------------&lt; RUNNING SCRIPT &gt;------------------------------------------------- #</span>
</span></span><span class="line"><span class="cl"><span class="c"># -------------------------------------------------------------------------------------------------------------------- #</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nb">Start-Script</span></span></span></code></pre></td></tr></table>
</div>
</div>
                </div>
              </div>
            </div>]]></turbo:content></item><item turbo="true"><title>Изменение порта RDP</title><link>https://lib.onl/ru/2023/10/616da78a-eb16-575a-9119-65f0c0c7baee/</link><pubDate>Thu, 26 Oct 2023 23:35:50 +0000</pubDate><dc:creator>Kai Kimera</dc:creator><category>MS Windows</category><category>Терминал</category><category>Скрипты</category><yandex:related><link url="https://lib.onl/ru/2023/10/c6e32349-8fc2-53f9-9a42-790878a64076/">PowerShell: Полезные функции</link><link url="https://lib.onl/ru/2023/10/52d75b90-0637-5ba6-91d6-b1bff40e1d67/">PowerShell: Стирание диска</link><link url="https://lib.onl/ru/2023/10/2a73410a-6611-570c-9ab4-dc8cc8998146/">PowerShell: Сжатие видео при помощи FFmpeg</link><link url="https://lib.onl/ru/2023/10/0028821e-c96c-5014-a1dd-8963c161b170/">PowerShell: Определение разрядности ОС Windows</link><link url="https://lib.onl/ru/2023/10/4c7aba7c-f5a6-589a-9975-fdb16f2e2862/">PowerShell Vault</link><link url="https://lib.onl/ru/2023/10/eb39e3f7-b194-53d4-8bad-01edf9fdac47/">Дефрагментация в ОС Windows</link><link url="https://lib.onl/ru/2023/10/75075788-9308-56b7-b531-2008cb35f7d0/">Установка сертификата НУЦ Минцифры</link><link url="https://lib.onl/ru/2022/05/36058650-3f35-5ed5-9565-0aa7d8800c28/">Windows Server 2022 для рабочей станции</link></yandex:related><turbo:extendedHtml>true</turbo:extendedHtml><turbo:source>https://lib.onl/ru/2023/10/616da78a-eb16-575a-9119-65f0c0c7baee/</turbo:source><turbo:topic>Изменение порта RDP</turbo:topic><turbo:content><![CDATA[<p>По умолчанию, <span class="shortcode shortcode-tag"><a href="/ru/tags/rdp/" target="_blank">#RDP</a></span> использует порт <span class="shortcode shortcode-tag">TCP</span> <code>3389</code>, но по каким-либо обстоятельствам приходится его менять. Рассмотрим два способа изменения порта RDP.</p>
<h2 id="ручное-изменение-порта">
  <a class="link-body-emphasis" href="#%d1%80%d1%83%d1%87%d0%bd%d0%be%d0%b5-%d0%b8%d0%b7%d0%bc%d0%b5%d0%bd%d0%b5%d0%bd%d0%b8%d0%b5-%d0%bf%d0%be%d1%80%d1%82%d0%b0">Ручное изменение порта</a>
</h2><p>Для изменения порта <span class="shortcode shortcode-tag"><a href="/ru/tags/rdp/" target="_blank">#RDP</a></span>, нужно отредактировать реестр:</p>
<ol>
<li>Открыть редактор реестра <code>regedit.exe</code>.</li>
<li>Пройти по пути <code>HKEY_LOCAL_MACHINE\System\CurrentControlSet\Control\Terminal Server\WinStations\RDP-Tcp</code>.</li>
<li>Найти параметр <code>PortNumber</code>.</li>
<li>Ввести новый номер порта (decimal).</li>
<li>Перезагрузить компьютер.</li>
</ol>




    








    
    






<div class="shortcode shortcode-alert">
  <div class="alert alert-warning d-flex overflow-hidden" role="alert">
    <div class="flex-shrink-0 align-self-center">
      <i class="fas fa-exclamation-triangle fa-fw fa-2x"></i>
    </div>
    <div class="flex-grow-1 ms-3 overflow-hidden">
        <p>Если включён брандмауэр, необходимо в нём разрешить подключение через новый порт RDP.</p>

    </div>
  </div>
</div>

<h2 id="автоматизация">
  <a class="link-body-emphasis" href="#%d0%b0%d0%b2%d1%82%d0%be%d0%bc%d0%b0%d1%82%d0%b8%d0%b7%d0%b0%d1%86%d0%b8%d1%8f">Автоматизация</a>
</h2><p>Весь процесс можно автоматизировать при помощи скрипта.</p>
<h3 id="параметры">
  <a class="link-body-emphasis" href="#%d0%bf%d0%b0%d1%80%d0%b0%d0%bc%d0%b5%d1%82%d1%80%d1%8b">Параметры</a>
</h3><p>Скрипт имеет один единственный параметр, это номер порта.</p>
<ul>
<li><code>-P</code> <code>-P_Port</code> - номер порта <span class="shortcode shortcode-tag"><a href="/ru/tags/rdp/" target="_blank">#RDP</a></span>.</li>
</ul>
<h3 id="примеры">
  <a class="link-body-emphasis" href="#%d0%bf%d1%80%d0%b8%d0%bc%d0%b5%d1%80%d1%8b">Примеры</a>
</h3><p>Запускается скрипт обычным способом. В параметре <code>-P</code> указывается новый номер порта <span class="shortcode shortcode-tag"><a href="/ru/tags/rdp/" target="_blank">#RDP</a></span>.</p>











<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-0 shortcode-codeblock-terminal
shortcode-codeblock-terminal-windows
shortcode-codeblock-terminal-windows-root">
  <div class="card overflow-hidden" data-bs-theme="dark">
    <div class="card-header">
      <div class="d-flex align-items-center">
        <div class="flex-shrink-0 text-danger">
          <i class="fas fa-terminal fa-fw"></i>
        </div>
        <div class="flex-grow-1 mx-2">
          <h5 class="mb-0">Терминал</h5>
        </div>
        <div class="flex-shrink-0">
          <ul class="list-inline mb-0">
            <li class="list-inline-item" title='Копировать'>
              <a class="text-body" href="#"
                 data-fn="clipboard" data-clipboard-target="#cp-8ed0a4ffcbc1eba06458f57f0fa5f1d8"
                 role="button" aria-label='Копировать'>
                <i class="fas fa-copy fa-fw"></i>
              </a>
            </li>
          </ul>
        </div>
      </div>
    </div>
    <div class="card-body p-0 overflow-auto" id="cp-8ed0a4ffcbc1eba06458f57f0fa5f1d8"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-plaintext" data-lang="plaintext"><span class="line"><span class="cl">.\pwsh.rdp.port.ps1 -P 50102</span></span></code></pre></td></tr></table>
</div>
</div></div>
  </div>
</div>
<h3 id="алгоритм-работы">
  <a class="link-body-emphasis" href="#%d0%b0%d0%bb%d0%b3%d0%be%d1%80%d0%b8%d1%82%d0%bc-%d1%80%d0%b0%d0%b1%d0%be%d1%82%d1%8b">Алгоритм работы</a>
</h3><ul>
<li>Проверяется в реестре корректность пути и изменяется номер порта <span class="shortcode shortcode-tag"><a href="/ru/tags/rdp/" target="_blank">#RDP</a></span>. Если путь не найден, то скрипт аварийно завершает работу без дальнейших изменений.</li>
<li>В брандмауэр вносится два правила, которые разрешают подключение к новому порту <span class="shortcode shortcode-tag"><a href="/ru/tags/rdp/" target="_blank">#RDP</a></span>.</li>
<li>Если служба <code>TermService</code> (служба удаленных рабочих столов) запущена, она перезапускается, применяя новые параметры порта <span class="shortcode shortcode-tag"><a href="/ru/tags/rdp/" target="_blank">#RDP</a></span>.</li>
</ul>
<h3 id="скрипт">
  <a class="link-body-emphasis" href="#%d1%81%d0%ba%d1%80%d0%b8%d0%bf%d1%82">Скрипт</a>
</h3>
    

    
        
            
            <div class="shortcode shortcode-file mb-3">
              <div class="card overflow-hidden" data-bs-theme="dark">
                <div class="card-header">
                  <div class="d-flex align-items-center">
                    <div class="flex-shrink-0">
                      <i class="far fa-file-code fa-fw"></i>
                    </div>
                    <div class="flex-grow-1 mx-2 text-truncate">
                      <code>pwsh.rdp.port.ps1</code>
                    </div>
                    <div class="flex-shrink-0">
                      <ul class="list-inline mb-0">
                        <li class="list-inline-item" title='Копировать'>
                          <a class="text-body" href="#"
                             data-fn="clipboard" data-clipboard-target="#cp-8ee3242a1bc18585317cd7c07fab9199"
                             role="button" aria-label='Копировать'>
                            <i class="fas fa-copy fa-fw"></i>
                          </a>
                        </li>
                        <li class="list-inline-item" title='Скачать'>
                          <a class="text-body" href="/ru/2023/10/616da78a-eb16-575a-9119-65f0c0c7baee/pwsh.rdp.port.ps1" download
                             role="button" aria-label='Скачать'>
                            <i class="fas fa-download fa-fw"></i>
                          </a>
                        </li>
                        <li class="list-inline-item" title='Открыть'>
                          <a class="text-body" href="/ru/2023/10/616da78a-eb16-575a-9119-65f0c0c7baee/pwsh.rdp.port.ps1" target="_blank"
                             role="button" aria-label='Открыть'>
                            <i class="fas fa-arrow-up-right-from-square fa-fw"></i>
                          </a>
                        </li>
                      </ul>
                    </div>
                  </div>
                </div>
                <div class="card-body p-0 overflow-auto" id="cp-8ee3242a1bc18585317cd7c07fab9199">
                    
                        
                    
                    <div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">  1
</span><span class="lnt">  2
</span><span class="lnt">  3
</span><span class="lnt">  4
</span><span class="lnt">  5
</span><span class="lnt">  6
</span><span class="lnt">  7
</span><span class="lnt">  8
</span><span class="lnt">  9
</span><span class="lnt"> 10
</span><span class="lnt"> 11
</span><span class="lnt"> 12
</span><span class="lnt"> 13
</span><span class="lnt"> 14
</span><span class="lnt"> 15
</span><span class="lnt"> 16
</span><span class="lnt"> 17
</span><span class="lnt"> 18
</span><span class="lnt"> 19
</span><span class="lnt"> 20
</span><span class="lnt"> 21
</span><span class="lnt"> 22
</span><span class="lnt"> 23
</span><span class="lnt"> 24
</span><span class="lnt"> 25
</span><span class="lnt"> 26
</span><span class="lnt"> 27
</span><span class="lnt"> 28
</span><span class="lnt"> 29
</span><span class="lnt"> 30
</span><span class="lnt"> 31
</span><span class="lnt"> 32
</span><span class="lnt"> 33
</span><span class="lnt"> 34
</span><span class="lnt"> 35
</span><span class="lnt"> 36
</span><span class="lnt"> 37
</span><span class="lnt"> 38
</span><span class="lnt"> 39
</span><span class="lnt"> 40
</span><span class="lnt"> 41
</span><span class="lnt"> 42
</span><span class="lnt"> 43
</span><span class="lnt"> 44
</span><span class="lnt"> 45
</span><span class="lnt"> 46
</span><span class="lnt"> 47
</span><span class="lnt"> 48
</span><span class="lnt"> 49
</span><span class="lnt"> 50
</span><span class="lnt"> 51
</span><span class="lnt"> 52
</span><span class="lnt"> 53
</span><span class="lnt"> 54
</span><span class="lnt"> 55
</span><span class="lnt"> 56
</span><span class="lnt"> 57
</span><span class="lnt"> 58
</span><span class="lnt"> 59
</span><span class="lnt"> 60
</span><span class="lnt"> 61
</span><span class="lnt"> 62
</span><span class="lnt"> 63
</span><span class="lnt"> 64
</span><span class="lnt"> 65
</span><span class="lnt"> 66
</span><span class="lnt"> 67
</span><span class="lnt"> 68
</span><span class="lnt"> 69
</span><span class="lnt"> 70
</span><span class="lnt"> 71
</span><span class="lnt"> 72
</span><span class="lnt"> 73
</span><span class="lnt"> 74
</span><span class="lnt"> 75
</span><span class="lnt"> 76
</span><span class="lnt"> 77
</span><span class="lnt"> 78
</span><span class="lnt"> 79
</span><span class="lnt"> 80
</span><span class="lnt"> 81
</span><span class="lnt"> 82
</span><span class="lnt"> 83
</span><span class="lnt"> 84
</span><span class="lnt"> 85
</span><span class="lnt"> 86
</span><span class="lnt"> 87
</span><span class="lnt"> 88
</span><span class="lnt"> 89
</span><span class="lnt"> 90
</span><span class="lnt"> 91
</span><span class="lnt"> 92
</span><span class="lnt"> 93
</span><span class="lnt"> 94
</span><span class="lnt"> 95
</span><span class="lnt"> 96
</span><span class="lnt"> 97
</span><span class="lnt"> 98
</span><span class="lnt"> 99
</span><span class="lnt">100
</span><span class="lnt">101
</span><span class="lnt">102
</span><span class="lnt">103
</span><span class="lnt">104
</span><span class="lnt">105
</span><span class="lnt">106
</span><span class="lnt">107
</span><span class="lnt">108
</span><span class="lnt">109
</span><span class="lnt">110
</span><span class="lnt">111
</span><span class="lnt">112
</span><span class="lnt">113
</span><span class="lnt">114
</span><span class="lnt">115
</span><span class="lnt">116
</span><span class="lnt">117
</span><span class="lnt">118
</span><span class="lnt">119
</span><span class="lnt">120
</span><span class="lnt">121
</span><span class="lnt">122
</span><span class="lnt">123
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-ps1" data-lang="ps1"><span class="line"><span class="cl"><span class="cm">&lt;#PSScriptInfo
</span></span></span><span class="line"><span class="cl"><span class="cm">.VERSION      0.1.0
</span></span></span><span class="line"><span class="cl"><span class="cm">.GUID         5d2bddd9-4eed-42f0-a0ba-7d30efcb81e2
</span></span></span><span class="line"><span class="cl"><span class="cm">.AUTHOR       Kai Kimera
</span></span></span><span class="line"><span class="cl"><span class="cm">.AUTHOREMAIL  mail@kai.kim
</span></span></span><span class="line"><span class="cl"><span class="cm">.COMPANYNAME  Library Online
</span></span></span><span class="line"><span class="cl"><span class="cm">.COPYRIGHT    2023 Library Online. All rights reserved.
</span></span></span><span class="line"><span class="cl"><span class="cm">.LICENSEURI   https://choosealicense.com/licenses/mit/
</span></span></span><span class="line"><span class="cl"><span class="cm">.PROJECTURI   https://lib.onl/ru/2023/10/616da78a-eb16-575a-9119-65f0c0c7baee/
</span></span></span><span class="line"><span class="cl"><span class="cm">#&gt;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c">#</span><span class="k">Requires</span><span class="w"> </span><span class="kd">-Version</span><span class="na"> 7.2</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c">#</span><span class="k">Requires</span><span class="w"> </span><span class="kd">-RunAsAdministrator</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="cm">&lt;#
</span></span></span><span class="line"><span class="cl"><span class="cm">.</span><span class="sd">SYNOPSIS</span><span class="cm">
</span></span></span><span class="line"><span class="cl"><span class="cm">Changing the RDP port number.
</span></span></span><span class="line"><span class="cl"><span class="cm">
</span></span></span><span class="line"><span class="cl"><span class="cm">.</span><span class="sd">DESCRIPTION</span><span class="cm">
</span></span></span><span class="line"><span class="cl"><span class="cm">Changing the listening port for Remote Desktop on your computer.
</span></span></span><span class="line"><span class="cl"><span class="cm">
</span></span></span><span class="line"><span class="cl"><span class="cm">.PARAMETER P_Port
</span></span></span><span class="line"><span class="cl"><span class="cm">RDP port number.
</span></span></span><span class="line"><span class="cl"><span class="cm">Default: 3389.
</span></span></span><span class="line"><span class="cl"><span class="cm">
</span></span></span><span class="line"><span class="cl"><span class="cm">.</span><span class="sd">EXAMPLE</span><span class="cm">
</span></span></span><span class="line"><span class="cl"><span class="cm">.\pwsh.rdp.port.ps1 -P 50102
</span></span></span><span class="line"><span class="cl"><span class="cm">
</span></span></span><span class="line"><span class="cl"><span class="cm">.</span><span class="sd">LINK</span><span class="cm">
</span></span></span><span class="line"><span class="cl"><span class="cm">https://lib.onl/ru/2023/10/616da78a-eb16-575a-9119-65f0c0c7baee/
</span></span></span><span class="line"><span class="cl"><span class="cm">#&gt;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c"># -------------------------------------------------------------------------------------------------------------------- #</span>
</span></span><span class="line"><span class="cl"><span class="c"># CONFIGURATION</span>
</span></span><span class="line"><span class="cl"><span class="c"># -------------------------------------------------------------------------------------------------------------------- #</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">param</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">  <span class="p">[</span><span class="nb">Parameter</span><span class="p">(</span><span class="na">HelpMessage</span><span class="p">=</span><span class="s2">&#34;RDP port number.&#34;</span><span class="p">)]</span>
</span></span><span class="line"><span class="cl">  <span class="p">[</span><span class="nb">ValidatePattern</span><span class="p">(</span><span class="s1">&#39;^[0-9]+$&#39;</span><span class="p">)]</span>
</span></span><span class="line"><span class="cl">  <span class="p">[</span><span class="nb">Alias</span><span class="p">(</span><span class="s1">&#39;P&#39;</span><span class="p">)][</span><span class="no">int</span><span class="p">]</span><span class="nv">$P_Port</span> <span class="p">=</span> <span class="mf">3389</span>
</span></span><span class="line"><span class="cl"><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c"># -------------------------------------------------------------------------------------------------------------------- #</span>
</span></span><span class="line"><span class="cl"><span class="c"># INITIALIZATION</span>
</span></span><span class="line"><span class="cl"><span class="c"># -------------------------------------------------------------------------------------------------------------------- #</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kd">function</span><span class="w"> </span><span class="nb">Start-Script</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="nb">Start-RdpRegistry</span>
</span></span><span class="line"><span class="cl">  <span class="nb">Start-RdpFirewall</span>
</span></span><span class="line"><span class="cl">  <span class="nb">Start-RdpService</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c"># -------------------------------------------------------------------------------------------------------------------- #</span>
</span></span><span class="line"><span class="cl"><span class="c"># EDITING THE REGISTRY</span>
</span></span><span class="line"><span class="cl"><span class="c"># -------------------------------------------------------------------------------------------------------------------- #</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kd">function</span><span class="w"> </span><span class="nb">Start-RdpRegistry</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="nv">$Path</span> <span class="p">=</span> <span class="s1">&#39;HKLM:\SYSTEM\CurrentControlSet\Control\Terminal Server\WinStations\RDP-Tcp&#39;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="nv">$Param</span> <span class="p">=</span> <span class="vm">@</span><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">LiteralPath</span> <span class="p">=</span> <span class="s2">&#34;</span><span class="nv">${Path}</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="n">Name</span> <span class="p">=</span> <span class="s1">&#39;PortNumber&#39;</span>
</span></span><span class="line"><span class="cl">    <span class="n">Value</span> <span class="p">=</span> <span class="nv">$P_Port</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="k">if</span> <span class="p">(</span><span class="nb">Test-Path</span> <span class="n">-LiteralPath</span> <span class="s2">&#34;</span><span class="nv">${Path}</span><span class="s2">&#34;</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nb">Set-ItemProperty</span> <span class="nv">@Param</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nb">Write-Error</span> <span class="n">-Message</span> <span class="s2">&#34;&#39;</span><span class="nv">${Path}</span><span class="s2">&#39; not found!&#34;</span> <span class="n">-ErrorAction</span> <span class="s1">&#39;Stop&#39;</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c"># -------------------------------------------------------------------------------------------------------------------- #</span>
</span></span><span class="line"><span class="cl"><span class="c"># EDITING THE FIREWALL</span>
</span></span><span class="line"><span class="cl"><span class="c"># -------------------------------------------------------------------------------------------------------------------- #</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kd">function</span><span class="w"> </span><span class="nb">Start-RdpFirewall</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="nv">$TCP</span> <span class="p">=</span> <span class="vm">@</span><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">DisplayName</span> <span class="p">=</span> <span class="s1">&#39;Custom RDP Port (TCP-In)&#39;</span>
</span></span><span class="line"><span class="cl">    <span class="n">Profile</span> <span class="p">=</span> <span class="s1">&#39;Public&#39;</span>
</span></span><span class="line"><span class="cl">    <span class="n">Direction</span> <span class="p">=</span> <span class="n">Inbound</span>
</span></span><span class="line"><span class="cl">    <span class="n">Action</span> <span class="p">=</span> <span class="n">Allow</span>
</span></span><span class="line"><span class="cl">    <span class="n">Protocol</span> <span class="p">=</span> <span class="n">TCP</span>
</span></span><span class="line"><span class="cl">    <span class="n">LocalPort</span> <span class="p">=</span> <span class="nv">$P_Port</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="nv">$UDP</span> <span class="p">=</span> <span class="vm">@</span><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">DisplayName</span> <span class="p">=</span> <span class="s1">&#39;Custom RDP Port (UDP-In)&#39;</span>
</span></span><span class="line"><span class="cl">    <span class="n">Profile</span> <span class="p">=</span> <span class="s1">&#39;Public&#39;</span>
</span></span><span class="line"><span class="cl">    <span class="n">Direction</span> <span class="p">=</span> <span class="n">Inbound</span>
</span></span><span class="line"><span class="cl">    <span class="n">Action</span> <span class="p">=</span> <span class="n">Allow</span>
</span></span><span class="line"><span class="cl">    <span class="n">Protocol</span> <span class="p">=</span> <span class="n">UDP</span>
</span></span><span class="line"><span class="cl">    <span class="n">LocalPort</span> <span class="p">=</span> <span class="nv">$P_Port</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="nb">New-NetFirewallRule</span> <span class="nv">@TCP</span>
</span></span><span class="line"><span class="cl">  <span class="nb">New-NetFirewallRule</span> <span class="nv">@UDP</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c"># -------------------------------------------------------------------------------------------------------------------- #</span>
</span></span><span class="line"><span class="cl"><span class="c"># RESTARTING THE REMOTE DESKTOP SERVICES</span>
</span></span><span class="line"><span class="cl"><span class="c"># -------------------------------------------------------------------------------------------------------------------- #</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kd">function</span><span class="w"> </span><span class="nb">Start-RdpService</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="nv">$Name</span> <span class="p">=</span> <span class="s1">&#39;TermService&#39;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="nv">$Param</span> <span class="p">=</span> <span class="vm">@</span><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">Name</span> <span class="p">=</span> <span class="s2">&#34;</span><span class="nv">${Name}</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="n">Force</span> <span class="p">=</span> <span class="vm">$true</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="k">if</span> <span class="p">((</span><span class="nb">Get-Service</span> <span class="n">-Name</span> <span class="s2">&#34;</span><span class="nv">${Name}</span><span class="s2">&#34;</span><span class="p">).</span><span class="py">Status</span> <span class="o">-eq</span> <span class="s1">&#39;Running&#39;</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nb">Restart-Service</span> <span class="nv">@Param</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nb">Write-Host</span> <span class="s2">&#34;Service &#39;</span><span class="nv">${Name}</span><span class="s2">&#39; not running!&#34;</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c"># -------------------------------------------------------------------------------------------------------------------- #</span>
</span></span><span class="line"><span class="cl"><span class="c"># -------------------------------------------------&lt; RUNNING SCRIPT &gt;------------------------------------------------- #</span>
</span></span><span class="line"><span class="cl"><span class="c"># -------------------------------------------------------------------------------------------------------------------- #</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nb">Start-Script</span></span></span></code></pre></td></tr></table>
</div>
</div>
                </div>
              </div>
            </div>]]></turbo:content></item><item turbo="true"><title>PowerShell: Полезные функции</title><link>https://lib.onl/ru/2023/10/c6e32349-8fc2-53f9-9a42-790878a64076/</link><pubDate>Tue, 24 Oct 2023 03:38:45 +0000</pubDate><dc:creator>Kai Kimera</dc:creator><category>MS Windows</category><category>Терминал</category><category>Скрипты</category><yandex:related><link url="https://lib.onl/ru/2023/10/52d75b90-0637-5ba6-91d6-b1bff40e1d67/">PowerShell: Стирание диска</link><link url="https://lib.onl/ru/2023/10/2a73410a-6611-570c-9ab4-dc8cc8998146/">PowerShell: Сжатие видео при помощи FFmpeg</link><link url="https://lib.onl/ru/2023/10/0028821e-c96c-5014-a1dd-8963c161b170/">PowerShell: Определение разрядности ОС Windows</link><link url="https://lib.onl/ru/2023/10/4c7aba7c-f5a6-589a-9975-fdb16f2e2862/">PowerShell Vault</link><link url="https://lib.onl/ru/2023/10/eb39e3f7-b194-53d4-8bad-01edf9fdac47/">Дефрагментация в ОС Windows</link><link url="https://lib.onl/ru/2023/10/75075788-9308-56b7-b531-2008cb35f7d0/">Установка сертификата НУЦ Минцифры</link><link url="https://lib.onl/ru/2022/05/36058650-3f35-5ed5-9565-0aa7d8800c28/">Windows Server 2022 для рабочей станции</link></yandex:related><turbo:extendedHtml>true</turbo:extendedHtml><turbo:source>https://lib.onl/ru/2023/10/c6e32349-8fc2-53f9-9a42-790878a64076/</turbo:source><turbo:topic>PowerShell: Полезные функции</turbo:topic><turbo:content><![CDATA[<p>Полезные функции <span class="shortcode shortcode-tag"><a href="/ru/tags/powershell/" target="_blank">#PowerShell</a></span>, которые я пишу сам или нахожу в интернете. Очень помогает в работе и в скриптах.</p>
<h2 id="найти-файлы-старше-x-дней-с-момента-создания">
  <a class="link-body-emphasis" href="#%d0%bd%d0%b0%d0%b9%d1%82%d0%b8-%d1%84%d0%b0%d0%b9%d0%bb%d1%8b-%d1%81%d1%82%d0%b0%d1%80%d1%88%d0%b5-x-%d0%b4%d0%bd%d0%b5%d0%b9-%d1%81-%d0%bc%d0%be%d0%bc%d0%b5%d0%bd%d1%82%d0%b0-%d1%81%d0%be%d0%b7%d0%b4%d0%b0%d0%bd%d0%b8%d1%8f">Найти файлы старше X дней с момента создания</a>
</h2><p>Функция позволяет найти и вывести элементы старше X дней по свойству <code>CreationTime</code>.</p>
<h3 id="параметры">
  <a class="link-body-emphasis" href="#%d0%bf%d0%b0%d1%80%d0%b0%d0%bc%d0%b5%d1%82%d1%80%d1%8b">Параметры</a>
</h3><ul>
<li><code>-P</code> - путь к директории, в которой необходимо найти файлы.</li>
<li><code>-T</code> - время, прошедшее с момента создания файла (в секундах).</li>
</ul>

    

    
        
            
            <div class="shortcode shortcode-file mb-3">
              <div class="card overflow-hidden" data-bs-theme="dark">
                <div class="card-header">
                  <div class="d-flex align-items-center">
                    <div class="flex-shrink-0">
                      <i class="far fa-file-code fa-fw"></i>
                    </div>
                    <div class="flex-grow-1 mx-2 text-truncate">
                      <code>pwsh.find.ct.ps1</code>
                    </div>
                    <div class="flex-shrink-0">
                      <ul class="list-inline mb-0">
                        <li class="list-inline-item" title='Копировать'>
                          <a class="text-body" href="#"
                             data-fn="clipboard" data-clipboard-target="#cp-8f9b41c639e8d0256a4b07938ffba3ba"
                             role="button" aria-label='Копировать'>
                            <i class="fas fa-copy fa-fw"></i>
                          </a>
                        </li>
                        <li class="list-inline-item" title='Скачать'>
                          <a class="text-body" href="/ru/2023/10/c6e32349-8fc2-53f9-9a42-790878a64076/pwsh.find.ct.ps1" download
                             role="button" aria-label='Скачать'>
                            <i class="fas fa-download fa-fw"></i>
                          </a>
                        </li>
                        <li class="list-inline-item" title='Открыть'>
                          <a class="text-body" href="/ru/2023/10/c6e32349-8fc2-53f9-9a42-790878a64076/pwsh.find.ct.ps1" target="_blank"
                             role="button" aria-label='Открыть'>
                            <i class="fas fa-arrow-up-right-from-square fa-fw"></i>
                          </a>
                        </li>
                      </ul>
                    </div>
                  </div>
                </div>
                <div class="card-body p-0 overflow-auto" id="cp-8f9b41c639e8d0256a4b07938ffba3ba">
                    
                        
                    
                    <div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-ps1" data-lang="ps1"><span class="line"><span class="cl"><span class="k">param</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">  <span class="p">[</span><span class="nb">Alias</span><span class="p">(</span><span class="s1">&#39;P&#39;</span><span class="p">)][</span><span class="no">string</span><span class="p">]</span><span class="nv">$Path</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">  <span class="p">[</span><span class="nb">Alias</span><span class="p">(</span><span class="s1">&#39;T&#39;</span><span class="p">)][</span><span class="no">long</span><span class="p">]</span><span class="nv">$Time</span>
</span></span><span class="line"><span class="cl"><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kd">function</span><span class="w"> </span><span class="nb">Find-CreationTime</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="nb">Get-ChildItem</span> <span class="n">-Path</span> <span class="s2">&#34;</span><span class="nv">${Path}</span><span class="s2">&#34;</span> <span class="n">-Recurse</span> <span class="o">-File</span>
</span></span><span class="line"><span class="cl">    <span class="p">|</span> <span class="nb">Sort-Object</span> <span class="n">-Property</span> <span class="s1">&#39;LastAccessTime&#39;</span>
</span></span><span class="line"><span class="cl">    <span class="p">|</span> <span class="nb">Where-Object</span> <span class="p">{</span> <span class="p">((</span><span class="nv">$_</span><span class="p">.</span><span class="n">CreationTime</span><span class="p">)</span> <span class="o">-lt</span> <span class="p">((</span><span class="nb">Get-Date</span><span class="p">).</span><span class="py">AddSeconds</span><span class="p">(-</span><span class="nv">$Time</span><span class="p">)))</span> <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nb">Find-CreationTime</span></span></span></code></pre></td></tr></table>
</div>
</div>
                </div>
              </div>
            </div>
        
    




    










    
    




<div class="shortcode shortcode-alert">
  <div class="alert alert-success d-flex overflow-hidden" role="alert">
    <div class="flex-shrink-0 align-self-center">
      <i class="fas fa-lightbulb fa-fw fa-2x"></i>
    </div>
    <div class="flex-grow-1 ms-3 overflow-hidden">
        <p><code>.AddSeconds</code> можно заменить на <code>.AddDays</code>, чтобы отсчитывать дату не в секундах, а в днях.</p>

    </div>
  </div>
</div>

<h2 id="найти-файлы-старше-x-дней-с-момента-изменения">
  <a class="link-body-emphasis" href="#%d0%bd%d0%b0%d0%b9%d1%82%d0%b8-%d1%84%d0%b0%d0%b9%d0%bb%d1%8b-%d1%81%d1%82%d0%b0%d1%80%d1%88%d0%b5-x-%d0%b4%d0%bd%d0%b5%d0%b9-%d1%81-%d0%bc%d0%be%d0%bc%d0%b5%d0%bd%d1%82%d0%b0-%d0%b8%d0%b7%d0%bc%d0%b5%d0%bd%d0%b5%d0%bd%d0%b8%d1%8f">Найти файлы старше X дней с момента изменения</a>
</h2><p>Функция позволяет найти и вывести элементы старше X дней по свойству <code>LastWriteTime</code>.</p>
<h3 id="параметры-1">
  <a class="link-body-emphasis" href="#%d0%bf%d0%b0%d1%80%d0%b0%d0%bc%d0%b5%d1%82%d1%80%d1%8b-1">Параметры</a>
</h3><ul>
<li><code>-P</code> - путь к директории, в которой необходимо найти файлы.</li>
<li><code>-T</code> - время, прошедшее с момента изменения файла (в секундах).</li>
</ul>




    










    
    




<div class="shortcode shortcode-alert">
  <div class="alert alert-success d-flex overflow-hidden" role="alert">
    <div class="flex-shrink-0 align-self-center">
      <i class="fas fa-lightbulb fa-fw fa-2x"></i>
    </div>
    <div class="flex-grow-1 ms-3 overflow-hidden">
        <p><code>.AddSeconds</code> можно заменить на <code>.AddDays</code>, чтобы отсчитывать дату не в секундах, а в днях.</p>

    </div>
  </div>
</div>


    

    
        
            
            <div class="shortcode shortcode-file mb-3">
              <div class="card overflow-hidden" data-bs-theme="dark">
                <div class="card-header">
                  <div class="d-flex align-items-center">
                    <div class="flex-shrink-0">
                      <i class="far fa-file-code fa-fw"></i>
                    </div>
                    <div class="flex-grow-1 mx-2 text-truncate">
                      <code>pwsh.find.lwt.ps1</code>
                    </div>
                    <div class="flex-shrink-0">
                      <ul class="list-inline mb-0">
                        <li class="list-inline-item" title='Копировать'>
                          <a class="text-body" href="#"
                             data-fn="clipboard" data-clipboard-target="#cp-1de462acc9fc7064250a5c42b10a8c0a"
                             role="button" aria-label='Копировать'>
                            <i class="fas fa-copy fa-fw"></i>
                          </a>
                        </li>
                        <li class="list-inline-item" title='Скачать'>
                          <a class="text-body" href="/ru/2023/10/c6e32349-8fc2-53f9-9a42-790878a64076/pwsh.find.lwt.ps1" download
                             role="button" aria-label='Скачать'>
                            <i class="fas fa-download fa-fw"></i>
                          </a>
                        </li>
                        <li class="list-inline-item" title='Открыть'>
                          <a class="text-body" href="/ru/2023/10/c6e32349-8fc2-53f9-9a42-790878a64076/pwsh.find.lwt.ps1" target="_blank"
                             role="button" aria-label='Открыть'>
                            <i class="fas fa-arrow-up-right-from-square fa-fw"></i>
                          </a>
                        </li>
                      </ul>
                    </div>
                  </div>
                </div>
                <div class="card-body p-0 overflow-auto" id="cp-1de462acc9fc7064250a5c42b10a8c0a">
                    
                        
                    
                    <div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-ps1" data-lang="ps1"><span class="line"><span class="cl"><span class="k">param</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">  <span class="p">[</span><span class="nb">Alias</span><span class="p">(</span><span class="s1">&#39;P&#39;</span><span class="p">)][</span><span class="no">string</span><span class="p">]</span><span class="nv">$Path</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">  <span class="p">[</span><span class="nb">Alias</span><span class="p">(</span><span class="s1">&#39;T&#39;</span><span class="p">)][</span><span class="no">long</span><span class="p">]</span><span class="nv">$Time</span>
</span></span><span class="line"><span class="cl"><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kd">function</span><span class="w"> </span><span class="nb">Find-LastWriteTime</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="nb">Get-ChildItem</span> <span class="n">-Path</span> <span class="s2">&#34;</span><span class="nv">${Path}</span><span class="s2">&#34;</span> <span class="n">-Recurse</span> <span class="o">-File</span>
</span></span><span class="line"><span class="cl">    <span class="p">|</span> <span class="nb">Sort-Object</span> <span class="n">-Property</span> <span class="s1">&#39;LastAccessTime&#39;</span>
</span></span><span class="line"><span class="cl">    <span class="p">|</span> <span class="nb">Where-Object</span> <span class="p">{</span> <span class="p">((</span><span class="nv">$_</span><span class="p">.</span><span class="n">LastWriteTime</span><span class="p">)</span> <span class="o">-lt</span> <span class="p">((</span><span class="nb">Get-Date</span><span class="p">).</span><span class="py">AddSeconds</span><span class="p">(-</span><span class="nv">$Time</span><span class="p">)))</span> <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nb">Find-LastWriteTime</span></span></span></code></pre></td></tr></table>
</div>
</div>
                </div>
              </div>
            </div>
        
    
<h2 id="создать-новый-элемент">
  <a class="link-body-emphasis" href="#%d1%81%d0%be%d0%b7%d0%b4%d0%b0%d1%82%d1%8c-%d0%bd%d0%be%d0%b2%d1%8b%d0%b9-%d1%8d%d0%bb%d0%b5%d0%bc%d0%b5%d0%bd%d1%82">Создать новый элемент</a>
</h2><p>Функция позволяет создавать элементы. Ничего экстраординарного здесь нет, просто функция, укорачивающая стандартный cmdlet <code>New-Item</code>.</p>
<h3 id="параметры-2">
  <a class="link-body-emphasis" href="#%d0%bf%d0%b0%d1%80%d0%b0%d0%bc%d0%b5%d1%82%d1%80%d1%8b-2">Параметры</a>
</h3><ul>
<li><code>-T</code> - тип элемента.
<ul>
<li><code>'D'</code> - директория.</li>
<li><code>'F'</code> - файл.</li>
</ul>
</li>
<li><code>-P</code> - путь к директории, в которой необходимо создать элемент.</li>
<li><code>-N</code> - название элемента.</li>
</ul>

    

    
        
            
            <div class="shortcode shortcode-file mb-3">
              <div class="card overflow-hidden" data-bs-theme="dark">
                <div class="card-header">
                  <div class="d-flex align-items-center">
                    <div class="flex-shrink-0">
                      <i class="far fa-file-code fa-fw"></i>
                    </div>
                    <div class="flex-grow-1 mx-2 text-truncate">
                      <code>pwsh.new.item.ps1</code>
                    </div>
                    <div class="flex-shrink-0">
                      <ul class="list-inline mb-0">
                        <li class="list-inline-item" title='Копировать'>
                          <a class="text-body" href="#"
                             data-fn="clipboard" data-clipboard-target="#cp-52953a2d6aa7e0418d938a7f50abd84a"
                             role="button" aria-label='Копировать'>
                            <i class="fas fa-copy fa-fw"></i>
                          </a>
                        </li>
                        <li class="list-inline-item" title='Скачать'>
                          <a class="text-body" href="/ru/2023/10/c6e32349-8fc2-53f9-9a42-790878a64076/pwsh.new.item.ps1" download
                             role="button" aria-label='Скачать'>
                            <i class="fas fa-download fa-fw"></i>
                          </a>
                        </li>
                        <li class="list-inline-item" title='Открыть'>
                          <a class="text-body" href="/ru/2023/10/c6e32349-8fc2-53f9-9a42-790878a64076/pwsh.new.item.ps1" target="_blank"
                             role="button" aria-label='Открыть'>
                            <i class="fas fa-arrow-up-right-from-square fa-fw"></i>
                          </a>
                        </li>
                      </ul>
                    </div>
                  </div>
                </div>
                <div class="card-body p-0 overflow-auto" id="cp-52953a2d6aa7e0418d938a7f50abd84a">
                    
                        
                    
                    <div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-ps1" data-lang="ps1"><span class="line"><span class="cl"><span class="k">param</span> <span class="p">(</span>
</span></span><span class="line"><span class="cl">  <span class="p">[</span><span class="nb">Alias</span><span class="p">(</span><span class="s1">&#39;T&#39;</span><span class="p">)][</span><span class="no">string</span><span class="p">]</span><span class="nv">$Type</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">  <span class="p">[</span><span class="nb">Alias</span><span class="p">(</span><span class="s1">&#39;P&#39;</span><span class="p">)][</span><span class="no">string</span><span class="p">]</span><span class="nv">$Path</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">  <span class="p">[</span><span class="nb">Alias</span><span class="p">(</span><span class="s1">&#39;N&#39;</span><span class="p">)][</span><span class="no">string</span><span class="p">]</span><span class="nv">$Name</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">  <span class="p">[</span><span class="nb">Alias</span><span class="p">(</span><span class="s1">&#39;A&#39;</span><span class="p">)][</span><span class="no">string</span><span class="p">]</span><span class="nv">$Action</span> <span class="p">=</span> <span class="s1">&#39;SilentlyContinue&#39;</span>
</span></span><span class="line"><span class="cl"><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kd">function</span><span class="w"> </span><span class="nb">New-Data</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="k">switch</span> <span class="p">(</span><span class="nv">$Type</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="s1">&#39;D&#39;</span> <span class="p">{</span> <span class="nv">$Type</span> <span class="p">=</span> <span class="s1">&#39;Directory&#39;</span> <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="s1">&#39;F&#39;</span> <span class="p">{</span> <span class="nv">$Type</span> <span class="p">=</span> <span class="s1">&#39;File&#39;</span> <span class="p">}</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="nb">New-Item</span> <span class="n">-Path</span> <span class="s2">&#34;</span><span class="nv">${Path}</span><span class="s2">&#34;</span> <span class="n">-Name</span> <span class="s2">&#34;</span><span class="nv">${Name}</span><span class="s2">&#34;</span> <span class="n">-ItemType</span> <span class="s2">&#34;</span><span class="nv">${Type}</span><span class="s2">&#34;</span> <span class="n">-ErrorAction</span> <span class="s2">&#34;</span><span class="nv">${Action}</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nb">New-Data</span></span></span></code></pre></td></tr></table>
</div>
</div>
                </div>
              </div>
            </div>
        
    
<h2 id="проверить-существование-элемента">
  <a class="link-body-emphasis" href="#%d0%bf%d1%80%d0%be%d0%b2%d0%b5%d1%80%d0%b8%d1%82%d1%8c-%d1%81%d1%83%d1%89%d0%b5%d1%81%d1%82%d0%b2%d0%be%d0%b2%d0%b0%d0%bd%d0%b8%d0%b5-%d1%8d%d0%bb%d0%b5%d0%bc%d0%b5%d0%bd%d1%82%d0%b0">Проверить существование элемента</a>
</h2><p>Функция позволяет &ldquo;безопасно&rdquo; проверить существование элемента. Применяется параметр <code>-LiteralPath</code>, который интерпретирует путь без какой-либо обработки.</p>
<h3 id="параметры-3">
  <a class="link-body-emphasis" href="#%d0%bf%d0%b0%d1%80%d0%b0%d0%bc%d0%b5%d1%82%d1%80%d1%8b-3">Параметры</a>
</h3><ul>
<li><code>-T</code> - тип элемента.</li>
<li><code>-P</code> - путь к директории, в которой необходимо проверить элемент.</li>
</ul>

    

    
        
            
            <div class="shortcode shortcode-file mb-3">
              <div class="card overflow-hidden" data-bs-theme="dark">
                <div class="card-header">
                  <div class="d-flex align-items-center">
                    <div class="flex-shrink-0">
                      <i class="far fa-file-code fa-fw"></i>
                    </div>
                    <div class="flex-grow-1 mx-2 text-truncate">
                      <code>pwsh.test.item.ps1</code>
                    </div>
                    <div class="flex-shrink-0">
                      <ul class="list-inline mb-0">
                        <li class="list-inline-item" title='Копировать'>
                          <a class="text-body" href="#"
                             data-fn="clipboard" data-clipboard-target="#cp-8ea62f05680d2e5e84d26df7b6a93225"
                             role="button" aria-label='Копировать'>
                            <i class="fas fa-copy fa-fw"></i>
                          </a>
                        </li>
                        <li class="list-inline-item" title='Скачать'>
                          <a class="text-body" href="/ru/2023/10/c6e32349-8fc2-53f9-9a42-790878a64076/pwsh.test.item.ps1" download
                             role="button" aria-label='Скачать'>
                            <i class="fas fa-download fa-fw"></i>
                          </a>
                        </li>
                        <li class="list-inline-item" title='Открыть'>
                          <a class="text-body" href="/ru/2023/10/c6e32349-8fc2-53f9-9a42-790878a64076/pwsh.test.item.ps1" target="_blank"
                             role="button" aria-label='Открыть'>
                            <i class="fas fa-arrow-up-right-from-square fa-fw"></i>
                          </a>
                        </li>
                      </ul>
                    </div>
                  </div>
                </div>
                <div class="card-body p-0 overflow-auto" id="cp-8ea62f05680d2e5e84d26df7b6a93225">
                    
                        
                    
                    <div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-ps1" data-lang="ps1"><span class="line"><span class="cl"><span class="k">param</span> <span class="p">(</span>
</span></span><span class="line"><span class="cl">  <span class="p">[</span><span class="nb">Alias</span><span class="p">(</span><span class="s1">&#39;T&#39;</span><span class="p">)][</span><span class="no">string</span><span class="p">]</span><span class="nv">$Type</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">  <span class="p">[</span><span class="nb">Alias</span><span class="p">(</span><span class="s1">&#39;P&#39;</span><span class="p">)][</span><span class="no">string</span><span class="p">]</span><span class="nv">$Path</span>
</span></span><span class="line"><span class="cl"><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kd">function</span><span class="w"> </span><span class="nb">Test-Data</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="k">switch</span> <span class="p">(</span><span class="nv">$Type</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="s1">&#39;D&#39;</span> <span class="p">{</span> <span class="nv">$Type</span> <span class="p">=</span> <span class="s1">&#39;Container&#39;</span> <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="s1">&#39;F&#39;</span> <span class="p">{</span> <span class="nv">$Type</span> <span class="p">=</span> <span class="s1">&#39;Leaf&#39;</span> <span class="p">}</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="nb">Test-Path</span> <span class="n">-LiteralPath</span> <span class="s2">&#34;</span><span class="nv">${Path}</span><span class="s2">&#34;</span> <span class="n">-PathType</span> <span class="s2">&#34;</span><span class="nv">${Type}</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nb">Test-Data</span></span></span></code></pre></td></tr></table>
</div>
</div>
                </div>
              </div>
            </div>
        
    
<h2 id="проверить-существование-модуля">
  <a class="link-body-emphasis" href="#%d0%bf%d1%80%d0%be%d0%b2%d0%b5%d1%80%d0%b8%d1%82%d1%8c-%d1%81%d1%83%d1%89%d0%b5%d1%81%d1%82%d0%b2%d0%be%d0%b2%d0%b0%d0%bd%d0%b8%d0%b5-%d0%bc%d0%be%d0%b4%d1%83%d0%bb%d1%8f">Проверить существование модуля</a>
</h2><p>Функция позволяет проверить существование модуля PowerShell в памяти компьютера.</p>
<h3 id="параметры-4">
  <a class="link-body-emphasis" href="#%d0%bf%d0%b0%d1%80%d0%b0%d0%bc%d0%b5%d1%82%d1%80%d1%8b-4">Параметры</a>
</h3><ul>
<li><code>-N</code> - название модуля.</li>
</ul>

    

    
        
            
            <div class="shortcode shortcode-file mb-3">
              <div class="card overflow-hidden" data-bs-theme="dark">
                <div class="card-header">
                  <div class="d-flex align-items-center">
                    <div class="flex-shrink-0">
                      <i class="far fa-file-code fa-fw"></i>
                    </div>
                    <div class="flex-grow-1 mx-2 text-truncate">
                      <code>pwsh.test.module.ps1</code>
                    </div>
                    <div class="flex-shrink-0">
                      <ul class="list-inline mb-0">
                        <li class="list-inline-item" title='Копировать'>
                          <a class="text-body" href="#"
                             data-fn="clipboard" data-clipboard-target="#cp-7a9c65f5a73a3c2e12914bca3547c374"
                             role="button" aria-label='Копировать'>
                            <i class="fas fa-copy fa-fw"></i>
                          </a>
                        </li>
                        <li class="list-inline-item" title='Скачать'>
                          <a class="text-body" href="/ru/2023/10/c6e32349-8fc2-53f9-9a42-790878a64076/pwsh.test.module.ps1" download
                             role="button" aria-label='Скачать'>
                            <i class="fas fa-download fa-fw"></i>
                          </a>
                        </li>
                        <li class="list-inline-item" title='Открыть'>
                          <a class="text-body" href="/ru/2023/10/c6e32349-8fc2-53f9-9a42-790878a64076/pwsh.test.module.ps1" target="_blank"
                             role="button" aria-label='Открыть'>
                            <i class="fas fa-arrow-up-right-from-square fa-fw"></i>
                          </a>
                        </li>
                      </ul>
                    </div>
                  </div>
                </div>
                <div class="card-body p-0 overflow-auto" id="cp-7a9c65f5a73a3c2e12914bca3547c374">
                    
                        
                    
                    <div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-ps1" data-lang="ps1"><span class="line"><span class="cl"><span class="k">param</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">  <span class="p">[</span><span class="nb">Alias</span><span class="p">(</span><span class="s1">&#39;N&#39;</span><span class="p">)][</span><span class="no">string[]</span><span class="p">]</span><span class="nv">$Names</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">  <span class="p">[</span><span class="nb">Alias</span><span class="p">(</span><span class="s1">&#39;A&#39;</span><span class="p">)][</span><span class="no">string</span><span class="p">]</span><span class="nv">$Action</span> <span class="p">=</span> <span class="s1">&#39;Stop&#39;</span>
</span></span><span class="line"><span class="cl"><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kd">function</span><span class="w"> </span><span class="nb">Test-Module</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="k">ForEach</span> <span class="p">(</span><span class="nv">$Name</span> <span class="k">in</span> <span class="nv">$Names</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="p">(</span><span class="o">-not</span> <span class="p">(</span><span class="nb">Get-Module</span> <span class="n">-ListAvailable</span> <span class="n">-Name</span> <span class="s2">&#34;</span><span class="nv">${Name}</span><span class="s2">&#34;</span><span class="p">))</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="nb">Write-Error</span> <span class="n">-Message</span> <span class="s2">&#34;Module &#39;</span><span class="nv">${Name}</span><span class="s2">&#39; not installed!&#34;</span> <span class="n">-ErrorAction</span> <span class="s2">&#34;</span><span class="nv">${Action}</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nb">Test-Module</span></span></span></code></pre></td></tr></table>
</div>
</div>
                </div>
              </div>
            </div>
        
    
<h2 id="вывести-сообщение-в-терминал">
  <a class="link-body-emphasis" href="#%d0%b2%d1%8b%d0%b2%d0%b5%d1%81%d1%82%d0%b8-%d1%81%d0%be%d0%be%d0%b1%d1%89%d0%b5%d0%bd%d0%b8%d0%b5-%d0%b2-%d1%82%d0%b5%d1%80%d0%bc%d0%b8%d0%bd%d0%b0%d0%bb">Вывести сообщение в терминал</a>
</h2><p>Функция выводит информацию в терминал по типу сообщений.</p>
<h3 id="параметры-5">
  <a class="link-body-emphasis" href="#%d0%bf%d0%b0%d1%80%d0%b0%d0%bc%d0%b5%d1%82%d1%80%d1%8b-5">Параметры</a>
</h3><ul>
<li><code>-T</code> - тип сообщения.
<ul>
<li><code>'HL'</code> - заголовок.</li>
<li><code>'I'</code> - информационное сообщение.</li>
<li><code>'W'</code> - предупреждение (warning).</li>
<li><code>'E'</code> - ошибка (error).</li>
</ul>
</li>
<li><code>-M</code> - текст сообщения.</li>
<li><code>-A</code> - действие, которое необходимо выполнить при выводе сообщения в терминал.</li>
</ul>

    

    
        
            
            <div class="shortcode shortcode-file mb-3">
              <div class="card overflow-hidden" data-bs-theme="dark">
                <div class="card-header">
                  <div class="d-flex align-items-center">
                    <div class="flex-shrink-0">
                      <i class="far fa-file-code fa-fw"></i>
                    </div>
                    <div class="flex-grow-1 mx-2 text-truncate">
                      <code>pwsh.write.msg.ps1</code>
                    </div>
                    <div class="flex-shrink-0">
                      <ul class="list-inline mb-0">
                        <li class="list-inline-item" title='Копировать'>
                          <a class="text-body" href="#"
                             data-fn="clipboard" data-clipboard-target="#cp-07a2c40e0fd67f53c87edd81419ff8f4"
                             role="button" aria-label='Копировать'>
                            <i class="fas fa-copy fa-fw"></i>
                          </a>
                        </li>
                        <li class="list-inline-item" title='Скачать'>
                          <a class="text-body" href="/ru/2023/10/c6e32349-8fc2-53f9-9a42-790878a64076/pwsh.write.msg.ps1" download
                             role="button" aria-label='Скачать'>
                            <i class="fas fa-download fa-fw"></i>
                          </a>
                        </li>
                        <li class="list-inline-item" title='Открыть'>
                          <a class="text-body" href="/ru/2023/10/c6e32349-8fc2-53f9-9a42-790878a64076/pwsh.write.msg.ps1" target="_blank"
                             role="button" aria-label='Открыть'>
                            <i class="fas fa-arrow-up-right-from-square fa-fw"></i>
                          </a>
                        </li>
                      </ul>
                    </div>
                  </div>
                </div>
                <div class="card-body p-0 overflow-auto" id="cp-07a2c40e0fd67f53c87edd81419ff8f4">
                    
                        
                    
                    <div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-ps1" data-lang="ps1"><span class="line"><span class="cl"><span class="k">param</span> <span class="p">(</span>
</span></span><span class="line"><span class="cl">  <span class="p">[</span><span class="nb">Alias</span><span class="p">(</span><span class="s1">&#39;T&#39;</span><span class="p">)][</span><span class="no">string</span><span class="p">]</span><span class="nv">$Type</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">  <span class="p">[</span><span class="nb">Alias</span><span class="p">(</span><span class="s1">&#39;M&#39;</span><span class="p">)][</span><span class="no">string</span><span class="p">]</span><span class="nv">$Message</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">  <span class="p">[</span><span class="nb">Alias</span><span class="p">(</span><span class="s1">&#39;A&#39;</span><span class="p">)][</span><span class="no">string</span><span class="p">]</span><span class="nv">$Action</span> <span class="p">=</span> <span class="s1">&#39;Continue&#39;</span>
</span></span><span class="line"><span class="cl"><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kd">function</span><span class="w"> </span><span class="nb">Write-Msg</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="k">switch</span> <span class="p">(</span><span class="nv">$Type</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="s1">&#39;HL&#39;</span>    <span class="p">{</span> <span class="nb">Write-Host</span> <span class="s2">&#34;</span><span class="nv">${NL}</span><span class="s2">--- </span><span class="nv">${Message}</span><span class="s2">&#34;</span><span class="p">.</span><span class="py">ToUpper</span><span class="p">()</span> <span class="n">-ForegroundColor</span> <span class="n">Blue</span> <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="s1">&#39;I&#39;</span>     <span class="p">{</span> <span class="nb">Write-Information</span> <span class="n">-MessageData</span> <span class="s2">&#34;</span><span class="nv">${Message}</span><span class="s2">&#34;</span> <span class="n">-InformationAction</span> <span class="s2">&#34;</span><span class="nv">${Action}</span><span class="s2">&#34;</span> <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="s1">&#39;W&#39;</span>     <span class="p">{</span> <span class="nb">Write-Warning</span> <span class="n">-Message</span> <span class="s2">&#34;</span><span class="nv">${Message}</span><span class="s2">&#34;</span> <span class="n">-WarningAction</span> <span class="s2">&#34;</span><span class="nv">${Action}</span><span class="s2">&#34;</span> <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="s1">&#39;E&#39;</span>     <span class="p">{</span> <span class="nb">Write-Error</span> <span class="n">-Message</span> <span class="s2">&#34;</span><span class="nv">${Message}</span><span class="s2">&#34;</span> <span class="n">-ErrorAction</span> <span class="s2">&#34;</span><span class="nv">${Action}</span><span class="s2">&#34;</span> <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="k">default</span> <span class="p">{</span> <span class="nb">Write-Host</span> <span class="s2">&#34;</span><span class="nv">${Message}</span><span class="s2">&#34;</span> <span class="p">}</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nb">Write-Msg</span></span></span></code></pre></td></tr></table>
</div>
</div>
                </div>
              </div>
            </div>
        
    
<h2 id="найти-свободную-букву-диска">
  <a class="link-body-emphasis" href="#%d0%bd%d0%b0%d0%b9%d1%82%d0%b8-%d1%81%d0%b2%d0%be%d0%b1%d0%be%d0%b4%d0%bd%d1%83%d1%8e-%d0%b1%d1%83%d0%ba%d0%b2%d1%83-%d0%b4%d0%b8%d1%81%d0%ba%d0%b0">Найти свободную букву диска</a>
</h2><p>Небольшая функция, которая возвращает не занятую букву диска. Используется в <span class="shortcode shortcode-uuid"><a href="/ru/2023/10/52d75b90-0637-5ba6-91d6-b1bff40e1d67/">PowerShell: Стирание диска</a></span>.</p>

    

    
        
            
            <div class="shortcode shortcode-file mb-3">
              <div class="card overflow-hidden" data-bs-theme="dark">
                <div class="card-header">
                  <div class="d-flex align-items-center">
                    <div class="flex-shrink-0">
                      <i class="far fa-file-code fa-fw"></i>
                    </div>
                    <div class="flex-grow-1 mx-2 text-truncate">
                      <code>pwsh.find.adl.ps1</code>
                    </div>
                    <div class="flex-shrink-0">
                      <ul class="list-inline mb-0">
                        <li class="list-inline-item" title='Копировать'>
                          <a class="text-body" href="#"
                             data-fn="clipboard" data-clipboard-target="#cp-4e05b7bfec210b8298820c9d2c6555f4"
                             role="button" aria-label='Копировать'>
                            <i class="fas fa-copy fa-fw"></i>
                          </a>
                        </li>
                        <li class="list-inline-item" title='Скачать'>
                          <a class="text-body" href="/ru/2023/10/c6e32349-8fc2-53f9-9a42-790878a64076/pwsh.find.adl.ps1" download
                             role="button" aria-label='Скачать'>
                            <i class="fas fa-download fa-fw"></i>
                          </a>
                        </li>
                        <li class="list-inline-item" title='Открыть'>
                          <a class="text-body" href="/ru/2023/10/c6e32349-8fc2-53f9-9a42-790878a64076/pwsh.find.adl.ps1" target="_blank"
                             role="button" aria-label='Открыть'>
                            <i class="fas fa-arrow-up-right-from-square fa-fw"></i>
                          </a>
                        </li>
                      </ul>
                    </div>
                  </div>
                </div>
                <div class="card-body p-0 overflow-auto" id="cp-4e05b7bfec210b8298820c9d2c6555f4">
                    
                        
                    
                    <div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-ps1" data-lang="ps1"><span class="line"><span class="cl"><span class="kd">function</span><span class="w"> </span><span class="nb">Find-AvailableDriveLetter</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="p">(</span><span class="mf">68</span><span class="p">.</span><span class="mf">.90</span> <span class="p">|</span> <span class="nb">ForEach-Object</span> <span class="p">{</span> <span class="nv">$L</span><span class="p">=[</span><span class="no">char</span><span class="p">]</span><span class="nv">$_</span><span class="p">;</span> <span class="k">if</span> <span class="p">((</span><span class="nb">Get-PSDrive</span><span class="p">).</span><span class="py">Name</span> <span class="o">-notContains</span> <span class="nv">$L</span><span class="p">)</span> <span class="p">{</span> <span class="nv">$L</span> <span class="p">}</span> <span class="p">})[</span><span class="mf">0</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></td></tr></table>
</div>
</div>
                </div>
              </div>
            </div>
        
    
<h2 id="получить-размер-файла">
  <a class="link-body-emphasis" href="#%d0%bf%d0%be%d0%bb%d1%83%d1%87%d0%b8%d1%82%d1%8c-%d1%80%d0%b0%d0%b7%d0%bc%d0%b5%d1%80-%d1%84%d0%b0%d0%b9%d0%bb%d0%b0">Получить размер файла</a>
</h2><p>Функция позволяет получить размер файла в различных единицах измерения.</p>
<h3 id="параметры-6">
  <a class="link-body-emphasis" href="#%d0%bf%d0%b0%d1%80%d0%b0%d0%bc%d0%b5%d1%82%d1%80%d1%8b-6">Параметры</a>
</h3><ul>
<li><code>-F</code> - название файла.</li>
</ul>

    

    
        
            
            <div class="shortcode shortcode-file mb-3">
              <div class="card overflow-hidden" data-bs-theme="dark">
                <div class="card-header">
                  <div class="d-flex align-items-center">
                    <div class="flex-shrink-0">
                      <i class="far fa-file-code fa-fw"></i>
                    </div>
                    <div class="flex-grow-1 mx-2 text-truncate">
                      <code>pwsh.get.filesize.ps1</code>
                    </div>
                    <div class="flex-shrink-0">
                      <ul class="list-inline mb-0">
                        <li class="list-inline-item" title='Копировать'>
                          <a class="text-body" href="#"
                             data-fn="clipboard" data-clipboard-target="#cp-5e88f2b14de4be94e60c1e9abcc680ed"
                             role="button" aria-label='Копировать'>
                            <i class="fas fa-copy fa-fw"></i>
                          </a>
                        </li>
                        <li class="list-inline-item" title='Скачать'>
                          <a class="text-body" href="/ru/2023/10/c6e32349-8fc2-53f9-9a42-790878a64076/pwsh.get.filesize.ps1" download
                             role="button" aria-label='Скачать'>
                            <i class="fas fa-download fa-fw"></i>
                          </a>
                        </li>
                        <li class="list-inline-item" title='Открыть'>
                          <a class="text-body" href="/ru/2023/10/c6e32349-8fc2-53f9-9a42-790878a64076/pwsh.get.filesize.ps1" target="_blank"
                             role="button" aria-label='Открыть'>
                            <i class="fas fa-arrow-up-right-from-square fa-fw"></i>
                          </a>
                        </li>
                      </ul>
                    </div>
                  </div>
                </div>
                <div class="card-body p-0 overflow-auto" id="cp-5e88f2b14de4be94e60c1e9abcc680ed">
                    
                        
                    
                    <div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-ps1" data-lang="ps1"><span class="line"><span class="cl"><span class="k">param</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">  <span class="p">[</span><span class="nb">Alias</span><span class="p">(</span><span class="s1">&#39;F&#39;</span><span class="p">)][</span><span class="no">string</span><span class="p">]</span><span class="nv">$File</span>
</span></span><span class="line"><span class="cl"><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kd">function</span><span class="w"> </span><span class="nb">Get-FileSize</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="p">(</span><span class="nb">Get-Item</span> <span class="s2">&#34;</span><span class="nv">${File}</span><span class="s2">&#34;</span><span class="p">).</span><span class="py">Length</span>      <span class="c"># Size in bytes.</span>
</span></span><span class="line"><span class="cl">  <span class="p">(</span><span class="nb">Get-Item</span> <span class="s2">&#34;</span><span class="nv">${File}</span><span class="s2">&#34;</span><span class="p">).</span><span class="n">Length</span><span class="p">/</span><span class="mf">1</span><span class="p">KB</span>  <span class="c"># Size in KB.</span>
</span></span><span class="line"><span class="cl">  <span class="p">(</span><span class="nb">Get-Item</span> <span class="s2">&#34;</span><span class="nv">${File}</span><span class="s2">&#34;</span><span class="p">).</span><span class="n">Length</span><span class="p">/</span><span class="mf">1</span><span class="p">MB</span>  <span class="c"># Size in MB.</span>
</span></span><span class="line"><span class="cl">  <span class="p">(</span><span class="nb">Get-Item</span> <span class="s2">&#34;</span><span class="nv">${File}</span><span class="s2">&#34;</span><span class="p">).</span><span class="n">Length</span><span class="p">/</span><span class="mf">1</span><span class="p">GB</span>  <span class="c"># Size in GB.</span>
</span></span><span class="line"><span class="cl">  <span class="p">(</span><span class="nb">Get-Item</span> <span class="s2">&#34;</span><span class="nv">${File}</span><span class="s2">&#34;</span><span class="p">).</span><span class="n">Length</span><span class="p">/</span><span class="mf">1</span><span class="p">TB</span>  <span class="c"># Size in TB.</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nb">Get-FileSize</span></span></span></code></pre></td></tr></table>
</div>
</div>
                </div>
              </div>
            </div>
        
    
<h2 id="работа-с-архивами-7-zip">
  <a class="link-body-emphasis" href="#%d1%80%d0%b0%d0%b1%d0%be%d1%82%d0%b0-%d1%81-%d0%b0%d1%80%d1%85%d0%b8%d0%b2%d0%b0%d0%bc%d0%b8-7-zip">Работа с архивами 7-Zip</a>
</h2><p>Функции по работе с архивами 7-Zip.</p>
<h3 id="параметры-7">
  <a class="link-body-emphasis" href="#%d0%bf%d0%b0%d1%80%d0%b0%d0%bc%d0%b5%d1%82%d1%80%d1%8b-7">Параметры</a>
</h3><ul>
<li><code>-F</code> - путь к файлу.</li>
</ul>
<h3 id="упаковка">
  <a class="link-body-emphasis" href="#%d1%83%d0%bf%d0%b0%d0%ba%d0%be%d0%b2%d0%ba%d0%b0">Упаковка</a>
</h3>
    

    
        
            
            <div class="shortcode shortcode-file mb-3">
              <div class="card overflow-hidden" data-bs-theme="dark">
                <div class="card-header">
                  <div class="d-flex align-items-center">
                    <div class="flex-shrink-0">
                      <i class="far fa-file-code fa-fw"></i>
                    </div>
                    <div class="flex-grow-1 mx-2 text-truncate">
                      <code>pwsh.compress.7z.ps1</code>
                    </div>
                    <div class="flex-shrink-0">
                      <ul class="list-inline mb-0">
                        <li class="list-inline-item" title='Копировать'>
                          <a class="text-body" href="#"
                             data-fn="clipboard" data-clipboard-target="#cp-f8b303a95a6da79f2f1fb0158d4ae49e"
                             role="button" aria-label='Копировать'>
                            <i class="fas fa-copy fa-fw"></i>
                          </a>
                        </li>
                        <li class="list-inline-item" title='Скачать'>
                          <a class="text-body" href="/ru/2023/10/c6e32349-8fc2-53f9-9a42-790878a64076/pwsh.compress.7z.ps1" download
                             role="button" aria-label='Скачать'>
                            <i class="fas fa-download fa-fw"></i>
                          </a>
                        </li>
                        <li class="list-inline-item" title='Открыть'>
                          <a class="text-body" href="/ru/2023/10/c6e32349-8fc2-53f9-9a42-790878a64076/pwsh.compress.7z.ps1" target="_blank"
                             role="button" aria-label='Открыть'>
                            <i class="fas fa-arrow-up-right-from-square fa-fw"></i>
                          </a>
                        </li>
                      </ul>
                    </div>
                  </div>
                </div>
                <div class="card-body p-0 overflow-auto" id="cp-f8b303a95a6da79f2f1fb0158d4ae49e">
                    
                        
                    
                    <div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-ps1" data-lang="ps1"><span class="line"><span class="cl"><span class="k">param</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">  <span class="p">[</span><span class="nb">Alias</span><span class="p">(</span><span class="s1">&#39;F&#39;</span><span class="p">)][</span><span class="no">string</span><span class="p">]</span><span class="nv">$File</span>
</span></span><span class="line"><span class="cl"><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kd">function</span><span class="w"> </span><span class="nb">Compress-A7z</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="nb">Get-ChildItem</span> <span class="s2">&#34;</span><span class="nv">${File}</span><span class="s2">&#34;</span> <span class="p">|</span> <span class="nb">ForEach-Object</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="p">&amp;</span> <span class="s2">&#34;</span><span class="p">$(</span><span class="nv">$Env:ProgramFiles</span><span class="p">)</span><span class="s2">\7-Zip\7z.exe&#34;</span> <span class="n">a</span> <span class="s2">&#34;</span><span class="p">$(</span><span class="nv">$_</span><span class="p">.</span><span class="py">FullName</span> <span class="p">+</span> <span class="s1">&#39;.7z&#39;</span><span class="p">)</span><span class="s2">&#34;</span> <span class="s2">&#34;</span><span class="p">$(</span><span class="nv">$_</span><span class="p">.</span><span class="n">FullName</span><span class="p">)</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nb">Compress-A7z</span></span></span></code></pre></td></tr></table>
</div>
</div>
                </div>
              </div>
            </div>
        
    
<h3 id="распаковка">
  <a class="link-body-emphasis" href="#%d1%80%d0%b0%d1%81%d0%bf%d0%b0%d0%ba%d0%be%d0%b2%d0%ba%d0%b0">Распаковка</a>
</h3>
    

    
        
            
            <div class="shortcode shortcode-file mb-3">
              <div class="card overflow-hidden" data-bs-theme="dark">
                <div class="card-header">
                  <div class="d-flex align-items-center">
                    <div class="flex-shrink-0">
                      <i class="far fa-file-code fa-fw"></i>
                    </div>
                    <div class="flex-grow-1 mx-2 text-truncate">
                      <code>pwsh.expand.7z.ps1</code>
                    </div>
                    <div class="flex-shrink-0">
                      <ul class="list-inline mb-0">
                        <li class="list-inline-item" title='Копировать'>
                          <a class="text-body" href="#"
                             data-fn="clipboard" data-clipboard-target="#cp-e5d429f4bd6165d28239aa346f296148"
                             role="button" aria-label='Копировать'>
                            <i class="fas fa-copy fa-fw"></i>
                          </a>
                        </li>
                        <li class="list-inline-item" title='Скачать'>
                          <a class="text-body" href="/ru/2023/10/c6e32349-8fc2-53f9-9a42-790878a64076/pwsh.expand.7z.ps1" download
                             role="button" aria-label='Скачать'>
                            <i class="fas fa-download fa-fw"></i>
                          </a>
                        </li>
                        <li class="list-inline-item" title='Открыть'>
                          <a class="text-body" href="/ru/2023/10/c6e32349-8fc2-53f9-9a42-790878a64076/pwsh.expand.7z.ps1" target="_blank"
                             role="button" aria-label='Открыть'>
                            <i class="fas fa-arrow-up-right-from-square fa-fw"></i>
                          </a>
                        </li>
                      </ul>
                    </div>
                  </div>
                </div>
                <div class="card-body p-0 overflow-auto" id="cp-e5d429f4bd6165d28239aa346f296148">
                    
                        
                    
                    <div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-ps1" data-lang="ps1"><span class="line"><span class="cl"><span class="k">param</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">  <span class="p">[</span><span class="nb">Alias</span><span class="p">(</span><span class="s1">&#39;F&#39;</span><span class="p">)][</span><span class="no">string</span><span class="p">]</span><span class="nv">$File</span>
</span></span><span class="line"><span class="cl"><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kd">function</span><span class="w"> </span><span class="nb">Expand-A7z</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="nb">Get-ChildItem</span> <span class="s2">&#34;</span><span class="nv">${File}</span><span class="s2">&#34;</span> <span class="p">|</span> <span class="nb">ForEach-Object</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="p">&amp;</span> <span class="s2">&#34;</span><span class="p">$(</span><span class="nv">$Env:ProgramFiles</span><span class="p">)</span><span class="s2">\7-Zip\7z.exe&#34;</span> <span class="n">x</span> <span class="s2">&#34;</span><span class="p">$(</span><span class="nv">$_</span><span class="p">.</span><span class="n">FullName</span><span class="p">)</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nb">Expand-A7z</span></span></span></code></pre></td></tr></table>
</div>
</div>
                </div>
              </div>
            </div>
        
    
<h2 id="работа-с-архивами-winrar">
  <a class="link-body-emphasis" href="#%d1%80%d0%b0%d0%b1%d0%be%d1%82%d0%b0-%d1%81-%d0%b0%d1%80%d1%85%d0%b8%d0%b2%d0%b0%d0%bc%d0%b8-winrar">Работа с архивами WinRAR</a>
</h2><p>Функции по работе с архивами WinRAR.</p>
<h3 id="параметры-8">
  <a class="link-body-emphasis" href="#%d0%bf%d0%b0%d1%80%d0%b0%d0%bc%d0%b5%d1%82%d1%80%d1%8b-8">Параметры</a>
</h3><ul>
<li><code>-F</code> - путь к файлу.</li>
</ul>
<h3 id="упаковка-1">
  <a class="link-body-emphasis" href="#%d1%83%d0%bf%d0%b0%d0%ba%d0%be%d0%b2%d0%ba%d0%b0-1">Упаковка</a>
</h3>
    

    
        
            
            <div class="shortcode shortcode-file mb-3">
              <div class="card overflow-hidden" data-bs-theme="dark">
                <div class="card-header">
                  <div class="d-flex align-items-center">
                    <div class="flex-shrink-0">
                      <i class="far fa-file-code fa-fw"></i>
                    </div>
                    <div class="flex-grow-1 mx-2 text-truncate">
                      <code>pwsh.compress.rar.ps1</code>
                    </div>
                    <div class="flex-shrink-0">
                      <ul class="list-inline mb-0">
                        <li class="list-inline-item" title='Копировать'>
                          <a class="text-body" href="#"
                             data-fn="clipboard" data-clipboard-target="#cp-ce83977d75a652bbbe5b953aecd2be0d"
                             role="button" aria-label='Копировать'>
                            <i class="fas fa-copy fa-fw"></i>
                          </a>
                        </li>
                        <li class="list-inline-item" title='Скачать'>
                          <a class="text-body" href="/ru/2023/10/c6e32349-8fc2-53f9-9a42-790878a64076/pwsh.compress.rar.ps1" download
                             role="button" aria-label='Скачать'>
                            <i class="fas fa-download fa-fw"></i>
                          </a>
                        </li>
                        <li class="list-inline-item" title='Открыть'>
                          <a class="text-body" href="/ru/2023/10/c6e32349-8fc2-53f9-9a42-790878a64076/pwsh.compress.rar.ps1" target="_blank"
                             role="button" aria-label='Открыть'>
                            <i class="fas fa-arrow-up-right-from-square fa-fw"></i>
                          </a>
                        </li>
                      </ul>
                    </div>
                  </div>
                </div>
                <div class="card-body p-0 overflow-auto" id="cp-ce83977d75a652bbbe5b953aecd2be0d">
                    
                        
                    
                    <div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-ps1" data-lang="ps1"><span class="line"><span class="cl"><span class="k">param</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">  <span class="p">[</span><span class="nb">Alias</span><span class="p">(</span><span class="s1">&#39;F&#39;</span><span class="p">)][</span><span class="no">string</span><span class="p">]</span><span class="nv">$File</span>
</span></span><span class="line"><span class="cl"><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kd">function</span><span class="w"> </span><span class="nb">Compress-RAR</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="nb">Get-ChildItem</span> <span class="s2">&#34;</span><span class="nv">${File}</span><span class="s2">&#34;</span> <span class="p">|</span> <span class="nb">ForEach-Object</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="p">&amp;</span> <span class="s2">&#34;</span><span class="p">$(</span><span class="nv">$Env:ProgramFiles</span><span class="p">)</span><span class="s2">\WinRAR\Rar.exe&#34;</span> <span class="n">a</span> <span class="s2">&#34;</span><span class="p">$(</span><span class="nv">$_</span><span class="p">.</span><span class="py">FullName</span> <span class="p">+</span> <span class="s1">&#39;.rar&#39;</span><span class="p">)</span><span class="s2">&#34;</span> <span class="s2">&#34;</span><span class="p">$(</span><span class="nv">$_</span><span class="p">.</span><span class="n">FullName</span><span class="p">)</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nb">Compress-RAR</span></span></span></code></pre></td></tr></table>
</div>
</div>
                </div>
              </div>
            </div>
        
    
<h3 id="распаковка-1">
  <a class="link-body-emphasis" href="#%d1%80%d0%b0%d1%81%d0%bf%d0%b0%d0%ba%d0%be%d0%b2%d0%ba%d0%b0-1">Распаковка</a>
</h3>
    

    
        
            
            <div class="shortcode shortcode-file mb-3">
              <div class="card overflow-hidden" data-bs-theme="dark">
                <div class="card-header">
                  <div class="d-flex align-items-center">
                    <div class="flex-shrink-0">
                      <i class="far fa-file-code fa-fw"></i>
                    </div>
                    <div class="flex-grow-1 mx-2 text-truncate">
                      <code>pwsh.expand.rar.ps1</code>
                    </div>
                    <div class="flex-shrink-0">
                      <ul class="list-inline mb-0">
                        <li class="list-inline-item" title='Копировать'>
                          <a class="text-body" href="#"
                             data-fn="clipboard" data-clipboard-target="#cp-c1b893d8bd768eacc20e57b6daec80b6"
                             role="button" aria-label='Копировать'>
                            <i class="fas fa-copy fa-fw"></i>
                          </a>
                        </li>
                        <li class="list-inline-item" title='Скачать'>
                          <a class="text-body" href="/ru/2023/10/c6e32349-8fc2-53f9-9a42-790878a64076/pwsh.expand.rar.ps1" download
                             role="button" aria-label='Скачать'>
                            <i class="fas fa-download fa-fw"></i>
                          </a>
                        </li>
                        <li class="list-inline-item" title='Открыть'>
                          <a class="text-body" href="/ru/2023/10/c6e32349-8fc2-53f9-9a42-790878a64076/pwsh.expand.rar.ps1" target="_blank"
                             role="button" aria-label='Открыть'>
                            <i class="fas fa-arrow-up-right-from-square fa-fw"></i>
                          </a>
                        </li>
                      </ul>
                    </div>
                  </div>
                </div>
                <div class="card-body p-0 overflow-auto" id="cp-c1b893d8bd768eacc20e57b6daec80b6">
                    
                        
                    
                    <div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-ps1" data-lang="ps1"><span class="line"><span class="cl"><span class="k">param</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">  <span class="p">[</span><span class="nb">Alias</span><span class="p">(</span><span class="s1">&#39;F&#39;</span><span class="p">)][</span><span class="no">string</span><span class="p">]</span><span class="nv">$File</span>
</span></span><span class="line"><span class="cl"><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kd">function</span><span class="w"> </span><span class="nb">Expand-RAR</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="nb">Get-ChildItem</span> <span class="s2">&#34;</span><span class="nv">${File}</span><span class="s2">&#34;</span> <span class="p">|</span> <span class="nb">ForEach-Object</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="p">&amp;</span> <span class="s2">&#34;</span><span class="p">$(</span><span class="nv">$Env:ProgramFiles</span><span class="p">)</span><span class="s2">\WinRAR\Rar.exe&#34;</span> <span class="n">x</span> <span class="s2">&#34;</span><span class="p">$(</span><span class="nv">$_</span><span class="p">.</span><span class="n">FullName</span><span class="p">)</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nb">Expand-RAR</span></span></span></code></pre></td></tr></table>
</div>
</div>
                </div>
              </div>
            </div>]]></turbo:content></item><item turbo="true"><title>PowerShell: Стирание диска</title><link>https://lib.onl/ru/2023/10/52d75b90-0637-5ba6-91d6-b1bff40e1d67/</link><pubDate>Mon, 23 Oct 2023 11:03:04 +0000</pubDate><dc:creator>Kai Kimera</dc:creator><category>MS Windows</category><category>Терминал</category><category>Скрипты</category><yandex:related><link url="https://lib.onl/ru/2023/10/eb39e3f7-b194-53d4-8bad-01edf9fdac47/">Дефрагментация в ОС Windows</link><link url="https://lib.onl/ru/2023/10/2a73410a-6611-570c-9ab4-dc8cc8998146/">PowerShell: Сжатие видео при помощи FFmpeg</link><link url="https://lib.onl/ru/2023/10/0028821e-c96c-5014-a1dd-8963c161b170/">PowerShell: Определение разрядности ОС Windows</link><link url="https://lib.onl/ru/2023/10/4c7aba7c-f5a6-589a-9975-fdb16f2e2862/">PowerShell Vault</link><link url="https://lib.onl/ru/2023/10/75075788-9308-56b7-b531-2008cb35f7d0/">Установка сертификата НУЦ Минцифры</link><link url="https://lib.onl/ru/2022/05/36058650-3f35-5ed5-9565-0aa7d8800c28/">Windows Server 2022 для рабочей станции</link></yandex:related><turbo:extendedHtml>true</turbo:extendedHtml><turbo:source>https://lib.onl/ru/2023/10/52d75b90-0637-5ba6-91d6-b1bff40e1d67/</turbo:source><turbo:topic>PowerShell: Стирание диска</turbo:topic><turbo:content><![CDATA[<p>Небольшой скрипт, который обнуляет <span class="shortcode shortcode-tag"><a href="/ru/tags/hdd/" target="_blank">#HDD</a></span> / <span class="shortcode shortcode-tag"><a href="/ru/tags/ssd/" target="_blank">#SSD</a></span> и создаёт файловую систему заново.</p>
<h2 id="параметры">
  <a class="link-body-emphasis" href="#%d0%bf%d0%b0%d1%80%d0%b0%d0%bc%d0%b5%d1%82%d1%80%d1%8b">Параметры</a>
</h2><ul>
<li><code>-DN</code> <code>-P_DiskNumber</code> - номер диска. Можно узнать командой <code>Get-Disk</code>. Но если не ввести номер диска в параметры скрипта при запуске, скрипт сам выведет информацию и спросит номер диска. Обязательный параметр.</li>
<li><code>-FS</code> <code>-P_FileSystem</code> - файловая система. Может принимать следующие значения:
<ul>
<li><code>'FAT'</code> - файловая система <span class="shortcode shortcode-tag">FAT</span>.</li>
<li><code>'FAT32'</code> - файловая система <span class="shortcode shortcode-tag">FAT32</span>.</li>
<li><code>'exFAT'</code> - файловая система <span class="shortcode shortcode-tag">exFAT</span>.</li>
<li><code>'NTFS'</code> - файловая система <span class="shortcode shortcode-tag">NTFS</span>.</li>
<li><code>'ReFS'</code> - новая файловая система <span class="shortcode shortcode-tag">ReFS</span>.</li>
</ul>
</li>
<li><code>-S</code> <code>-P_Sleep</code> - перерыв между командами (в секундах).</li>
</ul>
<h2 id="примеры">
  <a class="link-body-emphasis" href="#%d0%bf%d1%80%d0%b8%d0%bc%d0%b5%d1%80%d1%8b">Примеры</a>
</h2><p>Скрипт, запущенный без параметров, сам спросит необходимые данные:</p>











<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-0 shortcode-codeblock-terminal
shortcode-codeblock-terminal-windows
shortcode-codeblock-terminal-windows-root">
  <div class="card overflow-hidden" data-bs-theme="dark">
    <div class="card-header">
      <div class="d-flex align-items-center">
        <div class="flex-shrink-0 text-danger">
          <i class="fas fa-terminal fa-fw"></i>
        </div>
        <div class="flex-grow-1 mx-2">
          <h5 class="mb-0">Терминал</h5>
        </div>
        <div class="flex-shrink-0">
          <ul class="list-inline mb-0">
            <li class="list-inline-item" title='Копировать'>
              <a class="text-body" href="#"
                 data-fn="clipboard" data-clipboard-target="#cp-7788477afbd3b6761715a47d5f15a283"
                 role="button" aria-label='Копировать'>
                <i class="fas fa-copy fa-fw"></i>
              </a>
            </li>
          </ul>
        </div>
      </div>
    </div>
    <div class="card-body p-0 overflow-auto" id="cp-7788477afbd3b6761715a47d5f15a283"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-plaintext" data-lang="plaintext"><span class="line"><span class="cl">.\pwsh.disk.erase.ps1</span></span></code></pre></td></tr></table>
</div>
</div></div>
  </div>
</div>
<p>Обнулить диск <code>3</code> и указать метку <code>USB-SSD</code>:</p>











<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-1 shortcode-codeblock-terminal
shortcode-codeblock-terminal-windows
shortcode-codeblock-terminal-windows-root">
  <div class="card overflow-hidden" data-bs-theme="dark">
    <div class="card-header">
      <div class="d-flex align-items-center">
        <div class="flex-shrink-0 text-danger">
          <i class="fas fa-terminal fa-fw"></i>
        </div>
        <div class="flex-grow-1 mx-2">
          <h5 class="mb-0">Терминал</h5>
        </div>
        <div class="flex-shrink-0">
          <ul class="list-inline mb-0">
            <li class="list-inline-item" title='Копировать'>
              <a class="text-body" href="#"
                 data-fn="clipboard" data-clipboard-target="#cp-f30b11eb7972650dea04f8ba4c38f8c1"
                 role="button" aria-label='Копировать'>
                <i class="fas fa-copy fa-fw"></i>
              </a>
            </li>
          </ul>
        </div>
      </div>
    </div>
    <div class="card-body p-0 overflow-auto" id="cp-f30b11eb7972650dea04f8ba4c38f8c1"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-plaintext" data-lang="plaintext"><span class="line"><span class="cl">.\pwsh.disk.erase.ps1 -DN 3 -FS &#39;NTFS&#39;</span></span></code></pre></td></tr></table>
</div>
</div></div>
  </div>
</div>
<h2 id="скрипт">
  <a class="link-body-emphasis" href="#%d1%81%d0%ba%d1%80%d0%b8%d0%bf%d1%82">Скрипт</a>
</h2>
    

    
        
            
            <div class="shortcode shortcode-file mb-3">
              <div class="card overflow-hidden" data-bs-theme="dark">
                <div class="card-header">
                  <div class="d-flex align-items-center">
                    <div class="flex-shrink-0">
                      <i class="far fa-file-code fa-fw"></i>
                    </div>
                    <div class="flex-grow-1 mx-2 text-truncate">
                      <code>pwsh.disk.erase.ps1</code>
                    </div>
                    <div class="flex-shrink-0">
                      <ul class="list-inline mb-0">
                        <li class="list-inline-item" title='Копировать'>
                          <a class="text-body" href="#"
                             data-fn="clipboard" data-clipboard-target="#cp-dc71e0be4ff85a7f2f3d2b78d927a41c"
                             role="button" aria-label='Копировать'>
                            <i class="fas fa-copy fa-fw"></i>
                          </a>
                        </li>
                        <li class="list-inline-item" title='Скачать'>
                          <a class="text-body" href="/ru/2023/10/52d75b90-0637-5ba6-91d6-b1bff40e1d67/pwsh.disk.erase.ps1" download
                             role="button" aria-label='Скачать'>
                            <i class="fas fa-download fa-fw"></i>
                          </a>
                        </li>
                        <li class="list-inline-item" title='Открыть'>
                          <a class="text-body" href="/ru/2023/10/52d75b90-0637-5ba6-91d6-b1bff40e1d67/pwsh.disk.erase.ps1" target="_blank"
                             role="button" aria-label='Открыть'>
                            <i class="fas fa-arrow-up-right-from-square fa-fw"></i>
                          </a>
                        </li>
                      </ul>
                    </div>
                  </div>
                </div>
                <div class="card-body p-0 overflow-auto" id="cp-dc71e0be4ff85a7f2f3d2b78d927a41c">
                    
                        
                    
                    <div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">  1
</span><span class="lnt">  2
</span><span class="lnt">  3
</span><span class="lnt">  4
</span><span class="lnt">  5
</span><span class="lnt">  6
</span><span class="lnt">  7
</span><span class="lnt">  8
</span><span class="lnt">  9
</span><span class="lnt"> 10
</span><span class="lnt"> 11
</span><span class="lnt"> 12
</span><span class="lnt"> 13
</span><span class="lnt"> 14
</span><span class="lnt"> 15
</span><span class="lnt"> 16
</span><span class="lnt"> 17
</span><span class="lnt"> 18
</span><span class="lnt"> 19
</span><span class="lnt"> 20
</span><span class="lnt"> 21
</span><span class="lnt"> 22
</span><span class="lnt"> 23
</span><span class="lnt"> 24
</span><span class="lnt"> 25
</span><span class="lnt"> 26
</span><span class="lnt"> 27
</span><span class="lnt"> 28
</span><span class="lnt"> 29
</span><span class="lnt"> 30
</span><span class="lnt"> 31
</span><span class="lnt"> 32
</span><span class="lnt"> 33
</span><span class="lnt"> 34
</span><span class="lnt"> 35
</span><span class="lnt"> 36
</span><span class="lnt"> 37
</span><span class="lnt"> 38
</span><span class="lnt"> 39
</span><span class="lnt"> 40
</span><span class="lnt"> 41
</span><span class="lnt"> 42
</span><span class="lnt"> 43
</span><span class="lnt"> 44
</span><span class="lnt"> 45
</span><span class="lnt"> 46
</span><span class="lnt"> 47
</span><span class="lnt"> 48
</span><span class="lnt"> 49
</span><span class="lnt"> 50
</span><span class="lnt"> 51
</span><span class="lnt"> 52
</span><span class="lnt"> 53
</span><span class="lnt"> 54
</span><span class="lnt"> 55
</span><span class="lnt"> 56
</span><span class="lnt"> 57
</span><span class="lnt"> 58
</span><span class="lnt"> 59
</span><span class="lnt"> 60
</span><span class="lnt"> 61
</span><span class="lnt"> 62
</span><span class="lnt"> 63
</span><span class="lnt"> 64
</span><span class="lnt"> 65
</span><span class="lnt"> 66
</span><span class="lnt"> 67
</span><span class="lnt"> 68
</span><span class="lnt"> 69
</span><span class="lnt"> 70
</span><span class="lnt"> 71
</span><span class="lnt"> 72
</span><span class="lnt"> 73
</span><span class="lnt"> 74
</span><span class="lnt"> 75
</span><span class="lnt"> 76
</span><span class="lnt"> 77
</span><span class="lnt"> 78
</span><span class="lnt"> 79
</span><span class="lnt"> 80
</span><span class="lnt"> 81
</span><span class="lnt"> 82
</span><span class="lnt"> 83
</span><span class="lnt"> 84
</span><span class="lnt"> 85
</span><span class="lnt"> 86
</span><span class="lnt"> 87
</span><span class="lnt"> 88
</span><span class="lnt"> 89
</span><span class="lnt"> 90
</span><span class="lnt"> 91
</span><span class="lnt"> 92
</span><span class="lnt"> 93
</span><span class="lnt"> 94
</span><span class="lnt"> 95
</span><span class="lnt"> 96
</span><span class="lnt"> 97
</span><span class="lnt"> 98
</span><span class="lnt"> 99
</span><span class="lnt">100
</span><span class="lnt">101
</span><span class="lnt">102
</span><span class="lnt">103
</span><span class="lnt">104
</span><span class="lnt">105
</span><span class="lnt">106
</span><span class="lnt">107
</span><span class="lnt">108
</span><span class="lnt">109
</span><span class="lnt">110
</span><span class="lnt">111
</span><span class="lnt">112
</span><span class="lnt">113
</span><span class="lnt">114
</span><span class="lnt">115
</span><span class="lnt">116
</span><span class="lnt">117
</span><span class="lnt">118
</span><span class="lnt">119
</span><span class="lnt">120
</span><span class="lnt">121
</span><span class="lnt">122
</span><span class="lnt">123
</span><span class="lnt">124
</span><span class="lnt">125
</span><span class="lnt">126
</span><span class="lnt">127
</span><span class="lnt">128
</span><span class="lnt">129
</span><span class="lnt">130
</span><span class="lnt">131
</span><span class="lnt">132
</span><span class="lnt">133
</span><span class="lnt">134
</span><span class="lnt">135
</span><span class="lnt">136
</span><span class="lnt">137
</span><span class="lnt">138
</span><span class="lnt">139
</span><span class="lnt">140
</span><span class="lnt">141
</span><span class="lnt">142
</span><span class="lnt">143
</span><span class="lnt">144
</span><span class="lnt">145
</span><span class="lnt">146
</span><span class="lnt">147
</span><span class="lnt">148
</span><span class="lnt">149
</span><span class="lnt">150
</span><span class="lnt">151
</span><span class="lnt">152
</span><span class="lnt">153
</span><span class="lnt">154
</span><span class="lnt">155
</span><span class="lnt">156
</span><span class="lnt">157
</span><span class="lnt">158
</span><span class="lnt">159
</span><span class="lnt">160
</span><span class="lnt">161
</span><span class="lnt">162
</span><span class="lnt">163
</span><span class="lnt">164
</span><span class="lnt">165
</span><span class="lnt">166
</span><span class="lnt">167
</span><span class="lnt">168
</span><span class="lnt">169
</span><span class="lnt">170
</span><span class="lnt">171
</span><span class="lnt">172
</span><span class="lnt">173
</span><span class="lnt">174
</span><span class="lnt">175
</span><span class="lnt">176
</span><span class="lnt">177
</span><span class="lnt">178
</span><span class="lnt">179
</span><span class="lnt">180
</span><span class="lnt">181
</span><span class="lnt">182
</span><span class="lnt">183
</span><span class="lnt">184
</span><span class="lnt">185
</span><span class="lnt">186
</span><span class="lnt">187
</span><span class="lnt">188
</span><span class="lnt">189
</span><span class="lnt">190
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-ps1" data-lang="ps1"><span class="line"><span class="cl"><span class="cm">&lt;#PSScriptInfo
</span></span></span><span class="line"><span class="cl"><span class="cm">.VERSION      0.1.0
</span></span></span><span class="line"><span class="cl"><span class="cm">.GUID         8d95f4d5-4d14-412c-9fa4-b75ebe79df09
</span></span></span><span class="line"><span class="cl"><span class="cm">.AUTHOR       Kai Kimera
</span></span></span><span class="line"><span class="cl"><span class="cm">.AUTHOREMAIL  mail@kai.kim
</span></span></span><span class="line"><span class="cl"><span class="cm">.COMPANYNAME  Library Online
</span></span></span><span class="line"><span class="cl"><span class="cm">.COPYRIGHT    2023 Library Online. All rights reserved.
</span></span></span><span class="line"><span class="cl"><span class="cm">.LICENSEURI   https://choosealicense.com/licenses/mit/
</span></span></span><span class="line"><span class="cl"><span class="cm">.PROJECTURI   https://lib.onl/ru/2023/10/52d75b90-0637-5ba6-91d6-b1bff40e1d67/
</span></span></span><span class="line"><span class="cl"><span class="cm">#&gt;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c">#</span><span class="k">Requires</span><span class="w"> </span><span class="kd">-Version</span><span class="na"> 7.2</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c">#</span><span class="k">Requires</span><span class="w"> </span><span class="kd">-RunAsAdministrator</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="cm">&lt;#
</span></span></span><span class="line"><span class="cl"><span class="cm">.</span><span class="sd">SYNOPSIS</span><span class="cm">
</span></span></span><span class="line"><span class="cl"><span class="cm">Disk erase script.
</span></span></span><span class="line"><span class="cl"><span class="cm">
</span></span></span><span class="line"><span class="cl"><span class="cm">.</span><span class="sd">DESCRIPTION</span><span class="cm">
</span></span></span><span class="line"><span class="cl"><span class="cm">Disk cleanup followed by partition creation.
</span></span></span><span class="line"><span class="cl"><span class="cm">
</span></span></span><span class="line"><span class="cl"><span class="cm">.PARAMETER P_DiskNumber
</span></span></span><span class="line"><span class="cl"><span class="cm">Specifies the disk number of the disk on which to perform the clear operation. For a list of available disks, see the &#39;Get-Disk&#39; cmdlet.
</span></span></span><span class="line"><span class="cl"><span class="cm">
</span></span></span><span class="line"><span class="cl"><span class="cm">.PARAMETER P_FileSystem
</span></span></span><span class="line"><span class="cl"><span class="cm">Specifies the file system with which to format the volume.
</span></span></span><span class="line"><span class="cl"><span class="cm">The acceptable values for this parameter are: &#39;NTFS&#39;, &#39;ReFS&#39;, &#39;exFAT&#39;, &#39;FAT32&#39; and &#39;FAT&#39;.
</span></span></span><span class="line"><span class="cl"><span class="cm">
</span></span></span><span class="line"><span class="cl"><span class="cm">.PARAMETER P_Sleep
</span></span></span><span class="line"><span class="cl"><span class="cm">Sleep time (in seconds).
</span></span></span><span class="line"><span class="cl"><span class="cm">
</span></span></span><span class="line"><span class="cl"><span class="cm">.</span><span class="sd">EXAMPLE</span><span class="cm">
</span></span></span><span class="line"><span class="cl"><span class="cm">.\pwsh.disk.erase.ps1 -DN 3 -FS &#39;NTFS&#39;
</span></span></span><span class="line"><span class="cl"><span class="cm">
</span></span></span><span class="line"><span class="cl"><span class="cm">.</span><span class="sd">LINK</span><span class="cm">
</span></span></span><span class="line"><span class="cl"><span class="cm">https://lib.onl/ru/2023/10/52d75b90-0637-5ba6-91d6-b1bff40e1d67/
</span></span></span><span class="line"><span class="cl"><span class="cm">#&gt;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c"># -------------------------------------------------------------------------------------------------------------------- #</span>
</span></span><span class="line"><span class="cl"><span class="c"># CONFIGURATION</span>
</span></span><span class="line"><span class="cl"><span class="c"># -------------------------------------------------------------------------------------------------------------------- #</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">param</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">  <span class="p">[</span><span class="nb">Parameter</span><span class="p">(</span><span class="na">HelpMessage</span><span class="p">=</span><span class="s2">&#34;Specify the disk number.&#34;</span><span class="p">)]</span>
</span></span><span class="line"><span class="cl">  <span class="p">[</span><span class="nb">ValidatePattern</span><span class="p">(</span><span class="s1">&#39;^[0-9]+$&#39;</span><span class="p">)]</span>
</span></span><span class="line"><span class="cl">  <span class="p">[</span><span class="nb">Alias</span><span class="p">(</span><span class="s1">&#39;DN&#39;</span><span class="p">)][</span><span class="no">int</span><span class="p">]</span><span class="nv">$P_DiskNumber</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">  <span class="p">[</span><span class="nb">Parameter</span><span class="p">(</span><span class="na">HelpMessage</span><span class="p">=</span><span class="s2">&#34;Specify the file system to format the volume.&#34;</span><span class="p">)]</span>
</span></span><span class="line"><span class="cl">  <span class="p">[</span><span class="nb">ValidateSet</span><span class="p">(</span><span class="s1">&#39;FAT&#39;</span><span class="p">,</span> <span class="s1">&#39;FAT32&#39;</span><span class="p">,</span> <span class="s1">&#39;exFAT&#39;</span><span class="p">,</span> <span class="s1">&#39;NTFS&#39;</span><span class="p">,</span> <span class="s1">&#39;ReFS&#39;</span><span class="p">)]</span>
</span></span><span class="line"><span class="cl">  <span class="p">[</span><span class="nb">Alias</span><span class="p">(</span><span class="s1">&#39;FS&#39;</span><span class="p">)][</span><span class="no">string</span><span class="p">]</span><span class="nv">$P_FileSystem</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">  <span class="p">[</span><span class="nb">Parameter</span><span class="p">(</span><span class="na">HelpMessage</span><span class="p">=</span><span class="s2">&#34;Sleep time (in seconds).&#34;</span><span class="p">)]</span>
</span></span><span class="line"><span class="cl">  <span class="p">[</span><span class="nb">Alias</span><span class="p">(</span><span class="s1">&#39;S&#39;</span><span class="p">)][</span><span class="no">int</span><span class="p">]</span><span class="nv">$P_Sleep</span> <span class="p">=</span> <span class="mf">2</span>
</span></span><span class="line"><span class="cl"><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c"># New line separator.</span>
</span></span><span class="line"><span class="cl"><span class="nv">$NL</span> <span class="p">=</span> <span class="s2">&#34;</span><span class="p">$([</span><span class="no">Environment</span><span class="p">]::</span><span class="n">NewLine</span><span class="p">)</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c"># Random number.</span>
</span></span><span class="line"><span class="cl"><span class="nv">$Random</span> <span class="p">=</span> <span class="s2">&#34;</span><span class="p">$(</span><span class="nb">Get-Random</span> <span class="n">-Minimum</span> <span class="mf">1000</span> <span class="n">-Maximum</span> <span class="mf">9999</span><span class="p">)</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c"># Getting free drive letter and to assign to the new partition.</span>
</span></span><span class="line"><span class="cl"><span class="nv">$DriveLetter</span> <span class="p">=</span> <span class="s2">&#34;</span><span class="p">$((</span><span class="mf">68</span><span class="p">.</span><span class="mf">.90</span> <span class="p">|</span> <span class="nb">ForEach-Object</span> <span class="p">{</span> <span class="nv">$L</span><span class="p">=[</span><span class="no">char</span><span class="p">]</span><span class="nv">$_</span><span class="p">;</span> <span class="k">if</span> <span class="p">((</span><span class="nb">Get-PSDrive</span><span class="p">).</span><span class="py">Name</span> <span class="o">-notContains</span> <span class="nv">$L</span><span class="p">)</span> <span class="p">{</span> <span class="nv">$L</span> <span class="p">}</span> <span class="p">})[</span><span class="mf">0</span><span class="p">])</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c"># Specifying a new label to use for the volume.</span>
</span></span><span class="line"><span class="cl"><span class="nv">$FileSystemLabel</span> <span class="p">=</span> <span class="s2">&#34;DISK_</span><span class="nv">${Random}</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c"># -------------------------------------------------------------------------------------------------------------------- #</span>
</span></span><span class="line"><span class="cl"><span class="c"># INITIALIZATION</span>
</span></span><span class="line"><span class="cl"><span class="c"># -------------------------------------------------------------------------------------------------------------------- #</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kd">function</span><span class="w"> </span><span class="nb">Start-Script</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="nb">Start-DPDiskList</span>        <span class="c"># Showing disk list.</span>
</span></span><span class="line"><span class="cl">  <span class="k">if</span> <span class="p">(</span><span class="o">-not</span> <span class="nv">$P_DiskNumber</span><span class="p">)</span> <span class="p">{</span> <span class="nv">$P_DiskNumber</span> <span class="p">=</span> <span class="p">(</span><span class="nb">Read-Host</span> <span class="n">-Prompt</span> <span class="s1">&#39;Disk number&#39;</span><span class="p">)</span> <span class="p">}</span>   <span class="c"># Getting disk number.</span>
</span></span><span class="line"><span class="cl">  <span class="k">if</span> <span class="p">(</span><span class="o">-not</span> <span class="nv">$P_FileSystem</span><span class="p">)</span> <span class="p">{</span> <span class="nv">$P_FileSystem</span> <span class="p">=</span> <span class="p">(</span><span class="nb">Read-Host</span> <span class="n">-Prompt</span> <span class="s1">&#39;File system&#39;</span><span class="p">)</span> <span class="p">}</span>   <span class="c"># Getting file system.</span>
</span></span><span class="line"><span class="cl">  <span class="nb">Start-DPDiskClear</span>       <span class="c"># Starting clearing disk.</span>
</span></span><span class="line"><span class="cl">  <span class="nb">Start-DPDiskInit</span>        <span class="c"># Initializing disk.</span>
</span></span><span class="line"><span class="cl">  <span class="nb">Start-DPDiskPartition</span>   <span class="c"># Creating partition.</span>
</span></span><span class="line"><span class="cl">  <span class="nb">Start-DPDiskFormat</span>      <span class="c"># Formatting volume.</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c"># -------------------------------------------------------------------------------------------------------------------- #</span>
</span></span><span class="line"><span class="cl"><span class="c"># DISK LIST</span>
</span></span><span class="line"><span class="cl"><span class="c"># -------------------------------------------------------------------------------------------------------------------- #</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kd">function</span><span class="w"> </span><span class="nb">Start-DPDiskList</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="nb">Write-Msg</span> <span class="n">-T</span> <span class="s1">&#39;HL&#39;</span> <span class="n">-M</span> <span class="s1">&#39;Disk List&#39;</span>
</span></span><span class="line"><span class="cl">  <span class="nb">Get-Disk</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c"># -------------------------------------------------------------------------------------------------------------------- #</span>
</span></span><span class="line"><span class="cl"><span class="c"># CLEAR DISK</span>
</span></span><span class="line"><span class="cl"><span class="c"># -------------------------------------------------------------------------------------------------------------------- #</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kd">function</span><span class="w"> </span><span class="nb">Start-DPDiskClear</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="nb">Write-Msg</span> <span class="n">-T</span> <span class="s1">&#39;HL&#39;</span> <span class="n">-M</span> <span class="s2">&#34;[DISK #</span><span class="nv">${P_DiskNumber}</span><span class="s2">] Clear Disk&#34;</span>
</span></span><span class="line"><span class="cl">  <span class="nb">Write-Msg</span> <span class="n">-T</span> <span class="s1">&#39;W&#39;</span> <span class="n">-A</span> <span class="s1">&#39;Inquire&#39;</span> <span class="n">-M</span> <span class="p">(</span><span class="s2">&#34;You specified drive number &#39;</span><span class="nv">${P_DiskNumber}</span><span class="s2">&#39;.</span><span class="nv">${NL}</span><span class="s2">&#34;</span> <span class="p">+</span>
</span></span><span class="line"><span class="cl">  <span class="s2">&#34;All data will be DELETED!&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="nv">$Param</span> <span class="p">=</span> <span class="vm">@</span><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">Number</span> <span class="p">=</span> <span class="nv">$P_DiskNumber</span>
</span></span><span class="line"><span class="cl">    <span class="n">RemoveData</span> <span class="p">=</span> <span class="vm">$true</span>
</span></span><span class="line"><span class="cl">    <span class="n">RemoveOEM</span> <span class="p">=</span> <span class="vm">$true</span>
</span></span><span class="line"><span class="cl">    <span class="n">Confirm</span> <span class="p">=</span> <span class="vm">$false</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="nb">Clear-Disk</span> <span class="nv">@Param</span>
</span></span><span class="line"><span class="cl">  <span class="nb">Start-Sleep</span> <span class="n">-s</span> <span class="nv">$P_Sleep</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c"># -------------------------------------------------------------------------------------------------------------------- #</span>
</span></span><span class="line"><span class="cl"><span class="c"># INITIALIZE DISK</span>
</span></span><span class="line"><span class="cl"><span class="c"># -------------------------------------------------------------------------------------------------------------------- #</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kd">function</span><span class="w"> </span><span class="nb">Start-DPDiskInit</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="nb">Write-Msg</span> <span class="n">-T</span> <span class="s1">&#39;HL&#39;</span> <span class="n">-M</span> <span class="s2">&#34;[DISK #</span><span class="nv">${P_DiskNumber}</span><span class="s2">] Initialize Disk&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="nv">$Param</span> <span class="p">=</span> <span class="vm">@</span><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">Number</span> <span class="p">=</span> <span class="nv">$P_DiskNumber</span>
</span></span><span class="line"><span class="cl">    <span class="n">PartitionStyle</span> <span class="p">=</span> <span class="s1">&#39;GPT&#39;</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="nb">Initialize-Disk</span> <span class="nv">@Param</span>
</span></span><span class="line"><span class="cl">  <span class="nb">Start-Sleep</span> <span class="n">-s</span> <span class="nv">$P_Sleep</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c"># -------------------------------------------------------------------------------------------------------------------- #</span>
</span></span><span class="line"><span class="cl"><span class="c"># CREATE PARTITION</span>
</span></span><span class="line"><span class="cl"><span class="c"># -------------------------------------------------------------------------------------------------------------------- #</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kd">function</span><span class="w"> </span><span class="nb">Start-DPDiskPartition</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="nb">Write-Msg</span> <span class="n">-T</span> <span class="s1">&#39;HL&#39;</span> <span class="n">-M</span> <span class="s2">&#34;[DISK #</span><span class="nv">${P_DiskNumber}</span><span class="s2">] Create Partition&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="nv">$Param</span> <span class="p">=</span> <span class="vm">@</span><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">DiskNumber</span> <span class="p">=</span> <span class="nv">$P_DiskNumber</span>
</span></span><span class="line"><span class="cl">    <span class="n">DriveLetter</span> <span class="p">=</span> <span class="s2">&#34;</span><span class="nv">${DriveLetter}</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="n">UseMaximumSize</span> <span class="p">=</span> <span class="vm">$true</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="nb">New-Partition</span> <span class="nv">@Param</span>
</span></span><span class="line"><span class="cl">  <span class="nb">Start-Sleep</span> <span class="n">-s</span> <span class="nv">$P_Sleep</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c"># -------------------------------------------------------------------------------------------------------------------- #</span>
</span></span><span class="line"><span class="cl"><span class="c"># FORMAT DISK VOLUME</span>
</span></span><span class="line"><span class="cl"><span class="c"># -------------------------------------------------------------------------------------------------------------------- #</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kd">function</span><span class="w"> </span><span class="nb">Start-DPDiskFormat</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="nb">Write-Msg</span> <span class="n">-T</span> <span class="s1">&#39;HL&#39;</span> <span class="n">-M</span> <span class="s2">&#34;[DISK #</span><span class="nv">${P_DiskNumber}</span><span class="s2">] Format Disk Volume (</span><span class="nv">${DriveLetter}</span><span class="s2"> / </span><span class="nv">${P_FileSystem}</span><span class="s2">)&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="k">if</span> <span class="p">(</span><span class="o">-not</span> <span class="nv">$P_FileSystem</span><span class="p">)</span> <span class="p">{</span> <span class="nv">$P_FileSystem</span> <span class="p">=</span> <span class="s1">&#39;NTFS&#39;</span> <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="nv">$Param</span> <span class="p">=</span> <span class="vm">@</span><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">DriveLetter</span> <span class="p">=</span> <span class="s2">&#34;</span><span class="nv">${DriveLetter}</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="n">FileSystem</span> <span class="p">=</span> <span class="s2">&#34;</span><span class="nv">${P_FileSystem}</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="n">NewFileSystemLabel</span> <span class="p">=</span> <span class="s2">&#34;</span><span class="nv">${FileSystemLabel}</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="n">Force</span> <span class="p">=</span> <span class="vm">$true</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="nb">Format-Volume</span> <span class="nv">@Param</span>
</span></span><span class="line"><span class="cl">  <span class="nb">Start-Sleep</span> <span class="n">-s</span> <span class="nv">$P_Sleep</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c"># -------------------------------------------------------------------------------------------------------------------- #</span>
</span></span><span class="line"><span class="cl"><span class="c"># ------------------------------------------------&lt; COMMON FUNCTIONS &gt;------------------------------------------------ #</span>
</span></span><span class="line"><span class="cl"><span class="c"># -------------------------------------------------------------------------------------------------------------------- #</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c"># -------------------------------------------------------------------------------------------------------------------- #</span>
</span></span><span class="line"><span class="cl"><span class="c"># SYSTEM MESSAGES</span>
</span></span><span class="line"><span class="cl"><span class="c"># -------------------------------------------------------------------------------------------------------------------- #</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kd">function</span><span class="w"> </span><span class="nb">Write-Msg</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="k">param</span> <span class="p">(</span>
</span></span><span class="line"><span class="cl">    <span class="p">[</span><span class="nb">Alias</span><span class="p">(</span><span class="s1">&#39;T&#39;</span><span class="p">)][</span><span class="no">string</span><span class="p">]</span><span class="nv">$Type</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="p">[</span><span class="nb">Alias</span><span class="p">(</span><span class="s1">&#39;M&#39;</span><span class="p">)][</span><span class="no">string</span><span class="p">]</span><span class="nv">$Message</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="p">[</span><span class="nb">Alias</span><span class="p">(</span><span class="s1">&#39;A&#39;</span><span class="p">)][</span><span class="no">string</span><span class="p">]</span><span class="nv">$Action</span> <span class="p">=</span> <span class="s1">&#39;Continue&#39;</span>
</span></span><span class="line"><span class="cl">  <span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="k">switch</span> <span class="p">(</span><span class="nv">$Type</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="s1">&#39;HL&#39;</span>    <span class="p">{</span> <span class="nb">Write-Host</span> <span class="s2">&#34;</span><span class="nv">${NL}</span><span class="s2">--- </span><span class="nv">${Message}</span><span class="s2">&#34;</span><span class="p">.</span><span class="py">ToUpper</span><span class="p">()</span> <span class="n">-ForegroundColor</span> <span class="n">Blue</span> <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="s1">&#39;I&#39;</span>     <span class="p">{</span> <span class="nb">Write-Information</span> <span class="n">-MessageData</span> <span class="s2">&#34;</span><span class="nv">${Message}</span><span class="s2">&#34;</span> <span class="n">-InformationAction</span> <span class="s2">&#34;</span><span class="nv">${Action}</span><span class="s2">&#34;</span> <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="s1">&#39;W&#39;</span>     <span class="p">{</span> <span class="nb">Write-Warning</span> <span class="n">-Message</span> <span class="s2">&#34;</span><span class="nv">${Message}</span><span class="s2">&#34;</span> <span class="n">-WarningAction</span> <span class="s2">&#34;</span><span class="nv">${Action}</span><span class="s2">&#34;</span> <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="s1">&#39;E&#39;</span>     <span class="p">{</span> <span class="nb">Write-Error</span> <span class="n">-Message</span> <span class="s2">&#34;</span><span class="nv">${Message}</span><span class="s2">&#34;</span> <span class="n">-ErrorAction</span> <span class="s2">&#34;</span><span class="nv">${Action}</span><span class="s2">&#34;</span> <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="k">default</span> <span class="p">{</span> <span class="nb">Write-Host</span> <span class="s2">&#34;</span><span class="nv">${Message}</span><span class="s2">&#34;</span> <span class="p">}</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c"># -------------------------------------------------------------------------------------------------------------------- #</span>
</span></span><span class="line"><span class="cl"><span class="c"># -------------------------------------------------&lt; RUNNING SCRIPT &gt;------------------------------------------------- #</span>
</span></span><span class="line"><span class="cl"><span class="c"># -------------------------------------------------------------------------------------------------------------------- #</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nb">Start-Script</span></span></span></code></pre></td></tr></table>
</div>
</div>
                </div>
              </div>
            </div>]]></turbo:content></item><item turbo="true"><title>PowerShell: Сжатие видео при помощи FFmpeg</title><link>https://lib.onl/ru/2023/10/2a73410a-6611-570c-9ab4-dc8cc8998146/</link><pubDate>Sun, 22 Oct 2023 14:06:44 +0000</pubDate><dc:creator>Kai Kimera</dc:creator><category>MS Windows</category><category>Терминал</category><category>Скрипты</category><yandex:related><link url="https://lib.onl/ru/2023/10/0028821e-c96c-5014-a1dd-8963c161b170/">PowerShell: Определение разрядности ОС Windows</link><link url="https://lib.onl/ru/2023/10/4c7aba7c-f5a6-589a-9975-fdb16f2e2862/">PowerShell Vault</link><link url="https://lib.onl/ru/2023/10/eb39e3f7-b194-53d4-8bad-01edf9fdac47/">Дефрагментация в ОС Windows</link><link url="https://lib.onl/ru/2023/10/75075788-9308-56b7-b531-2008cb35f7d0/">Установка сертификата НУЦ Минцифры</link><link url="https://lib.onl/ru/2022/05/36058650-3f35-5ed5-9565-0aa7d8800c28/">Windows Server 2022 для рабочей станции</link></yandex:related><turbo:extendedHtml>true</turbo:extendedHtml><turbo:source>https://lib.onl/ru/2023/10/2a73410a-6611-570c-9ab4-dc8cc8998146/</turbo:source><turbo:topic>PowerShell: Сжатие видео при помощи FFmpeg</turbo:topic><turbo:content><![CDATA[<p>Когда то в далёкой далёкой галактике&hellip; Ко мне на работе обратились с просьбой как то уменьшить видео, записанное на камеру в формате <code>.mov</code>. Естественно, я воспользовался библиотекой <span class="shortcode shortcode-tag"><a href="/ru/tags/ffmpeg/" target="_blank">#FFmpeg</a></span>. Но скрипт автоматизации решил написать только сейчас&hellip;</p>
<p>Скрипт прост как лапоть. Состоит из небольшого количества вводных параметров, большинство из которых изменять не требуется. Предназначен скрипт для быстрого пакетного конвертирования файлов видео из одного формата в другой, в основном, с целью уменьшения размера. Скрипт не предназначен для сложного редактирования видео!</p>
<h2 id="параметры">
  <a class="link-body-emphasis" href="#%d0%bf%d0%b0%d1%80%d0%b0%d0%bc%d0%b5%d1%82%d1%80%d1%8b">Параметры</a>
</h2><ul>
<li><code>-F</code> <code>-Files</code> - массив входящих файлов.</li>
<li><code>-CV</code> <code>-vCodec</code> - видео кодек, используемый для конвертации. По умолчанию: <code>libx265</code>. Поддерживаемые кодеки:
<ul>
<li><code>'libx264'</code> - кодек &ldquo;H.264&rdquo;.</li>
<li><code>'libx265'</code> - кодек &ldquo;H.265&rdquo;.</li>
<li><code>'libvpx-vp9'</code> - кодек &ldquo;VP9&rdquo; (&ldquo;WebM&rdquo;).</li>
<li><code>'libaom-av1'</code> - кодек &ldquo;AV1&rdquo;.</li>
</ul>
</li>
<li><code>-CA</code> <code>-aCodec</code> - аудио кодек, используемый для конвертации. По умолчанию: <code>copy</code>. Поддерживаемые кодеки:
<ul>
<li><code>'libfdk_aac'</code> - кодек &ldquo;Fraunhofer FDK AAC&rdquo;.</li>
<li><code>'aac'</code> - кодек &ldquo;FFmpeg AAC&rdquo;.</li>
<li><code>'libmp3lame'</code> - кодек &ldquo;FFmpeg MP3&rdquo;.</li>
</ul>
</li>
<li><code>-R</code> <code>-Framerate</code> - частота кадров выходящего файла (FPS). Сжатие кадров с учётом движения, где сцены движения кодируются с меньшим качеством, чем статичные сцены, что субъективно приводит к восприятию, как качественного, ибо визуально человек различает больше деталей в неподвижных объектах, чем в движущихся. Если параметр не указан, то значение берётся из входящего файла.</li>
<li><code>-C</code> <code>-CRF</code> - постоянный коэффициент потока (Constant Rate Factor). Это режим кодирования для кодеков &ldquo;H.264&rdquo; и &ldquo;H.265&rdquo; с постоянным воспринимаемым качеством, осуществляемый с помощью настройки качества (и управления скоростью). Если параметр не указан, то значение берётся по умолчанию, обычно это <code>28</code> при кодеке <code>libx265</code> и <code>23</code> при <code>libx264</code>.</li>
<li><code>-P</code> <code>-Preset</code> - пресеты. Это набор параметров, которые обеспечивают определённую скорость кодирования с степень сжатия. У каждого кодека видео свой набор пресетов. Нужно смотреть <a title="" href="https://trac.ffmpeg.org/wiki" target="_blank"
   rel="noopener noreferrer">документацию</a>.</li>
<li><code>-EXT</code> <code>-Extension</code> - расширение выходящих файлов.</li>
</ul>
<h2 id="примеры">
  <a class="link-body-emphasis" href="#%d0%bf%d1%80%d0%b8%d0%bc%d0%b5%d1%80%d1%8b">Примеры</a>
</h2><p>Конвертировать файлы <code>file_01.mov</code>, <code>file_02.mov</code> и <code>file_03.mov</code> в формат <code>mp4</code>:</p>











<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-0 shortcode-codeblock-terminal
shortcode-codeblock-terminal-windows
shortcode-codeblock-terminal-windows-user">
  <div class="card overflow-hidden" data-bs-theme="dark">
    <div class="card-header">
      <div class="d-flex align-items-center">
        <div class="flex-shrink-0 ">
          <i class="fas fa-terminal fa-fw"></i>
        </div>
        <div class="flex-grow-1 mx-2">
          <h5 class="mb-0">Терминал</h5>
        </div>
        <div class="flex-shrink-0">
          <ul class="list-inline mb-0">
            <li class="list-inline-item" title='Копировать'>
              <a class="text-body" href="#"
                 data-fn="clipboard" data-clipboard-target="#cp-3bc6c0235da016f4b4351522919f8f81"
                 role="button" aria-label='Копировать'>
                <i class="fas fa-copy fa-fw"></i>
              </a>
            </li>
          </ul>
        </div>
      </div>
    </div>
    <div class="card-body p-0 overflow-auto" id="cp-3bc6c0235da016f4b4351522919f8f81"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-plaintext" data-lang="plaintext"><span class="line"><span class="cl">Compress-Video -F &#39;file_01.mov&#39;, &#39;file_02.mov&#39;, &#39;file_03.mov&#39;</span></span></code></pre></td></tr></table>
</div>
</div></div>
  </div>
</div>
<p>Пакетная конвертация всех файлов с расширением <code>.mov</code> в формат <code>mp4</code>:</p>











<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-1 shortcode-codeblock-terminal
shortcode-codeblock-terminal-windows
shortcode-codeblock-terminal-windows-user">
  <div class="card overflow-hidden" data-bs-theme="dark">
    <div class="card-header">
      <div class="d-flex align-items-center">
        <div class="flex-shrink-0 ">
          <i class="fas fa-terminal fa-fw"></i>
        </div>
        <div class="flex-grow-1 mx-2">
          <h5 class="mb-0">Терминал</h5>
        </div>
        <div class="flex-shrink-0">
          <ul class="list-inline mb-0">
            <li class="list-inline-item" title='Копировать'>
              <a class="text-body" href="#"
                 data-fn="clipboard" data-clipboard-target="#cp-a721a02ea21332f0f3db1144678839fe"
                 role="button" aria-label='Копировать'>
                <i class="fas fa-copy fa-fw"></i>
              </a>
            </li>
          </ul>
        </div>
      </div>
    </div>
    <div class="card-body p-0 overflow-auto" id="cp-a721a02ea21332f0f3db1144678839fe"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-plaintext" data-lang="plaintext"><span class="line"><span class="cl">Compress-Video -F &#39;*.mov&#39;</span></span></code></pre></td></tr></table>
</div>
</div></div>
  </div>
</div>
<h2 id="алгоритм-работы">
  <a class="link-body-emphasis" href="#%d0%b0%d0%bb%d0%b3%d0%be%d1%80%d0%b8%d1%82%d0%bc-%d1%80%d0%b0%d0%b1%d0%be%d1%82%d1%8b">Алгоритм работы</a>
</h2><p>Скрипт предназначен для быстрого пакетного преобразования файлов видео из одного формата в другой.</p>




    








    
    






<div class="shortcode shortcode-alert">
  <div class="alert alert-warning d-flex overflow-hidden" role="alert">
    <div class="flex-shrink-0 align-self-center">
      <i class="fas fa-exclamation-triangle fa-fw fa-2x"></i>
    </div>
    <div class="flex-grow-1 ms-3 overflow-hidden">
        <p>Для работы скрипта необходим файл <code>ffmpeg.exe</code>, архив которого можно скачать с сайта <a title="" href="https://www.gyan.dev/ffmpeg/builds/" target="_blank"
   rel="noopener noreferrer">gyan.dev</a>, распаковать и разместить рядом с файлом скрипта или в любую дочернюю директорию. Скрипт сам найдёт файл <code>ffmpeg.exe</code> и начнёт его использовать.</p>

    </div>
  </div>
</div>

<h2 id="скрипт">
  <a class="link-body-emphasis" href="#%d1%81%d0%ba%d1%80%d0%b8%d0%bf%d1%82">Скрипт</a>
</h2>

    <div class="shortcode shortcode-gh-repo mb-3">
      <div class="row row-cols-1 row-cols-lg-2 g-3">
          
            <div class="col gh-repo" data-repos="pkgstore/pwsh-ffmpeg">
              <div class="card">
                <div class="row g-0">
                  <div class="col-md-4 p-1">
                    <a class="d-block gh-repo-avatar"
                       href="https://github.com/pkgstore/pwsh-ffmpeg" target="_blank"
                       rel="noopener noreferrer nofollow">
                      <img class="card-img gh-repo-avatar"
                           src="https://github.com/identicons/pkgstore.png"
                           alt="pkgstore/pwsh-ffmpeg" loading="lazy"/>
                    </a>
                  </div>
                  <div class="col">
                    <div class="card-body h-100">
                      <div class="d-flex flex-column h-100">
                        <div class="flex-shrink-0">
                          <h5 class="card-title">
                            <a class="gh-repo-name"
                               href="https://github.com/pkgstore/pwsh-ffmpeg" target="_blank"
                               rel="noopener noreferrer nofollow">pkgstore/pwsh-ffmpeg</a>
                          </h5>
                          <h6 class="card-subtitle mb-2 text-body-secondary gh-repo-owner"></h6>
                          <p class="card-text gh-repo-description"></p>
                        </div>
                        <div class="mt-auto">
                          <div class="row row-cols-auto g-2 mt-3">
                            <div class="col">
                              <div class="btn btn-light btn-sm"
                                   title='Язык разработки'>
                                <i class="fas fa-code fa-fw me-1"></i>
                                <span class="gh-repo-language">#</span>
                              </div>
                            </div>
                            <div class="col">
                              <div class="btn btn-light btn-sm"
                                   title='Подписки'>
                                <i class="fas fa-eye fa-fw me-1"></i>
                                <span class="gh-repo-subscribers">#</span>
                              </div>
                            </div>
                            <div class="col">
                              <div class="btn btn-light btn-sm"
                                   title='Звёзды'>
                                <i class="fas fa-star fa-fw me-1"></i>
                                <span class="gh-repo-stars">#</span>
                              </div>
                            </div>
                            <div class="col">
                              <div class="btn btn-light btn-sm"
                                   title='Вилки'>
                                <i class="fas fa-code-branch fa-fw me-1"></i>
                                <span class="gh-repo-forks">#</span>
                              </div>
                            </div>
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          
      </div>
    </div>]]></turbo:content></item><item turbo="true"><title>PowerShell: Определение разрядности ОС Windows</title><link>https://lib.onl/ru/2023/10/0028821e-c96c-5014-a1dd-8963c161b170/</link><pubDate>Sat, 21 Oct 2023 17:42:05 +0000</pubDate><dc:creator>Kai Kimera</dc:creator><category>MS Windows</category><category>Терминал</category><yandex:related><link url="https://lib.onl/ru/2023/10/4c7aba7c-f5a6-589a-9975-fdb16f2e2862/">PowerShell Vault</link><link url="https://lib.onl/ru/2023/10/eb39e3f7-b194-53d4-8bad-01edf9fdac47/">Дефрагментация в ОС Windows</link><link url="https://lib.onl/ru/2023/10/75075788-9308-56b7-b531-2008cb35f7d0/">Установка сертификата НУЦ Минцифры</link><link url="https://lib.onl/ru/2022/05/36058650-3f35-5ed5-9565-0aa7d8800c28/">Windows Server 2022 для рабочей станции</link></yandex:related><turbo:extendedHtml>true</turbo:extendedHtml><turbo:source>https://lib.onl/ru/2023/10/0028821e-c96c-5014-a1dd-8963c161b170/</turbo:source><turbo:topic>PowerShell: Определение разрядности ОС Windows</turbo:topic><turbo:content><![CDATA[<p>Нашёл на Stack Overflow хорошую функцию по определению разрядности ОС и процесса <span class="shortcode shortcode-tag"><a href="/ru/tags/powershell/" target="_blank">#PowerShell</a></span>. Запишу, обязательно пригодится.</p>
<h2 id="разрядность-ос">
  <a class="link-body-emphasis" href="#%d1%80%d0%b0%d0%b7%d1%80%d1%8f%d0%b4%d0%bd%d0%be%d1%81%d1%82%d1%8c-%d0%be%d1%81">Разрядность ОС</a>
</h2><p>Разрядность ОС можно определить следующей функцией:</p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-0
shortcode-codeblock-powershell">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-721e01ed3592d7e121025d12cdb7d058" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-powershell" data-lang="powershell"><span class="line"><span class="cl"><span class="kd">function</span><span class="w"> </span><span class="nb">Get-Architecture</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="c"># What bitness does Windows use.</span>
</span></span><span class="line"><span class="cl">  <span class="k">switch</span> <span class="p">([</span><span class="no">Environment</span><span class="p">]::</span><span class="n">Is64BitOperatingSystem</span><span class="p">)</span> <span class="p">{</span> <span class="c"># Needs &#39;.NET 4&#39;.</span>
</span></span><span class="line"><span class="cl">    <span class="vm">$true</span>   <span class="p">{</span> <span class="mf">64</span><span class="p">;</span> <span class="k">break</span> <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="vm">$false</span>  <span class="p">{</span> <span class="mf">32</span><span class="p">;</span> <span class="k">break</span> <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="k">default</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="p">(</span><span class="nb">Get-WmiObject</span> <span class="n">-Class</span> <span class="n">Win32_OperatingSystem</span><span class="p">).</span><span class="py">OSArchitecture</span> <span class="o">-replace</span> <span class="s1">&#39;\D&#39;</span>
</span></span><span class="line"><span class="cl">      <span class="c"># Or do any of these:</span>
</span></span><span class="line"><span class="cl">      <span class="c"># (Get-WmiObject -Class Win32_ComputerSystem).SystemType -replace &#39;\D&#39; -replace &#39;86&#39;, &#39;32&#39;</span>
</span></span><span class="line"><span class="cl">      <span class="c"># (Get-WmiObject -Class Win32_Processor).AddressWidth # This is slow...</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-721e01ed3592d7e121025d12cdb7d058"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<p>Можно записать эту функцию в файл и запустить файл в терминале, или же внедрить в крупный проект и вызывать по имени <code>Get-Architecture</code>.</p>
<h3 id="результат">
  <a class="link-body-emphasis" href="#%d1%80%d0%b5%d0%b7%d1%83%d0%bb%d1%8c%d1%82%d0%b0%d1%82">Результат</a>
</h3>










<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-1 shortcode-codeblock-terminal
shortcode-codeblock-terminal-windows
shortcode-codeblock-terminal-windows-user">
  <div class="card overflow-hidden" data-bs-theme="dark">
    <div class="card-header">
      <div class="d-flex align-items-center">
        <div class="flex-shrink-0 ">
          <i class="fas fa-terminal fa-fw"></i>
        </div>
        <div class="flex-grow-1 mx-2">
          <h5 class="mb-0">Терминал</h5>
        </div>
        <div class="flex-shrink-0">
          <ul class="list-inline mb-0">
            <li class="list-inline-item" title='Копировать'>
              <a class="text-body" href="#"
                 data-fn="clipboard" data-clipboard-target="#cp-6dd951b1073f6c8cacef144ed46eb899"
                 role="button" aria-label='Копировать'>
                <i class="fas fa-copy fa-fw"></i>
              </a>
            </li>
          </ul>
        </div>
      </div>
    </div>
    <div class="card-body p-0 overflow-auto" id="cp-6dd951b1073f6c8cacef144ed46eb899"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-plaintext" data-lang="plaintext"><span class="line"><span class="cl">.\arch.ps1
</span></span><span class="line"><span class="cl">64</span></span></code></pre></td></tr></table>
</div>
</div></div>
  </div>
</div>
<h2 id="разрядность-ос-и-powershell">
  <a class="link-body-emphasis" href="#%d1%80%d0%b0%d0%b7%d1%80%d1%8f%d0%b4%d0%bd%d0%be%d1%81%d1%82%d1%8c-%d0%be%d1%81-%d0%b8-powershell">Разрядность ОС и PowerShell</a>
</h2><p>Расширенная версия, которая позволяет определить разрядность ОС и процесса PowerShell, под которым выполняется функция.</p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-2
shortcode-codeblock-powershell">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-1428bcdff3f666a2412e588a43355931" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-powershell" data-lang="powershell"><span class="line"><span class="cl"><span class="kd">function</span><span class="w"> </span><span class="nb">Get-Architecture</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="c"># What bitness does Windows use.</span>
</span></span><span class="line"><span class="cl">  <span class="nv">$windowsBitness</span> <span class="p">=</span> <span class="k">switch</span> <span class="p">([</span><span class="no">Environment</span><span class="p">]::</span><span class="n">Is64BitOperatingSystem</span><span class="p">)</span> <span class="p">{</span> <span class="c"># Needs &#39;.NET 4&#39;.</span>
</span></span><span class="line"><span class="cl">    <span class="vm">$true</span>   <span class="p">{</span> <span class="mf">64</span><span class="p">;</span> <span class="k">break</span> <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="vm">$false</span>  <span class="p">{</span> <span class="mf">32</span><span class="p">;</span> <span class="k">break</span> <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="k">default</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="p">(</span><span class="nb">Get-WmiObject</span> <span class="n">-Class</span> <span class="n">Win32_OperatingSystem</span><span class="p">).</span><span class="py">OSArchitecture</span> <span class="o">-replace</span> <span class="s1">&#39;\D&#39;</span>
</span></span><span class="line"><span class="cl">      <span class="c"># Or do any of these:</span>
</span></span><span class="line"><span class="cl">      <span class="c"># (Get-WmiObject -Class Win32_ComputerSystem).SystemType -replace &#39;\D&#39; -replace &#39;86&#39;, &#39;32&#39;</span>
</span></span><span class="line"><span class="cl">      <span class="c"># (Get-WmiObject -Class Win32_Processor).AddressWidth # Slow...</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="c"># What bitness does this PowerShell process use.</span>
</span></span><span class="line"><span class="cl">  <span class="nv">$processBitness</span> <span class="p">=</span> <span class="p">[</span><span class="no">IntPtr</span><span class="p">]::</span><span class="n">Size</span> <span class="p">*</span> <span class="mf">8</span>
</span></span><span class="line"><span class="cl">  <span class="c"># Or do any of these:</span>
</span></span><span class="line"><span class="cl">  <span class="c"># $processBitness = $env:PROCESSOR_ARCHITECTURE -replace &#39;\D&#39; -replace &#39;86|ARM&#39;, &#39;32&#39;</span>
</span></span><span class="line"><span class="cl">  <span class="c"># $processBitness = if ([Environment]::Is64BitProcess) { 64 } else { 32 }</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="c"># Return the info as object.</span>
</span></span><span class="line"><span class="cl">  <span class="nb">New-Object</span> <span class="n">-TypeName</span> <span class="n">PSObject</span> <span class="n">-Property</span> <span class="vm">@</span><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="s1">&#39;ProcessArchitecture&#39;</span> <span class="p">=</span> <span class="s2">&#34;{0} bit&#34;</span> <span class="o">-f</span> <span class="nv">$processBitness</span>
</span></span><span class="line"><span class="cl">    <span class="s1">&#39;WindowsArchitecture&#39;</span> <span class="p">=</span> <span class="s2">&#34;{0} bit&#34;</span> <span class="o">-f</span> <span class="nv">$windowsBitness</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-1428bcdff3f666a2412e588a43355931"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<p>Можно записать эту функцию в файл и запустить файл в терминале, или же внедрить в крупный проект и вызывать по имени <code>Get-Architecture</code>.</p>
<h3 id="результат-1">
  <a class="link-body-emphasis" href="#%d1%80%d0%b5%d0%b7%d1%83%d0%bb%d1%8c%d1%82%d0%b0%d1%82-1">Результат</a>
</h3>










<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-3 shortcode-codeblock-terminal
shortcode-codeblock-terminal-windows
shortcode-codeblock-terminal-windows-user">
  <div class="card overflow-hidden" data-bs-theme="dark">
    <div class="card-header">
      <div class="d-flex align-items-center">
        <div class="flex-shrink-0 ">
          <i class="fas fa-terminal fa-fw"></i>
        </div>
        <div class="flex-grow-1 mx-2">
          <h5 class="mb-0">Терминал</h5>
        </div>
        <div class="flex-shrink-0">
          <ul class="list-inline mb-0">
            <li class="list-inline-item" title='Копировать'>
              <a class="text-body" href="#"
                 data-fn="clipboard" data-clipboard-target="#cp-07b4c7cb0ba2edc4a97b1636ffa44c13"
                 role="button" aria-label='Копировать'>
                <i class="fas fa-copy fa-fw"></i>
              </a>
            </li>
          </ul>
        </div>
      </div>
    </div>
    <div class="card-body p-0 overflow-auto" id="cp-07b4c7cb0ba2edc4a97b1636ffa44c13"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-plaintext" data-lang="plaintext"><span class="line"><span class="cl">.\arch.ps1
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">ProcessArchitecture WindowsArchitecture
</span></span><span class="line"><span class="cl">------------------- -------------------
</span></span><span class="line"><span class="cl">64 bit              64 bit</span></span></code></pre></td></tr></table>
</div>
</div></div>
  </div>
</div>]]></turbo:content></item><item turbo="true"><title>PowerShell Vault</title><link>https://lib.onl/ru/2023/10/4c7aba7c-f5a6-589a-9975-fdb16f2e2862/</link><pubDate>Fri, 20 Oct 2023 09:57:21 +0000</pubDate><dc:creator>Kai Kimera</dc:creator><category>MS Windows</category><category>Терминал</category><category>Скрипты</category><yandex:related><link url="https://lib.onl/ru/2023/10/eb39e3f7-b194-53d4-8bad-01edf9fdac47/">Дефрагментация в ОС Windows</link><link url="https://lib.onl/ru/2023/10/75075788-9308-56b7-b531-2008cb35f7d0/">Установка сертификата НУЦ Минцифры</link><link url="https://lib.onl/ru/2022/05/36058650-3f35-5ed5-9565-0aa7d8800c28/">Windows Server 2022 для рабочей станции</link></yandex:related><turbo:extendedHtml>true</turbo:extendedHtml><turbo:source>https://lib.onl/ru/2023/10/4c7aba7c-f5a6-589a-9975-fdb16f2e2862/</turbo:source><turbo:topic>PowerShell Vault</turbo:topic><turbo:content><![CDATA[<p>На работе в локальной сети использовалась задача, которая перемещала старые, по долгу не использовавшиеся, файлы из главного файлового хранилища в резервное. Но так как организация являлась проектной, то старые файлы могли понадобиться в любое время.</p>
<p>Задача использовала простой скрипт с фильтрацией файлов по параметрам <em>время создания</em> и <em>время изменения</em>. Я чуть доработали скрипт и решил опубликовать его для других администраторов. Вдруг, пригодится. Только перед использованием прошу проверить скрипт в какой-нибудь песочнице.</p>




    












    
    


<div class="shortcode shortcode-alert">
  <div class="alert alert-danger d-flex overflow-hidden" role="alert">
    <div class="flex-shrink-0 align-self-center">
      <i class="fas fa-circle-radiation fa-fw fa-2x"></i>
    </div>
    <div class="flex-grow-1 ms-3 overflow-hidden">
        <p>Есть вероятность, что скрипт удалит все файлы в вашем файловом хранилище, из-за того, что автор может оказаться <em>рукожопом</em>! Поэтому, перед боевой задачей, проверьте скрипт в какой-нибудь песочнице. А кто хорошо разбирается в PowerShell - автор будет благодарен за оптимизацию и корректировку скрипта.</p>

    </div>
  </div>
</div>

<h2 id="параметры">
  <a class="link-body-emphasis" href="#%d0%bf%d0%b0%d1%80%d0%b0%d0%bc%d0%b5%d1%82%d1%80%d1%8b">Параметры</a>
</h2><ul>
<li><code>-M</code> <code>-Mode</code> - режим работы скрипта. По умолчанию <code>'MV'</code>.
<ul>
<li><code>'CP'</code> - копировать файлы из источника в хранилище.</li>
<li><code>'MV'</code> - перемещать файлы из источника в хранилище.</li>
<li><code>'RM'</code> - только удалять файлы из источника без копирования или перемещения куда-либо.</li>
</ul>
</li>
<li><code>-SRC</code> <code>-Source</code> - путь к директории откуда перемещать файлы. Например, <code>-SRC 'C:\Data\Source'</code>. По умолчанию: <code>${PSScriptRoot}\Source</code>.</li>
<li><code>-DST</code> <code>-Vault</code> - путь к директории куда перемещать файлы. Например, <code>-DST 'C:\Data\Vault'</code>. По умолчанию: <code>${PSScriptRoot}\Vault</code>.</li>
<li><code>-CT</code> <code>-CreationTime</code> - время создания файла в секундах. Например, <code>-CT 5270400</code>. По умолчанию: <code>5270400</code> (61 день).</li>
<li><code>-WT</code> <code>-LastWriteTime</code> - время изменения файла в секундах. Например, <code>-WT 5270400</code>. По умолчанию: <code>${P_CreationTime}</code>.</li>
<li><code>-FS</code> <code>-FileSize</code> - размер файла. Например, <code>-FS '5kb'</code> или <code>-FS '12mb'</code>. По умолчанию: <code>'0kb'</code>.</li>
<li><code>-E</code> <code>-Exclude</code> - путь к файлу с исключениями. Например, <code>-E 'C:\Data\exclude.txt'</code>. По умолчанию: <code>${PSScriptRoot}\vault.exclude.txt</code>.</li>
<li><code>-L</code> <code>-Logs</code> - путь к директории с журналами работы скрипта. Например, <code>-L 'C:\Data\Logs'</code>. По умолчанию: <code>${PSScriptRoot}\Logs</code>.</li>
<li><code>-RD</code> <code>-RemoveDirs</code> - удалять пустые каталоги.</li>
<li><code>-O</code> <code>-Overwrite</code> - перезаписать файлы в Vault.</li>
</ul>
<h2 id="примеры">
  <a class="link-body-emphasis" href="#%d0%bf%d1%80%d0%b8%d0%bc%d0%b5%d1%80%d1%8b">Примеры</a>
</h2><p>Запустить перемещение файлов из <code>Source</code> в <code>Vault</code> с сохранением структуры директорий:</p>











<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-0 shortcode-codeblock-terminal
shortcode-codeblock-terminal-windows
shortcode-codeblock-terminal-windows-user">
  <div class="card overflow-hidden" data-bs-theme="dark">
    <div class="card-header">
      <div class="d-flex align-items-center">
        <div class="flex-shrink-0 ">
          <i class="fas fa-terminal fa-fw"></i>
        </div>
        <div class="flex-grow-1 mx-2">
          <h5 class="mb-0">Терминал</h5>
        </div>
        <div class="flex-shrink-0">
          <ul class="list-inline mb-0">
            <li class="list-inline-item" title='Копировать'>
              <a class="text-body" href="#"
                 data-fn="clipboard" data-clipboard-target="#cp-e163e8dbf679aa9d0067447f07f5a77a"
                 role="button" aria-label='Копировать'>
                <i class="fas fa-copy fa-fw"></i>
              </a>
            </li>
          </ul>
        </div>
      </div>
    </div>
    <div class="card-body p-0 overflow-auto" id="cp-e163e8dbf679aa9d0067447f07f5a77a"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-plaintext" data-lang="plaintext"><span class="line"><span class="cl">Start-Vault -SRC &#39;C:\Data\Source&#39; -DST &#39;C:\Data\Vault&#39;</span></span></code></pre></td></tr></table>
</div>
</div></div>
  </div>
</div>
<p>Запустить перемещение файлов с временем создания и изменения от 10 дней (<code>864000</code>) из <code>Source</code> в <code>Vault</code> с сохранением структуры директорий:</p>











<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-1 shortcode-codeblock-terminal
shortcode-codeblock-terminal-windows
shortcode-codeblock-terminal-windows-user">
  <div class="card overflow-hidden" data-bs-theme="dark">
    <div class="card-header">
      <div class="d-flex align-items-center">
        <div class="flex-shrink-0 ">
          <i class="fas fa-terminal fa-fw"></i>
        </div>
        <div class="flex-grow-1 mx-2">
          <h5 class="mb-0">Терминал</h5>
        </div>
        <div class="flex-shrink-0">
          <ul class="list-inline mb-0">
            <li class="list-inline-item" title='Копировать'>
              <a class="text-body" href="#"
                 data-fn="clipboard" data-clipboard-target="#cp-88534336075495e6fe1c149fafc3b15f"
                 role="button" aria-label='Копировать'>
                <i class="fas fa-copy fa-fw"></i>
              </a>
            </li>
          </ul>
        </div>
      </div>
    </div>
    <div class="card-body p-0 overflow-auto" id="cp-88534336075495e6fe1c149fafc3b15f"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-plaintext" data-lang="plaintext"><span class="line"><span class="cl">Start-Vault -SRC &#39;C:\Data\Source&#39; -DST &#39;C:\Data\Vault&#39; -CT &#39;864000&#39; -WT &#39;864000&#39;</span></span></code></pre></td></tr></table>
</div>
</div></div>
  </div>
</div>
<p>Запустить перемещение файлов с временем создания и изменения от 10 дней (<code>864000</code>) и размером более 32 мегабайта (<code>32mb</code>) из <code>Source</code> в <code>Vault</code> с сохранением структуры директорий:</p>











<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-2 shortcode-codeblock-terminal
shortcode-codeblock-terminal-windows
shortcode-codeblock-terminal-windows-user">
  <div class="card overflow-hidden" data-bs-theme="dark">
    <div class="card-header">
      <div class="d-flex align-items-center">
        <div class="flex-shrink-0 ">
          <i class="fas fa-terminal fa-fw"></i>
        </div>
        <div class="flex-grow-1 mx-2">
          <h5 class="mb-0">Терминал</h5>
        </div>
        <div class="flex-shrink-0">
          <ul class="list-inline mb-0">
            <li class="list-inline-item" title='Копировать'>
              <a class="text-body" href="#"
                 data-fn="clipboard" data-clipboard-target="#cp-10fc0dec094c57f71c4662457cb207bf"
                 role="button" aria-label='Копировать'>
                <i class="fas fa-copy fa-fw"></i>
              </a>
            </li>
          </ul>
        </div>
      </div>
    </div>
    <div class="card-body p-0 overflow-auto" id="cp-10fc0dec094c57f71c4662457cb207bf"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-plaintext" data-lang="plaintext"><span class="line"><span class="cl">Start-Vault -SRC &#39;C:\Data\Source&#39; -DST &#39;C:\Data\Vault&#39; -CT &#39;864000&#39; -WT &#39;864000&#39; -FS &#39;32mb&#39;</span></span></code></pre></td></tr></table>
</div>
</div></div>
  </div>
</div>
<p>Запустить перемещение файлов с временем создания и изменения от 10 дней (<code>864000</code>), и с перезаписью файлов с одинаковыми названиями (<code>-O</code>) из <code>Source</code> в <code>Vault</code> с сохранением структуры директорий:</p>











<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-3 shortcode-codeblock-terminal
shortcode-codeblock-terminal-windows
shortcode-codeblock-terminal-windows-user">
  <div class="card overflow-hidden" data-bs-theme="dark">
    <div class="card-header">
      <div class="d-flex align-items-center">
        <div class="flex-shrink-0 ">
          <i class="fas fa-terminal fa-fw"></i>
        </div>
        <div class="flex-grow-1 mx-2">
          <h5 class="mb-0">Терминал</h5>
        </div>
        <div class="flex-shrink-0">
          <ul class="list-inline mb-0">
            <li class="list-inline-item" title='Копировать'>
              <a class="text-body" href="#"
                 data-fn="clipboard" data-clipboard-target="#cp-0f4aee34851454873f6105ec681d8a4d"
                 role="button" aria-label='Копировать'>
                <i class="fas fa-copy fa-fw"></i>
              </a>
            </li>
          </ul>
        </div>
      </div>
    </div>
    <div class="card-body p-0 overflow-auto" id="cp-0f4aee34851454873f6105ec681d8a4d"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-plaintext" data-lang="plaintext"><span class="line"><span class="cl">Start-Vault -SRC &#39;C:\Data\Source&#39; -DST &#39;C:\Data\Vault&#39; -CT &#39;864000&#39; -WT &#39;864000&#39; -O</span></span></code></pre></td></tr></table>
</div>
</div></div>
  </div>
</div>
<p>Параметр <code>-O</code> означает, что не нужно архивировать старый файл при перемещении нового с таким же названием. Старый файл в хранилище перезапишется новым.</p>
<h2 id="алгоритм-работы">
  <a class="link-body-emphasis" href="#%d0%b0%d0%bb%d0%b3%d0%be%d1%80%d0%b8%d1%82%d0%bc-%d1%80%d0%b0%d0%b1%d0%be%d1%82%d1%8b">Алгоритм работы</a>
</h2><p>Скрипт создаёт хранилище старых файлов. Это, своего рода, аналог резервного копирования. При перемещении файлов из источника в хранилище, скрипт обрабатывает несколько заданных параметров и фильтров. Всё настроить можно под себя. По умолчанию, скрипт перемещает файлы из источника в хранилище, и если в хранилище уже имеется старый файл с названием кау у нового перемещаемого, то старый файл архивируется с меткой <code>.[UnixTime].7z</code>.</p>




    








    
    






<div class="shortcode shortcode-alert">
  <div class="alert alert-warning d-flex overflow-hidden" role="alert">
    <div class="flex-shrink-0 align-self-center">
      <i class="fas fa-exclamation-triangle fa-fw fa-2x"></i>
    </div>
    <div class="flex-grow-1 ms-3 overflow-hidden">
        <p>Для работы скрипта необходим архиватор <strong>7-Zip</strong>, а конкретно его облегчённая версия <code>7za.exe</code> с библиотеками из <strong>7-Zip Extra</strong>. Скачать можно с <a title="" href="https://www.7-zip.org/download.html" target="_blank"
   rel="noopener noreferrer">официального сайта</a>. После скачивания архива, файлы <code>7za.exe</code>, <code>7za.dll</code> и <code>7zxa.dll</code> нужно разместить рядом со скриптом, или в любую дочернюю директорию. Скрипт сам найдёт путь к <code>7za.exe</code>.</p>

    </div>
  </div>
</div>

<h2 id="скрипт">
  <a class="link-body-emphasis" href="#%d1%81%d0%ba%d1%80%d0%b8%d0%bf%d1%82">Скрипт</a>
</h2>

    <div class="shortcode shortcode-gh-repo mb-3">
      <div class="row row-cols-1 row-cols-lg-2 g-3">
          
            <div class="col gh-repo" data-repos="pkgstore/pwsh-vault">
              <div class="card">
                <div class="row g-0">
                  <div class="col-md-4 p-1">
                    <a class="d-block gh-repo-avatar"
                       href="https://github.com/pkgstore/pwsh-vault" target="_blank"
                       rel="noopener noreferrer nofollow">
                      <img class="card-img gh-repo-avatar"
                           src="https://github.com/identicons/pkgstore.png"
                           alt="pkgstore/pwsh-vault" loading="lazy"/>
                    </a>
                  </div>
                  <div class="col">
                    <div class="card-body h-100">
                      <div class="d-flex flex-column h-100">
                        <div class="flex-shrink-0">
                          <h5 class="card-title">
                            <a class="gh-repo-name"
                               href="https://github.com/pkgstore/pwsh-vault" target="_blank"
                               rel="noopener noreferrer nofollow">pkgstore/pwsh-vault</a>
                          </h5>
                          <h6 class="card-subtitle mb-2 text-body-secondary gh-repo-owner"></h6>
                          <p class="card-text gh-repo-description"></p>
                        </div>
                        <div class="mt-auto">
                          <div class="row row-cols-auto g-2 mt-3">
                            <div class="col">
                              <div class="btn btn-light btn-sm"
                                   title='Язык разработки'>
                                <i class="fas fa-code fa-fw me-1"></i>
                                <span class="gh-repo-language">#</span>
                              </div>
                            </div>
                            <div class="col">
                              <div class="btn btn-light btn-sm"
                                   title='Подписки'>
                                <i class="fas fa-eye fa-fw me-1"></i>
                                <span class="gh-repo-subscribers">#</span>
                              </div>
                            </div>
                            <div class="col">
                              <div class="btn btn-light btn-sm"
                                   title='Звёзды'>
                                <i class="fas fa-star fa-fw me-1"></i>
                                <span class="gh-repo-stars">#</span>
                              </div>
                            </div>
                            <div class="col">
                              <div class="btn btn-light btn-sm"
                                   title='Вилки'>
                                <i class="fas fa-code-branch fa-fw me-1"></i>
                                <span class="gh-repo-forks">#</span>
                              </div>
                            </div>
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          
      </div>
    </div>]]></turbo:content></item><item turbo="true"><title>Дефрагментация в ОС Windows</title><link>https://lib.onl/ru/2023/10/eb39e3f7-b194-53d4-8bad-01edf9fdac47/</link><pubDate>Fri, 20 Oct 2023 00:46:16 +0000</pubDate><dc:creator>Kai Kimera</dc:creator><category>MS Windows</category><category>Терминал</category><yandex:related><link url="https://lib.onl/ru/2023/10/75075788-9308-56b7-b531-2008cb35f7d0/">Установка сертификата НУЦ Минцифры</link><link url="https://lib.onl/ru/2023/09/dd5a3e1a-596b-50d5-b070-b2a065f99f32/">Получение и установка MS Office 2021 LTSC</link><link url="https://lib.onl/ru/2022/05/862226e6-cbb1-58f8-bc8e-0cfef747f475/">Интеграция обновлений в дистрибутив ОС MS Windows</link><link url="https://lib.onl/ru/2022/05/36058650-3f35-5ed5-9565-0aa7d8800c28/">Windows Server 2022 для рабочей станции</link></yandex:related><turbo:extendedHtml>true</turbo:extendedHtml><turbo:source>https://lib.onl/ru/2023/10/eb39e3f7-b194-53d4-8bad-01edf9fdac47/</turbo:source><turbo:topic>Дефрагментация в ОС Windows</turbo:topic><turbo:content><![CDATA[<p>При работе с оборудованием, мне приходится сталкиваться с довольно старыми устройствами, их их работу нужно как-нибудь оптимизировать. Одним из вариантов оптимизации является дефрагментация <span class="shortcode shortcode-tag"><a href="/ru/tags/hdd/" target="_blank">#HDD</a></span>.</p>
<h2 id="powershell">
  <a class="link-body-emphasis" href="#powershell">PowerShell</a>
</h2><p>Командлет по дефрагментации для <span class="shortcode shortcode-tag"><a href="/ru/tags/powershell/" target="_blank">#PowerShell</a></span> называется <code>Optimize-Volume</code> и может принимать следующие параметры:</p>
<ul>
<li><code>-Analyze</code> - выполнение анализа указанного тома.</li>
<li><code>-Defrag</code> - выполнение дефрагментации указанного тома.</li>
<li><code>-DriveLetter</code> - буква тома.</li>
<li><code>-NormalPriority</code> - выполнение процесса с нормальным приоритетом (по умолчанию приоритет пониженный).</li>
<li><code>-ReTrim</code> - выполнение TRIM-операции для <span class="shortcode shortcode-tag"><a href="/ru/tags/ssd/" target="_blank">#SSD</a></span>.</li>
</ul>
<p>Это наиболее востребованные параметры. Остальные параметры можно посмотреть в <a title="" href="https://learn.microsoft.com/en-us/powershell/module/storage/optimize-volume" target="_blank"
   rel="noopener noreferrer">официальной документации</a>.</p>




    










    
    




<div class="shortcode shortcode-alert">
  <div class="alert alert-success d-flex overflow-hidden" role="alert">
    <div class="flex-shrink-0 align-self-center">
      <i class="fas fa-lightbulb fa-fw fa-2x"></i>
    </div>
    <div class="flex-grow-1 ms-3 overflow-hidden">
        <p>Для всех команд можно добавить параметр <code>-Verbose</code>, который выводит подробную информацию о происходящем процессе.</p>

    </div>
  </div>
</div>

<h3 id="анализ-тома">
  <a class="link-body-emphasis" href="#%d0%b0%d0%bd%d0%b0%d0%bb%d0%b8%d0%b7-%d1%82%d0%be%d0%bc%d0%b0">Анализ тома</a>
</h3>








  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-0
shortcode-codeblock-powershell">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-75156109d6d52fc80b0d228f4dfff5af" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-powershell" data-lang="powershell"><span class="line"><span class="cl"><span class="nb">Optimize-Volume</span> <span class="n">-DriveLetter</span> <span class="n">C</span> <span class="n">-Analyze</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-75156109d6d52fc80b0d228f4dfff5af"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<p>Где:</p>
<ul>
<li><code>-DriveLetter C</code> - буква тома (диск C:).</li>
<li><code>-Analyze</code> - анализ.</li>
</ul>
<h3 id="дефрагментация">
  <a class="link-body-emphasis" href="#%d0%b4%d0%b5%d1%84%d1%80%d0%b0%d0%b3%d0%bc%d0%b5%d0%bd%d1%82%d0%b0%d1%86%d0%b8%d1%8f">Дефрагментация</a>
</h3>








  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-1
shortcode-codeblock-powershell">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-3c4d91cff140010431fc0178e6b4dcaf" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-powershell" data-lang="powershell"><span class="line"><span class="cl"><span class="nb">Optimize-Volume</span> <span class="n">-DriveLetter</span> <span class="n">C</span> <span class="n">-Defrag</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-3c4d91cff140010431fc0178e6b4dcaf"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<p>Где:</p>
<ul>
<li><code>-DriveLetter C</code> - буква тома (диск C:).</li>
<li><code>-Defrag</code> - дефрагментация.</li>
</ul>
<h3 id="trim-операция-для-ssd">
  <a class="link-body-emphasis" href="#trim-%d0%be%d0%bf%d0%b5%d1%80%d0%b0%d1%86%d0%b8%d1%8f-%d0%b4%d0%bb%d1%8f-ssd">TRIM-операция для SSD</a>
</h3>








  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-2
shortcode-codeblock-powershell">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-c6e10cda7bc6cdf716821ee306b4620a" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-powershell" data-lang="powershell"><span class="line"><span class="cl"><span class="nb">Optimize-Volume</span> <span class="n">-DriveLetter</span> <span class="n">C</span> <span class="n">-ReTrim</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-c6e10cda7bc6cdf716821ee306b4620a"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<p>Где:</p>
<ul>
<li><code>-DriveLetter C</code> - буква тома (диск C:).</li>
<li><code>-ReTrim</code> - на дисках SSD запускает TRIM-операцию.</li>
</ul>
<h2 id="cmd-defrag">
  <a class="link-body-emphasis" href="#cmd-defrag">CMD Defrag</a>
</h2><p>Утилита <code>defrag.exe</code> выполняет анализ и оптимизацию томов через командную строку. Утилита может принимать следующие параметры:</p>
<ul>
<li>Тома:
<ul>
<li><code>/c</code> - выполнение операции на всех томах.</li>
<li><code>/e</code> - выполнение операции на всех томах, кроме указанных.</li>
</ul>
</li>
<li>Операции:
<ul>
<li><code>/a</code> - анализ указанных томов.</li>
<li><code>/d</code> - выполнение традиционной дефрагментации (по умолчанию). На многоуровневом томе традиционная дефрагментация выполняется только на уровне ёмкости.</li>
<li><code>/l</code> - выполнение TRIM-операции для SSD.</li>
<li><code>/o</code> - выполнение правильной оптимизации для каждого типа носителя.</li>
<li><code>/u</code> - отображение хода операции.</li>
</ul>
</li>
</ul>




    










    
    




<div class="shortcode shortcode-alert">
  <div class="alert alert-success d-flex overflow-hidden" role="alert">
    <div class="flex-shrink-0 align-self-center">
      <i class="fas fa-lightbulb fa-fw fa-2x"></i>
    </div>
    <div class="flex-grow-1 ms-3 overflow-hidden">
        <p>Для всех команд можно добавить параметр <code>/v</code>, который выводит подробную информацию о происходящем процессе.</p>

    </div>
  </div>
</div>

<h3 id="анализ-тома-1">
  <a class="link-body-emphasis" href="#%d0%b0%d0%bd%d0%b0%d0%bb%d0%b8%d0%b7-%d1%82%d0%be%d0%bc%d0%b0-1">Анализ тома</a>
</h3><p>Анализ тома, с отображением хода выполнения и выводом результатов в подробном формате:</p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-3
shortcode-codeblock-cmd">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-dca51c71419a70933c21b5df440e0a3c" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-cmd" data-lang="cmd"><span class="line"><span class="cl">defrag c: /u /a</span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-dca51c71419a70933c21b5df440e0a3c"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<p>Где:</p>
<ul>
<li><code>c:</code> - буква тома (диск <code>C:</code>).</li>
<li><code>/u</code> - отображение хода выполнения операции.</li>
<li><code>/a</code> - анализ.</li>
</ul>
<h3 id="параллельная-дефрагментация">
  <a class="link-body-emphasis" href="#%d0%bf%d0%b0%d1%80%d0%b0%d0%bb%d0%bb%d0%b5%d0%bb%d1%8c%d0%bd%d0%b0%d1%8f-%d0%b4%d0%b5%d1%84%d1%80%d0%b0%d0%b3%d0%bc%d0%b5%d0%bd%d1%82%d0%b0%d1%86%d0%b8%d1%8f">Параллельная дефрагментация</a>
</h3><p>Параллельная дефрагментация томов <code>C:</code> и <code>D:</code> в фоновом режиме:</p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-4
shortcode-codeblock-cmd">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-e22b38e930ef053c6f457d1557df5da5" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-cmd" data-lang="cmd"><span class="line"><span class="cl">defrag c: d: /m</span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-e22b38e930ef053c6f457d1557df5da5"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<p>Где:</p>
<ul>
<li><code>c:</code> - буква тома (диск <code>C:</code>).</li>
<li><code>d:</code> - буква тома (диск <code>D:</code>).</li>
<li><code>/m</code> - выполнение операции с каждым томом параллельно в фоновом режиме.</li>
</ul>
<h3 id="дефрагментация-всех-томах">
  <a class="link-body-emphasis" href="#%d0%b4%d0%b5%d1%84%d1%80%d0%b0%d0%b3%d0%bc%d0%b5%d0%bd%d1%82%d0%b0%d1%86%d0%b8%d1%8f-%d0%b2%d1%81%d0%b5%d1%85-%d1%82%d0%be%d0%bc%d0%b0%d1%85">Дефрагментация всех томах</a>
</h3><p>Выполнить дефрагментацию на всех локальных томах с нормальным приоритетом:</p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-5
shortcode-codeblock-cmd">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-bf6f5968b538b9b5439dee205d386879" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-cmd" data-lang="cmd"><span class="line"><span class="cl">defrag /u /c /h</span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-bf6f5968b538b9b5439dee205d386879"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<p>Где:</p>
<ul>
<li><code>/u</code> - отображение хода выполнения операции.</li>
<li><code>/c</code> - выполнение операции на всех томах.</li>
<li><code>/h</code> - выполнение операции с нормальным приоритетом (по умолчанию приоритет пониженный).</li>
</ul>
<h3 id="trim-операция-для-ssd-1">
  <a class="link-body-emphasis" href="#trim-%d0%be%d0%bf%d0%b5%d1%80%d0%b0%d1%86%d0%b8%d1%8f-%d0%b4%d0%bb%d1%8f-ssd-1">TRIM-операция для SSD</a>
</h3>








  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-6
shortcode-codeblock-cmd">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-88ecd4e5c3de3a48efdb63065678b6f5" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-cmd" data-lang="cmd"><span class="line"><span class="cl">defrag /u /c /l</span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-88ecd4e5c3de3a48efdb63065678b6f5"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<p>Где:</p>
<ul>
<li><code>/u</code> - отображение хода выполнения операции.</li>
<li><code>/c</code> - выполнение операции на всех томах.</li>
<li><code>/l</code> или <code>/retrim</code> - на дисках SSD запускает TRIM-операцию.</li>
</ul>]]></turbo:content></item><item turbo="true"><title>MikroTik: Добавление корневых сертификатов в RouterOS</title><link>https://lib.onl/ru/2023/10/cc13623b-970c-5950-867e-168f9ba9025a/</link><pubDate>Thu, 19 Oct 2023 08:56:43 +0000</pubDate><dc:creator>Kai Kimera</dc:creator><category>Сеть</category><category>Безопасность</category><yandex:related><link url="https://lib.onl/ru/2020/07/ff2ae66e-8e14-5c4a-baa6-0cd2e59f6517/">MikroTik и CloudFlare: Динамический IP для домена</link></yandex:related><turbo:extendedHtml>true</turbo:extendedHtml><turbo:source>https://lib.onl/ru/2023/10/cc13623b-970c-5950-867e-168f9ba9025a/</turbo:source><turbo:topic>MikroTik: Добавление корневых сертификатов в RouterOS</turbo:topic><turbo:content><![CDATA[<p>Репозиторий корневых сертификатов необходим для того, чтобы <span class="shortcode shortcode-tag"><a href="/ru/tags/routeros/" target="_blank">#RouterOS</a></span> имела представление какие вообще центры сертификации существуют.</p>
<p>Если репозиторий заполнен корневыми сертификатами центров сертификации, <span class="shortcode shortcode-tag"><a href="/ru/tags/routeros/" target="_blank">#RouterOS</a></span> сможет проверять подлинность выданных этими центрами сертификатов, работать с DNS over HTTPS (<span class="shortcode shortcode-tag"><a href="/ru/tags/doh/" target="_blank">#DoH</a></span>) и делать другую работу, связанную с шифрованием данных.</p>
<h2 id="загрузка-базы-сертификатов">
  <a class="link-body-emphasis" href="#%d0%b7%d0%b0%d0%b3%d1%80%d1%83%d0%b7%d0%ba%d0%b0-%d0%b1%d0%b0%d0%b7%d1%8b-%d1%81%d0%b5%d1%80%d1%82%d0%b8%d1%84%d0%b8%d0%ba%d0%b0%d1%82%d0%be%d0%b2">Загрузка базы сертификатов</a>
</h2><p>Файл <a title="" href="https://curl.se/docs/caextract.html" target="_blank"
   rel="noopener noreferrer">cacert.pem</a> с сайта <a title="" href="https://curl.se/" target="_blank"
   rel="noopener noreferrer">curl.se</a> переодически обновляется и содержит в себе корневые сертификаты центров сертификации. Откроем терминал в <span class="shortcode shortcode-tag"><a href="/ru/tags/routeros/" target="_blank">#RouterOS</a></span> и скачаем сразу на роутер командой:</p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-0
shortcode-codeblock-text">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-3642f7cd26f1eca667b5eec6b8b2f6d7" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-text" data-lang="text"><span class="line"><span class="cl">/tool fetch url=&#34;https://curl.se/ca/cacert.pem&#34; dst-path=&#34;ros.cacert.pem&#34;</span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-3642f7cd26f1eca667b5eec6b8b2f6d7"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<p>Где:</p>
<ul>
<li><code>url</code> - URL файла, который необходимо скачать.</li>
<li><code>dst-path</code> - название, под которым файл сохранится на роутере. Я добавляю префикс <code>ros.</code>, чтобы знать, что этот файл важен для <span class="shortcode shortcode-tag"><a href="/ru/tags/routeros/" target="_blank">#RouterOS</a></span>.</li>
</ul>
<h2 id="импортирование-сертификатов-в-репозиторий">
  <a class="link-body-emphasis" href="#%d0%b8%d0%bc%d0%bf%d0%be%d1%80%d1%82%d0%b8%d1%80%d0%be%d0%b2%d0%b0%d0%bd%d0%b8%d0%b5-%d1%81%d0%b5%d1%80%d1%82%d0%b8%d1%84%d0%b8%d0%ba%d0%b0%d1%82%d0%be%d0%b2-%d0%b2-%d1%80%d0%b5%d0%bf%d0%be%d0%b7%d0%b8%d1%82%d0%be%d1%80%d0%b8%d0%b9">Импортирование сертификатов в репозиторий</a>
</h2><p>Теперь когда файл на роутере, нужно импортировать его содержимое в репозиторий сертификатов. Делается это следующей командой:</p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-1
shortcode-codeblock-text">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-93d49e96448ff1e77421e43dedd87b85" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-text" data-lang="text"><span class="line"><span class="cl">/certificate import file-name=&#34;ros.cacert.pem&#34; passphrase=&#34;&#34; name=&#34;CA&#34;</span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-93d49e96448ff1e77421e43dedd87b85"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<p>Где:</p>
<ul>
<li><code>file-name</code> - название файла на  роутере.</li>
<li><code>name</code> - название, под которым сертификаты будут обозначаться в репозитории сертификатов. Здесь я указываю <code>CA</code>, чтобы знать, что сертификаты импортировались вручную и представляют собой сертификаты CA. Вы можете ввести любое своё название, главное, чтобы оно для вас что-то обозначало.</li>
</ul>




    










    
    




<div class="shortcode shortcode-alert">
  <div class="alert alert-success d-flex overflow-hidden" role="alert">
    <div class="flex-shrink-0 align-self-center">
      <i class="fas fa-lightbulb fa-fw fa-2x"></i>
    </div>
    <div class="flex-grow-1 ms-3 overflow-hidden">
        <p>Параметр <code>name</code> можно не указывать, тогда при импорте сертификатов, RouterOS в этот параметр автоматически подставит название файла.</p>

    </div>
  </div>
</div>]]></turbo:content></item><item turbo="true"><title>Создание сертификатов при помощи OpenSSL</title><link>https://lib.onl/ru/2023/10/6733cb51-62a0-5ed9-b421-8f08c4e0cb18/</link><pubDate>Tue, 17 Oct 2023 23:42:31 +0000</pubDate><dc:creator>Kai Kimera</dc:creator><category>Терминал</category><category>Скрипты</category><category>Linux</category><yandex:related><link url="https://lib.onl/ru/2023/10/75075788-9308-56b7-b531-2008cb35f7d0/">Установка сертификата НУЦ Минцифры</link><link url="https://lib.onl/ru/2021/08/ca744dce-e607-52e6-9952-8ae04e052a5b/">Скрипт автоматического удаления устаревших файлов</link></yandex:related><turbo:extendedHtml>true</turbo:extendedHtml><turbo:source>https://lib.onl/ru/2023/10/6733cb51-62a0-5ed9-b421-8f08c4e0cb18/</turbo:source><turbo:topic>Создание сертификатов при помощи OpenSSL</turbo:topic><turbo:content><![CDATA[<p><span class="shortcode shortcode-tag"><a href="/ru/tags/openssl/" target="_blank">#OpenSSL</a></span> является библиотекой по работе с криптографией, но в этой статье я затрону только часть функций этого инструмента, а именно создание само-подписанных сертификатов.</p>
<h2 id="создание-центра-сертификации">
  <a class="link-body-emphasis" href="#%d1%81%d0%be%d0%b7%d0%b4%d0%b0%d0%bd%d0%b8%d0%b5-%d1%86%d0%b5%d0%bd%d1%82%d1%80%d0%b0-%d1%81%d0%b5%d1%80%d1%82%d0%b8%d1%84%d0%b8%d0%ba%d0%b0%d1%86%d0%b8%d0%b8">Создание центра сертификации</a>
</h2><p>При помощи корневого сертификата, мы будем подписывать сертификаты клиентские. Создаём сертификат центра сертификации&hellip;</p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-0
shortcode-codeblock-bash">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-83ba4d3f45fb80559234943e09b4ac4d" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">openssl ecparam -genkey -name <span class="s1">&#39;secp384r1&#39;</span> <span class="p">|</span> openssl ec -aes256 -out <span class="s2">&#34;_CA.key&#34;</span> <span class="o">&amp;&amp;</span> openssl req -new -sha384 -key <span class="s2">&#34;_CA.key&#34;</span> -out <span class="s2">&#34;_CA.csr&#34;</span> <span class="o">&amp;&amp;</span> openssl x509 -req -sha384 -days <span class="m">3650</span> -key <span class="s2">&#34;_CA.key&#34;</span> -in <span class="s2">&#34;_CA.csr&#34;</span> -out <span class="s2">&#34;_CA.crt&#34;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-83ba4d3f45fb80559234943e09b4ac4d"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<p>Где:</p>
<ul>
<li><code>-days '3650'</code> - количество дней, по прошествии которого сертификат центра сертификации станет недействительным.</li>
<li><code>'_CA.key'</code> - название создаваемого файла с ключом центра сертификации.</li>
<li><code>'_CA.crt'</code> - название создаваемого файла с сертификатом центра сертификации.</li>
</ul>
<h2 id="создание-клиентского-сертификата">
  <a class="link-body-emphasis" href="#%d1%81%d0%be%d0%b7%d0%b4%d0%b0%d0%bd%d0%b8%d0%b5-%d0%ba%d0%bb%d0%b8%d0%b5%d0%bd%d1%82%d1%81%d0%ba%d0%be%d0%b3%d0%be-%d1%81%d0%b5%d1%80%d1%82%d0%b8%d1%84%d0%b8%d0%ba%d0%b0%d1%82%d0%b0">Создание клиентского сертификата</a>
</h2><p>Как только будет готов корневой сертификат, можно приступать к выпуску клиентских сертификатов.</p>
<h3 id="создание-приватного-ключа">
  <a class="link-body-emphasis" href="#%d1%81%d0%be%d0%b7%d0%b4%d0%b0%d0%bd%d0%b8%d0%b5-%d0%bf%d1%80%d0%b8%d0%b2%d0%b0%d1%82%d0%bd%d0%be%d0%b3%d0%be-%d0%ba%d0%bb%d1%8e%d1%87%d0%b0">Создание приватного ключа</a>
</h3><p>Для начала создаём приватный ключ.</p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-1
shortcode-codeblock-bash">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-49318040d60f303cd4d58f6936d3120d" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">openssl ecparam -genkey -name <span class="s1">&#39;prime256v1&#39;</span> <span class="p">|</span> openssl ec -out <span class="s1">&#39;client.key&#39;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-49318040d60f303cd4d58f6936d3120d"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<p>Где:</p>
<ul>
<li><code>-out 'client.key'</code> - название создаваемого файла с клиентским приватным ключом.</li>
</ul>
<h3 id="создание-запроса-на-подпись-сертификата">
  <a class="link-body-emphasis" href="#%d1%81%d0%be%d0%b7%d0%b4%d0%b0%d0%bd%d0%b8%d0%b5-%d0%b7%d0%b0%d0%bf%d1%80%d0%be%d1%81%d0%b0-%d0%bd%d0%b0-%d0%bf%d0%be%d0%b4%d0%bf%d0%b8%d1%81%d1%8c-%d1%81%d0%b5%d1%80%d1%82%d0%b8%d1%84%d0%b8%d0%ba%d0%b0%d1%82%d0%b0">Создание запроса на подпись сертификата</a>
</h3><p>Выполняем запрос на сертификат.</p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-2
shortcode-codeblock-bash">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-ae5bc4bcd4c0740acaaa2296b37b0e4a" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">openssl req -new -key <span class="s1">&#39;client.key&#39;</span> -out <span class="s1">&#39;client.csr&#39;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-ae5bc4bcd4c0740acaaa2296b37b0e4a"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<p>Где:</p>
<ul>
<li><code>-key 'client.key'</code> - файл с приватным ключом клиентского сертификата.</li>
<li><code>-out 'client.csr'</code> - название создаваемого файла с запросом на подпись клиентского сертификата.</li>
</ul>
<p>При выполнении запроса будет предложено ввести актуальные данные для будущего сертификата:</p>
<ul>
<li><code>Country Name (2 letter code)</code> - двухбуквенный код страны, в которой юридически находится ваша организация.</li>
<li><code>State or Province Name (full name)</code> - штат или провинция, в которой юридически находится ваша организация.</li>
<li><code>Locality Name (e.g., city)</code> - город, в котором юридически находится ваша организация.</li>
<li><code>Organization Name (e.g., company)</code> - юридически зарегистрированное название вашей организации.</li>
<li><code>Organizational Unit Name (e.g., section)</code> - название вашего отдела в организации (опционально).</li>
<li><code>Common Name (e.g., server FQDN)</code> - полное доменное имя (FQDN) (например, <a title="" href="https://www.example.com" target="_blank"
   rel="noopener noreferrer">www.example.com</a>).</li>
<li><code>Email Address</code> - ваш адрес email (опционально).</li>
<li><code>A challenge password</code> - пароль (опционально).</li>
<li><code>An optional company name</code> - необязательное название компании (опционально).</li>
</ul>
<p>Самое главное поле это <code>Common Name (e.g., server FQDN)</code> (<code>CN</code>), заполнять его необходимо очень внимательно.</p>
<h3 id="создание-и-подпись-сертификата">
  <a class="link-body-emphasis" href="#%d1%81%d0%be%d0%b7%d0%b4%d0%b0%d0%bd%d0%b8%d0%b5-%d0%b8-%d0%bf%d0%be%d0%b4%d0%bf%d0%b8%d1%81%d1%8c-%d1%81%d0%b5%d1%80%d1%82%d0%b8%d1%84%d0%b8%d0%ba%d0%b0%d1%82%d0%b0">Создание и подпись сертификата</a>
</h3><p>В заключительной части остаётся только создать сам сертификат и подписать его.</p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-3
shortcode-codeblock-bash">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-a5ec04b66b3d69a4ee361073b5c59297" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">openssl x509 -req -days <span class="m">3650</span> -in <span class="s1">&#39;client.csr&#39;</span> -CA <span class="s1">&#39;_CA.crt&#39;</span> -CAkey <span class="s1">&#39;_CA.key&#39;</span> -out <span class="s1">&#39;client.crt&#39;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-a5ec04b66b3d69a4ee361073b5c59297"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<p>Где:</p>
<ul>
<li><code>-in 'client.csr'</code> - файл с запросом клиентского сертификата.</li>
<li><code>-CA '_CA.crt'</code> - файл с сертификатом центра сертификации.</li>
<li><code>-CAkey '_CA.key'</code> - файл с ключом центра сертификации.</li>
<li><code>-days '3650'</code> - количество дней, по прошествии которого клиентский сертификат станет недействительным.</li>
<li><code>-out 'client.crt'</code> - название создаваемого файла с клиентским сертификатом.</li>
</ul>
<h3 id="экспорт-сертификата">
  <a class="link-body-emphasis" href="#%d1%8d%d0%ba%d1%81%d0%bf%d0%be%d1%80%d1%82-%d1%81%d0%b5%d1%80%d1%82%d0%b8%d1%84%d0%b8%d0%ba%d0%b0%d1%82%d0%b0">Экспорт сертификата</a>
</h3><p>Для того, чтобы импортировать сертификат на клиентские устройства, его необходимо экспортировать в формат <code>P12</code>. <code>P12</code> является контейнером, в котором содержится приватный ключ сертификата и сам сертификат.</p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-4
shortcode-codeblock-bash">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-2c7f99b1dab2842eb4bfb711e061b334" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">openssl pkcs12 -export -inkey <span class="s1">&#39;client.key&#39;</span> -in <span class="s1">&#39;client.crt&#39;</span> -out <span class="s1">&#39;client.p12&#39;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-2c7f99b1dab2842eb4bfb711e061b334"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<p>Где:</p>
<ul>
<li><code>-inkey 'client.key'</code> - файл с приватным клиентским ключом.</li>
<li><code>-in 'client.crt'</code> - файл с клиентским сертификатом.</li>
<li><code>-out 'client.p12'</code> - название создаваемого файла-контейнера с приватным ключом и сертификатом.</li>
</ul>
<h3 id="верификация-сертификата">
  <a class="link-body-emphasis" href="#%d0%b2%d0%b5%d1%80%d0%b8%d1%84%d0%b8%d0%ba%d0%b0%d1%86%d0%b8%d1%8f-%d1%81%d0%b5%d1%80%d1%82%d0%b8%d1%84%d0%b8%d0%ba%d0%b0%d1%82%d0%b0">Верификация сертификата</a>
</h3>








  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-5
shortcode-codeblock-bash">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-24251b2061dc89a444030e993158c774" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">openssl verify -CAfile <span class="s1">&#39;_CA.crt&#39;</span> <span class="s1">&#39;client.crt&#39;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-24251b2061dc89a444030e993158c774"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<ul>
<li><code>-CAfile '_CA.crt'</code> - файл с сертификатом центра сертификации.</li>
<li><code>'client.crt'</code> - файл с клиентским сертификатом.</li>
</ul>
<h3 id="просмотр-сертификата">
  <a class="link-body-emphasis" href="#%d0%bf%d1%80%d0%be%d1%81%d0%bc%d0%be%d1%82%d1%80-%d1%81%d0%b5%d1%80%d1%82%d0%b8%d1%84%d0%b8%d0%ba%d0%b0%d1%82%d0%b0">Просмотр сертификата</a>
</h3>








  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-6
shortcode-codeblock-bash">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-7244e671bc2dad61b8b3d25596d345ca" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">openssl x509 -in <span class="s1">&#39;client.crt&#39;</span> -text</span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-7244e671bc2dad61b8b3d25596d345ca"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<p>Где:</p>
<ul>
<li><code>-in 'client.crt'</code> - файл с клиентским сертификатом.</li>
</ul>
<p>При выполнении команды, терминал покажет информацию со всеми основными сведениями о сертификате (пример ниже).</p>











<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-7 shortcode-codeblock-terminal
shortcode-codeblock-terminal-linux
shortcode-codeblock-terminal-linux-user">
  <div class="card overflow-hidden" data-bs-theme="dark">
    <div class="card-header">
      <div class="d-flex align-items-center">
        <div class="flex-shrink-0 ">
          <i class="fas fa-terminal fa-fw"></i>
        </div>
        <div class="flex-grow-1 mx-2">
          <h5 class="mb-0">Терминал</h5>
        </div>
        <div class="flex-shrink-0">
          <ul class="list-inline mb-0">
            <li class="list-inline-item" title='Копировать'>
              <a class="text-body" href="#"
                 data-fn="clipboard" data-clipboard-target="#cp-60be05e90cb3a1dcf400677862b443ed"
                 role="button" aria-label='Копировать'>
                <i class="fas fa-copy fa-fw"></i>
              </a>
            </li>
          </ul>
        </div>
      </div>
    </div>
    <div class="card-body p-0 overflow-auto" id="cp-60be05e90cb3a1dcf400677862b443ed"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-plaintext" data-lang="plaintext"><span class="line"><span class="cl">openssl x509 -in &#39;client.crt&#39; -text
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Certificate:
</span></span><span class="line"><span class="cl">    Data:
</span></span><span class="line"><span class="cl">        Version: 1 (0x0)
</span></span><span class="line"><span class="cl">        Serial Number:
</span></span><span class="line"><span class="cl">            49:14:b8:78:17:a1:ca:c4:6a:41:1b:23:f3:8a:8d:36:e0:9e:69:81
</span></span><span class="line"><span class="cl">        Signature Algorithm: ecdsa-with-SHA256
</span></span><span class="line"><span class="cl">        Issuer: C = AU, ST = Some-State, O = Internet Widgits Pty Ltd, CN = CA
</span></span><span class="line"><span class="cl">        Validity
</span></span><span class="line"><span class="cl">            Not Before: Oct 18 21:31:53 2023 GMT
</span></span><span class="line"><span class="cl">            Not After : Oct 15 21:31:53 2033 GMT
</span></span><span class="line"><span class="cl">        Subject: C = AU, ST = Some-State, O = Internet Widgits Pty Ltd, CN = CN-FQDN, emailAddress = mail@example.com
</span></span><span class="line"><span class="cl">        Subject Public Key Info:
</span></span><span class="line"><span class="cl">            Public Key Algorithm: id-ecPublicKey
</span></span><span class="line"><span class="cl">                Public-Key: (256 bit)
</span></span><span class="line"><span class="cl">                pub:
</span></span><span class="line"><span class="cl">                    04:9f:22:91:cc:14:b3:75:ad:44:cc:0d:96:0d:19:
</span></span><span class="line"><span class="cl">                    04:c4:20:79:fd:b7:f5:65:64:dd:65:a1:f0:b8:2d:
</span></span><span class="line"><span class="cl">                    e4:02:75:62:41:03:7c:6e:2f:48:e4:11:38:dc:ed:
</span></span><span class="line"><span class="cl">                    08:1f:4c:fa:5f:2f:a2:f5:5d:51:2e:8e:de:de:70:
</span></span><span class="line"><span class="cl">                    33:aa:e5:3b:95
</span></span><span class="line"><span class="cl">                ASN1 OID: prime256v1
</span></span><span class="line"><span class="cl">                NIST CURVE: P-256
</span></span><span class="line"><span class="cl">    Signature Algorithm: ecdsa-with-SHA256
</span></span><span class="line"><span class="cl">         30:64:02:30:0d:ff:b1:dc:8b:a6:c6:9c:ad:65:8a:7c:01:41:
</span></span><span class="line"><span class="cl">         9f:91:ca:24:4c:0b:28:5a:5c:f6:35:2a:b2:d7:58:ca:39:da:
</span></span><span class="line"><span class="cl">         6c:bf:cf:8b:23:20:ce:11:45:13:61:36:e2:23:4a:e9:02:30:
</span></span><span class="line"><span class="cl">         54:dc:45:ed:ef:21:58:ea:c7:b6:63:db:a2:d9:71:fe:3d:b3:
</span></span><span class="line"><span class="cl">         d6:1e:15:82:7b:c8:e8:08:33:d5:2f:d5:f2:8f:3b:41:ea:53:
</span></span><span class="line"><span class="cl">         1e:2d:a9:1e:9e:25:9c:fb:a7:12:f9:ec</span></span></code></pre></td></tr></table>
</div>
</div></div>
  </div>
</div>
<h3 id="просмотр-запроса-на-подпись-сертификата">
  <a class="link-body-emphasis" href="#%d0%bf%d1%80%d0%be%d1%81%d0%bc%d0%be%d1%82%d1%80-%d0%b7%d0%b0%d0%bf%d1%80%d0%be%d1%81%d0%b0-%d0%bd%d0%b0-%d0%bf%d0%be%d0%b4%d0%bf%d0%b8%d1%81%d1%8c-%d1%81%d0%b5%d1%80%d1%82%d0%b8%d1%84%d0%b8%d0%ba%d0%b0%d1%82%d0%b0">Просмотр запроса на подпись сертификата</a>
</h3>








  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-8
shortcode-codeblock-bash">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-bcc9372624b7e587db65569021c349d2" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">openssl req -in <span class="s1">&#39;client.csr&#39;</span> -text</span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-bcc9372624b7e587db65569021c349d2"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<p>Где:</p>
<ul>
<li><code>-in 'client.csr'</code> - файл с запросом на подпись клиентского сертификата.</li>
</ul>
<p>Команда выдаст информацию по запросу на подпись клиентского сертификата (пример ниже).</p>











<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-9 shortcode-codeblock-terminal
shortcode-codeblock-terminal-linux
shortcode-codeblock-terminal-linux-user">
  <div class="card overflow-hidden" data-bs-theme="dark">
    <div class="card-header">
      <div class="d-flex align-items-center">
        <div class="flex-shrink-0 ">
          <i class="fas fa-terminal fa-fw"></i>
        </div>
        <div class="flex-grow-1 mx-2">
          <h5 class="mb-0">Терминал</h5>
        </div>
        <div class="flex-shrink-0">
          <ul class="list-inline mb-0">
            <li class="list-inline-item" title='Копировать'>
              <a class="text-body" href="#"
                 data-fn="clipboard" data-clipboard-target="#cp-31541e37026fda4377ed3cf2feaeeb99"
                 role="button" aria-label='Копировать'>
                <i class="fas fa-copy fa-fw"></i>
              </a>
            </li>
          </ul>
        </div>
      </div>
    </div>
    <div class="card-body p-0 overflow-auto" id="cp-31541e37026fda4377ed3cf2feaeeb99"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-plaintext" data-lang="plaintext"><span class="line"><span class="cl">openssl req -in &#39;client.csr&#39; -text
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Certificate Request:
</span></span><span class="line"><span class="cl">    Data:
</span></span><span class="line"><span class="cl">        Version: 1 (0x0)
</span></span><span class="line"><span class="cl">        Subject: C = AU, ST = Some-State, O = Internet Widgits Pty Ltd, CN = CN-FQDN, emailAddress = mail@example.com
</span></span><span class="line"><span class="cl">        Subject Public Key Info:
</span></span><span class="line"><span class="cl">            Public Key Algorithm: id-ecPublicKey
</span></span><span class="line"><span class="cl">                Public-Key: (256 bit)
</span></span><span class="line"><span class="cl">                pub:
</span></span><span class="line"><span class="cl">                    04:9f:22:91:cc:14:b3:75:ad:44:cc:0d:96:0d:19:
</span></span><span class="line"><span class="cl">                    04:c4:20:79:fd:b7:f5:65:64:dd:65:a1:f0:b8:2d:
</span></span><span class="line"><span class="cl">                    e4:02:75:62:41:03:7c:6e:2f:48:e4:11:38:dc:ed:
</span></span><span class="line"><span class="cl">                    08:1f:4c:fa:5f:2f:a2:f5:5d:51:2e:8e:de:de:70:
</span></span><span class="line"><span class="cl">                    33:aa:e5:3b:95
</span></span><span class="line"><span class="cl">                ASN1 OID: prime256v1
</span></span><span class="line"><span class="cl">                NIST CURVE: P-256
</span></span><span class="line"><span class="cl">        Attributes:
</span></span><span class="line"><span class="cl">            a0:00
</span></span><span class="line"><span class="cl">        Requested Extensions:
</span></span><span class="line"><span class="cl">    Signature Algorithm: ecdsa-with-SHA256
</span></span><span class="line"><span class="cl">         30:45:02:20:51:9c:a0:b9:b2:61:7f:fa:64:ea:34:1f:65:15:
</span></span><span class="line"><span class="cl">         37:ae:f4:89:30:47:11:89:db:c4:1b:1d:9b:82:b9:64:ea:c7:
</span></span><span class="line"><span class="cl">         02:21:00:f8:00:70:4e:e6:db:99:78:cf:25:22:c0:8d:c6:b1:
</span></span><span class="line"><span class="cl">         f3:f0:d8:68:3b:c2:51:21:a5:b3:fa:97:f9:85:c6:9c:49</span></span></code></pre></td></tr></table>
</div>
</div></div>
  </div>
</div>
<h2 id="автоматизация">
  <a class="link-body-emphasis" href="#%d0%b0%d0%b2%d1%82%d0%be%d0%bc%d0%b0%d1%82%d0%b8%d0%b7%d0%b0%d1%86%d0%b8%d1%8f">Автоматизация</a>
</h2><p>Команд много. Поэтому я как обычно, решил всё автоматизировать и загнать в скрипт.</p>

    

    
        
            
            <div class="shortcode shortcode-file mb-3">
              <div class="card overflow-hidden" data-bs-theme="dark">
                <div class="card-header">
                  <div class="d-flex align-items-center">
                    <div class="flex-shrink-0">
                      <i class="far fa-file-code fa-fw"></i>
                    </div>
                    <div class="flex-grow-1 mx-2 text-truncate">
                      <code>bash.openssl.ca.sh</code>
                    </div>
                    <div class="flex-shrink-0">
                      <ul class="list-inline mb-0">
                        <li class="list-inline-item" title='Копировать'>
                          <a class="text-body" href="#"
                             data-fn="clipboard" data-clipboard-target="#cp-3a2fc314342bf3454b4d6543e704bdcd"
                             role="button" aria-label='Копировать'>
                            <i class="fas fa-copy fa-fw"></i>
                          </a>
                        </li>
                        <li class="list-inline-item" title='Скачать'>
                          <a class="text-body" href="/ru/2023/10/6733cb51-62a0-5ed9-b421-8f08c4e0cb18/bash.openssl.ca.sh" download
                             role="button" aria-label='Скачать'>
                            <i class="fas fa-download fa-fw"></i>
                          </a>
                        </li>
                        <li class="list-inline-item" title='Открыть'>
                          <a class="text-body" href="/ru/2023/10/6733cb51-62a0-5ed9-b421-8f08c4e0cb18/bash.openssl.ca.sh" target="_blank"
                             role="button" aria-label='Открыть'>
                            <i class="fas fa-arrow-up-right-from-square fa-fw"></i>
                          </a>
                        </li>
                      </ul>
                    </div>
                  </div>
                </div>
                <div class="card-body p-0 overflow-auto" id="cp-3a2fc314342bf3454b4d6543e704bdcd">
                    
                        
                    
                    <div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">  1
</span><span class="lnt">  2
</span><span class="lnt">  3
</span><span class="lnt">  4
</span><span class="lnt">  5
</span><span class="lnt">  6
</span><span class="lnt">  7
</span><span class="lnt">  8
</span><span class="lnt">  9
</span><span class="lnt"> 10
</span><span class="lnt"> 11
</span><span class="lnt"> 12
</span><span class="lnt"> 13
</span><span class="lnt"> 14
</span><span class="lnt"> 15
</span><span class="lnt"> 16
</span><span class="lnt"> 17
</span><span class="lnt"> 18
</span><span class="lnt"> 19
</span><span class="lnt"> 20
</span><span class="lnt"> 21
</span><span class="lnt"> 22
</span><span class="lnt"> 23
</span><span class="lnt"> 24
</span><span class="lnt"> 25
</span><span class="lnt"> 26
</span><span class="lnt"> 27
</span><span class="lnt"> 28
</span><span class="lnt"> 29
</span><span class="lnt"> 30
</span><span class="lnt"> 31
</span><span class="lnt"> 32
</span><span class="lnt"> 33
</span><span class="lnt"> 34
</span><span class="lnt"> 35
</span><span class="lnt"> 36
</span><span class="lnt"> 37
</span><span class="lnt"> 38
</span><span class="lnt"> 39
</span><span class="lnt"> 40
</span><span class="lnt"> 41
</span><span class="lnt"> 42
</span><span class="lnt"> 43
</span><span class="lnt"> 44
</span><span class="lnt"> 45
</span><span class="lnt"> 46
</span><span class="lnt"> 47
</span><span class="lnt"> 48
</span><span class="lnt"> 49
</span><span class="lnt"> 50
</span><span class="lnt"> 51
</span><span class="lnt"> 52
</span><span class="lnt"> 53
</span><span class="lnt"> 54
</span><span class="lnt"> 55
</span><span class="lnt"> 56
</span><span class="lnt"> 57
</span><span class="lnt"> 58
</span><span class="lnt"> 59
</span><span class="lnt"> 60
</span><span class="lnt"> 61
</span><span class="lnt"> 62
</span><span class="lnt"> 63
</span><span class="lnt"> 64
</span><span class="lnt"> 65
</span><span class="lnt"> 66
</span><span class="lnt"> 67
</span><span class="lnt"> 68
</span><span class="lnt"> 69
</span><span class="lnt"> 70
</span><span class="lnt"> 71
</span><span class="lnt"> 72
</span><span class="lnt"> 73
</span><span class="lnt"> 74
</span><span class="lnt"> 75
</span><span class="lnt"> 76
</span><span class="lnt"> 77
</span><span class="lnt"> 78
</span><span class="lnt"> 79
</span><span class="lnt"> 80
</span><span class="lnt"> 81
</span><span class="lnt"> 82
</span><span class="lnt"> 83
</span><span class="lnt"> 84
</span><span class="lnt"> 85
</span><span class="lnt"> 86
</span><span class="lnt"> 87
</span><span class="lnt"> 88
</span><span class="lnt"> 89
</span><span class="lnt"> 90
</span><span class="lnt"> 91
</span><span class="lnt"> 92
</span><span class="lnt"> 93
</span><span class="lnt"> 94
</span><span class="lnt"> 95
</span><span class="lnt"> 96
</span><span class="lnt"> 97
</span><span class="lnt"> 98
</span><span class="lnt"> 99
</span><span class="lnt">100
</span><span class="lnt">101
</span><span class="lnt">102
</span><span class="lnt">103
</span><span class="lnt">104
</span><span class="lnt">105
</span><span class="lnt">106
</span><span class="lnt">107
</span><span class="lnt">108
</span><span class="lnt">109
</span><span class="lnt">110
</span><span class="lnt">111
</span><span class="lnt">112
</span><span class="lnt">113
</span><span class="lnt">114
</span><span class="lnt">115
</span><span class="lnt">116
</span><span class="lnt">117
</span><span class="lnt">118
</span><span class="lnt">119
</span><span class="lnt">120
</span><span class="lnt">121
</span><span class="lnt">122
</span><span class="lnt">123
</span><span class="lnt">124
</span><span class="lnt">125
</span><span class="lnt">126
</span><span class="lnt">127
</span><span class="lnt">128
</span><span class="lnt">129
</span><span class="lnt">130
</span><span class="lnt">131
</span><span class="lnt">132
</span><span class="lnt">133
</span><span class="lnt">134
</span><span class="lnt">135
</span><span class="lnt">136
</span><span class="lnt">137
</span><span class="lnt">138
</span><span class="lnt">139
</span><span class="lnt">140
</span><span class="lnt">141
</span><span class="lnt">142
</span><span class="lnt">143
</span><span class="lnt">144
</span><span class="lnt">145
</span><span class="lnt">146
</span><span class="lnt">147
</span><span class="lnt">148
</span><span class="lnt">149
</span><span class="lnt">150
</span><span class="lnt">151
</span><span class="lnt">152
</span><span class="lnt">153
</span><span class="lnt">154
</span><span class="lnt">155
</span><span class="lnt">156
</span><span class="lnt">157
</span><span class="lnt">158
</span><span class="lnt">159
</span><span class="lnt">160
</span><span class="lnt">161
</span><span class="lnt">162
</span><span class="lnt">163
</span><span class="lnt">164
</span><span class="lnt">165
</span><span class="lnt">166
</span><span class="lnt">167
</span><span class="lnt">168
</span><span class="lnt">169
</span><span class="lnt">170
</span><span class="lnt">171
</span><span class="lnt">172
</span><span class="lnt">173
</span><span class="lnt">174
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sh" data-lang="sh"><span class="line"><span class="cl"><span class="cp">#!/usr/bin/env -S bash -e
</span></span></span><span class="line"><span class="cl"><span class="cp"></span><span class="c1">#</span>
</span></span><span class="line"><span class="cl"><span class="c1"># OpenSSL certificate generator with CA.</span>
</span></span><span class="line"><span class="cl"><span class="c1">#</span>
</span></span><span class="line"><span class="cl"><span class="c1"># @package    Bash</span>
</span></span><span class="line"><span class="cl"><span class="c1"># @author     Kai Kimera &lt;mail@kai.kim&gt;</span>
</span></span><span class="line"><span class="cl"><span class="c1"># @copyright  2023 Library Online</span>
</span></span><span class="line"><span class="cl"><span class="c1"># @license    MIT</span>
</span></span><span class="line"><span class="cl"><span class="c1"># @version    0.1.2</span>
</span></span><span class="line"><span class="cl"><span class="c1"># @link       https://lib.onl/ru/2023/10/6733cb51-62a0-5ed9-b421-8f08c4e0cb18/</span>
</span></span><span class="line"><span class="cl"><span class="c1"># -------------------------------------------------------------------------------------------------------------------- #</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="o">((</span> <span class="nv">EUID</span> <span class="o">==</span> <span class="m">0</span> <span class="o">))</span> <span class="o">&amp;&amp;</span> <span class="o">{</span> <span class="nb">echo</span> &gt;<span class="p">&amp;</span><span class="m">2</span> <span class="s1">&#39;This script should not be run as root!&#39;</span><span class="p">;</span> <span class="nb">exit</span> 1<span class="p">;</span> <span class="o">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># -------------------------------------------------------------------------------------------------------------------- #</span>
</span></span><span class="line"><span class="cl"><span class="c1"># CONFIGURATION.</span>
</span></span><span class="line"><span class="cl"><span class="c1"># -------------------------------------------------------------------------------------------------------------------- #</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Get &#39;cat&#39; command.</span>
</span></span><span class="line"><span class="cl"><span class="nv">cat</span><span class="o">=</span><span class="s2">&#34;</span><span class="k">$(</span> <span class="nb">command</span> -v cat <span class="k">)</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Get &#39;date&#39; command.</span>
</span></span><span class="line"><span class="cl"><span class="nv">date</span><span class="o">=</span><span class="s2">&#34;</span><span class="k">$(</span> <span class="nb">command</span> -v date <span class="k">)</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Get &#39;mkdir&#39; command.</span>
</span></span><span class="line"><span class="cl"><span class="nv">mkdir</span><span class="o">=</span><span class="s2">&#34;</span><span class="k">$(</span> <span class="nb">command</span> -v mkdir <span class="k">)</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Get &#39;openssl&#39; command.</span>
</span></span><span class="line"><span class="cl"><span class="nv">openssl</span><span class="o">=</span><span class="s2">&#34;</span><span class="k">$(</span> <span class="nb">command</span> -v openssl <span class="k">)</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Get &#39;shuf&#39; command.</span>
</span></span><span class="line"><span class="cl"><span class="nv">shuf</span><span class="o">=</span><span class="s2">&#34;</span><span class="k">$(</span> <span class="nb">command</span> -v shuf <span class="k">)</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># CA file names.</span>
</span></span><span class="line"><span class="cl"><span class="nv">ca</span><span class="o">=</span><span class="s1">&#39;_CA&#39;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Specifies the number of days to make a certificate valid for.</span>
</span></span><span class="line"><span class="cl"><span class="c1"># Default is 10 years.</span>
</span></span><span class="line"><span class="cl"><span class="nv">days</span><span class="o">=</span><span class="s1">&#39;3650&#39;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># The two-letter country code where your company is legally located.</span>
</span></span><span class="line"><span class="cl"><span class="nv">country</span><span class="o">=</span><span class="s1">&#39;RU&#39;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># The state/province where your company is legally located.</span>
</span></span><span class="line"><span class="cl"><span class="nv">state</span><span class="o">=</span><span class="s1">&#39;Russia&#39;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># The city where your company is legally located.</span>
</span></span><span class="line"><span class="cl"><span class="nv">city</span><span class="o">=</span><span class="s1">&#39;Moscow&#39;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Your company&#39;s legally registered name (e.g., YourCompany, Inc.).</span>
</span></span><span class="line"><span class="cl"><span class="nv">org</span><span class="o">=</span><span class="s1">&#39;YourCompany&#39;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Timestamp.</span>
</span></span><span class="line"><span class="cl"><span class="nv">ts</span><span class="o">=</span><span class="s2">&#34;</span><span class="k">$(</span> <span class="si">${</span><span class="nv">date</span><span class="si">}</span> -u <span class="s1">&#39;+%s&#39;</span> <span class="k">)</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Suffix.</span>
</span></span><span class="line"><span class="cl"><span class="nv">sfx</span><span class="o">=</span><span class="k">$(</span> <span class="si">${</span><span class="nv">shuf</span><span class="si">}</span> -i <span class="s1">&#39;1000-9999&#39;</span> -n <span class="m">1</span> --random-source<span class="o">=</span><span class="s1">&#39;/dev/random&#39;</span> <span class="k">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># -------------------------------------------------------------------------------------------------------------------- #</span>
</span></span><span class="line"><span class="cl"><span class="c1"># -----------------------------------------------------&lt; SCRIPT &gt;----------------------------------------------------- #</span>
</span></span><span class="line"><span class="cl"><span class="c1"># -------------------------------------------------------------------------------------------------------------------- #</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># -------------------------------------------------------------------------------------------------------------------- #</span>
</span></span><span class="line"><span class="cl"><span class="c1"># CERTIFICATE AUTHORITY.</span>
</span></span><span class="line"><span class="cl"><span class="c1"># -------------------------------------------------------------------------------------------------------------------- #</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">ca<span class="o">()</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">  ! <span class="o">[[</span> -x <span class="s2">&#34;</span><span class="si">${</span><span class="nv">openssl</span><span class="si">}</span><span class="s2">&#34;</span> <span class="o">]]</span> <span class="o">&amp;&amp;</span> <span class="o">{</span> <span class="nb">echo</span> &gt;<span class="p">&amp;</span><span class="m">2</span> <span class="s2">&#34;&#39;openssl&#39; is not installed!&#34;</span><span class="p">;</span> <span class="nb">exit</span> 1<span class="p">;</span> <span class="o">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="nb">local</span> <span class="nv">name</span><span class="o">=</span><span class="s2">&#34;</span><span class="si">${</span><span class="nv">1</span><span class="k">:-</span><span class="nv">example</span><span class="p">.com</span><span class="si">}</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl">  <span class="nb">local</span> <span class="nv">email</span><span class="o">=</span><span class="s2">&#34;</span><span class="si">${</span><span class="nv">2</span><span class="k">:-</span><span class="nv">mail</span><span class="p">@example.com</span><span class="si">}</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl">  <span class="nb">local</span> <span class="nv">v3ext_ca</span><span class="o">=</span><span class="s1">&#39;_CA.v3ext&#39;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  cat &gt; <span class="s2">&#34;</span><span class="si">${</span><span class="nv">v3ext_ca</span><span class="si">}</span><span class="s2">&#34;</span> <span class="s">&lt;&lt;EOF
</span></span></span><span class="line"><span class="cl"><span class="s">authorityKeyIdentifier = keyid:always,issuer
</span></span></span><span class="line"><span class="cl"><span class="s">basicConstraints = critical, CA:TRUE
</span></span></span><span class="line"><span class="cl"><span class="s">keyUsage = critical, digitalSignature, cRLSign, keyCertSign
</span></span></span><span class="line"><span class="cl"><span class="s">EOF</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="nb">echo</span> <span class="s1">&#39;&#39;</span> <span class="o">&amp;&amp;</span> <span class="nb">echo</span> <span class="s2">&#34;--- [SSL-CA] CREATING A CA CERTIFICATE&#34;</span> <span class="o">&amp;&amp;</span> <span class="nb">echo</span> <span class="s1">&#39;&#39;</span>
</span></span><span class="line"><span class="cl">  <span class="si">${</span><span class="nv">openssl</span><span class="si">}</span> ecparam -genkey -name <span class="s1">&#39;secp384r1&#39;</span> <span class="p">|</span> <span class="si">${</span><span class="nv">openssl</span><span class="si">}</span> ec -aes256 -out <span class="s2">&#34;</span><span class="si">${</span><span class="nv">ca</span><span class="si">}</span><span class="s2">.key&#34;</span> <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>    <span class="o">&amp;&amp;</span> <span class="si">${</span><span class="nv">openssl</span><span class="si">}</span> req -new -sha384 -key <span class="s2">&#34;</span><span class="si">${</span><span class="nv">ca</span><span class="si">}</span><span class="s2">.key&#34;</span> -out <span class="s2">&#34;</span><span class="si">${</span><span class="nv">ca</span><span class="si">}</span><span class="s2">.csr&#34;</span> <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>    -subj <span class="s2">&#34;/C=</span><span class="si">${</span><span class="nv">country</span><span class="si">}</span><span class="s2">/ST=</span><span class="si">${</span><span class="nv">state</span><span class="si">}</span><span class="s2">/L=</span><span class="si">${</span><span class="nv">city</span><span class="si">}</span><span class="s2">/O=</span><span class="si">${</span><span class="nv">org</span><span class="si">}</span><span class="s2">/emailAddress=</span><span class="si">${</span><span class="nv">email</span><span class="si">}</span><span class="s2">/CN=</span><span class="si">${</span><span class="nv">name</span><span class="si">}</span><span class="s2">&#34;</span> <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>    <span class="o">&amp;&amp;</span> <span class="si">${</span><span class="nv">openssl</span><span class="si">}</span> x509 -req -extfile <span class="s2">&#34;</span><span class="si">${</span><span class="nv">v3ext_ca</span><span class="si">}</span><span class="s2">&#34;</span> -sha384 -days <span class="si">${</span><span class="nv">days</span><span class="si">}</span> -key <span class="s2">&#34;</span><span class="si">${</span><span class="nv">ca</span><span class="si">}</span><span class="s2">.key&#34;</span> -in <span class="s2">&#34;</span><span class="si">${</span><span class="nv">ca</span><span class="si">}</span><span class="s2">.csr&#34;</span> -out <span class="s2">&#34;</span><span class="si">${</span><span class="nv">ca</span><span class="si">}</span><span class="s2">.crt&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    _info <span class="s2">&#34;</span><span class="si">${</span><span class="nv">ca</span><span class="si">}</span><span class="s2">.crt&#34;</span>
</span></span><span class="line"><span class="cl"><span class="o">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># -------------------------------------------------------------------------------------------------------------------- #</span>
</span></span><span class="line"><span class="cl"><span class="c1"># CLIENT CERTIFICATE.</span>
</span></span><span class="line"><span class="cl"><span class="c1"># -------------------------------------------------------------------------------------------------------------------- #</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">cert<span class="o">()</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">  <span class="k">for</span> i in <span class="s2">&#34;</span><span class="si">${</span><span class="nv">mkdir</span><span class="si">}</span><span class="s2">&#34;</span> <span class="s2">&#34;</span><span class="si">${</span><span class="nv">openssl</span><span class="si">}</span><span class="s2">&#34;</span> <span class="s2">&#34;</span><span class="si">${</span><span class="nv">shuf</span><span class="si">}</span><span class="s2">&#34;</span><span class="p">;</span> <span class="k">do</span>
</span></span><span class="line"><span class="cl">    ! <span class="o">[[</span> -x <span class="s2">&#34;</span><span class="si">${</span><span class="nv">i</span><span class="si">}</span><span class="s2">&#34;</span> <span class="o">]]</span> <span class="o">&amp;&amp;</span> <span class="o">{</span> <span class="nb">echo</span> &gt;<span class="p">&amp;</span><span class="m">2</span> <span class="s2">&#34;&#39;</span><span class="si">${</span><span class="nv">i</span><span class="si">}</span><span class="s2">&#39; is not installed!&#34;</span><span class="p">;</span> <span class="nb">exit</span> 1<span class="p">;</span> <span class="o">}</span>
</span></span><span class="line"><span class="cl">  <span class="k">done</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="nb">local</span> name<span class="p">;</span> <span class="nv">name</span><span class="o">=</span><span class="s2">&#34;</span><span class="si">${</span><span class="nv">1</span><span class="k">:-</span><span class="nv">example</span><span class="p">.com</span><span class="si">}</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl">  <span class="nb">local</span> email<span class="p">;</span> <span class="nv">email</span><span class="o">=</span><span class="s2">&#34;</span><span class="si">${</span><span class="nv">2</span><span class="k">:-</span><span class="nv">mail</span><span class="p">@example.com</span><span class="si">}</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl">  <span class="nb">local</span> type<span class="p">;</span> <span class="nv">type</span><span class="o">=</span><span class="s2">&#34;</span><span class="si">${</span><span class="nv">3</span><span class="k">:-</span><span class="nv">server</span><span class="si">}</span><span class="s2">&#34;</span><span class="p">;</span> <span class="o">[[</span> <span class="s2">&#34;</span><span class="si">${</span><span class="nv">name</span><span class="si">}</span><span class="s2">&#34;</span> <span class="o">=</span> *<span class="s1">&#39; &#39;</span>* <span class="o">]]</span> <span class="o">&amp;&amp;</span> <span class="nv">type</span><span class="o">=</span><span class="s1">&#39;client&#39;</span>
</span></span><span class="line"><span class="cl">  <span class="nb">local</span> dir<span class="p">;</span> <span class="nv">dir</span><span class="o">=</span><span class="s2">&#34;</span><span class="si">${</span><span class="nv">type</span><span class="si">}</span><span class="s2">/</span><span class="si">${</span><span class="nv">name</span><span class="p">// /_</span><span class="si">}</span><span class="s2">&#34;</span><span class="p">;</span> <span class="si">${</span><span class="nv">mkdir</span><span class="si">}</span> -p <span class="s2">&#34;</span><span class="si">${</span><span class="nv">dir</span><span class="si">}</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl">  <span class="nb">local</span> file<span class="p">;</span> <span class="nv">file</span><span class="o">=</span><span class="s2">&#34;</span><span class="si">${</span><span class="nv">dir</span><span class="si">}</span><span class="s2">/</span><span class="si">${</span><span class="nv">email</span><span class="si">}</span><span class="s2">.</span><span class="si">${</span><span class="nv">ts</span><span class="si">}</span><span class="s2">.</span><span class="si">${</span><span class="nv">sfx</span><span class="si">}</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="nb">local</span> v3ext
</span></span><span class="line"><span class="cl">  <span class="k">if</span> <span class="o">[[</span> <span class="s2">&#34;</span><span class="si">${</span><span class="nv">type</span><span class="si">}</span><span class="s2">&#34;</span> <span class="o">=</span> <span class="s1">&#39;client&#39;</span> <span class="o">]]</span><span class="p">;</span> <span class="k">then</span>
</span></span><span class="line"><span class="cl">    <span class="nv">v3ext</span><span class="o">=</span><span class="k">$(</span> _v3ext_client <span class="s2">&#34;</span><span class="si">${</span><span class="nv">file</span><span class="si">}</span><span class="s2">.v3ext&#34;</span> <span class="k">)</span>
</span></span><span class="line"><span class="cl">  <span class="k">else</span>
</span></span><span class="line"><span class="cl">    <span class="nv">v3ext</span><span class="o">=</span><span class="k">$(</span> _v3ext_server <span class="s2">&#34;</span><span class="si">${</span><span class="nv">file</span><span class="si">}</span><span class="s2">.v3ext&#34;</span> <span class="s2">&#34;</span><span class="si">${</span><span class="nv">name</span><span class="si">}</span><span class="s2">&#34;</span> <span class="k">)</span>
</span></span><span class="line"><span class="cl">  <span class="k">fi</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="nb">echo</span> <span class="s1">&#39;&#39;</span> <span class="o">&amp;&amp;</span> <span class="nb">echo</span> <span class="s2">&#34;--- [SSL] CREATING A </span><span class="si">${</span><span class="nv">type</span><span class="p">^^</span><span class="si">}</span><span class="s2"> CERTIFICATE&#34;</span> <span class="o">&amp;&amp;</span> <span class="nb">echo</span> <span class="s1">&#39;&#39;</span>
</span></span><span class="line"><span class="cl">  <span class="si">${</span><span class="nv">openssl</span><span class="si">}</span> ecparam -genkey -name <span class="s1">&#39;prime256v1&#39;</span> <span class="p">|</span> <span class="si">${</span><span class="nv">openssl</span><span class="si">}</span> ec -out <span class="s2">&#34;</span><span class="si">${</span><span class="nv">file</span><span class="si">}</span><span class="s2">.key&#34;</span> <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>    <span class="o">&amp;&amp;</span> <span class="si">${</span><span class="nv">openssl</span><span class="si">}</span> req -new -key <span class="s2">&#34;</span><span class="si">${</span><span class="nv">file</span><span class="si">}</span><span class="s2">.key&#34;</span> -out <span class="s2">&#34;</span><span class="si">${</span><span class="nv">file</span><span class="si">}</span><span class="s2">.csr&#34;</span> <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>    -subj <span class="s2">&#34;/C=</span><span class="si">${</span><span class="nv">country</span><span class="si">}</span><span class="s2">/ST=</span><span class="si">${</span><span class="nv">state</span><span class="si">}</span><span class="s2">/L=</span><span class="si">${</span><span class="nv">city</span><span class="si">}</span><span class="s2">/O=</span><span class="si">${</span><span class="nv">org</span><span class="si">}</span><span class="s2">/emailAddress=</span><span class="si">${</span><span class="nv">email</span><span class="si">}</span><span class="s2">/CN=</span><span class="si">${</span><span class="nv">name</span><span class="si">}</span><span class="s2">&#34;</span> <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>    <span class="o">&amp;&amp;</span> <span class="si">${</span><span class="nv">openssl</span><span class="si">}</span> x509 -req -extfile <span class="s2">&#34;</span><span class="si">${</span><span class="nv">v3ext</span><span class="si">}</span><span class="s2">&#34;</span> -days <span class="si">${</span><span class="nv">days</span><span class="si">}</span> -in <span class="s2">&#34;</span><span class="si">${</span><span class="nv">file</span><span class="si">}</span><span class="s2">.csr&#34;</span> <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>    -CA <span class="s2">&#34;</span><span class="si">${</span><span class="nv">ca</span><span class="si">}</span><span class="s2">.crt&#34;</span> -CAkey <span class="s2">&#34;</span><span class="si">${</span><span class="nv">ca</span><span class="si">}</span><span class="s2">.key&#34;</span> -CAcreateserial -CAserial <span class="s2">&#34;</span><span class="si">${</span><span class="nv">file</span><span class="si">}</span><span class="s2">.srl&#34;</span> -out <span class="s2">&#34;</span><span class="si">${</span><span class="nv">file</span><span class="si">}</span><span class="s2">.crt&#34;</span> <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>    <span class="o">&amp;&amp;</span> <span class="si">${</span><span class="nv">cat</span><span class="si">}</span> <span class="s2">&#34;</span><span class="si">${</span><span class="nv">file</span><span class="si">}</span><span class="s2">.key&#34;</span> <span class="s2">&#34;</span><span class="si">${</span><span class="nv">file</span><span class="si">}</span><span class="s2">.crt&#34;</span> <span class="s2">&#34;</span><span class="si">${</span><span class="nv">ca</span><span class="si">}</span><span class="s2">.crt&#34;</span> &gt; <span class="s2">&#34;</span><span class="si">${</span><span class="nv">file</span><span class="si">}</span><span class="s2">.crt.chain&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  _verify <span class="s2">&#34;</span><span class="si">${</span><span class="nv">ca</span><span class="si">}</span><span class="s2">.crt&#34;</span> <span class="s2">&#34;</span><span class="si">${</span><span class="nv">file</span><span class="si">}</span><span class="s2">.crt&#34;</span> <span class="o">&amp;&amp;</span> _info <span class="s2">&#34;</span><span class="si">${</span><span class="nv">file</span><span class="si">}</span><span class="s2">.crt&#34;</span> <span class="o">&amp;&amp;</span> _export <span class="s2">&#34;</span><span class="si">${</span><span class="nv">file</span><span class="si">}</span><span class="s2">.key&#34;</span> <span class="s2">&#34;</span><span class="si">${</span><span class="nv">file</span><span class="si">}</span><span class="s2">.crt&#34;</span> <span class="s2">&#34;</span><span class="si">${</span><span class="nv">file</span><span class="si">}</span><span class="s2">.p12&#34;</span>
</span></span><span class="line"><span class="cl"><span class="o">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">_verify<span class="o">()</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">  <span class="nb">echo</span> <span class="s1">&#39;&#39;</span> <span class="o">&amp;&amp;</span> <span class="nb">echo</span> <span class="s2">&#34;--- [SSL] CERTIFICATE VERIFICATION&#34;</span> <span class="o">&amp;&amp;</span> <span class="nb">echo</span> <span class="s1">&#39;&#39;</span>
</span></span><span class="line"><span class="cl">  <span class="k">for</span> i in <span class="s2">&#34;</span><span class="si">${</span><span class="nv">1</span><span class="si">}</span><span class="s2">&#34;</span> <span class="s2">&#34;</span><span class="si">${</span><span class="nv">2</span><span class="si">}</span><span class="s2">&#34;</span><span class="p">;</span> <span class="k">do</span> <span class="o">[[</span> ! -f <span class="s2">&#34;</span><span class="si">${</span><span class="nv">i</span><span class="si">}</span><span class="s2">&#34;</span> <span class="o">]]</span> <span class="o">&amp;&amp;</span> <span class="o">{</span> <span class="nb">echo</span> &gt;<span class="p">&amp;</span><span class="m">2</span> <span class="s2">&#34;&#39;</span><span class="si">${</span><span class="nv">i</span><span class="si">}</span><span class="s2">&#39; not found!&#34;</span><span class="p">;</span> <span class="nb">exit</span> 1<span class="p">;</span> <span class="o">}</span><span class="p">;</span> <span class="k">done</span>
</span></span><span class="line"><span class="cl">  <span class="si">${</span><span class="nv">openssl</span><span class="si">}</span> verify -CAfile <span class="s2">&#34;</span><span class="si">${</span><span class="nv">1</span><span class="si">}</span><span class="s2">&#34;</span> <span class="s2">&#34;</span><span class="si">${</span><span class="nv">2</span><span class="si">}</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl"><span class="o">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">_info<span class="o">()</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">  <span class="nb">echo</span> <span class="s1">&#39;&#39;</span> <span class="o">&amp;&amp;</span> <span class="nb">echo</span> <span class="s2">&#34;--- [SSL] CERTIFICATE DETAILS&#34;</span> <span class="o">&amp;&amp;</span> <span class="nb">echo</span> <span class="s1">&#39;&#39;</span>
</span></span><span class="line"><span class="cl">  <span class="o">[[</span> ! -f <span class="s2">&#34;</span><span class="si">${</span><span class="nv">1</span><span class="si">}</span><span class="s2">&#34;</span> <span class="o">]]</span> <span class="o">&amp;&amp;</span> <span class="o">{</span> <span class="nb">echo</span> &gt;<span class="p">&amp;</span><span class="m">2</span> <span class="s2">&#34;&#39;</span><span class="si">${</span><span class="nv">i</span><span class="si">}</span><span class="s2">&#39; not found!&#34;</span><span class="p">;</span> <span class="nb">exit</span> 1<span class="p">;</span> <span class="o">}</span>
</span></span><span class="line"><span class="cl">  <span class="si">${</span><span class="nv">openssl</span><span class="si">}</span> x509 -in <span class="s2">&#34;</span><span class="si">${</span><span class="nv">1</span><span class="si">}</span><span class="s2">&#34;</span> -text -noout
</span></span><span class="line"><span class="cl"><span class="o">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">_export<span class="o">()</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">  <span class="nb">echo</span> <span class="s1">&#39;&#39;</span> <span class="o">&amp;&amp;</span> <span class="nb">echo</span> <span class="s2">&#34;--- [SSL] EXPORTING A CERTIFICATE&#34;</span> <span class="o">&amp;&amp;</span> <span class="nb">echo</span> <span class="s1">&#39;&#39;</span>
</span></span><span class="line"><span class="cl">  <span class="k">for</span> i in <span class="s2">&#34;</span><span class="si">${</span><span class="nv">1</span><span class="si">}</span><span class="s2">&#34;</span> <span class="s2">&#34;</span><span class="si">${</span><span class="nv">2</span><span class="si">}</span><span class="s2">&#34;</span><span class="p">;</span> <span class="k">do</span> <span class="o">[[</span> ! -f <span class="s2">&#34;</span><span class="si">${</span><span class="nv">i</span><span class="si">}</span><span class="s2">&#34;</span> <span class="o">]]</span> <span class="o">&amp;&amp;</span> <span class="o">{</span> <span class="nb">echo</span> &gt;<span class="p">&amp;</span><span class="m">2</span> <span class="s2">&#34;&#39;</span><span class="si">${</span><span class="nv">i</span><span class="si">}</span><span class="s2">&#39; not found!&#34;</span><span class="p">;</span> <span class="nb">exit</span> 1<span class="p">;</span> <span class="o">}</span><span class="p">;</span> <span class="k">done</span>
</span></span><span class="line"><span class="cl">  <span class="si">${</span><span class="nv">openssl</span><span class="si">}</span> pkcs12 -export -inkey <span class="s2">&#34;</span><span class="si">${</span><span class="nv">1</span><span class="si">}</span><span class="s2">&#34;</span> -in <span class="s2">&#34;</span><span class="si">${</span><span class="nv">2</span><span class="si">}</span><span class="s2">&#34;</span> -out <span class="s2">&#34;</span><span class="si">${</span><span class="nv">3</span><span class="si">}</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl"><span class="o">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">_v3ext_client<span class="o">()</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">  cat &gt; <span class="s2">&#34;</span><span class="si">${</span><span class="nv">1</span><span class="si">}</span><span class="s2">&#34;</span> <span class="s">&lt;&lt;EOF
</span></span></span><span class="line"><span class="cl"><span class="s">authorityKeyIdentifier = keyid,issuer
</span></span></span><span class="line"><span class="cl"><span class="s">basicConstraints = CA:FALSE
</span></span></span><span class="line"><span class="cl"><span class="s">nsCertType = client, email
</span></span></span><span class="line"><span class="cl"><span class="s">nsComment = &#34;OpenSSL Generated Client Certificate&#34;
</span></span></span><span class="line"><span class="cl"><span class="s">keyUsage = critical, digitalSignature, keyEncipherment, nonRepudiation
</span></span></span><span class="line"><span class="cl"><span class="s">extendedKeyUsage = clientAuth, emailProtection
</span></span></span><span class="line"><span class="cl"><span class="s">EOF</span>
</span></span><span class="line"><span class="cl">  <span class="nb">echo</span> -n <span class="s2">&#34;</span><span class="si">${</span><span class="nv">1</span><span class="si">}</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl"><span class="o">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">_v3ext_server<span class="o">()</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">  cat &gt; <span class="s2">&#34;</span><span class="si">${</span><span class="nv">1</span><span class="si">}</span><span class="s2">&#34;</span> <span class="s">&lt;&lt;EOF
</span></span></span><span class="line"><span class="cl"><span class="s">authorityKeyIdentifier = keyid,issuer:always
</span></span></span><span class="line"><span class="cl"><span class="s">basicConstraints = CA:FALSE
</span></span></span><span class="line"><span class="cl"><span class="s">nsCertType = server
</span></span></span><span class="line"><span class="cl"><span class="s">nsComment = &#34;OpenSSL Generated Server Certificate&#34;
</span></span></span><span class="line"><span class="cl"><span class="s">keyUsage = critical, digitalSignature, keyEncipherment
</span></span></span><span class="line"><span class="cl"><span class="s">extendedKeyUsage = serverAuth, clientAuth
</span></span></span><span class="line"><span class="cl"><span class="s">subjectAltName = @alt_names
</span></span></span><span class="line"><span class="cl"><span class="s">
</span></span></span><span class="line"><span class="cl"><span class="s">[alt_names]
</span></span></span><span class="line"><span class="cl"><span class="s">DNS.1 = ${2}
</span></span></span><span class="line"><span class="cl"><span class="s">DNS.2 = *.${2}
</span></span></span><span class="line"><span class="cl"><span class="s">IP.1 = 127.0.0.1
</span></span></span><span class="line"><span class="cl"><span class="s">EOF</span>
</span></span><span class="line"><span class="cl">  <span class="nb">echo</span> -n <span class="s2">&#34;</span><span class="si">${</span><span class="nv">1</span><span class="si">}</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl"><span class="o">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># -------------------------------------------------------------------------------------------------------------------- #</span>
</span></span><span class="line"><span class="cl"><span class="c1"># -------------------------------------------------&lt; RUNNING SCRIPT &gt;------------------------------------------------- #</span>
</span></span><span class="line"><span class="cl"><span class="c1"># -------------------------------------------------------------------------------------------------------------------- #</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="s2">&#34;</span><span class="nv">$@</span><span class="s2">&#34;</span></span></span></code></pre></td></tr></table>
</div>
</div>
                </div>
              </div>
            </div>
        
    
<p>Скрипт содержит две функции, вызывать которых можно по отдельности. Функция <code>ca()</code> позволяет сгенерировать ключ и сертификат центра сертификации, а функция <code>cert()</code>, соответственно, генерирует клиентские сертификаты.</p>
<h3 id="использование">
  <a class="link-body-emphasis" href="#%d0%b8%d1%81%d0%bf%d0%be%d0%bb%d1%8c%d0%b7%d0%be%d0%b2%d0%b0%d0%bd%d0%b8%d0%b5">Использование</a>
</h3><ol>
<li>Создать ключ и сертификат центра сертификации:</li>
</ol>











<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-10 shortcode-codeblock-terminal
shortcode-codeblock-terminal-linux
shortcode-codeblock-terminal-linux-user">
  <div class="card overflow-hidden" data-bs-theme="dark">
    <div class="card-header">
      <div class="d-flex align-items-center">
        <div class="flex-shrink-0 ">
          <i class="fas fa-terminal fa-fw"></i>
        </div>
        <div class="flex-grow-1 mx-2">
          <h5 class="mb-0">Терминал</h5>
        </div>
        <div class="flex-shrink-0">
          <ul class="list-inline mb-0">
            <li class="list-inline-item" title='Копировать'>
              <a class="text-body" href="#"
                 data-fn="clipboard" data-clipboard-target="#cp-5e021e19cb1eb270616b38463948c679"
                 role="button" aria-label='Копировать'>
                <i class="fas fa-copy fa-fw"></i>
              </a>
            </li>
          </ul>
        </div>
      </div>
    </div>
    <div class="card-body p-0 overflow-auto" id="cp-5e021e19cb1eb270616b38463948c679"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-plaintext" data-lang="plaintext"><span class="line"><span class="cl">bash bash.openssl.ca.sh ca</span></span></code></pre></td></tr></table>
</div>
</div></div>
  </div>
</div>
<ol start="2">
<li>Создать клиентские ключи и сертификаты:</li>
</ol>











<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-11 shortcode-codeblock-terminal
shortcode-codeblock-terminal-linux
shortcode-codeblock-terminal-linux-user">
  <div class="card overflow-hidden" data-bs-theme="dark">
    <div class="card-header">
      <div class="d-flex align-items-center">
        <div class="flex-shrink-0 ">
          <i class="fas fa-terminal fa-fw"></i>
        </div>
        <div class="flex-grow-1 mx-2">
          <h5 class="mb-0">Терминал</h5>
        </div>
        <div class="flex-shrink-0">
          <ul class="list-inline mb-0">
            <li class="list-inline-item" title='Копировать'>
              <a class="text-body" href="#"
                 data-fn="clipboard" data-clipboard-target="#cp-905e8389a3c6d3cf68e2fe3d5c8265b1"
                 role="button" aria-label='Копировать'>
                <i class="fas fa-copy fa-fw"></i>
              </a>
            </li>
          </ul>
        </div>
      </div>
    </div>
    <div class="card-body p-0 overflow-auto" id="cp-905e8389a3c6d3cf68e2fe3d5c8265b1"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-plaintext" data-lang="plaintext"><span class="line"><span class="cl">bash bash.openssl.ca.sh cert</span></span></code></pre></td></tr></table>
</div>
</div></div>
  </div>
</div>
<p>Немного расскажу про алгоритм генерации сертификатов.</p>
<ol>
<li>У сертификата есть поле <code>Serial Number</code>, которое содержит серийный номер сертификата. Серийный номер сертификата это уникальный номер, выданный центром сертификации. В моём скрипте при генерации клиентского сертификата указаны опции <code>-CAcreateserial</code> и <code>-CAserial &quot;${srl}&quot;</code>, которые позволяют OpenSSL создавать рядом с клиентскими сертификатами файлы формата <code>.slr</code>, содержащие в себе серийные номера сгенерированных сертификатов. Таким образом можно создавать небольшую локальную базу данных выданных сертификатов.</li>
<li>Файл каждого клиентского сертификата генерируется с названием вида <code>[TS].[SFX].[EXE]</code>, где <code>[TS]</code> - это временная метка в микросекундах, <code>[SFX]</code> - числовой суффикс, а <code>[EXE]</code> - расширение файлов.</li>
</ol>
<p>На этом всё. Не исключаю факта присутствия ошибок или неточностей. Если что, жду предложения в электронную почту. <span class="shortcode shortcode-emoji">😄</span></p>
<h2 id="быстрое-создание-само-подписанного-сертификата">
  <a class="link-body-emphasis" href="#%d0%b1%d1%8b%d1%81%d1%82%d1%80%d0%be%d0%b5-%d1%81%d0%be%d0%b7%d0%b4%d0%b0%d0%bd%d0%b8%d0%b5-%d1%81%d0%b0%d0%bc%d0%be-%d0%bf%d0%be%d0%b4%d0%bf%d0%b8%d1%81%d0%b0%d0%bd%d0%bd%d0%be%d0%b3%d0%be-%d1%81%d0%b5%d1%80%d1%82%d0%b8%d1%84%d0%b8%d0%ba%d0%b0%d1%82%d0%b0">Быстрое создание само-подписанного сертификата</a>
</h2><p>Для быстрого создания само-подписанного сертификата, я написал небольшой скрипт. Настройки скрипта необходимо адаптировать под себя.</p>
<h3 id="скрипт">
  <a class="link-body-emphasis" href="#%d1%81%d0%ba%d1%80%d0%b8%d0%bf%d1%82">Скрипт</a>
</h3><p>Генератор корректных SSL-сертификатов. Перед генерацией сертификата, необходимо откорректировать переменные в скрипте под проект.</p>

    

    
        
            
            <div class="shortcode shortcode-file mb-3">
              <div class="card overflow-hidden" data-bs-theme="dark">
                <div class="card-header">
                  <div class="d-flex align-items-center">
                    <div class="flex-shrink-0">
                      <i class="far fa-file-code fa-fw"></i>
                    </div>
                    <div class="flex-grow-1 mx-2 text-truncate">
                      <code>bash.openssl.ssc.sh</code>
                    </div>
                    <div class="flex-shrink-0">
                      <ul class="list-inline mb-0">
                        <li class="list-inline-item" title='Копировать'>
                          <a class="text-body" href="#"
                             data-fn="clipboard" data-clipboard-target="#cp-dc839dcd631d83172a3041cc61de9873"
                             role="button" aria-label='Копировать'>
                            <i class="fas fa-copy fa-fw"></i>
                          </a>
                        </li>
                        <li class="list-inline-item" title='Скачать'>
                          <a class="text-body" href="/ru/2023/10/6733cb51-62a0-5ed9-b421-8f08c4e0cb18/bash.openssl.ssc.sh" download
                             role="button" aria-label='Скачать'>
                            <i class="fas fa-download fa-fw"></i>
                          </a>
                        </li>
                        <li class="list-inline-item" title='Открыть'>
                          <a class="text-body" href="/ru/2023/10/6733cb51-62a0-5ed9-b421-8f08c4e0cb18/bash.openssl.ssc.sh" target="_blank"
                             role="button" aria-label='Открыть'>
                            <i class="fas fa-arrow-up-right-from-square fa-fw"></i>
                          </a>
                        </li>
                      </ul>
                    </div>
                  </div>
                </div>
                <div class="card-body p-0 overflow-auto" id="cp-dc839dcd631d83172a3041cc61de9873">
                    
                        
                    
                    <div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span><span class="lnt">56
</span><span class="lnt">57
</span><span class="lnt">58
</span><span class="lnt">59
</span><span class="lnt">60
</span><span class="lnt">61
</span><span class="lnt">62
</span><span class="lnt">63
</span><span class="lnt">64
</span><span class="lnt">65
</span><span class="lnt">66
</span><span class="lnt">67
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sh" data-lang="sh"><span class="line"><span class="cl"><span class="cp">#!/usr/bin/env -S bash -e
</span></span></span><span class="line"><span class="cl"><span class="cp"></span><span class="c1"># -------------------------------------------------------------------------------------------------------------------- #</span>
</span></span><span class="line"><span class="cl"><span class="c1"># OPENSSL SELF SIGNED CERTIFICATE GENERATOR</span>
</span></span><span class="line"><span class="cl"><span class="c1">#</span>
</span></span><span class="line"><span class="cl"><span class="c1"># @package    Bash</span>
</span></span><span class="line"><span class="cl"><span class="c1"># @author     Kai Kimera &lt;mail@kai.kim&gt;</span>
</span></span><span class="line"><span class="cl"><span class="c1"># @copyright  2024 Library Online</span>
</span></span><span class="line"><span class="cl"><span class="c1"># @license    MIT</span>
</span></span><span class="line"><span class="cl"><span class="c1"># @version    0.1.0</span>
</span></span><span class="line"><span class="cl"><span class="c1"># @link       https://lib.onl/ru/2023/10/6733cb51-62a0-5ed9-b421-8f08c4e0cb18/</span>
</span></span><span class="line"><span class="cl"><span class="c1"># -------------------------------------------------------------------------------------------------------------------- #</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="o">((</span> <span class="nv">EUID</span> <span class="o">==</span> <span class="m">0</span> <span class="o">))</span> <span class="o">&amp;&amp;</span> <span class="o">{</span> <span class="nb">echo</span> &gt;<span class="p">&amp;</span><span class="m">2</span> <span class="s1">&#39;This script should not be run as root!&#39;</span><span class="p">;</span> <span class="nb">exit</span> 1<span class="p">;</span> <span class="o">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># -------------------------------------------------------------------------------------------------------------------- #</span>
</span></span><span class="line"><span class="cl"><span class="c1"># CONFIGURATION</span>
</span></span><span class="line"><span class="cl"><span class="c1"># -------------------------------------------------------------------------------------------------------------------- #</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Specifies the number of days to make a certificate valid for.</span>
</span></span><span class="line"><span class="cl"><span class="c1"># Default is 10 years.</span>
</span></span><span class="line"><span class="cl"><span class="nv">days</span><span class="o">=</span><span class="s1">&#39;3650&#39;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># The two-letter country code where your company is legally located.</span>
</span></span><span class="line"><span class="cl"><span class="nv">country</span><span class="o">=</span><span class="s1">&#39;RU&#39;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># The state/province where your company is legally located.</span>
</span></span><span class="line"><span class="cl"><span class="nv">state</span><span class="o">=</span><span class="s1">&#39;Russia&#39;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># The city where your company is legally located.</span>
</span></span><span class="line"><span class="cl"><span class="nv">city</span><span class="o">=</span><span class="s1">&#39;Moscow&#39;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Your company&#39;s legally registered name (e.g., YourCompany, Inc.).</span>
</span></span><span class="line"><span class="cl"><span class="nv">org</span><span class="o">=</span><span class="s1">&#39;LocalHost&#39;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Your company&#39;s organizational unit.</span>
</span></span><span class="line"><span class="cl"><span class="nv">ou</span><span class="o">=</span><span class="s1">&#39;IT Department&#39;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Common name (CN). The fully-qualified domain name (FQDN) (e.g., www.example.com).</span>
</span></span><span class="line"><span class="cl"><span class="nv">cn</span><span class="o">=</span><span class="s2">&#34;</span><span class="si">${</span><span class="nv">1</span><span class="p">:?</span><span class="si">}</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Your email address.</span>
</span></span><span class="line"><span class="cl"><span class="nv">email</span><span class="o">=</span><span class="s1">&#39;mail@localhost&#39;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># -------------------------------------------------------------------------------------------------------------------- #</span>
</span></span><span class="line"><span class="cl"><span class="c1"># -----------------------------------------------------&lt; SCRIPT &gt;----------------------------------------------------- #</span>
</span></span><span class="line"><span class="cl"><span class="c1"># -------------------------------------------------------------------------------------------------------------------- #</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">! <span class="o">[[</span> -x <span class="s2">&#34;</span><span class="k">$(</span> <span class="nb">command</span> -v <span class="s1">&#39;openssl&#39;</span> <span class="k">)</span><span class="s2">&#34;</span> <span class="o">]]</span> <span class="o">&amp;&amp;</span> <span class="o">{</span> <span class="nb">echo</span> &gt;<span class="p">&amp;</span><span class="m">2</span> <span class="s2">&#34;&#39;openssl&#39; is not installed!&#34;</span><span class="p">;</span> <span class="nb">exit</span> 1<span class="p">;</span> <span class="o">}</span>
</span></span><span class="line"><span class="cl"><span class="nb">echo</span> <span class="s1">&#39;&#39;</span> <span class="o">&amp;&amp;</span> <span class="nb">echo</span> <span class="s2">&#34;--- [SSL] SELF SIGNED CERTIFICATE: &#39;</span><span class="si">${</span><span class="nv">cn</span><span class="si">}</span><span class="s2">&#39;&#34;</span> <span class="o">&amp;&amp;</span> <span class="nb">echo</span> <span class="s1">&#39;&#39;</span>
</span></span><span class="line"><span class="cl">openssl ecparam -genkey -name <span class="s1">&#39;prime256v1&#39;</span> <span class="p">|</span> openssl ec -out <span class="s2">&#34;</span><span class="si">${</span><span class="nv">cn</span><span class="si">}</span><span class="s2">.key&#34;</span> <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>  <span class="o">&amp;&amp;</span> openssl req -new -sha256 <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>  -key <span class="s2">&#34;</span><span class="si">${</span><span class="nv">cn</span><span class="si">}</span><span class="s2">.key&#34;</span> <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>  -out <span class="s2">&#34;</span><span class="si">${</span><span class="nv">cn</span><span class="si">}</span><span class="s2">.csr&#34;</span> <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>  -subj <span class="s2">&#34;/C=</span><span class="si">${</span><span class="nv">country</span><span class="si">}</span><span class="s2">/ST=</span><span class="si">${</span><span class="nv">state</span><span class="si">}</span><span class="s2">/L=</span><span class="si">${</span><span class="nv">city</span><span class="si">}</span><span class="s2">/O=</span><span class="si">${</span><span class="nv">org</span><span class="si">}</span><span class="s2">/OU=</span><span class="si">${</span><span class="nv">ou</span><span class="si">}</span><span class="s2">/CN=</span><span class="si">${</span><span class="nv">cn</span><span class="si">}</span><span class="s2">/emailAddress=</span><span class="si">${</span><span class="nv">email</span><span class="si">}</span><span class="s2">&#34;</span> <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>  -addext <span class="s2">&#34;basicConstraints = critical, CA:</span><span class="si">${</span><span class="nv">3</span><span class="k">:-</span><span class="nv">FALSE</span><span class="si">}</span><span class="s2">&#34;</span> <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>  -addext <span class="s1">&#39;nsCertType = server&#39;</span> <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>  -addext <span class="s1">&#39;nsComment = OpenSSL Generated Server Certificate&#39;</span> <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>  -addext <span class="s1">&#39;keyUsage = critical, digitalSignature, keyEncipherment&#39;</span> <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>  -addext <span class="s1">&#39;extendedKeyUsage = serverAuth, clientAuth&#39;</span> <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>  -addext <span class="s2">&#34;subjectAltName = </span><span class="si">${</span><span class="nv">2</span><span class="p">:?</span><span class="si">}</span><span class="s2">&#34;</span> <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>  <span class="o">&amp;&amp;</span> openssl x509 -req -sha256 -days <span class="si">${</span><span class="nv">days</span><span class="si">}</span> -copy_extensions <span class="s1">&#39;copyall&#39;</span> <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>  -key <span class="s2">&#34;</span><span class="si">${</span><span class="nv">cn</span><span class="si">}</span><span class="s2">.key&#34;</span> <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>  -in <span class="s2">&#34;</span><span class="si">${</span><span class="nv">cn</span><span class="si">}</span><span class="s2">.csr&#34;</span> <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>  -out <span class="s2">&#34;</span><span class="si">${</span><span class="nv">cn</span><span class="si">}</span><span class="s2">.crt&#34;</span> <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>  <span class="o">&amp;&amp;</span> openssl x509 -in <span class="s2">&#34;</span><span class="si">${</span><span class="nv">cn</span><span class="si">}</span><span class="s2">.crt&#34;</span> -text -noout
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nb">exit</span> <span class="m">0</span></span></span></code></pre></td></tr></table>
</div>
</div>
                </div>
              </div>
            </div>
        
    
<h4 id="использование-1">
  <a class="link-body-emphasis" href="#%d0%b8%d1%81%d0%bf%d0%be%d0%bb%d1%8c%d0%b7%d0%be%d0%b2%d0%b0%d0%bd%d0%b8%d0%b5-1">Использование</a>
</h4><p>Скрипт можно удалённо запросить из репозитория или запустить локально на хосте. Скрипт принимает следующие параметры согласно очерёдности:</p>
<ol>
<li><code>CN</code> - CN (Common Name).</li>
<li><code>subjectAltName</code> - subjectAltName (Alternative Name).</li>
<li><code>[TRUE|FALSE]</code> - является ли сертификат сертификатом центра сертификации и можно ли при помощи него заверять другие сертификаты. Параметр принимает значение <code>TRUE</code> или <code>FALSE</code>. По умолчанию <code>FALSE</code>.</li>
</ol>
<h4 id="удалённый-запрос-скрипта">
  <a class="link-body-emphasis" href="#%d1%83%d0%b4%d0%b0%d0%bb%d1%91%d0%bd%d0%bd%d1%8b%d0%b9-%d0%b7%d0%b0%d0%bf%d1%80%d0%be%d1%81-%d1%81%d0%ba%d1%80%d0%b8%d0%bf%d1%82%d0%b0">Удалённый запрос скрипта</a>
</h4><p>В терминале выполнить команду, подставив свои значения:</p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-12
shortcode-codeblock-bash">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-12c7bfefe6f687bc7902cd0b922c21eb" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">curl -sL <span class="s1">&#39;https://lib.onl/ru/2023/10/6733cb51-62a0-5ed9-b421-8f08c4e0cb18/bash.openssl.ssc.sh&#39;</span> <span class="p">|</span> bash -s -- <span class="s1">&#39;&lt;CN&gt;&#39;</span> <span class="s1">&#39;&lt;subjectAltName&gt;&#39;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-12c7bfefe6f687bc7902cd0b922c21eb"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>











  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-13
shortcode-codeblock-bash">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-2d9e6b641d8621f8bf6c41d536e3fee5" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">wget -qO - <span class="s1">&#39;https://lib.onl/ru/2023/10/6733cb51-62a0-5ed9-b421-8f08c4e0cb18/bash.openssl.ssc.sh&#39;</span> <span class="p">|</span> bash -s -- <span class="s1">&#39;&lt;CN&gt;&#39;</span> <span class="s1">&#39;&lt;subjectAltName&gt;&#39;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-2d9e6b641d8621f8bf6c41d536e3fee5"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<p>Например:</p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-14
shortcode-codeblock-bash">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-b53522f195eb1800ea289c84e8038fa1" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">curl -sL <span class="s1">&#39;https://lib.onl/ru/2023/10/6733cb51-62a0-5ed9-b421-8f08c4e0cb18/bash.openssl.ssc.sh&#39;</span> <span class="p">|</span> bash -s -- <span class="s1">&#39;example.com&#39;</span> <span class="s1">&#39;DNS:localhost, DNS:*.localhost, DNS:example.com, DNS:*.example.com, IP:127.0.0.1, IP:192.168.1.2&#39;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-b53522f195eb1800ea289c84e8038fa1"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>











  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-15
shortcode-codeblock-bash">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-0f6a84fd564dc17fc0c1b772825dec98" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">wget -qO - <span class="s1">&#39;https://lib.onl/ru/2023/10/6733cb51-62a0-5ed9-b421-8f08c4e0cb18/bash.openssl.ssc.sh&#39;</span> <span class="p">|</span> bash -s -- <span class="s1">&#39;example.com&#39;</span> <span class="s1">&#39;DNS:localhost, DNS:*.localhost, DNS:example.com, DNS:*.example.com, IP:127.0.0.1, IP:192.168.1.2&#39;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-0f6a84fd564dc17fc0c1b772825dec98"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<p>Таким образом, сертификат будет сгенерирован с заданными параметрами и заверен собственной подписью.</p>
<h4 id="создание-pfx">
  <a class="link-body-emphasis" href="#%d1%81%d0%be%d0%b7%d0%b4%d0%b0%d0%bd%d0%b8%d0%b5-pfx">Создание PFX</a>
</h4><p>Чтобы создать PFX-файл, необходимо выполнить следующую команду:</p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-16
shortcode-codeblock-bash">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-2ba04f7d7df9b3f34d42cfa5269b69cf" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="nv">f</span><span class="o">=</span><span class="s1">&#39;example.com&#39;</span><span class="p">;</span> openssl pkcs12 -export -certpbe PBE-SHA1-3DES -keypbe PBE-SHA1-3DES -nomac -inkey <span class="s2">&#34;</span><span class="si">${</span><span class="nv">f</span><span class="si">}</span><span class="s2">.key&#34;</span> -in <span class="s2">&#34;</span><span class="si">${</span><span class="nv">f</span><span class="si">}</span><span class="s2">.crt&#34;</span> -out <span class="s2">&#34;</span><span class="si">${</span><span class="nv">f</span><span class="si">}</span><span class="s2">.pfx&#34;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-2ba04f7d7df9b3f34d42cfa5269b69cf"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<p>Где:</p>
<ul>
<li><code>f</code> - переменная, содержащая общее название файлов.</li>
</ul>]]></turbo:content></item><item turbo="true"><title>Дополнительная страница для vBulletin 4</title><link>https://lib.onl/ru/2023/10/382d49d6-8f44-5367-bf24-88890d7c4723/</link><pubDate>Tue, 17 Oct 2023 18:01:38 +0000</pubDate><dc:creator>Kai Kimera</dc:creator><category>CMF</category><category>В истории</category><yandex:related><link url="https://lib.onl/ru/2023/10/01d19479-028f-5b81-9c58-9c99adb08461/">Дополнительная страница для vBulletin 3</link><link url="https://lib.onl/ru/2023/10/c079a268-5fb5-5d0d-8c00-0202630ce13d/">Условия в шаблонах для vBulletin 4</link><link url="https://lib.onl/ru/2023/10/f82b1436-6752-5084-ba98-264b264edca7/">Условия в шаблонах для vBulletin 3</link><link url="https://lib.onl/ru/2023/10/f0463a78-0393-5891-bbe5-c39ec575ae75/">Дополнительная страница для IP.Board 2.3</link><link url="https://lib.onl/ru/2023/10/560dfed8-9a25-5db3-95a6-a7df8129e960/">Невидимые ссылки для гостей на IP.Board 2.3</link><link url="https://lib.onl/ru/2023/10/347826e1-53d9-5c99-a6f8-66fc359323a2/">Динамическое "(Powered by Invision Power Board)" на IP.Board 2.3</link><link url="https://lib.onl/ru/2023/10/d477b5ce-8095-5607-91c7-5c5ad7b7f146/">Читабельные ссылки на темы форума для IP.Board 2.3</link><link url="https://lib.onl/ru/2023/10/a0756cae-ae3c-59ff-b587-ee8c7f3247c8/">FAQ для IP.Board 2.3</link><link url="https://lib.onl/ru/2023/10/54d4e488-9a8f-55ed-8fea-c77d4dba0720/">SQL запросы IP.Board 2.3</link><link url="https://lib.onl/ru/2023/10/06c9d359-31f0-5862-a342-62a21d4eb032/">SQL запросы IP.Board 3.x</link><link url="https://lib.onl/ru/2023/10/0743e73e-7c4c-5ab8-bba3-ba70bdb5cdfd/">Условия в файлах IP.Board 2.3</link><link url="https://lib.onl/ru/2023/10/d310a44c-4259-5bef-a7c2-d3d09a5c69f4/">Условия в шаблонах IP.Board 2.3</link><link url="https://lib.onl/ru/2023/10/a7405294-9f0c-52c1-a70e-ce4990079dc7/">Условия в шаблонах IP.Board 3.x</link></yandex:related><turbo:extendedHtml>true</turbo:extendedHtml><turbo:source>https://lib.onl/ru/2023/10/382d49d6-8f44-5367-bf24-88890d7c4723/</turbo:source><turbo:topic>Дополнительная страница для vBulletin 4</turbo:topic><turbo:content><![CDATA[<p>Создание дополнительных страниц для уже устаревшего форумного движка <span class="shortcode shortcode-tag"><a href="/ru/tags/vbulletin/" target="_blank">#vBulletin</a></span> 4.</p>
<p>Для <span class="shortcode shortcode-tag"><a href="/ru/tags/vbulletin/" target="_blank">#vBulletin</a></span> версии <strong>4.0</strong> действия практически одни и те же, как в материале <span class="shortcode shortcode-uuid"><a href="/ru/2023/10/01d19479-028f-5b81-9c58-9c99adb08461/">Дополнительная страница для vBulletin 3</a></span>.</p>
<h2 id="что-такое-дополнительная-страница-или-custom-pages">
  <a class="link-body-emphasis" href="#%d1%87%d1%82%d0%be-%d1%82%d0%b0%d0%ba%d0%be%d0%b5-%d0%b4%d0%be%d0%bf%d0%be%d0%bb%d0%bd%d0%b8%d1%82%d0%b5%d0%bb%d1%8c%d0%bd%d0%b0%d1%8f-%d1%81%d1%82%d1%80%d0%b0%d0%bd%d0%b8%d1%86%d0%b0-%d0%b8%d0%bb%d0%b8-custom-pages">Что такое дополнительная страница (или Custom Pages)?</a>
</h2><p>Дополнительная страница (или Custom Pages) - это страница, &ldquo;совмещённая&rdquo; со стилем форума.</p>
<h2 id="как-сделать-дополнительную-страницу">
  <a class="link-body-emphasis" href="#%d0%ba%d0%b0%d0%ba-%d1%81%d0%b4%d0%b5%d0%bb%d0%b0%d1%82%d1%8c-%d0%b4%d0%be%d0%bf%d0%be%d0%bb%d0%bd%d0%b8%d1%82%d0%b5%d0%bb%d1%8c%d0%bd%d1%83%d1%8e-%d1%81%d1%82%d1%80%d0%b0%d0%bd%d0%b8%d1%86%d1%83">Как сделать дополнительную страницу?</a>
</h2><p>Необходимо создать шаблон <code>custom_ШАБЛОН</code>, содержимое которого представляет собой следующий код:</p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-0
shortcode-codeblock-html">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-5adc68a3aeb2121a51af7071c646e0f4" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-html" data-lang="html"><span class="line"><span class="cl">{vb:stylevar htmldoctype}
</span></span><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">html</span> <span class="na">xmlns</span><span class="o">=</span><span class="s">&#34;http://www.w3.org/1999/xhtml&#34;</span> <span class="na">dir</span><span class="o">=</span><span class="s">&#34;{vb:stylevar textdirection}&#34;</span> <span class="na">lang</span><span class="o">=</span><span class="s">&#34;{vb:stylevar languagecode}&#34;</span> <span class="na">id</span><span class="o">=</span><span class="s">&#34;vbulletin_html&#34;</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">head</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="p">&lt;</span><span class="nt">title</span><span class="p">&gt;</span>{vb:raw vboptions.bbtitle}<span class="p">&lt;/</span><span class="nt">title</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">  {vb:raw headinclude}
</span></span><span class="line"><span class="cl"><span class="p">&lt;/</span><span class="nt">head</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">body</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">  {vb:raw header}
</span></span><span class="line"><span class="cl">  {vb:raw navbar}
</span></span><span class="line"><span class="cl">  <span class="p">&lt;</span><span class="nt">div</span> <span class="na">id</span><span class="o">=</span><span class="s">&#34;pagetitle&#34;</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="p">&lt;</span><span class="nt">h1</span><span class="p">&gt;</span>{vb:raw pagetitle}<span class="p">&lt;/</span><span class="nt">h1</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="p">&lt;</span><span class="nt">h2</span> <span class="na">class</span><span class="o">=</span><span class="s">&#34;blockhead&#34;</span><span class="p">&gt;</span><span class="c">&lt;!-- Заголовок страницы --&gt;</span><span class="p">&lt;/</span><span class="nt">h2</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="p">&lt;</span><span class="nt">div</span> <span class="na">class</span><span class="o">=</span><span class="s">&#34;blockbody&#34;</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="p">&lt;</span><span class="nt">div</span> <span class="na">class</span><span class="o">=</span><span class="s">&#34;blockrow&#34;</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">      <span class="c">&lt;!-- Текст страницы --&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">  {vb:raw footer}
</span></span><span class="line"><span class="cl"><span class="p">&lt;/</span><span class="nt">body</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl"><span class="p">&lt;/</span><span class="nt">html</span><span class="p">&gt;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-5adc68a3aeb2121a51af7071c646e0f4"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<p>Страница будет располагаться по адресу:</p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-1
shortcode-codeblock-plaintext">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-fffc2fe588832ac503242fb5ee4638b7" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-plaintext" data-lang="plaintext"><span class="line"><span class="cl">https://example.com/misc.php?do=page&amp;template=ШАБЛОН</span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-fffc2fe588832ac503242fb5ee4638b7"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>]]></turbo:content></item><item turbo="true"><title>Дополнительная страница для vBulletin 3</title><link>https://lib.onl/ru/2023/10/01d19479-028f-5b81-9c58-9c99adb08461/</link><pubDate>Tue, 17 Oct 2023 17:39:09 +0000</pubDate><dc:creator>Kai Kimera</dc:creator><category>CMF</category><category>В истории</category><yandex:related><link url="https://lib.onl/ru/2023/10/c079a268-5fb5-5d0d-8c00-0202630ce13d/">Условия в шаблонах для vBulletin 4</link><link url="https://lib.onl/ru/2023/10/f82b1436-6752-5084-ba98-264b264edca7/">Условия в шаблонах для vBulletin 3</link><link url="https://lib.onl/ru/2023/10/f0463a78-0393-5891-bbe5-c39ec575ae75/">Дополнительная страница для IP.Board 2.3</link><link url="https://lib.onl/ru/2023/10/560dfed8-9a25-5db3-95a6-a7df8129e960/">Невидимые ссылки для гостей на IP.Board 2.3</link><link url="https://lib.onl/ru/2023/10/347826e1-53d9-5c99-a6f8-66fc359323a2/">Динамическое "(Powered by Invision Power Board)" на IP.Board 2.3</link><link url="https://lib.onl/ru/2023/10/d477b5ce-8095-5607-91c7-5c5ad7b7f146/">Читабельные ссылки на темы форума для IP.Board 2.3</link><link url="https://lib.onl/ru/2023/10/a0756cae-ae3c-59ff-b587-ee8c7f3247c8/">FAQ для IP.Board 2.3</link><link url="https://lib.onl/ru/2023/10/54d4e488-9a8f-55ed-8fea-c77d4dba0720/">SQL запросы IP.Board 2.3</link><link url="https://lib.onl/ru/2023/10/06c9d359-31f0-5862-a342-62a21d4eb032/">SQL запросы IP.Board 3.x</link><link url="https://lib.onl/ru/2023/10/0743e73e-7c4c-5ab8-bba3-ba70bdb5cdfd/">Условия в файлах IP.Board 2.3</link><link url="https://lib.onl/ru/2023/10/d310a44c-4259-5bef-a7c2-d3d09a5c69f4/">Условия в шаблонах IP.Board 2.3</link><link url="https://lib.onl/ru/2023/10/a7405294-9f0c-52c1-a70e-ce4990079dc7/">Условия в шаблонах IP.Board 3.x</link></yandex:related><turbo:extendedHtml>true</turbo:extendedHtml><turbo:source>https://lib.onl/ru/2023/10/01d19479-028f-5b81-9c58-9c99adb08461/</turbo:source><turbo:topic>Дополнительная страница для vBulletin 3</turbo:topic><turbo:content><![CDATA[<p>Материал по созданию дополнительных страниц в <span class="shortcode shortcode-tag"><a href="/ru/tags/vbulletin/" target="_blank">#vBulletin</a></span> 3. Возможно, кто-то ещё пользуется этой версией движка&hellip;</p>
<h2 id="что-такое-дополнительная-страница-или-custom-pages">
  <a class="link-body-emphasis" href="#%d1%87%d1%82%d0%be-%d1%82%d0%b0%d0%ba%d0%be%d0%b5-%d0%b4%d0%be%d0%bf%d0%be%d0%bb%d0%bd%d0%b8%d1%82%d0%b5%d0%bb%d1%8c%d0%bd%d0%b0%d1%8f-%d1%81%d1%82%d1%80%d0%b0%d0%bd%d0%b8%d1%86%d0%b0-%d0%b8%d0%bb%d0%b8-custom-pages">Что такое дополнительная страница (или Custom Pages)?</a>
</h2><p>Дополнительная страница (или Custom Pages) - это страница, &ldquo;совмещённая&rdquo; со стилем форума и находится по адресу:</p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-0
shortcode-codeblock-plaintext">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-6aea08ef1f0c91f474fda091f9df6b2c" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-plaintext" data-lang="plaintext"><span class="line"><span class="cl">http://example.com/misc.php?do=page&amp;template=название_страницы</span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-6aea08ef1f0c91f474fda091f9df6b2c"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<h2 id="как-сделать-дополнительную-страницу">
  <a class="link-body-emphasis" href="#%d0%ba%d0%b0%d0%ba-%d1%81%d0%b4%d0%b5%d0%bb%d0%b0%d1%82%d1%8c-%d0%b4%d0%be%d0%bf%d0%be%d0%bb%d0%bd%d0%b8%d1%82%d0%b5%d0%bb%d1%8c%d0%bd%d1%83%d1%8e-%d1%81%d1%82%d1%80%d0%b0%d0%bd%d0%b8%d1%86%d1%83">Как сделать дополнительную страницу?</a>
</h2><p>Итак, для начала нужно создать дополнительный шаблон того стиля, который вами используется. Этот дополнительный шаблон должен иметь префикс <code>custom_</code>, то есть само название дополнительного шаблона должно выглядеть вот так: <code>custom_ШАБЛОН</code>.</p>
<p>После этого в тело шаблона вставляем следующий код:</p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-1
shortcode-codeblock-html">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-bebfe9da1a44888f3603774bc4d6c85b" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-html" data-lang="html"><span class="line"><span class="cl">$stylevar[htmldoctype]
</span></span><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">html</span> <span class="na">dir</span><span class="o">=</span><span class="s">&#34;$stylevar[textdirection]&#34;</span> <span class="na">lang</span><span class="o">=</span><span class="s">&#34;$stylevar[languagecode]&#34;</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="p">&lt;</span><span class="nt">head</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">    $headinclude
</span></span><span class="line"><span class="cl">    <span class="p">&lt;</span><span class="nt">title</span><span class="p">&gt;</span>$vboptions[bbtitle]<span class="p">&lt;/</span><span class="nt">title</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="p">&lt;/</span><span class="nt">head</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="p">&lt;</span><span class="nt">body</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">    $header
</span></span><span class="line"><span class="cl">    $navbar
</span></span><span class="line"><span class="cl">    <span class="c">&lt;!-- На этом месте будет находится ваш код страницы. --&gt;</span>
</span></span><span class="line"><span class="cl">    $footer
</span></span><span class="line"><span class="cl">  <span class="p">&lt;/</span><span class="nt">body</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl"><span class="p">&lt;/</span><span class="nt">html</span><span class="p">&gt;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-bebfe9da1a44888f3603774bc4d6c85b"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<p>Вот и всё!</p>]]></turbo:content></item><item turbo="true"><title>Дополнительная страница для IP.Board 2.3</title><link>https://lib.onl/ru/2023/10/f0463a78-0393-5891-bbe5-c39ec575ae75/</link><pubDate>Tue, 17 Oct 2023 17:39:08 +0000</pubDate><dc:creator>Kai Kimera</dc:creator><category>CMF</category><category>В истории</category><yandex:related><link url="https://lib.onl/ru/2023/10/560dfed8-9a25-5db3-95a6-a7df8129e960/">Невидимые ссылки для гостей на IP.Board 2.3</link><link url="https://lib.onl/ru/2023/10/347826e1-53d9-5c99-a6f8-66fc359323a2/">Динамическое "(Powered by Invision Power Board)" на IP.Board 2.3</link><link url="https://lib.onl/ru/2023/10/d477b5ce-8095-5607-91c7-5c5ad7b7f146/">Читабельные ссылки на темы форума для IP.Board 2.3</link><link url="https://lib.onl/ru/2023/10/a0756cae-ae3c-59ff-b587-ee8c7f3247c8/">FAQ для IP.Board 2.3</link><link url="https://lib.onl/ru/2023/10/54d4e488-9a8f-55ed-8fea-c77d4dba0720/">SQL запросы IP.Board 2.3</link><link url="https://lib.onl/ru/2023/10/06c9d359-31f0-5862-a342-62a21d4eb032/">SQL запросы IP.Board 3.x</link><link url="https://lib.onl/ru/2023/10/0743e73e-7c4c-5ab8-bba3-ba70bdb5cdfd/">Условия в файлах IP.Board 2.3</link><link url="https://lib.onl/ru/2023/10/d310a44c-4259-5bef-a7c2-d3d09a5c69f4/">Условия в шаблонах IP.Board 2.3</link><link url="https://lib.onl/ru/2023/10/a7405294-9f0c-52c1-a70e-ce4990079dc7/">Условия в шаблонах IP.Board 3.x</link><link url="https://lib.onl/ru/2023/10/c079a268-5fb5-5d0d-8c00-0202630ce13d/">Условия в шаблонах для vBulletin 4</link><link url="https://lib.onl/ru/2023/10/f82b1436-6752-5084-ba98-264b264edca7/">Условия в шаблонах для vBulletin 3</link></yandex:related><turbo:extendedHtml>true</turbo:extendedHtml><turbo:source>https://lib.onl/ru/2023/10/f0463a78-0393-5891-bbe5-c39ec575ae75/</turbo:source><turbo:topic>Дополнительная страница для IP.Board 2.3</turbo:topic><turbo:content><![CDATA[<p>Ещё один артефакт прошлого. Инструкция по созданию дополнительных страниц в <span class="shortcode shortcode-tag"><a href="/ru/tags/ipb/" target="_blank">#IPB</a></span> 2.3. Старая, но вдруг кому-то пригодится.</p>
<h2 id="что-такое-дополнительная-страница-или-custom-pages">
  <a class="link-body-emphasis" href="#%d1%87%d1%82%d0%be-%d1%82%d0%b0%d0%ba%d0%be%d0%b5-%d0%b4%d0%be%d0%bf%d0%be%d0%bb%d0%bd%d0%b8%d1%82%d0%b5%d0%bb%d1%8c%d0%bd%d0%b0%d1%8f-%d1%81%d1%82%d1%80%d0%b0%d0%bd%d0%b8%d1%86%d0%b0-%d0%b8%d0%bb%d0%b8-custom-pages">Что такое дополнительная страница (или Custom Pages)?</a>
</h2><p>Дополнительная страница (или Custom Pages) - это страница, &ldquo;совмещённая&rdquo; со стилем форума и находится по адресу:</p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-0
shortcode-codeblock-plaintext">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-da793bb43acb9c83ea1c0b391f117b72" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-plaintext" data-lang="plaintext"><span class="line"><span class="cl">http://example.com/index.php?autocom=название_страницы</span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-da793bb43acb9c83ea1c0b391f117b72"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<p>Объект <code>название_страницы</code> представляет собой название файла <code>.php</code> дополнительной страницы.</p>
<h2 id="как-сделать-дополнительную-страницу">
  <a class="link-body-emphasis" href="#%d0%ba%d0%b0%d0%ba-%d1%81%d0%b4%d0%b5%d0%bb%d0%b0%d1%82%d1%8c-%d0%b4%d0%be%d0%bf%d0%be%d0%bb%d0%bd%d0%b8%d1%82%d0%b5%d0%bb%d1%8c%d0%bd%d1%83%d1%8e-%d1%81%d1%82%d1%80%d0%b0%d0%bd%d0%b8%d1%86%d1%83">Как сделать дополнительную страницу?</a>
</h2><p>Создаём файл <code>.php</code> следующего содержания:</p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-1
shortcode-codeblock-php">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-54c9a26e0c6a804e935bfae5ff36e2e9" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="o">&lt;?</span><span class="nx">php</span>
</span></span><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">component_public</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="k">var</span> <span class="nv">$ipsclass</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="k">function</span> <span class="nf">run_component</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">  <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">pagetitle</span> <span class="o">=</span> <span class="s2">&#34;Название страницы&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="cm">/* Здесь идёт название вашей страницы.
</span></span></span><span class="line"><span class="cl"><span class="cm">    Название также будет показано в панели навигации вашего форума. */</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">nav</span><span class="p">[]</span> <span class="o">=</span> <span class="s2">&#34;&lt;a href=&#39;</span><span class="si">{</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">ipsclass</span><span class="o">-&gt;</span><span class="na">base_url</span><span class="si">}</span><span class="s2">autocom=custom&#39;&gt;</span><span class="si">{</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">pagetitle</span><span class="si">}</span><span class="s2">&lt;/a&gt;&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">ipsclass</span><span class="o">-&gt;</span><span class="na">load_template</span><span class="p">(</span><span class="s1">&#39;skin_global&#39;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="nv">$output</span> <span class="o">.=</span> <span class="s2">&#34;Здесь содержимое страницы&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="cm">/* Здесь будет содержимое вашей будущей страницы.
</span></span></span><span class="line"><span class="cl"><span class="cm">    Содержимое помещается между кавычками.
</span></span></span><span class="line"><span class="cl"><span class="cm">    Также, как обычно, вам доступен HTML-код. */</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">ipsclass</span><span class="o">-&gt;</span><span class="na">print</span><span class="o">-&gt;</span><span class="na">add_output</span><span class="p">(</span><span class="nv">$output</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">ipsclass</span><span class="o">-&gt;</span><span class="na">print</span><span class="o">-&gt;</span><span class="na">do_output</span><span class="p">(</span><span class="k">array</span><span class="p">(</span><span class="s1">&#39;TITLE&#39;</span> <span class="o">=&gt;</span> <span class="s2">&#34;</span><span class="si">{</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">ipsclass</span><span class="o">-&gt;</span><span class="na">vars</span><span class="p">[</span><span class="s1">&#39;board_name&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2"> - </span><span class="si">{</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">pagetitle</span><span class="si">}</span><span class="s2">&#34;</span><span class="p">,</span> <span class="s1">&#39;JS&#39;</span> <span class="o">=&gt;</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;NAV&#39;</span> <span class="o">=&gt;</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">nav</span><span class="p">));</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-54c9a26e0c6a804e935bfae5ff36e2e9"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<p>В самом коде установлены комментарии, так что вы без труда разберётесь что к чему.</p>
<p>После создания этого PHP-файла, вы должны поместить его в папку <code>./sources/components_public</code>.</p>
<p>Всё!</p>]]></turbo:content></item><item turbo="true"><title>Условия в шаблонах для vBulletin 4</title><link>https://lib.onl/ru/2023/10/c079a268-5fb5-5d0d-8c00-0202630ce13d/</link><pubDate>Tue, 17 Oct 2023 17:20:56 +0000</pubDate><dc:creator>Kai Kimera</dc:creator><category>CMF</category><category>В истории</category><yandex:related><link url="https://lib.onl/ru/2023/10/f82b1436-6752-5084-ba98-264b264edca7/">Условия в шаблонах для vBulletin 3</link><link url="https://lib.onl/ru/2023/10/560dfed8-9a25-5db3-95a6-a7df8129e960/">Невидимые ссылки для гостей на IP.Board 2.3</link><link url="https://lib.onl/ru/2023/10/347826e1-53d9-5c99-a6f8-66fc359323a2/">Динамическое "(Powered by Invision Power Board)" на IP.Board 2.3</link><link url="https://lib.onl/ru/2023/10/d477b5ce-8095-5607-91c7-5c5ad7b7f146/">Читабельные ссылки на темы форума для IP.Board 2.3</link><link url="https://lib.onl/ru/2023/10/a0756cae-ae3c-59ff-b587-ee8c7f3247c8/">FAQ для IP.Board 2.3</link><link url="https://lib.onl/ru/2023/10/54d4e488-9a8f-55ed-8fea-c77d4dba0720/">SQL запросы IP.Board 2.3</link><link url="https://lib.onl/ru/2023/10/06c9d359-31f0-5862-a342-62a21d4eb032/">SQL запросы IP.Board 3.x</link><link url="https://lib.onl/ru/2023/10/0743e73e-7c4c-5ab8-bba3-ba70bdb5cdfd/">Условия в файлах IP.Board 2.3</link><link url="https://lib.onl/ru/2023/10/d310a44c-4259-5bef-a7c2-d3d09a5c69f4/">Условия в шаблонах IP.Board 2.3</link><link url="https://lib.onl/ru/2023/10/a7405294-9f0c-52c1-a70e-ce4990079dc7/">Условия в шаблонах IP.Board 3.x</link></yandex:related><turbo:extendedHtml>true</turbo:extendedHtml><turbo:source>https://lib.onl/ru/2023/10/c079a268-5fb5-5d0d-8c00-0202630ce13d/</turbo:source><turbo:topic>Условия в шаблонах для vBulletin 4</turbo:topic><turbo:content><![CDATA[<p>Набор условий для применения в шаблонах форумного движка <span class="shortcode shortcode-tag"><a href="/ru/tags/vbulletin/" target="_blank">#vBulletin</a></span> 4. К сожалению, версия 4 оказалась провальной. Зато, из неё родился всем известный <span class="shortcode shortcode-tag"><a href="/ru/tags/xenforo/" target="_blank">#XenForo</a></span>!</p>
<h2 id="обычные-условия">
  <a class="link-body-emphasis" href="#%d0%be%d0%b1%d1%8b%d1%87%d0%bd%d1%8b%d0%b5-%d1%83%d1%81%d0%bb%d0%be%d0%b2%d0%b8%d1%8f">Обычные условия</a>
</h2><ol>
<li>Показать информацию только для пользователей</li>
</ol>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-0
shortcode-codeblock-html">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-2c5e720198cdd8890cb3a3fc85fa8604" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-html" data-lang="html"><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">vb:if</span> <span class="na">condition</span><span class="o">=</span><span class="s">&#34;$show[&#39;member&#39;]&#34;</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="c">&lt;!-- информация только для пользователей --&gt;</span>
</span></span><span class="line"><span class="cl"><span class="p">&lt;/</span><span class="nt">vb:if</span><span class="p">&gt;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-2c5e720198cdd8890cb3a3fc85fa8604"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<ol start="2">
<li>Показать информацию только для гостей</li>
</ol>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-1
shortcode-codeblock-html">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-1082864ddcd6bcdd10d6feba044830dc" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-html" data-lang="html"><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">vb:if</span> <span class="na">condition</span><span class="o">=</span><span class="s">&#34;$show[&#39;guest&#39;]&#34;</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="c">&lt;!-- информация только для гостей --&gt;</span>
</span></span><span class="line"><span class="cl"><span class="p">&lt;/</span><span class="nt">vb:if</span><span class="p">&gt;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-1082864ddcd6bcdd10d6feba044830dc"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<ol start="3">
<li>Показать информацию только для определённой группы.</li>
</ol>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-2
shortcode-codeblock-html">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-9574e586415aca23f1199cf2d9cbcc57" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-html" data-lang="html"><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">vb:if</span> <span class="na">condition</span><span class="o">=</span><span class="s">&#34;is_member_of($bbuserinfo, 1,2,3)&#34;</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="c">&lt;!-- информация только для группы с ID = 1, 2 и 3 --&gt;</span>
</span></span><span class="line"><span class="cl"><span class="p">&lt;/</span><span class="nt">vb:if</span><span class="p">&gt;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-9574e586415aca23f1199cf2d9cbcc57"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<ol start="4">
<li>Показать информацию только для определённой группы в сообщении.</li>
</ol>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-3
shortcode-codeblock-html">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-f1e0554aa8452f13b5ef4556251b480e" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-html" data-lang="html"><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">vb:if</span> <span class="na">condition</span><span class="o">=</span><span class="s">&#34;is_member_of($post, 1,2,3)&#34;</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="c">&lt;!-- информация только для группы с ID = 1, 2 и 3 --&gt;</span>
</span></span><span class="line"><span class="cl"><span class="p">&lt;/</span><span class="nt">vb:if</span><span class="p">&gt;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-f1e0554aa8452f13b5ef4556251b480e"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<ol start="5">
<li>Показать информацию только для определённого пользователя.</li>
</ol>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-4
shortcode-codeblock-html">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-6fedd82e37ea4328123f6e1830b5bc15" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-html" data-lang="html"><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">vb:if</span> <span class="na">condition</span><span class="o">=</span><span class="s">&#34;$bbuserinfo[&#39;userid&#39;] == 318713&#34;</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="c">&lt;!-- информация только для пользователя с ID = 318713 --&gt;</span>
</span></span><span class="line"><span class="cl"><span class="p">&lt;/</span><span class="nt">vb:if</span><span class="p">&gt;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-6fedd82e37ea4328123f6e1830b5bc15"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<ol start="6">
<li>Показать информацию для всех, кроме определённого пользователя.</li>
</ol>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-5
shortcode-codeblock-html">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-00616ea5a3bfabe728b7f527949fcbbb" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-html" data-lang="html"><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">vb:if</span> <span class="na">condition</span><span class="o">=</span><span class="s">&#34;$bbuserinfo[&#39;userid&#39;] != 318713&#34;</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="c">&lt;!-- информация для всех, кроме пользователя с ID = 318713 --&gt;</span>
</span></span><span class="line"><span class="cl"><span class="p">&lt;/</span><span class="nt">vb:if</span><span class="p">&gt;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-00616ea5a3bfabe728b7f527949fcbbb"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<ol start="7">
<li>Показать информацию для всех модераторов во всех форумах.</li>
</ol>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-6
shortcode-codeblock-html">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-285dcb17f9a2f04b003ec81b06720322" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-html" data-lang="html"><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">vb:if</span> <span class="na">condition</span><span class="o">=</span><span class="s">&#34;can_moderate()&#34;</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="c">&lt;!-- информация для модераторов во всех форумах --&gt;</span>
</span></span><span class="line"><span class="cl"><span class="p">&lt;/</span><span class="nt">vb:if</span><span class="p">&gt;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-285dcb17f9a2f04b003ec81b06720322"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<ol start="8">
<li>Показать информацию для модератора в определённом форуме.</li>
</ol>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-7
shortcode-codeblock-html">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-bbd5c6bfcf86e2de4e3d0dda344b8d94" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-html" data-lang="html"><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">vb:if</span> <span class="na">condition</span><span class="o">=</span><span class="s">&#34;can_moderate($forum[&#39;x])&#34;</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="c">&lt;!-- информация для модератора определённого форума с ID = X --&gt;</span>
</span></span><span class="line"><span class="cl"><span class="p">&lt;/</span><span class="nt">vb:if</span><span class="p">&gt;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-bbd5c6bfcf86e2de4e3d0dda344b8d94"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<ol start="9">
<li>Показать информацию во всех форумах, кроме одного.</li>
</ol>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-8
shortcode-codeblock-html">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-207278e23b2539a70e88fd95480858a5" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-html" data-lang="html"><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">vb:if</span> <span class="na">condition</span><span class="o">=</span><span class="s">&#34;$forum[forumid] != x&#34;</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="c">&lt;!-- информация во всех форумах, кроме ID = X --&gt;</span>
</span></span><span class="line"><span class="cl"><span class="p">&lt;/</span><span class="nt">vb:if</span><span class="p">&gt;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-207278e23b2539a70e88fd95480858a5"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<ol start="10">
<li>Показать информацию в определённых форумах.</li>
</ol>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-9
shortcode-codeblock-html">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-fc9ebebf37c1b4b09fd2811993906730" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-html" data-lang="html"><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">vb:if</span> <span class="na">condition</span><span class="o">=</span><span class="s">&#34;in_array($forum[&#39;forumid&#39;], array(1,2,3))&#34;</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="c">&lt;!-- информация для форумов с ID = 1, 2 или 3 --&gt;</span>
</span></span><span class="line"><span class="cl"><span class="p">&lt;/</span><span class="nt">vb:if</span><span class="p">&gt;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-fc9ebebf37c1b4b09fd2811993906730"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<ol start="11">
<li>Показать информацию только на определённой странице.</li>
</ol>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-10
shortcode-codeblock-html">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-40460e5b87fd3be1021337456ca692cc" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-html" data-lang="html"><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">vb:if</span> <span class="na">condition</span><span class="o">=</span><span class="s">&#34;THIS_SCRIPT == &#39;calendar&#39;&#34;</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="c">&lt;!-- Показать информацию в calendar.php --&gt;</span>
</span></span><span class="line"><span class="cl"><span class="p">&lt;/</span><span class="nt">vb:if</span><span class="p">&gt;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-40460e5b87fd3be1021337456ca692cc"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<ol start="12">
<li>Показать информацию везде, кроме определённой страницы.</li>
</ol>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-11
shortcode-codeblock-html">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-0855363a4de476654d710e41a233cd6d" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-html" data-lang="html"><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">vb:if</span> <span class="na">condition</span><span class="o">=</span><span class="s">&#34;THIS_SCRIPT != &#39;calendar&#39;&#34;</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="c">&lt;!-- информация на всех страницах, кроме calendar.php --&gt;</span>
</span></span><span class="line"><span class="cl"><span class="p">&lt;/</span><span class="nt">vb:if</span><span class="p">&gt;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-0855363a4de476654d710e41a233cd6d"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<ol start="13">
<li>Показать информацию, если переменная активна.</li>
</ol>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-12
shortcode-codeblock-html">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-6117fe260c23ed5830010d95a0be1d6b" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-html" data-lang="html"><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">vb:if</span> <span class="na">condition</span><span class="o">=</span><span class="s">&#34;$customvar&#34;</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="c">&lt;!-- показать, если переменная $customvar активна --&gt;</span>
</span></span><span class="line"><span class="cl"><span class="p">&lt;/</span><span class="nt">vb:if</span><span class="p">&gt;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-6117fe260c23ed5830010d95a0be1d6b"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<ol start="14">
<li>Показать информацию, если переменная имеет значение.</li>
</ol>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-13
shortcode-codeblock-html">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-b57f6723a47a276d672514ac51cc2567" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-html" data-lang="html"><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">vb:if</span> <span class="na">condition</span><span class="o">=</span><span class="s">&#34;$customvar == значение&#34;</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="c">&lt;!-- показать, если переменная $customvar имеет значение &#34;значение&#34; --&gt;</span>
</span></span><span class="line"><span class="cl"><span class="p">&lt;/</span><span class="nt">vb:if</span><span class="p">&gt;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-b57f6723a47a276d672514ac51cc2567"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<ol start="15">
<li>Показать информацию, если переменная НЕ имеет значение.</li>
</ol>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-14
shortcode-codeblock-html">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-c41c118df7c04fd2569b38c67240f411" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-html" data-lang="html"><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">vb:if</span> <span class="na">condition</span><span class="o">=</span><span class="s">&#34;$customvar != значение&#34;</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="c">&lt;!-- показать, если переменная $customvar на имеет значение &#34;значение&#34; --&gt;</span>
</span></span><span class="line"><span class="cl"><span class="p">&lt;/</span><span class="nt">vb:if</span><span class="p">&gt;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-c41c118df7c04fd2569b38c67240f411"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<ol start="16">
<li>Показать информацию только для пользователя не набравшего определённого количества сообщений.</li>
</ol>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-15
shortcode-codeblock-html">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-b24d139833e9f3d7825a25db0c10a75c" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-html" data-lang="html"><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">vb:if</span> <span class="na">condition</span><span class="o">=</span><span class="s">&#34;$post[posts] &lt; 10&#34;</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="c">&lt;!-- информация для пользователя, не набравшего 10 сообщений --&gt;</span>
</span></span><span class="line"><span class="cl"><span class="p">&lt;/</span><span class="nt">vb:if</span><span class="p">&gt;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-b24d139833e9f3d7825a25db0c10a75c"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<h2 id="комбинированные-условия">
  <a class="link-body-emphasis" href="#%d0%ba%d0%be%d0%bc%d0%b1%d0%b8%d0%bd%d0%b8%d1%80%d0%be%d0%b2%d0%b0%d0%bd%d0%bd%d1%8b%d0%b5-%d1%83%d1%81%d0%bb%d0%be%d0%b2%d0%b8%d1%8f">Комбинированные условия</a>
</h2>








  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-16
shortcode-codeblock-html">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-40d943683bf20b15e2b2d4c314ff34fa" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-html" data-lang="html"><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">vb:if</span> <span class="na">condition</span><span class="o">=</span><span class="s">&#34;$show[&#39;guest&#39;]&#34;</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="c">&lt;!-- показать только для гостей --&gt;</span>
</span></span><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">vb:else</span> <span class="p">/&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="c">&lt;!-- показать только зарегистрированным пользователям --&gt;</span>
</span></span><span class="line"><span class="cl"><span class="p">&lt;/</span><span class="nt">vb:if</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">vb:if</span> <span class="na">condition</span><span class="o">=</span><span class="s">&#34;$show[&#39;guest&#39;]&#34;</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="c">&lt;!-- показать только для гостей --&gt;</span>
</span></span><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">vb:elseif</span> <span class="na">condition</span><span class="o">=</span><span class="s">&#34;is_member_of($bbuserinfo, 5,6)&#34;</span> <span class="p">/&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="c">&lt;!-- показать только для групп пользователей с ID = 5 и 6 --&gt;</span>
</span></span><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">vb:else</span> <span class="p">/&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="c">&lt;!-- показать только зарегистрированным пользователям --&gt;</span>
</span></span><span class="line"><span class="cl"><span class="p">&lt;/</span><span class="nt">vb:if</span><span class="p">&gt;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-40d943683bf20b15e2b2d4c314ff34fa"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>]]></turbo:content></item><item turbo="true"><title>Условия в шаблонах для vBulletin 3</title><link>https://lib.onl/ru/2023/10/f82b1436-6752-5084-ba98-264b264edca7/</link><pubDate>Tue, 17 Oct 2023 17:07:58 +0000</pubDate><dc:creator>Kai Kimera</dc:creator><category>CMF</category><category>В истории</category><yandex:related><link url="https://lib.onl/ru/2023/10/560dfed8-9a25-5db3-95a6-a7df8129e960/">Невидимые ссылки для гостей на IP.Board 2.3</link><link url="https://lib.onl/ru/2023/10/347826e1-53d9-5c99-a6f8-66fc359323a2/">Динамическое "(Powered by Invision Power Board)" на IP.Board 2.3</link><link url="https://lib.onl/ru/2023/10/d477b5ce-8095-5607-91c7-5c5ad7b7f146/">Читабельные ссылки на темы форума для IP.Board 2.3</link><link url="https://lib.onl/ru/2023/10/a0756cae-ae3c-59ff-b587-ee8c7f3247c8/">FAQ для IP.Board 2.3</link><link url="https://lib.onl/ru/2023/10/54d4e488-9a8f-55ed-8fea-c77d4dba0720/">SQL запросы IP.Board 2.3</link><link url="https://lib.onl/ru/2023/10/06c9d359-31f0-5862-a342-62a21d4eb032/">SQL запросы IP.Board 3.x</link><link url="https://lib.onl/ru/2023/10/0743e73e-7c4c-5ab8-bba3-ba70bdb5cdfd/">Условия в файлах IP.Board 2.3</link><link url="https://lib.onl/ru/2023/10/d310a44c-4259-5bef-a7c2-d3d09a5c69f4/">Условия в шаблонах IP.Board 2.3</link><link url="https://lib.onl/ru/2023/10/a7405294-9f0c-52c1-a70e-ce4990079dc7/">Условия в шаблонах IP.Board 3.x</link></yandex:related><turbo:extendedHtml>true</turbo:extendedHtml><turbo:source>https://lib.onl/ru/2023/10/f82b1436-6752-5084-ba98-264b264edca7/</turbo:source><turbo:topic>Условия в шаблонах для vBulletin 3</turbo:topic><turbo:content><![CDATA[<p>Набор условий для применения в шаблонах форумного движка <span class="shortcode shortcode-tag"><a href="/ru/tags/vbulletin/" target="_blank">#vBulletin</a></span> 3.</p>
<h2 id="условия-в-шаблонах">
  <a class="link-body-emphasis" href="#%d1%83%d1%81%d0%bb%d0%be%d0%b2%d0%b8%d1%8f-%d0%b2-%d1%88%d0%b0%d0%b1%d0%bb%d0%be%d0%bd%d0%b0%d1%85">Условия в шаблонах</a>
</h2><ol>
<li>Показать информацию для одной или нескольких групп пользователей.</li>
</ol>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-0
shortcode-codeblock-html">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-1d5e0dcff1cb100aab24c96c9d0b8e24" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-html" data-lang="html"><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">if</span> <span class="na">condition</span><span class="o">=</span><span class="s">&#34;is_member_of($bbuserinfo, X, Y, Z)&#34;</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="c">&lt;!-- информация --&gt;</span>
</span></span><span class="line"><span class="cl"><span class="p">&lt;/</span><span class="nt">if</span><span class="p">&gt;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-1d5e0dcff1cb100aab24c96c9d0b8e24"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<ol start="2">
<li>Показать информацию только для одного пользователя.</li>
</ol>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-1
shortcode-codeblock-html">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-7d32206f9d674dfc0ccf06a4d03948f9" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-html" data-lang="html"><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">if</span> <span class="na">condition</span><span class="o">=</span><span class="s">&#34;$bbuserinfo[userid] == X&#34;</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="c">&lt;!-- информация --&gt;</span>
</span></span><span class="line"><span class="cl"><span class="p">&lt;/</span><span class="nt">if</span><span class="p">&gt;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-7d32206f9d674dfc0ccf06a4d03948f9"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<ol start="3">
<li>Показать информацию только для нескольких пользователей.</li>
</ol>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-2
shortcode-codeblock-html">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-8a25f80b1c087fc37c2f14f00234724b" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-html" data-lang="html"><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">if</span> <span class="na">condition</span><span class="o">=</span><span class="s">&#34;in_array($bbuserinfo[userid], array(X,Y,Z))&#34;</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="c">&lt;!-- информация --&gt;</span>
</span></span><span class="line"><span class="cl"><span class="p">&lt;/</span><span class="nt">if</span><span class="p">&gt;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-8a25f80b1c087fc37c2f14f00234724b"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<ol start="4">
<li>Скрыть информацию для одной группы пользователей.</li>
</ol>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-3
shortcode-codeblock-html">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-7f463a802db0c59e63709ffbd0e997bb" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-html" data-lang="html"><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">if</span> <span class="na">condition</span><span class="o">=</span><span class="s">&#34;!is_member_of($bbuserinfo, X)&#34;</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="c">&lt;!-- информация --&gt;</span>
</span></span><span class="line"><span class="cl"><span class="p">&lt;/</span><span class="nt">if</span><span class="p">&gt;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-7f463a802db0c59e63709ffbd0e997bb"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<ol start="5">
<li>Скрыть информацию для нескольких групп пользователей.</li>
</ol>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-4
shortcode-codeblock-html">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-1829c3e1e8509e69a181ccea79b8cafb" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-html" data-lang="html"><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">if</span> <span class="na">condition</span><span class="o">=</span><span class="s">&#34;!is_member_of($bbuserinfo, X, Y, Z)&#34;</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="c">&lt;!-- информация --&gt;</span>
</span></span><span class="line"><span class="cl"><span class="p">&lt;/</span><span class="nt">if</span><span class="p">&gt;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-1829c3e1e8509e69a181ccea79b8cafb"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<ol start="6">
<li>Скрыть информацию от нескольких пользователей.</li>
</ol>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-5
shortcode-codeblock-html">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-01c2d4bc45506e8adfd60b772beab99b" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-html" data-lang="html"><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">if</span> <span class="na">condition</span><span class="o">=</span><span class="s">&#34;!in_array($bbuserinfo[userid], array(X,Y,Z))&#34;</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="c">&lt;!-- информация --&gt;</span>
</span></span><span class="line"><span class="cl"><span class="p">&lt;/</span><span class="nt">if</span><span class="p">&gt;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-01c2d4bc45506e8adfd60b772beab99b"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<ol start="7">
<li>Показать информацию только в определённом форуме.</li>
</ol>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-6
shortcode-codeblock-html">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-e168cc6f2314c993e0c84fb3480b8cd1" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-html" data-lang="html"><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">if</span> <span class="na">condition</span><span class="o">=</span><span class="s">&#34;$forumid == X&#34;</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="c">&lt;!-- информация --&gt;</span>
</span></span><span class="line"><span class="cl"><span class="p">&lt;/</span><span class="nt">if</span><span class="p">&gt;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-e168cc6f2314c993e0c84fb3480b8cd1"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<ol start="8">
<li>Показать информацию в нескольких форумах.</li>
</ol>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-7
shortcode-codeblock-html">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-13c9d7010c0c53eeb6dd5b0a33307085" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-html" data-lang="html"><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">if</span> <span class="na">condition</span><span class="o">=</span><span class="s">&#34;in_array($forumid, array(X,Y,Z))&#34;</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="c">&lt;!-- информация --&gt;</span>
</span></span><span class="line"><span class="cl"><span class="p">&lt;/</span><span class="nt">if</span><span class="p">&gt;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-13c9d7010c0c53eeb6dd5b0a33307085"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<ol start="9">
<li>Скрыть информацию в определённом форуме.</li>
</ol>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-8
shortcode-codeblock-html">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-f608dedcda881c961ba9248b201dbb12" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-html" data-lang="html"><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">if</span> <span class="na">condition</span><span class="o">=</span><span class="s">&#34;$forumid != X&#34;</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="c">&lt;!-- информация --&gt;</span>
</span></span><span class="line"><span class="cl"><span class="p">&lt;/</span><span class="nt">if</span><span class="p">&gt;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-f608dedcda881c961ba9248b201dbb12"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<ol start="10">
<li>Скрыть информацию в нескольких форумах.</li>
</ol>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-9
shortcode-codeblock-html">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-1e65a5ebc581f6f69821b721785483cb" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-html" data-lang="html"><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">if</span> <span class="na">condition</span><span class="o">=</span><span class="s">&#34;!in_array($forumid, array(X,Y,Z))&#34;</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="c">&lt;!-- информация --&gt;</span>
</span></span><span class="line"><span class="cl"><span class="p">&lt;/</span><span class="nt">if</span><span class="p">&gt;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-1e65a5ebc581f6f69821b721785483cb"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>]]></turbo:content></item><item turbo="true"><title>Невидимые ссылки для гостей на IP.Board 2.3</title><link>https://lib.onl/ru/2023/10/560dfed8-9a25-5db3-95a6-a7df8129e960/</link><pubDate>Tue, 17 Oct 2023 03:15:11 +0000</pubDate><dc:creator>Kai Kimera</dc:creator><category>CMF</category><category>В истории</category><yandex:related><link url="https://lib.onl/ru/2023/10/347826e1-53d9-5c99-a6f8-66fc359323a2/">Динамическое "(Powered by Invision Power Board)" на IP.Board 2.3</link><link url="https://lib.onl/ru/2023/10/d477b5ce-8095-5607-91c7-5c5ad7b7f146/">Читабельные ссылки на темы форума для IP.Board 2.3</link><link url="https://lib.onl/ru/2023/10/a0756cae-ae3c-59ff-b587-ee8c7f3247c8/">FAQ для IP.Board 2.3</link><link url="https://lib.onl/ru/2023/10/54d4e488-9a8f-55ed-8fea-c77d4dba0720/">SQL запросы IP.Board 2.3</link><link url="https://lib.onl/ru/2023/10/06c9d359-31f0-5862-a342-62a21d4eb032/">SQL запросы IP.Board 3.x</link><link url="https://lib.onl/ru/2023/10/0743e73e-7c4c-5ab8-bba3-ba70bdb5cdfd/">Условия в файлах IP.Board 2.3</link><link url="https://lib.onl/ru/2023/10/d310a44c-4259-5bef-a7c2-d3d09a5c69f4/">Условия в шаблонах IP.Board 2.3</link><link url="https://lib.onl/ru/2023/10/a7405294-9f0c-52c1-a70e-ce4990079dc7/">Условия в шаблонах IP.Board 3.x</link></yandex:related><turbo:extendedHtml>true</turbo:extendedHtml><turbo:source>https://lib.onl/ru/2023/10/560dfed8-9a25-5db3-95a6-a7df8129e960/</turbo:source><turbo:topic>Невидимые ссылки для гостей на IP.Board 2.3</turbo:topic><turbo:content><![CDATA[<p>Когда-то была очень полезная модификация для <span class="shortcode shortcode-tag"><a href="/ru/tags/ipb/" target="_blank">#IPB</a></span>, которая защищала ссылки внутри форума от гостей. Ибо нефиг смотреть просто так, регистрируйтесь!</p>




    






    
    








<div class="shortcode shortcode-alert">
  <div class="alert alert-info d-flex overflow-hidden" role="alert">
    <div class="flex-shrink-0 align-self-center">
      <i class="fas fa-info fa-fw fa-2x"></i>
    </div>
    <div class="flex-grow-1 ms-3 overflow-hidden">
        <ul>
<li>Автор: Sannis.</li>
</ul>

    </div>
  </div>
</div>

<h2 id="внедрение-модификации">
  <a class="link-body-emphasis" href="#%d0%b2%d0%bd%d0%b5%d0%b4%d1%80%d0%b5%d0%bd%d0%b8%d0%b5-%d0%bc%d0%be%d0%b4%d0%b8%d1%84%d0%b8%d0%ba%d0%b0%d1%86%d0%b8%d0%b8">Внедрение модификации</a>
</h2><p>Эта небольшая модификация позволяет сделать так, чтобы ссылки стали скрытыми от гостей. Для этого нужно отредактировать файлы <code>topic.php</code> и <code>class_post.php</code>.</p>
<p>Открыть файл <code>./sources/action_public/topic.php</code>, найти:</p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-0
shortcode-codeblock-php">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-f815fa2219d99747c1244a53273bf518" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="c1">//-----------------------------------------
</span></span></span><span class="line"><span class="cl"><span class="c1">// Highlight...
</span></span></span><span class="line"><span class="cl"><span class="c1">//-----------------------------------------
</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-f815fa2219d99747c1244a53273bf518"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<p>Заменить на:</p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-1
shortcode-codeblock-php">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-cad7ac600e4e5cf7b27adbb6214957d3" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">ipsclass</span><span class="o">-&gt;</span><span class="na">member</span><span class="p">[</span><span class="s1">&#39;id&#39;</span><span class="p">])</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="c1">//-----------------------------------------
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="c1">// Clear links for guests
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="c1">//-----------------------------------------
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl">  <span class="nv">$row</span><span class="p">[</span><span class="s1">&#39;post&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nx">preg_replace</span><span class="p">(</span><span class="s2">&#34;#&lt;a href=[</span><span class="se">\&#34;</span><span class="s2">&#39;].+?[</span><span class="se">\&#34;</span><span class="s2">&#39;].+?&gt;.+?&lt;/a&gt;#&#34;</span><span class="p">,</span> <span class="s2">&#34;&lt;i&gt;ссылка&lt;/i&gt;&#34;</span><span class="p">,</span> <span class="nv">$row</span><span class="p">[</span><span class="s1">&#39;post&#39;</span><span class="p">]);</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-cad7ac600e4e5cf7b27adbb6214957d3"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<p>Открыть файл <code>./sources/classes/class_post.php</code>, найти:</p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-2
shortcode-codeblock-php">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-a10954e7dd96136c351282a504159c23" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="nv">$extra</span> <span class="o">=</span> <span class="s2">&#34;&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">if</span> <span class="p">(</span> <span class="nv">$tmp_post</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="nv">$raw_post</span> <span class="o">.=</span> <span class="s2">&#34;[quote name=&#39;&#34;</span><span class="o">.</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">parser</span><span class="o">-&gt;</span><span class="na">make_quote_safe</span><span class="p">(</span><span class="nv">$tp</span><span class="p">[</span><span class="s1">&#39;author_name&#39;</span><span class="p">])</span><span class="o">.</span><span class="s2">&#34;&#39; date=&#39;&#34;</span><span class="o">.</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">parser</span><span class="o">-&gt;</span><span class="na">make_quote_safe</span><span class="p">(</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">ipsclass</span><span class="o">-&gt;</span><span class="na">get_date</span><span class="p">(</span> <span class="nv">$tp</span><span class="p">[</span><span class="s1">&#39;post_date&#39;</span><span class="p">],</span> <span class="s1">&#39;LONG&#39;</span><span class="p">,</span> <span class="mi">1</span> <span class="p">))</span><span class="o">.</span><span class="s2">&#34;&#39; post=&#39;&#34;</span><span class="o">.</span><span class="nv">$tp</span><span class="p">[</span><span class="s1">&#39;pid&#39;</span><span class="p">]</span><span class="o">.</span><span class="s2">&#34;&#39;]</span><span class="se">\n</span><span class="si">$tmp_post\n</span><span class="s2">&#34;</span><span class="o">.</span><span class="nv">$extra</span><span class="o">.</span><span class="s1">&#39;[/quote]&#39;</span><span class="o">.</span><span class="s2">&#34;</span><span class="se">\n\n\n</span><span class="s2">&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-a10954e7dd96136c351282a504159c23"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<p>Заменить на:</p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-3
shortcode-codeblock-php">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-c7d5be883737a363cd7296f43fe89a6c" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span><span class="lnt">9
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">ipsclass</span><span class="o">-&gt;</span><span class="na">member</span><span class="p">[</span><span class="s1">&#39;id&#39;</span><span class="p">])</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="c1">//-----------------------------------------
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="c1">// Clear links for guests
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="c1">//-----------------------------------------
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl">  <span class="nv">$tmp_post</span> <span class="o">=</span> <span class="nx">preg_replace</span><span class="p">(</span><span class="s2">&#34;#\[url\](\S+?)\[/url\]#i&#34;</span><span class="p">,</span> <span class="s2">&#34;[i]ссылка[/i]&#34;</span><span class="p">,</span> <span class="nv">$tmp_post</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="nv">$tmp_post</span> <span class="o">=</span> <span class="nx">preg_replace</span><span class="p">(</span><span class="s2">&#34;#\[url\s*=\s*</span><span class="se">\&#34;</span><span class="s2">\;\s*(\S+?)\s*</span><span class="se">\&#34;</span><span class="s2">\;\s*\](.*?)\[\/url\]#i&#34;</span><span class="p">,</span> <span class="s2">&#34;</span><span class="se">\\</span><span class="s2">2&#34;</span><span class="p">,</span> <span class="nv">$tmp_post</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="nv">$tmp_post</span> <span class="o">=</span> <span class="nx">preg_replace</span><span class="p">(</span><span class="s2">&#34;#\[url\s*=\s*(\S+?)\s*\](.*?)\[\/url\]#i&#34;</span><span class="p">,</span> <span class="s2">&#34;</span><span class="se">\\</span><span class="s2">2&#34;</span><span class="p">,</span> <span class="nv">$tmp_post</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-c7d5be883737a363cd7296f43fe89a6c"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>]]></turbo:content></item><item turbo="true"><title>Динамическое "(Powered by Invision Power Board)" на IP.Board 2.3</title><link>https://lib.onl/ru/2023/10/347826e1-53d9-5c99-a6f8-66fc359323a2/</link><pubDate>Tue, 17 Oct 2023 03:10:06 +0000</pubDate><dc:creator>Kai Kimera</dc:creator><category>CMF</category><category>В истории</category><yandex:related><link url="https://lib.onl/ru/2023/10/d477b5ce-8095-5607-91c7-5c5ad7b7f146/">Читабельные ссылки на темы форума для IP.Board 2.3</link><link url="https://lib.onl/ru/2023/10/a0756cae-ae3c-59ff-b587-ee8c7f3247c8/">FAQ для IP.Board 2.3</link><link url="https://lib.onl/ru/2023/10/54d4e488-9a8f-55ed-8fea-c77d4dba0720/">SQL запросы IP.Board 2.3</link><link url="https://lib.onl/ru/2023/10/06c9d359-31f0-5862-a342-62a21d4eb032/">SQL запросы IP.Board 3.x</link><link url="https://lib.onl/ru/2023/10/0743e73e-7c4c-5ab8-bba3-ba70bdb5cdfd/">Условия в файлах IP.Board 2.3</link><link url="https://lib.onl/ru/2023/10/d310a44c-4259-5bef-a7c2-d3d09a5c69f4/">Условия в шаблонах IP.Board 2.3</link><link url="https://lib.onl/ru/2023/10/a7405294-9f0c-52c1-a70e-ce4990079dc7/">Условия в шаблонах IP.Board 3.x</link></yandex:related><turbo:extendedHtml>true</turbo:extendedHtml><turbo:source>https://lib.onl/ru/2023/10/347826e1-53d9-5c99-a6f8-66fc359323a2/</turbo:source><turbo:topic>Динамическое "(Powered by Invision Power Board)" на IP.Board 2.3</turbo:topic><turbo:content><![CDATA[<p>Нашёл ещё одну модификацию а-ля &ldquo;прикол на зависть другим&rdquo; для <span class="shortcode shortcode-tag"><a href="/ru/tags/ipb/" target="_blank">#IPB</a></span>. Модификация позволяет сделать из копирайта форума динамически изменяемую &ldquo;свистульку&rdquo;.</p>
<h2 id="внедрение-модификации">
  <a class="link-body-emphasis" href="#%d0%b2%d0%bd%d0%b5%d0%b4%d1%80%d0%b5%d0%bd%d0%b8%d0%b5-%d0%bc%d0%be%d0%b4%d0%b8%d1%84%d0%b8%d0%ba%d0%b0%d1%86%d0%b8%d0%b8">Внедрение модификации</a>
</h2><p>Открыть файл <code>./sources/action_public/boards.php</code>, найти:</p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-0
shortcode-codeblock-php">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-eaca4f82e44fa7f10dba95d11d5e4669" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="nv">$cp</span> <span class="o">=</span> <span class="s2">&#34; (Powered by Invision Power Board)&#34;</span><span class="p">;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-eaca4f82e44fa7f10dba95d11d5e4669"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<p>Заменить на:</p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-1
shortcode-codeblock-php">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-dc53b76fbc8ce2db299c3270bb4e1e8e" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="nv">$cp_phrases</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">  <span class="s1">&#39;0&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39; - CYBER-CITY: Поддержка&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">  <span class="s1">&#39;1&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39; - CYBER-CITY: Разработка&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">  <span class="s1">&#39;2&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39; - CYBER-CITY: Исследование&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl"><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nv">$cp_rand</span> <span class="o">=</span> <span class="nx">rand</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="nv">$cp</span> <span class="o">=</span> <span class="nv">$cp_phrases</span><span class="p">[</span><span class="nv">$cp_rand</span><span class="p">];</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-dc53b76fbc8ce2db299c3270bb4e1e8e"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<p>Не забудьте, если у вас больше фраз, чем 3, то измените <code>rand(0, 2)</code>, где <code>0</code> - первая фраза, <code>2</code> - последняя.</p>]]></turbo:content></item><item turbo="true"><title>Читабельные ссылки на темы форума для IP.Board 2.3</title><link>https://lib.onl/ru/2023/10/d477b5ce-8095-5607-91c7-5c5ad7b7f146/</link><pubDate>Tue, 17 Oct 2023 02:45:40 +0000</pubDate><dc:creator>Kai Kimera</dc:creator><category>CMF</category><category>В истории</category><yandex:related><link url="https://lib.onl/ru/2023/10/a0756cae-ae3c-59ff-b587-ee8c7f3247c8/">FAQ для IP.Board 2.3</link><link url="https://lib.onl/ru/2023/10/54d4e488-9a8f-55ed-8fea-c77d4dba0720/">SQL запросы IP.Board 2.3</link><link url="https://lib.onl/ru/2023/10/06c9d359-31f0-5862-a342-62a21d4eb032/">SQL запросы IP.Board 3.x</link><link url="https://lib.onl/ru/2023/10/0743e73e-7c4c-5ab8-bba3-ba70bdb5cdfd/">Условия в файлах IP.Board 2.3</link><link url="https://lib.onl/ru/2023/10/d310a44c-4259-5bef-a7c2-d3d09a5c69f4/">Условия в шаблонах IP.Board 2.3</link><link url="https://lib.onl/ru/2023/10/a7405294-9f0c-52c1-a70e-ce4990079dc7/">Условия в шаблонах IP.Board 3.x</link></yandex:related><turbo:extendedHtml>true</turbo:extendedHtml><turbo:source>https://lib.onl/ru/2023/10/d477b5ce-8095-5607-91c7-5c5ad7b7f146/</turbo:source><turbo:topic>Читабельные ссылки на темы форума для IP.Board 2.3</turbo:topic><turbo:content><![CDATA[<p>Очередной артефакт прошлого. Когда то была очень крутая модификация для <span class="shortcode shortcode-tag"><a href="/ru/tags/ipb/" target="_blank">#IPB</a></span> 2.3. Эта модификация позволяла преобразовывать обычные ссылки на темы внутри форума в читабельный формат с текстом. Золотое время было&hellip;</p>




    






    
    








<div class="shortcode shortcode-alert">
  <div class="alert alert-info d-flex overflow-hidden" role="alert">
    <div class="flex-shrink-0 align-self-center">
      <i class="fas fa-info fa-fw fa-2x"></i>
    </div>
    <div class="flex-grow-1 ms-3 overflow-hidden">
        <ul>
<li>Автор: GiV.</li>
<li>Тестирование (маленькое :)): KaiKimera.</li>
<li>Исправление ошибок и неточностей: Sannis.</li>
</ul>

    </div>
  </div>
</div>

<h2 id="внедрение-модификации">
  <a class="link-body-emphasis" href="#%d0%b2%d0%bd%d0%b5%d0%b4%d1%80%d0%b5%d0%bd%d0%b8%d0%b5-%d0%bc%d0%be%d0%b4%d0%b8%d1%84%d0%b8%d0%ba%d0%b0%d1%86%d0%b8%d0%b8">Внедрение модификации</a>
</h2><p>Открыть файл <code>./sources/classes/bbcode/class_bbcode_core.php</code>, найти:</p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-0
shortcode-codeblock-php">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-59c3ee7a6bb42f6817bf819149ac7b73" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="nv">$show</span> <span class="o">=</span> <span class="nv">$url</span><span class="p">[</span><span class="s1">&#39;show&#39;</span><span class="p">];</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-59c3ee7a6bb42f6817bf819149ac7b73"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<p>Добавить <strong>после</strong>:</p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-1
shortcode-codeblock-php">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-103ff7b70a0f63d38b31b200e97b3097" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="k">if</span> <span class="p">(</span><span class="nx">strpos</span><span class="p">(</span><span class="nv">$show</span><span class="p">,</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">ipsclass</span><span class="o">-&gt;</span><span class="na">base_url</span><span class="p">)</span> <span class="o">!==</span> <span class="k">false</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="nv">$match</span> <span class="o">=</span> <span class="k">array</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="k">if</span> <span class="p">(</span><span class="nx">preg_match</span><span class="p">(</span><span class="s2">&#34;/showtopic=(\d+)/&#34;</span><span class="p">,</span> <span class="nv">$show</span><span class="p">,</span> <span class="nv">$match</span><span class="p">)</span> <span class="k">or</span> <span class="nx">preg_match</span><span class="p">(</span><span class="s2">&#34;/&amp;t=(\d+)/&#34;</span><span class="p">,</span> <span class="nv">$show</span><span class="p">,</span> <span class="nv">$match</span><span class="p">))</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nv">$show</span> <span class="o">=</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">_getUrlLocalName</span><span class="p">(</span><span class="s1">&#39;topics&#39;</span><span class="p">,</span> <span class="nv">$match</span><span class="p">[</span><span class="mi">1</span><span class="p">]);</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="k">if</span> <span class="p">(</span><span class="nx">preg_match</span><span class="p">(</span><span class="s2">&#34;/showforum=(\d+)/&#34;</span><span class="p">,</span> <span class="nv">$show</span><span class="p">,</span> <span class="nv">$match</span><span class="p">))</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nv">$show</span> <span class="o">=</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">_getUrlLocalName</span><span class="p">(</span><span class="s1">&#39;forums&#39;</span><span class="p">,</span> <span class="nv">$match</span><span class="p">[</span><span class="mi">1</span><span class="p">]);</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="k">if</span> <span class="p">(</span><span class="nx">preg_match</span><span class="p">(</span><span class="s2">&#34;/showuser=(\d+)/&#34;</span><span class="p">,</span> <span class="nv">$show</span><span class="p">,</span> <span class="nv">$match</span><span class="p">))</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nv">$show</span> <span class="o">=</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">_getUrlLocalName</span><span class="p">(</span><span class="s1">&#39;members&#39;</span><span class="p">,</span> <span class="nv">$match</span><span class="p">[</span><span class="mi">1</span><span class="p">]);</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nv">$show</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nv">$show</span> <span class="o">=</span> <span class="nv">$url</span><span class="p">[</span><span class="s1">&#39;show&#39;</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span> <span class="k">else</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-103ff7b70a0f63d38b31b200e97b3097"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<p>Найти:</p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-2
shortcode-codeblock-php">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-e7843e12d418c9594808cbd0622ec43a" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="cm">/*-------------------------------------------------------------------------*/</span>
</span></span><span class="line"><span class="cl"><span class="c1">// Remove sessions in a nice way
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="cm">/*-------------------------------------------------------------------------*/</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-e7843e12d418c9594808cbd0622ec43a"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<p>Добавить <strong>перед</strong>:</p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-3
shortcode-codeblock-php">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-97aeaeac9d0627373d03282c2697c208" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="k">function</span> <span class="nf">_getUrlLocalName</span><span class="p">(</span><span class="nv">$from</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="nv">$for</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="c1">// Сколько раз разбирали ссылки.
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="k">static</span> <span class="nv">$parsedUrls</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="c1">// Проверка на лимит разбора ссылок, чем больше число, тем больше
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="c1">// вероятность, что злоумышленник может создать нагрузку на БД.
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="k">if</span> <span class="p">(</span><span class="o">++</span><span class="nv">$parsedUrls</span> <span class="o">&gt;=</span> <span class="mi">10</span><span class="p">)</span> <span class="k">return</span> <span class="k">false</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nv">$from</span> <span class="k">or</span> <span class="o">!</span><span class="nv">$for</span><span class="p">)</span> <span class="k">return</span> <span class="k">false</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="c1">// Оптимизация для ссылок на форумы/разделы. Берем имя не через запрос
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="c1">// к базе, а из кэша форумов. Спасибо улетает к SAT.
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="k">if</span> <span class="p">(</span><span class="nv">$from</span> <span class="o">==</span> <span class="s1">&#39;forums&#39;</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">ipsclass</span><span class="o">-&gt;</span><span class="na">cache</span><span class="p">[</span><span class="s1">&#39;forum_cache&#39;</span><span class="p">][</span><span class="nv">$for</span><span class="p">][</span><span class="s1">&#39;name&#39;</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="c1">// &#39;pk&#39; - имя первичного ключа (id&#39;ентификатора) в таблице.
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="c1">// &#39;fieldName&#39; - имя поля в таблице, в котором хранится возвращаемое имя.
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="nv">$pk</span> <span class="o">=</span> <span class="s1">&#39;id&#39;</span><span class="p">;</span>           <span class="c1">// В большинстве случаев имя первичного ключа - &#39;id&#39;.
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="nv">$fieldName</span> <span class="o">=</span> <span class="s1">&#39;name&#39;</span><span class="p">;</span>  <span class="c1">// Имя поля - &#39;name&#39;.
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl">  <span class="c1">// Однако в случае с темами у нас другие &#39;pk&#39; и &#39;fieldName&#39;.
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="k">if</span> <span class="p">(</span><span class="nv">$from</span> <span class="o">==</span> <span class="s1">&#39;topics&#39;</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nv">$pk</span> <span class="o">=</span> <span class="s1">&#39;tid&#39;</span><span class="p">;</span>          <span class="c1">// Имя первичного ключа - &#39;tid&#39;.
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="nv">$fieldName</span> <span class="o">=</span> <span class="s1">&#39;title&#39;</span><span class="p">;</span> <span class="c1">// Имя поля с названием - &#39;title&#39;.
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="c1">// Однако в случае с пользователями у нас другое &#39;fieldName&#39;.
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="k">if</span> <span class="p">(</span><span class="nv">$from</span> <span class="o">==</span> <span class="s1">&#39;members&#39;</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nv">$fieldName</span> <span class="o">=</span> <span class="s1">&#39;members_display_name&#39;</span><span class="p">;</span> <span class="c1">// Имя поля с названием - &#39;members_display_name&#39;.
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">ipsclass</span><span class="o">-&gt;</span><span class="na">DB</span><span class="o">-&gt;</span><span class="na">simple_select</span><span class="p">(</span><span class="nv">$fieldName</span><span class="p">,</span> <span class="nv">$from</span><span class="p">,</span> <span class="nv">$pk</span> <span class="o">.</span> <span class="s2">&#34;= &#39;&#34;</span> <span class="o">.</span> <span class="nv">$for</span> <span class="o">.</span> <span class="s2">&#34;&#39;&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="nv">$ci</span> <span class="o">=</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">ipsclass</span><span class="o">-&gt;</span><span class="na">DB</span><span class="o">-&gt;</span><span class="na">exec_query</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">  <span class="nv">$row</span> <span class="o">=</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">ipsclass</span><span class="o">-&gt;</span><span class="na">DB</span><span class="o">-&gt;</span><span class="na">fetch_row</span><span class="p">(</span><span class="nv">$ci</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="k">if</span> <span class="p">(</span><span class="nv">$fieldValue</span> <span class="o">=</span> <span class="nv">$row</span><span class="p">[</span><span class="nv">$fieldName</span><span class="p">])</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="nv">$fieldValue</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="k">return</span> <span class="k">false</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-97aeaeac9d0627373d03282c2697c208"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>]]></turbo:content></item><item turbo="true"><title>FAQ для IP.Board 2.3</title><link>https://lib.onl/ru/2023/10/a0756cae-ae3c-59ff-b587-ee8c7f3247c8/</link><pubDate>Tue, 17 Oct 2023 00:57:06 +0000</pubDate><dc:creator>Kai Kimera</dc:creator><category>CMF</category><category>В истории</category><yandex:related><link url="https://lib.onl/ru/2023/10/54d4e488-9a8f-55ed-8fea-c77d4dba0720/">SQL запросы IP.Board 2.3</link><link url="https://lib.onl/ru/2023/10/06c9d359-31f0-5862-a342-62a21d4eb032/">SQL запросы IP.Board 3.x</link><link url="https://lib.onl/ru/2023/10/0743e73e-7c4c-5ab8-bba3-ba70bdb5cdfd/">Условия в файлах IP.Board 2.3</link><link url="https://lib.onl/ru/2023/10/d310a44c-4259-5bef-a7c2-d3d09a5c69f4/">Условия в шаблонах IP.Board 2.3</link><link url="https://lib.onl/ru/2023/10/a7405294-9f0c-52c1-a70e-ce4990079dc7/">Условия в шаблонах IP.Board 3.x</link></yandex:related><turbo:extendedHtml>true</turbo:extendedHtml><turbo:source>https://lib.onl/ru/2023/10/a0756cae-ae3c-59ff-b587-ee8c7f3247c8/</turbo:source><turbo:topic>FAQ для IP.Board 2.3</turbo:topic><turbo:content><![CDATA[<p>Сборник вопросов и ответов по форумному движку <span class="shortcode shortcode-tag"><a href="/ru/tags/ipb/" target="_blank">#IPB</a></span> 2.3.</p>
<h2 id="как-сделать-портал-главной-страницей-форума">
  <a class="link-body-emphasis" href="#%d0%ba%d0%b0%d0%ba-%d1%81%d0%b4%d0%b5%d0%bb%d0%b0%d1%82%d1%8c-%d0%bf%d0%be%d1%80%d1%82%d0%b0%d0%bb-%d0%b3%d0%bb%d0%b0%d0%b2%d0%bd%d0%be%d0%b9-%d1%81%d1%82%d1%80%d0%b0%d0%bd%d0%b8%d1%86%d0%b5%d0%b9-%d1%84%d0%be%d1%80%d1%83%d0%bc%d0%b0">Как сделать портал главной страницей форума?</a>
</h2><p>Открыть файл <code>init.php</code>, найти:</p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-0
shortcode-codeblock-php">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-5fab4db76527c57aa11f273445079eb5" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="nx">define</span><span class="p">(</span> <span class="s1">&#39;IPB_MAKE_PORTAL_HOMEPAGE&#39;</span><span class="p">,</span> <span class="mi">0</span> <span class="p">);</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-5fab4db76527c57aa11f273445079eb5"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<p>Заменить на:</p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-1
shortcode-codeblock-php">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-fac00927b935a6932dbe030145498614" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="nx">define</span><span class="p">(</span> <span class="s1">&#39;IPB_MAKE_PORTAL_HOMEPAGE&#39;</span><span class="p">,</span> <span class="mi">1</span> <span class="p">);</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-fac00927b935a6932dbe030145498614"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<h2 id="как-удалить-powered-by-invision-power-board-из-title">
  <a class="link-body-emphasis" href="#%d0%ba%d0%b0%d0%ba-%d1%83%d0%b4%d0%b0%d0%bb%d0%b8%d1%82%d1%8c-powered-by-invision-power-board-%d0%b8%d0%b7-title">Как удалить (Powered by Invision Power Board) из title?</a>
</h2><p>Открыть файл <code>./sources/action_public/boards.php</code>, найти:</p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-2
shortcode-codeblock-php">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-10be45dfe57a41e936ae6f84d911fbf3" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="nv">$cp</span> <span class="o">=</span> <span class="s2">&#34; (Powered by Invision Power Board)&#34;</span><span class="p">;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-10be45dfe57a41e936ae6f84d911fbf3"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<p>Заменить на:</p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-3
shortcode-codeblock-php">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-fe486ea70e476910905cf5e078823132" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="nv">$cp</span> <span class="o">=</span> <span class="s2">&#34;&#34;</span><span class="p">;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-fe486ea70e476910905cf5e078823132"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<h2 id="как-убрать-текст-в-просмотре-темы-под-аватаром">
  <a class="link-body-emphasis" href="#%d0%ba%d0%b0%d0%ba-%d1%83%d0%b1%d1%80%d0%b0%d1%82%d1%8c-%d1%82%d0%b5%d0%ba%d1%81%d1%82-%d0%b2-%d0%bf%d1%80%d0%be%d1%81%d0%bc%d0%be%d1%82%d1%80%d0%b5-%d1%82%d0%b5%d0%bc%d1%8b-%d0%bf%d0%be%d0%b4-%d0%b0%d0%b2%d0%b0%d1%82%d0%b0%d1%80%d0%be%d0%bc">Как убрать текст в просмотре темы под аватаром?</a>
</h2><p>Нужно отредактировать шаблон <code>RenderRow</code>:</p>
<ul>
<li>Админцентр / Внешний вид / <em>Ваш скин</em>.
<ul>
<li>редактировать HTML фрагменты / <code>skin_topic</code> (Просмотр темы) / <code>RenderRow</code>.</li>
</ul>
</li>
</ul>
<p>Код, отвечающий за поля пользователя в сообщении:</p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-4
shortcode-codeblock-php">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-7a6deff15f83cbd416c0128cee2079ae" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="p">{</span><span class="nv">$author</span><span class="p">[</span><span class="s1">&#39;avatar&#39;</span><span class="p">]}</span><span class="o">&lt;</span><span class="nx">br</span> <span class="o">/&gt;&lt;</span><span class="nx">br</span> <span class="o">/&gt;</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span><span class="nv">$author</span><span class="p">[</span><span class="s1">&#39;title&#39;</span><span class="p">]}</span><span class="o">&lt;</span><span class="nx">br</span> <span class="o">/&gt;</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span><span class="nv">$author</span><span class="p">[</span><span class="s1">&#39;member_rank_img&#39;</span><span class="p">]}</span><span class="o">&lt;</span><span class="nx">br</span> <span class="o">/&gt;&lt;</span><span class="nx">br</span> <span class="o">/&gt;</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span><span class="nv">$author</span><span class="p">[</span><span class="s1">&#39;member_group&#39;</span><span class="p">]}</span><span class="o">&lt;</span><span class="nx">br</span> <span class="o">/&gt;</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span><span class="nv">$author</span><span class="p">[</span><span class="s1">&#39;member_posts&#39;</span><span class="p">]}</span><span class="o">&lt;</span><span class="nx">br</span> <span class="o">/&gt;</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span><span class="nv">$author</span><span class="p">[</span><span class="s1">&#39;member_joined&#39;</span><span class="p">]}</span><span class="o">&lt;</span><span class="nx">br</span> <span class="o">/&gt;</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span><span class="nv">$author</span><span class="p">[</span><span class="s1">&#39;member_location&#39;</span><span class="p">]}</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span><span class="nv">$author</span><span class="p">[</span><span class="s1">&#39;member_number&#39;</span><span class="p">]}</span><span class="o">&lt;</span><span class="nx">br</span> <span class="o">/&gt;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-7a6deff15f83cbd416c0128cee2079ae"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<p>Где:</p>
<ul>
<li><code>{$author['avatar']}</code> - аватар.</li>
<li><code>{$author['title']}</code> - ранг.</li>
<li><code>{$author['member_rank_img']}</code> - изображения ранга.</li>
<li><code>{$author['member_group']}</code> - Группа пользователя.</li>
<li><code>{$author['member_posts']}</code> - Сообщения.</li>
<li><code>{$author['member_joined']}</code> - Регистрация.</li>
<li><code>{$author['member_number']}</code> - ID пользователя.</li>
</ul>
<h2 id="как-добавить-дополнительные-кнопки-bb-кода-в-быстрый-ответ">
  <a class="link-body-emphasis" href="#%d0%ba%d0%b0%d0%ba-%d0%b4%d0%be%d0%b1%d0%b0%d0%b2%d0%b8%d1%82%d1%8c-%d0%b4%d0%be%d0%bf%d0%be%d0%bb%d0%bd%d0%b8%d1%82%d0%b5%d0%bb%d1%8c%d0%bd%d1%8b%d0%b5-%d0%ba%d0%bd%d0%be%d0%bf%d0%ba%d0%b8-bb-%d0%ba%d0%be%d0%b4%d0%b0-%d0%b2-%d0%b1%d1%8b%d1%81%d1%82%d1%80%d1%8b%d0%b9-%d0%be%d1%82%d0%b2%d0%b5%d1%82">Как добавить дополнительные кнопки BB-кода в быстрый ответ?</a>
</h2><p>Сначала нужно в файле <code>./jscripts/ips_text_editor_lite.js</code> добавить свои BB-коды, а потом отредактировать шаблон <code>quick_reply_box_open</code>.</p>
<p>Открываем <code>./jscripts/ips_text_editor_lite.js</code>, находим строчку:</p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-5
shortcode-codeblock-js">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-9336118fba6271676a37b5f496a257ff" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="line"><span class="cl"><span class="k">this</span><span class="p">.</span><span class="nx">ipb_code</span><span class="o">=</span><span class="kd">function</span><span class="p">(){</span><span class="kd">var</span> <span class="nx">_text</span><span class="o">=</span><span class="k">this</span><span class="p">.</span><span class="nx">get_selection</span><span class="p">();</span><span class="k">this</span><span class="p">.</span><span class="nx">wrap_tags</span><span class="p">(</span><span class="s1">&#39;code&#39;</span><span class="p">,</span><span class="kc">false</span><span class="p">,</span><span class="nx">_text</span><span class="p">);};</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-9336118fba6271676a37b5f496a257ff"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<p>Эта строка отвечает за BB-код <code>CODE</code>. Копируем её к себе в редактор и заменяем в ней слово code на свой BB-код (например, у меня будет это <code>[i]spoiler[/i]</code>):</p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-6
shortcode-codeblock-js">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-db2d94fc0ec121a36a1c2f0a60e28ba0" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="line"><span class="cl"><span class="k">this</span><span class="p">.</span><span class="nx">ipb_spoiler</span><span class="o">=</span><span class="kd">function</span><span class="p">(){</span><span class="kd">var</span> <span class="nx">_text</span><span class="o">=</span><span class="k">this</span><span class="p">.</span><span class="nx">get_selection</span><span class="p">();</span><span class="k">this</span><span class="p">.</span><span class="nx">wrap_tags</span><span class="p">(</span><span class="s1">&#39;spoiler&#39;</span><span class="p">,</span><span class="kc">false</span><span class="p">,</span><span class="nx">_text</span><span class="p">);};</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-db2d94fc0ec121a36a1c2f0a60e28ba0"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<p>После этого вставляем её обратно в файл <code>./jscripts/ips_text_editor_lite.js</code>, НО уже после скопированной нами ранее строки с BB-кодом <code>CODE</code>. Получается вот так:</p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-7
shortcode-codeblock-js">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-dedb77970284f937d88bd82908658ab7" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="line"><span class="cl"><span class="k">this</span><span class="p">.</span><span class="nx">ipb_code</span><span class="o">=</span><span class="kd">function</span><span class="p">(){</span><span class="kd">var</span> <span class="nx">_text</span><span class="o">=</span><span class="k">this</span><span class="p">.</span><span class="nx">get_selection</span><span class="p">();</span><span class="k">this</span><span class="p">.</span><span class="nx">wrap_tags</span><span class="p">(</span><span class="s1">&#39;code&#39;</span><span class="p">,</span><span class="kc">false</span><span class="p">,</span><span class="nx">_text</span><span class="p">);};</span><span class="k">this</span><span class="p">.</span><span class="nx">ipb_spoiler</span><span class="o">=</span><span class="kd">function</span><span class="p">(){</span><span class="kd">var</span> <span class="nx">_text</span><span class="o">=</span><span class="k">this</span><span class="p">.</span><span class="nx">get_selection</span><span class="p">();</span><span class="k">this</span><span class="p">.</span><span class="nx">wrap_tags</span><span class="p">(</span><span class="s1">&#39;spoiler&#39;</span><span class="p">,</span><span class="kc">false</span><span class="p">,</span><span class="nx">_text</span><span class="p">);};</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-dedb77970284f937d88bd82908658ab7"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<p>Сохраняем!</p>
<p>Теперь нужно отредактировать шаблон <code>quick_reply_box_open</code>:</p>
<ul>
<li>Админцентр / Внешний вид / <em>Ваш скин</em>.
<ul>
<li>редактировать HTML фрагменты / <code>skin_topic</code> (Просмотр темы) / <code>quick_reply_box_open</code>.</li>
</ul>
</li>
</ul>
<p>Открываем шаблон, находим:</p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-8
shortcode-codeblock-html">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-d92de97d8447ad44179bd0e113ab42f4" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-html" data-lang="html"><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">td</span><span class="p">&gt;&lt;</span><span class="nt">div</span> <span class="na">class</span><span class="o">=</span><span class="s">&#34;rte-normal&#34;</span> <span class="na">id</span><span class="o">=</span><span class="s">&#34;fast-reply_cmd_ipb_code&#34;</span><span class="p">&gt;&lt;</span><span class="nt">img</span> <span class="na">src</span><span class="o">=</span><span class="s">&#34;style_images/&lt;#IMG_DIR#&gt;/folder_editor_images/rte-code-button.png&#34;</span>  <span class="na">alt</span><span class="o">=</span><span class="s">&#34;{$this-&gt;ipsclass-&gt;lang[&#39;js_rte_lite_code&#39;]}&#34;</span> <span class="na">title</span><span class="o">=</span><span class="s">&#34;{$this-&gt;ipsclass-&gt;lang[&#39;js_rte_lite_code&#39;]}&#34;</span><span class="p">&gt;&lt;/</span><span class="nt">div</span><span class="p">&gt;&lt;/</span><span class="nt">td</span><span class="p">&gt;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-d92de97d8447ad44179bd0e113ab42f4"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<p>Копируем этот участок и вставляем ниже. Теперь нужно отредактировать вставленный нами участок. Слово <code>code</code> заменяем на свой тег. Напомню, что у меня это - <code>spoiler</code>. Вот пример:</p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-9
shortcode-codeblock-html">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-736c8640ae21c93d70bc8f3a475769fd" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-html" data-lang="html"><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">td</span><span class="p">&gt;&lt;</span><span class="nt">div</span> <span class="na">class</span><span class="o">=</span><span class="s">&#34;rte-normal&#34;</span> <span class="na">id</span><span class="o">=</span><span class="s">&#34;fast-reply_cmd_ipb_spoiler&#34;</span><span class="p">&gt;&lt;</span><span class="nt">img</span> <span class="na">src</span><span class="o">=</span><span class="s">&#34;style_images/&lt;#IMG_DIR#&gt;/folder_editor_images/rte-spoiler-button.png&#34;</span>  <span class="na">alt</span><span class="o">=</span><span class="s">&#34;Спойлер&#34;</span> <span class="na">title</span><span class="o">=</span><span class="s">&#34;Спойлер&#34;</span><span class="p">&gt;&lt;/</span><span class="nt">div</span><span class="p">&gt;&lt;/</span><span class="nt">td</span><span class="p">&gt;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-736c8640ae21c93d70bc8f3a475769fd"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<p>Не забудьте загрузить кнопку для своего тега в папку <code>./style_images/папка_стиля/folder_editor_images</code>.</p>
<h2 id="как-добавить-дополнительные-кнопки-bb-кода-в-расширенный-ответ">
  <a class="link-body-emphasis" href="#%d0%ba%d0%b0%d0%ba-%d0%b4%d0%be%d0%b1%d0%b0%d0%b2%d0%b8%d1%82%d1%8c-%d0%b4%d0%be%d0%bf%d0%be%d0%bb%d0%bd%d0%b8%d1%82%d0%b5%d0%bb%d1%8c%d0%bd%d1%8b%d0%b5-%d0%ba%d0%bd%d0%be%d0%bf%d0%ba%d0%b8-bb-%d0%ba%d0%be%d0%b4%d0%b0-%d0%b2-%d1%80%d0%b0%d1%81%d1%88%d0%b8%d1%80%d0%b5%d0%bd%d0%bd%d1%8b%d0%b9-%d0%be%d1%82%d0%b2%d0%b5%d1%82">Как добавить дополнительные кнопки BB-кода в расширенный ответ?</a>
</h2><p>Инструкция добавления BB-кода в расширенный ответ похожа на предыдущую, за исключением того, что для расширенного ответа необходимо отредактировать файл <code>./jscripts/ips_text_editor.js</code> и шаблон <code>ips_editor</code>.</p>
<p>Открываем <code>./jscripts/ips_text_editor.js</code>, находим:</p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-10
shortcode-codeblock-js">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-4774140feccbd65eda372995b7beb2c7" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="line"><span class="cl"><span class="k">this</span><span class="p">.</span><span class="nx">ipb_quote</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">  <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">this</span><span class="p">.</span><span class="nx">wrap_tags_lite</span><span class="p">(</span>  <span class="s1">&#39;[quote]&#39;</span><span class="p">,</span> <span class="s1">&#39;[/quote]&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="p">};</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-4774140feccbd65eda372995b7beb2c7"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<p>Добавить ниже:</p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-11
shortcode-codeblock-js">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-fa56751ddd3dfad28ece4cf384c19d6a" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="line"><span class="cl"><span class="k">this</span><span class="p">.</span><span class="nx">ipb_youtube</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">  <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">this</span><span class="p">.</span><span class="nx">wrap_tags_lite</span><span class="p">(</span>  <span class="s1">&#39;[spoiler]&#39;</span><span class="p">,</span> <span class="s1">&#39;[/spoiler]&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="p">};</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-fa56751ddd3dfad28ece4cf384c19d6a"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<p>После этого необходимо отредактировать шаблон <code>skin_editors</code> (редактор сообщений) / <code>ips_editor</code>, чтобы добавить кнопку в расширенный ответ. Находим:</p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-12
shortcode-codeblock-html">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-b7706d7ee9281c6f13ebfddf0015962f" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-html" data-lang="html"><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">td</span><span class="p">&gt;&lt;</span><span class="nt">div</span> <span class="na">class</span><span class="o">=</span><span class="s">&#34;rte-normal&#34;</span>  <span class="na">id</span><span class="o">=</span><span class="s">&#34;{$editor_id}_cmd_ipb_code&#34;</span><span class="p">&gt;&lt;</span><span class="nt">img</span>  <span class="na">src</span><span class="o">=</span><span class="s">&#34;{$images_path}rte-code-button.png&#34;</span>   <span class="na">alt</span><span class="o">=</span><span class="s">&#34;{$this-&gt;ipsclass-&gt;lang[&#39;js_rte_lite_code&#39;]}&#34;</span>  <span class="na">title</span><span class="o">=</span><span class="s">&#34;{$this-&gt;ipsclass-&gt;lang[&#39;js_rte_lite_code&#39;]}&#34;</span><span class="p">&gt;&lt;/</span><span class="nt">div</span><span class="p">&gt;&lt;/</span><span class="nt">td</span><span class="p">&gt;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-b7706d7ee9281c6f13ebfddf0015962f"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<p>Добавляем выше:</p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-13
shortcode-codeblock-html">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-bc0177b4e726cd28d27be3dc9201b531" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-html" data-lang="html"><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">td</span><span class="p">&gt;&lt;</span><span class="nt">div</span> <span class="na">class</span><span class="o">=</span><span class="s">&#34;rte-normal&#34;</span> <span class="na">id</span><span class="o">=</span><span class="s">&#34;{$editor_id}_cmd_ipb_youtube&#34;</span><span class="p">&gt;&lt;</span><span class="nt">img</span> <span class="na">src</span><span class="o">=</span><span class="s">&#34;{$images_path}rte-code-tube.png&#34;</span>  <span class="na">alt</span><span class="o">=</span><span class="s">&#34;Youtube&#34;</span> <span class="na">title</span><span class="o">=</span><span class="s">&#34;YouTube&#34;</span><span class="p">&gt;&lt;/</span><span class="nt">div</span><span class="p">&gt;&lt;/</span><span class="nt">td</span><span class="p">&gt;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-bc0177b4e726cd28d27be3dc9201b531"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<p>Не забудьте загрузить кнопку для своего тега в папку <code>./style_images/папка_стиля/folder_editor_images</code>.</p>
<h2 id="возникает-ошибка-fatal-error-allowed-memory-size-of-xxx-bytes-exhausted-tried-to-allocate-yyy-bytes-что-это-такое">
  <a class="link-body-emphasis" href="#%d0%b2%d0%be%d0%b7%d0%bd%d0%b8%d0%ba%d0%b0%d0%b5%d1%82-%d0%be%d1%88%d0%b8%d0%b1%d0%ba%d0%b0-fatal-error-allowed-memory-size-of-xxx-bytes-exhausted-tried-to-allocate-yyy-bytes-%d1%87%d1%82%d0%be-%d1%8d%d1%82%d0%be-%d1%82%d0%b0%d0%ba%d0%be%d0%b5">Возникает ошибка Fatal error: Allowed memory size of xxx bytes exhausted (tried to allocate yyy bytes). Что это такое?</a>
</h2><p>При попытке зайти в тему, профиль пользователя, список пользователей либо любую другую страницу ничего не выводится, либо выводится сообщение аналогичное приведенному:</p>






    




<div class="shortcode shortcode-window">
  <div class="card text-bg-danger mb-3 overflow-hidden">
    <div class="card-header">
      <div class="d-flex align-items-center">
        <div class="flex-shrink-0">
          <i class="fas fa-computer fa-fw"></i>
        </div>
        <div class="flex-grow-1 mx-2">
          <h5 class="mb-0">Fatal error</h5>
        </div>
        <div class="flex-shrink-0">
          <ul class="list-inline mb-0">
            <li class="list-inline-item"><i class="fas fa-circle fa-fw"></i></li>
            <li class="list-inline-item"><i class="fas fa-circle fa-fw"></i></li>
            <li class="list-inline-item"><i class="fas fa-circle fa-fw"></i></li>
          </ul>
        </div>
      </div>
    </div>
    <div class="card-body">
        <p>Fatal error: Allowed memory size of 8388608 bytes exhausted (tried to allocate 737280 bytes) in /home/ourmobil/public_html/forum/sources/ipsclass.php(2054) : eval()&rsquo;d code on line 1085</p>

    </div>
  </div>
</div>

<p>или такому:</p>






    




<div class="shortcode shortcode-window">
  <div class="card text-bg-danger mb-3 overflow-hidden">
    <div class="card-header">
      <div class="d-flex align-items-center">
        <div class="flex-shrink-0">
          <i class="fas fa-computer fa-fw"></i>
        </div>
        <div class="flex-grow-1 mx-2">
          <h5 class="mb-0">Fatal error</h5>
        </div>
        <div class="flex-shrink-0">
          <ul class="list-inline mb-0">
            <li class="list-inline-item"><i class="fas fa-circle fa-fw"></i></li>
            <li class="list-inline-item"><i class="fas fa-circle fa-fw"></i></li>
            <li class="list-inline-item"><i class="fas fa-circle fa-fw"></i></li>
          </ul>
        </div>
      </div>
    </div>
    <div class="card-body">
        <p>Fatal error: Allowed memory size of 50331648 bytes exhausted (tried to allocate 16 bytes) in /home/users/d/demon99/docs/subs/cs/forum/ips_kernel/class_xml.php on line 254</p>

    </div>
  </div>
</div>

<p>Это означает, что для выполнения скрипта требуется больше памяти, чем предоставляет PHP. Необходимо увеличить количество выделяемой PHP памяти. Сделать это можно одним из следующих способов:</p>
<ol>
<li>В <code>.htaccess</code> добавить строку (при условии, что <span class="shortcode shortcode-tag"><a href="/ru/tags/php/" target="_blank">#PHP</a></span> работает под Apache):</li>
</ol>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-14
shortcode-codeblock-apache">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-37d03b9d5de3e42a4d7dd33616ebb2be" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-apache" data-lang="apache"><span class="line"><span class="cl"><span class="nb">php_value</span> memory_limit <span class="m">32</span>M</span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-37d03b9d5de3e42a4d7dd33616ebb2be"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<ol start="2">
<li>В <code>php.ini</code> (при условии, что Вы можете его редактировать) изменить значение параметра <code>memory_limit</code>:</li>
</ol>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-15
shortcode-codeblock-ini">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-9a5be2fce9205c49cd9b1ac3c7b6b943" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-ini" data-lang="ini"><span class="line"><span class="cl"><span class="na">memory_limit 32M</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-9a5be2fce9205c49cd9b1ac3c7b6b943"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<ol start="3">
<li>Добавив в <code>index.php</code> после:</li>
</ol>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-16
shortcode-codeblock-php">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-4da0f9c69b0ba5d61f2e1c786e44ef53" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="o">&lt;?</span><span class="nx">php</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-4da0f9c69b0ba5d61f2e1c786e44ef53"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<p>следующий код:</p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-17
shortcode-codeblock-php">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-a6bac0a3fab5282b712c840b646463a0" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="nx">ini_set</span><span class="p">(</span><span class="s1">&#39;memory_limit&#39;</span><span class="p">,</span> <span class="s1">&#39;32M&#39;</span><span class="p">);</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-a6bac0a3fab5282b712c840b646463a0"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<p>Если ни один из предложенных вариантов не подошел, обратитесь за помощью к хостеру с указанием описания ошибки.</p>
<h2 id="как-сделать-форум-на-несколько-доменов">
  <a class="link-body-emphasis" href="#%d0%ba%d0%b0%d0%ba-%d1%81%d0%b4%d0%b5%d0%bb%d0%b0%d1%82%d1%8c-%d1%84%d0%be%d1%80%d1%83%d0%bc-%d0%bd%d0%b0-%d0%bd%d0%b5%d1%81%d0%ba%d0%be%d0%bb%d1%8c%d0%ba%d0%be-%d0%b4%d0%be%d0%bc%d0%b5%d0%bd%d0%be%d0%b2">Как сделать форум на несколько доменов?</a>
</h2><p>Если у вас несколько доменов, но ОДНА база данных, то в <code>conf_global.php</code> нужно изменить строчку:</p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-18
shortcode-codeblock-php">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-23cdb4616eb8b03a1ae82ee9e6c2482a" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="nv">$INFO</span><span class="p">[</span><span class="s1">&#39;board_url&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;http://domain.com&#39;</span><span class="p">;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-23cdb4616eb8b03a1ae82ee9e6c2482a"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<p>На такую:</p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-19
shortcode-codeblock-php">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-48b01e622907209e48b754928c12e835" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="nv">$INFO</span><span class="p">[</span><span class="s1">&#39;board_url&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&#34;http://&#34;</span><span class="o">.</span><span class="nv">$_SERVER</span><span class="p">[</span><span class="s2">&#34;HTTP_HOST&#34;</span><span class="p">];</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-48b01e622907209e48b754928c12e835"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<p>Однако, если форум установлен в под-директорию, например, <code>http://domain.com/forum</code>, то необходимо изменить строчку на следующую:</p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-20
shortcode-codeblock-php">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-7a5164d7de44c7d212187012401af6c1" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="nv">$INFO</span><span class="p">[</span><span class="s1">&#39;board_url&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&#34;http://&#34;</span><span class="o">.</span><span class="nv">$_SERVER</span><span class="p">[</span><span class="s2">&#34;HTTP_HOST&#34;</span><span class="p">]</span><span class="o">.</span><span class="s2">&#34;/forum&#34;</span><span class="p">;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-7a5164d7de44c7d212187012401af6c1"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<p>Где:</p>
<ul>
<li><code>forum</code> - папка форума.</li>
</ul>
<h2 id="как-сделать-чтобы-прикреплённые-имена-файлов-имели-русские-символы-в-названии">
  <a class="link-body-emphasis" href="#%d0%ba%d0%b0%d0%ba-%d1%81%d0%b4%d0%b5%d0%bb%d0%b0%d1%82%d1%8c-%d1%87%d1%82%d0%be%d0%b1%d1%8b-%d0%bf%d1%80%d0%b8%d0%ba%d1%80%d0%b5%d0%bf%d0%bb%d1%91%d0%bd%d0%bd%d1%8b%d0%b5-%d0%b8%d0%bc%d0%b5%d0%bd%d0%b0-%d1%84%d0%b0%d0%b9%d0%bb%d0%be%d0%b2-%d0%b8%d0%bc%d0%b5%d0%bb%d0%b8-%d1%80%d1%83%d1%81%d1%81%d0%ba%d0%b8%d0%b5-%d1%81%d0%b8%d0%bc%d0%b2%d0%be%d0%bb%d1%8b-%d0%b2-%d0%bd%d0%b0%d0%b7%d0%b2%d0%b0%d0%bd%d0%b8%d0%b8">Как сделать, чтобы прикреплённые имена файлов имели русские символы в названии?</a>
</h2><p>Для этого необходимо открыть файл <code>./ips_kernel/class_upload.php</code>, найти:</p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-21
shortcode-codeblock-php">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-eb16096870bd06b8609c7703b80774f2" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="c1">//-------------------------------------------------
</span></span></span><span class="line"><span class="cl"><span class="c1">// Make the uploaded file safe
</span></span></span><span class="line"><span class="cl"><span class="c1">//-------------------------------------------------
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl"><span class="nv">$FILE_NAME</span> <span class="o">=</span> <span class="nx">preg_replace</span><span class="p">(</span> <span class="s2">&#34;/[^\w\.]/&#34;</span><span class="p">,</span> <span class="s2">&#34;_&#34;</span><span class="p">,</span> <span class="nv">$FILE_NAME</span> <span class="p">);</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-eb16096870bd06b8609c7703b80774f2"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<p>Заменить на:</p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-22
shortcode-codeblock-php">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-fc002549c5a39ca0f11d158bb84de142" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="c1">//-------------------------------------------------
</span></span></span><span class="line"><span class="cl"><span class="c1">// Make the uploaded file safe
</span></span></span><span class="line"><span class="cl"><span class="c1">//-------------------------------------------------
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl"><span class="nv">$FILE_NAME</span> <span class="o">=</span> <span class="nx">preg_replace</span><span class="p">(</span> <span class="s2">&#34;/[^a-zA-Z0-9а-яА-Я\-\.\_]/&#34;</span><span class="p">,</span> <span class="s2">&#34;_&#34;</span><span class="p">,</span> <span class="nv">$FILE_NAME</span> <span class="p">);</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-fc002549c5a39ca0f11d158bb84de142"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>]]></turbo:content></item><item turbo="true"><title>SQL запросы IP.Board 2.3</title><link>https://lib.onl/ru/2023/10/54d4e488-9a8f-55ed-8fea-c77d4dba0720/</link><pubDate>Mon, 16 Oct 2023 23:59:21 +0000</pubDate><dc:creator>Kai Kimera</dc:creator><category>CMF</category><category>В истории</category><yandex:related><link url="https://lib.onl/ru/2023/10/06c9d359-31f0-5862-a342-62a21d4eb032/">SQL запросы IP.Board 3.x</link><link url="https://lib.onl/ru/2023/10/0743e73e-7c4c-5ab8-bba3-ba70bdb5cdfd/">Условия в файлах IP.Board 2.3</link><link url="https://lib.onl/ru/2023/10/d310a44c-4259-5bef-a7c2-d3d09a5c69f4/">Условия в шаблонах IP.Board 2.3</link><link url="https://lib.onl/ru/2023/10/a7405294-9f0c-52c1-a70e-ce4990079dc7/">Условия в шаблонах IP.Board 3.x</link></yandex:related><turbo:extendedHtml>true</turbo:extendedHtml><turbo:source>https://lib.onl/ru/2023/10/54d4e488-9a8f-55ed-8fea-c77d4dba0720/</turbo:source><turbo:topic>SQL запросы IP.Board 2.3</turbo:topic><turbo:content><![CDATA[<p>Запросы для базы дынных (<span class="shortcode shortcode-tag"><a href="/ru/tags/sql/" target="_blank">#SQL</a></span>) <span class="shortcode shortcode-tag"><a href="/ru/tags/ipb/" target="_blank">#IPB</a></span> 2.3. Информация со старых проектов. Пригодится.</p>
<h2 id="sql-запросы">
  <a class="link-body-emphasis" href="#sql-%d0%b7%d0%b0%d0%bf%d1%80%d0%be%d1%81%d1%8b">SQL запросы</a>
</h2><ol>
<li>Заменить определённый текст во всех сообщениях на форуме.</li>
</ol>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-0
shortcode-codeblock-sql">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-62d9f9c81814b21954505a65dc28b1f2" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="k">UPDATE</span><span class="w"> </span><span class="n">ibf_posts</span><span class="w"> </span><span class="k">SET</span><span class="w"> </span><span class="n">post</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">REPLACE</span><span class="p">(</span><span class="n">post</span><span class="p">,</span><span class="s1">&#39;старый текст&#39;</span><span class="p">,</span><span class="s1">&#39;новый текст&#39;</span><span class="p">);</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-62d9f9c81814b21954505a65dc28b1f2"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<ol start="2">
<li>Заменить текст во всех описаниях форумов.</li>
</ol>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-1
shortcode-codeblock-sql">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-9b7adb1cc5f09e92259dc3056cc1caff" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="k">UPDATE</span><span class="w"> </span><span class="n">ibf_forums</span><span class="w"> </span><span class="k">SET</span><span class="w"> </span><span class="n">description</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">REPLACE</span><span class="p">(</span><span class="n">description</span><span class="p">,</span><span class="s1">&#39;старый текст&#39;</span><span class="p">,</span><span class="s1">&#39;новый текст&#39;</span><span class="p">);</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-9b7adb1cc5f09e92259dc3056cc1caff"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<ol start="3">
<li>Очистка журнала предупреждений конкретного пользователя, где X - вставить id пользователя, чей журнал вы хотите очистить.</li>
</ol>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-2
shortcode-codeblock-sql">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-8299cc47dd7fb9203fc0f091264264a0" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="k">DELETE</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">ibf_warn_logs</span><span class="w"> </span><span class="k">WHERE</span><span class="w"> </span><span class="n">wlog_mid</span><span class="o">=</span><span class="n">X</span><span class="p">;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-8299cc47dd7fb9203fc0f091264264a0"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<ol start="4">
<li>Удалить подписи у всех пользователей.</li>
</ol>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-3
shortcode-codeblock-sql">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-e692c475a8023f61bfa7640a2322f6c7" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="k">UPDATE</span><span class="w"> </span><span class="n">ibf_member_extra</span><span class="w"> </span><span class="k">SET</span><span class="w"> </span><span class="n">signature</span><span class="o">=</span><span class="s1">&#39;Ваша подпись удалена&#39;</span><span class="p">;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-e692c475a8023f61bfa7640a2322f6c7"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<ol start="5">
<li>Удаление модераторов.</li>
</ol>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-4
shortcode-codeblock-sql">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-b5442cefcac7561d953a540d78308c9b" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="k">DELETE</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">ibf_moderators</span><span class="p">;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-b5442cefcac7561d953a540d78308c9b"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<ol start="6">
<li>Удаление модератора из всех форумов.</li>
</ol>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-5
shortcode-codeblock-sql">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-fe432028770f2e32117c41edf71a8246" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="k">DELETE</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">ibf_moderators</span><span class="w"> </span><span class="k">WHERE</span><span class="w"> </span><span class="n">member_id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">XX</span><span class="p">;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-fe432028770f2e32117c41edf71a8246"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<ol start="7">
<li>Удаление модератора из определённых форумов.</li>
</ol>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-6
shortcode-codeblock-sql">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-8a88590d66a41bf025528b45754b629d" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="k">DELETE</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">ibf_moderators</span><span class="w"> </span><span class="k">WHERE</span><span class="w"> </span><span class="n">member_id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">XX</span><span class="w"> </span><span class="k">AND</span><span class="w"> </span><span class="n">forum_id</span><span class="w"> </span><span class="k">IN</span><span class="w"> </span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="w"> </span><span class="mi">11</span><span class="p">,</span><span class="w"> </span><span class="mi">22</span><span class="p">,</span><span class="w"> </span><span class="mi">25</span><span class="p">);</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-8a88590d66a41bf025528b45754b629d"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<ol start="8">
<li>Удаление аватаров у всех пользователей.</li>
</ol>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-7
shortcode-codeblock-sql">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-fd2b6675ff41d28951c2d231448b384b" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="k">DELETE</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">ibf_member_extra</span><span class="w"> </span><span class="k">WHERE</span><span class="w"> </span><span class="n">avatar_location</span><span class="w"> </span><span class="k">AND</span><span class="w"> </span><span class="n">avatar_size</span><span class="p">;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-fd2b6675ff41d28951c2d231448b384b"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<ol start="9">
<li>Если не работает, то выполните следующие два запроса:</li>
</ol>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-8
shortcode-codeblock-sql">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-bfff2ae52886a267fe38994e3bba40ac" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="k">UPDATE</span><span class="w"> </span><span class="n">ibf_member_extra</span><span class="w"> </span><span class="k">SET</span><span class="w"> </span><span class="n">avatar_location</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;&#39;</span><span class="p">;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-bfff2ae52886a267fe38994e3bba40ac"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>











  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-9
shortcode-codeblock-sql">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-cdaafc7553ade6e27b5fbebc0f7d5271" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="k">UPDATE</span><span class="w"> </span><span class="n">ibf_member_extra</span><span class="w"> </span><span class="k">SET</span><span class="w"> </span><span class="n">avatar_size</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;&#39;</span><span class="p">;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-cdaafc7553ade6e27b5fbebc0f7d5271"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<ol start="10">
<li>Массовый перенос пользователей c определённым количеством сообщений из одной группы в другую.</li>
</ol>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-10
shortcode-codeblock-sql">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-5ab95a4182911b4c9c5a9ff102cd9184" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="k">UPDATE</span><span class="w"> </span><span class="n">ibf_members</span><span class="w"> </span><span class="k">SET</span><span class="w"> </span><span class="n">mgroup</span><span class="o">=</span><span class="err">Б</span><span class="w"> </span><span class="k">WHERE</span><span class="w"> </span><span class="n">mgroup</span><span class="o">=</span><span class="err">А</span><span class="w"> </span><span class="k">AND</span><span class="w"> </span><span class="n">posts</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-5ab95a4182911b4c9c5a9ff102cd9184"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<ol start="11">
<li>Удалить пользователей определенной группы, где b меняете на номер группы.</li>
</ol>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-11
shortcode-codeblock-sql">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-9549157248944d1168f9bf60f7550dde" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="k">DELETE</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">ibf_members</span><span class="w"> </span><span class="k">WHERE</span><span class="w"> </span><span class="n">mgroup</span><span class="o">=</span><span class="s1">&#39;b&#39;</span><span class="p">;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-9549157248944d1168f9bf60f7550dde"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<ol start="12">
<li>Удалить все ICQ номера пользователей.</li>
</ol>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-12
shortcode-codeblock-sql">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-ae3946f8b0a9738acfbb244f98b5ca51" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="k">UPDATE</span><span class="w"> </span><span class="n">ibf_member_extra</span><span class="w"> </span><span class="k">SET</span><span class="w"> </span><span class="n">icq_number</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-ae3946f8b0a9738acfbb244f98b5ca51"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<ol start="13">
<li>Удалить ссылки на сайт у всех пользователей.</li>
</ol>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-13
shortcode-codeblock-sql">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-780f7e8f3393813deef1ce54dd72737a" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="k">UPDATE</span><span class="w"> </span><span class="n">ibf_member_extra</span><span class="w"> </span><span class="k">SET</span><span class="w"> </span><span class="n">website</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-780f7e8f3393813deef1ce54dd72737a"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<ol start="14">
<li>Снятие обязательного подтверждения модератором.</li>
</ol>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-14
shortcode-codeblock-sql">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-c4723319e84f8878b069d83b36a0f994" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="k">UPDATE</span><span class="w"> </span><span class="n">ibf_members</span><span class="w"> </span><span class="k">SET</span><span class="w"> </span><span class="n">mod_posts</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-c4723319e84f8878b069d83b36a0f994"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<ol start="15">
<li>Снятие только чтение/read_only.</li>
</ol>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-15
shortcode-codeblock-sql">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-d96c78e2a6de6d091349da551ff723ea" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="k">UPDATE</span><span class="w"> </span><span class="n">ibf_members</span><span class="w"> </span><span class="k">SET</span><span class="w"> </span><span class="n">restrict_post</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-d96c78e2a6de6d091349da551ff723ea"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<ol start="16">
<li>Очистка журнала.</li>
</ol>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-16
shortcode-codeblock-sql">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-a38814639bb52e1158583c171821fd52" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="k">DELETE</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">ibf_warn_logs</span><span class="w"> </span><span class="k">WHERE</span><span class="w"> </span><span class="n">wlog_mid</span><span class="o">=</span><span class="n">id_пользователя</span><span class="p">;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-a38814639bb52e1158583c171821fd52"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<ol start="17">
<li>Удаление всех установленных смайликов, то есть они переходят в список неустановленных смайликов.</li>
</ol>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-17
shortcode-codeblock-sql">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-3e6682a05848759074b11175b395f1c7" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="k">DELETE</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">ibf_emoticons</span><span class="p">;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-3e6682a05848759074b11175b395f1c7"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<ol start="18">
<li>Установка кодировки и сравнения БД по умолчанию.</li>
</ol>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-18
shortcode-codeblock-sql">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-b9a40a0df7264ce43e956d52f39ad498" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="k">ALTER</span><span class="w"> </span><span class="k">DATABASE</span><span class="w"> </span><span class="o">`</span><span class="err">название</span><span class="n">_бд</span><span class="o">`</span><span class="w"> </span><span class="k">DEFAULT</span><span class="w"> </span><span class="nb">CHARACTER</span><span class="w"> </span><span class="k">SET</span><span class="w"> </span><span class="n">cp1251</span><span class="w"> </span><span class="k">COLLATE</span><span class="w"> </span><span class="n">cp1251_general_ci</span><span class="p">;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-b9a40a0df7264ce43e956d52f39ad498"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<ol start="19">
<li>Аннулируем счётчик сообщений у всех пользователей.</li>
</ol>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-19
shortcode-codeblock-sql">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-c6ddbf54982151420c6b6e466978d030" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="k">UPDATE</span><span class="w"> </span><span class="n">ibf_members</span><span class="w"> </span><span class="k">SET</span><span class="w"> </span><span class="n">posts</span><span class="o">=</span><span class="s1">&#39;0&#39;</span><span class="p">;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-c6ddbf54982151420c6b6e466978d030"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<ol start="20">
<li>Аннулируем счётчик сообщений у определённых групп.</li>
</ol>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-20
shortcode-codeblock-sql">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-4f93774018ccfbbd7caffe2c6bc3823e" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="k">UPDATE</span><span class="w"> </span><span class="n">ibf_members</span><span class="w"> </span><span class="k">SET</span><span class="w"> </span><span class="n">posts</span><span class="o">=</span><span class="s1">&#39;0&#39;</span><span class="w"> </span><span class="k">WHERE</span><span class="w"> </span><span class="n">mgroup</span><span class="o">=</span><span class="s1">&#39;номер_группы&#39;</span><span class="p">;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-4f93774018ccfbbd7caffe2c6bc3823e"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<ol start="21">
<li>Удаление всех сообщений оставленных гостями.</li>
</ol>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-21
shortcode-codeblock-sql">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-bb152453b02a08a19d7dcca8c22d27b5" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="k">DELETE</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">ibf_posts</span><span class="w"> </span><span class="k">WHERE</span><span class="w"> </span><span class="n">author_id</span><span class="o">=</span><span class="s1">&#39;0&#39;</span><span class="p">;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-bb152453b02a08a19d7dcca8c22d27b5"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<ol start="22">
<li>Заменить текст во всех описаниях тем.</li>
</ol>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-22
shortcode-codeblock-sql">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-08e44b5643f4f902cccc1f24cd3adadf" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="k">UPDATE</span><span class="w"> </span><span class="n">ibf_topics</span><span class="w"> </span><span class="k">SET</span><span class="w"> </span><span class="n">description</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">REPLACE</span><span class="p">(</span><span class="n">description</span><span class="p">,</span><span class="s1">&#39;старый текст&#39;</span><span class="p">,</span><span class="s1">&#39;новый текст&#39;</span><span class="p">);</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-08e44b5643f4f902cccc1f24cd3adadf"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<h2 id="благодарности">
  <a class="link-body-emphasis" href="#%d0%b1%d0%bb%d0%b0%d0%b3%d0%be%d0%b4%d0%b0%d1%80%d0%bd%d0%be%d1%81%d1%82%d0%b8">Благодарности</a>
</h2><p>В составлении запросов благодарим следующих участников конференции:</p>
<ul>
<li>Mazafuka</li>
<li>КиКиМоРа</li>
<li>a_aqua</li>
<li>Ritsuka</li>
<li>Security</li>
<li>truth</li>
</ul>]]></turbo:content></item><item turbo="true"><title>SQL запросы IP.Board 3.x</title><link>https://lib.onl/ru/2023/10/06c9d359-31f0-5862-a342-62a21d4eb032/</link><pubDate>Mon, 16 Oct 2023 23:55:00 +0000</pubDate><dc:creator>Kai Kimera</dc:creator><category>CMF</category><category>В истории</category><yandex:related><link url="https://lib.onl/ru/2023/10/0743e73e-7c4c-5ab8-bba3-ba70bdb5cdfd/">Условия в файлах IP.Board 2.3</link><link url="https://lib.onl/ru/2023/10/d310a44c-4259-5bef-a7c2-d3d09a5c69f4/">Условия в шаблонах IP.Board 2.3</link><link url="https://lib.onl/ru/2023/10/a7405294-9f0c-52c1-a70e-ce4990079dc7/">Условия в шаблонах IP.Board 3.x</link></yandex:related><turbo:extendedHtml>true</turbo:extendedHtml><turbo:source>https://lib.onl/ru/2023/10/06c9d359-31f0-5862-a342-62a21d4eb032/</turbo:source><turbo:topic>SQL запросы IP.Board 3.x</turbo:topic><turbo:content><![CDATA[<p>Запросы для базы дынных (<span class="shortcode shortcode-tag"><a href="/ru/tags/sql/" target="_blank">#SQL</a></span>) <span class="shortcode shortcode-tag"><a href="/ru/tags/ipb/" target="_blank">#IPB</a></span> 3. Информация со старых проектов. Пригодится.</p>
<h2 id="sql-запросы">
  <a class="link-body-emphasis" href="#sql-%d0%b7%d0%b0%d0%bf%d1%80%d0%be%d1%81%d1%8b">SQL запросы</a>
</h2><ol>
<li>Удалить всех модераторов.</li>
</ol>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-0
shortcode-codeblock-sql">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-39b52c6685b3d6589283290173d23ea6" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="k">DELETE</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">moderators</span><span class="p">;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-39b52c6685b3d6589283290173d23ea6"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<ol start="2">
<li>Удалить все подписи.</li>
</ol>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-1
shortcode-codeblock-sql">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-2849df6330c588adc634b70f9919d027" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="k">DELETE</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">content_cache_sigs</span><span class="p">;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-2849df6330c588adc634b70f9919d027"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>











  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-2
shortcode-codeblock-sql">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-1a96fddc5e34b80ac5f6e92f76cbf491" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="k">UPDATE</span><span class="w"> </span><span class="n">profile_portal</span><span class="w"> </span><span class="k">SET</span><span class="w"> </span><span class="n">signature</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-1a96fddc5e34b80ac5f6e92f76cbf491"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<ol start="3">
<li>Массовый перенос пользователей c определённым количеством сообщений из одной группы в другую.</li>
</ol>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-3
shortcode-codeblock-sql">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-7f932a5baa88c95b4a9f5e35b844a513" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="k">UPDATE</span><span class="w"> </span><span class="n">members</span><span class="w"> </span><span class="k">SET</span><span class="w"> </span><span class="n">member_group_id</span><span class="o">=</span><span class="err">Б</span><span class="w"> </span><span class="k">WHERE</span><span class="w"> </span><span class="n">member_group_id</span><span class="o">=</span><span class="err">А</span><span class="w"> </span><span class="k">AND</span><span class="w"> </span><span class="n">posts</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-7f932a5baa88c95b4a9f5e35b844a513"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<ol start="4">
<li>Полный пересчет репутации сообщений и пользователей после ручной правки <code>ibf_reputation_index</code>.</li>
</ol>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-4
shortcode-codeblock-sql">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-dae8bb2142416cb754861a0479681535" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="k">TRUNCATE</span><span class="w"> </span><span class="n">ibf_reputation_cache</span><span class="p">;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-dae8bb2142416cb754861a0479681535"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>











  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-5
shortcode-codeblock-sql">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-7e4019bf9b593b08d08cb7a222765ca4" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="k">INSERT</span><span class="w"> </span><span class="k">INTO</span><span class="w"> </span><span class="n">ibf_reputation_cache</span><span class="w"> </span><span class="p">(</span><span class="n">app</span><span class="p">,</span><span class="w"> </span><span class="k">type</span><span class="p">,</span><span class="w"> </span><span class="n">type_id</span><span class="p">,</span><span class="w"> </span><span class="n">rep_points</span><span class="p">)</span><span class="w"> </span><span class="k">SELECT</span><span class="w"> </span><span class="n">app</span><span class="p">,</span><span class="w"> </span><span class="k">type</span><span class="p">,</span><span class="w"> </span><span class="n">type_id</span><span class="p">,</span><span class="w"> </span><span class="k">SUM</span><span class="p">(</span><span class="n">rep_rating</span><span class="p">)</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">ibf_reputation_index</span><span class="w"> </span><span class="k">GROUP</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="n">type_id</span><span class="p">;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-7e4019bf9b593b08d08cb7a222765ca4"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>











  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-6
shortcode-codeblock-sql">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-904ce5c52ee5264968e4d6b1095c4e62" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="k">UPDATE</span><span class="w"> </span><span class="n">ibf_profile_portal</span><span class="w"> </span><span class="n">pp</span><span class="w"> </span><span class="k">SET</span><span class="w"> </span><span class="n">pp</span><span class="p">.</span><span class="n">pp_reputation_points</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="k">SELECT</span><span class="w"> </span><span class="k">SUM</span><span class="p">(</span><span class="n">r</span><span class="p">.</span><span class="n">rep_points</span><span class="p">)</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">ibf_posts</span><span class="w"> </span><span class="n">p</span><span class="w"> </span><span class="k">LEFT</span><span class="w"> </span><span class="k">JOIN</span><span class="w"> </span><span class="n">ibf_reputation_cache</span><span class="w"> </span><span class="n">r</span><span class="w"> </span><span class="k">ON</span><span class="w"> </span><span class="n">r</span><span class="p">.</span><span class="n">type_id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">p</span><span class="p">.</span><span class="n">pid</span><span class="w"> </span><span class="k">WHERE</span><span class="w"> </span><span class="n">p</span><span class="p">.</span><span class="n">author_id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">pp</span><span class="p">.</span><span class="n">pp_member_id</span><span class="p">);</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-904ce5c52ee5264968e4d6b1095c4e62"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<ol start="5">
<li>Удаление или замена ненужного мусора из сообщений, например, куски от старых BBCODE.</li>
</ol>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-7
shortcode-codeblock-sql">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-310ffe906e244d20f3e4bc1b158f2766" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="k">UPDATE</span><span class="w"> </span><span class="n">ibf_posts</span><span class="w"> </span><span class="k">SET</span><span class="w"> </span><span class="n">post</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">REPLACE</span><span class="p">(</span><span class="n">post</span><span class="p">,</span><span class="s2">&#34;original&#34;</span><span class="p">,</span><span class="s2">&#34;replace&#34;</span><span class="p">);</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-310ffe906e244d20f3e4bc1b158f2766"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<ol start="6">
<li>Удаление или замена информации из подписей пользователей.</li>
</ol>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-8
shortcode-codeblock-sql">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-39bb90571e5780427f7889245f260475" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="k">UPDATE</span><span class="w"> </span><span class="n">ibf_profile_portal</span><span class="w"> </span><span class="k">SET</span><span class="w"> </span><span class="n">signature</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">REPLACE</span><span class="p">(</span><span class="n">signature</span><span class="p">,</span><span class="s2">&#34;original&#34;</span><span class="p">,</span><span class="s2">&#34;replace&#34;</span><span class="p">);</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-39bb90571e5780427f7889245f260475"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<h2 id="благодарности">
  <a class="link-body-emphasis" href="#%d0%b1%d0%bb%d0%b0%d0%b3%d0%be%d0%b4%d0%b0%d1%80%d0%bd%d0%be%d1%81%d1%82%d0%b8">Благодарности</a>
</h2><p>В составлении запросов благодарим следующих участников конференции:</p>
<ul>
<li>Mazafuka</li>
<li>КиКиМоРа</li>
<li>a_aqua</li>
<li>Ritsuka</li>
<li>Security</li>
<li>truth</li>
</ul>]]></turbo:content></item><item turbo="true"><title>Условия в файлах IP.Board 2.3</title><link>https://lib.onl/ru/2023/10/0743e73e-7c4c-5ab8-bba3-ba70bdb5cdfd/</link><pubDate>Mon, 16 Oct 2023 23:49:40 +0000</pubDate><dc:creator>Kai Kimera</dc:creator><category>CMF</category><category>В истории</category><yandex:related><link url="https://lib.onl/ru/2023/10/d310a44c-4259-5bef-a7c2-d3d09a5c69f4/">Условия в шаблонах IP.Board 2.3</link><link url="https://lib.onl/ru/2023/10/a7405294-9f0c-52c1-a70e-ce4990079dc7/">Условия в шаблонах IP.Board 3.x</link></yandex:related><turbo:extendedHtml>true</turbo:extendedHtml><turbo:source>https://lib.onl/ru/2023/10/0743e73e-7c4c-5ab8-bba3-ba70bdb5cdfd/</turbo:source><turbo:topic>Условия в файлах IP.Board 2.3</turbo:topic><turbo:content><![CDATA[<p>Условия в файлах для <span class="shortcode shortcode-tag"><a href="/ru/tags/ipb/" target="_blank">#IPB</a></span> 2.3. Версия <strong>2.3</strong> ужа давно не актуальна, но информация пусть будет.</p>
<h2 id="условия-в-файлах">
  <a class="link-body-emphasis" href="#%d1%83%d1%81%d0%bb%d0%be%d0%b2%d0%b8%d1%8f-%d0%b2-%d1%84%d0%b0%d0%b9%d0%bb%d0%b0%d1%85">Условия в файлах</a>
</h2><ol>
<li>Показать информацию только для пользователей.</li>
</ol>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-0
shortcode-codeblock-php">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-fdf9c2e54f0a6481bec6785438ed4552" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="k">if</span> <span class="p">(</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">ipsclass</span><span class="o">-&gt;</span><span class="na">member</span><span class="p">[</span><span class="s1">&#39;id&#39;</span><span class="p">]</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="cm">/* информация только для пользователей */</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-fdf9c2e54f0a6481bec6785438ed4552"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<ol start="2">
<li>Показать информацию только супер-модераторам.</li>
</ol>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-1
shortcode-codeblock-php">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-ceda9df30becb691919dee781bfd2329" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="k">if</span> <span class="p">(</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">ipsclass</span><span class="o">-&gt;</span><span class="na">member</span><span class="p">[</span><span class="s1">&#39;g_is_supmod&#39;</span><span class="p">]</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="cm">/* информация только для супермодераторов */</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-ceda9df30becb691919dee781bfd2329"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<ol start="3">
<li>Показать информацию только администраторам.</li>
</ol>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-2
shortcode-codeblock-php">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-1a33176d54d2b4f745da5afc1e75efe7" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="k">if</span> <span class="p">(</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">ipsclass</span><span class="o">-&gt;</span><span class="na">member</span><span class="p">[</span><span class="s1">&#39;mgroup&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">ipsclass</span><span class="o">-&gt;</span><span class="na">vars</span><span class="p">[</span><span class="s1">&#39;admin_group&#39;</span><span class="p">]</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="cm">/* информация только для администраторов */</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-1a33176d54d2b4f745da5afc1e75efe7"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<ol start="4">
<li>Показать информацию только модераторам.</li>
</ol>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-3
shortcode-codeblock-php">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-f63eaed8e2110de015f45ba603aa845c" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="k">if</span> <span class="p">(</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">ipsclass</span><span class="o">-&gt;</span><span class="na">member</span><span class="p">[</span><span class="s1">&#39;_moderator&#39;</span><span class="p">]</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="cm">/* информация только для модераторов */</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-f63eaed8e2110de015f45ba603aa845c"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<ol start="5">
<li>Показать информацию в определённом форуме.</li>
</ol>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-4
shortcode-codeblock-php">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-92c6fa7513cefbe38f30a2672d7b710b" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="k">if</span> <span class="p">(</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">ipsclass</span><span class="o">-&gt;</span><span class="na">input</span><span class="p">[</span><span class="s1">&#39;f&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">35</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="cm">/* информация только в опеределённом форуме с ID = 35 */</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-92c6fa7513cefbe38f30a2672d7b710b"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<ol start="6">
<li>Показать информацию на определённой странице.</li>
</ol>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-5
shortcode-codeblock-php">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-1c9abcc3ef4fe67d281e797293b6ab71" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="k">if</span> <span class="p">(</span> <span class="nv">$ipsclass</span><span class="o">-&gt;</span><span class="na">input</span><span class="p">[</span><span class="s1">&#39;_low_act&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;home&#39;</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="cm">/* информация только на определённой странице (в данном случае - home) */</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-1c9abcc3ef4fe67d281e797293b6ab71"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<ol start="7">
<li>Пример сложной конструкции с применением <code>&lt;или&gt;</code>.</li>
</ol>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-6
shortcode-codeblock-php">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-6a91f33ff346a73b59fe8778d56d9baf" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="k">if</span> <span class="p">(</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">ipsclass</span><span class="o">-&gt;</span><span class="na">member</span><span class="p">[</span><span class="s1">&#39;id&#39;</span><span class="p">]</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="cm">/* информация только для пользователей */</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="k">else</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="cm">/* информация только для гостей */</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-6a91f33ff346a73b59fe8778d56d9baf"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>]]></turbo:content></item><item turbo="true"><title>Условия в шаблонах IP.Board 2.3</title><link>https://lib.onl/ru/2023/10/d310a44c-4259-5bef-a7c2-d3d09a5c69f4/</link><pubDate>Mon, 16 Oct 2023 23:11:29 +0000</pubDate><dc:creator>Kai Kimera</dc:creator><category>CMF</category><category>В истории</category><yandex:related><link url="https://lib.onl/ru/2023/10/a7405294-9f0c-52c1-a70e-ce4990079dc7/">Условия в шаблонах IP.Board 3.x</link></yandex:related><turbo:extendedHtml>true</turbo:extendedHtml><turbo:source>https://lib.onl/ru/2023/10/d310a44c-4259-5bef-a7c2-d3d09a5c69f4/</turbo:source><turbo:topic>Условия в шаблонах IP.Board 2.3</turbo:topic><turbo:content><![CDATA[<p>Список условий, которые можно использовать в шаблонах <span class="shortcode shortcode-tag"><a href="/ru/tags/ipb/" target="_blank">#IPB</a></span> 2.3. Версия <strong>2.3</strong> уже давно не актуальна, но я всё же решил сохранить информацию в своей библиотеке.</p>
<h2 id="условия-в-шаблонах">
  <a class="link-body-emphasis" href="#%d1%83%d1%81%d0%bb%d0%be%d0%b2%d0%b8%d1%8f-%d0%b2-%d1%88%d0%b0%d0%b1%d0%bb%d0%be%d0%bd%d0%b0%d1%85">Условия в шаблонах</a>
</h2><ol>
<li>Показать информацию только для пользователей.</li>
</ol>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-0
shortcode-codeblock-html">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-2e0e4f1a85243af3f213cb339a773281" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-html" data-lang="html"><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">if</span><span class="err">=&#34;</span><span class="na">ipb</span><span class="err">.</span><span class="na">member</span><span class="err">[&#39;</span><span class="na">id</span><span class="err">&#39;]</span> <span class="p">&gt;</span> 0&#34;&gt;
</span></span><span class="line"><span class="cl">  <span class="c">&lt;!-- информация только для пользователей --&gt;</span>
</span></span><span class="line"><span class="cl"><span class="p">&lt;/</span><span class="nt">if</span><span class="p">&gt;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-2e0e4f1a85243af3f213cb339a773281"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<ol start="2">
<li>Показать информацию только для гостей.</li>
</ol>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-1
shortcode-codeblock-html">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-743b9ef112f1111dc85a2e9ad91077d8" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-html" data-lang="html"><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">if</span><span class="err">=&#34;</span><span class="na">ipb</span><span class="err">.</span><span class="na">member</span><span class="err">[&#39;</span><span class="na">id</span><span class="err">&#39;]</span> <span class="err">&lt;=</span> <span class="na">0</span><span class="err">&#34;</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="c">&lt;!-- информация только для гостей --&gt;</span>
</span></span><span class="line"><span class="cl"><span class="p">&lt;/</span><span class="nt">if</span><span class="p">&gt;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-743b9ef112f1111dc85a2e9ad91077d8"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<ol start="3">
<li>Показать информацию только для группы администраторов.</li>
</ol>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-2
shortcode-codeblock-html">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-03c8fa464087226bc13b7b231f330566" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-html" data-lang="html"><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">if</span><span class="err">=&#34;</span><span class="na">ipb</span><span class="err">.</span><span class="na">member</span><span class="err">[&#39;</span><span class="na">mgroup</span><span class="err">&#39;]</span> <span class="err">==</span> <span class="na">ipb</span><span class="err">.</span><span class="na">vars</span><span class="err">[&#39;</span><span class="na">admin_group</span><span class="err">&#39;]&#34;</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="c">&lt;!-- информация только для группы администраторов --&gt;</span>
</span></span><span class="line"><span class="cl"><span class="p">&lt;/</span><span class="nt">if</span><span class="p">&gt;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-03c8fa464087226bc13b7b231f330566"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<ol start="4">
<li>Показать информацию только для администрации форума.</li>
</ol>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-3
shortcode-codeblock-html">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-af03d530c64d224749737a4d43d7cb02" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-html" data-lang="html"><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">if</span><span class="err">=&#34;</span><span class="na">ipb</span><span class="err">.</span><span class="na">member</span><span class="err">[&#39;</span><span class="na">mgroup</span><span class="err">&#39;]</span> <span class="err">==</span> <span class="na">ipb</span><span class="err">.</span><span class="na">vars</span><span class="err">[&#39;</span><span class="na">admin_group</span><span class="err">&#39;]</span> <span class="err">||</span> <span class="na">ipb</span><span class="err">.</span><span class="na">member</span><span class="err">[&#39;</span><span class="na">is_mod</span><span class="err">&#39;]</span> <span class="err">||</span> <span class="na">ipb</span><span class="err">.</span><span class="na">member</span><span class="err">[&#39;</span><span class="na">g_is_supmod</span><span class="err">&#39;]</span> <span class="err">==</span> <span class="na">1</span><span class="err">&#34;</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="c">&lt;!-- информация только для администрации (различные группы) --&gt;</span>
</span></span><span class="line"><span class="cl"><span class="p">&lt;/</span><span class="nt">if</span><span class="p">&gt;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-af03d530c64d224749737a4d43d7cb02"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<ol start="5">
<li>Показать информацию только для определённого пользователя (<code>{id}</code> = ID пользователя).</li>
</ol>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-4
shortcode-codeblock-html">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-55ee933c1cd18e0d37aabe3ce98d43d3" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-html" data-lang="html"><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">if</span><span class="err">=&#34;</span><span class="na">ipb</span><span class="err">.</span><span class="na">member</span><span class="err">[&#39;</span><span class="na">id</span><span class="err">&#39;]</span> <span class="err">==</span> <span class="err">{</span><span class="na">id</span><span class="err">}&#34;</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="c">&lt;!-- информация только для пользователя с определённым {id} --&gt;</span>
</span></span><span class="line"><span class="cl"><span class="p">&lt;/</span><span class="nt">if</span><span class="p">&gt;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-55ee933c1cd18e0d37aabe3ce98d43d3"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<ol start="6">
<li>Показать информацию только для определённых пользователей (<code>{id}</code> = ID пользователя).</li>
</ol>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-5
shortcode-codeblock-html">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-45eac76c647e2fdc4d5a14c4fd1eadda" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-html" data-lang="html"><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">if</span><span class="err">=&#34;</span><span class="na">ipb</span><span class="err">.</span><span class="na">member</span><span class="err">[&#39;</span><span class="na">id</span><span class="err">&#39;]</span> <span class="err">==</span> <span class="err">{</span><span class="na">id1</span><span class="err">}</span> <span class="err">||</span> <span class="na">ipb</span><span class="err">.</span><span class="na">member</span><span class="err">[&#39;</span><span class="na">id</span><span class="err">&#39;]</span> <span class="err">==</span> <span class="err">{</span><span class="na">id2</span><span class="err">}&#34;</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="c">&lt;!-- информация только для пользователя с {id1} и {id2} --&gt;</span>
</span></span><span class="line"><span class="cl"><span class="p">&lt;/</span><span class="nt">if</span><span class="p">&gt;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-45eac76c647e2fdc4d5a14c4fd1eadda"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<ol start="7">
<li>Показать информацию только для определённой группы (<code>{gid}</code> = ID группы).</li>
</ol>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-6
shortcode-codeblock-html">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-0709fe6a61505542bda38ea012400a0b" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-html" data-lang="html"><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">if</span><span class="err">=&#34;</span><span class="na">ipb</span><span class="err">.</span><span class="na">member</span><span class="err">[&#39;</span><span class="na">mgroup</span><span class="err">&#39;]</span> <span class="err">==</span> <span class="err">{</span><span class="na">gid</span><span class="err">}&#34;</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="c">&lt;!-- информация только для определённой группы с {gid} --&gt;</span>
</span></span><span class="line"><span class="cl"><span class="p">&lt;/</span><span class="nt">if</span><span class="p">&gt;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-0709fe6a61505542bda38ea012400a0b"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<ol start="8">
<li>Показать информацию тольк для двух определённых групп (<code>{gid}</code> = ID группы).</li>
</ol>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-7
shortcode-codeblock-html">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-147f55bb6c2bbceaefc435613102b341" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-html" data-lang="html"><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">if</span><span class="err">=&#34;</span><span class="na">ipb</span><span class="err">.</span><span class="na">member</span><span class="err">[&#39;</span><span class="na">mgroup</span><span class="err">&#39;]</span> <span class="err">==</span> <span class="err">{</span><span class="na">gid1</span><span class="err">}</span> <span class="err">||</span> <span class="na">ipb</span><span class="err">.</span><span class="na">member</span><span class="err">[&#39;</span><span class="na">mgroup</span><span class="err">&#39;]</span> <span class="err">==</span> <span class="err">{</span><span class="na">gid2</span><span class="err">}&#34;</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="c">&lt;!-- информация только для группы с {gid1} и {gid2} --&gt;</span>
</span></span><span class="line"><span class="cl"><span class="p">&lt;/</span><span class="nt">if</span><span class="p">&gt;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-147f55bb6c2bbceaefc435613102b341"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<ol start="9">
<li>Показать информацию только на определённой странице форума (<code>idx</code> = страница).</li>
</ol>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-8
shortcode-codeblock-html">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-688cd489240efc62cfc1ec0bd9cef192" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-html" data-lang="html"><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">if</span><span class="err">=&#34;</span><span class="na">ipb</span><span class="err">.</span><span class="na">input</span><span class="err">[&#39;</span><span class="na">_low_act</span><span class="err">&#39;]</span> <span class="err">==</span> <span class="err">&#39;</span><span class="na">idx</span><span class="err">&#39;&#34;</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="c">&lt;!-- информация только для определённой страницы форума (index.php?act=idx) --&gt;</span>
</span></span><span class="line"><span class="cl"><span class="p">&lt;/</span><span class="nt">if</span><span class="p">&gt;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-688cd489240efc62cfc1ec0bd9cef192"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<ol start="10">
<li>Показать информацию только в определённом форуме (<code>{fid}</code> = ID форума).</li>
</ol>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-9
shortcode-codeblock-html">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-4f8cce2fd9a5f57055cf88afb489e70b" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-html" data-lang="html"><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">if</span><span class="err">=&#34;</span><span class="na">ipb</span><span class="err">.</span><span class="na">input</span><span class="err">[&#39;</span><span class="na">showforum</span><span class="err">&#39;]</span> <span class="err">==</span> <span class="err">{</span><span class="na">fid</span><span class="err">}&#34;</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="c">&lt;!-- информация только для определённого форума с {fid} --&gt;</span>
</span></span><span class="line"><span class="cl"><span class="p">&lt;/</span><span class="nt">if</span><span class="p">&gt;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-4f8cce2fd9a5f57055cf88afb489e70b"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<ol start="11">
<li>Показать информацию только в определённой теме (<code>{tid}</code> = ID темы).</li>
</ol>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-10
shortcode-codeblock-html">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-968db936441bda9610c3ac506849f0ec" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-html" data-lang="html"><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">if</span><span class="err">=&#34;</span><span class="na">ipb</span><span class="err">.</span><span class="na">input</span><span class="err">[&#39;</span><span class="na">showtopic</span><span class="err">&#39;]</span> <span class="err">==</span> <span class="err">{</span><span class="na">tid</span><span class="err">}&#34;</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="c">&lt;!-- информация только для определённой темы с {tid} --&gt;</span>
</span></span><span class="line"><span class="cl"><span class="p">&lt;/</span><span class="nt">if</span><span class="p">&gt;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-968db936441bda9610c3ac506849f0ec"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<ol start="12">
<li>Показать информацию только в определённом сообщении (<code>{pnid}</code> = номер сообщения).</li>
</ol>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-11
shortcode-codeblock-html">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-4b050616e25bd7d6f9263683451a9246" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-html" data-lang="html"><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">if</span><span class="err">=&#34;$</span><span class="na">post</span><span class="err">[&#39;</span><span class="na">post_count</span><span class="err">&#39;]</span> <span class="err">==</span> <span class="err">{</span><span class="na">pnid</span><span class="err">}&#34;</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="c">&lt;!-- информация только в сообщении с номером {pnid} --&gt;</span>
</span></span><span class="line"><span class="cl"><span class="p">&lt;/</span><span class="nt">if</span><span class="p">&gt;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-4b050616e25bd7d6f9263683451a9246"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<ol start="13">
<li>Показать информацию во всех, кроме определённого сообщения (<code>{pnid}</code> = номер сообщения).</li>
</ol>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-12
shortcode-codeblock-html">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-2061a060918449769f74d5371326fe8d" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-html" data-lang="html"><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">if</span><span class="err">=&#34;$</span><span class="na">post</span><span class="err">[&#39;</span><span class="na">post_count</span><span class="err">&#39;]</span> <span class="err">!=</span> <span class="err">{</span><span class="na">pnid</span><span class="err">}&#34;</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="c">&lt;!-- информация во всех сообщениях, кроме сообщения с номером {pnid} --&gt;</span>
</span></span><span class="line"><span class="cl"><span class="p">&lt;/</span><span class="nt">if</span><span class="p">&gt;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-2061a060918449769f74d5371326fe8d"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<ol start="14">
<li>Показать информацию в определённых сообщениях (<code>1,5,10</code> = номера сообщений).</li>
</ol>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-13
shortcode-codeblock-html">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-75e7307d677411759a3638d1c775a653" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-html" data-lang="html"><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">if</span><span class="err">=&#34;</span><span class="na">in_array</span><span class="err">($</span><span class="na">post</span><span class="err">[&#39;</span><span class="na">post_count</span><span class="err">&#39;],</span> <span class="na">array</span><span class="err">(</span><span class="na">1</span><span class="err">,</span><span class="na">5</span><span class="err">,</span><span class="na">10</span><span class="err">))&#34;</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="c">&lt;!-- отображение информации в сообщениях 1, 5 и 10 --&gt;</span>
</span></span><span class="line"><span class="cl"><span class="p">&lt;/</span><span class="nt">if</span><span class="p">&gt;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-75e7307d677411759a3638d1c775a653"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<ol start="15">
<li>Показать информацию только в определённом сообщении пользователя (<code>{id}</code> = ID пользователя).</li>
</ol>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-14
shortcode-codeblock-html">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-e80439a75db5955c831d9c9fa4fde1a1" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-html" data-lang="html"><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">if</span><span class="err">=&#34;$</span><span class="na">author</span><span class="err">[&#39;</span><span class="na">id</span><span class="err">&#39;]</span> <span class="err">==</span> <span class="err">{</span><span class="na">id</span><span class="err">}&#34;</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="c">&lt;!-- информация только в определённом сообщении пользователя с ID = {id} --&gt;</span>
</span></span><span class="line"><span class="cl"><span class="p">&lt;/</span><span class="nt">if</span><span class="p">&gt;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-e80439a75db5955c831d9c9fa4fde1a1"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<ol start="16">
<li>Пример сложной конструкции с применением <code>&lt;или&gt;</code>.</li>
</ol>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-15
shortcode-codeblock-html">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-dcf2232496eeb1e69665dd0c0e1d9856" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-html" data-lang="html"><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">if</span><span class="err">=&#34;</span><span class="na">ipb</span><span class="err">.</span><span class="na">member</span><span class="err">[&#39;</span><span class="na">id</span><span class="err">&#39;]</span> <span class="p">&gt;</span> 0&#34;&gt;
</span></span><span class="line"><span class="cl">  <span class="c">&lt;!-- информация только для пользователей --&gt;</span>
</span></span><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">else</span> <span class="p">/&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="c">&lt;!-- информация только для гостей --&gt;</span>
</span></span><span class="line"><span class="cl"><span class="p">&lt;/</span><span class="nt">if</span><span class="p">&gt;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-dcf2232496eeb1e69665dd0c0e1d9856"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>]]></turbo:content></item><item turbo="true"><title>Условия в шаблонах IP.Board 3.x</title><link>https://lib.onl/ru/2023/10/a7405294-9f0c-52c1-a70e-ce4990079dc7/</link><pubDate>Mon, 16 Oct 2023 23:07:22 +0000</pubDate><dc:creator>Kai Kimera</dc:creator><category>CMF</category><category>В истории</category><turbo:extendedHtml>true</turbo:extendedHtml><turbo:source>https://lib.onl/ru/2023/10/a7405294-9f0c-52c1-a70e-ce4990079dc7/</turbo:source><turbo:topic>Условия в шаблонах IP.Board 3.x</turbo:topic><turbo:content><![CDATA[<p>Список условий, которые можно использовать в шаблонах <span class="shortcode shortcode-tag"><a href="/ru/tags/ipb/" target="_blank">#IPB</a></span> 3.x. Продолжаю находить и публиковать старые заметки со своих давно закрытых ресурсов.</p>
<h2 id="условия-в-шаблонах">
  <a class="link-body-emphasis" href="#%d1%83%d1%81%d0%bb%d0%be%d0%b2%d0%b8%d1%8f-%d0%b2-%d1%88%d0%b0%d0%b1%d0%bb%d0%be%d0%bd%d0%b0%d1%85">Условия в шаблонах</a>
</h2><ol>
<li>Отображение информации в определённом сообщении.</li>
</ol>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-0
shortcode-codeblock-html">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-dc96d638cf22be1985e67420d70a3e71" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-html" data-lang="html"><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">if</span> <span class="na">test</span><span class="o">=</span><span class="s">&#34;$post[&#39;post&#39;][&#39;post_count&#39;] == X&#34;</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="c">&lt;!-- информация только в сообщении X --&gt;</span>
</span></span><span class="line"><span class="cl"><span class="p">&lt;/</span><span class="nt">if</span><span class="p">&gt;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-dc96d638cf22be1985e67420d70a3e71"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<p>Где:</p>
<ul>
<li><code>X</code> - номер сообщения в теме.</li>
</ul>
<ol start="2">
<li>Отображение информации для определённых групп.</li>
</ol>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-1
shortcode-codeblock-html">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-ba1e9080c06ed8592f4e627c268f54c2" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-html" data-lang="html"><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">if</span> <span class="na">test</span><span class="o">=</span><span class="s">&#34;in_array($this-&gt;memberData[&#39;member_group_id&#39;], array( 4,5,6 ) )&#34;</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="c">&lt;!-- информация только для групп ID = 4, 5 и 6 --&gt;</span>
</span></span><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">else</span> <span class="p">/&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="c">&lt;!-- информация для всех остальных --&gt;</span>
</span></span><span class="line"><span class="cl"><span class="p">&lt;/</span><span class="nt">if</span><span class="p">&gt;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-ba1e9080c06ed8592f4e627c268f54c2"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<ol start="3">
<li>Пример сложной конструкции с применением <code>&lt;или&gt;</code>.</li>
</ol>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-2
shortcode-codeblock-html">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-2fab47eee5fb2b200f9a690cec2c6bde" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-html" data-lang="html"><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">if</span> <span class="na">test</span><span class="o">=</span><span class="s">&#34;memberbox:|:$this-&gt;memberData[&#39;member_id&#39;]&#34;</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="c">&lt;!-- информация только для пользователей --&gt;</span>
</span></span><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">else</span> <span class="p">/&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="c">&lt;!-- информация только для гостей --&gt;</span>
</span></span><span class="line"><span class="cl"><span class="p">&lt;/</span><span class="nt">if</span><span class="p">&gt;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-2fab47eee5fb2b200f9a690cec2c6bde"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>]]></turbo:content></item><item turbo="true"><title>Установка сертификата НУЦ Минцифры</title><link>https://lib.onl/ru/2023/10/75075788-9308-56b7-b531-2008cb35f7d0/</link><pubDate>Fri, 06 Oct 2023 11:42:15 +0000</pubDate><dc:creator>Kai Kimera</dc:creator><category>Linux</category><category>MS Windows</category><category>Безопасность</category><yandex:related><link url="https://lib.onl/ru/2022/05/36058650-3f35-5ed5-9565-0aa7d8800c28/">Windows Server 2022 для рабочей станции</link><link url="https://lib.onl/ru/2021/08/ca744dce-e607-52e6-9952-8ae04e052a5b/">Скрипт автоматического удаления устаревших файлов</link></yandex:related><turbo:extendedHtml>true</turbo:extendedHtml><turbo:source>https://lib.onl/ru/2023/10/75075788-9308-56b7-b531-2008cb35f7d0/</turbo:source><turbo:topic>Установка сертификата НУЦ Минцифры</turbo:topic><turbo:content><![CDATA[<p>Рассказываю о нескольких способах установки сертификатов от НУЦ Минцифры. Установка производится в ОС MS <span class="shortcode shortcode-tag"><a href="/ru/tags/windows/" target="_blank">#Windows</a></span> и <span class="shortcode shortcode-tag"><a href="/ru/tags/linux/" target="_blank">#Linux</a></span>.</p>
<h2 id="ms-windows">
  <a class="link-body-emphasis" href="#ms-windows">MS Windows</a>
</h2><h3 id="установка-корневого-сертификата">
  <a class="link-body-emphasis" href="#%d1%83%d1%81%d1%82%d0%b0%d0%bd%d0%be%d0%b2%d0%ba%d0%b0-%d0%ba%d0%be%d1%80%d0%bd%d0%b5%d0%b2%d0%be%d0%b3%d0%be-%d1%81%d0%b5%d1%80%d1%82%d0%b8%d1%84%d0%b8%d0%ba%d0%b0%d1%82%d0%b0">Установка корневого сертификата</a>
</h3><ul>
<li><a title="" href="https://gu-st.ru/content/Other/doc/russian_trusted_root_ca.cer" target="_blank"
   rel="noopener noreferrer">Скачать</a> корневой сертификат.</li>
<li>Открыть скаченный файл <code>russian_trusted_root_ca.cer</code> и нажать кнопку <span class="shortcode shortcode-key d-inline-block"><kbd>Установить сертификат...</kbd></span>.</li>
<li>В <strong>Мастере импорта сертификатов</strong> выбрать <em>Текущий пользователь</em>.
<ul>
<li>Выбрать <em>Поместить все сертификаты в следующее хранилище</em>.</li>
<li>Нажать <span class="shortcode shortcode-key d-inline-block"><kbd>Обзор</kbd></span> и выбрать <em>Доверенные корневые центры сертификации</em>.</li>
<li>В окне <strong>Завершение мастера импорта сертификатов</strong> нажать <span class="shortcode shortcode-key d-inline-block"><kbd>Готово</kbd></span>.</li>
</ul>
</li>
</ul>
<h3 id="установка-выпускающего-сертификата">
  <a class="link-body-emphasis" href="#%d1%83%d1%81%d1%82%d0%b0%d0%bd%d0%be%d0%b2%d0%ba%d0%b0-%d0%b2%d1%8b%d0%bf%d1%83%d1%81%d0%ba%d0%b0%d1%8e%d1%89%d0%b5%d0%b3%d0%be-%d1%81%d0%b5%d1%80%d1%82%d0%b8%d1%84%d0%b8%d0%ba%d0%b0%d1%82%d0%b0">Установка выпускающего сертификата</a>
</h3><ul>
<li><a title="" href="https://gu-st.ru/content/Other/doc/russian_trusted_sub_ca.cer" target="_blank"
   rel="noopener noreferrer">Скачать</a> выпускающий сертификат.</li>
<li>Открыть скаченный файл <code>russian_trusted_sub_ca.cer</code> и нажать кнопку <span class="shortcode shortcode-key d-inline-block"><kbd>Установить сертификат...</kbd></span>.</li>
<li>В <strong>Мастере импорта сертификатов</strong> выбрать <em>Текущий пользователь</em>.
<ul>
<li>Выбрать <em>Автоматически выбрать хранилище на основе типа сертификата</em>.</li>
<li>В окне <strong>Завершение мастера импорта сертификатов</strong> нажать <span class="shortcode shortcode-key d-inline-block"><kbd>Готово</kbd></span>.</li>
</ul>
</li>
</ul>
<h3 id="powershell">
  <a class="link-body-emphasis" href="#powershell">PowerShell</a>
</h3><p>При помощи <span class="shortcode shortcode-tag"><a href="/ru/tags/powershell/" target="_blank">#PowerShell</a></span> можно установить сертификат одной строчкой, состоящей из нескольких команд:</p>
<ul>
<li><code>Invoke-WebRequest</code> - скачивает файл с внешнего веб-ресурса.</li>
<li><code>Import-Certificate</code> - импортирует сертификат в указанное хранилище.</li>
<li><code>${DIR}</code> - переменная, определяющая директорию <code>Downloads</code> (<code>Загрузки</code>) для текущего пользователя.</li>
</ul>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-0
shortcode-codeblock-powershell">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-650dd73fd5f6158683c0666d87062980" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-powershell" data-lang="powershell"><span class="line"><span class="cl"><span class="p">${</span><span class="n">CERT_ROOT</span><span class="p">}</span> <span class="p">=</span> <span class="s1">&#39;russian_trusted_root_ca.cer&#39;</span><span class="p">;</span> <span class="p">${</span><span class="n">CERT_SUB</span><span class="p">}</span> <span class="p">=</span> <span class="s1">&#39;russian_trusted_sub_ca.cer&#39;</span><span class="p">;</span> <span class="p">${</span><span class="n">DIR</span><span class="p">}</span> <span class="p">=</span> <span class="p">(</span><span class="nb">New-Object</span> <span class="n">-ComObject</span> <span class="n">Shell</span><span class="p">.</span><span class="n">Application</span><span class="p">).</span><span class="py">NameSpace</span><span class="p">(</span><span class="s1">&#39;shell:Downloads&#39;</span><span class="p">).</span><span class="py">Self</span><span class="p">.</span><span class="n">Path</span><span class="p">;</span> <span class="nb">Invoke-WebRequest</span> <span class="s2">&#34;https://gu-st.ru/content/Other/doc/</span><span class="nv">${CERT_ROOT}</span><span class="s2">&#34;</span> <span class="n">-OutFile</span> <span class="s2">&#34;</span><span class="nv">${DIR}</span><span class="s2">\</span><span class="nv">${CERT_ROOT}</span><span class="s2">&#34;</span><span class="p">;</span> <span class="nb">Import-Certificate</span> <span class="n">-FilePath</span> <span class="s2">&#34;</span><span class="nv">${DIR}</span><span class="s2">\</span><span class="nv">${CERT_ROOT}</span><span class="s2">&#34;</span> <span class="n">-CertStoreLocation</span> <span class="s1">&#39;Cert:\CurrentUser\Root&#39;</span><span class="p">;</span> <span class="nb">Invoke-WebRequest</span> <span class="s2">&#34;https://gu-st.ru/content/Other/doc/</span><span class="nv">${CERT_SUB}</span><span class="s2">&#34;</span> <span class="n">-OutFile</span> <span class="s2">&#34;</span><span class="nv">${DIR}</span><span class="s2">\</span><span class="nv">${CERT_SUB}</span><span class="s2">&#34;</span><span class="p">;</span> <span class="nb">Import-Certificate</span> <span class="n">-FilePath</span> <span class="s2">&#34;</span><span class="nv">${DIR}</span><span class="s2">\</span><span class="nv">${CERT_SUB}</span><span class="s2">&#34;</span> <span class="n">-CertStoreLocation</span> <span class="s1">&#39;Cert:\CurrentUser\CA&#39;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-650dd73fd5f6158683c0666d87062980"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<h2 id="linux">
  <a class="link-body-emphasis" href="#linux">Linux</a>
</h2><p>Для <span class="shortcode shortcode-tag"><a href="/ru/tags/linux/" target="_blank">#Linux</a></span> можно воспользоваться пакетом сертификатов в формате <code>.PEM</code> от <span class="shortcode shortcode-tag">MacOS</span>. Положительным моментом подобного пакета является то, что <span class="shortcode shortcode-tag">PEM</span> содержит в себе сразу два сертификата: корневой и выпускающий.</p>
<h3 id="установка-корневого-и-выпускающего-сертификатов">
  <a class="link-body-emphasis" href="#%d1%83%d1%81%d1%82%d0%b0%d0%bd%d0%be%d0%b2%d0%ba%d0%b0-%d0%ba%d0%be%d1%80%d0%bd%d0%b5%d0%b2%d0%be%d0%b3%d0%be-%d0%b8-%d0%b2%d1%8b%d0%bf%d1%83%d1%81%d0%ba%d0%b0%d1%8e%d1%89%d0%b5%d0%b3%d0%be-%d1%81%d0%b5%d1%80%d1%82%d0%b8%d1%84%d0%b8%d0%ba%d0%b0%d1%82%d0%be%d0%b2">Установка корневого и выпускающего сертификатов</a>
</h3><ul>
<li><a title="" href="https://gu-st.ru/content/Other/doc/russiantrustedca.pem" target="_blank"
   rel="noopener noreferrer">Скачать</a> файл с корневым и выпускающим сертификатами.</li>
<li>Добавить скаченный файл <code>russiantrustedca.pem</code> в хранилище доверенных сертификатов в зависимости от дистрибутива <span class="shortcode shortcode-tag"><a href="/ru/tags/linux/" target="_blank">#Linux</a></span>.
<ul>
<li>DEB-based: <code>/usr/local/share/ca-certificates/</code>.</li>
<li>RHEL-based: <code>/etc/pki/ca-trust/source/anchors/</code>.</li>
<li>Arch Linux: <code>/etc/ca-certificates/trust-source/anchors/</code>.</li>
</ul>
</li>
<li>Обновить хранилище сертификатов следующими командами.
<ul>
<li>DEB-based: <code>update-ca-certificates --fresh</code>.</li>
<li>RHEL-based: <code>update-ca-trust force-enable</code> и <code>update-ca-trust extract</code>.</li>
</ul>
</li>
</ul>
<h3 id="bash">
  <a class="link-body-emphasis" href="#bash">Bash</a>
</h3><p>Установить сертификат можно одной командой. Команды вводится от пользователя <code>root</code>. Как выше приводилось, для <span class="shortcode shortcode-tag"><a href="/ru/tags/deb/" target="_blank">#DEB</a></span>-based и <span class="shortcode shortcode-tag"><a href="/ru/tags/rhel/" target="_blank">#RHEL</a></span>-based дистрибутивов, пути хранилища сертификатов различаются. Поэтому, я привожу две команды под каждые версии дистрибутивов.</p>
<h4 id="deb-based-дистрибутивы">
  <a class="link-body-emphasis" href="#deb-based-%d0%b4%d0%b8%d1%81%d1%82%d1%80%d0%b8%d0%b1%d1%83%d1%82%d0%b8%d0%b2%d1%8b">DEB-based дистрибутивы</a>
</h4>








  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-1
shortcode-codeblock-bash">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-9632fcd7a0d3cd04200e5f00f86beea8" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="nv">CERT</span><span class="o">=</span><span class="s1">&#39;russiantrustedca.pem&#39;</span><span class="p">;</span> curl -o <span class="s2">&#34;/usr/local/share/ca-certificates/</span><span class="si">${</span><span class="nv">CERT</span><span class="si">}</span><span class="s2">&#34;</span> <span class="s2">&#34;https://gu-st.ru/content/Other/doc/</span><span class="si">${</span><span class="nv">CERT</span><span class="si">}</span><span class="s2">&#34;</span> <span class="o">&amp;&amp;</span> update-ca-certificates --fresh</span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-9632fcd7a0d3cd04200e5f00f86beea8"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<h4 id="rhel-based-дистрибутивы">
  <a class="link-body-emphasis" href="#rhel-based-%d0%b4%d0%b8%d1%81%d1%82%d1%80%d0%b8%d0%b1%d1%83%d1%82%d0%b8%d0%b2%d1%8b">RHEL-based дистрибутивы</a>
</h4>








  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-2
shortcode-codeblock-bash">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-49abe8c0d5a0a0c234ba21eef4ec9e81" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="nv">CERT</span><span class="o">=</span><span class="s1">&#39;russiantrustedca.pem&#39;</span><span class="p">;</span> curl -o <span class="s2">&#34;/etc/pki/ca-trust/source/anchors/</span><span class="si">${</span><span class="nv">CERT</span><span class="si">}</span><span class="s2">&#34;</span> <span class="s2">&#34;https://gu-st.ru/content/Other/doc/</span><span class="si">${</span><span class="nv">CERT</span><span class="si">}</span><span class="s2">&#34;</span> <span class="o">&amp;&amp;</span> update-ca-trust force-enable <span class="o">&amp;&amp;</span> update-ca-trust extract</span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-49abe8c0d5a0a0c234ba21eef4ec9e81"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>]]></turbo:content></item><item turbo="true"><title>Получение и установка MS Office 2021 LTSC</title><link>https://lib.onl/ru/2023/09/dd5a3e1a-596b-50d5-b070-b2a065f99f32/</link><pubDate>Tue, 26 Sep 2023 17:17:18 +0000</pubDate><dc:creator>Kai Kimera</dc:creator><category>MS Windows</category><category>Скрипты</category><yandex:related><link url="https://lib.onl/ru/2022/05/862226e6-cbb1-58f8-bc8e-0cfef747f475/">Интеграция обновлений в дистрибутив ОС MS Windows</link></yandex:related><turbo:extendedHtml>true</turbo:extendedHtml><turbo:source>https://lib.onl/ru/2023/09/dd5a3e1a-596b-50d5-b070-b2a065f99f32/</turbo:source><turbo:topic>Получение и установка MS Office 2021 LTSC</turbo:topic><turbo:content><![CDATA[<p>MS Office является самым популярным набором приложений для офисной работы. На момент написания этой статьи, актуальной версией MS <span class="shortcode shortcode-tag"><a href="/ru/tags/office/" target="_blank">#Office</a></span> является 2021. Её можно купить в магазине. Но здесь я расскажу как получить актуальную версию MS <span class="shortcode shortcode-tag"><a href="/ru/tags/office/" target="_blank">#Office</a></span> 2021 LTSC с серверов Microsoft.</p>
<p>MS <span class="shortcode shortcode-tag"><a href="/ru/tags/office/" target="_blank">#Office</a></span> 2021 LTSC просто так не купить, это программное обеспечение распространяется для организаций по соглашению о корпоративном лицензировании. MS Office 2021 LTSC поддерживает устройства только с операционными системами MS <span class="shortcode shortcode-tag"><a href="/ru/tags/windows/" target="_blank">#Windows</a></span> 10 или MS <span class="shortcode shortcode-tag"><a href="/ru/tags/windows/" target="_blank">#Windows</a></span> 11.</p>
<h2 id="получение-ms-office-2021-ltsc">
  <a class="link-body-emphasis" href="#%d0%bf%d0%be%d0%bb%d1%83%d1%87%d0%b5%d0%bd%d0%b8%d0%b5-ms-office-2021-ltsc">Получение MS Office 2021 LTSC</a>
</h2><p>Для получения установочного дистрибутива необходимо выполнить подготовительные шаги:</p>
<ol>
<li>Скачать и запустить <a title="" href="https://www.microsoft.com/download/details.aspx?id=49117" target="_blank"
   rel="noopener noreferrer">Office Deployment Tool</a>.</li>
<li>Во время установки, выбрать директорию для распаковки <strong>Office Deployment Tool</strong>. В эту директорию будет в дальнейшем загружен установочный дистрибутив MS Office 2021 LTSC.</li>
<li>После завершения процесса установки, открыть консоль и перейти в директорию (<code>cd &lt;path&gt;</code>), куда был установлен Office Deployment Tool.</li>
<li>В корне директории Office Deployment Tool создать файл <code>office.2021.xml</code> следующего содержания:</li>
</ol>

    

    
        
            
            <div class="shortcode shortcode-file mb-3">
              <div class="card overflow-hidden" data-bs-theme="dark">
                <div class="card-header">
                  <div class="d-flex align-items-center">
                    <div class="flex-shrink-0">
                      <i class="far fa-file-code fa-fw"></i>
                    </div>
                    <div class="flex-grow-1 mx-2 text-truncate">
                      <code>office.2021.xml</code>
                    </div>
                    <div class="flex-shrink-0">
                      <ul class="list-inline mb-0">
                        <li class="list-inline-item" title='Копировать'>
                          <a class="text-body" href="#"
                             data-fn="clipboard" data-clipboard-target="#cp-b219a6e2f1697ca5e02767c5e4340b64"
                             role="button" aria-label='Копировать'>
                            <i class="fas fa-copy fa-fw"></i>
                          </a>
                        </li>
                        <li class="list-inline-item" title='Скачать'>
                          <a class="text-body" href="/ru/2023/09/dd5a3e1a-596b-50d5-b070-b2a065f99f32/office.2021.xml" download
                             role="button" aria-label='Скачать'>
                            <i class="fas fa-download fa-fw"></i>
                          </a>
                        </li>
                        <li class="list-inline-item" title='Открыть'>
                          <a class="text-body" href="/ru/2023/09/dd5a3e1a-596b-50d5-b070-b2a065f99f32/office.2021.xml" target="_blank"
                             role="button" aria-label='Открыть'>
                            <i class="fas fa-arrow-up-right-from-square fa-fw"></i>
                          </a>
                        </li>
                      </ul>
                    </div>
                  </div>
                </div>
                <div class="card-body p-0 overflow-auto" id="cp-b219a6e2f1697ca5e02767c5e4340b64">
                    
                        
                    
                    <div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-xml" data-lang="xml"><span class="line"><span class="cl"><span class="nt">&lt;Configuration</span> <span class="na">ID=</span><span class="s">&#34;42865718-c416-4c72-990b-20b6972cb9af&#34;</span><span class="nt">&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="nt">&lt;Add</span> <span class="na">OfficeClientEdition=</span><span class="s">&#34;64&#34;</span> <span class="na">Channel=</span><span class="s">&#34;PerpetualVL2021&#34;</span><span class="nt">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;Product</span> <span class="na">ID=</span><span class="s">&#34;ProPlus2021Volume&#34;</span> <span class="na">PIDKEY=</span><span class="s">&#34;FXYTK-NJJ8C-GB6DW-3DYQT-6F7TH&#34;</span><span class="nt">&gt;</span>
</span></span><span class="line"><span class="cl">      <span class="nt">&lt;Language</span> <span class="na">ID=</span><span class="s">&#34;en-us&#34;</span> <span class="nt">/&gt;</span>
</span></span><span class="line"><span class="cl">      <span class="nt">&lt;Language</span> <span class="na">ID=</span><span class="s">&#34;ru-ru&#34;</span> <span class="nt">/&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;/Product&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;Product</span> <span class="na">ID=</span><span class="s">&#34;VisioPro2021Volume&#34;</span> <span class="na">PIDKEY=</span><span class="s">&#34;KNH8D-FGHT4-T8RK3-CTDYJ-K2HT4&#34;</span><span class="nt">&gt;</span>
</span></span><span class="line"><span class="cl">      <span class="nt">&lt;Language</span> <span class="na">ID=</span><span class="s">&#34;en-us&#34;</span> <span class="nt">/&gt;</span>
</span></span><span class="line"><span class="cl">      <span class="nt">&lt;Language</span> <span class="na">ID=</span><span class="s">&#34;ru-ru&#34;</span> <span class="nt">/&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;/Product&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;Product</span> <span class="na">ID=</span><span class="s">&#34;ProjectPro2021Volume&#34;</span> <span class="na">PIDKEY=</span><span class="s">&#34;FTNWT-C6WBT-8HMGF-K9PRX-QV9H8&#34;</span><span class="nt">&gt;</span>
</span></span><span class="line"><span class="cl">      <span class="nt">&lt;Language</span> <span class="na">ID=</span><span class="s">&#34;en-us&#34;</span> <span class="nt">/&gt;</span>
</span></span><span class="line"><span class="cl">      <span class="nt">&lt;Language</span> <span class="na">ID=</span><span class="s">&#34;ru-ru&#34;</span> <span class="nt">/&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;/Product&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;Product</span> <span class="na">ID=</span><span class="s">&#34;LanguagePack&#34;</span><span class="nt">&gt;</span>
</span></span><span class="line"><span class="cl">      <span class="nt">&lt;Language</span> <span class="na">ID=</span><span class="s">&#34;en-us&#34;</span> <span class="nt">/&gt;</span>
</span></span><span class="line"><span class="cl">      <span class="nt">&lt;Language</span> <span class="na">ID=</span><span class="s">&#34;ru-ru&#34;</span> <span class="nt">/&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;/Product&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;Product</span> <span class="na">ID=</span><span class="s">&#34;ProofingTools&#34;</span><span class="nt">&gt;</span>
</span></span><span class="line"><span class="cl">      <span class="nt">&lt;Language</span> <span class="na">ID=</span><span class="s">&#34;en-us&#34;</span> <span class="nt">/&gt;</span>
</span></span><span class="line"><span class="cl">      <span class="nt">&lt;Language</span> <span class="na">ID=</span><span class="s">&#34;ru-ru&#34;</span> <span class="nt">/&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;/Product&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="nt">&lt;/Add&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="nt">&lt;Property</span> <span class="na">Name=</span><span class="s">&#34;SharedComputerLicensing&#34;</span> <span class="na">Value=</span><span class="s">&#34;0&#34;</span> <span class="nt">/&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="nt">&lt;Property</span> <span class="na">Name=</span><span class="s">&#34;FORCEAPPSHUTDOWN&#34;</span> <span class="na">Value=</span><span class="s">&#34;FALSE&#34;</span> <span class="nt">/&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="nt">&lt;Property</span> <span class="na">Name=</span><span class="s">&#34;DeviceBasedLicensing&#34;</span> <span class="na">Value=</span><span class="s">&#34;0&#34;</span> <span class="nt">/&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="nt">&lt;Property</span> <span class="na">Name=</span><span class="s">&#34;SCLCacheOverride&#34;</span> <span class="na">Value=</span><span class="s">&#34;0&#34;</span> <span class="nt">/&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="nt">&lt;Property</span> <span class="na">Name=</span><span class="s">&#34;AUTOACTIVATE&#34;</span> <span class="na">Value=</span><span class="s">&#34;1&#34;</span> <span class="nt">/&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="nt">&lt;Updates</span> <span class="na">Enabled=</span><span class="s">&#34;TRUE&#34;</span> <span class="nt">/&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="nt">&lt;RemoveMSI</span> <span class="nt">/&gt;</span>
</span></span><span class="line"><span class="cl"><span class="nt">&lt;/Configuration&gt;</span></span></span></code></pre></td></tr></table>
</div>
</div>
                </div>
              </div>
            </div>
        
    
<p>Далее, в консоли выполните команду <code>setup.exe /download office.2021.xml</code>. Команда запускает формирование и скачивание установочного дистрибутива MS Office 2021 LTCS с серверов Microsoft. Команда может не отображать процесс своей работы. После завершения команды, консоль вернёт управление пользователю, тем самым можно контролировать завершение получения установочного дистрибутива.</p>
<h2 id="установка-полной-версии-ms-office-2021-ltsc">
  <a class="link-body-emphasis" href="#%d1%83%d1%81%d1%82%d0%b0%d0%bd%d0%be%d0%b2%d0%ba%d0%b0-%d0%bf%d0%be%d0%bb%d0%bd%d0%be%d0%b9-%d0%b2%d0%b5%d1%80%d1%81%d0%b8%d0%b8-ms-office-2021-ltsc">Установка полной версии MS Office 2021 LTSC</a>
</h2><p>После получения установочного дистрибутива MS Office 2021 LTCS, в той же консоли необходимо выполнить команду <code>setup.exe /configure office.2021.xml</code>. Эта команда запускает процесс установки <strong>полной версии</strong> MS Office 2021 LTCS на компьютер пользователя со всеми дополнительными модулями.</p>
<h2 id="установка-минимальной-версии-ms-office-2021-ltsc">
  <a class="link-body-emphasis" href="#%d1%83%d1%81%d1%82%d0%b0%d0%bd%d0%be%d0%b2%d0%ba%d0%b0-%d0%bc%d0%b8%d0%bd%d0%b8%d0%bc%d0%b0%d0%bb%d1%8c%d0%bd%d0%be%d0%b9-%d0%b2%d0%b5%d1%80%d1%81%d0%b8%d0%b8-ms-office-2021-ltsc">Установка минимальной версии MS Office 2021 LTSC</a>
</h2><p>Для администраторов, которые хотят установить на компьютер пользователя только самые необходимые компоненты (<span class="shortcode shortcode-tag">Access</span>, <span class="shortcode shortcode-tag">Excel</span>, <span class="shortcode shortcode-tag">Outlook</span>, <span class="shortcode shortcode-tag">PowerPoint</span> и <span class="shortcode shortcode-tag">World</span>), предлагаю следующий конфигурационный файл:</p>

    

    
        
            
            <div class="shortcode shortcode-file mb-3">
              <div class="card overflow-hidden" data-bs-theme="dark">
                <div class="card-header">
                  <div class="d-flex align-items-center">
                    <div class="flex-shrink-0">
                      <i class="far fa-file-code fa-fw"></i>
                    </div>
                    <div class="flex-grow-1 mx-2 text-truncate">
                      <code>office.2021.minimal.xml</code>
                    </div>
                    <div class="flex-shrink-0">
                      <ul class="list-inline mb-0">
                        <li class="list-inline-item" title='Копировать'>
                          <a class="text-body" href="#"
                             data-fn="clipboard" data-clipboard-target="#cp-06de7b2096a05dff209d5e68b2ac2fb8"
                             role="button" aria-label='Копировать'>
                            <i class="fas fa-copy fa-fw"></i>
                          </a>
                        </li>
                        <li class="list-inline-item" title='Скачать'>
                          <a class="text-body" href="/ru/2023/09/dd5a3e1a-596b-50d5-b070-b2a065f99f32/office.2021.minimal.xml" download
                             role="button" aria-label='Скачать'>
                            <i class="fas fa-download fa-fw"></i>
                          </a>
                        </li>
                        <li class="list-inline-item" title='Открыть'>
                          <a class="text-body" href="/ru/2023/09/dd5a3e1a-596b-50d5-b070-b2a065f99f32/office.2021.minimal.xml" target="_blank"
                             role="button" aria-label='Открыть'>
                            <i class="fas fa-arrow-up-right-from-square fa-fw"></i>
                          </a>
                        </li>
                      </ul>
                    </div>
                  </div>
                </div>
                <div class="card-body p-0 overflow-auto" id="cp-06de7b2096a05dff209d5e68b2ac2fb8">
                    
                        
                    
                    <div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-xml" data-lang="xml"><span class="line"><span class="cl"><span class="nt">&lt;Configuration</span> <span class="na">ID=</span><span class="s">&#34;42865718-c416-4c72-990b-20b6972cb9af&#34;</span><span class="nt">&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="nt">&lt;Add</span> <span class="na">OfficeClientEdition=</span><span class="s">&#34;64&#34;</span> <span class="na">Channel=</span><span class="s">&#34;PerpetualVL2021&#34;</span><span class="nt">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;Product</span> <span class="na">ID=</span><span class="s">&#34;ProPlus2021Volume&#34;</span> <span class="na">PIDKEY=</span><span class="s">&#34;FXYTK-NJJ8C-GB6DW-3DYQT-6F7TH&#34;</span><span class="nt">&gt;</span>
</span></span><span class="line"><span class="cl">      <span class="nt">&lt;Language</span> <span class="na">ID=</span><span class="s">&#34;en-us&#34;</span> <span class="nt">/&gt;</span>
</span></span><span class="line"><span class="cl">      <span class="nt">&lt;Language</span> <span class="na">ID=</span><span class="s">&#34;ru-ru&#34;</span> <span class="nt">/&gt;</span>
</span></span><span class="line"><span class="cl">      <span class="nt">&lt;ExcludeApp</span> <span class="na">ID=</span><span class="s">&#34;Lync&#34;</span> <span class="nt">/&gt;</span>
</span></span><span class="line"><span class="cl">      <span class="nt">&lt;ExcludeApp</span> <span class="na">ID=</span><span class="s">&#34;OneDrive&#34;</span> <span class="nt">/&gt;</span>
</span></span><span class="line"><span class="cl">      <span class="nt">&lt;ExcludeApp</span> <span class="na">ID=</span><span class="s">&#34;OneNote&#34;</span> <span class="nt">/&gt;</span>
</span></span><span class="line"><span class="cl">      <span class="nt">&lt;ExcludeApp</span> <span class="na">ID=</span><span class="s">&#34;Publisher&#34;</span> <span class="nt">/&gt;</span>
</span></span><span class="line"><span class="cl">      <span class="nt">&lt;ExcludeApp</span> <span class="na">ID=</span><span class="s">&#34;Teams&#34;</span> <span class="nt">/&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;/Product&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;Product</span> <span class="na">ID=</span><span class="s">&#34;LanguagePack&#34;</span><span class="nt">&gt;</span>
</span></span><span class="line"><span class="cl">      <span class="nt">&lt;Language</span> <span class="na">ID=</span><span class="s">&#34;en-us&#34;</span> <span class="nt">/&gt;</span>
</span></span><span class="line"><span class="cl">      <span class="nt">&lt;Language</span> <span class="na">ID=</span><span class="s">&#34;ru-ru&#34;</span> <span class="nt">/&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;/Product&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;Product</span> <span class="na">ID=</span><span class="s">&#34;ProofingTools&#34;</span><span class="nt">&gt;</span>
</span></span><span class="line"><span class="cl">      <span class="nt">&lt;Language</span> <span class="na">ID=</span><span class="s">&#34;en-us&#34;</span> <span class="nt">/&gt;</span>
</span></span><span class="line"><span class="cl">      <span class="nt">&lt;Language</span> <span class="na">ID=</span><span class="s">&#34;ru-ru&#34;</span> <span class="nt">/&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;/Product&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="nt">&lt;/Add&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="nt">&lt;Property</span> <span class="na">Name=</span><span class="s">&#34;SharedComputerLicensing&#34;</span> <span class="na">Value=</span><span class="s">&#34;0&#34;</span> <span class="nt">/&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="nt">&lt;Property</span> <span class="na">Name=</span><span class="s">&#34;FORCEAPPSHUTDOWN&#34;</span> <span class="na">Value=</span><span class="s">&#34;FALSE&#34;</span> <span class="nt">/&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="nt">&lt;Property</span> <span class="na">Name=</span><span class="s">&#34;DeviceBasedLicensing&#34;</span> <span class="na">Value=</span><span class="s">&#34;0&#34;</span> <span class="nt">/&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="nt">&lt;Property</span> <span class="na">Name=</span><span class="s">&#34;SCLCacheOverride&#34;</span> <span class="na">Value=</span><span class="s">&#34;0&#34;</span> <span class="nt">/&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="nt">&lt;Property</span> <span class="na">Name=</span><span class="s">&#34;AUTOACTIVATE&#34;</span> <span class="na">Value=</span><span class="s">&#34;1&#34;</span> <span class="nt">/&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="nt">&lt;Updates</span> <span class="na">Enabled=</span><span class="s">&#34;TRUE&#34;</span> <span class="nt">/&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="nt">&lt;RemoveMSI</span> <span class="nt">/&gt;</span>
</span></span><span class="line"><span class="cl"><span class="nt">&lt;/Configuration&gt;</span></span></span></code></pre></td></tr></table>
</div>
</div>
                </div>
              </div>
            </div>
        
    
<p>Сохраните его под названием <code>office.2021.minimal.xml</code> и запустите процесс установки при помощи команды <code>setup.exe /configure office.2021.minimal.xml</code>.</p>
<h2 id="создание-собственных-конфигураций">
  <a class="link-body-emphasis" href="#%d1%81%d0%be%d0%b7%d0%b4%d0%b0%d0%bd%d0%b8%d0%b5-%d1%81%d0%be%d0%b1%d1%81%d1%82%d0%b2%d0%b5%d0%bd%d0%bd%d1%8b%d1%85-%d0%ba%d0%be%d0%bd%d1%84%d0%b8%d0%b3%d1%83%d1%80%d0%b0%d1%86%d0%b8%d0%b9">Создание собственных конфигураций</a>
</h2><p>Приведённые выше XML-файлы это файлы конфигураций. Их можно создавать самому при помощи веб-инструмента <a title="" href="https://config.office.com/deploymentsettings" target="_blank"
   rel="noopener noreferrer">Office Deployment Center</a>. На странице создания конфигураций укажите необходимые параметры и настройки, и нажмите кнопку <span class="shortcode shortcode-key d-inline-block"><kbd>Импорт</kbd></span>.</p>
<p>Полученный XML-файл можно указывать в командах <code>setup.exe /download &lt;XML_FILE&gt;</code> и <code>setup.exe /configure &lt;XML_FILE&gt;</code> для конфигурирования установочного дистрибутива.</p>
<h2 id="активация-при-помощи-kms-сервера">
  <a class="link-body-emphasis" href="#%d0%b0%d0%ba%d1%82%d0%b8%d0%b2%d0%b0%d1%86%d0%b8%d1%8f-%d0%bf%d1%80%d0%b8-%d0%bf%d0%be%d0%bc%d0%be%d1%89%d0%b8-kms-%d1%81%d0%b5%d1%80%d0%b2%d0%b5%d1%80%d0%b0">Активация при помощи KMS-сервера</a>
</h2><p>Если в сети вашей организации присутствует KMS-сервер, установленный MS Office 2021 можно активировать при помощи этого сервера.</p>




    










    
    




<div class="shortcode shortcode-alert">
  <div class="alert alert-success d-flex overflow-hidden" role="alert">
    <div class="flex-shrink-0 align-self-center">
      <i class="fas fa-lightbulb fa-fw fa-2x"></i>
    </div>
    <div class="flex-grow-1 ms-3 overflow-hidden">
        <p>Подобным способом активируются следующие версии MS Office:</p>
<ul>
<li>Microsoft Office 2016 Volume License Pack.</li>
<li>Microsoft Office 2019 Volume License Pack.</li>
<li>Microsoft Office LTSC 2021 Volume License Pack.</li>
</ul>

    </div>
  </div>
</div>

<p>Для активации MS Office при помощи KMS-сервера, необходимо открыть консоль и перейти в директорию с файлом <code>ospp.vbs</code>. Обычно, этот файл находится в директории <code>\Program Files\Microsoft Office\Office16</code>. После того, как консоль будет находится в необходимой директории с файлом <code>ospp.vbs</code>, можно выполнять следующие команды в зависимости от задачи.</p>
<ol>
<li>Указать адрес KMS-сервера для клиента MS Office:</li>
</ol>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-0
shortcode-codeblock-powershell">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-de83d13ad50e594e7fb41b57f35a16ca" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-powershell" data-lang="powershell"><span class="line"><span class="cl"><span class="n">cscript</span> <span class="n">ospp</span><span class="p">.</span><span class="py">vbs</span> <span class="p">/</span><span class="n">sethst</span><span class="err">:</span><span class="n">kms</span><span class="p">.</span><span class="py">example</span><span class="p">.</span><span class="n">com</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-de83d13ad50e594e7fb41b57f35a16ca"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<ol start="2">
<li>Указать нестандартный порт (<code>1689</code>) KMS-сервера:</li>
</ol>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-1
shortcode-codeblock-powershell">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-ff7ce82bb75a51709507ef49e4b9b7e8" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-powershell" data-lang="powershell"><span class="line"><span class="cl"><span class="n">cscript</span> <span class="n">ospp</span><span class="p">.</span><span class="py">vbs</span> <span class="p">/</span><span class="n">setprt</span><span class="err">:</span><span class="mf">1689</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-ff7ce82bb75a51709507ef49e4b9b7e8"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<ol start="3">
<li>Выполнить активацию MS Office на KMS-сервере:</li>
</ol>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-2
shortcode-codeblock-powershell">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-42429f816e05ee6fff2e74cad7b0e504" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-powershell" data-lang="powershell"><span class="line"><span class="cl"><span class="n">cscript</span> <span class="n">ospp</span><span class="p">.</span><span class="py">vbs</span> <span class="p">/</span><span class="n">act</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-42429f816e05ee6fff2e74cad7b0e504"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<ol start="4">
<li>Узнать текущий статус активации MS Office:</li>
</ol>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-3
shortcode-codeblock-powershell">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-a916f79a219a6b5ae867df268021c99a" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-powershell" data-lang="powershell"><span class="line"><span class="cl"><span class="n">cscript</span> <span class="n">ospp</span><span class="p">.</span><span class="py">vbs</span> <span class="p">/</span><span class="n">dstatusall</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-a916f79a219a6b5ae867df268021c99a"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<p>В интернете можно найти открытые KMS-серверы для нелегальной активации MS Office. Но подобные действия имеют противоправный характер. <span class="shortcode shortcode-emoji">😜</span></p>]]></turbo:content></item><item turbo="true"><title>Включение DNS over TLS (DoT) в OPNsense</title><link>https://lib.onl/ru/2022/08/badb30a9-0471-5dab-a422-85422c0ac611/</link><pubDate>Sun, 14 Aug 2022 18:16:34 +0000</pubDate><dc:creator>Kai Kimera</dc:creator><category>Сеть</category><yandex:related><link url="https://lib.onl/ru/2021/05/ee559a6c-5cde-5166-9d2d-3ceb55878eb8/">Debian: Статический IP-адрес</link></yandex:related><turbo:extendedHtml>true</turbo:extendedHtml><turbo:source>https://lib.onl/ru/2022/08/badb30a9-0471-5dab-a422-85422c0ac611/</turbo:source><turbo:topic>Включение DNS over TLS (DoT) в OPNsense</turbo:topic><turbo:content><![CDATA[<p>Почитав несколько статей на тему <span class="shortcode shortcode-tag"><a href="/ru/tags/dot/" target="_blank">#DoT</a></span>, я решил написать небольшую заметку по настройки <span class="shortcode shortcode-tag"><a href="/ru/tags/opnsense/" target="_blank">#OPNsense</a></span> на использование этого протокола.</p>
<p><strong>DNS поверх TLS</strong> или <span class="shortcode shortcode-tag"><a href="/ru/tags/dot/" target="_blank">#DoT</a></span> это протокол, при помощи которого происходит шифрование запросов и ответов к <span class="shortcode shortcode-tag"><a href="/ru/tags/dns/" target="_blank">#DNS</a></span> через <span class="shortcode shortcode-tag"><a href="/ru/tags/tls/" target="_blank">#TLS</a></span>. Таким образом, повышается конфиденциальность и безопасность пользователей в интернете.</p>
<p>Не все публичные сервера поддерживают <span class="shortcode shortcode-tag"><a href="/ru/tags/dot/" target="_blank">#DoT</a></span>. Список наиболее предпочтительных, по моему мнению, я приведу в таблице в конце статьи. А теперь, по пунктам, я расскажу как правильно настроить <span class="shortcode shortcode-tag"><a href="/ru/tags/opnsense/" target="_blank">#OPNsense</a></span>, чтобы она задействовала протокол <span class="shortcode shortcode-tag"><a href="/ru/tags/dot/" target="_blank">#DoT</a></span> в своей работе. Для этого нужно выполнить всего несколько шагов&hellip;</p>
<h2 id="настройка-opnsense">
  <a class="link-body-emphasis" href="#%d0%bd%d0%b0%d1%81%d1%82%d1%80%d0%be%d0%b9%d0%ba%d0%b0-opnsense">Настройка OPNsense</a>
</h2><ul>
<li>System / Settings / General
<ul>
<li>Удалить все записи о DNS, если они имеются.</li>
<li>Отключить параметр <strong>Allow DNS server list to be overridden by DHCP/PPP on WAN</strong>.</li>
<li>Отключить параметр <strong>Do not use the local DNS service as a nameserver for this system</strong>.</li>
</ul>
</li>
<li>Services / Unbound DNS / General
<ul>
<li>Включить сервис, поставив галочку напротив <strong>Enable</strong>.</li>
<li>Выбрать в параметре <strong>Network Interfaces</strong> пункт локальной сети, в данном случае, <em>LAN</em>.</li>
<li>Включить <strong>DNSSEC</strong>, поставив галочку напротив парамера <strong>Enable DNSSEC Support</strong>.</li>
<li>Остальные параметры можно не трогать.</li>
</ul>
</li>
<li>Services / Unbound DNS / DNS over TLS
<ul>
<li>Добавить публичные сервера DNS из списка ниже.</li>
</ul>
</li>
</ul>
<h2 id="публичные-сервера-dns">
  <a class="link-body-emphasis" href="#%d0%bf%d1%83%d0%b1%d0%bb%d0%b8%d1%87%d0%bd%d1%8b%d0%b5-%d1%81%d0%b5%d1%80%d0%b2%d0%b5%d1%80%d0%b0-dns">Публичные сервера DNS</a>
</h2><p>Ниже я привожу список публичных серверов <span class="shortcode shortcode-tag"><a href="/ru/tags/dns/" target="_blank">#DNS</a></span>, которые поддерживают функцию DNS over TLS (<span class="shortcode shortcode-tag"><a href="/ru/tags/dot/" target="_blank">#DoT</a></span>).</p>
<h3 id="cloudflare">
  <a class="link-body-emphasis" href="#cloudflare">Cloudflare</a>
</h3>




<table class='table table-striped table-bordered table-responsive w-50'>
  <thead>
      <tr>
          <th>Server IP</th>
          <th>Server Port</th>
          <th>Verify CN</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>1.1.1.1</td>
          <td>853</td>
          <td>cloudflare-dns.com</td>
      </tr>
      <tr>
          <td>1.0.0.1</td>
          <td>853</td>
          <td>cloudflare-dns.com</td>
      </tr>
      <tr>
          <td>2606:4700:4700::1111</td>
          <td>853</td>
          <td>cloudflare-dns.com</td>
      </tr>
      <tr>
          <td>2606:4700:4700::1001</td>
          <td>853</td>
          <td>cloudflare-dns.com</td>
      </tr>
  </tbody>
</table>


<h3 id="google">
  <a class="link-body-emphasis" href="#google">Google</a>
</h3>




<table class='table table-striped table-bordered table-responsive w-50'>
  <thead>
      <tr>
          <th>Server IP</th>
          <th>Server Port</th>
          <th>Verify CN</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>8.8.8.8</td>
          <td>853</td>
          <td>dns.google</td>
      </tr>
      <tr>
          <td>8.8.4.4</td>
          <td>853</td>
          <td>dns.google</td>
      </tr>
      <tr>
          <td>2001:4860:4860::8888</td>
          <td>853</td>
          <td>dns.google</td>
      </tr>
      <tr>
          <td>2001:4860:4860::8844</td>
          <td>853</td>
          <td>dns.google</td>
      </tr>
  </tbody>
</table>


<h3 id="quad9">
  <a class="link-body-emphasis" href="#quad9">Quad9</a>
</h3>




<table class='table table-striped table-bordered table-responsive w-50'>
  <thead>
      <tr>
          <th>Server IP</th>
          <th>Server Port</th>
          <th>Verify CN</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>9.9.9.9</td>
          <td>853</td>
          <td>dns.quad9.net</td>
      </tr>
      <tr>
          <td>149.112.112.112</td>
          <td>853</td>
          <td>dns.quad9.net</td>
      </tr>
      <tr>
          <td>2620:fe::fe</td>
          <td>853</td>
          <td>dns.quad9.net</td>
      </tr>
      <tr>
          <td>2620:fe::9</td>
          <td>853</td>
          <td>dns.quad9.net</td>
      </tr>
  </tbody>
</table>


<h3 id="cisco-umbrella">
  <a class="link-body-emphasis" href="#cisco-umbrella">Cisco Umbrella</a>
</h3>




<table class='table table-striped table-bordered table-responsive w-50'>
  <thead>
      <tr>
          <th>Server IP</th>
          <th>Server Port</th>
          <th>Verify CN</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>208.67.222.222</td>
          <td>853</td>
          <td>dns.opendns.com</td>
      </tr>
      <tr>
          <td>208.67.220.220</td>
          <td>853</td>
          <td>dns.opendns.com</td>
      </tr>
      <tr>
          <td>2620:119:35::35</td>
          <td>853</td>
          <td>dns.opendns.com</td>
      </tr>
      <tr>
          <td>2620:119:53::53</td>
          <td>853</td>
          <td>dns.opendns.com</td>
      </tr>
  </tbody>
</table>


<h3 id="cleanbrowsing">
  <a class="link-body-emphasis" href="#cleanbrowsing">CleanBrowsing</a>
</h3>




<table class='table table-striped table-bordered table-responsive w-50'>
  <thead>
      <tr>
          <th>Server IP</th>
          <th>Server Port</th>
          <th>Verify CN</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>185.228.168.9</td>
          <td>853</td>
          <td>security-filter-dns.cleanbrowsing.org</td>
      </tr>
      <tr>
          <td>185.228.169.9</td>
          <td>853</td>
          <td>security-filter-dns.cleanbrowsing.org</td>
      </tr>
      <tr>
          <td>2a0d:2a00:1::2</td>
          <td>853</td>
          <td>security-filter-dns.cleanbrowsing.org</td>
      </tr>
      <tr>
          <td>2a0d:2a00:2::2</td>
          <td>853</td>
          <td>security-filter-dns.cleanbrowsing.org</td>
      </tr>
  </tbody>
</table>


<h3 id="adguard-dns">
  <a class="link-body-emphasis" href="#adguard-dns">AdGuard DNS</a>
</h3>




<table class='table table-striped table-bordered table-responsive w-50'>
  <thead>
      <tr>
          <th>Server IP</th>
          <th>Server Port</th>
          <th>Verify CN</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>94.140.14.14</td>
          <td>853</td>
          <td>dns.adguard-dns.com</td>
      </tr>
      <tr>
          <td>94.140.15.15</td>
          <td>853</td>
          <td>dns.adguard-dns.com</td>
      </tr>
      <tr>
          <td>2a10:50c0::ad1:ff</td>
          <td>853</td>
          <td>dns.adguard-dns.com</td>
      </tr>
      <tr>
          <td>2a10:50c0::ad2:ff</td>
          <td>853</td>
          <td>dns.adguard-dns.com</td>
      </tr>
  </tbody>
</table>]]></turbo:content></item><item turbo="true"><title>Интеграция обновлений в дистрибутив ОС MS Windows</title><link>https://lib.onl/ru/2022/05/862226e6-cbb1-58f8-bc8e-0cfef747f475/</link><pubDate>Mon, 09 May 2022 12:39:47 +0000</pubDate><dc:creator>Kai Kimera</dc:creator><category>MS Windows</category><category>Терминал</category><category>Скрипты</category><turbo:extendedHtml>true</turbo:extendedHtml><turbo:source>https://lib.onl/ru/2022/05/862226e6-cbb1-58f8-bc8e-0cfef747f475/</turbo:source><turbo:topic>Интеграция обновлений в дистрибутив ОС MS Windows</turbo:topic><turbo:content><![CDATA[<p>Microsoft каждый месяц выпускает новые версии дистрибутивов с уже интегрированными обновлениями. Но есть редакции ОС, например <span class="shortcode shortcode-tag">LTSC</span>, для которых Microsoft не выполняет подобные действия. Приходится делать самому&hellip;</p>
<h2 id="подготовка">
  <a class="link-body-emphasis" href="#%d0%bf%d0%be%d0%b4%d0%b3%d0%be%d1%82%d0%be%d0%b2%d0%ba%d0%b0">Подготовка</a>
</h2><p>Для интеграции обновлений в дистрибутив ОС, потребуется:</p>
<ul>
<li>Дистрибутив операционной системы в файле <code>.iso</code>.</li>
<li>Доступ в интернет для скачивания необходимых инструментов и обновлений.</li>
<li>Рекомендуется <span class="shortcode shortcode-tag"><a href="/ru/tags/ssd/" target="_blank">#SSD</a></span>. Все ниже приведённые этапы требуют активной работы с файлами. Поэтому, существенное ускорение можно получить выполняя все задачи на <span class="shortcode shortcode-tag"><a href="/ru/tags/ssd/" target="_blank">#SSD</a></span>.</li>
</ul>
<h3 id="структура-директорий">
  <a class="link-body-emphasis" href="#%d1%81%d1%82%d1%80%d1%83%d0%ba%d1%82%d1%83%d1%80%d0%b0-%d0%b4%d0%b8%d1%80%d0%b5%d0%ba%d1%82%d0%be%d1%80%d0%b8%d0%b9">Структура директорий</a>
</h3><p>Для начала необходимо создать структуру директорий, которая послужит базисом для процесса интеграции обновлений:</p>
<ul>
<li><code>C:\BuildFarm</code> - корневая директория для работы.
<ul>
<li><code>\MNT</code> - директория, в которую будет монтироваться образ WIM.</li>
<li><code>\UPD</code> - директория для хранения скаченных обновлений.</li>
<li><code>\WIM</code> - директория для хранения образа WIM.</li>
</ul>
</li>
</ul>
<h3 id="ms-dism">
  <a class="link-body-emphasis" href="#ms-dism">MS DISM</a>
</h3><p>Для интеграции обновлений потребуется инструмент <strong>Deployment Image Servicing and Management (DISM)</strong> (<code>DISM.exe</code>), который входит в комплект <a title="" href="https://learn.microsoft.com/en-us/windows-hardware/get-started/adk-install" target="_blank"
   rel="noopener noreferrer">Windows Assessment and Deployment Kit (Windows ADK)</a>. Обычно, DISM уже поставляется с операционной системой, но я рекомендую <a title="" href="https://learn.microsoft.com/en-us/windows-hardware/get-started/adk-install#other-adk-downloads" target="_blank"
   rel="noopener noreferrer">скачивать</a> последнюю версию с сайта Microsoft и устанавливать вручную.</p>
<p>Когда Windows ADK установлен, <span class="shortcode shortcode-tag"><a href="/ru/tags/dism/" target="_blank">#DISM</a></span> можно найти в меню <strong>&ldquo;Пуск&rdquo;</strong> вместе с остальными программам. Запускать <span class="shortcode shortcode-tag"><a href="/ru/tags/dism/" target="_blank">#DISM</a></span> необходимо под администратором. Все команды, приведённые ниже, должны будут выполняться только через установленный вручную <span class="shortcode shortcode-tag"><a href="/ru/tags/dism/" target="_blank">#DISM</a></span>. Использовать <span class="shortcode shortcode-tag"><a href="/ru/tags/dism/" target="_blank">#DISM</a></span>, поставляемый с операционной системой нет необходимости.</p>




    










    
    




<div class="shortcode shortcode-alert">
  <div class="alert alert-success d-flex overflow-hidden" role="alert">
    <div class="flex-shrink-0 align-self-center">
      <i class="fas fa-lightbulb fa-fw fa-2x"></i>
    </div>
    <div class="flex-grow-1 ms-3 overflow-hidden">
        <p>Установленный вручную DISM можно найти в меню &ldquo;Пуск&rdquo; / Windows Kits / <strong>Среда средств развертывания и работы с образами</strong>.</p>

    </div>
  </div>
</div>

<h2 id="интеграция-обновлений">
  <a class="link-body-emphasis" href="#%d0%b8%d0%bd%d1%82%d0%b5%d0%b3%d1%80%d0%b0%d1%86%d0%b8%d1%8f-%d0%be%d0%b1%d0%bd%d0%be%d0%b2%d0%bb%d0%b5%d0%bd%d0%b8%d0%b9">Интеграция обновлений</a>
</h2><p>Обновления можно скачивать с сайта-каталога <a title="" href="https://www.catalog.update.microsoft.com/" target="_blank"
   rel="noopener noreferrer">Microsoft Update Catalog</a>. Я беру так называемые &ldquo;кумулятивные (накопительные) обновления&rdquo; (cumulative updates), содержащие в себе сразу множество пакетов с исправлениями и обновлениями функций. <a title="" href="https://www.catalog.update.microsoft.com/Search.aspx?q=cumulative%20update" target="_blank"
   rel="noopener noreferrer">Найти</a> такие крупные обновления можно в каталоге при помощи поискового запроса <code>cumulative update</code>.</p>
<p>Скачиваемые обновления помещаются в директорию <code>C:\BuildFarm\UPD</code> для дальнейшей интеграции в дистрибутив ОС.</p>
<h3 id="извлечение-файла-wim-из-дистрибутива-ms-windows">
  <a class="link-body-emphasis" href="#%d0%b8%d0%b7%d0%b2%d0%bb%d0%b5%d1%87%d0%b5%d0%bd%d0%b8%d0%b5-%d1%84%d0%b0%d0%b9%d0%bb%d0%b0-wim-%d0%b8%d0%b7-%d0%b4%d0%b8%d1%81%d1%82%d1%80%d0%b8%d0%b1%d1%83%d1%82%d0%b8%d0%b2%d0%b0-ms-windows">Извлечение файла WIM из дистрибутива MS Windows</a>
</h3><p>Образ ОС находится в специальном файле <code>sources\install.wim</code>. Его необходимо извлечь при помощи программ для работы с файлами <code>.iso</code> (подойдёт <a title="" href="https://www.ultraiso.com" target="_blank"
   rel="noopener noreferrer">UltraISO</a> или <a title="" href="https://www.poweriso.com" target="_blank"
   rel="noopener noreferrer">PowerISO</a>) в директорию <code>C:\BuildFarm\WIM</code>.</p>
<h3 id="получение-информации-из-wim-образа">
  <a class="link-body-emphasis" href="#%d0%bf%d0%be%d0%bb%d1%83%d1%87%d0%b5%d0%bd%d0%b8%d0%b5-%d0%b8%d0%bd%d1%84%d0%be%d1%80%d0%bc%d0%b0%d1%86%d0%b8%d0%b8-%d0%b8%d0%b7-wim-%d0%be%d0%b1%d1%80%d0%b0%d0%b7%d0%b0">Получение информации из WIM-образа</a>
</h3><p>Файл <code>install.wim</code> может содержать несколько редакций ОС. Каждая редакция ОС имеет свой индекс. Для того, чтобы увидеть эти индексы, нужно ввести команду:</p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-0
shortcode-codeblock-powershell">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-3a35d482b74253d10d8c3b50c87cfde8" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-powershell" data-lang="powershell"><span class="line"><span class="cl"><span class="n">Dism</span> <span class="p">/</span><span class="nb">Get-ImageInfo</span> <span class="p">/</span><span class="n">ImageFile</span><span class="err">:</span><span class="s2">&#34;C:\BuildFarm\WIM\install.wim&#34;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-3a35d482b74253d10d8c3b50c87cfde8"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<p>Где:</p>
<ul>
<li><code>/Get-ImageInfo</code> - получить информацию о версиях операционной системы, находящихся в WIM-образ.</li>
<li><code>/ImageFile</code> - путь к WIM-образу.</li>
</ul>
<p>Введённая команда предоставит примерно такой выхлоп:</p>











<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-1 shortcode-codeblock-terminal
shortcode-codeblock-terminal-windows
shortcode-codeblock-terminal-windows-root">
  <div class="card overflow-hidden" data-bs-theme="dark">
    <div class="card-header">
      <div class="d-flex align-items-center">
        <div class="flex-shrink-0 text-danger">
          <i class="fas fa-terminal fa-fw"></i>
        </div>
        <div class="flex-grow-1 mx-2">
          <h5 class="mb-0">Терминал</h5>
        </div>
        <div class="flex-shrink-0">
          <ul class="list-inline mb-0">
            <li class="list-inline-item" title='Копировать'>
              <a class="text-body" href="#"
                 data-fn="clipboard" data-clipboard-target="#cp-59fd69aea6ed82f1dcd22bab652219c8"
                 role="button" aria-label='Копировать'>
                <i class="fas fa-copy fa-fw"></i>
              </a>
            </li>
          </ul>
        </div>
      </div>
    </div>
    <div class="card-body p-0 overflow-auto" id="cp-59fd69aea6ed82f1dcd22bab652219c8"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-plaintext" data-lang="plaintext"><span class="line"><span class="cl">Dism /Get-ImageInfo /ImageFile:&#34;C:\BuildFarm\WIM\install.wim&#34;
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Details for image : C:\BuildFarm\WIM\install.wim
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Index : 1
</span></span><span class="line"><span class="cl">Name : Windows 10 Education
</span></span><span class="line"><span class="cl">Description : Windows 10 Education
</span></span><span class="line"><span class="cl">Size : 15,643,499,526 bytes
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Index : 2
</span></span><span class="line"><span class="cl">Name : Windows 10 Education N
</span></span><span class="line"><span class="cl">Description : Windows 10 Education N
</span></span><span class="line"><span class="cl">Size : 14,878,972,660 bytes
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Index : 3
</span></span><span class="line"><span class="cl">Name : Windows 10 Enterprise
</span></span><span class="line"><span class="cl">Description : Windows 10 Enterprise
</span></span><span class="line"><span class="cl">Size : 15,643,653,521 bytes
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Index : 4
</span></span><span class="line"><span class="cl">Name : Windows 10 Enterprise N
</span></span><span class="line"><span class="cl">Description : Windows 10 Enterprise N
</span></span><span class="line"><span class="cl">Size : 14,878,878,937 bytes
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Index : 5
</span></span><span class="line"><span class="cl">Name : Windows 10 Pro
</span></span><span class="line"><span class="cl">Description : Windows 10 Pro
</span></span><span class="line"><span class="cl">Size : 15,658,943,281 bytes
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">&lt;...&gt;
</span></span><span class="line"><span class="cl">Extract Specific Windows Index from Windows 10 Multiple Edition ISO</span></span></code></pre></td></tr></table>
</div>
</div></div>
  </div>
</div>
<h3 id="монтирование-wim-образа">
  <a class="link-body-emphasis" href="#%d0%bc%d0%be%d0%bd%d1%82%d0%b8%d1%80%d0%be%d0%b2%d0%b0%d0%bd%d0%b8%d0%b5-wim-%d0%be%d0%b1%d1%80%d0%b0%d0%b7%d0%b0">Монтирование WIM-образа</a>
</h3><p>Индексы получены. Теперь необходимо примонтировать редакцию ОС из конкретного индекса. Выбор индекса зависит от вас: выбираете индекс той редакции ОС, которая вам необходима. Я выбрал редакцию <strong>Windows 10 Pro</strong> с индексом <code>5</code>:</p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-2
shortcode-codeblock-powershell">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-4f7ece8daf97c60ee750679248b086a9" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-powershell" data-lang="powershell"><span class="line"><span class="cl"><span class="n">Dism</span> <span class="p">/</span><span class="nb">Mount-Image</span> <span class="p">/</span><span class="n">ImageFile</span><span class="err">:</span><span class="s2">&#34;C:\BuildFarm\WIM\install.wim&#34;</span> <span class="p">/</span><span class="n">MountDir</span><span class="err">:</span><span class="s2">&#34;C:\BuildFarm\MNT&#34;</span> <span class="p">/</span><span class="n">index</span><span class="err">:</span><span class="mf">5</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-4f7ece8daf97c60ee750679248b086a9"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<p>Где:</p>
<ul>
<li><code>/Mount-Image</code> - команда на монтирование <span class="shortcode shortcode-tag">WIM</span>-образа.</li>
<li><code>/MountDir</code> - путь к директории, в которую необходимо поместить содержимое монтируемого <span class="shortcode shortcode-tag">WIM</span>-образа.</li>
<li><code>/index:5</code> - номер версии дистрибутива ОС. Номер можно узнать командой <code>/Get-ImageInfo</code>.</li>
</ul>




    










    
    




<div class="shortcode shortcode-alert">
  <div class="alert alert-success d-flex overflow-hidden" role="alert">
    <div class="flex-shrink-0 align-self-center">
      <i class="fas fa-lightbulb fa-fw fa-2x"></i>
    </div>
    <div class="flex-grow-1 ms-3 overflow-hidden">
        <p>Если что-то пошло не так, размонтировать образ без сохранения можно следующей командой:</p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-0
shortcode-codeblock-bat">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-727729f351dc0e04a7780c0dea24b3b5" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bat" data-lang="bat"><span class="line"><span class="cl">Dism /Unmount-Image /MountDir:<span class="s2">&#34;C:\BuildFarm\MNT&#34;</span> /Discard</span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-727729f351dc0e04a7780c0dea24b3b5"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<p>Проверить список примонтированных образов можно следующей командой:</p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-1
shortcode-codeblock-bat">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-4414d7ba8d02e46f85820cd41ce78942" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bat" data-lang="bat"><span class="line"><span class="cl">Dism /Get-MountedImageInfo</span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-4414d7ba8d02e46f85820cd41ce78942"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<p>Если после размонтирования образ всё ещё остаётся подключённым к системе и является повреждённым, следующая команда можешь помочь:</p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-2
shortcode-codeblock-bat">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-78496586e20de9ee6195e9106867fd84" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bat" data-lang="bat"><span class="line"><span class="cl">Dism /Cleanup-Mountpoints</span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-78496586e20de9ee6195e9106867fd84"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<p>Она удалит все ресурсы, связанные с повреждённым образом и очистит систему от &ldquo;зависших&rdquo; точек монтирования.</p>

    </div>
  </div>
</div>

<h3 id="интеграция-обновлений-в-wim-образ">
  <a class="link-body-emphasis" href="#%d0%b8%d0%bd%d1%82%d0%b5%d0%b3%d1%80%d0%b0%d1%86%d0%b8%d1%8f-%d0%be%d0%b1%d0%bd%d0%be%d0%b2%d0%bb%d0%b5%d0%bd%d0%b8%d0%b9-%d0%b2-wim-%d0%be%d0%b1%d1%80%d0%b0%d0%b7">Интеграция обновлений в WIM-образ</a>
</h3><p>После монтирования редакции ОС с конкретным индексом, можно начинать процесс интеграции обновлений:</p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-3
shortcode-codeblock-powershell">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-407896f230c56f3ed60c6207bf9f947a" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-powershell" data-lang="powershell"><span class="line"><span class="cl"><span class="n">Dism</span> <span class="p">/</span><span class="n">Image</span><span class="err">:</span><span class="s2">&#34;C:\BuildFarm\MNT&#34;</span> <span class="p">/</span><span class="nb">Add-Package</span> <span class="p">/</span><span class="n">PackagePath</span><span class="err">:</span><span class="s2">&#34;C:\BuildFarm\UPD&#34;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-407896f230c56f3ed60c6207bf9f947a"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<p>Где:</p>
<ul>
<li><code>/Image</code> - путь к директории, в которой находится содержимое примонтированного WIM-образа.</li>
<li><code>/Add-Package</code> - команда на добавление пакетов (обновлений) в WIM-образ.
<ul>
<li><code>/PackagePath</code> - путь к директории, в которой находятся пакеты (обновления) для интеграции в WIM-образ.</li>
</ul>
</li>
</ul>
<h3 id="проверка-корректности-интеграции-обновлений-опционально">
  <a class="link-body-emphasis" href="#%d0%bf%d1%80%d0%be%d0%b2%d0%b5%d1%80%d0%ba%d0%b0-%d0%ba%d0%be%d1%80%d1%80%d0%b5%d0%ba%d1%82%d0%bd%d0%be%d1%81%d1%82%d0%b8-%d0%b8%d0%bd%d1%82%d0%b5%d0%b3%d1%80%d0%b0%d1%86%d0%b8%d0%b8-%d0%be%d0%b1%d0%bd%d0%be%d0%b2%d0%bb%d0%b5%d0%bd%d0%b8%d0%b9-%d0%be%d0%bf%d1%86%d0%b8%d0%be%d0%bd%d0%b0%d0%bb%d1%8c%d0%bd%d0%be">Проверка корректности интеграции обновлений (опционально)</a>
</h3><p>По окончании процесса интеграции, можно проверить корректность выполненной задачи. Команда ниже покажет список пакетов, установленных в примонтированной редакции ОС. В этом списке пакетов будут интегрированные обновления.</p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-4
shortcode-codeblock-powershell">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-39162c4883a6c10b84f6109ab9d9267c" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-powershell" data-lang="powershell"><span class="line"><span class="cl"><span class="n">Dism</span> <span class="p">/</span><span class="n">Image</span><span class="err">:</span><span class="s2">&#34;C:\BuildFarm\MNT&#34;</span> <span class="p">/</span><span class="nb">Get-Packages</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-39162c4883a6c10b84f6109ab9d9267c"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<p>Где:</p>
<ul>
<li><code>/Image</code> - путь к директории, в которой находится содержимое примонтированного <span class="shortcode shortcode-tag">WIM</span>-образа.</li>
<li><code>/Get-Packages</code> - команда для получения информации о интегрированных пакетах примонтированного <span class="shortcode shortcode-tag">WIM</span>-образа.</li>
</ul>
<h3 id="очистка-хранилища-компонентов-wim-образ-опционально">
  <a class="link-body-emphasis" href="#%d0%be%d1%87%d0%b8%d1%81%d1%82%d0%ba%d0%b0-%d1%85%d1%80%d0%b0%d0%bd%d0%b8%d0%bb%d0%b8%d1%89%d0%b0-%d0%ba%d0%be%d0%bc%d0%bf%d0%be%d0%bd%d0%b5%d0%bd%d1%82%d0%be%d0%b2-wim-%d0%be%d0%b1%d1%80%d0%b0%d0%b7-%d0%be%d0%bf%d1%86%d0%b8%d0%be%d0%bd%d0%b0%d0%bb%d1%8c%d0%bd%d0%be">Очистка хранилища компонентов WIM-образ (опционально)</a>
</h3><p>Для уменьшения размера дистрибутива можно запустить процедуру удаления предыдущих версий компонентов, которые были изменены (заменены) установленными обновлениями:</p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-5
shortcode-codeblock-powershell">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-37a53cddd29a4ca1e4ab6b9767ddf79f" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-powershell" data-lang="powershell"><span class="line"><span class="cl"><span class="n">Dism</span> <span class="p">/</span><span class="n">Image</span><span class="err">:</span><span class="s2">&#34;C:\BuildFarm\MNT&#34;</span> <span class="p">/</span><span class="nb">Cleanup-Image</span> <span class="p">/</span><span class="n">StartComponentCleanup</span> <span class="p">/</span><span class="n">ResetBase</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-37a53cddd29a4ca1e4ab6b9767ddf79f"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<p>Где:</p>
<ul>
<li><code>/Image</code> - путь к директории, в которой находится содержимое примонтированного <span class="shortcode shortcode-tag">WIM</span>-образа.</li>
<li><code>/Cleanup-Image</code> - очистка и восстановление образа.
<ul>
<li><code>/StartComponentCleanup</code> - удаляет заменённые компоненты и уменьшает размер хранилища компонентов.
<ul>
<li><code>/ResetBase</code> - сброс базы заменяемых компонентов.</li>
</ul>
</li>
</ul>
</li>
</ul>
<h3 id="проверка-хранилища-компонентов-wim-образа-опционально">
  <a class="link-body-emphasis" href="#%d0%bf%d1%80%d0%be%d0%b2%d0%b5%d1%80%d0%ba%d0%b0-%d1%85%d1%80%d0%b0%d0%bd%d0%b8%d0%bb%d0%b8%d1%89%d0%b0-%d0%ba%d0%be%d0%bc%d0%bf%d0%be%d0%bd%d0%b5%d0%bd%d1%82%d0%be%d0%b2-wim-%d0%be%d0%b1%d1%80%d0%b0%d0%b7%d0%b0-%d0%be%d0%bf%d1%86%d0%b8%d0%be%d0%bd%d0%b0%d0%bb%d1%8c%d0%bd%d0%be">Проверка хранилища компонентов WIM-образа (опционально)</a>
</h3><p>Опциональный шаг перед заключительным этапом - проверить системные компоненты и файлы на повреждения:</p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-6
shortcode-codeblock-powershell">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-b9c727485ab2f33a773eb2224bd3c003" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-powershell" data-lang="powershell"><span class="line"><span class="cl"><span class="n">Dism</span> <span class="p">/</span><span class="n">Image</span><span class="err">:</span><span class="s2">&#34;C:\BuildFarm\MNT&#34;</span> <span class="p">/</span><span class="nb">Cleanup-Image</span> <span class="p">/</span><span class="n">ScanHealth</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-b9c727485ab2f33a773eb2224bd3c003"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<p>Где:</p>
<ul>
<li><code>/Image</code> - путь к директории, в которой находится содержимое примонтированного <span class="shortcode shortcode-tag">WIM</span>-образа.</li>
<li><code>/Cleanup-Image</code> - очистка и восстановление образа.
<ul>
<li><code>/ScanHealth</code> - сканирование образа на наличие повреждений хранилища компонентов.</li>
</ul>
</li>
</ul>
<h3 id="сохранение-изменений-в-wim-образе">
  <a class="link-body-emphasis" href="#%d1%81%d0%be%d1%85%d1%80%d0%b0%d0%bd%d0%b5%d0%bd%d0%b8%d0%b5-%d0%b8%d0%b7%d0%bc%d0%b5%d0%bd%d0%b5%d0%bd%d0%b8%d0%b9-%d0%b2-wim-%d0%be%d0%b1%d1%80%d0%b0%d0%b7%d0%b5">Сохранение изменений в WIM-образе</a>
</h3><p>После выполнения всех действий, необходимо отмонтировать редакцию ОС с сохранением изменений. Делается это командой:</p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-7
shortcode-codeblock-powershell">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-d0a79cc9ffaf452538050806bae35d52" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-powershell" data-lang="powershell"><span class="line"><span class="cl"><span class="n">Dism</span> <span class="p">/</span><span class="nb">Unmount-Image</span> <span class="p">/</span><span class="n">MountDir</span><span class="err">:</span><span class="s2">&#34;C:\BuildFarm\MNT&#34;</span> <span class="p">/</span><span class="n">Commit</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-d0a79cc9ffaf452538050806bae35d52"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<p>Где:</p>
<ul>
<li><code>/Unmount-Image</code> - команда для отмонтирования <span class="shortcode shortcode-tag">WIM</span>-образа.</li>
<li><code>/MountDir</code> - путь к директории, в которой находится содержимое примонтированного <span class="shortcode shortcode-tag">WIM</span>-образа.</li>
<li><code>/Commit</code> - сохранение совершённых изменений в <span class="shortcode shortcode-tag">WIM</span>-образе.</li>
</ul>
<p>Всё. Мы получили файл <code>install.wim</code> с интегрированными обновлениями. Теперь этот файл <code>install.wim</code> необходимо обратно упаковать в образ <span class="shortcode shortcode-tag">ISO</span> с заменой старого.</p>
<h2 id="автоматизация">
  <a class="link-body-emphasis" href="#%d0%b0%d0%b2%d1%82%d0%be%d0%bc%d0%b0%d1%82%d0%b8%d0%b7%d0%b0%d1%86%d0%b8%d1%8f">Автоматизация</a>
</h2><p>Я люблю автоматизировать всё по максимуму. И здесь я не упустил шанс написать небольшой скрипт с деревянной логикой, который сделает все шаги по интеграции обновлений за человека. Только вот, извлечь файл <code>install.wim</code> из <span class="shortcode shortcode-tag">ISO</span>-образа придётся самому.</p>

    

    
        
            
            <div class="shortcode shortcode-file mb-3">
              <div class="card overflow-hidden" data-bs-theme="dark">
                <div class="card-header">
                  <div class="d-flex align-items-center">
                    <div class="flex-shrink-0">
                      <i class="far fa-file-code fa-fw"></i>
                    </div>
                    <div class="flex-grow-1 mx-2 text-truncate">
                      <code>dism.packages.bat</code>
                    </div>
                    <div class="flex-shrink-0">
                      <ul class="list-inline mb-0">
                        <li class="list-inline-item" title='Копировать'>
                          <a class="text-body" href="#"
                             data-fn="clipboard" data-clipboard-target="#cp-5135a9ec7315a666db043a4bb78d121c"
                             role="button" aria-label='Копировать'>
                            <i class="fas fa-copy fa-fw"></i>
                          </a>
                        </li>
                        <li class="list-inline-item" title='Скачать'>
                          <a class="text-body" href="/ru/2022/05/862226e6-cbb1-58f8-bc8e-0cfef747f475/dism.packages.bat" download
                             role="button" aria-label='Скачать'>
                            <i class="fas fa-download fa-fw"></i>
                          </a>
                        </li>
                        <li class="list-inline-item" title='Открыть'>
                          <a class="text-body" href="/ru/2022/05/862226e6-cbb1-58f8-bc8e-0cfef747f475/dism.packages.bat" target="_blank"
                             role="button" aria-label='Открыть'>
                            <i class="fas fa-arrow-up-right-from-square fa-fw"></i>
                          </a>
                        </li>
                      </ul>
                    </div>
                  </div>
                </div>
                <div class="card-body p-0 overflow-auto" id="cp-5135a9ec7315a666db043a4bb78d121c">
                    
                        
                    
                    <div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span><span class="lnt">56
</span><span class="lnt">57
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bat" data-lang="bat"><span class="line"><span class="cl"><span class="c1">rem # Automatic integration of updates into DISM.</span>
</span></span><span class="line"><span class="cl"><span class="c1">rem #</span>
</span></span><span class="line"><span class="cl"><span class="c1">rem # @package   CMD</span>
</span></span><span class="line"><span class="cl"><span class="c1">rem # @author    Kai Kimera &lt;mail@kai.kim&gt;</span>
</span></span><span class="line"><span class="cl"><span class="c1">rem # @copyright 2023 Library Online</span>
</span></span><span class="line"><span class="cl"><span class="c1">rem # @license   MIT</span>
</span></span><span class="line"><span class="cl"><span class="c1">rem # @version   0.1.0</span>
</span></span><span class="line"><span class="cl"><span class="c1">rem # @link      https://lib.onl/ru/2022/05/862226e6-cbb1-58f8-bc8e-0cfef747f475/</span>
</span></span><span class="line"><span class="cl"><span class="c1">rem # ---------------------------------------------------------------------------------------------------------------- #</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="p">@</span><span class="k">echo</span> off
</span></span><span class="line"><span class="cl"><span class="k">set</span> <span class="nv">d_mnt</span><span class="p">=</span><span class="s2">&#34;</span><span class="nv">%~dp0</span><span class="s2">MNT&#34;</span>
</span></span><span class="line"><span class="cl"><span class="k">set</span> <span class="nv">d_upd</span><span class="p">=</span><span class="s2">&#34;</span><span class="nv">%~dp0</span><span class="s2">UPD&#34;</span>
</span></span><span class="line"><span class="cl"><span class="k">set</span> <span class="nv">d_wim</span><span class="p">=</span><span class="s2">&#34;</span><span class="nv">%~dp0</span><span class="s2">WIM&#34;</span>
</span></span><span class="line"><span class="cl"><span class="k">set</span> <span class="nv">f_wim</span><span class="p">=</span><span class="s2">&#34;</span><span class="nv">%d_wim%</span><span class="s2">\install.wim&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">rem Creating directories.</span>
</span></span><span class="line"><span class="cl"><span class="k">if</span> <span class="k">not</span> <span class="k">exist</span> <span class="s2">&#34;</span><span class="nv">%d_mnt%</span><span class="s2">&#34;</span> <span class="k">mkdir</span> <span class="s2">&#34;</span><span class="nv">%d_mnt%</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl"><span class="k">if</span> <span class="k">not</span> <span class="k">exist</span> <span class="s2">&#34;</span><span class="nv">%d_upd%</span><span class="s2">&#34;</span> <span class="k">mkdir</span> <span class="s2">&#34;</span><span class="nv">%d_upd%</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl"><span class="k">if</span> <span class="k">not</span> <span class="k">exist</span> <span class="s2">&#34;</span><span class="nv">%d_wim%</span><span class="s2">&#34;</span> <span class="k">mkdir</span> <span class="s2">&#34;</span><span class="nv">%d_wim%</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">rem Checking files.</span>
</span></span><span class="line"><span class="cl"><span class="k">if</span> <span class="k">not</span> <span class="k">exist</span> <span class="s2">&#34;</span><span class="nv">%f_wim%</span><span class="s2">&#34;</span> <span class="k">echo</span> Please put <span class="s2">&#34;install.wim&#34;</span> file in <span class="s2">&#34;WIM&#34;</span> directory... <span class="p">&amp;&amp;</span> <span class="k">pause</span>
</span></span><span class="line"><span class="cl"><span class="k">if</span> <span class="k">not</span> <span class="k">exist</span> <span class="s2">&#34;</span><span class="nv">%d_upd%</span><span class="s2">/*.msu&#34;</span> <span class="k">echo</span> Please put <span class="s2">&#34;*.msu&#34;</span> files in <span class="s2">&#34;UPD&#34;</span> directory... <span class="p">&amp;&amp;</span> <span class="k">pause</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">if</span> <span class="k">exist</span> <span class="s2">&#34;</span><span class="nv">%f_wim%</span><span class="s2">&#34;</span> <span class="p">(</span>
</span></span><span class="line"><span class="cl">  <span class="k">echo</span> Getting Windows Image Info...
</span></span><span class="line"><span class="cl">  Dism /Get-ImageInfo /ImageFile:<span class="s2">&#34;</span><span class="nv">%f_wim%</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl"><span class="p">)</span> <span class="k">else</span> <span class="p">(</span>
</span></span><span class="line"><span class="cl">  <span class="k">echo</span> <span class="s2">&#34;install.wim&#34;</span> not found! <span class="p">&amp;</span> <span class="k">echo</span>.Failed with error #<span class="nv">%errorlevel%</span>.
</span></span><span class="line"><span class="cl">  <span class="k">goto</span> <span class="p">:</span><span class="nl">error</span>
</span></span><span class="line"><span class="cl"><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">set</span> <span class="k">/p</span> <span class="nv">index</span><span class="p">=</span><span class="s2">&#34;Enter INDEX: &#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">echo</span> Mounting Windows image...
</span></span><span class="line"><span class="cl">Dism /Mount-Image /ImageFile:<span class="s2">&#34;</span><span class="nv">%f_wim%</span><span class="s2">&#34;</span> /MountDir:<span class="s2">&#34;</span><span class="nv">%d_mnt%</span><span class="s2">&#34;</span> /index:<span class="nv">%index%</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">echo</span> Adding Windows packages...
</span></span><span class="line"><span class="cl">Dism /Image:<span class="s2">&#34;</span><span class="nv">%d_mnt%</span><span class="s2">&#34;</span> /Add-Package /PackagePath:<span class="s2">&#34;</span><span class="nv">%d_upd%</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">echo</span> Getting Windows packages...
</span></span><span class="line"><span class="cl">Dism /Image:<span class="s2">&#34;</span><span class="nv">%d_mnt%</span><span class="s2">&#34;</span> /Get-Packages
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">echo</span> Reseting Windows image...
</span></span><span class="line"><span class="cl">Dism /Image:<span class="s2">&#34;</span><span class="nv">%d_mnt%</span><span class="s2">&#34;</span> /Cleanup-Image /StartComponentCleanup /ResetBase
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">echo</span> Scaning health Windows image...
</span></span><span class="line"><span class="cl">Dism /Image:<span class="s2">&#34;</span><span class="nv">%d_mnt%</span><span class="s2">&#34;</span> /Cleanup-Image /ScanHealth
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">echo</span> Saving Windows image...
</span></span><span class="line"><span class="cl">Dism /Unmount-Image /MountDir:<span class="s2">&#34;</span><span class="nv">%d_mnt%</span><span class="s2">&#34;</span> /Commit
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">exit</span> /b 0
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="p">:</span><span class="nl">error</span>
</span></span><span class="line"><span class="cl"><span class="k">exit</span> /b <span class="nv">%errorlevel%</span></span></span></code></pre></td></tr></table>
</div>
</div>
                </div>
              </div>
            </div>
        
    
<p>Поместить скрипт нужно в корень директории <code>BuildFarm</code> и запустить из терминала <span class="shortcode shortcode-tag"><a href="/ru/tags/dism/" target="_blank">#DISM</a></span>. Если же возникнут какие-либо проблемы, ниже есть небольшой скрипт, который размонтирует образ и очистит систему от точек монтирования.</p>

    

    
        
            
            <div class="shortcode shortcode-file mb-3">
              <div class="card overflow-hidden" data-bs-theme="dark">
                <div class="card-header">
                  <div class="d-flex align-items-center">
                    <div class="flex-shrink-0">
                      <i class="far fa-file-code fa-fw"></i>
                    </div>
                    <div class="flex-grow-1 mx-2 text-truncate">
                      <code>dism.unmount.bat</code>
                    </div>
                    <div class="flex-shrink-0">
                      <ul class="list-inline mb-0">
                        <li class="list-inline-item" title='Копировать'>
                          <a class="text-body" href="#"
                             data-fn="clipboard" data-clipboard-target="#cp-51098f1bb735c3e0a692db84160dc907"
                             role="button" aria-label='Копировать'>
                            <i class="fas fa-copy fa-fw"></i>
                          </a>
                        </li>
                        <li class="list-inline-item" title='Скачать'>
                          <a class="text-body" href="/ru/2022/05/862226e6-cbb1-58f8-bc8e-0cfef747f475/dism.unmount.bat" download
                             role="button" aria-label='Скачать'>
                            <i class="fas fa-download fa-fw"></i>
                          </a>
                        </li>
                        <li class="list-inline-item" title='Открыть'>
                          <a class="text-body" href="/ru/2022/05/862226e6-cbb1-58f8-bc8e-0cfef747f475/dism.unmount.bat" target="_blank"
                             role="button" aria-label='Открыть'>
                            <i class="fas fa-arrow-up-right-from-square fa-fw"></i>
                          </a>
                        </li>
                      </ul>
                    </div>
                  </div>
                </div>
                <div class="card-body p-0 overflow-auto" id="cp-51098f1bb735c3e0a692db84160dc907">
                    
                        
                    
                    <div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bat" data-lang="bat"><span class="line"><span class="cl"><span class="c1">rem # Automatic unmounting WIM images into DISM.</span>
</span></span><span class="line"><span class="cl"><span class="c1">rem #</span>
</span></span><span class="line"><span class="cl"><span class="c1">rem # @package   CMD</span>
</span></span><span class="line"><span class="cl"><span class="c1">rem # @author    Kai Kimera &lt;mail@kai.kim&gt;</span>
</span></span><span class="line"><span class="cl"><span class="c1">rem # @copyright 2023 Library Online</span>
</span></span><span class="line"><span class="cl"><span class="c1">rem # @license   MIT</span>
</span></span><span class="line"><span class="cl"><span class="c1">rem # @version   0.1.0</span>
</span></span><span class="line"><span class="cl"><span class="c1">rem # @link      https://lib.onl/ru/2022/05/862226e6-cbb1-58f8-bc8e-0cfef747f475/</span>
</span></span><span class="line"><span class="cl"><span class="c1">rem # ---------------------------------------------------------------------------------------------------------------- #</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="p">@</span><span class="k">echo</span> off
</span></span><span class="line"><span class="cl"><span class="k">set</span> <span class="nv">d_mnt</span><span class="p">=</span><span class="s2">&#34;</span><span class="nv">%~dp0</span><span class="s2">MNT&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">echo</span> Unmounting <span class="s2">&#34;install.wim&#34;</span> and discards changes that were made when image was mounted...
</span></span><span class="line"><span class="cl">Dism /Unmount-Image /MountDir:<span class="s2">&#34;</span><span class="nv">%d_mnt%</span><span class="s2">&#34;</span> /Discard
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">echo</span> Deleting all of resources associated with a mounted image that has been corrupted...
</span></span><span class="line"><span class="cl">Dism /Cleanup-Mountpoints
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">echo</span> Getting information about mounted image...
</span></span><span class="line"><span class="cl">Dism /Get-MountedImageInfo
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">exit</span> /b 0</span></span></code></pre></td></tr></table>
</div>
</div>
                </div>
              </div>
            </div>]]></turbo:content></item><item turbo="true"><title>Windows Server 2022 для рабочей станции</title><link>https://lib.onl/ru/2022/05/36058650-3f35-5ed5-9565-0aa7d8800c28/</link><pubDate>Mon, 09 May 2022 11:53:26 +0000</pubDate><dc:creator>Kai Kimera</dc:creator><category>MS Windows</category><turbo:extendedHtml>true</turbo:extendedHtml><turbo:source>https://lib.onl/ru/2022/05/36058650-3f35-5ed5-9565-0aa7d8800c28/</turbo:source><turbo:topic>Windows Server 2022 для рабочей станции</turbo:topic><turbo:content><![CDATA[<p>В этой небольшой заметке я расскажу, как перенастроить серверную версию ОС <span class="shortcode shortcode-tag"><a href="/ru/tags/windows/" target="_blank">#Windows</a></span> для работы на обычном стационарном ПК.</p>
<h2 id="настройка-служб">
  <a class="link-body-emphasis" href="#%d0%bd%d0%b0%d1%81%d1%82%d1%80%d0%be%d0%b9%d0%ba%d0%b0-%d1%81%d0%bb%d1%83%d0%b6%d0%b1">Настройка служб</a>
</h2><p>На сервере нет необходимости использовать поисковые механизмы и вывод звука, поэтому они отключены. Но на рабочей станции эти параметры необходимы. Для включения звука и поискового механизма, необходимо настроить запуск соответствующих служб.</p>
<ul>
<li>Services
<ul>
<li>Windows Audio
<ul>
<li>Startup type
<ul>
<li>Automatic</li>
</ul>
</li>
</ul>
</li>
<li>Windows Audio Endpoint
<ul>
<li>Startup type
<ul>
<li>Automatic</li>
</ul>
</li>
</ul>
</li>
<li>Windows Search
<ul>
<li>Startup type
<ul>
<li>Automatic (Delayed Start)</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<h2 id="отключение-shutdown-event-tracker">
  <a class="link-body-emphasis" href="#%d0%be%d1%82%d0%ba%d0%bb%d1%8e%d1%87%d0%b5%d0%bd%d0%b8%d0%b5-shutdown-event-tracker">Отключение Shutdown Event Tracker</a>
</h2><p>Сервер должен работать бесперебойно. Любое отключение сервера, по хорошему, должно записываться в специальный журнал. Но так как у нас рабочая станция, записывать каждые перезагрузку или выключение нет необходимости. Включаем службы.</p>
<ul>
<li>Local Group Policy
<ul>
<li>Computer Configuration / Administrative Templates / System
<ul>
<li>Display Shutdown Event Tracker
<ul>
<li>Disabled</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<h2 id="отключение-строгой-системы-безопасности-ie">
  <a class="link-body-emphasis" href="#%d0%be%d1%82%d0%ba%d0%bb%d1%8e%d1%87%d0%b5%d0%bd%d0%b8%d0%b5-%d1%81%d1%82%d1%80%d0%be%d0%b3%d0%be%d0%b9-%d1%81%d0%b8%d1%81%d1%82%d0%b5%d0%bc%d1%8b-%d0%b1%d0%b5%d0%b7%d0%be%d0%bf%d0%b0%d1%81%d0%bd%d0%be%d1%81%d1%82%d0%b8-ie">Отключение строгой системы безопасности IE</a>
</h2><p>Сервер использует строгие параметры системы безопасности <span class="shortcode shortcode-tag">IE</span>. Но на рабочей станции в этих параметрах нет необходимости и они будут только мешать. Отключаем их.</p>
<ul>
<li>Server Manager / Local Server
<ul>
<li>IE Enhanced Security Configuration
<ul>
<li>Off</li>
</ul>
</li>
</ul>
</li>
</ul>
<h2 id="оптимизация-производительности-для-приложений">
  <a class="link-body-emphasis" href="#%d0%be%d0%bf%d1%82%d0%b8%d0%bc%d0%b8%d0%b7%d0%b0%d1%86%d0%b8%d1%8f-%d0%bf%d1%80%d0%be%d0%b8%d0%b7%d0%b2%d0%be%d0%b4%d0%b8%d1%82%d0%b5%d0%bb%d1%8c%d0%bd%d0%be%d1%81%d1%82%d0%b8-%d0%b4%d0%bb%d1%8f-%d0%bf%d1%80%d0%b8%d0%bb%d0%be%d0%b6%d0%b5%d0%bd%d0%b8%d0%b9">Оптимизация производительности для приложений</a>
</h2><p>По умолчанию, на сервере оптимизация включена для фоновых служб. На рабочей станции необходима оптимизация для программ. Включаем оптимизацию для программ.</p>
<ul>
<li>System / Advanced System Settings / Advanced / Performance / Advanced
<ul>
<li>Adjust for best performance of
<ul>
<li>Programs</li>
</ul>
</li>
</ul>
</li>
</ul>
<h2 id="отключение-dep">
  <a class="link-body-emphasis" href="#%d0%be%d1%82%d0%ba%d0%bb%d1%8e%d1%87%d0%b5%d0%bd%d0%b8%d0%b5-dep">Отключение DEP</a>
</h2><p>По умолчанию, <a title="" href="https://docs.microsoft.com/en-us/windows/win32/memory/data-execution-prevention" target="_blank"
   rel="noopener noreferrer">Data Execution Prevention (DEP)</a> включена абсолютно для всех программ и сервисов. Такая излишняя защита на рабочей станции не нужна. Поэтому, переключаем выполнение <span class="shortcode shortcode-tag">DEP</span> только для программ и сервисов самой ОС Windows.</p>
<ul>
<li>System / Advanced System Settings / Advanced / Performance / Data Execution Prevention
<ul>
<li>Turn on DEP for essential Windows programs and services only</li>
</ul>
</li>
</ul>
<h2 id="включение-memory-compression-operation-api-и-pagecombining">
  <a class="link-body-emphasis" href="#%d0%b2%d0%ba%d0%bb%d1%8e%d1%87%d0%b5%d0%bd%d0%b8%d0%b5-memory-compression-operation-api-%d0%b8-pagecombining">Включение Memory Compression, Operation API и PageCombining</a>
</h2><p>В ОС <span class="shortcode shortcode-tag"><a href="/ru/tags/windows/" target="_blank">#Windows</a></span> для обычных компьютеров включены Memory Compression, Operation API и PageCombining. Поэтому, перенастраиваем серверную версию ОС на такую же конфигурацию. Для этого запускаем <span class="shortcode shortcode-tag"><a href="/ru/tags/powershell/" target="_blank">#PowerShell</a></span> от имени Администратора и выполняем команду:</p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-0
shortcode-codeblock-powershell">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-047ece5062a1c623e01c64edcc8e850c" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-powershell" data-lang="powershell"><span class="line"><span class="cl"><span class="nb">Enable-MMAgent</span> <span class="n">-MemoryCompression</span> <span class="n">-OperationAPI</span> <span class="n">-PageCombining</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-047ece5062a1c623e01c64edcc8e850c"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>]]></turbo:content></item><item turbo="true"><title>Установка ядра XanMod в Debian</title><link>https://lib.onl/ru/2022/01/06ef2fab-2ae2-5356-9154-7ca1e486d27d/</link><pubDate>Thu, 13 Jan 2022 22:44:15 +0000</pubDate><dc:creator>Kai Kimera</dc:creator><category>Linux</category><yandex:related><link url="https://lib.onl/ru/2022/01/ddddd243-d182-5e26-a161-d2ea7812214a/">Установка Vivaldi в Debian</link><link url="https://lib.onl/ru/2021/09/581804b8-0613-52a8-a5c4-fdae90e7bc8a/">Чёрный экран с курсором при старте GDM</link><link url="https://lib.onl/ru/2021/09/1cf305cd-85d0-5e02-aabb-e01346bfee0f/">Proxmox VE: Установка на Debian 11 (Bullseye)</link><link url="https://lib.onl/ru/2021/09/ff829d15-4a19-52e3-a3aa-ad70aa38854a/">Debian: Wired Networks are Unmanaged</link><link url="https://lib.onl/ru/2021/09/b2caccc7-92bf-57ed-970f-136c546f18e2/">Распаковка пакетов DEB / RPM</link><link url="https://lib.onl/ru/2021/09/43b40b92-c29a-504b-87fa-5eac368dcf95/">Отключение установки дополнительных пакетов в Debian APT</link><link url="https://lib.onl/ru/2021/09/aeed7c90-003a-532a-b2c4-3807aaee88fa/">dhclient отправляет 36-значный идентификатор вместо MAC</link><link url="https://lib.onl/ru/2021/05/ee559a6c-5cde-5166-9d2d-3ceb55878eb8/">Debian: Статический IP-адрес</link></yandex:related><turbo:extendedHtml>true</turbo:extendedHtml><turbo:source>https://lib.onl/ru/2022/01/06ef2fab-2ae2-5356-9154-7ca1e486d27d/</turbo:source><turbo:topic>Установка ядра XanMod в Debian</turbo:topic><turbo:content><![CDATA[<p>Приветствую! В этой небольшой заметке приведу команду, при помощи которой можно добавить репозиторий ядра <span class="shortcode shortcode-tag"><a href="/ru/tags/xanmod/" target="_blank">#XanMod</a></span> в <span class="shortcode shortcode-tag"><a href="/ru/tags/debian/" target="_blank">#Debian</a></span>.</p>
<h2 id="что-такое-ядро-xanmod">
  <a class="link-body-emphasis" href="#%d1%87%d1%82%d0%be-%d1%82%d0%b0%d0%ba%d0%be%d0%b5-%d1%8f%d0%b4%d1%80%d0%be-xanmod">Что такое ядро XanMod?</a>
</h2><p>Ядро <span class="shortcode shortcode-tag"><a href="/ru/tags/xanmod/" target="_blank">#XanMod</a></span> имеет ряд патчей и оптимизаций. Список изменений по сравнению с ванильным ядром, я взял с <a title="" href="https://xanmod.org" target="_blank"
   rel="noopener noreferrer">официального сайта</a>:</p>
<ul>
<li>Caching, Virtual Memory Manager and CPUFreq Governor improvements.</li>
<li>Full multi-core block layer runqueue requests for high I/O throughput.</li>
<li>BBRv2 TCP congestion control + FQ-PIE packet scheduling and AQM algorithm.</li>
<li>ORC Unwinder for kernel stack traces (debuginfo) implementation.</li>
<li>High responsiveness multitasking Task Type scheduler (SCHED_NORMAL) build available [5.15-tt].</li>
<li>Real-time Linux kernel (PREEMPT_RT) build available [5.15-rt] [5.10-rt].</li>
<li>Third-party patchset available: patches
<ul>
<li>le9&rsquo;s file mappings under memory pressure protection.</li>
<li>Linux Random Number Generator (LRNG) framework.</li>
<li>TCP performance optimizations backport from linux/net-next [5.16] [5.15].</li>
<li>AMD&rsquo;s P-state driver for Zen2 and Zen3 processors [5.16] [5.15].</li>
<li>Futex waitv and legacy WAIT_MULTIPLE implementation for Wine / Proton Fsync support.</li>
<li>WineSync driver for fast kernel-backed Wine [5.16] [5.15] [as module: winesync].</li>
<li>Google&rsquo;s Multigenerational LRU framework [5.16] [5.15].</li>
<li>Google&rsquo;s BBRv2 TCP congestion control.</li>
<li>Paragon&rsquo;s Software NTFS3 driver [as module: ntfs3].</li>
<li>PCIe ACS Override for bypassing IOMMU groups support.</li>
<li>Graysky&rsquo;s additional CPU optimizations for GCC and Clang.</li>
<li>Clear Linux patchset [partial].</li>
<li>Android Ashmem and Binder IPC driver as module for Anbox.</li>
<li>Updated ZSTD library for bug fixes and r/w performance compression improvements on Btrfs, F2FS, SquashFS, pstore, initramfs and vmlinuz.</li>
</ul>
</li>
<li>Generic packages for compatibility with most Debian &amp; Ubuntu based distributions. Builts on the latest LLVM 12.0.1, GCC 11.2 and Binutils 2.37.</li>
<li>GPLv2 license. Can be built for any distribution or purpose.</li>
</ul>
<p>Стоит заметить, что ядро <span class="shortcode shortcode-tag"><a href="/ru/tags/xanmod/" target="_blank">#XanMod</a></span> не единственное, которое интегрирует в себя оптимизации. Есть ещё ядро <a title="" href="https://liquorix.net" target="_blank"
   rel="noopener noreferrer"><strong>Liquorix</strong></a>, которое занимается практически тем же самым. Но, посмотрев <a title="" href="https://www.phoronix.com/scan.php?page=article&amp;item=ryzen5-xanmod-liquorix" target="_blank"
   rel="noopener noreferrer">обзор и тесты</a> на Phoronix&rsquo;е, я сделал выбор в пользу <span class="shortcode shortcode-tag"><a href="/ru/tags/xanmod/" target="_blank">#XanMod</a></span>.</p>
<h2 id="установка-xanmod">
  <a class="link-body-emphasis" href="#%d1%83%d1%81%d1%82%d0%b0%d0%bd%d0%be%d0%b2%d0%ba%d0%b0-xanmod">Установка XanMod</a>
</h2><p>Однострочная команда по добавлению ядра <span class="shortcode shortcode-tag"><a href="/ru/tags/xanmod/" target="_blank">#XanMod</a></span> в репозиторий <span class="shortcode shortcode-tag"><a href="/ru/tags/debian/" target="_blank">#Debian</a></span>&rsquo;а приведена ниже. Она дробится на следующие под-команды:</p>
<ol>
<li>Добавление файла <code>xanmod-kernel.list</code> в директорию <code>/etc/apt/sources.list.d</code>.</li>
<li>Скачивание файла подписи <code>archive.key</code> и размещение его в директорию <code>/etc/apt/trusted.gpg.d</code> с названием <code>xanmod-kernel.gpg</code>.</li>
<li>Обновление информации из репозитория при помощи команды <code>apt update</code>.</li>
</ol>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-0
shortcode-codeblock-bash">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-6afb51d68bf3ca8503a6b98350eb86d3" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="nb">echo</span> <span class="s1">&#39;deb [signed-by=/etc/apt/trusted.gpg.d/xanmod-kernel.gpg] http://deb.xanmod.org releases main&#39;</span> <span class="p">|</span> tee /etc/apt/sources.list.d/xanmod-kernel.list <span class="o">&amp;&amp;</span> curl -fsSL <span class="s1">&#39;https://dl.xanmod.org/archive.key&#39;</span> <span class="p">|</span> gpg --dearmor <span class="p">|</span> tee /etc/apt/trusted.gpg.d/xanmod-kernel.gpg &gt; /dev/null <span class="o">&amp;&amp;</span> apt update</span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-6afb51d68bf3ca8503a6b98350eb86d3"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<p>После выполнения вышеприведённой команды, установка ядра <span class="shortcode shortcode-tag"><a href="/ru/tags/xanmod/" target="_blank">#XanMod</a></span> происходит таким образом:</p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-1
shortcode-codeblock-bash">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-eeb557e5ad2f4e905f1ed3553f7781c6" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">apt install linux-xanmod-<span class="o">[</span>ABI<span class="o">]</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-eeb557e5ad2f4e905f1ed3553f7781c6"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<p>Где:</p>
<ul>
<li><code>[ABI]</code> - версия архитектуры. Список версий архитектур можно посмотреть ниже.</li>
</ul>
<h3 id="примеры">
  <a class="link-body-emphasis" href="#%d0%bf%d1%80%d0%b8%d0%bc%d0%b5%d1%80%d1%8b">Примеры</a>
</h3><p>Установить ядро <span class="shortcode shortcode-tag"><a href="/ru/tags/xanmod/" target="_blank">#XanMod</a></span> с версией архитектуры <code>x64v1</code>:</p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-2
shortcode-codeblock-bash">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-4d9bf1857945c02422f78ff17e6eae87" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">apt install linux-xanmod-x64v1</span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-4d9bf1857945c02422f78ff17e6eae87"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<p>Установить ядро <span class="shortcode shortcode-tag"><a href="/ru/tags/xanmod/" target="_blank">#XanMod</a></span> с версией архитектуры <code>x64v2</code>:</p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-3
shortcode-codeblock-bash">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-56def606052321863b1d34477e43a671" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">apt install linux-xanmod-x64v2</span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-56def606052321863b1d34477e43a671"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<p>Установить ядро <span class="shortcode shortcode-tag"><a href="/ru/tags/xanmod/" target="_blank">#XanMod</a></span> с версией архитектуры <code>x64v3</code>:</p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-4
shortcode-codeblock-bash">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-667307d5693113b69172ff4374a485d9" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">apt install linux-xanmod-x64v3</span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-667307d5693113b69172ff4374a485d9"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<p>Установить ядро <span class="shortcode shortcode-tag"><a href="/ru/tags/xanmod/" target="_blank">#XanMod</a></span> с версией архитектуры <code>x64v4</code>:</p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-5
shortcode-codeblock-bash">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-00e01577cdf383df7b9bc58fd785485d" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">apt install linux-xanmod-x64v4</span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-00e01577cdf383df7b9bc58fd785485d"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<p>Для установки Mainline-версии ядра команда будет такой:</p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-6
shortcode-codeblock-bash">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-fa970bcb0bca3eb048b12edc45a41d3c" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">apt install linux-xanmod-edge-x64v3</span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-fa970bcb0bca3eb048b12edc45a41d3c"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<h2 id="версии-архитектур-xanmod">
  <a class="link-body-emphasis" href="#%d0%b2%d0%b5%d1%80%d1%81%d0%b8%d0%b8-%d0%b0%d1%80%d1%85%d0%b8%d1%82%d0%b5%d0%ba%d1%82%d1%83%d1%80-xanmod">Версии архитектур XanMod</a>
</h2><p>Версия архитектуры зависит от ядра процессора и поддерживаемых им инструкций. Версию архитектуры можно узнать из списка ниже.</p>
<h3 id="x86-64-legacy">
  <a class="link-body-emphasis" href="#x86-64-legacy">x86-64 (LEGACY)</a>
</h3><p>Суффикс для установки ядра: <code>x64v1</code>.</p>
<p><strong>Поддерживаемые архитектуры:</strong></p>
<ul>
<li>AMD K8-family</li>
<li>AMD K10-family</li>
<li>AMD Family 10h (Barcelona)</li>
<li>Intel Pentium 4 / Xeon (Nocona)</li>
<li>Intel Core 2 (all variants)</li>
<li>All x86-64 CPUs</li>
</ul>
<h3 id="x86-64-v2">
  <a class="link-body-emphasis" href="#x86-64-v2">x86-64-v2</a>
</h3><p>Суффикс для установки ядра: <code>x64v2</code>.</p>
<p><strong>Поддерживаемые архитектуры:</strong></p>
<ul>
<li>AMD Family 14h (Bobcat)</li>
<li>AMD Family 16h (Jaguar)</li>
<li>AMD Family 15h (Bulldozer)</li>
<li>AMD Family 15h (Piledriver)</li>
<li>AMD Family 15h (Steamroller)</li>
<li>Intel 1st Gen Core (Nehalem)</li>
<li>Intel 1.5 Gen Core (Westmere)</li>
<li>Intel 2nd Gen Core (Sandybridge)</li>
<li>Intel 3rd Gen Core (Ivybridge)</li>
<li>Intel low-power Silvermont</li>
<li>Intel Goldmont (Apollo Lake)</li>
<li>Intel Goldmont (Denverton)</li>
<li>Intel Goldmont Plus (Gemini Lake)</li>
</ul>
<h3 id="x86-64-v3">
  <a class="link-body-emphasis" href="#x86-64-v3">x86-64-v3</a>
</h3><p>Суффикс для установки ядра: <code>x64v3</code>.</p>
<p><strong>Поддерживаемые архитектуры:</strong></p>
<ul>
<li>AMD Family 15h (Excavator)</li>
<li>AMD Family 17h (Zen)</li>
<li>AMD Family 17h (Zen+)</li>
<li>AMD Family 17h (Zen2)</li>
<li>AMD Family 19h (Zen3)</li>
<li>Intel 4th Gen Core (Haswell)</li>
<li>Intel 5th Gen Core (Broadwell)</li>
<li>Intel 6th Gen Core (Skylake)</li>
<li>Intel 7th Gen Core (Kaby Lake)</li>
<li>Intel 8/9th Gen Core (Coffee Lake)</li>
<li>Intel 10th Gen Core (Comet Lake)</li>
<li>Intel 12th Gen (Alder Lake)</li>
<li>Intel 13th Gen (Raptor Lake)</li>
<li>Intel 14th Gen (Meteor Lake)</li>
</ul>
<h3 id="x86-64-v4-avx-512">
  <a class="link-body-emphasis" href="#x86-64-v4-avx-512">x86-64-v4 (AVX-512)</a>
</h3><p>Суффикс для установки ядра: <code>x64v4</code>.</p>
<p><strong>Поддерживаемые архитектуры:</strong></p>
<ul>
<li>AMD Family 19h (Zen4)</li>
<li>Intel 6th Gen Core (Skylake X)</li>
<li>Intel 8th Gen Core i3 (Cannon Lake)</li>
<li>Intel Xeon / 10th Gen Core (Ice Lake)</li>
<li>Intel Xeon (Cascade Lake)</li>
<li>Intel Xeon (Cooper Lake)</li>
<li>Intel 3rd Gen 10nm++ (Tiger Lake)</li>
<li>Intel 4th Gen 10nm++ (Sapphire Rapids)</li>
<li>Intel 5th Gen 10nm++ (Emerald Rapids)</li>
<li>Intel 11th Gen (Rocket Lake)</li>
</ul>]]></turbo:content></item><item turbo="true"><title>Установка Vivaldi в Debian</title><link>https://lib.onl/ru/2022/01/ddddd243-d182-5e26-a161-d2ea7812214a/</link><pubDate>Thu, 13 Jan 2022 22:44:01 +0000</pubDate><dc:creator>Kai Kimera</dc:creator><category>Linux</category><yandex:related><link url="https://lib.onl/ru/2021/09/581804b8-0613-52a8-a5c4-fdae90e7bc8a/">Чёрный экран с курсором при старте GDM</link><link url="https://lib.onl/ru/2021/09/1cf305cd-85d0-5e02-aabb-e01346bfee0f/">Proxmox VE: Установка на Debian 11 (Bullseye)</link><link url="https://lib.onl/ru/2021/09/ff829d15-4a19-52e3-a3aa-ad70aa38854a/">Debian: Wired Networks are Unmanaged</link><link url="https://lib.onl/ru/2021/09/b2caccc7-92bf-57ed-970f-136c546f18e2/">Распаковка пакетов DEB / RPM</link><link url="https://lib.onl/ru/2021/09/43b40b92-c29a-504b-87fa-5eac368dcf95/">Отключение установки дополнительных пакетов в Debian APT</link><link url="https://lib.onl/ru/2021/09/aeed7c90-003a-532a-b2c4-3807aaee88fa/">dhclient отправляет 36-значный идентификатор вместо MAC</link><link url="https://lib.onl/ru/2021/05/ee559a6c-5cde-5166-9d2d-3ceb55878eb8/">Debian: Статический IP-адрес</link></yandex:related><turbo:extendedHtml>true</turbo:extendedHtml><turbo:source>https://lib.onl/ru/2022/01/ddddd243-d182-5e26-a161-d2ea7812214a/</turbo:source><turbo:topic>Установка Vivaldi в Debian</turbo:topic><turbo:content><![CDATA[<p>Привет всем! В этой небольшой заметке я приведу команду, при помощи которой можно добавить репозиторий браузера <span class="shortcode shortcode-tag"><a href="/ru/tags/vivaldi/" target="_blank">#Vivaldi</a></span> в <span class="shortcode shortcode-tag"><a href="/ru/tags/debian/" target="_blank">#Debian</a></span>.</p>
<p>Установочный пакет <span class="shortcode shortcode-tag"><a href="/ru/tags/vivaldi/" target="_blank">#Vivaldi</a></span> уже выполняет указанные действия, но для этого он задействует утилиту <code>apt-key</code>, которая в <span class="shortcode shortcode-tag"><a href="/ru/tags/debian/" target="_blank">#Debian</a></span> 11 имеет статус <code>deprecated</code>.</p>
<p>Однострочная команда по добавлению <span class="shortcode shortcode-tag"><a href="/ru/tags/vivaldi/" target="_blank">#Vivaldi</a></span> в репозиторий <span class="shortcode shortcode-tag"><a href="/ru/tags/debian/" target="_blank">#Debian</a></span>&rsquo;а приведена ниже. Она дробится на следующие под-команды:</p>
<ol>
<li>Добавление файла <code>vivaldi-archive.list</code> в директорию <code>/etc/apt/sources.list.d</code>.</li>
<li>Скачивание файла подписи <code>linux_signing_key.pub</code> и размещение его в директорию <code>/etc/apt/trusted.gpg.d</code> с названием <code>vivaldi-browser.gpg</code>.</li>
<li>Обновление информации из репозитория при помощи команды <code>apt update</code>.</li>
</ol>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-0
shortcode-codeblock-bash">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-6dc98486f4d66ddc299ffe899a30afe1" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="nb">echo</span> <span class="s2">&#34;deb [signed-by=/etc/apt/trusted.gpg.d/vivaldi-browser.gpg arch=</span><span class="k">$(</span>dpkg --print-architecture<span class="k">)</span><span class="s2">] https://repo.vivaldi.com/archive/deb/ stable main&#34;</span> <span class="p">|</span> tee /etc/apt/sources.list.d/vivaldi-archive.list <span class="o">&amp;&amp;</span> curl -fsSL <span class="s1">&#39;https://repo.vivaldi.com/archive/linux_signing_key.pub&#39;</span> <span class="p">|</span> gpg --dearmor <span class="p">|</span> tee /etc/apt/trusted.gpg.d/vivaldi-browser.gpg &gt; /dev/null <span class="o">&amp;&amp;</span> apt update</span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-6dc98486f4d66ddc299ffe899a30afe1"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<p>После выполнения команды, установка <span class="shortcode shortcode-tag"><a href="/ru/tags/vivaldi/" target="_blank">#Vivaldi</a></span> происходит таким образом:</p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-1
shortcode-codeblock-bash">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-40eb2d26cb8142936154a6d4b94e7598" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">apt install vivaldi-stable</span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-40eb2d26cb8142936154a6d4b94e7598"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>]]></turbo:content></item><item turbo="true"><title>Чёрный экран с курсором при старте GDM</title><link>https://lib.onl/ru/2021/09/581804b8-0613-52a8-a5c4-fdae90e7bc8a/</link><pubDate>Thu, 30 Sep 2021 08:10:19 +0000</pubDate><dc:creator>Kai Kimera</dc:creator><category>Linux</category><yandex:related><link url="https://lib.onl/ru/2021/09/ff829d15-4a19-52e3-a3aa-ad70aa38854a/">Debian: Wired Networks are Unmanaged</link><link url="https://lib.onl/ru/2021/09/0d11ecc0-2714-5c5c-9b48-804f50419590/">Отключение режима Wayland в GDM</link><link url="https://lib.onl/ru/2021/09/1cf305cd-85d0-5e02-aabb-e01346bfee0f/">Proxmox VE: Установка на Debian 11 (Bullseye)</link><link url="https://lib.onl/ru/2021/09/b2caccc7-92bf-57ed-970f-136c546f18e2/">Распаковка пакетов DEB / RPM</link><link url="https://lib.onl/ru/2021/09/43b40b92-c29a-504b-87fa-5eac368dcf95/">Отключение установки дополнительных пакетов в Debian APT</link><link url="https://lib.onl/ru/2021/09/aeed7c90-003a-532a-b2c4-3807aaee88fa/">dhclient отправляет 36-значный идентификатор вместо MAC</link><link url="https://lib.onl/ru/2021/05/ee559a6c-5cde-5166-9d2d-3ceb55878eb8/">Debian: Статический IP-адрес</link><link url="https://lib.onl/ru/2021/03/0a815547-4f18-52a0-9a99-c463421872ca/">Monero Unit</link></yandex:related><turbo:extendedHtml>true</turbo:extendedHtml><turbo:source>https://lib.onl/ru/2021/09/581804b8-0613-52a8-a5c4-fdae90e7bc8a/</turbo:source><turbo:topic>Чёрный экран с курсором при старте GDM</turbo:topic><turbo:content><![CDATA[<p>На днях установил <span class="shortcode shortcode-tag"><a href="/ru/tags/debian/" target="_blank">#Debian</a></span> 11 на несколько ПК. Всё было отлично, кроме как на одном из ПК почему то <span class="shortcode shortcode-tag"><a href="/ru/tags/gdm/" target="_blank">#GDM</a></span> не стал загружаться. Чёрный экран с мигающем текстовым курсором&hellip;</p>
<p>На других ПК всё было нормально. Отличие проблемного ПК от остальных заключалось в том, что на проблемном ПК система была установлена на <span class="shortcode shortcode-tag"><a href="/ru/tags/ssd/" target="_blank">#SSD</a></span>. Может быть дело в этом. В интернете я нашёл похожую проблему. По сути, проблема заключается в том, что сам <span class="shortcode shortcode-tag"><a href="/ru/tags/gdm/" target="_blank">#GDM</a></span> запускается чуть раньше, чем начинается инициализация графической подсистемы. И на кой чёрт его несёт вперёд&hellip;</p>
<p>В общем, предлагают несколько решений.</p>
<h2 id="настройка-сервиса-gdm">
  <a class="link-body-emphasis" href="#%d0%bd%d0%b0%d1%81%d1%82%d1%80%d0%be%d0%b9%d0%ba%d0%b0-%d1%81%d0%b5%d1%80%d0%b2%d0%b8%d1%81%d0%b0-gdm">Настройка сервиса GDM</a>
</h2><p>Данный вариант решения проблемы предлагает отредактировать стартовые параметры сервиса <span class="shortcode shortcode-tag"><a href="/ru/tags/gdm/" target="_blank">#GDM</a></span>, чтобы тот запускался с небольшой задержкой и не лез вперёд остальной графической подсистемы.</p>
<p>В терминале нужно ввести от root&rsquo;а команду <code>systemctl edit gdm.service</code>, откроется редактор сервиса <span class="shortcode shortcode-tag"><a href="/ru/tags/gdm/" target="_blank">#GDM</a></span>. В нем необходимо добавить строку <code>ExecStartPre=/bin/sleep 2</code>, которая создаёт задержку перед запуском самого <span class="shortcode shortcode-tag"><a href="/ru/tags/gdm/" target="_blank">#GDM</a></span>. Примерно вот так:</p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-0
shortcode-codeblock-ini">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-7aa8642ab4b7297001a10c75f18333fa" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-ini" data-lang="ini"><span class="line"><span class="cl"><span class="c1">### Anything between here and the comment below will become the new contents of the file</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">[Service]</span>
</span></span><span class="line"><span class="cl"><span class="na">ExecStartPre</span><span class="o">=</span><span class="s">/bin/sleep 2</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">### Lines below this comment will be discarded</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-7aa8642ab4b7297001a10c75f18333fa"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<p>Таким образом GDM начинает запускаться после того, как инициализируется графическая подсистема.</p>
<p>Ещё одно исправление <a title="" href="https://gitlab.gnome.org/GNOME/gdm/-/issues/662#note_993169" target="_blank"
   rel="noopener noreferrer">предложили</a> в баг-трекере <span class="shortcode shortcode-tag"><a href="/ru/tags/gnome/" target="_blank">#GNOME</a></span> / <span class="shortcode shortcode-tag"><a href="/ru/tags/gdm/" target="_blank">#GDM</a></span>. Вместо торможения загрузки GDM, необходимо добавить следующие строки:</p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-1
shortcode-codeblock-ini">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-792ae39eb49da87182f2e571eaa68cec" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-ini" data-lang="ini"><span class="line"><span class="cl"><span class="k">[Unit]</span>
</span></span><span class="line"><span class="cl"><span class="na">Wants</span><span class="o">=</span><span class="s">systemd-udev-trigger.service systemd-udev-settle.service</span>
</span></span><span class="line"><span class="cl"><span class="na">After</span><span class="o">=</span><span class="s">systemd-udev-trigger.service systemd-udev-settle.service</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-792ae39eb49da87182f2e571eaa68cec"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<p>Но это не совсем корректное исправление (хотя исправление, изложенное выше, тоже трудно назвать правильным), так как после применения этих строк, появляется ошибка:</p>











<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-2 shortcode-codeblock-terminal
shortcode-codeblock-terminal-linux
shortcode-codeblock-terminal-linux-user">
  <div class="card overflow-hidden" data-bs-theme="dark">
    <div class="card-header">
      <div class="d-flex align-items-center">
        <div class="flex-shrink-0 ">
          <i class="fas fa-terminal fa-fw"></i>
        </div>
        <div class="flex-grow-1 mx-2">
          <h5 class="mb-0">Терминал</h5>
        </div>
        <div class="flex-shrink-0">
          <ul class="list-inline mb-0">
            <li class="list-inline-item" title='Копировать'>
              <a class="text-body" href="#"
                 data-fn="clipboard" data-clipboard-target="#cp-106a51b02e427d451aee7afd543ad257"
                 role="button" aria-label='Копировать'>
                <i class="fas fa-copy fa-fw"></i>
              </a>
            </li>
          </ul>
        </div>
      </div>
    </div>
    <div class="card-body p-0 overflow-auto" id="cp-106a51b02e427d451aee7afd543ad257"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-plaintext" data-lang="plaintext"><span class="line"><span class="cl">Dec 27 22:23:48 oleksandr-xps15 udevadm[260]: systemd-udev-settle.service is deprecated. Please fix gdm.service not to pull it in.</span></span></code></pre></td></tr></table>
</div>
</div></div>
  </div>
</div>
<h2 id="указание-порядка-инициализации-графической-подсистемы">
  <a class="link-body-emphasis" href="#%d1%83%d0%ba%d0%b0%d0%b7%d0%b0%d0%bd%d0%b8%d0%b5-%d0%bf%d0%be%d1%80%d1%8f%d0%b4%d0%ba%d0%b0-%d0%b8%d0%bd%d0%b8%d1%86%d0%b8%d0%b0%d0%bb%d0%b8%d0%b7%d0%b0%d1%86%d0%b8%d0%b8-%d0%b3%d1%80%d0%b0%d1%84%d0%b8%d1%87%d0%b5%d1%81%d0%ba%d0%be%d0%b9-%d0%bf%d0%be%d0%b4%d1%81%d0%b8%d1%81%d1%82%d0%b5%d0%bc%d1%8b">Указание порядка инициализации графической подсистемы</a>
</h2><p>Этот вариант решения проблемы подходит для <strong>Arch Linux</strong>. Необходимо в файле <code>/etc/mkinitcpio.conf</code> добавить в массив <code>MODULES</code> свою графическую подсистему, чтобы та запускалась раньше, чем <span class="shortcode shortcode-tag"><a href="/ru/tags/gdm/" target="_blank">#GDM</a></span>. Например:</p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-3
shortcode-codeblock-text">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-568a2154be628f3b412a258c0ac419e2" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-text" data-lang="text"><span class="line"><span class="cl">MODULES=(amdgpu)</span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-568a2154be628f3b412a258c0ac419e2"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<p>Можно указать другие графические подсистемы, всё зависит от видеокарты, установленной в ПК:</p>
<ul>
<li><code>amdgpu</code> - для современных видеокарт AMD.</li>
<li><code>radeon</code> - для устаревших видеокарт AMD.</li>
<li><code>nouveau</code> - для Nvidia Nouveau.</li>
<li><code>i915</code> - для Intel.</li>
<li><code>mgag200</code> - для видеокарт Matrox.</li>
</ul>
<p>Если в системе используется <span class="shortcode shortcode-tag"><a href="/ru/tags/intel/" target="_blank">#Intel</a></span> в качестве графики и в модулях прописан <code>i915</code>, то могут появится ошибки <span class="shortcode shortcode-tag">ACPI</span>. Для исправления этих ошибок необходимо добавить <code>intel_agp</code> перед <code>i915</code>. Чтобы проверить корректность загрузки модуля, можно ввести команду <code>lsmod | grep intel_agp</code>.</p>]]></turbo:content></item><item turbo="true"><title>Отключение режима Wayland в GDM</title><link>https://lib.onl/ru/2021/09/0d11ecc0-2714-5c5c-9b48-804f50419590/</link><pubDate>Thu, 30 Sep 2021 07:51:30 +0000</pubDate><dc:creator>Kai Kimera</dc:creator><category>Linux</category><turbo:extendedHtml>true</turbo:extendedHtml><turbo:source>https://lib.onl/ru/2021/09/0d11ecc0-2714-5c5c-9b48-804f50419590/</turbo:source><turbo:topic>Отключение режима Wayland в GDM</turbo:topic><turbo:content><![CDATA[<p>Использовать <span class="shortcode shortcode-tag"><a href="/ru/tags/wayland/" target="_blank">#Wayland</a></span> мне, пока что, нет необходимости. Поэтому, я решил его отключить в <span class="shortcode shortcode-tag"><a href="/ru/tags/gdm/" target="_blank">#GDM</a></span>.</p>
<p>Для того, чтобы отключить выбор режима <span class="shortcode shortcode-tag"><a href="/ru/tags/wayland/" target="_blank">#Wayland</a></span> в <span class="shortcode shortcode-tag"><a href="/ru/tags/gdm/" target="_blank">#GDM</a></span>, необходимо в файле <code>/etc/gdm3/daemon.conf</code> раскомментировать строку:</p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-0
shortcode-codeblock-ini">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-73cf63bcbd5c2203d96dff9be76a4e4d" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-ini" data-lang="ini"><span class="line"><span class="cl"><span class="c1"># WaylandEnable=false</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-73cf63bcbd5c2203d96dff9be76a4e4d"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<p>Должно получится так:</p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-1
shortcode-codeblock-ini">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-0948462f2dec8b0f216af802cb803cf4" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-ini" data-lang="ini"><span class="line"><span class="cl"><span class="na">WaylandEnable</span><span class="o">=</span><span class="s">false</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-0948462f2dec8b0f216af802cb803cf4"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<p>Таким образом даём понять <span class="shortcode shortcode-tag"><a href="/ru/tags/gdm/" target="_blank">#GDM</a></span>, что мы не желаем использовать <span class="shortcode shortcode-tag"><a href="/ru/tags/wayland/" target="_blank">#Wayland</a></span>.</p>]]></turbo:content></item><item turbo="true"><title>Proxmox VE: Установка на Debian 11 (Bullseye)</title><link>https://lib.onl/ru/2021/09/1cf305cd-85d0-5e02-aabb-e01346bfee0f/</link><pubDate>Sun, 12 Sep 2021 21:36:02 +0000</pubDate><dc:creator>Kai Kimera</dc:creator><category>Linux</category><category>В доработке</category><yandex:related><link url="https://lib.onl/ru/2021/09/ff829d15-4a19-52e3-a3aa-ad70aa38854a/">Debian: Wired Networks are Unmanaged</link><link url="https://lib.onl/ru/2021/09/b2caccc7-92bf-57ed-970f-136c546f18e2/">Распаковка пакетов DEB / RPM</link><link url="https://lib.onl/ru/2021/09/43b40b92-c29a-504b-87fa-5eac368dcf95/">Отключение установки дополнительных пакетов в Debian APT</link><link url="https://lib.onl/ru/2021/09/aeed7c90-003a-532a-b2c4-3807aaee88fa/">dhclient отправляет 36-значный идентификатор вместо MAC</link><link url="https://lib.onl/ru/2021/05/ee559a6c-5cde-5166-9d2d-3ceb55878eb8/">Debian: Статический IP-адрес</link></yandex:related><turbo:extendedHtml>true</turbo:extendedHtml><turbo:source>https://lib.onl/ru/2021/09/1cf305cd-85d0-5e02-aabb-e01346bfee0f/</turbo:source><turbo:topic>Proxmox VE: Установка на Debian 11 (Bullseye)</turbo:topic><turbo:content><![CDATA[<p>В этой небольшой заметке, я расскажу как установить <span class="shortcode shortcode-tag"><a href="/ru/tags/proxmox/" target="_blank">#Proxmox</a></span> VE на чистый <span class="shortcode shortcode-tag"><a href="/ru/tags/debian/" target="_blank">#Debian</a></span> 11 (<span class="shortcode shortcode-tag">Bullseye</span>).</p>
<h2 id="подготовка">
  <a class="link-body-emphasis" href="#%d0%bf%d0%be%d0%b4%d0%b3%d0%be%d1%82%d0%be%d0%b2%d0%ba%d0%b0">Подготовка</a>
</h2><p>Для начала необходимо отредактировать файл <code>/etc/hosts</code>, прописав туда IP сервера, на который будет устанавливаться наш <span class="shortcode shortcode-tag"><a href="/ru/tags/proxmox/" target="_blank">#Proxmox</a></span> VE:</p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-0
shortcode-codeblock-text">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-eb6bd58eda1d77fd8f1b9e5d4adc81e6" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-text" data-lang="text"><span class="line"><span class="cl">127.0.0.1   localhost
</span></span><span class="line"><span class="cl">127.0.1.1   localhost.localdomain     localhost
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"># Proxmox
</span></span><span class="line"><span class="cl">10.0.1.1    srv-vm.home.local         srv-vm</span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-eb6bd58eda1d77fd8f1b9e5d4adc81e6"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<p>Для проверки, можно выполнить команду <code>hostname --ip-address</code>, которая вернёт IP сервера, указанного в <code>/etc/hosts</code> выше.</p>
<h2 id="добавление-репозиториев">
  <a class="link-body-emphasis" href="#%d0%b4%d0%be%d0%b1%d0%b0%d0%b2%d0%bb%d0%b5%d0%bd%d0%b8%d0%b5-%d1%80%d0%b5%d0%bf%d0%be%d0%b7%d0%b8%d1%82%d0%be%d1%80%d0%b8%d0%b5%d0%b2">Добавление репозиториев</a>
</h2><p>Добавим репозиторий <span class="shortcode shortcode-tag"><a href="/ru/tags/proxmox/" target="_blank">#Proxmox</a></span> VE:</p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-1
shortcode-codeblock-bash">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-adea80161a70fe4e4fa61660595b97a3" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="nb">echo</span> <span class="s2">&#34;deb [arch=amd64] http://download.proxmox.com/debian/pve bullseye pve-no-subscription&#34;</span> &gt; /etc/apt/sources.list.d/pve.list</span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-adea80161a70fe4e4fa61660595b97a3"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<p>Скачаем и установим ключ репозитория:</p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-2
shortcode-codeblock-bash">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-5b913dc2ba513ce45be979c004f6d5bf" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">curl <span class="s1">&#39;https://enterprise.proxmox.com/debian/proxmox-release-bullseye.gpg&#39;</span> -o /etc/apt/trusted.gpg.d/pve.gpg</span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-5b913dc2ba513ce45be979c004f6d5bf"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<p>Обновим базу пакетов <span class="shortcode shortcode-tag"><a href="/ru/tags/apt/" target="_blank">#APT</a></span> и саму систему:</p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-3
shortcode-codeblock-bash">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-03a42c5aeb5ce548769b7360264dc630" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">apt update <span class="o">&amp;&amp;</span> apt full-upgrade</span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-03a42c5aeb5ce548769b7360264dc630"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<h2 id="установка-пакетов">
  <a class="link-body-emphasis" href="#%d1%83%d1%81%d1%82%d0%b0%d0%bd%d0%be%d0%b2%d0%ba%d0%b0-%d0%bf%d0%b0%d0%ba%d0%b5%d1%82%d0%be%d0%b2">Установка пакетов</a>
</h2><p>Начнём установку пакетов командой:</p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-4
shortcode-codeblock-bash">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-53dc99a8ed63ebc227f8a9acfc2ab799" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">apt install proxmox-ve postfix open-iscsi</span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-53dc99a8ed63ebc227f8a9acfc2ab799"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<p>Стоит заметить, что устанавливается <span class="shortcode shortcode-tag"><a href="/ru/tags/postfix/" target="_blank">#Postfix</a></span>, он необходим для отправки писем от <span class="shortcode shortcode-tag"><a href="/ru/tags/proxmox/" target="_blank">#Proxmox</a></span> VE. Но мне в локальной сети такая функция не нужна. При установке, <span class="shortcode shortcode-tag"><a href="/ru/tags/postfix/" target="_blank">#Postfix</a></span> спросит в каком режиме ему необходимо будет работать. Я выбираю <strong>local only</strong>.</p>
<h2 id="исправление-ошибок">
  <a class="link-body-emphasis" href="#%d0%b8%d1%81%d0%bf%d1%80%d0%b0%d0%b2%d0%bb%d0%b5%d0%bd%d0%b8%d0%b5-%d0%be%d1%88%d0%b8%d0%b1%d0%be%d0%ba">Исправление ошибок</a>
</h2><p>После установки <span class="shortcode shortcode-tag"><a href="/ru/tags/proxmox/" target="_blank">#Proxmox</a></span> VE через пакетны менеджер <span class="shortcode shortcode-tag"><a href="/ru/tags/apt/" target="_blank">#APT</a></span>, я столкнулся с некоторыми проблемами. Не знаю, может быть они будут отсутствовать, если устанавливать <span class="shortcode shortcode-tag"><a href="/ru/tags/proxmox/" target="_blank">#Proxmox</a></span> VE при помощи его отдельного файла <span class="shortcode shortcode-tag">ISO</span>&hellip;</p>
<h3 id="lvm2-activation-generator-lvmconfig-failed">
  <a class="link-body-emphasis" href="#lvm2-activation-generator-lvmconfig-failed">lvm2-activation-generator: lvmconfig failed</a>
</h3><p>Для исправления ошибки <code>lvm2-activation-generator: lvmconfig failed</code>, необходимо в файле <code>/etc/lvm/lvm.conf</code> изменить параметр <code>event_activation</code>, а именно рас-комментировать и установить в <code>0</code>:</p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-5
shortcode-codeblock-text">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-c5f1b3bb5c5cf5be7c9a5936a93036b4" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-text" data-lang="text"><span class="line"><span class="cl">global {
</span></span><span class="line"><span class="cl">  &lt;...&gt;
</span></span><span class="line"><span class="cl">  # Configuration option global/event_activation.
</span></span><span class="line"><span class="cl">  # Activate LVs based on system-generated device events.
</span></span><span class="line"><span class="cl">  # When a device appears on the system, a system-generated event runs
</span></span><span class="line"><span class="cl">  # the pvscan command to activate LVs if the new PV completes the VG.
</span></span><span class="line"><span class="cl">  # Use auto_activation_volume_list to select which LVs should be
</span></span><span class="line"><span class="cl">  # activated from these events (the default is all.)
</span></span><span class="line"><span class="cl">  # When event_activation is disabled, the system will generally run
</span></span><span class="line"><span class="cl">  # a direct activation command to activate LVs in complete VGs.
</span></span><span class="line"><span class="cl">  # This configuration option has an automatic default value.
</span></span><span class="line"><span class="cl">  # event_activation = 1
</span></span><span class="line"><span class="cl">  &lt;...&gt;
</span></span><span class="line"><span class="cl">}</span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-c5f1b3bb5c5cf5be7c9a5936a93036b4"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>











  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-6
shortcode-codeblock-text">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-b93ac81be9b026b08ed721d332453357" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-text" data-lang="text"><span class="line"><span class="cl">global {
</span></span><span class="line"><span class="cl">  &lt;...&gt;
</span></span><span class="line"><span class="cl">  # Configuration option global/event_activation.
</span></span><span class="line"><span class="cl">  # Activate LVs based on system-generated device events.
</span></span><span class="line"><span class="cl">  # When a device appears on the system, a system-generated event runs
</span></span><span class="line"><span class="cl">  # the pvscan command to activate LVs if the new PV completes the VG.
</span></span><span class="line"><span class="cl">  # Use auto_activation_volume_list to select which LVs should be
</span></span><span class="line"><span class="cl">  # activated from these events (the default is all.)
</span></span><span class="line"><span class="cl">  # When event_activation is disabled, the system will generally run
</span></span><span class="line"><span class="cl">  # a direct activation command to activate LVs in complete VGs.
</span></span><span class="line"><span class="cl">  # This configuration option has an automatic default value.
</span></span><span class="line"><span class="cl">  event_activation = 0
</span></span><span class="line"><span class="cl">  &lt;...&gt;
</span></span><span class="line"><span class="cl">}</span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-b93ac81be9b026b08ed721d332453357"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<h3 id="не-поднимается--интерфейс">
  <a class="link-body-emphasis" href="#%d0%bd%d0%b5-%d0%bf%d0%be%d0%b4%d0%bd%d0%b8%d0%bc%d0%b0%d0%b5%d1%82%d1%81%d1%8f--%d0%b8%d0%bd%d1%82%d0%b5%d1%80%d1%84%d0%b5%d0%b9%d1%81">Не поднимается  интерфейс</a>
</h3><p>После установки, у меня перестал автоматически подниматься сетевой интерфейс. Может быть, в отдельном образе <span class="shortcode shortcode-tag">ISO</span> <span class="shortcode shortcode-tag"><a href="/ru/tags/proxmox/" target="_blank">#Proxmox</a></span> VE такой проблемы нет, потому что при установке с отдельного образа <span class="shortcode shortcode-tag">ISO</span>, он запрашивает у администратора параметры сети. Но если устанавливать <span class="shortcode shortcode-tag"><a href="/ru/tags/proxmox/" target="_blank">#Proxmox</a></span> VE через пакетную систему Debian, то никаких запросов не появляется. В общем, я сделал так (<code>/etc/network/interfaces</code>):</p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-7
shortcode-codeblock-text">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-68562d80893598ffd002a84c2f64dedc" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-text" data-lang="text"><span class="line"><span class="cl">auto lo
</span></span><span class="line"><span class="cl">iface lo inet loopback
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">iface enp3s0 inet manual
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">auto vmbr0
</span></span><span class="line"><span class="cl">iface vmbr0 inet static
</span></span><span class="line"><span class="cl">  address 10.0.1.1/16
</span></span><span class="line"><span class="cl">  gateway 10.0.0.1
</span></span><span class="line"><span class="cl">  bridge-ports enp3s0
</span></span><span class="line"><span class="cl">  bridge-stp off
</span></span><span class="line"><span class="cl">  bridge-fd 0</span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-68562d80893598ffd002a84c2f64dedc"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<p>Конкретно, тут я добавил блок виртуального соединения:</p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-8
shortcode-codeblock-text">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-bd235e58ada8acab5c1dbc1d20a84d77" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-text" data-lang="text"><span class="line"><span class="cl">auto vmbr0
</span></span><span class="line"><span class="cl">iface vmbr0 inet static
</span></span><span class="line"><span class="cl">  address 10.0.1.1/16
</span></span><span class="line"><span class="cl">  gateway 10.0.0.1
</span></span><span class="line"><span class="cl">  bridge-ports enp3s0
</span></span><span class="line"><span class="cl">  bridge-stp off
</span></span><span class="line"><span class="cl">  bridge-fd 0</span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-bd235e58ada8acab5c1dbc1d20a84d77"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<p>Где указал мост с физической картой <code>enp3s0</code>. Саму же карту <code>enp3s0</code> я перевёл в режим <code>manual</code>. После этого, сетевой интерфейс на сервере заработал в штатном режиме.</p>
<p>На этом консольная настройка сервера виртуализации закончена. Настройка самого <span class="shortcode shortcode-tag"><a href="/ru/tags/proxmox/" target="_blank">#Proxmox</a></span>&rsquo;а можно выполнять уже в удобном web-интерфейсе.</p>]]></turbo:content></item><item turbo="true"><title>Debian: Wired Networks are Unmanaged</title><link>https://lib.onl/ru/2021/09/ff829d15-4a19-52e3-a3aa-ad70aa38854a/</link><pubDate>Thu, 09 Sep 2021 19:14:12 +0000</pubDate><dc:creator>Kai Kimera</dc:creator><category>Linux</category><yandex:related><link url="https://lib.onl/ru/2021/09/b2caccc7-92bf-57ed-970f-136c546f18e2/">Распаковка пакетов DEB / RPM</link><link url="https://lib.onl/ru/2021/09/43b40b92-c29a-504b-87fa-5eac368dcf95/">Отключение установки дополнительных пакетов в Debian APT</link><link url="https://lib.onl/ru/2021/09/aeed7c90-003a-532a-b2c4-3807aaee88fa/">dhclient отправляет 36-значный идентификатор вместо MAC</link><link url="https://lib.onl/ru/2021/05/ee559a6c-5cde-5166-9d2d-3ceb55878eb8/">Debian: Статический IP-адрес</link><link url="https://lib.onl/ru/2021/03/0a815547-4f18-52a0-9a99-c463421872ca/">Monero Unit</link></yandex:related><turbo:extendedHtml>true</turbo:extendedHtml><turbo:source>https://lib.onl/ru/2021/09/ff829d15-4a19-52e3-a3aa-ad70aa38854a/</turbo:source><turbo:topic>Debian: Wired Networks are Unmanaged</turbo:topic><turbo:content><![CDATA[<p>При базовой установке <span class="shortcode shortcode-tag"><a href="/ru/tags/debian/" target="_blank">#Debian</a></span>, Network Manager не устанавливается и, соответственно, он не управляет сетевой конфигурацией. Исправим данную ситуацию&hellip;</p>
<p>Лично я люблю ставить систему в минимальной комплектации. У меня есть <a title="" href="https://uaik.github.io/" target="_blank"
   rel="noopener noreferrer">отдельный ресурс</a> со сценариями автоматической установки. Это шаблоны, которые позволяют поставить систему в автоматическом режиме и с минимальным набором компонентов. В основном, такие шаблоны полезны для серверов. Однако, для домашнего компьютера тоже вполне подойдут. Но после установки домашней системы через такой шаблон, потребуется небольшая корректировка.</p>
<p>Итак, установим Network Manager при помощи пакетного менеджера <span class="shortcode shortcode-tag"><a href="/ru/tags/apt/" target="_blank">#APT</a></span>:</p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-0
shortcode-codeblock-bash">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-df6de2da85c49bdf04053d9b3a37c487" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">apt install network-manager</span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-df6de2da85c49bdf04053d9b3a37c487"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<p>Но этого недостаточно. Система будет говорить, что &ldquo;Wired Networks are Unmanaged&rdquo;, потому что всё ещё сетевой конфигурацией управляет не Network Manager. Для исправления этой ситуации, необходимо в <code>/etc/NetworkManager/NetworkManager.conf</code> изменить <code>managed=false</code> на <code>managed=true</code>.</p>
<p>Далее, перезапустить службу:</p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-1
shortcode-codeblock-bash">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-bd6ca913e080db003de0523a3d8e8618" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">service NetworkManager restart</span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-bd6ca913e080db003de0523a3d8e8618"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<p>На этом всё. Теперь сетевой конфигурацией управляет Network Manager.</p>]]></turbo:content></item><item turbo="true"><title>Распаковка пакетов DEB / RPM</title><link>https://lib.onl/ru/2021/09/b2caccc7-92bf-57ed-970f-136c546f18e2/</link><pubDate>Wed, 08 Sep 2021 09:39:36 +0000</pubDate><dc:creator>Kai Kimera</dc:creator><category>Linux</category><yandex:related><link url="https://lib.onl/ru/2021/09/43b40b92-c29a-504b-87fa-5eac368dcf95/">Отключение установки дополнительных пакетов в Debian APT</link><link url="https://lib.onl/ru/2021/09/aeed7c90-003a-532a-b2c4-3807aaee88fa/">dhclient отправляет 36-значный идентификатор вместо MAC</link><link url="https://lib.onl/ru/2021/05/0acd3f9d-07b7-52b8-9fac-b5cb1cc579e0/">Обновление Fedora Linux до актуальной версии</link><link url="https://lib.onl/ru/2021/05/ee559a6c-5cde-5166-9d2d-3ceb55878eb8/">Debian: Статический IP-адрес</link><link url="https://lib.onl/ru/2020/06/59781965-afe7-5dd5-9798-d1c5ba6cdafd/">Первичная настройка UAIK</link></yandex:related><turbo:extendedHtml>true</turbo:extendedHtml><turbo:source>https://lib.onl/ru/2021/09/b2caccc7-92bf-57ed-970f-136c546f18e2/</turbo:source><turbo:topic>Распаковка пакетов DEB / RPM</turbo:topic><turbo:content><![CDATA[<p>Я собираю пакеты для <span class="shortcode shortcode-tag"><a href="/ru/tags/debian/" target="_blank">#Debian</a></span> и <span class="shortcode shortcode-tag"><a href="/ru/tags/rhel/" target="_blank">#RHEL</a></span>. И зачастую, мне необходимо посмотреть содержимое собранного пакета, чтобы удостоверится в правильности сборки и корректности расположения файлов внутри пакета. В этой статье кратно расскажу, как и при помощи чего можно посмотреть собранные пакеты.</p>
<h2 id="deb">
  <a class="link-body-emphasis" href="#deb">DEB</a>
</h2><p>Пакет <code>.deb</code> архивируется при помощи <a title="" href="https://en.wikipedia.org/wiki/Ar_%28Unix%29" target="_blank"
   rel="noopener noreferrer">ar</a>. Соответственно, распаковать пакет тоже следует через данный архиватор:</p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-0
shortcode-codeblock-bash">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-0987043886aa6bf6100a02e9d3051655" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">ar x example.deb</span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-0987043886aa6bf6100a02e9d3051655"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<ul>
<li><code>debian-binary</code> – файл, содержащий версию формата <code>.deb</code>.</li>
<li><code>control.tar.xz</code> – файл, содержащий md5sums и директорию для сборки пакета.</li>
<li><code>data.tar.xz</code> – архив, содержащий все файлы, которые должны быть установлены в системе при установке пакета.</li>
</ul>
<h2 id="rpm">
  <a class="link-body-emphasis" href="#rpm">RPM</a>
</h2><p>Пакет <code>.rpm</code> содержит архив <code>cpio</code>. Имеется удобная утилита <code>rpm2cpio</code>, которая преобразует <code>.rpm</code> в архив <code>cpio</code>.</p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-1
shortcode-codeblock-bash">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-1f8856d6c94f776f1eb697ede83e77fc" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">rpm2cpio myrpmfile.rpm
</span></span><span class="line"><span class="cl">rpm2cpio - &lt; myrpmfile.rpm
</span></span><span class="line"><span class="cl">rpm2cpio myrpmfile.rpm <span class="p">|</span> cpio -idmv</span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-1f8856d6c94f776f1eb697ede83e77fc"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<p>Опции <code>rpm2cpio</code>:</p>
<ul>
<li><code>-i</code> - восстановить архив.</li>
<li><code>-d</code> - создать необходимые каталоги.</li>
<li><code>-m</code> - сохранить время модификации файлов.</li>
<li><code>-v</code> - подробный вывод процесса преобразования.</li>
</ul>
<p>Также, просматривать <code>.rpm</code> можно при помощи файлового менеджера Midnight Commander (<span class="shortcode shortcode-tag">MC</span>) (<code>mc</code>).</p>]]></turbo:content></item><item turbo="true"><title>Отключение установки дополнительных пакетов в Debian APT</title><link>https://lib.onl/ru/2021/09/43b40b92-c29a-504b-87fa-5eac368dcf95/</link><pubDate>Tue, 07 Sep 2021 13:07:46 +0000</pubDate><dc:creator>Kai Kimera</dc:creator><category>Linux</category><yandex:related><link url="https://lib.onl/ru/2021/09/aeed7c90-003a-532a-b2c4-3807aaee88fa/">dhclient отправляет 36-значный идентификатор вместо MAC</link><link url="https://lib.onl/ru/2021/05/ee559a6c-5cde-5166-9d2d-3ceb55878eb8/">Debian: Статический IP-адрес</link></yandex:related><turbo:extendedHtml>true</turbo:extendedHtml><turbo:source>https://lib.onl/ru/2021/09/43b40b92-c29a-504b-87fa-5eac368dcf95/</turbo:source><turbo:topic>Отключение установки дополнительных пакетов в Debian APT</turbo:topic><turbo:content><![CDATA[<p>Стандартное действие <span class="shortcode shortcode-tag"><a href="/ru/tags/apt/" target="_blank">#APT</a></span> при установке пакета, это установить дополнительные рекомендуемые пакеты. Но, к примеру, мне рекомендуемые пакеты не нужны. Они занимают место и, если я захочу поставить что-то дополнительно, я поставлю это сам.</p>
<p>Ниже приведены две команды, которые позволяют отключить установку рекомендуемых (Recommends) и дополнительных (Suggests) пакетов.</p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-0
shortcode-codeblock-bash">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-4cf85cf0007af4c9e28aff8744ee72fa" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="nb">echo</span> <span class="s1">&#39;APT::Install-Recommends &#34;false&#34;;&#39;</span> &gt; /etc/apt/apt.conf.d/00InstallRecommends</span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-4cf85cf0007af4c9e28aff8744ee72fa"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>











  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-1
shortcode-codeblock-bash">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-6b9c8a4f9c4407f5de31483f8e787d69" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="nb">echo</span> <span class="s1">&#39;APT::Install-Suggests &#34;false&#34;;&#39;</span> &gt; /etc/apt/apt.conf.d/00InstallSuggests</span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-6b9c8a4f9c4407f5de31483f8e787d69"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<p>Стоит заметить, что при установке <span class="shortcode shortcode-tag"><a href="/ru/tags/debian/" target="_blank">#Debian</a></span> на завершающем этапе можно отключить рекомендуемые пакеты (в <span class="shortcode shortcode-tag">preseed</span> этот параметр именуется как <code>d-i base-installer/install-recommends boolean false</code>). При этом, после установки, <span class="shortcode shortcode-tag"><a href="/ru/tags/debian/" target="_blank">#Debian</a></span> сам создаст файл <code>00InstallRecommends</code> в <code>/etc/apt/apt.conf.d</code> с соответствующим содержанием.</p>]]></turbo:content></item><item turbo="true"><title>dhclient отправляет 36-значный идентификатор вместо MAC</title><link>https://lib.onl/ru/2021/09/aeed7c90-003a-532a-b2c4-3807aaee88fa/</link><pubDate>Tue, 07 Sep 2021 08:38:24 +0000</pubDate><dc:creator>Kai Kimera</dc:creator><category>Linux</category><yandex:related><link url="https://lib.onl/ru/2021/05/ee559a6c-5cde-5166-9d2d-3ceb55878eb8/">Debian: Статический IP-адрес</link></yandex:related><turbo:extendedHtml>true</turbo:extendedHtml><turbo:source>https://lib.onl/ru/2021/09/aeed7c90-003a-532a-b2c4-3807aaee88fa/</turbo:source><turbo:topic>dhclient отправляет 36-значный идентификатор вместо MAC</turbo:topic><turbo:content><![CDATA[<p>Начиная с <span class="shortcode shortcode-tag"><a href="/ru/tags/debian/" target="_blank">#Debian</a></span> 10 в составе дистрибутива поставляется новая версия <span class="shortcode shortcode-tag"><a href="/ru/tags/dhclient/" target="_blank">#dhclient</a></span>, которая стала более совместимой с RFC. Поэтому, <span class="shortcode shortcode-tag"><a href="/ru/tags/dhclient/" target="_blank">#dhclient</a></span> теперь отправляет не прямой <span class="shortcode shortcode-tag">MAC</span>, а 36-значный идентификатор.</p>
<p>Чтобы указать <span class="shortcode shortcode-tag"><a href="/ru/tags/dhclient/" target="_blank">#dhclient</a></span>&rsquo;у отправлять обычный <span class="shortcode shortcode-tag">MAC</span>, необходимо в <code>/etc/dhcp/dhclient.conf</code> прописать строку:</p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-0
shortcode-codeblock-ini">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-462b69feba3cd79f5cf4e3c9b11114f2" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-ini" data-lang="ini"><span class="line"><span class="cl"><span class="na">send dhcp-client-identifier</span> <span class="o">=</span> <span class="s">hardware;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-462b69feba3cd79f5cf4e3c9b11114f2"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<p>Тоже самое при помощи команды:</p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-1
shortcode-codeblock-bash">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-417fc37f0981dacb205b44cccbff7d5a" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="nb">echo</span> <span class="s1">&#39;send dhcp-client-identifier = hardware;&#39;</span> &gt;&gt; /etc/dhcp/dhclient.conf</span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-417fc37f0981dacb205b44cccbff7d5a"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>]]></turbo:content></item><item turbo="true"><title>Скрипт автоматического удаления устаревших файлов</title><link>https://lib.onl/ru/2021/08/ca744dce-e607-52e6-9952-8ae04e052a5b/</link><pubDate>Thu, 19 Aug 2021 15:03:46 +0000</pubDate><dc:creator>Kai Kimera</dc:creator><category>Разработка</category><category>Скрипты</category><yandex:related><link url="https://lib.onl/ru/2021/05/4a3b0a31-0d3d-5a9b-8c07-7e3b4f80669e/">Рекурсивное изменение прав доступа на файлы и директории</link></yandex:related><turbo:extendedHtml>true</turbo:extendedHtml><turbo:source>https://lib.onl/ru/2021/08/ca744dce-e607-52e6-9952-8ae04e052a5b/</turbo:source><turbo:topic>Скрипт автоматического удаления устаревших файлов</turbo:topic><turbo:content><![CDATA[<p>В одной компании стояла задача сделать файловый архив-помойку для хранения и пересылки документации в сторонние организации. Я накидал на <span class="shortcode shortcode-tag"><a href="/ru/tags/php/" target="_blank">#PHP</a></span> самописный интерфейс для загрузки файлов, а на <span class="shortcode shortcode-tag"><a href="/ru/tags/bash/" target="_blank">#bash</a></span>&rsquo;е сделал скрипт автоматического удаления устаревших файлов. Небольшая заметка об этом скрипте.</p>
<p>Скрипт для удаления устаревших файлов очень прост, написан на <span class="shortcode shortcode-tag"><a href="/ru/tags/bash/" target="_blank">#bash</a></span>&rsquo;е и основывается на утилите <code>find</code>. Утилита <code>find</code> имеет опцию <code>-mtime</code>, при помощи которого можно сделать выборку файлов по времени изменения:</p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-0
shortcode-codeblock-bash">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-a2545ac4de4a40c7fcf0d54b543a7a0f" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">find <span class="s2">&#34;/home/user&#34;</span> -type f -mtime +3</span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-a2545ac4de4a40c7fcf0d54b543a7a0f"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<p>Здесь мы говорим утилите <code>find</code>, что необходимо найти и показать файлы, у которых с даты последнего изменения прошло более 3 дней. Если необходимо вывести файлы, дата изменения которых будет менее <code>3</code> дней, то ставим отрицательное значение <code>-3</code>.</p>
<p>Далее, конструируем конвейер, и при помощи <code>xargs</code> указываем команду удаления <code>rm -f</code>:</p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-1
shortcode-codeblock-bash">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-07dd6fb893cac003575b2f920cb48d4d" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">find <span class="s2">&#34;/home/user&#34;</span> -type f -mtime +3 -print0 <span class="p">|</span> xargs -0 rm -f</span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-07dd6fb893cac003575b2f920cb48d4d"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<p>Сам скрипт провожу ниже.</p>
<h2 id="скрипт">
  <a class="link-body-emphasis" href="#%d1%81%d0%ba%d1%80%d0%b8%d0%bf%d1%82">Скрипт</a>
</h2>
    

    
        
            
            <div class="shortcode shortcode-file mb-3">
              <div class="card overflow-hidden" data-bs-theme="dark">
                <div class="card-header">
                  <div class="d-flex align-items-center">
                    <div class="flex-shrink-0">
                      <i class="far fa-file-code fa-fw"></i>
                    </div>
                    <div class="flex-grow-1 mx-2 text-truncate">
                      <code>delete-files.sh</code>
                    </div>
                    <div class="flex-shrink-0">
                      <ul class="list-inline mb-0">
                        <li class="list-inline-item" title='Копировать'>
                          <a class="text-body" href="#"
                             data-fn="clipboard" data-clipboard-target="#cp-ded26c0c9e53a1da1c804ba34f858505"
                             role="button" aria-label='Копировать'>
                            <i class="fas fa-copy fa-fw"></i>
                          </a>
                        </li>
                        <li class="list-inline-item" title='Скачать'>
                          <a class="text-body" href="/ru/2021/08/ca744dce-e607-52e6-9952-8ae04e052a5b/delete-files.sh" download
                             role="button" aria-label='Скачать'>
                            <i class="fas fa-download fa-fw"></i>
                          </a>
                        </li>
                        <li class="list-inline-item" title='Открыть'>
                          <a class="text-body" href="/ru/2021/08/ca744dce-e607-52e6-9952-8ae04e052a5b/delete-files.sh" target="_blank"
                             role="button" aria-label='Открыть'>
                            <i class="fas fa-arrow-up-right-from-square fa-fw"></i>
                          </a>
                        </li>
                      </ul>
                    </div>
                  </div>
                </div>
                <div class="card-body p-0 overflow-auto" id="cp-ded26c0c9e53a1da1c804ba34f858505">
                    
                        
                    
                    <div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sh" data-lang="sh"><span class="line"><span class="cl"><span class="cp">#!/usr/bin/env -S bash -eu
</span></span></span><span class="line"><span class="cl"><span class="cp"></span><span class="c1"># -------------------------------------------------------------------------------------------------------------------- #</span>
</span></span><span class="line"><span class="cl"><span class="c1"># DELETING OUTDATED FILES</span>
</span></span><span class="line"><span class="cl"><span class="c1"># Script for automatically deleting outdated files.</span>
</span></span><span class="line"><span class="cl"><span class="c1"># -------------------------------------------------------------------------------------------------------------------- #</span>
</span></span><span class="line"><span class="cl"><span class="c1"># @package    Bash</span>
</span></span><span class="line"><span class="cl"><span class="c1"># @author     Kai Kimera &lt;mail@kai.kim&gt;</span>
</span></span><span class="line"><span class="cl"><span class="c1"># @copyright  2023 Library Online</span>
</span></span><span class="line"><span class="cl"><span class="c1"># @license    MIT</span>
</span></span><span class="line"><span class="cl"><span class="c1"># @version    0.1.0</span>
</span></span><span class="line"><span class="cl"><span class="c1"># @link       https://lib.onl/ru/2021/08/ca744dce-e607-52e6-9952-8ae04e052a5b/</span>
</span></span><span class="line"><span class="cl"><span class="c1"># -------------------------------------------------------------------------------------------------------------------- #</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nv">days</span><span class="o">=</span><span class="s2">&#34;</span><span class="si">${</span><span class="nv">1</span><span class="si">}</span><span class="s2">&#34;</span><span class="p">;</span> <span class="nv">dir</span><span class="o">=</span><span class="s2">&#34;</span><span class="si">${</span><span class="nv">2</span><span class="si">}</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="o">{</span> find <span class="s2">&#34;</span><span class="si">${</span><span class="nv">dir</span><span class="si">}</span><span class="s2">&#34;</span> -type f -mtime <span class="s2">&#34;+</span><span class="si">${</span><span class="nv">days</span><span class="si">}</span><span class="s2">&#34;</span> -print0 <span class="p">|</span> xargs -0 rm -f<span class="p">;</span> <span class="o">}</span> <span class="o">&amp;&amp;</span> <span class="nb">exit</span> <span class="m">0</span></span></span></code></pre></td></tr></table>
</div>
</div>
                </div>
              </div>
            </div>
        
    
<p>В скрипте я вынес некоторые значения в переменные для удобной перенастройки. Вызывается скрипт следующем образом:</p>











<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-2 shortcode-codeblock-terminal
shortcode-codeblock-terminal-linux
shortcode-codeblock-terminal-linux-user">
  <div class="card overflow-hidden" data-bs-theme="dark">
    <div class="card-header">
      <div class="d-flex align-items-center">
        <div class="flex-shrink-0 ">
          <i class="fas fa-terminal fa-fw"></i>
        </div>
        <div class="flex-grow-1 mx-2">
          <h5 class="mb-0">Терминал</h5>
        </div>
        <div class="flex-shrink-0">
          <ul class="list-inline mb-0">
            <li class="list-inline-item" title='Копировать'>
              <a class="text-body" href="#"
                 data-fn="clipboard" data-clipboard-target="#cp-7c6607e8f1543d64096ac72a80f9c593"
                 role="button" aria-label='Копировать'>
                <i class="fas fa-copy fa-fw"></i>
              </a>
            </li>
          </ul>
        </div>
      </div>
    </div>
    <div class="card-body p-0 overflow-auto" id="cp-7c6607e8f1543d64096ac72a80f9c593"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-plaintext" data-lang="plaintext"><span class="line"><span class="cl">delete-files.sh &#34;3&#34; &#34;/path/to/storage&#34;</span></span></code></pre></td></tr></table>
</div>
</div></div>
  </div>
</div>
<p>Где:</p>
<ul>
<li><code>3</code> - количество дней, прошедших с момента последнего изменения файла.</li>
<li><code>/path/to/storage</code> - путь к файловому хранилищу, в котором необходимо удалять устаревшие файлы.</li>
</ul>
<h2 id="автоматический-запуск-по-расписанию">
  <a class="link-body-emphasis" href="#%d0%b0%d0%b2%d1%82%d0%be%d0%bc%d0%b0%d1%82%d0%b8%d1%87%d0%b5%d1%81%d0%ba%d0%b8%d0%b9-%d0%b7%d0%b0%d0%bf%d1%83%d1%81%d0%ba-%d0%bf%d0%be-%d1%80%d0%b0%d1%81%d0%bf%d0%b8%d1%81%d0%b0%d0%bd%d0%b8%d1%8e">Автоматический запуск по расписанию</a>
</h2><p>Осталось добавить выполнение скрипта по <span class="shortcode shortcode-tag">cron</span>&rsquo;у. Я указал время <code>23:59</code>, когда нагрузка на файловое хранилище минимальна:</p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-3
shortcode-codeblock-bash">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-bfba10840cdf0fd9acdb054b86b23903" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="c1"># Check &amp; remove old files in 23:59 every day.</span>
</span></span><span class="line"><span class="cl"><span class="m">59</span> <span class="m">23</span> * * * <span class="o">[</span>username<span class="o">]</span> /usr/bin/bash /path/to/delete-files.sh <span class="s2">&#34;3&#34;</span> <span class="s2">&#34;/path/to/storage&#34;</span> &gt; /dev/null 2&gt;<span class="p">&amp;</span><span class="m">1</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-bfba10840cdf0fd9acdb054b86b23903"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>]]></turbo:content></item><item turbo="true"><title>Интересные модули Drupal</title><link>https://lib.onl/ru/2021/08/28fa2886-aea6-5abc-9da8-43be56283cdb/</link><pubDate>Wed, 18 Aug 2021 06:58:21 +0000</pubDate><dc:creator>Kai Kimera</dc:creator><category>CMF</category><category>В доработке</category><yandex:related><link url="https://lib.onl/ru/2021/08/8ddf3622-5dd8-5101-9c40-2f3e08f4a579/">XenForo: Первичные настройки движка и параметры системы</link><link url="https://lib.onl/ru/2020/08/5d35edd8-f0e3-5b39-afd3-2ac3b15b8c4f/">Генератор идентификаторов расширений</link><link url="https://lib.onl/ru/2021/08/f9a39e37-8816-5f80-8133-893f3dc8f352/">Условия в шаблонах XenForo 2</link></yandex:related><turbo:extendedHtml>true</turbo:extendedHtml><turbo:source>https://lib.onl/ru/2021/08/28fa2886-aea6-5abc-9da8-43be56283cdb/</turbo:source><turbo:topic>Интересные модули Drupal</turbo:topic><turbo:content><![CDATA[<p>Здесь собраны ссылки на интересные и необходимые для меня в работе модули <span class="shortcode shortcode-tag"><a href="/ru/tags/drupal/" target="_blank">#Drupal</a></span>.</p>
<h2 id="permissions-by-term">
  <a class="link-body-emphasis" href="#permissions-by-term">Permissions by Term</a>
</h2><p><a title="" href="https://www.drupal.org/project/permissions_by_term" target="_blank"
   rel="noopener noreferrer">Модуль</a> позволяет применять права доступа к материалу путём добавления термина таксономии.</p>
<h2 id="node-view-permissions">
  <a class="link-body-emphasis" href="#node-view-permissions">Node View Permissions</a>
</h2><p><a title="" href="https://www.drupal.org/project/node_view_permissions" target="_blank"
   rel="noopener noreferrer">Модуль</a> разрешает или запрещает просматривать материал определённым ролям пользователей. Подобная функция была в Drupal 6, но в последующих версиях её убрали.</p>
<h2 id="poll">
  <a class="link-body-emphasis" href="#poll">Poll</a>
</h2><p><a title="" href="https://www.drupal.org/project/poll" target="_blank"
   rel="noopener noreferrer">Модуль</a> опросов. Позволяет создавать опросы в различной конфигурации.</p>
<h2 id="scheduler">
  <a class="link-body-emphasis" href="#scheduler">Scheduler</a>
</h2><p>Очень полезный <a title="" href="https://www.drupal.org/project/scheduler" target="_blank"
   rel="noopener noreferrer">модуль</a>, особенно редакторам. Модуль позволяет создавать отложенные материалы, которые необходимо опубликовать через определённое время.</p>]]></turbo:content></item><item turbo="true"><title>XenForo: Первичные настройки движка и параметры системы</title><link>https://lib.onl/ru/2021/08/8ddf3622-5dd8-5101-9c40-2f3e08f4a579/</link><pubDate>Wed, 18 Aug 2021 06:55:19 +0000</pubDate><dc:creator>Kai Kimera</dc:creator><category>CMF</category><category>Разработка</category><category>Скрипты</category><yandex:related><link url="https://lib.onl/ru/2021/08/f9a39e37-8816-5f80-8133-893f3dc8f352/">Условия в шаблонах XenForo 2</link><link url="https://lib.onl/ru/2020/08/5d35edd8-f0e3-5b39-afd3-2ac3b15b8c4f/">Генератор идентификаторов расширений</link></yandex:related><turbo:extendedHtml>true</turbo:extendedHtml><turbo:source>https://lib.onl/ru/2021/08/8ddf3622-5dd8-5101-9c40-2f3e08f4a579/</turbo:source><turbo:topic>XenForo: Первичные настройки движка и параметры системы</turbo:topic><turbo:content><![CDATA[<p>У меня в проекте находятся несколько форумов на движке <span class="shortcode shortcode-tag"><a href="/ru/tags/xenforo/" target="_blank">#XenForo</a></span>. Здесь я собрал для себя первичные параметры и настройки движка <span class="shortcode shortcode-tag"><a href="/ru/tags/xenforo/" target="_blank">#XenForo</a></span>.</p>
<h2 id="файл-конфигурации">
  <a class="link-body-emphasis" href="#%d1%84%d0%b0%d0%b9%d0%bb-%d0%ba%d0%be%d0%bd%d1%84%d0%b8%d0%b3%d1%83%d1%80%d0%b0%d1%86%d0%b8%d0%b8">Файл конфигурации</a>
</h2><p>Примеры параметров в файле <code>config.php</code> для первоначальной установки и запуска системы.</p>

    

    
        
            
            <div class="shortcode shortcode-file mb-3">
              <div class="card overflow-hidden" data-bs-theme="dark">
                <div class="card-header">
                  <div class="d-flex align-items-center">
                    <div class="flex-shrink-0">
                      <i class="far fa-file-code fa-fw"></i>
                    </div>
                    <div class="flex-grow-1 mx-2 text-truncate">
                      <code>config.php</code>
                    </div>
                    <div class="flex-shrink-0">
                      <ul class="list-inline mb-0">
                        <li class="list-inline-item" title='Копировать'>
                          <a class="text-body" href="#"
                             data-fn="clipboard" data-clipboard-target="#cp-9ca8eb0b3a92050b94f08603f73c6141"
                             role="button" aria-label='Копировать'>
                            <i class="fas fa-copy fa-fw"></i>
                          </a>
                        </li>
                        <li class="list-inline-item" title='Скачать'>
                          <a class="text-body" href="/ru/2021/08/8ddf3622-5dd8-5101-9c40-2f3e08f4a579/config.php" download
                             role="button" aria-label='Скачать'>
                            <i class="fas fa-download fa-fw"></i>
                          </a>
                        </li>
                        <li class="list-inline-item" title='Открыть'>
                          <a class="text-body" href="/ru/2021/08/8ddf3622-5dd8-5101-9c40-2f3e08f4a579/config.php" target="_blank"
                             role="button" aria-label='Открыть'>
                            <i class="fas fa-arrow-up-right-from-square fa-fw"></i>
                          </a>
                        </li>
                      </ul>
                    </div>
                  </div>
                </div>
                <div class="card-body p-0 overflow-auto" id="cp-9ca8eb0b3a92050b94f08603f73c6141">
                    
                        
                    
                    <div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="o">&lt;?</span><span class="nx">php</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Database.
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nv">$config</span><span class="p">[</span><span class="s1">&#39;db&#39;</span><span class="p">][</span><span class="s1">&#39;host&#39;</span><span class="p">]</span>                             <span class="o">=</span> <span class="s1">&#39;127.0.0.1&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="nv">$config</span><span class="p">[</span><span class="s1">&#39;db&#39;</span><span class="p">][</span><span class="s1">&#39;port&#39;</span><span class="p">]</span>                             <span class="o">=</span> <span class="mi">3306</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="nv">$config</span><span class="p">[</span><span class="s1">&#39;db&#39;</span><span class="p">][</span><span class="s1">&#39;username&#39;</span><span class="p">]</span>                         <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="nv">$config</span><span class="p">[</span><span class="s1">&#39;db&#39;</span><span class="p">][</span><span class="s1">&#39;password&#39;</span><span class="p">]</span>                         <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="nv">$config</span><span class="p">[</span><span class="s1">&#39;db&#39;</span><span class="p">][</span><span class="s1">&#39;dbname&#39;</span><span class="p">]</span>                           <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="nv">$config</span><span class="p">[</span><span class="s1">&#39;db&#39;</span><span class="p">][</span><span class="s1">&#39;socket&#39;</span><span class="p">]</span>                           <span class="o">=</span> <span class="k">null</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Unicode support.
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nv">$config</span><span class="p">[</span><span class="s1">&#39;fullUnicode&#39;</span><span class="p">]</span>                            <span class="o">=</span> <span class="k">true</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Site-wide feature.
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nv">$config</span><span class="p">[</span><span class="s1">&#39;enableTfa&#39;</span><span class="p">]</span>                              <span class="o">=</span> <span class="k">false</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="nv">$config</span><span class="p">[</span><span class="s1">&#39;enableApi&#39;</span><span class="p">]</span>                              <span class="o">=</span> <span class="k">false</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="nv">$config</span><span class="p">[</span><span class="s1">&#39;enableOneClickUpgrade&#39;</span><span class="p">]</span>                  <span class="o">=</span> <span class="k">false</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Cookie.
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nv">$config</span><span class="p">[</span><span class="s1">&#39;cookie&#39;</span><span class="p">][</span><span class="s1">&#39;prefix&#39;</span><span class="p">]</span>                       <span class="o">=</span> <span class="s1">&#39;xf_&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Data and script locations.
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nv">$config</span><span class="p">[</span><span class="s1">&#39;externalDataPath&#39;</span><span class="p">]</span>                       <span class="o">=</span> <span class="s1">&#39;storage/data&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="nv">$config</span><span class="p">[</span><span class="s1">&#39;externalDataUrl&#39;</span><span class="p">]</span>                        <span class="o">=</span> <span class="s1">&#39;storage/data&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="nv">$config</span><span class="p">[</span><span class="s1">&#39;internalDataPath&#39;</span><span class="p">]</span>                       <span class="o">=</span> <span class="s1">&#39;storage/data.int&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="nv">$config</span><span class="p">[</span><span class="s1">&#39;codeCachePath&#39;</span><span class="p">]</span>                          <span class="o">=</span> <span class="s1">&#39;%s/cache/code&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="nv">$config</span><span class="p">[</span><span class="s1">&#39;tempDataPath&#39;</span><span class="p">]</span>                           <span class="o">=</span> <span class="s1">&#39;%s/temp&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="nv">$config</span><span class="p">[</span><span class="s1">&#39;javaScriptUrl&#39;</span><span class="p">]</span>                          <span class="o">=</span> <span class="s1">&#39;js&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Auth.
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nv">$config</span><span class="p">[</span><span class="s1">&#39;auth&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">  <span class="s1">&#39;algo&#39;</span> <span class="o">=&gt;</span> <span class="nx">PASSWORD_ARGON2ID</span>
</span></span><span class="line"><span class="cl"><span class="p">];</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Cache.
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="cm">/*
</span></span></span><span class="line"><span class="cl"><span class="cm">$config[&#39;cache&#39;][&#39;enabled&#39;]                       = true;
</span></span></span><span class="line"><span class="cl"><span class="cm">$config[&#39;cache&#39;][&#39;provider&#39;]                      = &#39;Redis&#39;;
</span></span></span><span class="line"><span class="cl"><span class="cm">$config[&#39;cache&#39;][&#39;config&#39;]                        = [
</span></span></span><span class="line"><span class="cl"><span class="cm">  &#39;host&#39; =&gt; &#39;127.0.0.1&#39;,
</span></span></span><span class="line"><span class="cl"><span class="cm">  &#39;password&#39; =&gt; &#39;&#39;,
</span></span></span><span class="line"><span class="cl"><span class="cm">  &#39;database&#39; =&gt; 1
</span></span></span><span class="line"><span class="cl"><span class="cm">];
</span></span></span><span class="line"><span class="cl"><span class="cm">*/</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Guest page caching.
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="cm">/*
</span></span></span><span class="line"><span class="cl"><span class="cm">$config[&#39;pageCache&#39;][&#39;enabled&#39;]                   = true;
</span></span></span><span class="line"><span class="cl"><span class="cm">$config[&#39;cache&#39;][&#39;context&#39;][&#39;page&#39;][&#39;provider&#39;]   = &#39;Filesystem&#39;;
</span></span></span><span class="line"><span class="cl"><span class="cm">$config[&#39;cache&#39;][&#39;context&#39;][&#39;page&#39;][&#39;config&#39;]     = [
</span></span></span><span class="line"><span class="cl"><span class="cm">  &#39;directory&#39; =&gt; &#39;&#39;
</span></span></span><span class="line"><span class="cl"><span class="cm">];
</span></span></span><span class="line"><span class="cl"><span class="cm">*/</span></span></span></code></pre></td></tr></table>
</div>
</div>
                </div>
              </div>
            </div>
        
    
<h2 id="регистрация-пользователей">
  <a class="link-body-emphasis" href="#%d1%80%d0%b5%d0%b3%d0%b8%d1%81%d1%82%d1%80%d0%b0%d1%86%d0%b8%d1%8f-%d0%bf%d0%be%d0%bb%d1%8c%d0%b7%d0%be%d0%b2%d0%b0%d1%82%d0%b5%d0%bb%d0%b5%d0%b9">Регистрация пользователей</a>
</h2><p>Параметры для регистрации пользователей.</p>
<p><strong>Регулярное выражение:</strong></p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-0
shortcode-codeblock-text">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-62c5f86cdc9865cfe8c05a02883d8f57" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-text" data-lang="text"><span class="line"><span class="cl">#(?!^[\d\-\_\s]+$)^(([a-zA-Z0-9\-\_\s]+)|(((\xD0[\x80-\xBF])|(\xD1[\x80-\xBF])|([0-9\-\_\s]))+))$#</span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-62c5f86cdc9865cfe8c05a02883d8f57"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<h2 id="теги">
  <a class="link-body-emphasis" href="#%d1%82%d0%b5%d0%b3%d0%b8">Теги</a>
</h2><p>Параметры для ввода тегов.</p>
<p><strong>Регулярное выражение:</strong></p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-1
shortcode-codeblock-text">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-2d7d2a03b78a19f56e95221b8a8efd11" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-text" data-lang="text"><span class="line"><span class="cl">#(?!^[\d\-\_\s]+$)^(([a-zA-Z0-9\-\_\s]+)|(((\xD0[\x80-\xBF])|(\xD1[\x80-\xBF])|([0-9\-\_\s]))+))$#</span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-2d7d2a03b78a19f56e95221b8a8efd11"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<h2 id="группы-пользователей">
  <a class="link-body-emphasis" href="#%d0%b3%d1%80%d1%83%d0%bf%d0%bf%d1%8b-%d0%bf%d0%be%d0%bb%d1%8c%d0%b7%d0%be%d0%b2%d0%b0%d1%82%d0%b5%d0%bb%d0%b5%d0%b9">Группы пользователей</a>
</h2><p>Настройки групп пользователей.</p>
<p><strong>Стандартные группы:</strong></p>
<ul>
<li>Unregistered / Unconfirmed <code>ID(1)</code></li>
<li>Registered <code>ID(2)</code></li>
<li>Administrative <code>ID(3)</code></li>
<li>Moderating <code>ID(4)</code></li>
</ul>]]></turbo:content></item><item turbo="true"><title>Условия в шаблонах XenForo 2</title><link>https://lib.onl/ru/2021/08/f9a39e37-8816-5f80-8133-893f3dc8f352/</link><pubDate>Tue, 17 Aug 2021 12:21:10 +0000</pubDate><dc:creator>Kai Kimera</dc:creator><category>CMF</category><yandex:related><link url="https://lib.onl/ru/2020/08/5d35edd8-f0e3-5b39-afd3-2ac3b15b8c4f/">Генератор идентификаторов расширений</link></yandex:related><turbo:extendedHtml>true</turbo:extendedHtml><turbo:source>https://lib.onl/ru/2021/08/f9a39e37-8816-5f80-8133-893f3dc8f352/</turbo:source><turbo:topic>Условия в шаблонах XenForo 2</turbo:topic><turbo:content><![CDATA[<p>Представляю список условий, которые можно использовать в шаблонах <span class="shortcode shortcode-tag"><a href="/ru/tags/xenforo/" target="_blank">#XenForo</a></span>. Все возможные условия перечислить затруднительно, потому что существует множество различных вариантов фильтрации и выборки информации. Здесь представлены наиболее популярные варианты.</p>
<p>С этой статьи я начинаю попытку восстановления накопленных данных за период моей деятельности в качестве исследователя и разработчика веб-приложений.</p>
<h2 id="условия-в-шаблонах">
  <a class="link-body-emphasis" href="#%d1%83%d1%81%d0%bb%d0%be%d0%b2%d0%b8%d1%8f-%d0%b2-%d1%88%d0%b0%d0%b1%d0%bb%d0%be%d0%bd%d0%b0%d1%85">Условия в шаблонах</a>
</h2><ol>
<li>Отображение информации только администраторам.</li>
</ol>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-0
shortcode-codeblock-html">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-e77de9ef4e460528020e50e00d44af90" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-html" data-lang="html"><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">xf:if</span> <span class="na">is</span><span class="o">=</span><span class="s">&#34;$xf.visitor.is_admin&#34;</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="c">&lt;!-- content --&gt;</span>
</span></span><span class="line"><span class="cl"><span class="p">&lt;/</span><span class="nt">xf:if</span><span class="p">&gt;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-e77de9ef4e460528020e50e00d44af90"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<ol start="2">
<li>Отображение информации только модераторам.</li>
</ol>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-1
shortcode-codeblock-html">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-efb2cc074d38e9e7e0d86889707190c8" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-html" data-lang="html"><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">xf:if</span> <span class="na">is</span><span class="o">=</span><span class="s">&#34;$xf.visitor.is_moderator&#34;</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="c">&lt;!-- content --&gt;</span>
</span></span><span class="line"><span class="cl"><span class="p">&lt;/</span><span class="nt">xf:if</span><span class="p">&gt;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-efb2cc074d38e9e7e0d86889707190c8"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<ol start="3">
<li>Отображение информации только администраторам и модераторам.</li>
</ol>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-2
shortcode-codeblock-html">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-9a20ffc93674f81520cac5f11181810f" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-html" data-lang="html"><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">xf:if</span> <span class="na">is</span><span class="o">=</span><span class="s">&#34;$xf.visitor.is_admin OR $xf.visitor.is_moderator&#34;</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="c">&lt;!-- content --&gt;</span>
</span></span><span class="line"><span class="cl"><span class="p">&lt;/</span><span class="nt">xf:if</span><span class="p">&gt;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-9a20ffc93674f81520cac5f11181810f"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<ol start="4">
<li>Отображение информации только зарегистрированному пользователю</li>
</ol>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-3
shortcode-codeblock-html">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-402766d6862b52486516e1572ac01516" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-html" data-lang="html"><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">xf:if</span> <span class="na">is</span><span class="o">=</span><span class="s">&#34;$xf.visitor.user_id&#34;</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="c">&lt;!-- content --&gt;</span>
</span></span><span class="line"><span class="cl"><span class="p">&lt;/</span><span class="nt">xf:if</span><span class="p">&gt;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-402766d6862b52486516e1572ac01516"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<ol start="5">
<li>Отображение информации гостю.</li>
</ol>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-4
shortcode-codeblock-html">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-b36f46747266bb97a63a9d7de24a2531" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-html" data-lang="html"><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">xf:if</span> <span class="na">is</span><span class="o">=</span><span class="s">&#34;!$xf.visitor.user_id&#34;</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="c">&lt;!-- content --&gt;</span>
</span></span><span class="line"><span class="cl"><span class="p">&lt;/</span><span class="nt">xf:if</span><span class="p">&gt;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-b36f46747266bb97a63a9d7de24a2531"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<ol start="6">
<li>Отображение разной информации зарегистрированному пользователю и гостю.</li>
</ol>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-5
shortcode-codeblock-html">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-4e925e73eae44b567b38aae491376079" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-html" data-lang="html"><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">xf:if</span> <span class="na">is</span><span class="o">=</span><span class="s">&#34;!$xf.visitor.user_id&#34;</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="c">&lt;!-- content for members --&gt;</span>
</span></span><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">xf:else</span> <span class="p">/&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="c">&lt;!-- content for guests --&gt;</span>
</span></span><span class="line"><span class="cl"><span class="p">&lt;/</span><span class="nt">xf:if</span><span class="p">&gt;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-4e925e73eae44b567b38aae491376079"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<ol start="7">
<li>Отображение информации только заблокированным пользователям.</li>
</ol>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-6
shortcode-codeblock-html">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-d6cf205692fcd5e7e0a226a33cf70fed" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-html" data-lang="html"><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">xf:if</span> <span class="na">is</span><span class="o">=</span><span class="s">&#34;$user.is_banned&#34;</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="c">&lt;!-- content --&gt;</span>
</span></span><span class="line"><span class="cl"><span class="p">&lt;/</span><span class="nt">xf:if</span><span class="p">&gt;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-d6cf205692fcd5e7e0a226a33cf70fed"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<ol start="8">
<li>Отображение информации только если у пользователя симпатий больше определённого количества.</li>
</ol>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-7
shortcode-codeblock-html">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-eb93cd883dd3d7f760e76403abb0499f" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-html" data-lang="html"><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">xf:if</span> <span class="na">is</span><span class="o">=</span><span class="s">&#34;$user.like_count|number &gt; X&#34;</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="c">&lt;!-- content --&gt;</span>
</span></span><span class="line"><span class="cl"><span class="p">&lt;/</span><span class="nt">xf:if</span><span class="p">&gt;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-eb93cd883dd3d7f760e76403abb0499f"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<ol start="9">
<li>Отображение информации только если у пользователя сообщений больше определённого количества.</li>
</ol>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-8
shortcode-codeblock-html">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-4949ea426ee1932414b691320bb6a780" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-html" data-lang="html"><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">xf:if</span> <span class="na">is</span><span class="o">=</span><span class="s">&#34;{$xf.visitor.message_count|number} &gt; X&#34;</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="c">&lt;!-- content --&gt;</span>
</span></span><span class="line"><span class="cl"><span class="p">&lt;/</span><span class="nt">xf:if</span><span class="p">&gt;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-4949ea426ee1932414b691320bb6a780"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<ol start="10">
<li>Отображение информации только если у пользователя очков больше определённого количества.</li>
</ol>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-9
shortcode-codeblock-html">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-5e84645bc468051d762ff1c65a085e25" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-html" data-lang="html"><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">xf:if</span> <span class="na">is</span><span class="o">=</span><span class="s">&#34;$user.trophy_points|number &gt; X&#34;</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="c">&lt;!-- content --&gt;</span>
</span></span><span class="line"><span class="cl"><span class="p">&lt;/</span><span class="nt">xf:if</span><span class="p">&gt;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-5e84645bc468051d762ff1c65a085e25"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<ol start="11">
<li>Отображение информации определённому пользователю.</li>
</ol>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-10
shortcode-codeblock-html">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-8e30aab2cd721a74490aa66c2801bfe3" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-html" data-lang="html"><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">xf:if</span> <span class="na">is</span><span class="o">=</span><span class="s">&#34;$xf.visitor.user_id == X&#34;</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="c">&lt;!-- content --&gt;</span>
</span></span><span class="line"><span class="cl"><span class="p">&lt;/</span><span class="nt">xf:if</span><span class="p">&gt;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-8e30aab2cd721a74490aa66c2801bfe3"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<ol start="12">
<li>Отображение информации определённым пользователям.</li>
</ol>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-11
shortcode-codeblock-html">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-d1c10217fbe887e314c42a4abc02fcfa" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-html" data-lang="html"><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">xf:if</span> <span class="na">is</span><span class="o">=</span><span class="s">&#34;in_array($xf.visitor.user_id, [X, Y, Z])&#34;</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="c">&lt;!-- content --&gt;</span>
</span></span><span class="line"><span class="cl"><span class="p">&lt;/</span><span class="nt">xf:if</span><span class="p">&gt;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-d1c10217fbe887e314c42a4abc02fcfa"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<ol start="13">
<li>(1) Отображение информации определённым группам пользователей.</li>
</ol>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-12
shortcode-codeblock-html">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-e36fa25eaa211e7b1c38bf431ddb9967" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-html" data-lang="html"><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">xf:if</span> <span class="na">is</span><span class="o">=</span><span class="s">&#34;{{$xf.visitor.isMemberOf([X, Y])}}&#34;</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="c">&lt;!-- content --&gt;</span>
</span></span><span class="line"><span class="cl"><span class="p">&lt;/</span><span class="nt">xf:if</span><span class="p">&gt;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-e36fa25eaa211e7b1c38bf431ddb9967"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<ol start="13">
<li>(2) Отображение информации определённой группе пользователей.</li>
</ol>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-13
shortcode-codeblock-html">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-0a66414392b954b550622a45034aecbb" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-html" data-lang="html"><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">xf:if</span> <span class="na">is</span><span class="o">=</span><span class="s">&#34;{{$xf.visitor.isMemberOf(X)}}&#34;</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="c">&lt;!-- content --&gt;</span>
</span></span><span class="line"><span class="cl"><span class="p">&lt;/</span><span class="nt">xf:if</span><span class="p">&gt;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-0a66414392b954b550622a45034aecbb"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<ol start="14">
<li>(1) Скрытие информации от определённых групп пользователей.</li>
</ol>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-14
shortcode-codeblock-html">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-b256b754e465efc0626175a650f9ce37" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-html" data-lang="html"><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">xf:if</span> <span class="na">is</span><span class="o">=</span><span class="s">&#34;{{!$xf.visitor.isMemberOf([X, Y])}}&#34;</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="c">&lt;!-- content --&gt;</span>
</span></span><span class="line"><span class="cl"><span class="p">&lt;/</span><span class="nt">xf:if</span><span class="p">&gt;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-b256b754e465efc0626175a650f9ce37"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<ol start="14">
<li>(2) Скрытие информации от определённой группы пользователей.</li>
</ol>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-15
shortcode-codeblock-html">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-f15bf93bac036aaf298375ff29135584" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-html" data-lang="html"><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">xf:if</span> <span class="na">is</span><span class="o">=</span><span class="s">&#34;{{!$xf.visitor.isMemberOf(X)}}&#34;</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="c">&lt;!-- content --&gt;</span>
</span></span><span class="line"><span class="cl"><span class="p">&lt;/</span><span class="nt">xf:if</span><span class="p">&gt;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-f15bf93bac036aaf298375ff29135584"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<ol start="15">
<li>(1) Отображение информации после первого сообщения в теме.</li>
</ol>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-16
shortcode-codeblock-html">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-d56772c5597b734195bbc62594d186ab" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-html" data-lang="html"><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">xf:if</span> <span class="na">is</span><span class="o">=</span><span class="s">&#34;$post.position % $xf.options.messagesPerPage == 0&#34;</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="c">&lt;!-- content --&gt;</span>
</span></span><span class="line"><span class="cl"><span class="p">&lt;/</span><span class="nt">xf:if</span><span class="p">&gt;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-d56772c5597b734195bbc62594d186ab"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<ol start="15">
<li>(2) Отображение информации через определённое количества сообщений.</li>
</ol>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-17
shortcode-codeblock-html">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-918d076b26374e9814627b3ac14b342d" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-html" data-lang="html"><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">xf:if</span> <span class="na">is</span><span class="o">=</span><span class="s">&#34;$post.position % $xf.options.messagesPerPage == X&#34;</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="c">&lt;!-- content --&gt;</span>
</span></span><span class="line"><span class="cl"><span class="p">&lt;/</span><span class="nt">xf:if</span><span class="p">&gt;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-918d076b26374e9814627b3ac14b342d"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<ol start="16">
<li>Отображение информации на странице, на которой присутствует боковая панель.</li>
</ol>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-18
shortcode-codeblock-html">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-247ddfef44f9e610156325bf64990836" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-html" data-lang="html"><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">xf:if</span> <span class="na">is</span><span class="o">=</span><span class="s">&#34;$sidebar&#34;</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="c">&lt;!-- content --&gt;</span>
</span></span><span class="line"><span class="cl"><span class="p">&lt;/</span><span class="nt">xf:if</span><span class="p">&gt;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-247ddfef44f9e610156325bf64990836"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<ol start="17">
<li>Отображение информации на главной (домашней) странице форума.</li>
</ol>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-19
shortcode-codeblock-html">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-00a939d369babe1d62851c95e4397f10" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-html" data-lang="html"><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">xf:if</span> <span class="na">is</span><span class="o">=</span><span class="s">&#34;$template == &#39;forum_list&#39;&#34;</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="c">&lt;!-- content --&gt;</span>
</span></span><span class="line"><span class="cl"><span class="p">&lt;/</span><span class="nt">xf:if</span><span class="p">&gt;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-00a939d369babe1d62851c95e4397f10"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<ol start="18">
<li>Скрытие информации только с главной (домашней) странице форума.</li>
</ol>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-20
shortcode-codeblock-html">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-55c792ba78fbe5fdbd25eee86eddd733" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-html" data-lang="html"><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">xf:if</span> <span class="na">is</span><span class="o">=</span><span class="s">&#34;$template !== &#39;forum_list&#39;&#34;</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="c">&lt;!-- content --&gt;</span>
</span></span><span class="line"><span class="cl"><span class="p">&lt;/</span><span class="nt">xf:if</span><span class="p">&gt;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-55c792ba78fbe5fdbd25eee86eddd733"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<ol start="19">
<li>Отображение информации на странице создания новой темы.</li>
</ol>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-21
shortcode-codeblock-html">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-04d599a77b2e22e41195421e2889a06b" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-html" data-lang="html"><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">xf:if</span> <span class="na">is</span><span class="o">=</span><span class="s">&#34;$template == &#39;forum_post_thread&#39;&#34;</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="c">&lt;!-- content --&gt;</span>
</span></span><span class="line"><span class="cl"><span class="p">&lt;/</span><span class="nt">xf:if</span><span class="p">&gt;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-04d599a77b2e22e41195421e2889a06b"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<ol start="20">
<li>Скрытие информации на странице создания новой темы.</li>
</ol>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-22
shortcode-codeblock-html">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-09576f19f0f59802f317c85dadc2a039" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-html" data-lang="html"><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">xf:if</span> <span class="na">is</span><span class="o">=</span><span class="s">&#34;$template != &#39;forum_post_thread&#39;&#34;</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="c">&lt;!-- content --&gt;</span>
</span></span><span class="line"><span class="cl"><span class="p">&lt;/</span><span class="nt">xf:if</span><span class="p">&gt;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-09576f19f0f59802f317c85dadc2a039"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<ol start="21">
<li>Отображение информации на странице создания нового ресурса.</li>
</ol>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-23
shortcode-codeblock-html">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-786e93c2ece3d3e86cb4a5d90c68135a" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-html" data-lang="html"><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">xf:if</span> <span class="na">is</span><span class="o">=</span><span class="s">&#34;$template == &#39;xfrm_category_add_resource&#39;&#34;</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="c">&lt;!-- content --&gt;</span>
</span></span><span class="line"><span class="cl"><span class="p">&lt;/</span><span class="nt">xf:if</span><span class="p">&gt;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-786e93c2ece3d3e86cb4a5d90c68135a"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<ol start="22">
<li>Скрытие информации на странице создания нового ресурса.</li>
</ol>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-24
shortcode-codeblock-html">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-d975c3456680a012d91ac7ee3d0e434d" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-html" data-lang="html"><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">xf:if</span> <span class="na">is</span><span class="o">=</span><span class="s">&#34;$template != &#39;xfrm_category_add_resource&#39;&#34;</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="c">&lt;!-- content --&gt;</span>
</span></span><span class="line"><span class="cl"><span class="p">&lt;/</span><span class="nt">xf:if</span><span class="p">&gt;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-d975c3456680a012d91ac7ee3d0e434d"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<ol start="23">
<li>Отображение информации на странице поисковой формы.</li>
</ol>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-25
shortcode-codeblock-html">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-c0cf4da160e97f8cf0a7e9a702bb6649" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-html" data-lang="html"><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">xf:if</span> <span class="na">is</span><span class="o">=</span><span class="s">&#34;$template == &#39;search_form&#39;&#34;</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="c">&lt;!-- content --&gt;</span>
</span></span><span class="line"><span class="cl"><span class="p">&lt;/</span><span class="nt">xf:if</span><span class="p">&gt;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-c0cf4da160e97f8cf0a7e9a702bb6649"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<ol start="24">
<li>Скрытие информации на странице поисковой формы.</li>
</ol>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-26
shortcode-codeblock-html">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-73e4845b6827b3762c464802521a6f05" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-html" data-lang="html"><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">xf:if</span> <span class="na">is</span><span class="o">=</span><span class="s">&#34;$template != &#39;search_form&#39;&#34;</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="c">&lt;!-- content --&gt;</span>
</span></span><span class="line"><span class="cl"><span class="p">&lt;/</span><span class="nt">xf:if</span><span class="p">&gt;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-73e4845b6827b3762c464802521a6f05"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<ol start="25">
<li>Отображение информации на странице &ldquo;Что нового?&rdquo;.</li>
</ol>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-27
shortcode-codeblock-html">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-c50a6b2e40a75195422b08af9e95f5cd" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-html" data-lang="html"><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">xf:if</span> <span class="na">is</span><span class="o">=</span><span class="s">&#34;$template == &#39;whats_new&#39;&#34;</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="c">&lt;!-- content --&gt;</span>
</span></span><span class="line"><span class="cl"><span class="p">&lt;/</span><span class="nt">xf:if</span><span class="p">&gt;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-c50a6b2e40a75195422b08af9e95f5cd"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<ol start="26">
<li>Скрытие информации на странице &ldquo;Что нового?&rdquo;.</li>
</ol>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-28
shortcode-codeblock-html">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-2dcd2cfefa247f708f81ed070006e3e2" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-html" data-lang="html"><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">xf:if</span> <span class="na">is</span><span class="o">=</span><span class="s">&#34;$template != &#39;whats_new&#39;&#34;</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="c">&lt;!-- content --&gt;</span>
</span></span><span class="line"><span class="cl"><span class="p">&lt;/</span><span class="nt">xf:if</span><span class="p">&gt;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-2dcd2cfefa247f708f81ed070006e3e2"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<ol start="27">
<li>Отображение информации на странице просмотра личной переписки.</li>
</ol>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-29
shortcode-codeblock-html">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-14b630b480fdc951dd92048534ec2b85" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-html" data-lang="html"><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">xf:if</span> <span class="na">is</span><span class="o">=</span><span class="s">&#34;$template == &#39;conversation_view&#39;&#34;</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="c">&lt;!-- content --&gt;</span>
</span></span><span class="line"><span class="cl"><span class="p">&lt;/</span><span class="nt">xf:if</span><span class="p">&gt;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-14b630b480fdc951dd92048534ec2b85"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<ol start="28">
<li>Скрытие информации на странице просмотра личной переписки.</li>
</ol>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-30
shortcode-codeblock-html">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-7018f38e5b9c15da0ec2d0097d826706" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-html" data-lang="html"><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">xf:if</span> <span class="na">is</span><span class="o">=</span><span class="s">&#34;$template != &#39;conversation_view&#39;&#34;</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="c">&lt;!-- content --&gt;</span>
</span></span><span class="line"><span class="cl"><span class="p">&lt;/</span><span class="nt">xf:if</span><span class="p">&gt;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-7018f38e5b9c15da0ec2d0097d826706"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<ol start="29">
<li>Отображение информации на странице просмотра списка личных переписок.</li>
</ol>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-31
shortcode-codeblock-html">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-ae37116ff27fc6f6e426efd2006d2473" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-html" data-lang="html"><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">xf:if</span> <span class="na">is</span><span class="o">=</span><span class="s">&#34;$template == &#39;conversation_list&#39;&#34;</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="c">&lt;!-- content --&gt;</span>
</span></span><span class="line"><span class="cl"><span class="p">&lt;/</span><span class="nt">xf:if</span><span class="p">&gt;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-ae37116ff27fc6f6e426efd2006d2473"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<ol start="30">
<li>Скрытие информации на странице просмотра списка личных переписок.</li>
</ol>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-32
shortcode-codeblock-html">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-26d7b1e40b2a17f2cb7e00c7a5007767" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-html" data-lang="html"><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">xf:if</span> <span class="na">is</span><span class="o">=</span><span class="s">&#34;$template != &#39;conversation_list&#39;&#34;</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="c">&lt;!-- content --&gt;</span>
</span></span><span class="line"><span class="cl"><span class="p">&lt;/</span><span class="nt">xf:if</span><span class="p">&gt;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-26d7b1e40b2a17f2cb7e00c7a5007767"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<ol start="31">
<li>Отображение информации на главной странице ресурсов.</li>
</ol>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-33
shortcode-codeblock-html">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-5077644e97e923767899f3a0d7d38101" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-html" data-lang="html"><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">xf:if</span> <span class="na">is</span><span class="o">=</span><span class="s">&#34;$template == &#39;xfrm_overview&#39;&#34;</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="c">&lt;!-- content --&gt;</span>
</span></span><span class="line"><span class="cl"><span class="p">&lt;/</span><span class="nt">xf:if</span><span class="p">&gt;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-5077644e97e923767899f3a0d7d38101"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<ol start="32">
<li>Скрытие информации на главной странице ресурсов.</li>
</ol>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-34
shortcode-codeblock-html">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-97be7cde68492c8ea33376643147245a" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-html" data-lang="html"><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">xf:if</span> <span class="na">is</span><span class="o">=</span><span class="s">&#34;$template != &#39;xfrm_overview&#39;&#34;</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="c">&lt;!-- content --&gt;</span>
</span></span><span class="line"><span class="cl"><span class="p">&lt;/</span><span class="nt">xf:if</span><span class="p">&gt;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-97be7cde68492c8ea33376643147245a"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<ol start="33">
<li>Отображение информации на странице просмотра ресурса.</li>
</ol>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-35
shortcode-codeblock-html">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-ea5588aba5d992a2733831d2c75bed24" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-html" data-lang="html"><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">xf:if</span> <span class="na">is</span><span class="o">=</span><span class="s">&#34;$template == &#39;xfrm_resource_view&#39;&#34;</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="c">&lt;!-- content --&gt;</span>
</span></span><span class="line"><span class="cl"><span class="p">&lt;/</span><span class="nt">xf:if</span><span class="p">&gt;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-ea5588aba5d992a2733831d2c75bed24"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<ol start="34">
<li>Скрытие информации на странице просмотра ресурса.</li>
</ol>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-36
shortcode-codeblock-html">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-6a363cd04764064d099f1cb7791170df" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-html" data-lang="html"><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">xf:if</span> <span class="na">is</span><span class="o">=</span><span class="s">&#34;$template != &#39;xfrm_resource_view&#39;&#34;</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="c">&lt;!-- content --&gt;</span>
</span></span><span class="line"><span class="cl"><span class="p">&lt;/</span><span class="nt">xf:if</span><span class="p">&gt;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-6a363cd04764064d099f1cb7791170df"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<ol start="35">
<li>Отображение информации на странице просмотра темы.</li>
</ol>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-37
shortcode-codeblock-html">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-72b97674018072659e36e671c2641be2" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-html" data-lang="html"><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">xf:if</span> <span class="na">is</span><span class="o">=</span><span class="s">&#34;$template == &#39;thread_view&#39;&#34;</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="c">&lt;!-- content --&gt;</span>
</span></span><span class="line"><span class="cl"><span class="p">&lt;/</span><span class="nt">xf:if</span><span class="p">&gt;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-72b97674018072659e36e671c2641be2"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<ol start="36">
<li>Скрытие информации на странице просмотра темы.</li>
</ol>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-38
shortcode-codeblock-html">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-e543739e4d7515947115f973f198053d" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-html" data-lang="html"><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">xf:if</span> <span class="na">is</span><span class="o">=</span><span class="s">&#34;$template !=&#39;thread_view&#39;&#34;</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="c">&lt;!-- content --&gt;</span>
</span></span><span class="line"><span class="cl"><span class="p">&lt;/</span><span class="nt">xf:if</span><span class="p">&gt;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-e543739e4d7515947115f973f198053d"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<ol start="37">
<li>Отображение информации на странице просмотра форума (раздела).</li>
</ol>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-39
shortcode-codeblock-html">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-c45e8941b42d8deed58b339fa19be262" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-html" data-lang="html"><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">xf:if</span> <span class="na">is</span><span class="o">=</span><span class="s">&#34;$template ==&#39;forum_view&#39;&#34;</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="c">&lt;!-- content --&gt;</span>
</span></span><span class="line"><span class="cl"><span class="p">&lt;/</span><span class="nt">xf:if</span><span class="p">&gt;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-c45e8941b42d8deed58b339fa19be262"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<ol start="38">
<li>Скрытие информации на странице просмотра форума (раздела).</li>
</ol>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-40
shortcode-codeblock-html">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-8f9adbce15d6457cdd1dab1998378a17" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-html" data-lang="html"><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">xf:if</span> <span class="na">is</span><span class="o">=</span><span class="s">&#34;$template != &#39;forum_view&#39;&#34;</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="c">&lt;!-- content --&gt;</span>
</span></span><span class="line"><span class="cl"><span class="p">&lt;/</span><span class="nt">xf:if</span><span class="p">&gt;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-8f9adbce15d6457cdd1dab1998378a17"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<ol start="39">
<li>Отображение информации &ldquo;наказанным&rdquo; пользователям.</li>
</ol>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-41
shortcode-codeblock-html">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-acb1a2fe54e6143b5c5b3b5c58b5f92e" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-html" data-lang="html"><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">xf:if</span> <span class="na">is</span><span class="o">=</span><span class="s">&#34;{$xf.visitor.Option.is_discouraged}&#34;</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="c">&lt;!-- content --&gt;</span>
</span></span><span class="line"><span class="cl"><span class="p">&lt;/</span><span class="nt">xf:if</span><span class="p">&gt;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-acb1a2fe54e6143b5c5b3b5c58b5f92e"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<ol start="40">
<li>Отображение информации пользователям, которые имеют Gravatar.</li>
</ol>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-42
shortcode-codeblock-html">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-cdf94bff4522d99ac08dc9dcb5c32cb4" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-html" data-lang="html"><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">xf:if</span> <span class="na">is</span><span class="o">=</span><span class="s">&#34;{$xf.visitor.gravatar}&#34;</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="c">&lt;!-- content --&gt;</span>
</span></span><span class="line"><span class="cl"><span class="p">&lt;/</span><span class="nt">xf:if</span><span class="p">&gt;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-cdf94bff4522d99ac08dc9dcb5c32cb4"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<ol start="41">
<li>Отображение информации пользователям поддержки форума.</li>
</ol>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-43
shortcode-codeblock-html">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-49b0ae552b07d985a2ea7253f59b3434" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-html" data-lang="html"><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">xf:if</span> <span class="na">is</span><span class="o">=</span><span class="s">&#34;{$xf.visitor.is_staff}&#34;</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="c">&lt;!-- content --&gt;</span>
</span></span><span class="line"><span class="cl"><span class="p">&lt;/</span><span class="nt">xf:if</span><span class="p">&gt;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-49b0ae552b07d985a2ea7253f59b3434"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<ol start="42">
<li>Отображение информации пользователям без подтверждённого адреса e-mail.</li>
</ol>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-44
shortcode-codeblock-html">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-14ef28e9b2f6ff6978505622d9519c72" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-html" data-lang="html"><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">xf:if</span> <span class="na">is</span><span class="o">=</span><span class="s">&#34;{$xf.visitor.isAwaitingEmailConfirmation()}&#34;</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="c">&lt;!-- content --&gt;</span>
</span></span><span class="line"><span class="cl"><span class="p">&lt;/</span><span class="nt">xf:if</span><span class="p">&gt;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-14ef28e9b2f6ff6978505622d9519c72"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<ol start="43">
<li>Отображение информации в нескольких форумах (разделах).</li>
</ol>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-45
shortcode-codeblock-html">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-e45e5cd566a38084eef8132a1e14ecb3" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-html" data-lang="html"><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">xf:if</span> <span class="na">is</span><span class="o">=</span><span class="s">&#34;in_array({$forum.node_id}, [X, Y, Z])&#34;</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="c">&lt;!-- content --&gt;</span>
</span></span><span class="line"><span class="cl"><span class="p">&lt;/</span><span class="nt">xf:if</span><span class="p">&gt;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-e45e5cd566a38084eef8132a1e14ecb3"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<ol start="44">
<li>Скрытие информации в нескольких форумах (разделах).</li>
</ol>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-46
shortcode-codeblock-html">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-c43dfbcb1e7db0104527b563cb1d09da" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-html" data-lang="html"><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">xf:if</span> <span class="na">is</span><span class="o">=</span><span class="s">&#34;in_array($forum.node_id, [X, Y, Z])&#34;</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="c">&lt;!-- content --&gt;</span>
</span></span><span class="line"><span class="cl"><span class="p">&lt;/</span><span class="nt">xf:if</span><span class="p">&gt;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-c43dfbcb1e7db0104527b563cb1d09da"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<ol start="45">
<li>Отображение информации в определённом форуме (разделе).</li>
</ol>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-47
shortcode-codeblock-html">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-2c40a56db25452a46925ea884465cf98" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-html" data-lang="html"><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">xf:if</span> <span class="na">is</span><span class="o">=</span><span class="s">&#34;$forum.node_id == X&#34;</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="c">&lt;!-- content --&gt;</span>
</span></span><span class="line"><span class="cl"><span class="p">&lt;/</span><span class="nt">xf:if</span><span class="p">&gt;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-2c40a56db25452a46925ea884465cf98"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<ol start="46">
<li>Скрытие информации в определённом форуме (разделе).</li>
</ol>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-48
shortcode-codeblock-html">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-8b9d9adf4549e2aad8578e761851667f" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-html" data-lang="html"><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">xf:if</span> <span class="na">is</span><span class="o">=</span><span class="s">&#34;$forum.node_id != 3&#34;</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="c">&lt;!-- content --&gt;</span>
</span></span><span class="line"><span class="cl"><span class="p">&lt;/</span><span class="nt">xf:if</span><span class="p">&gt;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-8b9d9adf4549e2aad8578e761851667f"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<ol start="47">
<li>Отображение информации только после первого сообщения в каждой теме.</li>
</ol>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-49
shortcode-codeblock-html">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-7b4e3fa462c811cffb98693ca30a3e4a" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-html" data-lang="html"><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">xf:if</span> <span class="na">is</span><span class="o">=</span><span class="s">&#34;{$post.position} % {$xf.options.messagesPerPage} == 1&#34;</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="c">&lt;!-- content --&gt;</span>
</span></span><span class="line"><span class="cl"><span class="p">&lt;/</span><span class="nt">xf:if</span><span class="p">&gt;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-7b4e3fa462c811cffb98693ca30a3e4a"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<ol start="48">
<li>Отображение информации только внутри первого сообщения в каждой теме.</li>
</ol>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-50
shortcode-codeblock-html">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-08274a51ffcc0a8a83734b97020ed5e2" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-html" data-lang="html"><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">xf:if</span> <span class="na">is</span><span class="o">=</span><span class="s">&#34;{$post.position} % {$xf.options.messagesPerPage} == 0&#34;</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="c">&lt;!-- content --&gt;</span>
</span></span><span class="line"><span class="cl"><span class="p">&lt;/</span><span class="nt">xf:if</span><span class="p">&gt;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-08274a51ffcc0a8a83734b97020ed5e2"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<ol start="49">
<li>Отображение информации только при заполненном поле местоположения.</li>
</ol>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-51
shortcode-codeblock-html">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-af7b345433f0f204bdae1f78f09d7c9c" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-html" data-lang="html"><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">xf:if</span> <span class="na">is</span><span class="o">=</span><span class="s">&#34;{$xf.visitor.location}&#34;</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="c">&lt;!-- content --&gt;</span>
</span></span><span class="line"><span class="cl"><span class="p">&lt;/</span><span class="nt">xf:if</span><span class="p">&gt;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-af7b345433f0f204bdae1f78f09d7c9c"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<ol start="50">
<li>Отображение информации только при заполненном поле веб-сайта.</li>
</ol>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-52
shortcode-codeblock-html">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-5df154ba9d8a08d627d1453d72b6757a" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-html" data-lang="html"><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">xf:if</span> <span class="na">is</span><span class="o">=</span><span class="s">&#34;{$xf.visitor.website}&#34;</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="c">&lt;!-- content --&gt;</span>
</span></span><span class="line"><span class="cl"><span class="p">&lt;/</span><span class="nt">xf:if</span><span class="p">&gt;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-5df154ba9d8a08d627d1453d72b6757a"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<ol start="51">
<li>Отображение информации при указанной подписи.</li>
</ol>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-53
shortcode-codeblock-html">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-ecb2a95fe98496d020271d6cbeb9bdeb" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-html" data-lang="html"><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">xf:if</span> <span class="na">is</span><span class="o">=</span><span class="s">&#34;{$xf.visitor.signature}&#34;</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="c">&lt;!-- content --&gt;</span>
</span></span><span class="line"><span class="cl"><span class="p">&lt;/</span><span class="nt">xf:if</span><span class="p">&gt;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-ecb2a95fe98496d020271d6cbeb9bdeb"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<ol start="52">
<li>Отображение информации только активированным пользователям.</li>
</ol>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-54
shortcode-codeblock-html">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-5553f21ca8c7057e8567e5e098851e96" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-html" data-lang="html"><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">xf:if</span> <span class="na">is</span><span class="o">=</span><span class="s">&#34;{$xf.visitor.user_state} == &#39;valid&#39;&#34;</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="c">&lt;!-- content --&gt;</span>
</span></span><span class="line"><span class="cl"><span class="p">&lt;/</span><span class="nt">xf:if</span><span class="p">&gt;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-5553f21ca8c7057e8567e5e098851e96"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<ol start="53">
<li>Отображение информации только пользователям, ожидающим подтверждения адреса e-mail.</li>
</ol>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-55
shortcode-codeblock-html">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-b01629c30d58397c51496d4e74cb1e2f" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-html" data-lang="html"><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">xf:if</span> <span class="na">is</span><span class="o">=</span><span class="s">&#34;{$xf.visitor.user_state} == &#39;email_confirm_edit&#39;&#34;</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="c">&lt;!-- content --&gt;</span>
</span></span><span class="line"><span class="cl"><span class="p">&lt;/</span><span class="nt">xf:if</span><span class="p">&gt;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-b01629c30d58397c51496d4e74cb1e2f"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<ol start="54">
<li>Отображение информации только пользователям с проблемным адресом e-mail.</li>
</ol>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-56
shortcode-codeblock-html">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-06248e67863ce30c7dae95f3d2216b3f" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-html" data-lang="html"><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">xf:if</span> <span class="na">is</span><span class="o">=</span><span class="s">&#34;{$xf.visitor.user_state} == &#39;email_bounce&#39;&#34;</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="c">&lt;!-- content --&gt;</span>
</span></span><span class="line"><span class="cl"><span class="p">&lt;/</span><span class="nt">xf:if</span><span class="p">&gt;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-06248e67863ce30c7dae95f3d2216b3f"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<ol start="55">
<li>Отображение информации, если ID пользователя = ID автора темы.</li>
</ol>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-57
shortcode-codeblock-html">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-2a2fb33dfcedce4469333d3fa18fdc0b" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-html" data-lang="html"><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">xf:if</span> <span class="na">is</span><span class="o">=</span><span class="s">&#34;{$__globals.thread} AND {$__globals.thread.user_id} == {$user.user_id}&#34;</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="c">&lt;!-- content --&gt;</span>
</span></span><span class="line"><span class="cl"><span class="p">&lt;/</span><span class="nt">xf:if</span><span class="p">&gt;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-2a2fb33dfcedce4469333d3fa18fdc0b"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<ol start="56">
<li>Отображение информации пользователю, который является автором темы.</li>
</ol>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-58
shortcode-codeblock-html">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-fdecc0329bccd302ce1d2e8b7030ec81" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-html" data-lang="html"><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">xf:if</span> <span class="na">is</span><span class="o">=</span><span class="s">&#34;{$thread.user_id} == {$xf.visitor.user_id}&#34;</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="c">&lt;!-- content --&gt;</span>
</span></span><span class="line"><span class="cl"><span class="p">&lt;/</span><span class="nt">xf:if</span><span class="p">&gt;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-fdecc0329bccd302ce1d2e8b7030ec81"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>]]></turbo:content></item><item turbo="true"><title>Настройка и использование Git</title><link>https://lib.onl/ru/2021/08/c35f395f-5921-55eb-afcf-1ad812a1a9d9/</link><pubDate>Sat, 14 Aug 2021 15:52:38 +0000</pubDate><dc:creator>Kai Kimera</dc:creator><category>Linux</category><category>Git</category><category>Терминал</category><category>В доработке</category><yandex:related><link url="https://lib.onl/ru/2021/07/3834fbed-71c8-5979-b6c2-236269f5ecea/">Зеркалирование репозитория между хостингами</link><link url="https://lib.onl/ru/2021/05/8544b8ce-4586-578f-9633-e8ae43441a25/">Синхронизация репозитория от GitHub к GitLab</link></yandex:related><turbo:extendedHtml>true</turbo:extendedHtml><turbo:source>https://lib.onl/ru/2021/08/c35f395f-5921-55eb-afcf-1ad812a1a9d9/</turbo:source><turbo:topic>Настройка и использование Git</turbo:topic><turbo:content><![CDATA[<p>В этой заметке я приведу параметры <span class="shortcode shortcode-tag"><a href="/ru/tags/git/" target="_blank">#Git</a></span>, которые сам использую при работе с репозиториями.</p>
<h2 id="первичная-настройка">
  <a class="link-body-emphasis" href="#%d0%bf%d0%b5%d1%80%d0%b2%d0%b8%d1%87%d0%bd%d0%b0%d1%8f-%d0%bd%d0%b0%d1%81%d1%82%d1%80%d0%be%d0%b9%d0%ba%d0%b0">Первичная настройка</a>
</h2><p>Для начала работы с <span class="shortcode shortcode-tag"><a href="/ru/tags/git/" target="_blank">#Git</a></span>&rsquo;ом, его необходимо хотя бы минимально настроить.</p>
<ol>
<li>Указать своё имя:</li>
</ol>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-0
shortcode-codeblock-bash">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-6eeba5059dd307c8b40e8059bda422cc" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">git config --global user.name <span class="s2">&#34;John Doe&#34;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-6eeba5059dd307c8b40e8059bda422cc"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<ol start="2">
<li>Указать свой адрес e-mail:</li>
</ol>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-1
shortcode-codeblock-bash">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-730eb4be4c6b0ee5caa7afc4b8635532" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">git config --global user.email <span class="s2">&#34;johndoe@example.com&#34;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-730eb4be4c6b0ee5caa7afc4b8635532"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<h2 id="настройка-подписи">
  <a class="link-body-emphasis" href="#%d0%bd%d0%b0%d1%81%d1%82%d1%80%d0%be%d0%b9%d0%ba%d0%b0-%d0%bf%d0%be%d0%b4%d0%bf%d0%b8%d1%81%d0%b8">Настройка подписи</a>
</h2><p>Хорошим тоном будет считаться подпись каждого своего commit&rsquo;а.</p>
<ol>
<li>Выяснить какие ключи установлены в системе (о создании ключей я публиковал заметку <span class="shortcode shortcode-uuid"><a href="/ru/2020/07/7a204545-daa8-58ce-ba35-75e732e1bcc0/">GnuPG: Создание и работа с ключами шифрования</a></span>):</li>
</ol>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-2
shortcode-codeblock-bash">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-21ebc1bb91986f2fd915e633764ed9ca" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">gpg --list-secret-keys --keyid-format<span class="o">=</span>long</span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-21ebc1bb91986f2fd915e633764ed9ca"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<ol start="2">
<li>Указать <span class="shortcode shortcode-tag"><a href="/ru/tags/git/" target="_blank">#Git</a></span>&rsquo;у всегда подписывать каждый commit:</li>
</ol>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-3
shortcode-codeblock-bash">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-93fec9cc31d57adb2dddc2b4ccf89d95" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">git config --global commit.gpgsign true</span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-93fec9cc31d57adb2dddc2b4ccf89d95"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<ol start="3">
<li>Указать <span class="shortcode shortcode-tag"><a href="/ru/tags/git/" target="_blank">#Git</a></span>&rsquo;у идентификатор ключа для подписи commit&rsquo;а:</li>
</ol>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-4
shortcode-codeblock-bash">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-8cbbf5676a80cbdb769f8065c9929762" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">git config --global user.signingkey 3AA5C34371567BD2</span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-8cbbf5676a80cbdb769f8065c9929762"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<h2 id="хранилище-паролей">
  <a class="link-body-emphasis" href="#%d1%85%d1%80%d0%b0%d0%bd%d0%b8%d0%bb%d0%b8%d1%89%d0%b5-%d0%bf%d0%b0%d1%80%d0%be%d0%bb%d0%b5%d0%b9">Хранилище паролей</a>
</h2><p><span class="shortcode shortcode-tag"><a href="/ru/tags/git/" target="_blank">#Git</a></span> по умолчанию не сохраняет регистрационные данные для репозиториев. Эта настройка позволяет указать <span class="shortcode shortcode-tag"><a href="/ru/tags/git/" target="_blank">#Git</a></span>&rsquo;у использовать для хранения регистрационных данных текстовый файл <code>~/.git-credentials</code>:</p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-5
shortcode-codeblock-bash">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-b6fcccae86fffb2f2e98997901cfbdde" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">git config --global credential.helper store</span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-b6fcccae86fffb2f2e98997901cfbdde"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<h2 id="отмена-изменений">
  <a class="link-body-emphasis" href="#%d0%be%d1%82%d0%bc%d0%b5%d0%bd%d0%b0-%d0%b8%d0%b7%d0%bc%d0%b5%d0%bd%d0%b5%d0%bd%d0%b8%d0%b9">Отмена изменений</a>
</h2><p>Отмена конкретного commit&rsquo;а:</p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-6
shortcode-codeblock-bash">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-31e18c68d98fcc58f0773947ebba184d" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">git revert <span class="o">[</span>commit<span class="o">]</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-31e18c68d98fcc58f0773947ebba184d"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<p>Отмена 2-х commit&rsquo;ов подряд:</p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-7
shortcode-codeblock-bash">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-07ea38d2f17a441edde281efb64c28cf" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">git revert HEAD~2</span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-07ea38d2f17a441edde281efb64c28cf"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<h2 id="модули">
  <a class="link-body-emphasis" href="#%d0%bc%d0%be%d0%b4%d1%83%d0%bb%d0%b8">Модули</a>
</h2><p>Добавление модуля:</p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-8
shortcode-codeblock-bash">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-46f086c497da1915780a5ea4d45ab580" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">git submodule add https://github.com/<span class="o">[</span>MODULE<span class="o">]</span> <span class="o">[</span>MODULE<span class="o">]</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-46f086c497da1915780a5ea4d45ab580"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<p>Рекурсивное обновление всех модулей:</p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-9
shortcode-codeblock-bash">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-380d23660578b7e90ec4c646d3283f18" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">git submodule update --recursive --remote --merge</span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-380d23660578b7e90ec4c646d3283f18"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<p>Удаление модуля:</p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-10
shortcode-codeblock-bash">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-5c41bba6a0e16229a12596af59baa789" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">git submodule deinit -f <span class="o">[</span>MODULE<span class="o">]</span>  <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>  <span class="o">&amp;&amp;</span> git rm -r --cached <span class="o">[</span>MODULE<span class="o">]</span>  <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>  <span class="o">&amp;&amp;</span> rm -rf .git/modules/<span class="o">[</span>MODULE<span class="o">]</span> <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>  <span class="o">&amp;&amp;</span> rm -rf <span class="o">[</span>MODULE<span class="o">]</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-5c41bba6a0e16229a12596af59baa789"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<h2 id="изменение-адреса-репозитория">
  <a class="link-body-emphasis" href="#%d0%b8%d0%b7%d0%bc%d0%b5%d0%bd%d0%b5%d0%bd%d0%b8%d0%b5-%d0%b0%d0%b4%d1%80%d0%b5%d1%81%d0%b0-%d1%80%d0%b5%d0%bf%d0%be%d0%b7%d0%b8%d1%82%d0%be%d1%80%d0%b8%d1%8f">Изменение адреса репозитория</a>
</h2><p>Показать текущий адрес:</p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-11
shortcode-codeblock-bash">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-edf721c721c6de5791216cac702cd224" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">git remote -v</span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-edf721c721c6de5791216cac702cd224"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<p>Установить новый адрес:</p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-12
shortcode-codeblock-bash">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-b5b09192c64d5455315309932ea9abac" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">git remote set-url origin <span class="s1">&#39;[URL]&#39;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-b5b09192c64d5455315309932ea9abac"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<h2 id="изменение-описания-последнего-commitа">
  <a class="link-body-emphasis" href="#%d0%b8%d0%b7%d0%bc%d0%b5%d0%bd%d0%b5%d0%bd%d0%b8%d0%b5-%d0%be%d0%bf%d0%b8%d1%81%d0%b0%d0%bd%d0%b8%d1%8f-%d0%bf%d0%be%d1%81%d0%bb%d0%b5%d0%b4%d0%bd%d0%b5%d0%b3%d0%be-commit%d0%b0">Изменение описания последнего commit&rsquo;а</a>
</h2><p>Если закралась ошибка в описании изменений кода при последнем commit&rsquo;е, это описание можно изменить при помощи команды:</p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-13
shortcode-codeblock-bash">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-f2dffc3d264ac79c29f8c772b7680931" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">git commit --amend -m <span class="s1">&#39;New commit message.&#39;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-f2dffc3d264ac79c29f8c772b7680931"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<p>Далее, изменённый коммит принудительно отправить на сервер:</p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-14
shortcode-codeblock-bash">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-028a5bac0fb21604b17035bd5c01ef71" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">git push --force <span class="s1">&#39;[remoteName]&#39;</span> <span class="s1">&#39;[branchName]&#39;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-028a5bac0fb21604b17035bd5c01ef71"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>











  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-15
shortcode-codeblock-bash">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-f8d46e84725b2bf0e29dc530b4579603" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">git push --force <span class="s1">&#39;origin&#39;</span> <span class="s1">&#39;main&#39;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-f8d46e84725b2bf0e29dc530b4579603"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>]]></turbo:content></item><item turbo="true"><title>Зеркалирование репозитория между хостингами</title><link>https://lib.onl/ru/2021/07/3834fbed-71c8-5979-b6c2-236269f5ecea/</link><pubDate>Tue, 06 Jul 2021 17:40:43 +0000</pubDate><dc:creator>Kai Kimera</dc:creator><category>Разработка</category><category>Скрипты</category><yandex:related><link url="https://lib.onl/ru/2021/05/8544b8ce-4586-578f-9633-e8ae43441a25/">Синхронизация репозитория от GitHub к GitLab</link></yandex:related><turbo:extendedHtml>true</turbo:extendedHtml><turbo:source>https://lib.onl/ru/2021/07/3834fbed-71c8-5979-b6c2-236269f5ecea/</turbo:source><turbo:topic>Зеркалирование репозитория между хостингами</turbo:topic><turbo:content><![CDATA[<p>В предыдущей статье <span class="shortcode shortcode-uuid"><a href="/ru/2021/05/8544b8ce-4586-578f-9633-e8ae43441a25/">Синхронизация репозитория от GitHub к GitLab</a></span> я рассказал о том, как организовать синхронизацию между репозиториями <span class="shortcode shortcode-tag"><a href="/ru/tags/git/" target="_blank">#Git</a></span> на разных хостингах, в частности, между <span class="shortcode shortcode-tag"><a href="/ru/tags/github/" target="_blank">#GitHub</a></span> и <span class="shortcode shortcode-tag"><a href="/ru/tags/gitlab/" target="_blank">#GitLab</a></span>. В итоге, я решил сделать <a title="" href="https://github.com/ghastore/github-mirror" target="_blank"
   rel="noopener noreferrer">собственный GitHub Action</a>, который позволяет полностью зеркалировать репозитории.</p>
<h2 id="использование">
  <a class="link-body-emphasis" href="#%d0%b8%d1%81%d0%bf%d0%be%d0%bb%d1%8c%d0%b7%d0%be%d0%b2%d0%b0%d0%bd%d0%b8%d0%b5">Использование</a>
</h2><p>Для подключения зеркалирования, к примеру, с <span class="shortcode shortcode-tag"><a href="/ru/tags/github/" target="_blank">#GitHub</a></span> на <span class="shortcode shortcode-tag"><a href="/ru/tags/gitlab/" target="_blank">#GitLab</a></span>, необходимо в исходном репозитории создать файл <code>.github/workflows/mirror.yml</code>, в котором указать следующее содержимое:</p>

    

    
        
            
            <div class="shortcode shortcode-file mb-3">
              <div class="card overflow-hidden" data-bs-theme="dark">
                <div class="card-header">
                  <div class="d-flex align-items-center">
                    <div class="flex-shrink-0">
                      <i class="far fa-file-code fa-fw"></i>
                    </div>
                    <div class="flex-grow-1 mx-2 text-truncate">
                      <code>mirror.yml</code>
                    </div>
                    <div class="flex-shrink-0">
                      <ul class="list-inline mb-0">
                        <li class="list-inline-item" title='Копировать'>
                          <a class="text-body" href="#"
                             data-fn="clipboard" data-clipboard-target="#cp-726c875e9b57a81f50672709a63dd96a"
                             role="button" aria-label='Копировать'>
                            <i class="fas fa-copy fa-fw"></i>
                          </a>
                        </li>
                        <li class="list-inline-item" title='Скачать'>
                          <a class="text-body" href="/ru/2021/07/3834fbed-71c8-5979-b6c2-236269f5ecea/mirror.yml" download
                             role="button" aria-label='Скачать'>
                            <i class="fas fa-download fa-fw"></i>
                          </a>
                        </li>
                        <li class="list-inline-item" title='Открыть'>
                          <a class="text-body" href="/ru/2021/07/3834fbed-71c8-5979-b6c2-236269f5ecea/mirror.yml" target="_blank"
                             role="button" aria-label='Открыть'>
                            <i class="fas fa-arrow-up-right-from-square fa-fw"></i>
                          </a>
                        </li>
                      </ul>
                    </div>
                  </div>
                </div>
                <div class="card-body p-0 overflow-auto" id="cp-726c875e9b57a81f50672709a63dd96a">
                    
                        
                    
                    <div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-yml" data-lang="yml"><span class="line"><span class="cl"><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;Repository Mirror&#34;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">on</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span>- <span class="l">push</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">jobs</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">mirror</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">runs-on</span><span class="p">:</span><span class="w"> </span><span class="l">ubuntu-latest</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;Mirror&#34;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">steps</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span>- <span class="nt">uses</span><span class="p">:</span><span class="w"> </span><span class="l">pkgstore/github-action-mirror@main</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="nt">with</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">          </span><span class="nt">src_repo</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;https://github.com/${{ github.repository }}.git&#34;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">          </span><span class="nt">src_user</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;${{ secrets.MIRROR_SOURCE_USER_GITHUB }}&#34;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">          </span><span class="nt">src_token</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;${{ secrets.MIRROR_SOURCE_TOKEN_GITHUB }}&#34;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">          </span><span class="nt">dsc_repo</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;https://gitlab.com/${{ github.repository }}.git&#34;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">          </span><span class="nt">dsc_user</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;${{ secrets.MIRROR_TARGET_USER_GITLAB }}&#34;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">          </span><span class="nt">dsc_token</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;${{ secrets.MIRROR_TARGET_TOKEN_GITLAB }}&#34;</span></span></span></code></pre></td></tr></table>
</div>
</div>
                </div>
              </div>
            </div>
        
    
<ul>
<li><code>src_repo</code> - <strong>URL</strong> исходного репозитория.</li>
<li><code>src_user</code> - <strong>пользователь</strong> исходного репозитория.</li>
<li><code>src_token</code> - <strong>токен пользователя</strong> исходного репозитория.</li>
<li><code>dsc_repo</code> - <strong>URL</strong> зеркального репозитория.</li>
<li><code>dsc_user</code> - <strong>пользователь</strong> зеркального репозитория.</li>
<li><code>dsc_token</code> - <strong>токен пользователя</strong> зеркального репозитория.</li>
</ul>
<p>В этом коде стоит обратить внимание на параметр <code>target_repo</code>. <span class="shortcode shortcode-tag"><a href="/ru/tags/gitlab/" target="_blank">#GitLab</a></span> позволяет автоматически создавать репозиторий при зеркалировании, а так как у меня адреса репозиториев совпадают между <span class="shortcode shortcode-tag"><a href="/ru/tags/github/" target="_blank">#GitHub</a></span> и <span class="shortcode shortcode-tag"><a href="/ru/tags/gitlab/" target="_blank">#GitLab</a></span>, мне гораздо проще выстроить конструкцию <code>https://gitlab.com/${{ github.repository }}.git</code>. Переменная <code>${{ github.repository }}</code> содержит имя пользователя / организации и название репозитория, и, при настройке зеркалирования репозитория на <span class="shortcode shortcode-tag"><a href="/ru/tags/github/" target="_blank">#GitHub</a></span>&rsquo;е, зеркало репозитория автоматически создаётся на <span class="shortcode shortcode-tag"><a href="/ru/tags/gitlab/" target="_blank">#GitLab</a></span>&rsquo;е.</p>]]></turbo:content></item><item turbo="true"><title>Генератор иконок для сайта</title><link>https://lib.onl/ru/2021/05/841ba281-a22b-55ee-b97d-251a5dc111d8/</link><pubDate>Tue, 18 May 2021 07:41:46 +0000</pubDate><dc:creator>Kai Kimera</dc:creator><category>Разработка</category><category>Скрипты</category><turbo:extendedHtml>true</turbo:extendedHtml><turbo:source>https://lib.onl/ru/2021/05/841ba281-a22b-55ee-b97d-251a5dc111d8/</turbo:source><turbo:topic>Генератор иконок для сайта</turbo:topic><turbo:content><![CDATA[<p>Сделал для сайта автоматизированное создание иконок типа <code>favicon</code>, которыми пользуются браузеры и устройства для своих нужд.</p>
<p>Я накидал небольшой скрипт, состоящий из двух функций <code>png()</code> и <code>ico()</code>. Функция <code>png()</code> берёт файл <code>favicon.svg</code> и преобразует его в <span class="shortcode shortcode-tag">PNG</span>, указанных в массиве <code>size</code>, размеров. Функция <code>ico()</code> также берёт файл <code>favicon.svg</code> и преобразует его в формат <span class="shortcode shortcode-tag">ICO</span>, который содержит в себе несколько размеров изображения.</p>

    

    
        
            
            <div class="shortcode shortcode-file mb-3">
              <div class="card overflow-hidden" data-bs-theme="dark">
                <div class="card-header">
                  <div class="d-flex align-items-center">
                    <div class="flex-shrink-0">
                      <i class="far fa-file-code fa-fw"></i>
                    </div>
                    <div class="flex-grow-1 mx-2 text-truncate">
                      <code>favicon.sh</code>
                    </div>
                    <div class="flex-shrink-0">
                      <ul class="list-inline mb-0">
                        <li class="list-inline-item" title='Копировать'>
                          <a class="text-body" href="#"
                             data-fn="clipboard" data-clipboard-target="#cp-f8d3391104c8e397238f676c91a7f11f"
                             role="button" aria-label='Копировать'>
                            <i class="fas fa-copy fa-fw"></i>
                          </a>
                        </li>
                        <li class="list-inline-item" title='Скачать'>
                          <a class="text-body" href="/ru/2021/05/841ba281-a22b-55ee-b97d-251a5dc111d8/favicon.sh" download
                             role="button" aria-label='Скачать'>
                            <i class="fas fa-download fa-fw"></i>
                          </a>
                        </li>
                        <li class="list-inline-item" title='Открыть'>
                          <a class="text-body" href="/ru/2021/05/841ba281-a22b-55ee-b97d-251a5dc111d8/favicon.sh" target="_blank"
                             role="button" aria-label='Открыть'>
                            <i class="fas fa-arrow-up-right-from-square fa-fw"></i>
                          </a>
                        </li>
                      </ul>
                    </div>
                  </div>
                </div>
                <div class="card-body p-0 overflow-auto" id="cp-f8d3391104c8e397238f676c91a7f11f">
                    
                        
                    
                    <div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sh" data-lang="sh"><span class="line"><span class="cl"><span class="cp">#!/usr/bin/env -S bash -eu
</span></span></span><span class="line"><span class="cl"><span class="cp"></span><span class="c1"># -------------------------------------------------------------------------------------------------------------------- #</span>
</span></span><span class="line"><span class="cl"><span class="c1"># FAVICON.ICO</span>
</span></span><span class="line"><span class="cl"><span class="c1"># Generating &#39;favicon.ico&#39; file.</span>
</span></span><span class="line"><span class="cl"><span class="c1"># -------------------------------------------------------------------------------------------------------------------- #</span>
</span></span><span class="line"><span class="cl"><span class="c1"># @package    Bash</span>
</span></span><span class="line"><span class="cl"><span class="c1"># @author     Kai Kimera &lt;mail@kai.kim&gt;</span>
</span></span><span class="line"><span class="cl"><span class="c1"># @copyright  2023 Library Online</span>
</span></span><span class="line"><span class="cl"><span class="c1"># @license    MIT</span>
</span></span><span class="line"><span class="cl"><span class="c1"># @version    0.1.0</span>
</span></span><span class="line"><span class="cl"><span class="c1"># @link       https://lib.onl/ru/2021/05/841ba281-a22b-55ee-b97d-251a5dc111d8/</span>
</span></span><span class="line"><span class="cl"><span class="c1"># -------------------------------------------------------------------------------------------------------------------- #</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nv">size</span><span class="o">=(</span> <span class="m">16</span> <span class="m">24</span> <span class="m">32</span> <span class="m">48</span> <span class="m">64</span> <span class="m">72</span> <span class="m">80</span> <span class="m">96</span> <span class="m">128</span> <span class="m">144</span> <span class="m">152</span> <span class="m">167</span> <span class="m">180</span> <span class="m">192</span> <span class="m">196</span> <span class="m">256</span> <span class="m">300</span> <span class="m">512</span> <span class="o">)</span>
</span></span><span class="line"><span class="cl"><span class="nv">svg</span><span class="o">=</span><span class="s1">&#39;favicon.svg&#39;</span>
</span></span><span class="line"><span class="cl"><span class="nv">ico</span><span class="o">=</span><span class="s1">&#39;favicon.ico&#39;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">png<span class="o">()</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">  _check_file
</span></span><span class="line"><span class="cl">  <span class="k">for</span> i in <span class="s2">&#34;</span><span class="si">${</span><span class="nv">size</span><span class="p">[@]</span><span class="si">}</span><span class="s2">&#34;</span><span class="p">;</span> <span class="k">do</span>
</span></span><span class="line"><span class="cl">    rsvg-convert -w <span class="s2">&#34;</span><span class="si">${</span><span class="nv">i</span><span class="si">}</span><span class="s2">&#34;</span> -h <span class="s2">&#34;</span><span class="si">${</span><span class="nv">i</span><span class="si">}</span><span class="s2">&#34;</span> <span class="s2">&#34;</span><span class="si">${</span><span class="nv">svg</span><span class="si">}</span><span class="s2">&#34;</span> -o <span class="s2">&#34;favicon-</span><span class="si">${</span><span class="nv">i</span><span class="si">}</span><span class="s2">.png&#34;</span>
</span></span><span class="line"><span class="cl">  <span class="k">done</span>
</span></span><span class="line"><span class="cl"><span class="o">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">ico<span class="o">()</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">  _check_file
</span></span><span class="line"><span class="cl">  convert -density <span class="s1">&#39;256x256&#39;</span> -background <span class="s1">&#39;transparent&#39;</span> <span class="s2">&#34;</span><span class="si">${</span><span class="nv">svg</span><span class="si">}</span><span class="s2">&#34;</span> -define <span class="s1">&#39;icon:auto-resize&#39;</span> -colors <span class="s1">&#39;256&#39;</span> <span class="s2">&#34;</span><span class="si">${</span><span class="nv">ico</span><span class="si">}</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl">  identify <span class="s2">&#34;</span><span class="si">${</span><span class="nv">ico</span><span class="si">}</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl"><span class="o">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">_check_file<span class="o">()</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">  <span class="o">[[</span> -f <span class="s2">&#34;</span><span class="si">${</span><span class="nv">svg</span><span class="si">}</span><span class="s2">&#34;</span> <span class="o">]]</span> <span class="o">||</span> <span class="o">{</span> <span class="nb">printf</span> <span class="s1">&#39;%s does not exist!\n&#39;</span> <span class="s2">&#34;</span><span class="si">${</span><span class="nv">svg</span><span class="si">}</span><span class="s2">&#34;</span><span class="p">;</span> <span class="nb">exit</span> 1<span class="p">;</span> <span class="o">}</span>
</span></span><span class="line"><span class="cl"><span class="o">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="s2">&#34;</span><span class="nv">$@</span><span class="s2">&#34;</span></span></span></code></pre></td></tr></table>
</div>
</div>
                </div>
              </div>
            </div>
        
    
<h2 id="использование">
  <a class="link-body-emphasis" href="#%d0%b8%d1%81%d0%bf%d0%be%d0%bb%d1%8c%d0%b7%d0%be%d0%b2%d0%b0%d0%bd%d0%b8%d0%b5">Использование</a>
</h2><p>Для работы скрипта необходимо, чтобы в системе были установлены <span class="shortcode shortcode-tag">RSVG</span> и <span class="shortcode shortcode-tag"><a href="/ru/tags/imagemagick/" target="_blank">#ImageMagick</a></span>. Скрипт можно сохранить с произвольным именем, например, <code>favicon.sh</code> в директорию, где находится изображение <code>favicon.svg</code>. Далее, вызывать функции следующим образом:</p>











<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-0 shortcode-codeblock-terminal
shortcode-codeblock-terminal-linux
shortcode-codeblock-terminal-linux-user">
  <div class="card overflow-hidden" data-bs-theme="dark">
    <div class="card-header">
      <div class="d-flex align-items-center">
        <div class="flex-shrink-0 ">
          <i class="fas fa-terminal fa-fw"></i>
        </div>
        <div class="flex-grow-1 mx-2">
          <h5 class="mb-0">Терминал</h5>
        </div>
        <div class="flex-shrink-0">
          <ul class="list-inline mb-0">
            <li class="list-inline-item" title='Копировать'>
              <a class="text-body" href="#"
                 data-fn="clipboard" data-clipboard-target="#cp-6e587f69db61f133d2193f49a9b3bb67"
                 role="button" aria-label='Копировать'>
                <i class="fas fa-copy fa-fw"></i>
              </a>
            </li>
          </ul>
        </div>
      </div>
    </div>
    <div class="card-body p-0 overflow-auto" id="cp-6e587f69db61f133d2193f49a9b3bb67"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-plaintext" data-lang="plaintext"><span class="line"><span class="cl">bash favicon.sh png</span></span></code></pre></td></tr></table>
</div>
</div></div>
  </div>
</div>











<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-1 shortcode-codeblock-terminal
shortcode-codeblock-terminal-linux
shortcode-codeblock-terminal-linux-user">
  <div class="card overflow-hidden" data-bs-theme="dark">
    <div class="card-header">
      <div class="d-flex align-items-center">
        <div class="flex-shrink-0 ">
          <i class="fas fa-terminal fa-fw"></i>
        </div>
        <div class="flex-grow-1 mx-2">
          <h5 class="mb-0">Терминал</h5>
        </div>
        <div class="flex-shrink-0">
          <ul class="list-inline mb-0">
            <li class="list-inline-item" title='Копировать'>
              <a class="text-body" href="#"
                 data-fn="clipboard" data-clipboard-target="#cp-e08bfa0ff7c78996f0ce2b34133eb977"
                 role="button" aria-label='Копировать'>
                <i class="fas fa-copy fa-fw"></i>
              </a>
            </li>
          </ul>
        </div>
      </div>
    </div>
    <div class="card-body p-0 overflow-auto" id="cp-e08bfa0ff7c78996f0ce2b34133eb977"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-plaintext" data-lang="plaintext"><span class="line"><span class="cl">bash favicon.sh ico</span></span></code></pre></td></tr></table>
</div>
</div></div>
  </div>
</div>
<p>Скрипт ищет файл <code>favicon.svg</code> и преобразует его в необходимые изображения.</p>]]></turbo:content></item><item turbo="true"><title>Обновление Fedora Linux до актуальной версии</title><link>https://lib.onl/ru/2021/05/0acd3f9d-07b7-52b8-9fac-b5cb1cc579e0/</link><pubDate>Sat, 15 May 2021 20:29:16 +0000</pubDate><dc:creator>Kai Kimera</dc:creator><category>Терминал</category><category>Linux</category><yandex:related><link url="https://lib.onl/ru/2020/06/59781965-afe7-5dd5-9798-d1c5ba6cdafd/">Первичная настройка UAIK</link></yandex:related><turbo:extendedHtml>true</turbo:extendedHtml><turbo:source>https://lib.onl/ru/2021/05/0acd3f9d-07b7-52b8-9fac-b5cb1cc579e0/</turbo:source><turbo:topic>Обновление Fedora Linux до актуальной версии</turbo:topic><turbo:content><![CDATA[<p>Новые версии <span class="shortcode shortcode-tag"><a href="/ru/tags/fedora/" target="_blank">#Fedora</a></span> публикуются каждые 6-8 месяцев. В этой статье я опишу шаги по обновлению дистрибутива между версиями.</p>
<ol>
<li>Устанавливаем плагин обновления системы:</li>
</ol>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-0
shortcode-codeblock-bash">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-e0ac33f04dce839b1fde6161dfcdb0d4" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">dnf install dnf-plugin-system-upgrade</span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-e0ac33f04dce839b1fde6161dfcdb0d4"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<ol start="2">
<li>Скачивание актуальной версии системы:</li>
</ol>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-1
shortcode-codeblock-bash">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-19a080e04d6dc8f8f3c58ae7d15f0a84" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">dnf system-upgrade download --releasever<span class="o">=</span><span class="m">34</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-19a080e04d6dc8f8f3c58ae7d15f0a84"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<ul>
<li><code>releasever</code> - номер актуальной версии системы.</li>
</ul>
<ol start="3">
<li>Запуск обновления системы на актуальную версию:</li>
</ol>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-2
shortcode-codeblock-bash">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-6b16a4401af6c04517799460ffb1951f" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">dnf system-upgrade reboot</span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-6b16a4401af6c04517799460ffb1951f"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<p>Вот и всё. Система обновит пакетную базу и перезагрузится.</p>]]></turbo:content></item></channel></rss>