<?xml version='1.0' encoding='UTF-8'?><rss version="2.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:yandex="http://news.yandex.ru" xmlns:turbo="http://turbo.yandex.ru"><channel><title>Library Online</title><link>https://lib.onl/ru/</link><description>Заметки на тему администрирования и разработки различных систем, приложений и серверов.</description><language>ru-RU</language><item turbo="true"><title>MikroTik: Сертификат Let's Encrypt</title><link>https://lib.onl/ru/2024/11/f892bebc-3ecd-518a-a948-27eed31649da/</link><pubDate>Thu, 21 Nov 2024 08:05:43 +0000</pubDate><dc:creator>Kai Kimera</dc:creator><category>Скрипты</category><category>Сеть</category><category>Безопасность</category><yandex:related><link url="https://lib.onl/ru/2024/04/326618af-d950-5001-8114-57c66bb8a5af/">MikroTik: Туннель GRE/IPsec (Site-to-Site)</link><link url="https://lib.onl/ru/2024/04/146e83d5-f571-5273-9a29-172bf5dc10fe/">MikroTik: Туннель WireGuard (Site-to-Site) + OSPF</link><link url="https://lib.onl/ru/2024/03/54a2b39f-38b4-5f0c-9b54-310f853da38f/">MikroTik: Туннель IPsec (Site-to-Site)</link><link url="https://lib.onl/ru/2023/12/0f3478b3-9fde-59aa-a424-ff160431fa35/">MikroTik: Базовая настройка</link><link url="https://lib.onl/ru/2023/10/cc13623b-970c-5950-867e-168f9ba9025a/">MikroTik: Добавление корневых сертификатов в RouterOS</link><link url="https://lib.onl/ru/2020/07/ff2ae66e-8e14-5c4a-baa6-0cd2e59f6517/">MikroTik и CloudFlare: Динамический IP для домена</link><link url="https://lib.onl/ru/2024/11/1f5924fa-7a3d-574e-a15d-8a41208fe10d/">Автоматическое получение и обновление сертификатов Let's Encrypt</link><link url="https://lib.onl/ru/2023/12/b6c7c5cd-1b0d-5fcd-8dd2-f28f87a5064c/">MikroTik: Настройка DoH</link></yandex:related><turbo:extendedHtml>true</turbo:extendedHtml><turbo:source>https://lib.onl/ru/2024/11/f892bebc-3ecd-518a-a948-27eed31649da/</turbo:source><turbo:topic>MikroTik: Сертификат Let's Encrypt</turbo:topic><turbo:content><![CDATA[<p>Алгоритм получения сертификата Let&rsquo;s Encrypt и последующего его продления при помощи скрипта.</p>
<h2 id="получение-сертификата">
  <a class="link-body-emphasis" href="#%d0%bf%d0%be%d0%bb%d1%83%d1%87%d0%b5%d0%bd%d0%b8%d0%b5-%d1%81%d0%b5%d1%80%d1%82%d0%b8%d1%84%d0%b8%d0%ba%d0%b0%d1%82%d0%b0">Получение сертификата</a>
</h2><ul>
<li>Создать правило в брандмауэре, которое будет разрешать обращение к порту <code>80</code> IP-адресов из списка <code>acme</code>:</li>
</ul>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-0
shortcode-codeblock-plaintext">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-ba0ad02aa32d18d0868a01fddaea12b0" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-plaintext" data-lang="plaintext"><span class="line"><span class="cl">/ip firewall filter add action=accept chain=input dst-port=80 protocol=tcp src-address-list=acme comment=&#34;[ROS] ACME&#34;</span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-ba0ad02aa32d18d0868a01fddaea12b0"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<ul>
<li>Включить сервис <code>WWW</code>:</li>
</ul>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-1
shortcode-codeblock-plaintext">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-78463db59b2aa9f5e6fd0edc10f478ab" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-plaintext" data-lang="plaintext"><span class="line"><span class="cl">/ip service enable www</span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-78463db59b2aa9f5e6fd0edc10f478ab"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<ul>
<li>Добавить адрес <code>0.0.0.0/0</code> в адрес-лист <code>acme</code> на 2 минуты:</li>
</ul>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-2
shortcode-codeblock-plaintext">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-fed516b120c5a6cf91e1f84688f9bee7" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-plaintext" data-lang="plaintext"><span class="line"><span class="cl">/ip firewall address-list add list=acme address=0.0.0.0/0 timeout=00:02:00 comment=&#34;[ROS] ACME running...&#34;</span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-fed516b120c5a6cf91e1f84688f9bee7"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<ul>
<li>Запустить получение сертификата для домена <code>sub.example.com</code>:</li>
</ul>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-3
shortcode-codeblock-plaintext">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-7bc6b50269c359f5c1ccb2b4e863a4c1" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-plaintext" data-lang="plaintext"><span class="line"><span class="cl">/certificate enable-ssl-certificate dns-name=sub.example.com</span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-7bc6b50269c359f5c1ccb2b4e863a4c1"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<ul>
<li>Отключить сервис <code>WWW</code>:</li>
</ul>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-4
shortcode-codeblock-plaintext">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-934d356cb426994fa1de01a27d1ecbfa" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-plaintext" data-lang="plaintext"><span class="line"><span class="cl">/ip service disable www</span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-934d356cb426994fa1de01a27d1ecbfa"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<h2 id="скрипт">
  <a class="link-body-emphasis" href="#%d1%81%d0%ba%d1%80%d0%b8%d0%bf%d1%82">Скрипт</a>
</h2><p>Сертификат получен, но по условиям Let&rsquo;s Encrypt, его необходимо продлевать каждые 90 дней. Этим занимается специальный скрип, который будет контролировать количество дней до истечения действия сертификата и перезапускать задачу на получения нового.</p>
<h3 id="приложение">
  <a class="link-body-emphasis" href="#%d0%bf%d1%80%d0%b8%d0%bb%d0%be%d0%b6%d0%b5%d0%bd%d0%b8%d0%b5">Приложение</a>
</h3>
    

    
        
            
            <div class="shortcode shortcode-file mb-3">
              <div class="card overflow-hidden" data-bs-theme="dark">
                <div class="card-header">
                  <div class="d-flex align-items-center">
                    <div class="flex-shrink-0">
                      <i class="far fa-file-code fa-fw"></i>
                    </div>
                    <div class="flex-grow-1 mx-2 text-truncate">
                      <code>ros.acme.rsc</code>
                    </div>
                    <div class="flex-shrink-0">
                      <ul class="list-inline mb-0">
                        <li class="list-inline-item" title='Копировать'>
                          <a class="text-body" href="#"
                             data-fn="clipboard" data-clipboard-target="#cp-c77a02e2d76e039263cbcd3d794c382a"
                             role="button" aria-label='Копировать'>
                            <i class="fas fa-copy fa-fw"></i>
                          </a>
                        </li>
                        <li class="list-inline-item" title='Скачать'>
                          <a class="text-body" href="/ru/2024/11/f892bebc-3ecd-518a-a948-27eed31649da/ros.acme.rsc" download
                             role="button" aria-label='Скачать'>
                            <i class="fas fa-download fa-fw"></i>
                          </a>
                        </li>
                        <li class="list-inline-item" title='Открыть'>
                          <a class="text-body" href="/ru/2024/11/f892bebc-3ecd-518a-a948-27eed31649da/ros.acme.rsc" target="_blank"
                             role="button" aria-label='Открыть'>
                            <i class="fas fa-arrow-up-right-from-square fa-fw"></i>
                          </a>
                        </li>
                      </ul>
                    </div>
                  </div>
                </div>
                <div class="card-body p-0 overflow-auto" id="cp-c77a02e2d76e039263cbcd3d794c382a">
                    
                    <div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-text" data-lang="text"><span class="line"><span class="cl"># LET&#39;S ENCRYPT
</span></span><span class="line"><span class="cl"># -------------------------------------------------------------------------------------------------------------------- #
</span></span><span class="line"><span class="cl"># @package    RouterOS
</span></span><span class="line"><span class="cl"># @author     Kai Kimera &lt;mail@kai.kim&gt;
</span></span><span class="line"><span class="cl"># @copyright  2024 Library Online
</span></span><span class="line"><span class="cl"># @license    MIT
</span></span><span class="line"><span class="cl"># @version    0.1.0
</span></span><span class="line"><span class="cl"># @policy     read, write, test
</span></span><span class="line"><span class="cl"># @schedule:  1d 00:00:00
</span></span><span class="line"><span class="cl"># @link       https://lib.onl/ru/2024/11/f892bebc-3ecd-518a-a948-27eed31649da/
</span></span><span class="line"><span class="cl"># -------------------------------------------------------------------------------------------------------------------- #
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">:local crtApi &#34;https://acme-v02.api.letsencrypt.org/directory&#34;
</span></span><span class="line"><span class="cl">:local crtDays 30d
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"># -------------------------------------------------------------------------------------------------------------------- #
</span></span><span class="line"><span class="cl"># -----------------------------------------------------&lt; SCRIPT &gt;----------------------------------------------------- #
</span></span><span class="line"><span class="cl"># -------------------------------------------------------------------------------------------------------------------- #
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">:local crtDomain
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">/certificate
</span></span><span class="line"><span class="cl">:foreach i in=[find where issuer~&#34;Let&#39;s Encrypt&#34;] do={
</span></span><span class="line"><span class="cl">  :if (([get $i expires-after] &lt; $crtDays) || [get $i expired]) do={
</span></span><span class="line"><span class="cl">    :set crtDomain [get $i common-name]
</span></span><span class="line"><span class="cl">    :do { remove $i } on-error={ :log error &#34;ACME: $crtDomain not found!&#34; }
</span></span><span class="line"><span class="cl">    :do {
</span></span><span class="line"><span class="cl">      :log info &#34;ACME: $crtDomain renewal starting...&#34;
</span></span><span class="line"><span class="cl">      /ip service enable www
</span></span><span class="line"><span class="cl">      /ip firewall address-list add list=acme address=0.0.0.0/0 timeout=00:02:00 comment=&#34;[ROS] ACME running...&#34;
</span></span><span class="line"><span class="cl">      /certificate enable-ssl-certificate directory-url=&#34;$crtApi&#34; dns-name=$crtDomain; :delay 60s
</span></span><span class="line"><span class="cl">      /ip service disable www
</span></span><span class="line"><span class="cl">      /ip service set api-ssl certificate=$crtDomain
</span></span><span class="line"><span class="cl">      /ip service set www-ssl certificate=$crtDomain
</span></span><span class="line"><span class="cl">      /interface sstp-server server set certificate=$crtDomain
</span></span><span class="line"><span class="cl">      :log info &#34;ACME: $crtDomain renewal completed!&#34;
</span></span><span class="line"><span class="cl">    } on-error={ :log error &#34;ACME: $crtDomain renewal failed!&#34; }
</span></span><span class="line"><span class="cl">  }
</span></span><span class="line"><span class="cl">}</span></span></code></pre></td></tr></table>
</div>
</div>
                </div>
              </div>
            </div>
        
    
<h4 id="параметры">
  <a class="link-body-emphasis" href="#%d0%bf%d0%b0%d1%80%d0%b0%d0%bc%d0%b5%d1%82%d1%80%d1%8b">Параметры</a>
</h4><ul>
<li><code>crtApi</code> - ссылка на ACME API. Принимает следующие значения:
<ul>
<li><code>https://acme-staging-v02.api.letsencrypt.org/directory</code> - API для тестирования заказа сертификата.</li>
<li><code>https://acme-v02.api.letsencrypt.org/directory</code> - основное API для заказа сертификата.</li>
</ul>
</li>
<li><code>crtDays</code> - количество дней до окончания срока действия сертификата.</li>
</ul>
<h3 id="установка">
  <a class="link-body-emphasis" href="#%d1%83%d1%81%d1%82%d0%b0%d0%bd%d0%be%d0%b2%d0%ba%d0%b0">Установка</a>
</h3><p>После настройки скрипта, его нужно добавить в репозиторий скриптов <span class="shortcode shortcode-tag"><a href="/ru/tags/routeros/" target="_blank">#RouterOS</a></span>. Находится репозиторий в System / Scripts. При добавлении скрипта, необходимо выбрать политики <code>read</code>, <code>write</code>, <code>test</code>.</p>
<h3 id="планировщик">
  <a class="link-body-emphasis" href="#%d0%bf%d0%bb%d0%b0%d0%bd%d0%b8%d1%80%d0%be%d0%b2%d1%89%d0%b8%d0%ba">Планировщик</a>
</h3><p>Скрипт должен переодически запускаться для проверки сертификатов. В этом поможет планировщик <span class="shortcode shortcode-tag"><a href="/ru/tags/routeros/" target="_blank">#RouterOS</a></span>. Заходим в System / Scheduler и создаём задачу с политиками <code>read</code>, <code>write</code>, <code>test</code>. В поле <strong>On Event</strong> вписываем точное название скрипта, ранее добавленного в репозиторий <span class="shortcode shortcode-tag"><a href="/ru/tags/routeros/" target="_blank">#RouterOS</a></span>.</p>]]></turbo:content></item><item turbo="true"><title>Как отключить ECH для домена за CloudFlare?</title><link>https://lib.onl/ru/2024/11/7cd2eb8b-4695-5737-8a9b-fa7b3a903562/</link><pubDate>Tue, 12 Nov 2024 18:48:59 +0000</pubDate><dc:creator>Kai Kimera</dc:creator><category>Ech</category><category>Cloudflare</category><category>Tls</category><category>Curl</category><category>Json</category><yandex:related><link url="https://lib.onl/ru/2023/10/3c4c6709-69a6-54be-9404-e4b7ede6ab90/">Как при помощи CloudFlare заменить в URL одну директорию на другую?</link></yandex:related><turbo:extendedHtml>true</turbo:extendedHtml><turbo:source>https://lib.onl/ru/2024/11/7cd2eb8b-4695-5737-8a9b-fa7b3a903562/</turbo:source><turbo:topic>Как отключить ECH для домена за CloudFlare?</turbo:topic><turbo:content>&lt;p>РКН начал блокировать технологию &lt;strong>ECH (Encrypted Client Hello)&lt;/strong>, соответственно, и домены, использующие эту технологию. Как можно её отключить?&lt;/p></turbo:content></item><item turbo="true"><title>Автоматическое получение и обновление сертификатов Let's Encrypt</title><link>https://lib.onl/ru/2024/11/1f5924fa-7a3d-574e-a15d-8a41208fe10d/</link><pubDate>Tue, 12 Nov 2024 11:59:17 +0000</pubDate><dc:creator>Kai Kimera</dc:creator><category>Скрипты</category><category>Безопасность</category><category>Терминал</category><category>Linux</category><yandex:related><link url="https://lib.onl/ru/2024/11/45ffdbeb-37ec-5ed2-b3cd-347df5e3d07b/">Jigasi: "The following addresses failed: RFC 6120 A/AAAA Endpoint"</link><link url="https://lib.onl/ru/2024/10/0a633c87-935c-54ba-bedf-9c95152b6b51/">Автоматическое закрытие конференц-комнаты в Asterisk</link><link url="https://lib.onl/ru/2024/06/b29b331d-ac93-5193-83ef-beab5a0f8dff/">Linux: Пользователи и группы</link><link url="https://lib.onl/ru/2024/03/6c7a038f-f41e-5a45-a285-b99fdacf82d4/">Работа с ZFS</link></yandex:related><turbo:extendedHtml>true</turbo:extendedHtml><turbo:source>https://lib.onl/ru/2024/11/1f5924fa-7a3d-574e-a15d-8a41208fe10d/</turbo:source><turbo:topic>Автоматическое получение и обновление сертификатов Let's Encrypt</turbo:topic><turbo:content><![CDATA[<p>Скрипт для автоматизации массового получения и обновления сертификатов. Базируется на библиотеке <span class="shortcode shortcode-tag"><a href="/ru/tags/lego/" target="_blank">#LeGo</a></span>.</p>
<h2 id="установка">
  <a class="link-body-emphasis" href="#%d1%83%d1%81%d1%82%d0%b0%d0%bd%d0%be%d0%b2%d0%ba%d0%b0">Установка</a>
</h2><ul>
<li>Скопировать файлы <code>app.acme.lego.conf</code>, <code>app.acme.lego.example.com.conf</code> и <code>app.acme.lego.sh</code> в директорию <code>/root/apps/acme/</code>.</li>
<li>Указать бит выполнения для <code>*.sh</code> скриптов: <code>chmod +x /root/apps/acme/*.sh</code>.</li>
<li>Скопировать файл <code>app_acme_lego</code> в директорию <code>/etc/cron.d/</code>.</li>
<li>Настроить параметры скрипта в файлах <code>app.acme.lego.conf</code> и <code>app.acme.lego.example.com.conf</code>.</li>
<li>При заказе первого сертификата для домена, необходимо выполнить следующую команду:</li>
</ul>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-0
shortcode-codeblock-bash">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-e0a029a9e1ba0222d3ea7449a8cd1a02" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">~/apps/acme/app.acme.lego.sh <span class="s1">&#39;example.com&#39;</span> <span class="s1">&#39;run&#39;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-e0a029a9e1ba0222d3ea7449a8cd1a02"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<h2 id="скрипт">
  <a class="link-body-emphasis" href="#%d1%81%d0%ba%d1%80%d0%b8%d0%bf%d1%82">Скрипт</a>
</h2><p>Скрипт состоит из 4-х компонентов:</p>
<ul>
<li>Файл с основными настройками.</li>
<li>Файл с настройками домена.</li>
<li>Приложение.</li>
<li>Задача для CRON.</li>
</ul>
<h3 id="общая-конфигурация">
  <a class="link-body-emphasis" href="#%d0%be%d0%b1%d1%89%d0%b0%d1%8f-%d0%ba%d0%be%d0%bd%d1%84%d0%b8%d0%b3%d1%83%d1%80%d0%b0%d1%86%d0%b8%d1%8f">Общая конфигурация</a>
</h3><p>Файл в общими параметрами скрипта. Этот файл подключается первым и содержит в себе общие параметры для всех доменов. Общие параметры можно переопределять файлом конфигурации домена.</p>

    

    
        
            
            <div class="shortcode shortcode-file mb-3">
              <div class="card overflow-hidden" data-bs-theme="dark">
                <div class="card-header">
                  <div class="d-flex align-items-center">
                    <div class="flex-shrink-0">
                      <i class="far fa-file-code fa-fw"></i>
                    </div>
                    <div class="flex-grow-1 mx-2 text-truncate">
                      <code>app.acme.lego.conf</code>
                    </div>
                    <div class="flex-shrink-0">
                      <ul class="list-inline mb-0">
                        <li class="list-inline-item" title='Копировать'>
                          <a class="text-body" href="#"
                             data-fn="clipboard" data-clipboard-target="#cp-178cd9430ebdbc34553ccab7d3329a3e"
                             role="button" aria-label='Копировать'>
                            <i class="fas fa-copy fa-fw"></i>
                          </a>
                        </li>
                        <li class="list-inline-item" title='Скачать'>
                          <a class="text-body" href="/ru/2024/11/1f5924fa-7a3d-574e-a15d-8a41208fe10d/app.acme.lego.conf" download
                             role="button" aria-label='Скачать'>
                            <i class="fas fa-download fa-fw"></i>
                          </a>
                        </li>
                        <li class="list-inline-item" title='Открыть'>
                          <a class="text-body" href="/ru/2024/11/1f5924fa-7a3d-574e-a15d-8a41208fe10d/app.acme.lego.conf" target="_blank"
                             role="button" aria-label='Открыть'>
                            <i class="fas fa-arrow-up-right-from-square fa-fw"></i>
                          </a>
                        </li>
                      </ul>
                    </div>
                  </div>
                </div>
                <div class="card-body p-0 overflow-auto" id="cp-178cd9430ebdbc34553ccab7d3329a3e">
                    
                    <div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="nv">ACME_SERVER</span><span class="o">=</span><span class="s1">&#39;https://acme-staging-v02.api.letsencrypt.org/directory&#39;</span>
</span></span><span class="line"><span class="cl"><span class="c1"># ACME_SERVER=&#39;https://acme-v02.api.letsencrypt.org/directory&#39;</span>
</span></span><span class="line"><span class="cl"><span class="nv">ACME_EMAIL</span><span class="o">=</span><span class="s1">&#39;mail@example.com&#39;</span>
</span></span><span class="line"><span class="cl"><span class="nv">ACME_PATH</span><span class="o">=</span><span class="s1">&#39;/etc/ssl/acme&#39;</span>
</span></span><span class="line"><span class="cl"><span class="nv">ACME_METHOD</span><span class="o">=</span><span class="s1">&#39;http&#39;</span>
</span></span><span class="line"><span class="cl"><span class="nv">ACME_HTTP_PORT</span><span class="o">=</span><span class="s1">&#39;:80&#39;</span>
</span></span><span class="line"><span class="cl"><span class="nv">ACME_HTTP_PROXY_HEADER</span><span class="o">=</span><span class="s1">&#39;Host&#39;</span>
</span></span><span class="line"><span class="cl"><span class="nv">ACME_TLS_PORT</span><span class="o">=</span><span class="s1">&#39;:443&#39;</span>
</span></span><span class="line"><span class="cl"><span class="nv">ACME_KEY_TYPE</span><span class="o">=</span><span class="s1">&#39;ec256&#39;</span>
</span></span><span class="line"><span class="cl"><span class="nv">ACME_PFX_PASSWORD</span><span class="o">=</span><span class="s1">&#39;pa$$word&#39;</span>
</span></span><span class="line"><span class="cl"><span class="nv">ACME_PFX_FORMAT</span><span class="o">=</span><span class="s1">&#39;RC2&#39;</span>
</span></span><span class="line"><span class="cl"><span class="nv">ACME_CRT_TIMEOUT</span><span class="o">=</span><span class="s1">&#39;30&#39;</span>
</span></span><span class="line"><span class="cl"><span class="nv">ACME_DAYS</span><span class="o">=</span><span class="s1">&#39;30&#39;</span>
</span></span><span class="line"><span class="cl"><span class="nv">ACME_SERVICES</span><span class="o">=(</span>
</span></span><span class="line"><span class="cl">  <span class="s1">&#39;angie.service&#39;</span>
</span></span><span class="line"><span class="cl">  <span class="s1">&#39;apache2.service&#39;</span>
</span></span><span class="line"><span class="cl">  <span class="s1">&#39;nginx.service&#39;</span>
</span></span><span class="line"><span class="cl">  <span class="s1">&#39;postfix@-.service&#39;</span>
</span></span><span class="line"><span class="cl">  <span class="s1">&#39;prosody.service&#39;</span>
</span></span><span class="line"><span class="cl"><span class="o">)</span>
</span></span><span class="line"><span class="cl"><span class="nv">ACME_DNS_PROVIDER</span><span class="o">=</span><span class="s1">&#39;cloudflare&#39;</span>
</span></span><span class="line"><span class="cl"><span class="nv">ACME_DNS_RESOLVERS</span><span class="o">=(</span>
</span></span><span class="line"><span class="cl">  <span class="s1">&#39;8.8.8.8&#39;</span>
</span></span><span class="line"><span class="cl">  <span class="s1">&#39;8.8.4.4&#39;</span>
</span></span><span class="line"><span class="cl"><span class="o">)</span>
</span></span><span class="line"><span class="cl"><span class="nb">export</span> <span class="nv">CLOUDFLARE_API_EMAIL</span><span class="o">=</span><span class="s1">&#39;mail@example.com&#39;</span>
</span></span><span class="line"><span class="cl"><span class="nb">export</span> <span class="nv">CLOUDFLARE_API_KEY</span><span class="o">=</span><span class="s1">&#39;&#39;</span>
</span></span><span class="line"><span class="cl"><span class="nb">export</span> <span class="nv">CLOUDFLARE_DNS_API_TOKEN</span><span class="o">=</span><span class="s1">&#39;&#39;</span>
</span></span><span class="line"><span class="cl"><span class="nb">export</span> <span class="nv">CLOUDFLARE_ZONE_API_TOKEN</span><span class="o">=</span><span class="s1">&#39;&#39;</span></span></span></code></pre></td></tr></table>
</div>
</div>
                </div>
              </div>
            </div>
        
    
<h4 id="параметры">
  <a class="link-body-emphasis" href="#%d0%bf%d0%b0%d1%80%d0%b0%d0%bc%d0%b5%d1%82%d1%80%d1%8b">Параметры</a>
</h4><ul>
<li><code>ACME_SERVER</code> - сервер Let&rsquo;s Encrypt для заказа сертификата. По умолчанию указан тестовый сервер. Может принимать следующие значения:
<ul>
<li><code>https://acme-staging-v02.api.letsencrypt.org/directory</code> - сервер для тестирования получения проверочных сертификатов. Используется для проверки работы скрипта.</li>
<li><code>https://acme-v02.api.letsencrypt.org/directory</code> - сервер для получения настоящих сертификатов.</li>
</ul>
</li>
<li><code>ACME_EMAIL</code> - адрес электронной почты для регистрации и восстановления сертификата Let&rsquo;s Encrypt.</li>
<li><code>ACME_PATH</code> - путь к хранилищу сертификатов. По умолчанию: <code>/etc/ssl/acme</code>.</li>
<li><code>ACME_METHOD</code> - метод получения/обновления сертификата. По умолчанию <code>http</code>. Может принимать следующие значения:
<ul>
<li><code>dns</code> - получения сертификата методом <strong>DNS-01</strong>.</li>
<li><code>http</code> - получение сертификата методом <strong>HTTP-01</strong>.</li>
<li><code>tls</code> - получения сертификата методом <strong>TLS-ALPN-01</strong>.</li>
</ul>
</li>
<li><code>ACME_HTTP_PORT</code> - порт, который будет слушать LeGo при получении сертификата методом <strong>HTTP-01</strong>. По умолчанию: <code>:80</code>. Может принимать следующие значения:
<ul>
<li><code>interface:port</code> - слушать на конкретном интерфейсе и номере порта.</li>
<li><code>:port</code> - слушать на всех интерфейсах и конкретном порту.</li>
</ul>
</li>
<li><code>ACME_HTTP_PROXY_HEADER</code> - проверка по указанному заголовку, если LeGo находится за обратным proxy-сервером.</li>
<li><code>ACME_TLS_PORT</code> - порт, который будет слушать LeGo при получении сертификата методом <strong>TLS-ALPN-01</strong>. По умолчанию: <code>:443</code>. Может принимать следующие значения:
<ul>
<li><code>interface:port</code> - слушать на конкретном интерфейсе и номере порта.</li>
<li><code>:port</code> - слушать на всех интерфейсах и конкретном порту.</li>
</ul>
</li>
<li><code>ACME_KEY_TYPE</code> - тип приватного ключа сертификата. По умолчанию: <code>ec256</code>. Может принимать следующие значения:
<ul>
<li><code>rsa2048</code> - тип <strong>RSA-2048</strong>.</li>
<li><code>rsa3072</code> - тип <strong>RSA-3072</strong>.</li>
<li><code>rsa4096</code> - тип <strong>RSA-4096</strong>.</li>
<li><code>rsa8192</code> - тип <strong>RSA-8192</strong>.</li>
<li><code>ec256</code> - тип <strong>EC-256</strong>.</li>
<li><code>ec384</code> - тип <strong>EC-384</strong>.</li>
</ul>
</li>
<li><code>ACME_PFX_PASSWORD</code> - пароль для контейнера PFX.</li>
<li><code>ACME_PFX_FORMAT</code> - формат контейнера PFX. По умолчанию: <code>RC2</code>. Может принимать следующие значения:
<ul>
<li><code>RC2</code> - формат <strong>RC2</strong>.</li>
<li><code>DES</code> - формат <strong>DES</strong>.</li>
<li><code>SHA256</code> - формат <strong>SHA256</strong>.</li>
</ul>
</li>
<li><code>ACME_CRT_TIMEOUT</code> - время ожидания сертификата в секундах. По умолчанию: <code>30</code> секунд. Используется только при получении нового сертификата.</li>
<li><code>ACME_DAYS</code> - количество дней, оставшихся у сертификата для его продления.</li>
<li><code>ACME_SERVICES</code> - сервисы, которые необходимо перезапустить после обновления сертификата. Каждый из сервисов проверяется на наличие в системе.</li>
<li><code>ACME_DNS_PROVIDER</code> - выбор DNS-провайдера для получения сертификата методом <strong>DNS-01</strong>.</li>
<li><code>ACME_DNS_RESOLVERS</code> - Адреса DNS-резолверов. По умолчанию: <code>8.8.8.8</code> и <code>8.8.4.4</code>. Может принимать следующие значения:
<ul>
<li><code>host:port</code> - название хоста и номер порта.</li>
</ul>
</li>
</ul>
<h3 id="конфигурация-домена">
  <a class="link-body-emphasis" href="#%d0%ba%d0%be%d0%bd%d1%84%d0%b8%d0%b3%d1%83%d1%80%d0%b0%d1%86%d0%b8%d1%8f-%d0%b4%d0%be%d0%bc%d0%b5%d0%bd%d0%b0">Конфигурация домена</a>
</h3><p>Файл с индивидуальной конфигурацией для каждого домена. Название файла должно строиться по шаблону <code>app.acme.lego.[domain.com].conf</code>. Этот файл подключается после файла с общими параметрами и позволяет переопределять их.</p>

    

    
        
            
            <div class="shortcode shortcode-file mb-3">
              <div class="card overflow-hidden" data-bs-theme="dark">
                <div class="card-header">
                  <div class="d-flex align-items-center">
                    <div class="flex-shrink-0">
                      <i class="far fa-file-code fa-fw"></i>
                    </div>
                    <div class="flex-grow-1 mx-2 text-truncate">
                      <code>app.acme.lego.example.com.conf</code>
                    </div>
                    <div class="flex-shrink-0">
                      <ul class="list-inline mb-0">
                        <li class="list-inline-item" title='Копировать'>
                          <a class="text-body" href="#"
                             data-fn="clipboard" data-clipboard-target="#cp-36080437139bb55480f768b7a125b7d0"
                             role="button" aria-label='Копировать'>
                            <i class="fas fa-copy fa-fw"></i>
                          </a>
                        </li>
                        <li class="list-inline-item" title='Скачать'>
                          <a class="text-body" href="/ru/2024/11/1f5924fa-7a3d-574e-a15d-8a41208fe10d/app.acme.lego.example.com.conf" download
                             role="button" aria-label='Скачать'>
                            <i class="fas fa-download fa-fw"></i>
                          </a>
                        </li>
                        <li class="list-inline-item" title='Открыть'>
                          <a class="text-body" href="/ru/2024/11/1f5924fa-7a3d-574e-a15d-8a41208fe10d/app.acme.lego.example.com.conf" target="_blank"
                             role="button" aria-label='Открыть'>
                            <i class="fas fa-arrow-up-right-from-square fa-fw"></i>
                          </a>
                        </li>
                      </ul>
                    </div>
                  </div>
                </div>
                <div class="card-body p-0 overflow-auto" id="cp-36080437139bb55480f768b7a125b7d0">
                    
                    <div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="nv">ACME_DOMAINS</span><span class="o">=(</span>
</span></span><span class="line"><span class="cl">  <span class="s1">&#39;example.com&#39;</span>
</span></span><span class="line"><span class="cl">  <span class="s1">&#39;mail.example.com&#39;</span>
</span></span><span class="line"><span class="cl"><span class="o">)</span>
</span></span><span class="line"><span class="cl"><span class="nv">ACME_HTTP_WEBROOT</span><span class="o">=</span><span class="s1">&#39;/var/www/html&#39;</span></span></span></code></pre></td></tr></table>
</div>
</div>
                </div>
              </div>
            </div>
        
    
<h4 id="параметры-1">
  <a class="link-body-emphasis" href="#%d0%bf%d0%b0%d1%80%d0%b0%d0%bc%d0%b5%d1%82%d1%80%d1%8b-1">Параметры</a>
</h4><ul>
<li><code>ACME_DOMAINS</code> - список доменов для получения сертификата.</li>
<li><code>ACME_HTTP_WEBROOT</code> - WEB-директория сервера для интеграции директории идентификации <code>.well-known/acme-challenge</code>. Если параметр пустой, LeGo поднимает свой внутренний сервер для получения сертификата.</li>
</ul>
<h3 id="приложение">
  <a class="link-body-emphasis" href="#%d0%bf%d1%80%d0%b8%d0%bb%d0%be%d0%b6%d0%b5%d0%bd%d0%b8%d0%b5">Приложение</a>
</h3><p>Тело скрипта. Скрипт подключает файлы с основными параметрами и параметрами домена.</p>

    

    
        
            
            <div class="shortcode shortcode-file mb-3">
              <div class="card overflow-hidden" data-bs-theme="dark">
                <div class="card-header">
                  <div class="d-flex align-items-center">
                    <div class="flex-shrink-0">
                      <i class="far fa-file-code fa-fw"></i>
                    </div>
                    <div class="flex-grow-1 mx-2 text-truncate">
                      <code>app.acme.lego.sh</code>
                    </div>
                    <div class="flex-shrink-0">
                      <ul class="list-inline mb-0">
                        <li class="list-inline-item" title='Копировать'>
                          <a class="text-body" href="#"
                             data-fn="clipboard" data-clipboard-target="#cp-224409ff553c29c811d707737b1439b6"
                             role="button" aria-label='Копировать'>
                            <i class="fas fa-copy fa-fw"></i>
                          </a>
                        </li>
                        <li class="list-inline-item" title='Скачать'>
                          <a class="text-body" href="/ru/2024/11/1f5924fa-7a3d-574e-a15d-8a41208fe10d/app.acme.lego.sh" download
                             role="button" aria-label='Скачать'>
                            <i class="fas fa-download fa-fw"></i>
                          </a>
                        </li>
                        <li class="list-inline-item" title='Открыть'>
                          <a class="text-body" href="/ru/2024/11/1f5924fa-7a3d-574e-a15d-8a41208fe10d/app.acme.lego.sh" target="_blank"
                             role="button" aria-label='Открыть'>
                            <i class="fas fa-arrow-up-right-from-square fa-fw"></i>
                          </a>
                        </li>
                      </ul>
                    </div>
                  </div>
                </div>
                <div class="card-body p-0 overflow-auto" id="cp-224409ff553c29c811d707737b1439b6">
                    
                        
                    
                    <div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">  1
</span><span class="lnt">  2
</span><span class="lnt">  3
</span><span class="lnt">  4
</span><span class="lnt">  5
</span><span class="lnt">  6
</span><span class="lnt">  7
</span><span class="lnt">  8
</span><span class="lnt">  9
</span><span class="lnt"> 10
</span><span class="lnt"> 11
</span><span class="lnt"> 12
</span><span class="lnt"> 13
</span><span class="lnt"> 14
</span><span class="lnt"> 15
</span><span class="lnt"> 16
</span><span class="lnt"> 17
</span><span class="lnt"> 18
</span><span class="lnt"> 19
</span><span class="lnt"> 20
</span><span class="lnt"> 21
</span><span class="lnt"> 22
</span><span class="lnt"> 23
</span><span class="lnt"> 24
</span><span class="lnt"> 25
</span><span class="lnt"> 26
</span><span class="lnt"> 27
</span><span class="lnt"> 28
</span><span class="lnt"> 29
</span><span class="lnt"> 30
</span><span class="lnt"> 31
</span><span class="lnt"> 32
</span><span class="lnt"> 33
</span><span class="lnt"> 34
</span><span class="lnt"> 35
</span><span class="lnt"> 36
</span><span class="lnt"> 37
</span><span class="lnt"> 38
</span><span class="lnt"> 39
</span><span class="lnt"> 40
</span><span class="lnt"> 41
</span><span class="lnt"> 42
</span><span class="lnt"> 43
</span><span class="lnt"> 44
</span><span class="lnt"> 45
</span><span class="lnt"> 46
</span><span class="lnt"> 47
</span><span class="lnt"> 48
</span><span class="lnt"> 49
</span><span class="lnt"> 50
</span><span class="lnt"> 51
</span><span class="lnt"> 52
</span><span class="lnt"> 53
</span><span class="lnt"> 54
</span><span class="lnt"> 55
</span><span class="lnt"> 56
</span><span class="lnt"> 57
</span><span class="lnt"> 58
</span><span class="lnt"> 59
</span><span class="lnt"> 60
</span><span class="lnt"> 61
</span><span class="lnt"> 62
</span><span class="lnt"> 63
</span><span class="lnt"> 64
</span><span class="lnt"> 65
</span><span class="lnt"> 66
</span><span class="lnt"> 67
</span><span class="lnt"> 68
</span><span class="lnt"> 69
</span><span class="lnt"> 70
</span><span class="lnt"> 71
</span><span class="lnt"> 72
</span><span class="lnt"> 73
</span><span class="lnt"> 74
</span><span class="lnt"> 75
</span><span class="lnt"> 76
</span><span class="lnt"> 77
</span><span class="lnt"> 78
</span><span class="lnt"> 79
</span><span class="lnt"> 80
</span><span class="lnt"> 81
</span><span class="lnt"> 82
</span><span class="lnt"> 83
</span><span class="lnt"> 84
</span><span class="lnt"> 85
</span><span class="lnt"> 86
</span><span class="lnt"> 87
</span><span class="lnt"> 88
</span><span class="lnt"> 89
</span><span class="lnt"> 90
</span><span class="lnt"> 91
</span><span class="lnt"> 92
</span><span class="lnt"> 93
</span><span class="lnt"> 94
</span><span class="lnt"> 95
</span><span class="lnt"> 96
</span><span class="lnt"> 97
</span><span class="lnt"> 98
</span><span class="lnt"> 99
</span><span class="lnt">100
</span><span class="lnt">101
</span><span class="lnt">102
</span><span class="lnt">103
</span><span class="lnt">104
</span><span class="lnt">105
</span><span class="lnt">106
</span><span class="lnt">107
</span><span class="lnt">108
</span><span class="lnt">109
</span><span class="lnt">110
</span><span class="lnt">111
</span><span class="lnt">112
</span><span class="lnt">113
</span><span class="lnt">114
</span><span class="lnt">115
</span><span class="lnt">116
</span><span class="lnt">117
</span><span class="lnt">118
</span><span class="lnt">119
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sh" data-lang="sh"><span class="line"><span class="cl"><span class="cp">#!/usr/bin/env -S bash -eu
</span></span></span><span class="line"><span class="cl"><span class="cp"></span><span class="c1"># -------------------------------------------------------------------------------------------------------------------- #</span>
</span></span><span class="line"><span class="cl"><span class="c1"># ACME: CERTIFICATE</span>
</span></span><span class="line"><span class="cl"><span class="c1"># Script for generating a certificate using Lego.</span>
</span></span><span class="line"><span class="cl"><span class="c1"># -------------------------------------------------------------------------------------------------------------------- #</span>
</span></span><span class="line"><span class="cl"><span class="c1"># @package    Bash</span>
</span></span><span class="line"><span class="cl"><span class="c1"># @author     Kai Kimera</span>
</span></span><span class="line"><span class="cl"><span class="c1"># @license    MIT</span>
</span></span><span class="line"><span class="cl"><span class="c1"># @version    0.1.0</span>
</span></span><span class="line"><span class="cl"><span class="c1"># @link       https://lib.onl/ru/2024/11/1f5924fa-7a3d-574e-a15d-8a41208fe10d/</span>
</span></span><span class="line"><span class="cl"><span class="c1"># -------------------------------------------------------------------------------------------------------------------- #</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="o">((</span> EUID !<span class="o">=</span> <span class="m">0</span> <span class="o">))</span> <span class="o">&amp;&amp;</span> <span class="o">{</span> <span class="nb">echo</span> &gt;<span class="p">&amp;</span><span class="m">2</span> <span class="s1">&#39;This script should be run as root!&#39;</span><span class="p">;</span> <span class="nb">exit</span> 1<span class="p">;</span> <span class="o">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Sources.</span>
</span></span><span class="line"><span class="cl"><span class="nv">SRC_DIR</span><span class="o">=</span><span class="s2">&#34;</span><span class="k">$(</span> <span class="nb">cd</span> <span class="s2">&#34;</span><span class="k">$(</span> dirname <span class="s2">&#34;</span><span class="si">${</span><span class="nv">BASH_SOURCE</span><span class="p">[0]</span><span class="si">}</span><span class="s2">&#34;</span> <span class="k">)</span><span class="s2">&#34;</span> <span class="p">&amp;</span>&gt; /dev/null <span class="o">&amp;&amp;</span> <span class="nb">pwd</span> -P <span class="k">)</span><span class="s2">&#34;</span><span class="p">;</span> <span class="nb">readonly</span> SRC_DIR <span class="c1"># Script directory.</span>
</span></span><span class="line"><span class="cl"><span class="nv">SRC_NAME</span><span class="o">=</span><span class="s2">&#34;</span><span class="k">$(</span> basename <span class="s2">&#34;</span><span class="k">$(</span> readlink -f <span class="s2">&#34;</span><span class="si">${</span><span class="nv">BASH_SOURCE</span><span class="p">[0]</span><span class="si">}</span><span class="s2">&#34;</span> <span class="k">)</span><span class="s2">&#34;</span> <span class="k">)</span><span class="s2">&#34;</span><span class="p">;</span> <span class="nb">readonly</span> SRC_NAME <span class="c1"># Script name.</span>
</span></span><span class="line"><span class="cl"><span class="nv">SRC_DOMAIN</span><span class="o">=</span><span class="s2">&#34;</span><span class="si">${</span><span class="nv">1</span><span class="p">:?</span><span class="si">}</span><span class="s2">&#34;</span><span class="p">;</span> <span class="nb">readonly</span> SRC_DOMAIN <span class="c1"># Domain name.</span>
</span></span><span class="line"><span class="cl"><span class="c1"># shellcheck source=/dev/null</span>
</span></span><span class="line"><span class="cl">. <span class="s2">&#34;</span><span class="si">${</span><span class="nv">SRC_DIR</span><span class="si">}</span><span class="s2">/</span><span class="si">${</span><span class="nv">SRC_NAME</span><span class="p">%.*</span><span class="si">}</span><span class="s2">.conf&#34;</span> <span class="c1"># Loading main configuration file.</span>
</span></span><span class="line"><span class="cl"><span class="c1"># shellcheck source=/dev/null</span>
</span></span><span class="line"><span class="cl">. <span class="s2">&#34;</span><span class="si">${</span><span class="nv">SRC_DIR</span><span class="si">}</span><span class="s2">/</span><span class="si">${</span><span class="nv">SRC_NAME</span><span class="p">%.*</span><span class="si">}</span><span class="s2">.</span><span class="si">${</span><span class="nv">SRC_DOMAIN</span><span class="si">}</span><span class="s2">.conf&#34;</span> <span class="c1"># Loading domain configuration file.</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Environment variables.</span>
</span></span><span class="line"><span class="cl"><span class="nb">export</span> <span class="nv">LEGO_PATH</span><span class="o">=</span><span class="s2">&#34;</span><span class="si">${</span><span class="nv">SRC_DIR</span><span class="p">:?</span><span class="si">}</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl"><span class="nb">export</span> <span class="nv">LEGO_SERVER</span><span class="o">=</span><span class="s2">&#34;</span><span class="si">${</span><span class="nv">ACME_SERVER</span><span class="p">:?</span><span class="si">}</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl"><span class="nb">export</span> <span class="nv">LEGO_PFX_PASSWORD</span><span class="o">=</span><span class="s2">&#34;</span><span class="si">${</span><span class="nv">ACME_PFX_PASSWORD</span><span class="p">:?</span><span class="si">}</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl"><span class="nb">export</span> <span class="nv">LEGO_PFX_FORMAT</span><span class="o">=</span><span class="s2">&#34;</span><span class="si">${</span><span class="nv">ACME_PFX_FORMAT</span><span class="p">:?</span><span class="si">}</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Parameters.</span>
</span></span><span class="line"><span class="cl"><span class="nv">ACME_CMD</span><span class="o">=</span><span class="s2">&#34;</span><span class="si">${</span><span class="nv">2</span><span class="p">:?</span><span class="si">}</span><span class="s2">&#34;</span><span class="p">;</span> <span class="nb">readonly</span> ACME_CMD<span class="p">;</span> <span class="o">[[</span> ! <span class="s2">&#34;</span><span class="si">${</span><span class="nv">ACME_CMD</span><span class="si">}</span><span class="s2">&#34;</span> <span class="o">=</span>~ ^<span class="o">(</span>run<span class="p">|</span>renew<span class="o">)</span>$ <span class="o">]]</span> <span class="o">&amp;&amp;</span> <span class="nb">exit</span> <span class="m">1</span>
</span></span><span class="line"><span class="cl"><span class="nv">ACME_EMAIL</span><span class="o">=</span><span class="s2">&#34;</span><span class="si">${</span><span class="nv">ACME_EMAIL</span><span class="p">:?</span><span class="si">}</span><span class="s2">&#34;</span><span class="p">;</span> <span class="nb">readonly</span> ACME_EMAIL
</span></span><span class="line"><span class="cl"><span class="nv">ACME_PATH</span><span class="o">=</span><span class="s2">&#34;</span><span class="si">${</span><span class="nv">ACME_PATH</span><span class="p">:?</span><span class="si">}</span><span class="s2">&#34;</span><span class="p">;</span> <span class="nb">readonly</span> ACME_PATH
</span></span><span class="line"><span class="cl"><span class="nv">ACME_METHOD</span><span class="o">=</span><span class="s2">&#34;</span><span class="si">${</span><span class="nv">ACME_METHOD</span><span class="p">:?</span><span class="si">}</span><span class="s2">&#34;</span><span class="p">;</span> <span class="nb">readonly</span> ACME_METHOD
</span></span><span class="line"><span class="cl"><span class="nv">ACME_HTTP_PORT</span><span class="o">=</span><span class="s2">&#34;</span><span class="si">${</span><span class="nv">ACME_HTTP_PORT</span><span class="p">:?</span><span class="si">}</span><span class="s2">&#34;</span><span class="p">;</span> <span class="nb">readonly</span> ACME_HTTP_PORT
</span></span><span class="line"><span class="cl"><span class="nv">ACME_HTTP_PROXY_HEADER</span><span class="o">=</span><span class="s2">&#34;</span><span class="si">${</span><span class="nv">ACME_HTTP_PROXY_HEADER</span><span class="p">:?</span><span class="si">}</span><span class="s2">&#34;</span><span class="p">;</span> <span class="nb">readonly</span> ACME_HTTP_PROXY_HEADER
</span></span><span class="line"><span class="cl"><span class="nv">ACME_HTTP_WEBROOT</span><span class="o">=</span><span class="s2">&#34;</span><span class="si">${</span><span class="nv">ACME_HTTP_WEBROOT</span><span class="p">?</span><span class="si">}</span><span class="s2">&#34;</span><span class="p">;</span> <span class="nb">readonly</span> ACME_HTTP_WEBROOT
</span></span><span class="line"><span class="cl"><span class="nv">ACME_TLS_PORT</span><span class="o">=</span><span class="s2">&#34;</span><span class="si">${</span><span class="nv">ACME_TLS_PORT</span><span class="p">:?</span><span class="si">}</span><span class="s2">&#34;</span><span class="p">;</span> <span class="nb">readonly</span> ACME_TLS_PORT
</span></span><span class="line"><span class="cl"><span class="nv">ACME_KEY_TYPE</span><span class="o">=</span><span class="s2">&#34;</span><span class="si">${</span><span class="nv">ACME_KEY_TYPE</span><span class="p">:?</span><span class="si">}</span><span class="s2">&#34;</span><span class="p">;</span> <span class="nb">readonly</span> ACME_KEY_TYPE
</span></span><span class="line"><span class="cl"><span class="nv">ACME_CRT_TIMEOUT</span><span class="o">=</span><span class="s2">&#34;</span><span class="si">${</span><span class="nv">ACME_CRT_TIMEOUT</span><span class="p">:?</span><span class="si">}</span><span class="s2">&#34;</span><span class="p">;</span> <span class="nb">readonly</span> ACME_CRT_TIMEOUT
</span></span><span class="line"><span class="cl"><span class="nv">ACME_DAYS</span><span class="o">=</span><span class="s2">&#34;</span><span class="si">${</span><span class="nv">ACME_DAYS</span><span class="p">:?</span><span class="si">}</span><span class="s2">&#34;</span><span class="p">;</span> <span class="nb">readonly</span> ACME_DAYS
</span></span><span class="line"><span class="cl"><span class="nv">ACME_SERVICES</span><span class="o">=(</span><span class="s2">&#34;</span><span class="si">${</span><span class="nv">ACME_SERVICES</span><span class="p">[@]:?</span><span class="si">}</span><span class="s2">&#34;</span><span class="o">)</span><span class="p">;</span> <span class="nb">readonly</span> ACME_SERVICES
</span></span><span class="line"><span class="cl"><span class="nv">ACME_DOMAINS</span><span class="o">=(</span><span class="s2">&#34;</span><span class="si">${</span><span class="nv">ACME_DOMAINS</span><span class="p">[@]:?</span><span class="si">}</span><span class="s2">&#34;</span><span class="o">)</span><span class="p">;</span> <span class="nb">readonly</span> ACME_DOMAINS
</span></span><span class="line"><span class="cl"><span class="nv">ACME_DNS_PROVIDER</span><span class="o">=</span><span class="s2">&#34;</span><span class="si">${</span><span class="nv">ACME_DNS_PROVIDER</span><span class="p">:?</span><span class="si">}</span><span class="s2">&#34;</span><span class="p">;</span> <span class="nb">readonly</span> ACME_DNS_PROVIDER
</span></span><span class="line"><span class="cl"><span class="nv">ACME_DNS_RESOLVERS</span><span class="o">=(</span><span class="s2">&#34;</span><span class="si">${</span><span class="nv">ACME_DNS_RESOLVERS</span><span class="p">[@]:?</span><span class="si">}</span><span class="s2">&#34;</span><span class="o">)</span><span class="p">;</span> <span class="nb">readonly</span> ACME_DNS_RESOLVERS
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># -------------------------------------------------------------------------------------------------------------------- #</span>
</span></span><span class="line"><span class="cl"><span class="c1"># INITIALIZATION</span>
</span></span><span class="line"><span class="cl"><span class="c1"># -------------------------------------------------------------------------------------------------------------------- #</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">run<span class="o">()</span> <span class="o">{</span> lego<span class="p">;</span> <span class="o">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># -------------------------------------------------------------------------------------------------------------------- #</span>
</span></span><span class="line"><span class="cl"><span class="c1"># LEGO</span>
</span></span><span class="line"><span class="cl"><span class="c1"># Let&#39;s Encrypt client and ACME library written in Go.</span>
</span></span><span class="line"><span class="cl"><span class="c1"># -------------------------------------------------------------------------------------------------------------------- #</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">lego<span class="o">()</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">  <span class="nb">local</span> cmd<span class="p">;</span> <span class="nv">cmd</span><span class="o">=(</span><span class="s2">&#34;</span><span class="si">${</span><span class="nv">ACME_CMD</span><span class="si">}</span><span class="s2">&#34;</span><span class="o">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="k">case</span> <span class="s2">&#34;</span><span class="si">${</span><span class="nv">ACME_CMD</span><span class="si">}</span><span class="s2">&#34;</span> in
</span></span><span class="line"><span class="cl">    <span class="s1">&#39;renew&#39;</span><span class="o">)</span>
</span></span><span class="line"><span class="cl">      <span class="nv">cmd</span><span class="o">+=(</span><span class="s1">&#39;--days&#39;</span> <span class="s2">&#34;</span><span class="si">${</span><span class="nv">ACME_DAYS</span><span class="si">}</span><span class="s2">&#34;</span><span class="o">)</span>
</span></span><span class="line"><span class="cl">      <span class="p">;;</span>
</span></span><span class="line"><span class="cl">  <span class="k">esac</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="nb">local</span> opts
</span></span><span class="line"><span class="cl">  <span class="nv">opts</span><span class="o">=(</span>
</span></span><span class="line"><span class="cl">    <span class="s1">&#39;--accept-tos&#39;</span>
</span></span><span class="line"><span class="cl">    <span class="s1">&#39;--key-type&#39;</span> <span class="s2">&#34;</span><span class="si">${</span><span class="nv">ACME_KEY_TYPE</span><span class="si">}</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="s1">&#39;--email&#39;</span> <span class="s2">&#34;</span><span class="si">${</span><span class="nv">ACME_EMAIL</span><span class="si">}</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="s1">&#39;--cert.timeout&#39;</span> <span class="s2">&#34;</span><span class="si">${</span><span class="nv">ACME_CRT_TIMEOUT</span><span class="si">}</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="s1">&#39;--pem&#39;</span>
</span></span><span class="line"><span class="cl">    <span class="s1">&#39;--pfx&#39;</span>
</span></span><span class="line"><span class="cl">  <span class="o">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="k">case</span> <span class="s2">&#34;</span><span class="si">${</span><span class="nv">ACME_METHOD</span><span class="si">}</span><span class="s2">&#34;</span> in
</span></span><span class="line"><span class="cl">    <span class="s1">&#39;dns&#39;</span><span class="o">)</span>
</span></span><span class="line"><span class="cl">      <span class="nv">opts</span><span class="o">+=(</span><span class="s1">&#39;--dns&#39;</span> <span class="s2">&#34;</span><span class="si">${</span><span class="nv">ACME_DNS_PROVIDER</span><span class="si">}</span><span class="s2">&#34;</span><span class="o">)</span>
</span></span><span class="line"><span class="cl">      <span class="k">for</span> i in <span class="s2">&#34;</span><span class="si">${</span><span class="nv">ACME_DNS_RESOLVERS</span><span class="p">[@]</span><span class="si">}</span><span class="s2">&#34;</span><span class="p">;</span> <span class="k">do</span> <span class="nv">opts</span><span class="o">+=(</span><span class="s1">&#39;--dns.resolvers&#39;</span> <span class="s2">&#34;</span><span class="si">${</span><span class="nv">i</span><span class="si">}</span><span class="s2">&#34;</span><span class="o">)</span><span class="p">;</span> <span class="k">done</span>
</span></span><span class="line"><span class="cl">      <span class="p">;;</span>
</span></span><span class="line"><span class="cl">    <span class="s1">&#39;http&#39;</span><span class="o">)</span>
</span></span><span class="line"><span class="cl">      <span class="nv">opts</span><span class="o">+=(</span><span class="s1">&#39;--http&#39;</span> <span class="s1">&#39;--http.port&#39;</span> <span class="s2">&#34;</span><span class="si">${</span><span class="nv">ACME_HTTP_PORT</span><span class="si">}</span><span class="s2">&#34;</span> <span class="s1">&#39;--http.proxy-header&#39;</span> <span class="s2">&#34;</span><span class="si">${</span><span class="nv">ACME_HTTP_PROXY_HEADER</span><span class="si">}</span><span class="s2">&#34;</span><span class="o">)</span>
</span></span><span class="line"><span class="cl">      <span class="o">[[</span> -n <span class="s2">&#34;</span><span class="si">${</span><span class="nv">ACME_HTTP_WEBROOT</span><span class="si">}</span><span class="s2">&#34;</span> <span class="o">]]</span> <span class="o">&amp;&amp;</span> <span class="nv">opts</span><span class="o">+=(</span><span class="s1">&#39;--http.webroot&#39;</span> <span class="s2">&#34;</span><span class="si">${</span><span class="nv">ACME_HTTP_WEBROOT</span><span class="si">}</span><span class="s2">&#34;</span><span class="o">)</span>
</span></span><span class="line"><span class="cl">      <span class="p">;;</span>
</span></span><span class="line"><span class="cl">    <span class="s1">&#39;tls&#39;</span><span class="o">)</span>
</span></span><span class="line"><span class="cl">      <span class="nv">opts</span><span class="o">+=(</span><span class="s1">&#39;--tls&#39;</span> <span class="s1">&#39;--tls.port&#39;</span> <span class="s2">&#34;</span><span class="si">${</span><span class="nv">ACME_TLS_PORT</span><span class="si">}</span><span class="s2">&#34;</span><span class="o">)</span>
</span></span><span class="line"><span class="cl">      <span class="p">;;</span>
</span></span><span class="line"><span class="cl">    *<span class="o">)</span>
</span></span><span class="line"><span class="cl">      <span class="nb">echo</span> <span class="s1">&#39;ACME_METHOD is not supported!&#39;</span><span class="p">;</span> <span class="nb">exit</span> <span class="m">1</span>
</span></span><span class="line"><span class="cl">      <span class="p">;;</span>
</span></span><span class="line"><span class="cl">  <span class="k">esac</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="k">for</span> i in <span class="s2">&#34;</span><span class="si">${</span><span class="nv">ACME_DOMAINS</span><span class="p">[@]</span><span class="si">}</span><span class="s2">&#34;</span><span class="p">;</span> <span class="k">do</span> <span class="nv">opts</span><span class="o">+=(</span><span class="s1">&#39;--domains&#39;</span> <span class="s2">&#34;</span><span class="si">${</span><span class="nv">i</span><span class="si">}</span><span class="s2">&#34;</span><span class="o">)</span><span class="p">;</span> <span class="k">done</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="k">if</span> <span class="s2">&#34;</span><span class="si">${</span><span class="nv">SRC_DIR</span><span class="si">}</span><span class="s2">/lego&#34;</span> <span class="s2">&#34;</span><span class="si">${</span><span class="nv">opts</span><span class="p">[@]</span><span class="si">}</span><span class="s2">&#34;</span> <span class="s2">&#34;</span><span class="si">${</span><span class="nv">cmd</span><span class="p">[@]</span><span class="si">}</span><span class="s2">&#34;</span><span class="p">;</span> <span class="k">then</span>
</span></span><span class="line"><span class="cl">    <span class="o">[[</span> ! -d <span class="s2">&#34;</span><span class="si">${</span><span class="nv">ACME_PATH</span><span class="si">}</span><span class="s2">&#34;</span> <span class="o">]]</span> <span class="o">&amp;&amp;</span> mkdir -p <span class="s2">&#34;</span><span class="si">${</span><span class="nv">ACME_PATH</span><span class="si">}</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl">    cp -f <span class="s2">&#34;</span><span class="si">${</span><span class="nv">LEGO_PATH</span><span class="si">}</span><span class="s2">/certificates/&#34;</span><span class="o">{</span>*.crt,*.key,*.pem,*.pfx<span class="o">}</span> <span class="s2">&#34;</span><span class="si">${</span><span class="nv">ACME_PATH</span><span class="si">}</span><span class="s2">&#34;</span> <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>      <span class="o">&amp;&amp;</span> chmod <span class="m">644</span> <span class="s2">&#34;</span><span class="si">${</span><span class="nv">ACME_PATH</span><span class="si">}</span><span class="s2">/&#34;</span><span class="o">{</span>*.crt,*.key,*.pem,*.pfx<span class="o">}</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> s in <span class="s2">&#34;</span><span class="si">${</span><span class="nv">ACME_SERVICES</span><span class="p">[@]</span><span class="si">}</span><span class="s2">&#34;</span><span class="p">;</span> <span class="k">do</span> _if_service <span class="s2">&#34;</span><span class="si">${</span><span class="nv">s</span><span class="si">}</span><span class="s2">&#34;</span> <span class="o">&amp;&amp;</span> systemctl reload <span class="s2">&#34;</span><span class="si">${</span><span class="nv">s</span><span class="si">}</span><span class="s2">&#34;</span><span class="p">;</span> <span class="k">done</span>
</span></span><span class="line"><span class="cl">  <span class="k">fi</span>
</span></span><span class="line"><span class="cl"><span class="o">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># -------------------------------------------------------------------------------------------------------------------- #</span>
</span></span><span class="line"><span class="cl"><span class="c1"># ------------------------------------------------&lt; COMMON FUNCTIONS &gt;------------------------------------------------ #</span>
</span></span><span class="line"><span class="cl"><span class="c1"># -------------------------------------------------------------------------------------------------------------------- #</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Checking service availability.</span>
</span></span><span class="line"><span class="cl">_if_service<span class="o">()</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">  <span class="nb">local</span> s<span class="p">;</span> <span class="nv">s</span><span class="o">=</span><span class="s2">&#34;</span><span class="si">${</span><span class="nv">1</span><span class="si">}</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl">  <span class="k">if</span> systemctl list-units --full -all <span class="p">|</span> grep -Fq <span class="s2">&#34;</span><span class="si">${</span><span class="nv">s</span><span class="si">}</span><span class="s2">&#34;</span><span class="p">;</span> <span class="k">then</span> <span class="k">return</span> 0<span class="p">;</span> <span class="k">fi</span>
</span></span><span class="line"><span class="cl">  <span class="k">return</span> <span class="m">1</span>
</span></span><span class="line"><span class="cl"><span class="o">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># -------------------------------------------------------------------------------------------------------------------- #</span>
</span></span><span class="line"><span class="cl"><span class="c1"># -------------------------------------------------&lt; RUNNING SCRIPT &gt;------------------------------------------------- #</span>
</span></span><span class="line"><span class="cl"><span class="c1"># -------------------------------------------------------------------------------------------------------------------- #</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">run <span class="o">&amp;&amp;</span> <span class="nb">exit</span> <span class="m">0</span> <span class="o">||</span> <span class="nb">exit</span> <span class="m">1</span></span></span></code></pre></td></tr></table>
</div>
</div>
                </div>
              </div>
            </div>
        
    
<h3 id="задача">
  <a class="link-body-emphasis" href="#%d0%b7%d0%b0%d0%b4%d0%b0%d1%87%d0%b0">Задача</a>
</h3><p>Файл задачи размещается в директории <code>/etc/cron.d/</code>. Задача запускает скрипт каждый день для проверки состояния сертификатов.</p>

    

    
        
            
            <div class="shortcode shortcode-file mb-3">
              <div class="card overflow-hidden" data-bs-theme="dark">
                <div class="card-header">
                  <div class="d-flex align-items-center">
                    <div class="flex-shrink-0">
                      <i class="far fa-file-code fa-fw"></i>
                    </div>
                    <div class="flex-grow-1 mx-2 text-truncate">
                      <code>app_acme_lego</code>
                    </div>
                    <div class="flex-shrink-0">
                      <ul class="list-inline mb-0">
                        <li class="list-inline-item" title='Копировать'>
                          <a class="text-body" href="#"
                             data-fn="clipboard" data-clipboard-target="#cp-3d839ec519e9504cb13d42198ee02c87"
                             role="button" aria-label='Копировать'>
                            <i class="fas fa-copy fa-fw"></i>
                          </a>
                        </li>
                        <li class="list-inline-item" title='Скачать'>
                          <a class="text-body" href="/ru/2024/11/1f5924fa-7a3d-574e-a15d-8a41208fe10d/app_acme_lego" download
                             role="button" aria-label='Скачать'>
                            <i class="fas fa-download fa-fw"></i>
                          </a>
                        </li>
                        <li class="list-inline-item" title='Открыть'>
                          <a class="text-body" href="/ru/2024/11/1f5924fa-7a3d-574e-a15d-8a41208fe10d/app_acme_lego" target="_blank"
                             role="button" aria-label='Открыть'>
                            <i class="fas fa-arrow-up-right-from-square fa-fw"></i>
                          </a>
                        </li>
                      </ul>
                    </div>
                  </div>
                </div>
                <div class="card-body p-0 overflow-auto" id="cp-3d839ec519e9504cb13d42198ee02c87">
                    
                    <div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="nv">SHELL</span><span class="o">=</span>/bin/bash
</span></span><span class="line"><span class="cl"><span class="nv">PATH</span><span class="o">=</span>/bin:/sbin:/usr/bin:/usr/sbin:/usr/local/bin:/usr/local/sbin
</span></span><span class="line"><span class="cl"><span class="nv">HOME</span><span class="o">=</span>/root
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="m">0</span> <span class="m">0</span> * * * root <span class="s2">&#34;</span><span class="si">${</span><span class="nv">HOME</span><span class="si">}</span><span class="s2">/apps/acme/app.acme.lego.sh&#34;</span> <span class="s1">&#39;example.com&#39;</span> <span class="s1">&#39;renew&#39;</span> &gt; /dev/null 2&gt;<span class="p">&amp;</span><span class="m">1</span></span></span></code></pre></td></tr></table>
</div>
</div>
                </div>
              </div>
            </div>
        
    
<h4 id="параметры-2">
  <a class="link-body-emphasis" href="#%d0%bf%d0%b0%d1%80%d0%b0%d0%bc%d0%b5%d1%82%d1%80%d1%8b-2">Параметры</a>
</h4><ul>
<li><code>example.com</code> - название домена для загрузки файла с его параметрами.</li>
<li><code>renew</code> - команда LeGo для проверки и обновления сертификатов.</li>
</ul>]]></turbo:content></item><item turbo="true"><title>Jigasi: "The following addresses failed: RFC 6120 A/AAAA Endpoint"</title><link>https://lib.onl/ru/2024/11/45ffdbeb-37ec-5ed2-b3cd-347df5e3d07b/</link><pubDate>Wed, 06 Nov 2024 10:16:13 +0000</pubDate><dc:creator>Kai Kimera</dc:creator><category>Linux</category><category>Сеть</category><yandex:related><link url="https://lib.onl/ru/2024/10/0a633c87-935c-54ba-bedf-9c95152b6b51/">Автоматическое закрытие конференц-комнаты в Asterisk</link><link url="https://lib.onl/ru/2024/06/b29b331d-ac93-5193-83ef-beab5a0f8dff/">Linux: Пользователи и группы</link><link url="https://lib.onl/ru/2024/03/6c7a038f-f41e-5a45-a285-b99fdacf82d4/">Работа с ZFS</link><link url="https://lib.onl/ru/2021/09/581804b8-0613-52a8-a5c4-fdae90e7bc8a/">Чёрный экран с курсором при старте GDM</link><link url="https://lib.onl/ru/2021/09/ff829d15-4a19-52e3-a3aa-ad70aa38854a/">Debian: Wired Networks are Unmanaged</link><link url="https://lib.onl/ru/2021/03/0a815547-4f18-52a0-9a99-c463421872ca/">Monero Unit</link></yandex:related><turbo:extendedHtml>true</turbo:extendedHtml><turbo:source>https://lib.onl/ru/2024/11/45ffdbeb-37ec-5ed2-b3cd-347df5e3d07b/</turbo:source><turbo:topic>Jigasi: "The following addresses failed: RFC 6120 A/AAAA Endpoint"</turbo:topic><turbo:content><![CDATA[<p>Решение ошибки, связанной с раннем запуском сервиса <span class="shortcode shortcode-tag"><a href="/ru/tags/jigasi/" target="_blank">#Jigasi</a></span>.</p>
<p>После перезагрузки сервера, <span class="shortcode shortcode-tag"><a href="/ru/tags/jigasi/" target="_blank">#Jigasi</a></span> не может приглашать локальные телефоны. Появляется следующая ошибка:</p>











<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-0 shortcode-codeblock-terminal
shortcode-codeblock-terminal-linux
shortcode-codeblock-terminal-linux-user">
  <div class="card overflow-hidden" data-bs-theme="dark">
    <div class="card-header">
      <div class="d-flex align-items-center">
        <div class="flex-shrink-0 ">
          <i class="fas fa-terminal fa-fw"></i>
        </div>
        <div class="flex-grow-1 mx-2">
          <h5 class="mb-0">Терминал</h5>
        </div>
        <div class="flex-shrink-0">
          <ul class="list-inline mb-0">
            <li class="list-inline-item" title='Копировать'>
              <a class="text-body" href="#"
                 data-fn="clipboard" data-clipboard-target="#cp-cf7b1c9d2f13259cf001350366f4bf93"
                 role="button" aria-label='Копировать'>
                <i class="fas fa-copy fa-fw"></i>
              </a>
            </li>
          </ul>
        </div>
      </div>
    </div>
    <div class="card-body p-0 overflow-auto" id="cp-cf7b1c9d2f13259cf001350366f4bf93"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-plaintext" data-lang="plaintext"><span class="line"><span class="cl">cat /var/log/jitsi/jicofo.log
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">2024-11-05 11:36:06.116 INFO: [33] SipGateway.registrationStateChanged#120: REG STATE CHANGE ProtocolProviderServiceSipImpl(SIP:1234@192.168.1.2) -&gt; RegistrationStateChangeEvent[ oldState=Unregistered; newState=RegistrationState=Registering; userRequest=false; reasonCode=-1; reason=null]
</span></span><span class="line"><span class="cl">2024-11-05 11:36:06.179 INFO: [43] SipGateway.registrationStateChanged#120: REG STATE CHANGE ProtocolProviderServiceSipImpl(SIP:1234@192.168.1.2) -&gt; RegistrationStateChangeEvent[ oldState=Registering; newState=RegistrationState=Registered; userRequest=false; reasonCode=-1; reason=null]
</span></span><span class="line"><span class="cl">2024-11-05 11:36:06.180 WARNING: [43] SipHealthPeriodicChecker.create#170: No health check started, no HEALTH_CHECK_SIP_URI prop.
</span></span><span class="line"><span class="cl">2024-11-05 11:36:06.231 SEVERE: [40] net.java.sip.communicator.impl.protocol.jabber.ProtocolProviderServiceJabberImpl.connectAndLogin: Failed to connect to XMPP service for:ProtocolProviderServiceJabberImpl(Jabber:jigasi@auth.cf.vpostal.ru)
</span></span><span class="line"><span class="cl">org.jivesoftware.smack.SmackException$EndpointConnectionException: The following addresses failed: &#39;RFC 6120 A/AAAA Endpoint + [127.0.0.1/127.0.0.1:5222] (127.0.0.1/127.0.0.1:5222)&#39; failed because: java.net.ConnectException: Connection refused
</span></span><span class="line"><span class="cl">        at org.jivesoftware.smack.SmackException$EndpointConnectionException.from(SmackException.java:334)
</span></span><span class="line"><span class="cl">        at org.jivesoftware.smack.tcp.XMPPTCPConnection.connectUsingConfiguration(XMPPTCPConnection.java:664)
</span></span><span class="line"><span class="cl">        at org.jivesoftware.smack.tcp.XMPPTCPConnection.connectInternal(XMPPTCPConnection.java:849)
</span></span><span class="line"><span class="cl">        at org.jivesoftware.smack.AbstractXMPPConnection.connect(AbstractXMPPConnection.java:525)
</span></span><span class="line"><span class="cl">        at net.java.sip.communicator.impl.protocol.jabber.ProtocolProviderServiceJabberImpl.connectAndLogin(ProtocolProviderServiceJabberImpl.java:1307)
</span></span><span class="line"><span class="cl">        at net.java.sip.communicator.impl.protocol.jabber.ProtocolProviderServiceJabberImpl.connectAndLogin(ProtocolProviderServiceJabberImpl.java:967)
</span></span><span class="line"><span class="cl">        at net.java.sip.communicator.impl.protocol.jabber.ProtocolProviderServiceJabberImpl.initializeConnectAndLogin(ProtocolProviderServiceJabberImpl.java:792)
</span></span><span class="line"><span class="cl">        at net.java.sip.communicator.impl.protocol.jabber.ProtocolProviderServiceJabberImpl.register(ProtocolProviderServiceJabberImpl.java:494)
</span></span><span class="line"><span class="cl">        at org.jitsi.jigasi.util.RegisterThread.run(RegisterThread.java:59)
</span></span><span class="line"><span class="cl">2024-11-05 11:36:36.255 WARNING: [14] org.jivesoftware.smackx.ping.PingManager.pingServerIfNecessary: XMPPTCPConnection[not-authenticated] (0) was not authenticated</span></span></code></pre></td></tr></table>
</div>
</div></div>
  </div>
</div>
<p>Возможно, <span class="shortcode shortcode-tag"><a href="/ru/tags/jigasi/" target="_blank">#Jigasi</a></span> запускается раньше других сервисов. Чтобы <span class="shortcode shortcode-tag"><a href="/ru/tags/jigasi/" target="_blank">#Jigasi</a></span> запустился в необходимое время, надо переопределить зависимости запуска стандартной конфигурации <strong>systemd</strong>. Для этого создаём файл <code>/etc/systemd/system/jigasi.service.d/override.conf</code> со строками:</p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-1
shortcode-codeblock-ini">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-be7e13927db6d5ef29865984db579d4c" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-ini" data-lang="ini"><span class="line"><span class="cl"><span class="k">[Unit]</span>
</span></span><span class="line"><span class="cl"><span class="na">After</span><span class="o">=</span><span class="s">jitsi-videobridge2.service</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-be7e13927db6d5ef29865984db579d4c"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<p>Таким образом, переменную <code>After</code> из стандартной конфигурации <span class="shortcode shortcode-tag"><a href="/ru/tags/jigasi/" target="_blank">#Jigasi</a></span> мы переопределяем на свою и говорим <span class="shortcode shortcode-tag"><a href="/ru/tags/jigasi/" target="_blank">#Jigasi</a></span>, чтобы та ждала загрузки unit&rsquo;а <code>jitsi-videobridge2.service</code> и только после этого сама запускалась.</p>
<p>Сам же unit <code>jitsi-videobridge2.service</code> содержит такие строки:</p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-2
shortcode-codeblock-ini">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-3a6bf64b452db22d37ef409202764dce" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-ini" data-lang="ini"><span class="line"><span class="cl"><span class="k">[Unit]</span>
</span></span><span class="line"><span class="cl"><span class="na">Description</span><span class="o">=</span><span class="s">Jitsi Videobridge</span>
</span></span><span class="line"><span class="cl"><span class="na">After</span><span class="o">=</span><span class="s">network-online.target</span>
</span></span><span class="line"><span class="cl"><span class="na">Wants</span><span class="o">=</span><span class="s">network-online.target</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-3a6bf64b452db22d37ef409202764dce"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<p>Согласно переменным <code>After=network-online.target</code> и <code>Wants=network-online.target</code>, unit ждёт активности сети и после этого загружается.</p>
<p>Объединив всё это, получаем цепочку последовательных, зависимых друг от друга, запусков:</p>
<ol>
<li>Активность сети.</li>
<li>Модуль <code>jitsi-videobridge2.service</code>.</li>
<li>Модуль <code>jigasi.service</code>.</li>
</ol>
<p>Команда для создания переопределения unit&rsquo;а одной строчкой:</p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-3
shortcode-codeblock-bash">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-84f8b1532667a3a1525d8dd6285d0782" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="nv">d</span><span class="o">=</span><span class="s1">&#39;/etc/systemd/system/jigasi.service.d&#39;</span><span class="p">;</span> mkdir -p <span class="s2">&#34;</span><span class="si">${</span><span class="nv">d</span><span class="si">}</span><span class="s2">&#34;</span> <span class="o">&amp;&amp;</span> <span class="nb">echo</span> -e <span class="s2">&#34;[Unit]\nAfter=jitsi-videobridge2.service&#34;</span> &gt; <span class="s2">&#34;</span><span class="si">${</span><span class="nv">d</span><span class="si">}</span><span class="s2">/override.conf&#34;</span> <span class="o">&amp;&amp;</span> systemctl daemon-reload <span class="o">&amp;&amp;</span> systemctl restart <span class="s1">&#39;jigasi.service&#39;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-84f8b1532667a3a1525d8dd6285d0782"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>]]></turbo:content></item><item turbo="true"><title>Как включить параметр Check Gateway для маршрута, полученного по DHCP?</title><link>https://lib.onl/ru/2024/10/4f371edb-90bc-537e-a5c9-d43b47fe1a59/</link><pubDate>Sun, 13 Oct 2024 20:49:17 +0000</pubDate><dc:creator>Kai Kimera</dc:creator><category>Mikrotik</category><turbo:extendedHtml>true</turbo:extendedHtml><turbo:source>https://lib.onl/ru/2024/10/4f371edb-90bc-537e-a5c9-d43b47fe1a59/</turbo:source><turbo:topic>Как включить параметр Check Gateway для маршрута, полученного по DHCP?</turbo:topic><turbo:content><![CDATA[<p>Mikrotik получает маршрут <code>0.0.0.0/0 &lt;- 89.208.234.1</code> от провайдера по DHCP. Как включить проверку шлюза <code>89.208.234.1</code> при помощи параметра <strong>Check Gateway</strong>?</p>]]></turbo:content></item><item turbo="true"><title>Автоматическое закрытие конференц-комнаты в Asterisk</title><link>https://lib.onl/ru/2024/10/0a633c87-935c-54ba-bedf-9c95152b6b51/</link><pubDate>Tue, 01 Oct 2024 08:40:04 +0000</pubDate><dc:creator>Kai Kimera</dc:creator><category>Скрипты</category><category>Linux</category><yandex:related><link url="https://lib.onl/ru/2024/04/2e00b43b-b0da-59c2-ae92-60dcf2ba1d52/">Установка и настройка Asterisk</link><link url="https://lib.onl/ru/2024/06/b29b331d-ac93-5193-83ef-beab5a0f8dff/">Linux: Пользователи и группы</link><link url="https://lib.onl/ru/2024/03/6c7a038f-f41e-5a45-a285-b99fdacf82d4/">Работа с ZFS</link></yandex:related><turbo:extendedHtml>true</turbo:extendedHtml><turbo:source>https://lib.onl/ru/2024/10/0a633c87-935c-54ba-bedf-9c95152b6b51/</turbo:source><turbo:topic>Автоматическое закрытие конференц-комнаты в Asterisk</turbo:topic><turbo:content><![CDATA[<p>Скрипт закрывающий конференц-комнату при условии, что в ней остаётся один конкретный номер участника.</p>
<p>Поставлена задача, когда генеральный директор остаётся один в конференц-комнате, конференц-комната должна сама закрываться. Написал небольшой скрипт, который анализирует конференц-комнату на наличие определённых номеров и количества участников в конференц-комнате, и при обнаружении конкретного номера без других участников, закрывает конференц-комнату.</p>
<h2 id="установка">
  <a class="link-body-emphasis" href="#%d1%83%d1%81%d1%82%d0%b0%d0%bd%d0%be%d0%b2%d0%ba%d0%b0">Установка</a>
</h2><ul>
<li>Скопировать файлы <code>app.asterisk.room-close.conf</code> и <code>app.asterisk.room-close.sh</code> в директорию <code>/root/apps/asterisk/</code>.</li>
<li>Указать бит выполнения для <code>*.sh</code> скриптов: <code>chmod +x /root/apps/asterisk/*.sh</code>.</li>
<li>Скопировать файл <code>app_asterisk_room-close</code> в директорию <code>/etc/cron.d/</code>.</li>
<li>Настроить параметры скрипта в файле <code>app.asterisk.room-close.conf</code>.</li>
</ul>
<h2 id="скрипт">
  <a class="link-body-emphasis" href="#%d1%81%d0%ba%d1%80%d0%b8%d0%bf%d1%82">Скрипт</a>
</h2><p>Скрипт состоит из трёх компонентов:</p>
<ul>
<li>Файл с настройками.</li>
<li>Приложение.</li>
<li>Задача для CRON.</li>
</ul>
<h3 id="настройка">
  <a class="link-body-emphasis" href="#%d0%bd%d0%b0%d1%81%d1%82%d1%80%d0%be%d0%b9%d0%ba%d0%b0">Настройка</a>
</h3>
    

    
        
            
            <div class="shortcode shortcode-file mb-3">
              <div class="card overflow-hidden" data-bs-theme="dark">
                <div class="card-header">
                  <div class="d-flex align-items-center">
                    <div class="flex-shrink-0">
                      <i class="far fa-file-code fa-fw"></i>
                    </div>
                    <div class="flex-grow-1 mx-2 text-truncate">
                      <code>app.asterisk.room-close.conf</code>
                    </div>
                    <div class="flex-shrink-0">
                      <ul class="list-inline mb-0">
                        <li class="list-inline-item" title='Копировать'>
                          <a class="text-body" href="#"
                             data-fn="clipboard" data-clipboard-target="#cp-af9a9d52820a60383b93a996842cd968"
                             role="button" aria-label='Копировать'>
                            <i class="fas fa-copy fa-fw"></i>
                          </a>
                        </li>
                        <li class="list-inline-item" title='Скачать'>
                          <a class="text-body" href="/ru/2024/10/0a633c87-935c-54ba-bedf-9c95152b6b51/app.asterisk.room-close.conf" download
                             role="button" aria-label='Скачать'>
                            <i class="fas fa-download fa-fw"></i>
                          </a>
                        </li>
                        <li class="list-inline-item" title='Открыть'>
                          <a class="text-body" href="/ru/2024/10/0a633c87-935c-54ba-bedf-9c95152b6b51/app.asterisk.room-close.conf" target="_blank"
                             role="button" aria-label='Открыть'>
                            <i class="fas fa-arrow-up-right-from-square fa-fw"></i>
                          </a>
                        </li>
                      </ul>
                    </div>
                  </div>
                </div>
                <div class="card-body p-0 overflow-auto" id="cp-af9a9d52820a60383b93a996842cd968">
                    
                    <div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="nv">PHONES</span><span class="o">=(</span>
</span></span><span class="line"><span class="cl">  <span class="s1">&#39;1234&#39;</span>
</span></span><span class="line"><span class="cl">  <span class="s1">&#39;4567&#39;</span>
</span></span><span class="line"><span class="cl">  <span class="s1">&#39;7890&#39;</span>
</span></span><span class="line"><span class="cl"><span class="o">)</span></span></span></code></pre></td></tr></table>
</div>
</div>
                </div>
              </div>
            </div>
        
    
<h4 id="параметры">
  <a class="link-body-emphasis" href="#%d0%bf%d0%b0%d1%80%d0%b0%d0%bc%d0%b5%d1%82%d1%80%d1%8b">Параметры</a>
</h4><ul>
<li><code>PHONES</code> - массив, в котором содержаться номера телефонов. Если один из указанных номеров телефонов остаётся в конференции без остальных участников, то конференция закрывается.</li>
</ul>
<h3 id="приложение">
  <a class="link-body-emphasis" href="#%d0%bf%d1%80%d0%b8%d0%bb%d0%be%d0%b6%d0%b5%d0%bd%d0%b8%d0%b5">Приложение</a>
</h3><p>Приложение забирает параметры из файла настроек и обрабатывает значения.</p>

    

    
        
            
            <div class="shortcode shortcode-file mb-3">
              <div class="card overflow-hidden" data-bs-theme="dark">
                <div class="card-header">
                  <div class="d-flex align-items-center">
                    <div class="flex-shrink-0">
                      <i class="far fa-file-code fa-fw"></i>
                    </div>
                    <div class="flex-grow-1 mx-2 text-truncate">
                      <code>app.asterisk.room-close.sh</code>
                    </div>
                    <div class="flex-shrink-0">
                      <ul class="list-inline mb-0">
                        <li class="list-inline-item" title='Копировать'>
                          <a class="text-body" href="#"
                             data-fn="clipboard" data-clipboard-target="#cp-950f6dc98b2f2f77452e93e7053fa374"
                             role="button" aria-label='Копировать'>
                            <i class="fas fa-copy fa-fw"></i>
                          </a>
                        </li>
                        <li class="list-inline-item" title='Скачать'>
                          <a class="text-body" href="/ru/2024/10/0a633c87-935c-54ba-bedf-9c95152b6b51/app.asterisk.room-close.sh" download
                             role="button" aria-label='Скачать'>
                            <i class="fas fa-download fa-fw"></i>
                          </a>
                        </li>
                        <li class="list-inline-item" title='Открыть'>
                          <a class="text-body" href="/ru/2024/10/0a633c87-935c-54ba-bedf-9c95152b6b51/app.asterisk.room-close.sh" target="_blank"
                             role="button" aria-label='Открыть'>
                            <i class="fas fa-arrow-up-right-from-square fa-fw"></i>
                          </a>
                        </li>
                      </ul>
                    </div>
                  </div>
                </div>
                <div class="card-body p-0 overflow-auto" id="cp-950f6dc98b2f2f77452e93e7053fa374">
                    
                        
                    
                    <div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sh" data-lang="sh"><span class="line"><span class="cl"><span class="cp">#!/usr/bin/env -S bash -eu
</span></span></span><span class="line"><span class="cl"><span class="cp"></span><span class="c1"># -------------------------------------------------------------------------------------------------------------------- #</span>
</span></span><span class="line"><span class="cl"><span class="c1"># ASTERISK: CLOSING ROOM</span>
</span></span><span class="line"><span class="cl"><span class="c1"># If there is only 1 user left in the room, the room is closed.</span>
</span></span><span class="line"><span class="cl"><span class="c1"># -------------------------------------------------------------------------------------------------------------------- #</span>
</span></span><span class="line"><span class="cl"><span class="c1"># @package    Bash</span>
</span></span><span class="line"><span class="cl"><span class="c1"># @author     Kai Kimera</span>
</span></span><span class="line"><span class="cl"><span class="c1"># @license    MIT</span>
</span></span><span class="line"><span class="cl"><span class="c1"># @version    0.1.0</span>
</span></span><span class="line"><span class="cl"><span class="c1"># @link       https://lib.onl/ru/2024/10/0a633c87-935c-54ba-bedf-9c95152b6b51/</span>
</span></span><span class="line"><span class="cl"><span class="c1"># -------------------------------------------------------------------------------------------------------------------- #</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="o">((</span> EUID !<span class="o">=</span> <span class="m">0</span> <span class="o">))</span> <span class="o">&amp;&amp;</span> <span class="o">{</span> <span class="nb">echo</span> &gt;<span class="p">&amp;</span><span class="m">2</span> <span class="s1">&#39;This script should be run as root!&#39;</span><span class="p">;</span> <span class="nb">exit</span> 1<span class="p">;</span> <span class="o">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Sources.</span>
</span></span><span class="line"><span class="cl"><span class="nv">SRC_DIR</span><span class="o">=</span><span class="s2">&#34;</span><span class="k">$(</span> <span class="nb">cd</span> <span class="s2">&#34;</span><span class="k">$(</span> dirname <span class="s2">&#34;</span><span class="si">${</span><span class="nv">BASH_SOURCE</span><span class="p">[0]</span><span class="si">}</span><span class="s2">&#34;</span> <span class="k">)</span><span class="s2">&#34;</span> <span class="p">&amp;</span>&gt; /dev/null <span class="o">&amp;&amp;</span> <span class="nb">pwd</span> -P <span class="k">)</span><span class="s2">&#34;</span> <span class="c1"># Source directory.</span>
</span></span><span class="line"><span class="cl"><span class="nv">SRC_NAME</span><span class="o">=</span><span class="s2">&#34;</span><span class="k">$(</span> basename <span class="s2">&#34;</span><span class="k">$(</span> readlink -f <span class="s2">&#34;</span><span class="si">${</span><span class="nv">BASH_SOURCE</span><span class="p">[0]</span><span class="si">}</span><span class="s2">&#34;</span> <span class="k">)</span><span class="s2">&#34;</span> <span class="k">)</span><span class="s2">&#34;</span> <span class="c1"># Source name.</span>
</span></span><span class="line"><span class="cl"><span class="c1"># shellcheck source=/dev/null</span>
</span></span><span class="line"><span class="cl">. <span class="s2">&#34;</span><span class="si">${</span><span class="nv">SRC_DIR</span><span class="si">}</span><span class="s2">/</span><span class="si">${</span><span class="nv">SRC_NAME</span><span class="p">%.*</span><span class="si">}</span><span class="s2">.conf&#34;</span> <span class="c1"># Loading configuration file.</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Parameters.</span>
</span></span><span class="line"><span class="cl"><span class="nv">PHONES</span><span class="o">=(</span><span class="s2">&#34;</span><span class="si">${</span><span class="nv">PHONES</span><span class="p">[@]:?</span><span class="si">}</span><span class="s2">&#34;</span><span class="o">)</span><span class="p">;</span> <span class="nb">readonly</span> PHONES
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Variables.</span>
</span></span><span class="line"><span class="cl">mapfile -t ROOMS &lt; &lt;<span class="o">(</span> grep <span class="s1">&#39;^conf =&gt;&#39;</span> <span class="s1">&#39;/etc/asterisk/meetme.conf&#39;</span> <span class="p">|</span> cut -d <span class="s1">&#39; &#39;</span> -f <span class="m">3</span> <span class="o">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># -------------------------------------------------------------------------------------------------------------------- #</span>
</span></span><span class="line"><span class="cl"><span class="c1"># INITIALIZATION</span>
</span></span><span class="line"><span class="cl"><span class="c1"># -------------------------------------------------------------------------------------------------------------------- #</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">run<span class="o">()</span> <span class="o">{</span> close<span class="p">;</span> <span class="o">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># -------------------------------------------------------------------------------------------------------------------- #</span>
</span></span><span class="line"><span class="cl"><span class="c1"># ROOM CLOSE</span>
</span></span><span class="line"><span class="cl"><span class="c1"># -------------------------------------------------------------------------------------------------------------------- #</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">close<span class="o">()</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">  <span class="k">for</span> room in <span class="s2">&#34;</span><span class="si">${</span><span class="nv">ROOMS</span><span class="p">[@]</span><span class="si">}</span><span class="s2">&#34;</span><span class="p">;</span> <span class="k">do</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> phone in <span class="s2">&#34;</span><span class="si">${</span><span class="nv">PHONES</span><span class="p">[@]</span><span class="si">}</span><span class="s2">&#34;</span><span class="p">;</span> <span class="k">do</span>
</span></span><span class="line"><span class="cl">      <span class="nb">local</span> users<span class="p">;</span> <span class="nv">users</span><span class="o">=</span><span class="k">$(</span> asterisk -x <span class="s2">&#34;meetme list </span><span class="si">${</span><span class="nv">room</span><span class="si">}</span><span class="s2">&#34;</span> <span class="p">|</span> head -n -1 <span class="p">|</span> awk <span class="s1">&#39;{ print NR }&#39;</span> <span class="k">)</span>
</span></span><span class="line"><span class="cl">      <span class="nb">local</span> last<span class="p">;</span> <span class="nv">last</span><span class="o">=</span><span class="k">$(</span> asterisk -x <span class="s2">&#34;meetme list </span><span class="si">${</span><span class="nv">room</span><span class="si">}</span><span class="s2">&#34;</span> <span class="p">|</span> grep <span class="s2">&#34;</span><span class="si">${</span><span class="nv">phone</span><span class="si">}</span><span class="s2">&#34;</span> <span class="p">|</span> awk <span class="s1">&#39;{ print $4 }&#39;</span> <span class="k">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">      <span class="k">case</span> <span class="si">${</span><span class="nv">users</span><span class="si">}</span> in
</span></span><span class="line"><span class="cl">        1<span class="o">)</span> <span class="o">[[</span> <span class="si">${</span><span class="nv">phone</span><span class="si">}</span> -eq <span class="si">${</span><span class="nv">last</span><span class="si">}</span> <span class="o">]]</span> <span class="o">&amp;&amp;</span> asterisk -x <span class="s2">&#34;meetme kick </span><span class="si">${</span><span class="nv">room</span><span class="si">}</span><span class="s2"> all&#34;</span> <span class="p">;;</span>
</span></span><span class="line"><span class="cl">        *<span class="o">)</span> <span class="k">continue</span> <span class="p">;;</span>
</span></span><span class="line"><span class="cl">      <span class="k">esac</span>
</span></span><span class="line"><span class="cl">    <span class="k">done</span>
</span></span><span class="line"><span class="cl">  <span class="k">done</span>
</span></span><span class="line"><span class="cl"><span class="o">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># -------------------------------------------------------------------------------------------------------------------- #</span>
</span></span><span class="line"><span class="cl"><span class="c1"># -------------------------------------------------&lt; RUNNING SCRIPT &gt;------------------------------------------------- #</span>
</span></span><span class="line"><span class="cl"><span class="c1"># -------------------------------------------------------------------------------------------------------------------- #</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">run <span class="o">&amp;&amp;</span> <span class="nb">exit</span> <span class="m">0</span> <span class="o">||</span> <span class="nb">exit</span> <span class="m">1</span></span></span></code></pre></td></tr></table>
</div>
</div>
                </div>
              </div>
            </div>
        
    
<h3 id="задача">
  <a class="link-body-emphasis" href="#%d0%b7%d0%b0%d0%b4%d0%b0%d1%87%d0%b0">Задача</a>
</h3><p>Задача запускает скрипт каждые 10 секунд для проверки конференц-комнат.</p>

    

    
        
            
            <div class="shortcode shortcode-file mb-3">
              <div class="card overflow-hidden" data-bs-theme="dark">
                <div class="card-header">
                  <div class="d-flex align-items-center">
                    <div class="flex-shrink-0">
                      <i class="far fa-file-code fa-fw"></i>
                    </div>
                    <div class="flex-grow-1 mx-2 text-truncate">
                      <code>app_asterisk_room-close</code>
                    </div>
                    <div class="flex-shrink-0">
                      <ul class="list-inline mb-0">
                        <li class="list-inline-item" title='Копировать'>
                          <a class="text-body" href="#"
                             data-fn="clipboard" data-clipboard-target="#cp-324d6da38d02ed246253e1b2c8537e29"
                             role="button" aria-label='Копировать'>
                            <i class="fas fa-copy fa-fw"></i>
                          </a>
                        </li>
                        <li class="list-inline-item" title='Скачать'>
                          <a class="text-body" href="/ru/2024/10/0a633c87-935c-54ba-bedf-9c95152b6b51/app_asterisk_room-close" download
                             role="button" aria-label='Скачать'>
                            <i class="fas fa-download fa-fw"></i>
                          </a>
                        </li>
                        <li class="list-inline-item" title='Открыть'>
                          <a class="text-body" href="/ru/2024/10/0a633c87-935c-54ba-bedf-9c95152b6b51/app_asterisk_room-close" target="_blank"
                             role="button" aria-label='Открыть'>
                            <i class="fas fa-arrow-up-right-from-square fa-fw"></i>
                          </a>
                        </li>
                      </ul>
                    </div>
                  </div>
                </div>
                <div class="card-body p-0 overflow-auto" id="cp-324d6da38d02ed246253e1b2c8537e29">
                    
                    <div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="nv">SHELL</span><span class="o">=</span>/bin/bash
</span></span><span class="line"><span class="cl"><span class="nv">PATH</span><span class="o">=</span>/bin:/sbin:/usr/bin:/usr/sbin:/usr/local/bin:/usr/local/sbin
</span></span><span class="line"><span class="cl"><span class="nv">HOME</span><span class="o">=</span>/root
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">* * * * * root <span class="k">for</span> i in <span class="o">{</span>1..6<span class="o">}</span><span class="p">;</span> <span class="k">do</span> <span class="s2">&#34;</span><span class="si">${</span><span class="nv">HOME</span><span class="si">}</span><span class="s2">/apps/asterisk/app.asterisk.room-close.sh&#34;</span> &gt; /dev/null 2&gt;<span class="p">&amp;</span><span class="m">1</span> <span class="p">&amp;</span> sleep 10<span class="p">;</span> <span class="k">done</span></span></span></code></pre></td></tr></table>
</div>
</div>
                </div>
              </div>
            </div>]]></turbo:content></item><item turbo="true"><title>Как найти и копировать письма между почтовыми ящиками в MS Exchange?</title><link>https://lib.onl/ru/2024/09/2b00140a-22a3-58ec-9741-6d1d180d60f6/</link><pubDate>Tue, 24 Sep 2024 13:29:25 +0000</pubDate><dc:creator>Kai Kimera</dc:creator><category>Exchange</category><category>Powershell</category><category>Mail</category><category>Search</category><yandex:related><link url="https://lib.onl/ru/2024/09/2d6ca7ec-235c-51ee-a732-eeb8f6e780c2/">Как мигрировать DHCP между двумя Windows Server?</link><link url="https://lib.onl/ru/2023/11/e153bb1d-7cea-5bd8-acce-2dbe63b26c91/">Как переименовать компьютер в PowerShell?</link><link url="https://lib.onl/ru/2023/11/8c2e7adc-9431-5bb7-a9b6-e9397b1116b3/">Как переключить PowerShell в кодировку UTF-8?</link><link url="https://lib.onl/ru/2023/10/edf74517-3e6e-5e1c-aa6b-8ee0335670b4/">Многоточие в выводе PowerShell в табличном формате. Как исправить?</link></yandex:related><turbo:extendedHtml>true</turbo:extendedHtml><turbo:source>https://lib.onl/ru/2024/09/2b00140a-22a3-58ec-9741-6d1d180d60f6/</turbo:source><turbo:topic>Как найти и копировать письма между почтовыми ящиками в MS Exchange?</turbo:topic><turbo:content><![CDATA[<p>В почтовом ящике <code>user@domain.com</code> пропало часть писем. Но этим письма есть на резервном ящике <code>recovery@domain.com</code>. Как копировать письма из резервного ящика в основной?</p>]]></turbo:content></item><item turbo="true"><title>Как мигрировать DHCP между двумя Windows Server?</title><link>https://lib.onl/ru/2024/09/2d6ca7ec-235c-51ee-a732-eeb8f6e780c2/</link><pubDate>Tue, 24 Sep 2024 10:34:31 +0000</pubDate><dc:creator>Kai Kimera</dc:creator><category>Windows</category><category>Powershell</category><category>Dhcp</category><yandex:related><link url="https://lib.onl/ru/2023/11/e153bb1d-7cea-5bd8-acce-2dbe63b26c91/">Как переименовать компьютер в PowerShell?</link><link url="https://lib.onl/ru/2023/11/8c2e7adc-9431-5bb7-a9b6-e9397b1116b3/">Как переключить PowerShell в кодировку UTF-8?</link><link url="https://lib.onl/ru/2023/10/edf74517-3e6e-5e1c-aa6b-8ee0335670b4/">Многоточие в выводе PowerShell в табличном формате. Как исправить?</link></yandex:related><turbo:extendedHtml>true</turbo:extendedHtml><turbo:source>https://lib.onl/ru/2024/09/2d6ca7ec-235c-51ee-a732-eeb8f6e780c2/</turbo:source><turbo:topic>Как мигрировать DHCP между двумя Windows Server?</turbo:topic><turbo:content>&lt;p>Необходим перенос настроек DHCP со старого сервера на новый. Сервера под управлением Windows Server 2022. Как это сделать?&lt;/p></turbo:content></item><item turbo="true"><title>Как переместить VM на новый ESXi?</title><link>https://lib.onl/ru/2024/09/8ed324cb-7d1f-5da0-8773-9c08a08664cd/</link><pubDate>Wed, 18 Sep 2024 09:39:06 +0000</pubDate><dc:creator>Kai Kimera</dc:creator><category>Vm</category><category>Vmware</category><category>Esxi</category><turbo:extendedHtml>true</turbo:extendedHtml><turbo:source>https://lib.onl/ru/2024/09/8ed324cb-7d1f-5da0-8773-9c08a08664cd/</turbo:source><turbo:topic>Как переместить VM на новый ESXi?</turbo:topic><turbo:content>&lt;p>Встала задача переместить виртуальную машину со старого VMware ESXi на новый. Как это сделать?&lt;/p></turbo:content></item><item turbo="true"><title>Уведомления от Windows Server Backup</title><link>https://lib.onl/ru/2024/09/40539e36-4656-5532-b920-8975c97d4dc5/</link><pubDate>Tue, 17 Sep 2024 20:47:31 +0000</pubDate><dc:creator>Kai Kimera</dc:creator><category>Скрипты</category><category>MS Windows</category><category>Терминал</category><turbo:extendedHtml>true</turbo:extendedHtml><turbo:source>https://lib.onl/ru/2024/09/40539e36-4656-5532-b920-8975c97d4dc5/</turbo:source><turbo:topic>Уведомления от Windows Server Backup</turbo:topic><turbo:content><![CDATA[<p>Windows Server Backup хороша в качестве компонента резервного копирования, встроенного в ОС. Но работу этого компонента неплохо было бы отслеживать.</p>
<p>Я написал небольшой скрипт, позволяющий по крону отслеживать системный журнал и находить записи по работе <strong>Windows Server Backup</strong>.</p>
<h2 id="скрипт">
  <a class="link-body-emphasis" href="#%d1%81%d0%ba%d1%80%d0%b8%d0%bf%d1%82">Скрипт</a>
</h2><p>Скрипт анализирует системный журнал и фиксирует записи, принадлежащие <span class="shortcode shortcode-tag"><a href="/ru/tags/windows/" target="_blank">#Windows</a></span> Server Backup. Скрипт состоит из файла настроек, к которому можно ограничить доступ, приложения и двух задач.</p>
<h3 id="установка">
  <a class="link-body-emphasis" href="#%d1%83%d1%81%d1%82%d0%b0%d0%bd%d0%be%d0%b2%d0%ba%d0%b0">Установка</a>
</h3><ul>
<li>Скопировать файлы <code>app.backup.wsb.mail.ps1</code> и <code>app.backup.wsb.mail.ini</code> в директорию <code>C:\Scripts\</code>.</li>
<li>Импортировать задания <code>task.backup.wsb.mail.error.xml</code> и <code>task.backup.wsb.mail.success.xml</code> в <strong>Windows Task Scheduler</strong> и откорректировать параметры вызова скрипта.</li>
<li>Изменить параметры скрипта в файле <code>app.backup.wsb.mail.ini</code>.</li>
</ul>
<h3 id="настройка">
  <a class="link-body-emphasis" href="#%d0%bd%d0%b0%d1%81%d1%82%d1%80%d0%be%d0%b9%d0%ba%d0%b0">Настройка</a>
</h3><p>Файл настройки представляет собой простой файл <code>.ini</code>, содержащий в себе приватные параметры.</p>

    

    
        
            
            <div class="shortcode shortcode-file mb-3">
              <div class="card overflow-hidden" data-bs-theme="dark">
                <div class="card-header">
                  <div class="d-flex align-items-center">
                    <div class="flex-shrink-0">
                      <i class="far fa-file-code fa-fw"></i>
                    </div>
                    <div class="flex-grow-1 mx-2 text-truncate">
                      <code>app.backup.wsb.mail.ini</code>
                    </div>
                    <div class="flex-shrink-0">
                      <ul class="list-inline mb-0">
                        <li class="list-inline-item" title='Копировать'>
                          <a class="text-body" href="#"
                             data-fn="clipboard" data-clipboard-target="#cp-5e8974b4856c926b1ad7f3dca337603e"
                             role="button" aria-label='Копировать'>
                            <i class="fas fa-copy fa-fw"></i>
                          </a>
                        </li>
                        <li class="list-inline-item" title='Скачать'>
                          <a class="text-body" href="/ru/2024/09/40539e36-4656-5532-b920-8975c97d4dc5/app.backup.wsb.mail.ini" download
                             role="button" aria-label='Скачать'>
                            <i class="fas fa-download fa-fw"></i>
                          </a>
                        </li>
                        <li class="list-inline-item" title='Открыть'>
                          <a class="text-body" href="/ru/2024/09/40539e36-4656-5532-b920-8975c97d4dc5/app.backup.wsb.mail.ini" target="_blank"
                             role="button" aria-label='Открыть'>
                            <i class="fas fa-arrow-up-right-from-square fa-fw"></i>
                          </a>
                        </li>
                      </ul>
                    </div>
                  </div>
                </div>
                <div class="card-body p-0 overflow-auto" id="cp-5e8974b4856c926b1ad7f3dca337603e">
                    
                        
                    
                    <div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-ini" data-lang="ini"><span class="line"><span class="cl"><span class="na">From</span><span class="o">=</span><span class="s">mail@domain.com</span>
</span></span><span class="line"><span class="cl"><span class="na">To</span><span class="o">=</span><span class="s">mail@domain.org</span>
</span></span><span class="line"><span class="cl"><span class="na">Server</span><span class="o">=</span><span class="s">192.168.11.22</span>
</span></span><span class="line"><span class="cl"><span class="na">Port</span><span class="o">=</span><span class="s">25</span>
</span></span><span class="line"><span class="cl"><span class="na">User</span><span class="o">=</span><span class="s">smtp_user</span>
</span></span><span class="line"><span class="cl"><span class="na">Password</span><span class="o">=</span><span class="s">smtp_password</span></span></span></code></pre></td></tr></table>
</div>
</div>
                </div>
              </div>
            </div>
        
    
<h4 id="параметры">
  <a class="link-body-emphasis" href="#%d0%bf%d0%b0%d1%80%d0%b0%d0%bc%d0%b5%d1%82%d1%80%d1%8b">Параметры</a>
</h4><ul>
<li><code>From</code> - адрес email, с которого будет отправлено сообщение.</li>
<li><code>To</code> - адрес email, на который будет отправлено сообщение.</li>
<li><code>Server</code> - IP-адрес SMTP-сервера.</li>
<li><code>Port</code> - порт SMTP-сервера.</li>
<li><code>User</code> - имя пользователя в SMTP-сервере.</li>
<li><code>Password</code> - пароль пользователя в SMTP-сервере.</li>
</ul>
<h3 id="приложение">
  <a class="link-body-emphasis" href="#%d0%bf%d1%80%d0%b8%d0%bb%d0%be%d0%b6%d0%b5%d0%bd%d0%b8%d0%b5">Приложение</a>
</h3>
    

    
        
            
            <div class="shortcode shortcode-file mb-3">
              <div class="card overflow-hidden" data-bs-theme="dark">
                <div class="card-header">
                  <div class="d-flex align-items-center">
                    <div class="flex-shrink-0">
                      <i class="far fa-file-code fa-fw"></i>
                    </div>
                    <div class="flex-grow-1 mx-2 text-truncate">
                      <code>app.backup.wsb.mail.ps1</code>
                    </div>
                    <div class="flex-shrink-0">
                      <ul class="list-inline mb-0">
                        <li class="list-inline-item" title='Копировать'>
                          <a class="text-body" href="#"
                             data-fn="clipboard" data-clipboard-target="#cp-b24d54cec8743097d99a272c1fd17ed3"
                             role="button" aria-label='Копировать'>
                            <i class="fas fa-copy fa-fw"></i>
                          </a>
                        </li>
                        <li class="list-inline-item" title='Скачать'>
                          <a class="text-body" href="/ru/2024/09/40539e36-4656-5532-b920-8975c97d4dc5/app.backup.wsb.mail.ps1" download
                             role="button" aria-label='Скачать'>
                            <i class="fas fa-download fa-fw"></i>
                          </a>
                        </li>
                        <li class="list-inline-item" title='Открыть'>
                          <a class="text-body" href="/ru/2024/09/40539e36-4656-5532-b920-8975c97d4dc5/app.backup.wsb.mail.ps1" target="_blank"
                             role="button" aria-label='Открыть'>
                            <i class="fas fa-arrow-up-right-from-square fa-fw"></i>
                          </a>
                        </li>
                      </ul>
                    </div>
                  </div>
                </div>
                <div class="card-body p-0 overflow-auto" id="cp-b24d54cec8743097d99a272c1fd17ed3">
                    
                        
                    
                    <div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">  1
</span><span class="lnt">  2
</span><span class="lnt">  3
</span><span class="lnt">  4
</span><span class="lnt">  5
</span><span class="lnt">  6
</span><span class="lnt">  7
</span><span class="lnt">  8
</span><span class="lnt">  9
</span><span class="lnt"> 10
</span><span class="lnt"> 11
</span><span class="lnt"> 12
</span><span class="lnt"> 13
</span><span class="lnt"> 14
</span><span class="lnt"> 15
</span><span class="lnt"> 16
</span><span class="lnt"> 17
</span><span class="lnt"> 18
</span><span class="lnt"> 19
</span><span class="lnt"> 20
</span><span class="lnt"> 21
</span><span class="lnt"> 22
</span><span class="lnt"> 23
</span><span class="lnt"> 24
</span><span class="lnt"> 25
</span><span class="lnt"> 26
</span><span class="lnt"> 27
</span><span class="lnt"> 28
</span><span class="lnt"> 29
</span><span class="lnt"> 30
</span><span class="lnt"> 31
</span><span class="lnt"> 32
</span><span class="lnt"> 33
</span><span class="lnt"> 34
</span><span class="lnt"> 35
</span><span class="lnt"> 36
</span><span class="lnt"> 37
</span><span class="lnt"> 38
</span><span class="lnt"> 39
</span><span class="lnt"> 40
</span><span class="lnt"> 41
</span><span class="lnt"> 42
</span><span class="lnt"> 43
</span><span class="lnt"> 44
</span><span class="lnt"> 45
</span><span class="lnt"> 46
</span><span class="lnt"> 47
</span><span class="lnt"> 48
</span><span class="lnt"> 49
</span><span class="lnt"> 50
</span><span class="lnt"> 51
</span><span class="lnt"> 52
</span><span class="lnt"> 53
</span><span class="lnt"> 54
</span><span class="lnt"> 55
</span><span class="lnt"> 56
</span><span class="lnt"> 57
</span><span class="lnt"> 58
</span><span class="lnt"> 59
</span><span class="lnt"> 60
</span><span class="lnt"> 61
</span><span class="lnt"> 62
</span><span class="lnt"> 63
</span><span class="lnt"> 64
</span><span class="lnt"> 65
</span><span class="lnt"> 66
</span><span class="lnt"> 67
</span><span class="lnt"> 68
</span><span class="lnt"> 69
</span><span class="lnt"> 70
</span><span class="lnt"> 71
</span><span class="lnt"> 72
</span><span class="lnt"> 73
</span><span class="lnt"> 74
</span><span class="lnt"> 75
</span><span class="lnt"> 76
</span><span class="lnt"> 77
</span><span class="lnt"> 78
</span><span class="lnt"> 79
</span><span class="lnt"> 80
</span><span class="lnt"> 81
</span><span class="lnt"> 82
</span><span class="lnt"> 83
</span><span class="lnt"> 84
</span><span class="lnt"> 85
</span><span class="lnt"> 86
</span><span class="lnt"> 87
</span><span class="lnt"> 88
</span><span class="lnt"> 89
</span><span class="lnt"> 90
</span><span class="lnt"> 91
</span><span class="lnt"> 92
</span><span class="lnt"> 93
</span><span class="lnt"> 94
</span><span class="lnt"> 95
</span><span class="lnt"> 96
</span><span class="lnt"> 97
</span><span class="lnt"> 98
</span><span class="lnt"> 99
</span><span class="lnt">100
</span><span class="lnt">101
</span><span class="lnt">102
</span><span class="lnt">103
</span><span class="lnt">104
</span><span class="lnt">105
</span><span class="lnt">106
</span><span class="lnt">107
</span><span class="lnt">108
</span><span class="lnt">109
</span><span class="lnt">110
</span><span class="lnt">111
</span><span class="lnt">112
</span><span class="lnt">113
</span><span class="lnt">114
</span><span class="lnt">115
</span><span class="lnt">116
</span><span class="lnt">117
</span><span class="lnt">118
</span><span class="lnt">119
</span><span class="lnt">120
</span><span class="lnt">121
</span><span class="lnt">122
</span><span class="lnt">123
</span><span class="lnt">124
</span><span class="lnt">125
</span><span class="lnt">126
</span><span class="lnt">127
</span><span class="lnt">128
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-ps1" data-lang="ps1"><span class="line"><span class="cl"><span class="cm">&lt;#PSScriptInfo
</span></span></span><span class="line"><span class="cl"><span class="cm">.VERSION      0.1.0
</span></span></span><span class="line"><span class="cl"><span class="cm">.GUID         18c25998-a474-425e-a59f-e32f79c8431d
</span></span></span><span class="line"><span class="cl"><span class="cm">.AUTHOR       Kai Kimera
</span></span></span><span class="line"><span class="cl"><span class="cm">.AUTHOREMAIL  mail@kai.kim
</span></span></span><span class="line"><span class="cl"><span class="cm">.COMPANYNAME  Library Online
</span></span></span><span class="line"><span class="cl"><span class="cm">.COPYRIGHT    2024 Library Online. All rights reserved.
</span></span></span><span class="line"><span class="cl"><span class="cm">.TAGS         windows server backup mail
</span></span></span><span class="line"><span class="cl"><span class="cm">.LICENSEURI   https://choosealicense.com/licenses/mit/
</span></span></span><span class="line"><span class="cl"><span class="cm">.PROJECTURI   https://lib.onl/ru/2024/09/40539e36-4656-5532-b920-8975c97d4dc5/
</span></span></span><span class="line"><span class="cl"><span class="cm">#&gt;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="cm">&lt;#
</span></span></span><span class="line"><span class="cl"><span class="cm">.</span><span class="sd">SYNOPSIS</span><span class="cm">
</span></span></span><span class="line"><span class="cl"><span class="cm">Script for sending messages about backup status.
</span></span></span><span class="line"><span class="cl"><span class="cm">
</span></span></span><span class="line"><span class="cl"><span class="cm">.</span><span class="sd">DESCRIPTION</span><span class="cm">
</span></span></span><span class="line"><span class="cl"><span class="cm">The script sends messages to the specified address for further analysis.
</span></span></span><span class="line"><span class="cl"><span class="cm">The messages contain the host ID and notification type.
</span></span></span><span class="line"><span class="cl"><span class="cm">
</span></span></span><span class="line"><span class="cl"><span class="cm">.</span><span class="sd">EXAMPLE</span><span class="cm">
</span></span></span><span class="line"><span class="cl"><span class="cm">.\app.backup.wsb.mail.ps1 -Type &#39;error&#39; [-SSL]
</span></span></span><span class="line"><span class="cl"><span class="cm">
</span></span></span><span class="line"><span class="cl"><span class="cm">.</span><span class="sd">EXAMPLE</span><span class="cm">
</span></span></span><span class="line"><span class="cl"><span class="cm">.\app.backup.wsb.mail.ps1 -Type &#39;success&#39; [-SSL]
</span></span></span><span class="line"><span class="cl"><span class="cm">
</span></span></span><span class="line"><span class="cl"><span class="cm">.</span><span class="sd">LINK</span><span class="cm">
</span></span></span><span class="line"><span class="cl"><span class="cm">https://lib.onl/ru/2024/09/40539e36-4656-5532-b920-8975c97d4dc5/
</span></span></span><span class="line"><span class="cl"><span class="cm">#&gt;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c"># -------------------------------------------------------------------------------------------------------------------- #</span>
</span></span><span class="line"><span class="cl"><span class="c"># CONFIGURATION</span>
</span></span><span class="line"><span class="cl"><span class="c"># -------------------------------------------------------------------------------------------------------------------- #</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">param</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">  <span class="p">[</span><span class="nb">Parameter</span><span class="p">(</span><span class="na">HelpMessage</span><span class="p">=</span><span class="s1">&#39;Message type.&#39;</span><span class="p">)]</span>
</span></span><span class="line"><span class="cl">  <span class="p">[</span><span class="nb">ValidateSet</span><span class="p">(</span><span class="s1">&#39;error&#39;</span><span class="p">,</span> <span class="s1">&#39;success&#39;</span><span class="p">)]</span>
</span></span><span class="line"><span class="cl">  <span class="p">[</span><span class="no">string</span><span class="p">]</span><span class="nv">$Type</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">  <span class="p">[</span><span class="nb">Parameter</span><span class="p">(</span><span class="na">HelpMessage</span><span class="p">=</span><span class="s1">&#39;Enable or disable encrypted connection.&#39;</span><span class="p">)]</span>
</span></span><span class="line"><span class="cl">  <span class="p">[</span><span class="no">switch</span><span class="p">]</span><span class="nv">$SSL</span> <span class="p">=</span> <span class="vm">$false</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">  <span class="p">[</span><span class="nb">Alias</span><span class="p">(</span><span class="s1">&#39;Host&#39;</span><span class="p">)][</span><span class="no">string</span><span class="p">]</span><span class="nv">$Hostname</span> <span class="p">=</span> <span class="p">([</span><span class="no">System.Net.Dns</span><span class="p">]::</span><span class="n">GetHostByName</span><span class="p">([</span><span class="no">string</span><span class="p">]</span><span class="s1">&#39;localhost&#39;</span><span class="p">).</span><span class="n">HostName</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c"># Loading configuration data.</span>
</span></span><span class="line"><span class="cl"><span class="nv">$S</span> <span class="p">=</span> <span class="p">((</span><span class="nb">Get-Item</span> <span class="s2">&#34;</span><span class="nv">${PSCommandPath}</span><span class="s2">&#34;</span><span class="p">).</span><span class="py">Basename</span> <span class="p">+</span> <span class="s1">&#39;.ini&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nv">$P</span> <span class="p">=</span> <span class="p">(</span><span class="nb">Get-Content</span> <span class="n">-Path</span> <span class="s2">&#34;</span><span class="nv">${PSScriptRoot}</span><span class="s2">\</span><span class="nv">${S}</span><span class="s2">&#34;</span> <span class="p">|</span> <span class="nb">ConvertFrom-StringData</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c"># Generating HostID (HID).</span>
</span></span><span class="line"><span class="cl"><span class="nv">$UUID</span> <span class="p">=</span> <span class="p">(</span><span class="nb">Get-CimInstance</span> <span class="s1">&#39;Win32_ComputerSystemProduct&#39;</span> <span class="p">|</span> <span class="nb">Select-Object</span> <span class="n">-ExpandProperty</span> <span class="s1">&#39;UUID&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nv">$HID</span> <span class="p">=</span> <span class="p">((${</span><span class="n">Hostname</span><span class="p">}</span> <span class="p">+</span> <span class="s1">&#39;:&#39;</span> <span class="p">+</span> <span class="p">${</span><span class="n">UUID</span><span class="p">}).</span><span class="py">ToUpper</span><span class="p">())</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c"># -------------------------------------------------------------------------------------------------------------------- #</span>
</span></span><span class="line"><span class="cl"><span class="c"># INITIALIZATION</span>
</span></span><span class="line"><span class="cl"><span class="c"># -------------------------------------------------------------------------------------------------------------------- #</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kd">function</span><span class="w"> </span><span class="nb">Start-Script</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="k">switch</span> <span class="p">(</span><span class="s2">&#34;</span><span class="nv">${Type}</span><span class="s2">&#34;</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="s1">&#39;error&#39;</span>   <span class="p">{</span> <span class="nb">Send-BackupError</span> <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="s1">&#39;success&#39;</span> <span class="p">{</span> <span class="nb">Send-BackupSuccess</span> <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="k">default</span>   <span class="p">{</span> <span class="n">exit</span> <span class="p">}</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c"># -------------------------------------------------------------------------------------------------------------------- #</span>
</span></span><span class="line"><span class="cl"><span class="c"># BACKUP: ERROR</span>
</span></span><span class="line"><span class="cl"><span class="c"># Sending an email after a failed backup.</span>
</span></span><span class="line"><span class="cl"><span class="c"># -------------------------------------------------------------------------------------------------------------------- #</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kd">function</span><span class="w"> </span><span class="nb">Send-BackupError</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="nv">$Subject</span> <span class="p">=</span> <span class="s2">&#34;Windows Server Backup: </span><span class="nv">${Hostname}</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl">  <span class="nv">$Body</span> <span class="p">=</span> <span class="sh">@&#34;
</span></span></span><span class="line"><span class="cl"><span class="sh">Windows Server Backup failed: </span><span class="nv">${Hostname}</span><span class="sh">.
</span></span></span><span class="line"><span class="cl"><span class="sh">Please check server backup!
</span></span></span><span class="line"><span class="cl"><span class="sh">
</span></span></span><span class="line"><span class="cl"><span class="sh">Host: </span><span class="nv">${Hostname}</span><span class="sh">
</span></span></span><span class="line"><span class="cl"><span class="sh">Status: ERROR
</span></span></span><span class="line"><span class="cl"><span class="sh">
</span></span></span><span class="line"><span class="cl"><span class="sh">-- 
</span></span></span><span class="line"><span class="cl"><span class="sh">#ID:</span><span class="nv">${HID}</span><span class="sh">
</span></span></span><span class="line"><span class="cl"><span class="sh">#TYPE:BACKUP:ERROR
</span></span></span><span class="line"><span class="cl"><span class="sh">&#34;@</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="nb">Start-Smtp</span> <span class="n">-S</span> <span class="s2">&#34;</span><span class="nv">${Subject}</span><span class="s2">&#34;</span> <span class="n">-B</span> <span class="s2">&#34;</span><span class="nv">${Body}</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c"># -------------------------------------------------------------------------------------------------------------------- #</span>
</span></span><span class="line"><span class="cl"><span class="c"># BACKUP: SUCCESS</span>
</span></span><span class="line"><span class="cl"><span class="c"># Sending an email after a successful backup.</span>
</span></span><span class="line"><span class="cl"><span class="c"># -------------------------------------------------------------------------------------------------------------------- #</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kd">function</span><span class="w"> </span><span class="nb">Send-BackupSuccess</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="nv">$Subject</span> <span class="p">=</span> <span class="s2">&#34;Windows Server Backup: </span><span class="nv">${Hostname}</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl">  <span class="nv">$Body</span> <span class="p">=</span> <span class="sh">@&#34;
</span></span></span><span class="line"><span class="cl"><span class="sh">Windows Server Backup completed successfully!
</span></span></span><span class="line"><span class="cl"><span class="sh">
</span></span></span><span class="line"><span class="cl"><span class="sh">Host: </span><span class="nv">${Hostname}</span><span class="sh">
</span></span></span><span class="line"><span class="cl"><span class="sh">Status: SUCCESS
</span></span></span><span class="line"><span class="cl"><span class="sh">
</span></span></span><span class="line"><span class="cl"><span class="sh">-- 
</span></span></span><span class="line"><span class="cl"><span class="sh">#ID:</span><span class="nv">${HID}</span><span class="sh">
</span></span></span><span class="line"><span class="cl"><span class="sh">#TYPE:BACKUP:SUCCESS
</span></span></span><span class="line"><span class="cl"><span class="sh">&#34;@</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="nb">Start-Smtp</span> <span class="n">-S</span> <span class="s2">&#34;</span><span class="nv">${Subject}</span><span class="s2">&#34;</span> <span class="n">-B</span> <span class="s2">&#34;</span><span class="nv">${Body}</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c"># -------------------------------------------------------------------------------------------------------------------- #</span>
</span></span><span class="line"><span class="cl"><span class="c"># SMTP</span>
</span></span><span class="line"><span class="cl"><span class="c"># SMTP configuration.</span>
</span></span><span class="line"><span class="cl"><span class="c"># -------------------------------------------------------------------------------------------------------------------- #</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kd">function</span><span class="w"> </span><span class="nb">Start-Smtp</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="k">param</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">    <span class="p">[</span><span class="nb">Alias</span><span class="p">(</span><span class="s1">&#39;S&#39;</span><span class="p">)][</span><span class="no">string</span><span class="p">]</span><span class="nv">$Subject</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="p">[</span><span class="nb">Alias</span><span class="p">(</span><span class="s1">&#39;B&#39;</span><span class="p">)][</span><span class="no">string</span><span class="p">]</span><span class="nv">$Body</span>
</span></span><span class="line"><span class="cl">  <span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="nv">$SmtpClient</span> <span class="p">=</span> <span class="nb">New-Object</span> <span class="n">Net</span><span class="p">.</span><span class="py">Mail</span><span class="p">.</span><span class="py">SmtpClient</span><span class="p">(</span><span class="s2">&#34;</span><span class="p">$(</span><span class="nv">$P</span><span class="p">.</span><span class="n">Server</span><span class="p">)</span><span class="s2">&#34;</span><span class="p">,</span> <span class="s2">&#34;</span><span class="p">$(</span><span class="nv">$P</span><span class="p">.</span><span class="n">Port</span><span class="p">)</span><span class="s2">&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="nv">$SmtpClient</span><span class="p">.</span><span class="py">EnableSsl</span> <span class="p">=</span> <span class="nv">$SSL</span>
</span></span><span class="line"><span class="cl">  <span class="nv">$SmtpClient</span><span class="p">.</span><span class="py">Credentials</span> <span class="p">=</span> <span class="nb">New-Object</span> <span class="n">System</span><span class="p">.</span><span class="py">Net</span><span class="p">.</span><span class="py">NetworkCredential</span><span class="p">(</span><span class="s2">&#34;</span><span class="p">$(</span><span class="nv">$P</span><span class="p">.</span><span class="n">User</span><span class="p">)</span><span class="s2">&#34;</span><span class="p">,</span> <span class="s2">&#34;</span><span class="p">$(</span><span class="nv">$P</span><span class="p">.</span><span class="n">Password</span><span class="p">)</span><span class="s2">&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="nv">$SmtpClient</span><span class="p">.</span><span class="py">Send</span><span class="p">(</span><span class="s2">&#34;</span><span class="p">$(</span><span class="nv">$P</span><span class="p">.</span><span class="n">From</span><span class="p">)</span><span class="s2">&#34;</span><span class="p">,</span> <span class="s2">&#34;</span><span class="p">$(</span><span class="nv">$P</span><span class="p">.</span><span class="n">To</span><span class="p">)</span><span class="s2">&#34;</span><span class="p">,</span> <span class="s2">&#34;</span><span class="nv">${Subject}</span><span class="s2">&#34;</span><span class="p">,</span> <span class="s2">&#34;</span><span class="nv">${Body}</span><span class="s2">&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c"># -------------------------------------------------------------------------------------------------------------------- #</span>
</span></span><span class="line"><span class="cl"><span class="c"># -------------------------------------------------&lt; RUNNING SCRIPT &gt;------------------------------------------------- #</span>
</span></span><span class="line"><span class="cl"><span class="c"># -------------------------------------------------------------------------------------------------------------------- #</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nb">Start-Script</span></span></span></code></pre></td></tr></table>
</div>
</div>
                </div>
              </div>
            </div>
        
    
<h4 id="параметры-1">
  <a class="link-body-emphasis" href="#%d0%bf%d0%b0%d1%80%d0%b0%d0%bc%d0%b5%d1%82%d1%80%d1%8b-1">Параметры</a>
</h4><ul>
<li><code>Type</code> - тип сообщения.
<ul>
<li><code>success</code> - задание <span class="shortcode shortcode-tag"><a href="/ru/tags/windows/" target="_blank">#Windows</a></span> Server Backup успешно выполнено.</li>
<li><code>error</code> - задание <span class="shortcode shortcode-tag"><a href="/ru/tags/windows/" target="_blank">#Windows</a></span> Server Backup не выполнено или выполнено с ошибками.</li>
</ul>
</li>
</ul>
<h3 id="задачи">
  <a class="link-body-emphasis" href="#%d0%b7%d0%b0%d0%b4%d0%b0%d1%87%d0%b8">Задачи</a>
</h3><p>Задачи делятся на два типа: <em><strong>ошибка</strong></em> и <em><strong>успешное выполнение</strong></em>. Каждая из задач будет искать записи <span class="shortcode shortcode-tag"><a href="/ru/tags/windows/" target="_blank">#Windows</a></span> Server Backup в журнале и запускаться в зависимости от идентификатора события (<code>EventID</code>).</p>
<h4 id="ошибка">
  <a class="link-body-emphasis" href="#%d0%be%d1%88%d0%b8%d0%b1%d0%ba%d0%b0">Ошибка</a>
</h4><p>Задача присылает уведомление в том случае, когда в журнале событий появляется запись об ошибке выполнения <span class="shortcode shortcode-tag"><a href="/ru/tags/windows/" target="_blank">#Windows</a></span> Server Backup.</p>

    

    
        
            
            <div class="shortcode shortcode-file mb-3">
              <div class="card overflow-hidden" data-bs-theme="dark">
                <div class="card-header">
                  <div class="d-flex align-items-center">
                    <div class="flex-shrink-0">
                      <i class="far fa-file-code fa-fw"></i>
                    </div>
                    <div class="flex-grow-1 mx-2 text-truncate">
                      <code>task.backup.wsb.mail.error.xml</code>
                    </div>
                    <div class="flex-shrink-0">
                      <ul class="list-inline mb-0">
                        <li class="list-inline-item" title='Копировать'>
                          <a class="text-body" href="#"
                             data-fn="clipboard" data-clipboard-target="#cp-2874da778928d2d3d2976b1678127e87"
                             role="button" aria-label='Копировать'>
                            <i class="fas fa-copy fa-fw"></i>
                          </a>
                        </li>
                        <li class="list-inline-item" title='Скачать'>
                          <a class="text-body" href="/ru/2024/09/40539e36-4656-5532-b920-8975c97d4dc5/task.backup.wsb.mail.error.xml" download
                             role="button" aria-label='Скачать'>
                            <i class="fas fa-download fa-fw"></i>
                          </a>
                        </li>
                        <li class="list-inline-item" title='Открыть'>
                          <a class="text-body" href="/ru/2024/09/40539e36-4656-5532-b920-8975c97d4dc5/task.backup.wsb.mail.error.xml" target="_blank"
                             role="button" aria-label='Открыть'>
                            <i class="fas fa-arrow-up-right-from-square fa-fw"></i>
                          </a>
                        </li>
                      </ul>
                    </div>
                  </div>
                </div>
                <div class="card-body p-0 overflow-auto" id="cp-2874da778928d2d3d2976b1678127e87">
                    
                        
                    
                    <div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-xml" data-lang="xml"><span class="line"><span class="cl"><span class="cp">&lt;?xml version=&#34;1.0&#34; encoding=&#34;UTF-16&#34;?&gt;</span>
</span></span><span class="line"><span class="cl"><span class="nt">&lt;Task</span> <span class="na">version=</span><span class="s">&#34;1.2&#34;</span> <span class="na">xmlns=</span><span class="s">&#34;http://schemas.microsoft.com/windows/2004/02/mit/task&#34;</span><span class="nt">&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="nt">&lt;RegistrationInfo&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;Description&gt;</span>Notifies backup admin of scheduled backup failure.<span class="nt">&lt;/Description&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="nt">&lt;/RegistrationInfo&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="nt">&lt;Triggers&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;EventTrigger&gt;</span>
</span></span><span class="line"><span class="cl">      <span class="nt">&lt;Enabled&gt;</span>true<span class="nt">&lt;/Enabled&gt;</span>
</span></span><span class="line"><span class="cl">      <span class="nt">&lt;Subscription&gt;</span><span class="ni">&amp;lt;</span>QueryList<span class="ni">&amp;gt;&amp;lt;</span>Query Id=&#34;0&#34; Path=&#34;Microsoft-Windows-Backup&#34;<span class="ni">&amp;gt;&amp;lt;</span>Select Path=&#34;Microsoft-Windows-Backup&#34;<span class="ni">&amp;gt;</span>*[System[Provider[@Name=&#39;Microsoft-Windows-Backup&#39;] and (EventID=5 or EventID=8 or EventID=9 or  (EventID <span class="ni">&amp;amp;</span>gt;= 17 and EventID <span class="ni">&amp;amp;</span>lt;= 22)  or EventID=49 or EventID=50 or EventID=52 or EventID=100 or EventID=517 or EventID=518 or EventID=521 or EventID=527 or EventID=528 or EventID=544 or EventID=545 or EventID=546 or EventID=561 or EventID=564 or EventID=612)]]<span class="ni">&amp;lt;</span>/Select<span class="ni">&amp;gt;&amp;lt;</span>/Query<span class="ni">&amp;gt;&amp;lt;</span>/QueryList<span class="ni">&amp;gt;</span><span class="nt">&lt;/Subscription&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;/EventTrigger&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="nt">&lt;/Triggers&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="nt">&lt;Settings&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;MultipleInstancesPolicy&gt;</span>IgnoreNew<span class="nt">&lt;/MultipleInstancesPolicy&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;DisallowStartIfOnBatteries&gt;</span>true<span class="nt">&lt;/DisallowStartIfOnBatteries&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;StopIfGoingOnBatteries&gt;</span>true<span class="nt">&lt;/StopIfGoingOnBatteries&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;AllowHardTerminate&gt;</span>true<span class="nt">&lt;/AllowHardTerminate&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;StartWhenAvailable&gt;</span>false<span class="nt">&lt;/StartWhenAvailable&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;RunOnlyIfNetworkAvailable&gt;</span>false<span class="nt">&lt;/RunOnlyIfNetworkAvailable&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;IdleSettings&gt;</span>
</span></span><span class="line"><span class="cl">      <span class="nt">&lt;StopOnIdleEnd&gt;</span>true<span class="nt">&lt;/StopOnIdleEnd&gt;</span>
</span></span><span class="line"><span class="cl">      <span class="nt">&lt;RestartOnIdle&gt;</span>false<span class="nt">&lt;/RestartOnIdle&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;/IdleSettings&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;AllowStartOnDemand&gt;</span>true<span class="nt">&lt;/AllowStartOnDemand&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;Enabled&gt;</span>true<span class="nt">&lt;/Enabled&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;Hidden&gt;</span>false<span class="nt">&lt;/Hidden&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;RunOnlyIfIdle&gt;</span>false<span class="nt">&lt;/RunOnlyIfIdle&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;WakeToRun&gt;</span>false<span class="nt">&lt;/WakeToRun&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="nt">&lt;/Settings&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="nt">&lt;Actions</span> <span class="na">Context=</span><span class="s">&#34;Author&#34;</span><span class="nt">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;Exec&gt;</span>
</span></span><span class="line"><span class="cl">      <span class="nt">&lt;Command&gt;</span>powershell<span class="nt">&lt;/Command&gt;</span>
</span></span><span class="line"><span class="cl">      <span class="nt">&lt;Arguments&gt;</span>&#34;C:\Scripts\app.backup.wsb.mail.ps1&#34; -Type &#39;error&#39;<span class="nt">&lt;/Arguments&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;/Exec&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="nt">&lt;/Actions&gt;</span>
</span></span><span class="line"><span class="cl"><span class="nt">&lt;/Task&gt;</span></span></span></code></pre></td></tr></table>
</div>
</div>
                </div>
              </div>
            </div>
        
    
<h4 id="успешно">
  <a class="link-body-emphasis" href="#%d1%83%d1%81%d0%bf%d0%b5%d1%88%d0%bd%d0%be">Успешно</a>
</h4><p>Задача присылает уведомление в том случае, когда в журнале событий появляется запись об успешном выполнении <span class="shortcode shortcode-tag"><a href="/ru/tags/windows/" target="_blank">#Windows</a></span> Server Backup.</p>

    

    
        
            
            <div class="shortcode shortcode-file mb-3">
              <div class="card overflow-hidden" data-bs-theme="dark">
                <div class="card-header">
                  <div class="d-flex align-items-center">
                    <div class="flex-shrink-0">
                      <i class="far fa-file-code fa-fw"></i>
                    </div>
                    <div class="flex-grow-1 mx-2 text-truncate">
                      <code>task.backup.wsb.mail.success.xml</code>
                    </div>
                    <div class="flex-shrink-0">
                      <ul class="list-inline mb-0">
                        <li class="list-inline-item" title='Копировать'>
                          <a class="text-body" href="#"
                             data-fn="clipboard" data-clipboard-target="#cp-d9a34e931006b963ee8c9de5f9509dcf"
                             role="button" aria-label='Копировать'>
                            <i class="fas fa-copy fa-fw"></i>
                          </a>
                        </li>
                        <li class="list-inline-item" title='Скачать'>
                          <a class="text-body" href="/ru/2024/09/40539e36-4656-5532-b920-8975c97d4dc5/task.backup.wsb.mail.success.xml" download
                             role="button" aria-label='Скачать'>
                            <i class="fas fa-download fa-fw"></i>
                          </a>
                        </li>
                        <li class="list-inline-item" title='Открыть'>
                          <a class="text-body" href="/ru/2024/09/40539e36-4656-5532-b920-8975c97d4dc5/task.backup.wsb.mail.success.xml" target="_blank"
                             role="button" aria-label='Открыть'>
                            <i class="fas fa-arrow-up-right-from-square fa-fw"></i>
                          </a>
                        </li>
                      </ul>
                    </div>
                  </div>
                </div>
                <div class="card-body p-0 overflow-auto" id="cp-d9a34e931006b963ee8c9de5f9509dcf">
                    
                        
                    
                    <div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-xml" data-lang="xml"><span class="line"><span class="cl"><span class="cp">&lt;?xml version=&#34;1.0&#34; encoding=&#34;UTF-16&#34;?&gt;</span>
</span></span><span class="line"><span class="cl"><span class="nt">&lt;Task</span> <span class="na">version=</span><span class="s">&#34;1.2&#34;</span> <span class="na">xmlns=</span><span class="s">&#34;http://schemas.microsoft.com/windows/2004/02/mit/task&#34;</span><span class="nt">&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="nt">&lt;RegistrationInfo&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;Description&gt;</span>Notifies backup admin of scheduled backup successful completion.<span class="nt">&lt;/Description&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="nt">&lt;/RegistrationInfo&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="nt">&lt;Triggers&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;EventTrigger&gt;</span>
</span></span><span class="line"><span class="cl">      <span class="nt">&lt;Enabled&gt;</span>true<span class="nt">&lt;/Enabled&gt;</span>
</span></span><span class="line"><span class="cl">      <span class="nt">&lt;Subscription&gt;</span><span class="ni">&amp;lt;</span>QueryList<span class="ni">&amp;gt;&amp;lt;</span>Query Id=&#34;0&#34; Path=&#34;Microsoft-Windows-Backup&#34;<span class="ni">&amp;gt;&amp;lt;</span>Select Path=&#34;Microsoft-Windows-Backup&#34;<span class="ni">&amp;gt;</span>*[System[Provider[@Name=&#39;Microsoft-Windows-Backup&#39;] and (EventID=4)]]<span class="ni">&amp;lt;</span>/Select<span class="ni">&amp;gt;&amp;lt;</span>/Query<span class="ni">&amp;gt;&amp;lt;</span>/QueryList<span class="ni">&amp;gt;</span><span class="nt">&lt;/Subscription&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;/EventTrigger&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="nt">&lt;/Triggers&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="nt">&lt;Settings&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;MultipleInstancesPolicy&gt;</span>IgnoreNew<span class="nt">&lt;/MultipleInstancesPolicy&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;DisallowStartIfOnBatteries&gt;</span>true<span class="nt">&lt;/DisallowStartIfOnBatteries&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;StopIfGoingOnBatteries&gt;</span>true<span class="nt">&lt;/StopIfGoingOnBatteries&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;AllowHardTerminate&gt;</span>true<span class="nt">&lt;/AllowHardTerminate&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;StartWhenAvailable&gt;</span>false<span class="nt">&lt;/StartWhenAvailable&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;RunOnlyIfNetworkAvailable&gt;</span>false<span class="nt">&lt;/RunOnlyIfNetworkAvailable&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;IdleSettings&gt;</span>
</span></span><span class="line"><span class="cl">      <span class="nt">&lt;StopOnIdleEnd&gt;</span>true<span class="nt">&lt;/StopOnIdleEnd&gt;</span>
</span></span><span class="line"><span class="cl">      <span class="nt">&lt;RestartOnIdle&gt;</span>false<span class="nt">&lt;/RestartOnIdle&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;/IdleSettings&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;AllowStartOnDemand&gt;</span>true<span class="nt">&lt;/AllowStartOnDemand&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;Enabled&gt;</span>true<span class="nt">&lt;/Enabled&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;Hidden&gt;</span>false<span class="nt">&lt;/Hidden&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;RunOnlyIfIdle&gt;</span>false<span class="nt">&lt;/RunOnlyIfIdle&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;WakeToRun&gt;</span>false<span class="nt">&lt;/WakeToRun&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="nt">&lt;/Settings&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="nt">&lt;Actions</span> <span class="na">Context=</span><span class="s">&#34;Author&#34;</span><span class="nt">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;Exec&gt;</span>
</span></span><span class="line"><span class="cl">      <span class="nt">&lt;Command&gt;</span>powershell<span class="nt">&lt;/Command&gt;</span>
</span></span><span class="line"><span class="cl">      <span class="nt">&lt;Arguments&gt;</span>&#34;C:\Scripts\app.backup.wsb.mail.ps1&#34; -Type &#39;success&#39;<span class="nt">&lt;/Arguments&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;/Exec&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="nt">&lt;/Actions&gt;</span>
</span></span><span class="line"><span class="cl"><span class="nt">&lt;/Task&gt;</span></span></span></code></pre></td></tr></table>
</div>
</div>
                </div>
              </div>
            </div>]]></turbo:content></item><item turbo="true"><title>Удаление временных данных ОС Windows</title><link>https://lib.onl/ru/2024/09/aaef951a-9caf-5765-8189-c91f3f305821/</link><pubDate>Tue, 17 Sep 2024 20:15:52 +0000</pubDate><dc:creator>Kai Kimera</dc:creator><category>Скрипты</category><category>MS Windows</category><category>Терминал</category><yandex:related><link url="https://lib.onl/ru/2023/10/430b916d-fd5c-5d44-8c24-8b98f41e0355/">Работа с сетевыми интерфейсами в PowerShell</link><link url="https://lib.onl/ru/2023/10/1f062637-3227-56d7-93e3-126d1c80f5a8/">Работа с переменной среды окружения PATH</link><link url="https://lib.onl/ru/2023/10/fb64d665-3e56-5fa5-a9eb-2e2e251949d8/">Автоматическая настройка Windows Server 2022 под рабочую станцию</link><link url="https://lib.onl/ru/2023/10/38fc94dd-8d37-5f9e-b556-676304976a9f/">Восстановление доверительных отношений между PC и Active Directory</link><link url="https://lib.onl/ru/2023/10/616da78a-eb16-575a-9119-65f0c0c7baee/">Изменение порта RDP</link><link url="https://lib.onl/ru/2023/10/c6e32349-8fc2-53f9-9a42-790878a64076/">PowerShell: Полезные функции</link><link url="https://lib.onl/ru/2023/10/52d75b90-0637-5ba6-91d6-b1bff40e1d67/">PowerShell: Стирание диска</link><link url="https://lib.onl/ru/2023/10/2a73410a-6611-570c-9ab4-dc8cc8998146/">PowerShell: Сжатие видео при помощи FFmpeg</link><link url="https://lib.onl/ru/2023/10/0028821e-c96c-5014-a1dd-8963c161b170/">PowerShell: Определение разрядности ОС Windows</link><link url="https://lib.onl/ru/2023/10/4c7aba7c-f5a6-589a-9975-fdb16f2e2862/">PowerShell Vault</link><link url="https://lib.onl/ru/2023/10/eb39e3f7-b194-53d4-8bad-01edf9fdac47/">Дефрагментация в ОС Windows</link><link url="https://lib.onl/ru/2023/10/75075788-9308-56b7-b531-2008cb35f7d0/">Установка сертификата НУЦ Минцифры</link><link url="https://lib.onl/ru/2022/05/36058650-3f35-5ed5-9565-0aa7d8800c28/">Windows Server 2022 для рабочей станции</link></yandex:related><turbo:extendedHtml>true</turbo:extendedHtml><turbo:source>https://lib.onl/ru/2024/09/aaef951a-9caf-5765-8189-c91f3f305821/</turbo:source><turbo:topic>Удаление временных данных ОС Windows</turbo:topic><turbo:content><![CDATA[<p>Для экономии места на дисках, можно автоматически очищать ОС от временных данных.</p>
<p>Написал небольшой скрипт, который удаляет временные данные ОС с системного диска и профилей пользователей.</p>
<h2 id="скрипт">
  <a class="link-body-emphasis" href="#%d1%81%d0%ba%d1%80%d0%b8%d0%bf%d1%82">Скрипт</a>
</h2><p>Скрипт представляет собой комплект приложения и задачи для импорта в планировщик задач ОС <span class="shortcode shortcode-tag"><a href="/ru/tags/windows/" target="_blank">#Windows</a></span>.</p>
<h3 id="установка">
  <a class="link-body-emphasis" href="#%d1%83%d1%81%d1%82%d0%b0%d0%bd%d0%be%d0%b2%d0%ba%d0%b0">Установка</a>
</h3><ul>
<li>Скопировать файл <code>app.temp.cleanup.ps1</code> в директорию <code>C:\Scripts\</code>.</li>
<li>Импортировать задания <code>task.temp.cleanup.xml</code> в <strong>Windows Task Scheduler</strong>, откорректировать параметры задачи.</li>
</ul>
<h3 id="приложение">
  <a class="link-body-emphasis" href="#%d0%bf%d1%80%d0%b8%d0%bb%d0%be%d0%b6%d0%b5%d0%bd%d0%b8%d0%b5">Приложение</a>
</h3><p>Скрипт забирает список профилей пользователей из реестра и удаляет в них временные данные. Следующие переменные можно откорректировать под задачу:</p>
<ul>
<li><code>$SystemTemp</code> - системные директории с временными данными.</li>
<li><code>$ProfileTemp</code> - директории с временными данными в профилях пользователей.</li>
<li><code>$ProfileExclude</code> - исключить профили пользователей из сканирования.</li>
</ul>

    

    
        
            
            <div class="shortcode shortcode-file mb-3">
              <div class="card overflow-hidden" data-bs-theme="dark">
                <div class="card-header">
                  <div class="d-flex align-items-center">
                    <div class="flex-shrink-0">
                      <i class="far fa-file-code fa-fw"></i>
                    </div>
                    <div class="flex-grow-1 mx-2 text-truncate">
                      <code>app.temp.cleanup.ps1</code>
                    </div>
                    <div class="flex-shrink-0">
                      <ul class="list-inline mb-0">
                        <li class="list-inline-item" title='Копировать'>
                          <a class="text-body" href="#"
                             data-fn="clipboard" data-clipboard-target="#cp-9b4e3d26477d1c00b04a8298534863af"
                             role="button" aria-label='Копировать'>
                            <i class="fas fa-copy fa-fw"></i>
                          </a>
                        </li>
                        <li class="list-inline-item" title='Скачать'>
                          <a class="text-body" href="/ru/2024/09/aaef951a-9caf-5765-8189-c91f3f305821/app.temp.cleanup.ps1" download
                             role="button" aria-label='Скачать'>
                            <i class="fas fa-download fa-fw"></i>
                          </a>
                        </li>
                        <li class="list-inline-item" title='Открыть'>
                          <a class="text-body" href="/ru/2024/09/aaef951a-9caf-5765-8189-c91f3f305821/app.temp.cleanup.ps1" target="_blank"
                             role="button" aria-label='Открыть'>
                            <i class="fas fa-arrow-up-right-from-square fa-fw"></i>
                          </a>
                        </li>
                      </ul>
                    </div>
                  </div>
                </div>
                <div class="card-body p-0 overflow-auto" id="cp-9b4e3d26477d1c00b04a8298534863af">
                    
                        
                    
                    <div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">  1
</span><span class="lnt">  2
</span><span class="lnt">  3
</span><span class="lnt">  4
</span><span class="lnt">  5
</span><span class="lnt">  6
</span><span class="lnt">  7
</span><span class="lnt">  8
</span><span class="lnt">  9
</span><span class="lnt"> 10
</span><span class="lnt"> 11
</span><span class="lnt"> 12
</span><span class="lnt"> 13
</span><span class="lnt"> 14
</span><span class="lnt"> 15
</span><span class="lnt"> 16
</span><span class="lnt"> 17
</span><span class="lnt"> 18
</span><span class="lnt"> 19
</span><span class="lnt"> 20
</span><span class="lnt"> 21
</span><span class="lnt"> 22
</span><span class="lnt"> 23
</span><span class="lnt"> 24
</span><span class="lnt"> 25
</span><span class="lnt"> 26
</span><span class="lnt"> 27
</span><span class="lnt"> 28
</span><span class="lnt"> 29
</span><span class="lnt"> 30
</span><span class="lnt"> 31
</span><span class="lnt"> 32
</span><span class="lnt"> 33
</span><span class="lnt"> 34
</span><span class="lnt"> 35
</span><span class="lnt"> 36
</span><span class="lnt"> 37
</span><span class="lnt"> 38
</span><span class="lnt"> 39
</span><span class="lnt"> 40
</span><span class="lnt"> 41
</span><span class="lnt"> 42
</span><span class="lnt"> 43
</span><span class="lnt"> 44
</span><span class="lnt"> 45
</span><span class="lnt"> 46
</span><span class="lnt"> 47
</span><span class="lnt"> 48
</span><span class="lnt"> 49
</span><span class="lnt"> 50
</span><span class="lnt"> 51
</span><span class="lnt"> 52
</span><span class="lnt"> 53
</span><span class="lnt"> 54
</span><span class="lnt"> 55
</span><span class="lnt"> 56
</span><span class="lnt"> 57
</span><span class="lnt"> 58
</span><span class="lnt"> 59
</span><span class="lnt"> 60
</span><span class="lnt"> 61
</span><span class="lnt"> 62
</span><span class="lnt"> 63
</span><span class="lnt"> 64
</span><span class="lnt"> 65
</span><span class="lnt"> 66
</span><span class="lnt"> 67
</span><span class="lnt"> 68
</span><span class="lnt"> 69
</span><span class="lnt"> 70
</span><span class="lnt"> 71
</span><span class="lnt"> 72
</span><span class="lnt"> 73
</span><span class="lnt"> 74
</span><span class="lnt"> 75
</span><span class="lnt"> 76
</span><span class="lnt"> 77
</span><span class="lnt"> 78
</span><span class="lnt"> 79
</span><span class="lnt"> 80
</span><span class="lnt"> 81
</span><span class="lnt"> 82
</span><span class="lnt"> 83
</span><span class="lnt"> 84
</span><span class="lnt"> 85
</span><span class="lnt"> 86
</span><span class="lnt"> 87
</span><span class="lnt"> 88
</span><span class="lnt"> 89
</span><span class="lnt"> 90
</span><span class="lnt"> 91
</span><span class="lnt"> 92
</span><span class="lnt"> 93
</span><span class="lnt"> 94
</span><span class="lnt"> 95
</span><span class="lnt"> 96
</span><span class="lnt"> 97
</span><span class="lnt"> 98
</span><span class="lnt"> 99
</span><span class="lnt">100
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-ps1" data-lang="ps1"><span class="line"><span class="cl"><span class="cm">&lt;#PSScriptInfo
</span></span></span><span class="line"><span class="cl"><span class="cm">.VERSION      0.1.0
</span></span></span><span class="line"><span class="cl"><span class="cm">.GUID         f5e8380e-4e2f-4c58-972e-a60ace8dee8e
</span></span></span><span class="line"><span class="cl"><span class="cm">.AUTHOR       Kai Kimera
</span></span></span><span class="line"><span class="cl"><span class="cm">.AUTHOREMAIL  mail@kai.kim
</span></span></span><span class="line"><span class="cl"><span class="cm">.COMPANYNAME  Library Online
</span></span></span><span class="line"><span class="cl"><span class="cm">.COPYRIGHT    2024 Library Online. All rights reserved.
</span></span></span><span class="line"><span class="cl"><span class="cm">.TAGS         windows temp cleanup
</span></span></span><span class="line"><span class="cl"><span class="cm">.LICENSEURI   https://choosealicense.com/licenses/mit/
</span></span></span><span class="line"><span class="cl"><span class="cm">.PROJECTURI   https://lib.onl/ru/2024/09/aaef951a-9caf-5765-8189-c91f3f305821/
</span></span></span><span class="line"><span class="cl"><span class="cm">#&gt;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="cm">&lt;#
</span></span></span><span class="line"><span class="cl"><span class="cm">.</span><span class="sd">SYNOPSIS</span><span class="cm">
</span></span></span><span class="line"><span class="cl"><span class="cm">Script for deleting temporary data.
</span></span></span><span class="line"><span class="cl"><span class="cm">
</span></span></span><span class="line"><span class="cl"><span class="cm">.</span><span class="sd">DESCRIPTION</span><span class="cm">
</span></span></span><span class="line"><span class="cl"><span class="cm">The script deletes data in the specified directories.
</span></span></span><span class="line"><span class="cl"><span class="cm">
</span></span></span><span class="line"><span class="cl"><span class="cm">.</span><span class="sd">EXAMPLE</span><span class="cm">
</span></span></span><span class="line"><span class="cl"><span class="cm">.\app.temp.cleanup.ps1
</span></span></span><span class="line"><span class="cl"><span class="cm">
</span></span></span><span class="line"><span class="cl"><span class="cm">.</span><span class="sd">LINK</span><span class="cm">
</span></span></span><span class="line"><span class="cl"><span class="cm">https://lib.onl/ru/2024/09/aaef951a-9caf-5765-8189-c91f3f305821/
</span></span></span><span class="line"><span class="cl"><span class="cm">#&gt;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c"># -------------------------------------------------------------------------------------------------------------------- #</span>
</span></span><span class="line"><span class="cl"><span class="c"># CONFIGURATION</span>
</span></span><span class="line"><span class="cl"><span class="c"># -------------------------------------------------------------------------------------------------------------------- #</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nv">$SystemTemp</span> <span class="p">=</span> <span class="vm">@</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">  <span class="s2">&#34;C:\Windows\Temp\*&#34;</span>
</span></span><span class="line"><span class="cl"><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nv">$ProfileTemp</span> <span class="p">=</span> <span class="vm">@</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">  <span class="s2">&#34;AppData\Local\Temp\*&#34;</span>
</span></span><span class="line"><span class="cl">  <span class="s2">&#34;AppData\Local\Mozilla\Firefox\Profiles\*.default-release\cache2\entries\*&#34;</span>
</span></span><span class="line"><span class="cl">  <span class="s2">&#34;AppData\Local\Microsoft\Windows\Explorer\*&#34;</span>
</span></span><span class="line"><span class="cl">  <span class="s2">&#34;AppData\Roaming\Mozilla\Firefox\Profiles\*.default-release\storage\default\*&#34;</span>
</span></span><span class="line"><span class="cl">  <span class="s2">&#34;AppData\Local\Google\Chrome\User Data\Default\Service Worker\CacheStorage\*&#34;</span>
</span></span><span class="line"><span class="cl">  <span class="s2">&#34;AppData\Local\Google\Chrome\User Data\Default\Cache\Cache_Data\*&#34;</span>
</span></span><span class="line"><span class="cl">  <span class="s2">&#34;AppData\Local\Google\Chrome\User Data\Default\Code Cache\js\*&#34;</span>
</span></span><span class="line"><span class="cl">  <span class="s2">&#34;AppData\LocalLow\Adobe\Acrobat\DC\ConnectorIcons\*&#34;</span>
</span></span><span class="line"><span class="cl">  <span class="s2">&#34;AppData\Local\Microsoft\Windows\INetCache\Content.Outlook\*&#34;</span>
</span></span><span class="line"><span class="cl"><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nv">$ProfileExclude</span> <span class="p">=</span> <span class="vm">@</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">  <span class="s1">&#39;Администратор&#39;</span>
</span></span><span class="line"><span class="cl">  <span class="s1">&#39;Administrator&#39;</span>
</span></span><span class="line"><span class="cl">  <span class="s1">&#39;Setup&#39;</span>
</span></span><span class="line"><span class="cl">  <span class="s1">&#39;Public&#39;</span>
</span></span><span class="line"><span class="cl">  <span class="s1">&#39;All Users&#39;</span>
</span></span><span class="line"><span class="cl">  <span class="s1">&#39;Default User&#39;</span>
</span></span><span class="line"><span class="cl"><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nv">$ProfileList</span> <span class="p">=</span> <span class="s1">&#39;HKLM:\SOFTWARE\Microsoft\Windows NT\CurrentVersion\ProfileList&#39;</span>
</span></span><span class="line"><span class="cl"><span class="nv">$Profiles</span> <span class="p">=</span> <span class="nb">Get-ChildItem</span> <span class="p">(</span><span class="nb">Get-ItemProperty</span> <span class="n">-Path</span> <span class="s2">&#34;</span><span class="nv">${ProfileList}</span><span class="s2">&#34;</span><span class="p">).</span><span class="py">ProfilesDirectory</span> <span class="n">-Exclude</span> <span class="nv">$ProfileExclude</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c"># -------------------------------------------------------------------------------------------------------------------- #</span>
</span></span><span class="line"><span class="cl"><span class="c"># INITIALIZATION</span>
</span></span><span class="line"><span class="cl"><span class="c"># -------------------------------------------------------------------------------------------------------------------- #</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kd">function</span><span class="w"> </span><span class="nb">Start-Script</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="nb">Start-CleanUp</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c"># -------------------------------------------------------------------------------------------------------------------- #</span>
</span></span><span class="line"><span class="cl"><span class="c"># CLEANUP</span>
</span></span><span class="line"><span class="cl"><span class="c"># -------------------------------------------------------------------------------------------------------------------- #</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kd">function</span><span class="w"> </span><span class="nb">Start-CleanUp</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="k">ForEach</span> <span class="p">(</span><span class="nv">$Path</span> <span class="k">in</span> <span class="nv">$SystemTemp</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nb">Remove-Data</span> <span class="n">-Path</span> <span class="s2">&#34;</span><span class="nv">${Path}</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="k">ForEach</span> <span class="p">(</span><span class="nv">$Profile</span> <span class="k">in</span> <span class="nv">$Profiles</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">ForEach</span> <span class="p">(</span><span class="nv">$Path</span> <span class="k">in</span> <span class="nv">$ProfileTemp</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="nv">$Path</span> <span class="p">=</span> <span class="p">(</span><span class="nb">Join-Path</span> <span class="n">-Path</span> <span class="s2">&#34;</span><span class="nv">${Profile}</span><span class="s2">&#34;</span> <span class="n">-ChildPath</span> <span class="s2">&#34;</span><span class="nv">${Path}</span><span class="s2">&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">      <span class="k">if</span> <span class="p">(</span><span class="nb">Test-Path</span> <span class="n">-Path</span> <span class="s2">&#34;</span><span class="nv">${Path}</span><span class="s2">&#34;</span><span class="p">)</span> <span class="p">{</span> <span class="nb">Remove-Data</span> <span class="n">-Path</span> <span class="s2">&#34;</span><span class="nv">${Path}</span><span class="s2">&#34;</span> <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c"># -------------------------------------------------------------------------------------------------------------------- #</span>
</span></span><span class="line"><span class="cl"><span class="c"># ------------------------------------------------&lt; COMMON FUNCTIONS &gt;------------------------------------------------ #</span>
</span></span><span class="line"><span class="cl"><span class="c"># -------------------------------------------------------------------------------------------------------------------- #</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kd">function</span><span class="w"> </span><span class="nb">Remove-Data</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="k">param</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">    <span class="p">[</span><span class="no">string</span><span class="p">]</span><span class="nv">$Path</span>
</span></span><span class="line"><span class="cl">  <span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="nb">Remove-Item</span> <span class="n">-Path</span> <span class="s2">&#34;</span><span class="nv">${Path}</span><span class="s2">&#34;</span> <span class="n">-Recurse</span> <span class="n">-Force</span> <span class="n">-ErrorAction</span> <span class="s1">&#39;SilentlyContinue&#39;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c"># -------------------------------------------------------------------------------------------------------------------- #</span>
</span></span><span class="line"><span class="cl"><span class="c"># -------------------------------------------------&lt; RUNNING SCRIPT &gt;------------------------------------------------- #</span>
</span></span><span class="line"><span class="cl"><span class="c"># -------------------------------------------------------------------------------------------------------------------- #</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nb">Start-Script</span></span></span></code></pre></td></tr></table>
</div>
</div>
                </div>
              </div>
            </div>
        
    
<h3 id="задача">
  <a class="link-body-emphasis" href="#%d0%b7%d0%b0%d0%b4%d0%b0%d1%87%d0%b0">Задача</a>
</h3><p>Для того, чтобы скрипт выполнялся автоматически по расписанию, я сделал XML-файл задачи. Его необходимо импортировать в планировщик задач Windows и откорректировать под свои требования:</p>

    

    
        
            
            <div class="shortcode shortcode-file mb-3">
              <div class="card overflow-hidden" data-bs-theme="dark">
                <div class="card-header">
                  <div class="d-flex align-items-center">
                    <div class="flex-shrink-0">
                      <i class="far fa-file-code fa-fw"></i>
                    </div>
                    <div class="flex-grow-1 mx-2 text-truncate">
                      <code>task.temp.cleanup.xml</code>
                    </div>
                    <div class="flex-shrink-0">
                      <ul class="list-inline mb-0">
                        <li class="list-inline-item" title='Копировать'>
                          <a class="text-body" href="#"
                             data-fn="clipboard" data-clipboard-target="#cp-67559f334ded45a2d30262c74c9791c6"
                             role="button" aria-label='Копировать'>
                            <i class="fas fa-copy fa-fw"></i>
                          </a>
                        </li>
                        <li class="list-inline-item" title='Скачать'>
                          <a class="text-body" href="/ru/2024/09/aaef951a-9caf-5765-8189-c91f3f305821/task.temp.cleanup.xml" download
                             role="button" aria-label='Скачать'>
                            <i class="fas fa-download fa-fw"></i>
                          </a>
                        </li>
                        <li class="list-inline-item" title='Открыть'>
                          <a class="text-body" href="/ru/2024/09/aaef951a-9caf-5765-8189-c91f3f305821/task.temp.cleanup.xml" target="_blank"
                             role="button" aria-label='Открыть'>
                            <i class="fas fa-arrow-up-right-from-square fa-fw"></i>
                          </a>
                        </li>
                      </ul>
                    </div>
                  </div>
                </div>
                <div class="card-body p-0 overflow-auto" id="cp-67559f334ded45a2d30262c74c9791c6">
                    
                        
                    
                    <div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-xml" data-lang="xml"><span class="line"><span class="cl"><span class="cp">&lt;?xml version=&#34;1.0&#34; encoding=&#34;UTF-16&#34;?&gt;</span>
</span></span><span class="line"><span class="cl"><span class="nt">&lt;Task</span> <span class="na">version=</span><span class="s">&#34;1.2&#34;</span> <span class="na">xmlns=</span><span class="s">&#34;http://schemas.microsoft.com/windows/2004/02/mit/task&#34;</span><span class="nt">&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="nt">&lt;RegistrationInfo&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;Description&gt;</span>Script for deleting temporary data.<span class="nt">&lt;/Description&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="nt">&lt;/RegistrationInfo&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="nt">&lt;Triggers&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;CalendarTrigger&gt;</span>
</span></span><span class="line"><span class="cl">      <span class="nt">&lt;StartBoundary&gt;</span>2024-09-09T00:15:00<span class="nt">&lt;/StartBoundary&gt;</span>
</span></span><span class="line"><span class="cl">      <span class="nt">&lt;Enabled&gt;</span>true<span class="nt">&lt;/Enabled&gt;</span>
</span></span><span class="line"><span class="cl">      <span class="nt">&lt;ScheduleByWeek&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&lt;DaysOfWeek&gt;</span>
</span></span><span class="line"><span class="cl">          <span class="nt">&lt;Sunday</span> <span class="nt">/&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&lt;/DaysOfWeek&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&lt;WeeksInterval&gt;</span>1<span class="nt">&lt;/WeeksInterval&gt;</span>
</span></span><span class="line"><span class="cl">      <span class="nt">&lt;/ScheduleByWeek&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;/CalendarTrigger&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="nt">&lt;/Triggers&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="nt">&lt;Settings&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;MultipleInstancesPolicy&gt;</span>IgnoreNew<span class="nt">&lt;/MultipleInstancesPolicy&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;DisallowStartIfOnBatteries&gt;</span>true<span class="nt">&lt;/DisallowStartIfOnBatteries&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;StopIfGoingOnBatteries&gt;</span>true<span class="nt">&lt;/StopIfGoingOnBatteries&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;AllowHardTerminate&gt;</span>true<span class="nt">&lt;/AllowHardTerminate&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;StartWhenAvailable&gt;</span>false<span class="nt">&lt;/StartWhenAvailable&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;RunOnlyIfNetworkAvailable&gt;</span>false<span class="nt">&lt;/RunOnlyIfNetworkAvailable&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;IdleSettings&gt;</span>
</span></span><span class="line"><span class="cl">      <span class="nt">&lt;StopOnIdleEnd&gt;</span>true<span class="nt">&lt;/StopOnIdleEnd&gt;</span>
</span></span><span class="line"><span class="cl">      <span class="nt">&lt;RestartOnIdle&gt;</span>false<span class="nt">&lt;/RestartOnIdle&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;/IdleSettings&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;AllowStartOnDemand&gt;</span>true<span class="nt">&lt;/AllowStartOnDemand&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;Enabled&gt;</span>true<span class="nt">&lt;/Enabled&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;Hidden&gt;</span>false<span class="nt">&lt;/Hidden&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;RunOnlyIfIdle&gt;</span>false<span class="nt">&lt;/RunOnlyIfIdle&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;WakeToRun&gt;</span>false<span class="nt">&lt;/WakeToRun&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="nt">&lt;/Settings&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="nt">&lt;Actions</span> <span class="na">Context=</span><span class="s">&#34;Author&#34;</span><span class="nt">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;Exec&gt;</span>
</span></span><span class="line"><span class="cl">      <span class="nt">&lt;Command&gt;</span>powershell<span class="nt">&lt;/Command&gt;</span>
</span></span><span class="line"><span class="cl">      <span class="nt">&lt;Arguments&gt;</span>&#34;C:\Scripts\app.temp.cleanup.ps1&#34;<span class="nt">&lt;/Arguments&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;/Exec&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="nt">&lt;/Actions&gt;</span>
</span></span><span class="line"><span class="cl"><span class="nt">&lt;/Task&gt;</span></span></span></code></pre></td></tr></table>
</div>
</div>
                </div>
              </div>
            </div>]]></turbo:content></item><item turbo="true"><title>Как обновить SSL-сертификат Proxmox?</title><link>https://lib.onl/ru/2024/09/ffca78db-eb62-5e14-91c1-1142a8a3b8a6/</link><pubDate>Sat, 14 Sep 2024 22:22:06 +0000</pubDate><dc:creator>Kai Kimera</dc:creator><category>Proxmox</category><category>Ssl</category><yandex:related><link url="https://lib.onl/ru/2024/05/ffbb2491-6784-510a-a067-2f08cc76c221/">Как изменить IP-адрес в Proxmox VE?</link></yandex:related><turbo:extendedHtml>true</turbo:extendedHtml><turbo:source>https://lib.onl/ru/2024/09/ffca78db-eb62-5e14-91c1-1142a8a3b8a6/</turbo:source><turbo:topic>Как обновить SSL-сертификат Proxmox?</turbo:topic><turbo:content>&lt;p>Поменялся IP-адрес сервера Proxmox. Старый IP остался в само-заверенном SSL-сертификате. Как обновить сертификат?&lt;/p></turbo:content></item><item turbo="true"><title>Как отключить новый интерфейс Acrobat Reader для всех пользователей?</title><link>https://lib.onl/ru/2024/06/39aad3f7-08a5-5b25-a860-be8a8673979c/</link><pubDate>Fri, 07 Jun 2024 15:36:34 +0000</pubDate><dc:creator>Kai Kimera</dc:creator><category>Adobe</category><category>Acrobat</category><category>Reader</category><category>Pdf</category><category>Ui</category><turbo:extendedHtml>true</turbo:extendedHtml><turbo:source>https://lib.onl/ru/2024/06/39aad3f7-08a5-5b25-a860-be8a8673979c/</turbo:source><turbo:topic>Как отключить новый интерфейс Acrobat Reader для всех пользователей?</turbo:topic><turbo:content>&lt;p>Пользователи терминального сервера жалуются на подвисания нового интерфейса Acrobat Reader. Как можно его отключить для всех пользователей?&lt;/p></turbo:content></item><item turbo="true"><title>Создание расширяемого хранилища LVM</title><link>https://lib.onl/ru/2024/06/2b75198c-776c-5ed9-9037-976c6d3021f9/</link><pubDate>Mon, 03 Jun 2024 15:24:00 +0000</pubDate><dc:creator>Kai Kimera</dc:creator><category>Linux</category><category>Терминал</category><turbo:extendedHtml>true</turbo:extendedHtml><turbo:source>https://lib.onl/ru/2024/06/2b75198c-776c-5ed9-9037-976c6d3021f9/</turbo:source><turbo:topic>Создание расширяемого хранилища LVM</turbo:topic><turbo:content><![CDATA[<p>Рассматриваем работу с LVM, управлением логическими томами. Вкратце описываю процессы и привожу полноценные команды для создания, изменения и удаления LVM.</p>




    








    
    






<div class="shortcode shortcode-alert">
  <div class="alert alert-warning d-flex overflow-hidden" role="alert">
    <div class="flex-shrink-0 align-self-center">
      <i class="fas fa-exclamation-triangle fa-fw fa-2x"></i>
    </div>
    <div class="flex-grow-1 ms-3 overflow-hidden">
        <p>Все команды в статье предполагают предварительные настройки по каждому отдельному хосту. Будьте аккуратными!</p>

    </div>
  </div>
</div>

<h2 id="экспорт-параметров">
  <a class="link-body-emphasis" href="#%d1%8d%d0%ba%d1%81%d0%bf%d0%be%d1%80%d1%82-%d0%bf%d0%b0%d1%80%d0%b0%d0%bc%d0%b5%d1%82%d1%80%d0%be%d0%b2">Экспорт параметров</a>
</h2><p>Для начала экспортируем заранее подготовленные параметры в переменные окружения:</p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-0
shortcode-codeblock-bash">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-3b326d97df512ab7310aec228863f868" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="nb">export</span> <span class="nv">PV</span><span class="o">=</span><span class="s1">&#39;/dev/sdb&#39;</span><span class="p">;</span> <span class="nb">export</span> <span class="nv">VG</span><span class="o">=</span><span class="s1">&#39;data&#39;</span><span class="p">;</span> <span class="nb">export</span> <span class="nv">LV</span><span class="o">=</span><span class="s1">&#39;storage&#39;</span><span class="p">;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-3b326d97df512ab7310aec228863f868"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<p>Где:</p>
<ul>
<li><code>PV='/dev/sdb'</code> - диск, который будет использоваться в качестве физического тома для LVM.</li>
<li><code>VG='data'</code> - имя группы томов (VG).</li>
<li><code>LV='storage'</code> - имя логического тома (LV).</li>
</ul>
<h2 id="создание-lvm">
  <a class="link-body-emphasis" href="#%d1%81%d0%be%d0%b7%d0%b4%d0%b0%d0%bd%d0%b8%d0%b5-lvm">Создание LVM</a>
</h2><p>Чтобы создать LVM, необходимо:</p>
<ol>
<li>Создать физический том <strong>PV</strong> на диске.</li>
<li>Создать группу логических томов <strong>VG</strong>.</li>
<li>Создать логические тома <strong>LV</strong>.</li>
</ol>
<p>Команда для создания LVM с одним логическим томом <code>storage</code> 100% размера:</p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-1
shortcode-codeblock-bash">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-f328c69d5c75fa96655e2108d9fbf607" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">pvcreate <span class="s2">&#34;</span><span class="si">${</span><span class="nv">PV</span><span class="si">}</span><span class="s2">&#34;</span> <span class="o">&amp;&amp;</span> vgcreate <span class="s2">&#34;</span><span class="si">${</span><span class="nv">VG</span><span class="si">}</span><span class="s2">&#34;</span> <span class="s2">&#34;</span><span class="si">${</span><span class="nv">PV</span><span class="si">}</span><span class="s2">&#34;</span> <span class="o">&amp;&amp;</span> lvcreate -l 100%FREE -n <span class="s2">&#34;</span><span class="si">${</span><span class="nv">LV</span><span class="si">}</span><span class="s2">&#34;</span> <span class="s2">&#34;</span><span class="si">${</span><span class="nv">VG</span><span class="si">}</span><span class="s2">&#34;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-f328c69d5c75fa96655e2108d9fbf607"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<h3 id="форматирование-lv">
  <a class="link-body-emphasis" href="#%d1%84%d0%be%d1%80%d0%bc%d0%b0%d1%82%d0%b8%d1%80%d0%be%d0%b2%d0%b0%d0%bd%d0%b8%d0%b5-lv">Форматирование LV</a>
</h3><p>Форматирование логического тома <strong>LV</strong> в файловую систему <strong>EXT4</strong>:</p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-2
shortcode-codeblock-bash">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-4ab4a3bd864d1cae51e38999f8c81370" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">mkfs.ext4 <span class="s2">&#34;/dev/</span><span class="si">${</span><span class="nv">VG</span><span class="si">}</span><span class="s2">/</span><span class="si">${</span><span class="nv">LV</span><span class="si">}</span><span class="s2">&#34;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-4ab4a3bd864d1cae51e38999f8c81370"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<p>Форматирование логического тома <strong>LV</strong> в файловую систему <strong>XFS</strong>:</p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-3
shortcode-codeblock-bash">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-d48fea8eb74affba1683b6e891ad89d1" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">mkfs.xfs <span class="s2">&#34;/dev/</span><span class="si">${</span><span class="nv">VG</span><span class="si">}</span><span class="s2">/</span><span class="si">${</span><span class="nv">LV</span><span class="si">}</span><span class="s2">&#34;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-d48fea8eb74affba1683b6e891ad89d1"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<h3 id="монтирование-lv">
  <a class="link-body-emphasis" href="#%d0%bc%d0%be%d0%bd%d1%82%d0%b8%d1%80%d0%be%d0%b2%d0%b0%d0%bd%d0%b8%d0%b5-lv">Монтирование LV</a>
</h3><p>Создание точки монтирования и монтирование логического тома <strong>LV</strong> в директорию <code>/home/storage</code> с файловой системой <strong>EXT4</strong>:</p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-4
shortcode-codeblock-bash">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-081e83c59918af298495d7e9a689610d" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">mkdir <span class="s1">&#39;/home/storage&#39;</span> <span class="o">&amp;&amp;</span> <span class="nb">echo</span> <span class="s2">&#34;/dev/</span><span class="si">${</span><span class="nv">VG</span><span class="si">}</span><span class="s2">/</span><span class="si">${</span><span class="nv">LV</span><span class="si">}</span><span class="s2"> /home/storage ext4 defaults 0 0&#34;</span> &gt;&gt; <span class="s1">&#39;/etc/fstab&#39;</span> <span class="o">&amp;&amp;</span> mount <span class="s2">&#34;/dev/</span><span class="si">${</span><span class="nv">VG</span><span class="si">}</span><span class="s2">/</span><span class="si">${</span><span class="nv">LV</span><span class="si">}</span><span class="s2">&#34;</span> <span class="s1">&#39;/home/storage&#39;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-081e83c59918af298495d7e9a689610d"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<p>Создание точки монтирования и монтирование логического тома <strong>LV</strong> в директорию <code>/home/storage</code> с файловой системой <strong>XFS</strong>:</p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-5
shortcode-codeblock-bash">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-8610ea1c9f13ae81f82004db2616bf13" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">mkdir <span class="s1">&#39;/home/storage&#39;</span> <span class="o">&amp;&amp;</span> <span class="nb">echo</span> <span class="s2">&#34;/dev/</span><span class="si">${</span><span class="nv">VG</span><span class="si">}</span><span class="s2">/</span><span class="si">${</span><span class="nv">LV</span><span class="si">}</span><span class="s2"> /home/storage xfs defaults 0 0&#34;</span> &gt;&gt; <span class="s1">&#39;/etc/fstab&#39;</span> <span class="o">&amp;&amp;</span> mount <span class="s2">&#34;/dev/</span><span class="si">${</span><span class="nv">VG</span><span class="si">}</span><span class="s2">/</span><span class="si">${</span><span class="nv">LV</span><span class="si">}</span><span class="s2">&#34;</span> <span class="s1">&#39;/home/storage&#39;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-8610ea1c9f13ae81f82004db2616bf13"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<h2 id="расширение-lvm">
  <a class="link-body-emphasis" href="#%d1%80%d0%b0%d1%81%d1%88%d0%b8%d1%80%d0%b5%d0%bd%d0%b8%d0%b5-lvm">Расширение LVM</a>
</h2><p>Для того, чтобы расширить логический том <strong>LV</strong>, необходимо:</p>
<ol>
<li>Указать системе провести повторное сканирование указанного устройства на предмет изменённых параметров (в данном случае, размер диска).</li>
<li>Расширить физический том <strong>PV</strong>.</li>
<li>Расширить логические тома <strong>LV</strong>.</li>
<li>Расширить файловую систему.</li>
</ol>
<p>Команда в одну строку для расширения логического тома <strong>LV</strong>:</p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-6
shortcode-codeblock-bash">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-f1f42ecc8bfe7db293b6e0df8cc34938" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="nb">echo</span> <span class="m">1</span> &gt; <span class="s2">&#34;/sys/block/</span><span class="si">${</span><span class="nv">PV</span><span class="p">##*/</span><span class="si">}</span><span class="s2">/device/rescan&#34;</span> <span class="o">&amp;&amp;</span> pvresize <span class="s2">&#34;</span><span class="si">${</span><span class="nv">PV</span><span class="si">}</span><span class="s2">&#34;</span> <span class="o">&amp;&amp;</span> lvextend -l +100%FREE <span class="s2">&#34;/dev/</span><span class="si">${</span><span class="nv">VG</span><span class="si">}</span><span class="s2">/</span><span class="si">${</span><span class="nv">LV</span><span class="si">}</span><span class="s2">&#34;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-f1f42ecc8bfe7db293b6e0df8cc34938"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<h3 id="расширение-фс">
  <a class="link-body-emphasis" href="#%d1%80%d0%b0%d1%81%d1%88%d0%b8%d1%80%d0%b5%d0%bd%d0%b8%d0%b5-%d1%84%d1%81">Расширение ФС</a>
</h3><p>Расширить файловую систему <strong>EXT4</strong>:</p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-7
shortcode-codeblock-bash">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-31aab2c846b4a56c58368843f77cda4e" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">resize2fs <span class="s2">&#34;/dev/</span><span class="si">${</span><span class="nv">VG</span><span class="si">}</span><span class="s2">/</span><span class="si">${</span><span class="nv">LV</span><span class="si">}</span><span class="s2">&#34;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-31aab2c846b4a56c58368843f77cda4e"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<p>Расширить файловую систему <strong>XFS</strong>:</p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-8
shortcode-codeblock-bash">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-43daeda4391d91f3eff0bbd9e563b312" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">xfs_growfs -d <span class="s2">&#34;/dev/</span><span class="si">${</span><span class="nv">VG</span><span class="si">}</span><span class="s2">/</span><span class="si">${</span><span class="nv">LV</span><span class="si">}</span><span class="s2">&#34;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-43daeda4391d91f3eff0bbd9e563b312"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<h2 id="удаление-lvm">
  <a class="link-body-emphasis" href="#%d1%83%d0%b4%d0%b0%d0%bb%d0%b5%d0%bd%d0%b8%d0%b5-lvm">Удаление LVM</a>
</h2><p>Для удаления LVM, необходимо:</p>
<ol>
<li>Удалить логические тома <strong>LV</strong>.</li>
<li>Удалить группу томов <strong>VG</strong>.</li>
<li>Удалить физический том <strong>PV</strong>.</li>
</ol>
<p>Для удаления LVM, нужно выполнить команду:</p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-9
shortcode-codeblock-bash">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-98feeb14629b7f2249e83a0c0e96af43" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">lvremove <span class="s2">&#34;/dev/</span><span class="si">${</span><span class="nv">VG</span><span class="si">}</span><span class="s2">/</span><span class="si">${</span><span class="nv">LV</span><span class="si">}</span><span class="s2">&#34;</span> <span class="o">&amp;&amp;</span> vgremove <span class="s2">&#34;</span><span class="si">${</span><span class="nv">VG</span><span class="si">}</span><span class="s2">&#34;</span> <span class="o">&amp;&amp;</span> pvremove <span class="s2">&#34;</span><span class="si">${</span><span class="nv">PV</span><span class="si">}</span><span class="s2">&#34;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-98feeb14629b7f2249e83a0c0e96af43"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<h2 id="информация-по-lvm">
  <a class="link-body-emphasis" href="#%d0%b8%d0%bd%d1%84%d0%be%d1%80%d0%bc%d0%b0%d1%86%d0%b8%d1%8f-%d0%bf%d0%be-lvm">Информация по LVM</a>
</h2><p>Отображение информации о физическом томе <strong>PV</strong>:</p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-10
shortcode-codeblock-bash">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-721f4303d8ad416280bf780b76926318" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">pvdisplay</span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-721f4303d8ad416280bf780b76926318"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<p>Отображение информации о группе логических томов <strong>VG</strong>:</p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-11
shortcode-codeblock-bash">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-af59390b9fcc7ef4c9360b97633cd841" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">vgdisplay</span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-af59390b9fcc7ef4c9360b97633cd841"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<p>Отображение информации о логических томах <strong>LV</strong>:</p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-12
shortcode-codeblock-bash">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-f8c3c4363a07a485176f2857f3c5818f" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">lvdisplay</span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-f8c3c4363a07a485176f2857f3c5818f"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>]]></turbo:content></item><item turbo="true"><title>Linux: Пользователи и группы</title><link>https://lib.onl/ru/2024/06/b29b331d-ac93-5193-83ef-beab5a0f8dff/</link><pubDate>Mon, 03 Jun 2024 10:59:22 +0000</pubDate><dc:creator>Kai Kimera</dc:creator><category>Linux</category><category>Терминал</category><yandex:related><link url="https://lib.onl/ru/2024/06/eea13ebc-7ca9-5721-b017-d911a8f6354d/">FreeBSD: Пользователи и группы</link><link url="https://lib.onl/ru/2024/03/6c7a038f-f41e-5a45-a285-b99fdacf82d4/">Работа с ZFS</link></yandex:related><turbo:extendedHtml>true</turbo:extendedHtml><turbo:source>https://lib.onl/ru/2024/06/b29b331d-ac93-5193-83ef-beab5a0f8dff/</turbo:source><turbo:topic>Linux: Пользователи и группы</turbo:topic><turbo:content><![CDATA[<p>Набор команд для работы с группами и пользователями в <span class="shortcode shortcode-tag"><a href="/ru/tags/linux/" target="_blank">#Linux</a></span>.</p>
<p>В отличие от <span class="shortcode shortcode-tag"><a href="/ru/tags/freebsd/" target="_blank">#FreeBSD</a></span>, в <span class="shortcode shortcode-tag"><a href="/ru/tags/linux/" target="_blank">#Linux</a></span> можно пользоваться стандартными инструментами <code>useradd</code>, <code>usermod</code> и <code>userdel</code>.</p>
<h2 id="создать-пользователя">
  <a class="link-body-emphasis" href="#%d1%81%d0%be%d0%b7%d0%b4%d0%b0%d1%82%d1%8c-%d0%bf%d0%be%d0%bb%d1%8c%d0%b7%d0%be%d0%b2%d0%b0%d1%82%d0%b5%d0%bb%d1%8f">Создать пользователя</a>
</h2><ul>
<li>Создать пользователя <code>username</code>, добавить его в группу <code>sudo</code>, указать комментарий <code>User username</code> и задать пароль:</li>
</ul>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-0
shortcode-codeblock-bash">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-72bbcc1408fc3ae218bf028db1cd1755" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="nv">u</span><span class="o">=</span><span class="s1">&#39;username&#39;</span><span class="p">;</span> useradd -m -G sudo -c <span class="s2">&#34;User </span><span class="si">${</span><span class="nv">u</span><span class="si">}</span><span class="s2">&#34;</span> <span class="s2">&#34;</span><span class="si">${</span><span class="nv">u</span><span class="si">}</span><span class="s2">&#34;</span> <span class="o">&amp;&amp;</span> passwd <span class="s2">&#34;</span><span class="si">${</span><span class="nv">u</span><span class="si">}</span><span class="s2">&#34;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-72bbcc1408fc3ae218bf028db1cd1755"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<h2 id="переименовать-пользователя">
  <a class="link-body-emphasis" href="#%d0%bf%d0%b5%d1%80%d0%b5%d0%b8%d0%bc%d0%b5%d0%bd%d0%be%d0%b2%d0%b0%d1%82%d1%8c-%d0%bf%d0%be%d0%bb%d1%8c%d0%b7%d0%be%d0%b2%d0%b0%d1%82%d0%b5%d0%bb%d1%8f">Переименовать пользователя</a>
</h2><ul>
<li>Переименовать домашнюю директорию пользователя, переименовать пользователя и его группу:</li>
</ul>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-1
shortcode-codeblock-bash">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-8369d266dc3cd2db02f9a8ae30dd6139" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="nv">u_old</span><span class="o">=</span><span class="s1">&#39;username_old&#39;</span><span class="p">;</span> <span class="nv">u_new</span><span class="o">=</span><span class="s1">&#39;username_new&#39;</span><span class="p">;</span> usermod -l <span class="s2">&#34;</span><span class="si">${</span><span class="nv">u_new</span><span class="si">}</span><span class="s2">&#34;</span> -d <span class="s2">&#34;/home/</span><span class="si">${</span><span class="nv">u_new</span><span class="si">}</span><span class="s2">&#34;</span> -m <span class="s2">&#34;</span><span class="si">${</span><span class="nv">u_old</span><span class="si">}</span><span class="s2">&#34;</span> <span class="o">&amp;&amp;</span> groupmod -n <span class="s2">&#34;</span><span class="si">${</span><span class="nv">u_new</span><span class="si">}</span><span class="s2">&#34;</span> <span class="s2">&#34;</span><span class="si">${</span><span class="nv">u_old</span><span class="si">}</span><span class="s2">&#34;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-8369d266dc3cd2db02f9a8ae30dd6139"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<h2 id="удалить-пользователя">
  <a class="link-body-emphasis" href="#%d1%83%d0%b4%d0%b0%d0%bb%d0%b8%d1%82%d1%8c-%d0%bf%d0%be%d0%bb%d1%8c%d0%b7%d0%be%d0%b2%d0%b0%d1%82%d0%b5%d0%bb%d1%8f">Удалить пользователя</a>
</h2><ul>
<li>Удалить пользователя <code>username</code> и его домашнюю директорию (<code>-r</code>):</li>
</ul>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-2
shortcode-codeblock-bash">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-2061872f693239463b0fab517206a989" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="nv">u</span><span class="o">=</span><span class="s1">&#39;username&#39;</span><span class="p">;</span> userdel -r <span class="s2">&#34;</span><span class="si">${</span><span class="nv">u</span><span class="si">}</span><span class="s2">&#34;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-2061872f693239463b0fab517206a989"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<h2 id="заблокировать-пользователя">
  <a class="link-body-emphasis" href="#%d0%b7%d0%b0%d0%b1%d0%bb%d0%be%d0%ba%d0%b8%d1%80%d0%be%d0%b2%d0%b0%d1%82%d1%8c-%d0%bf%d0%be%d0%bb%d1%8c%d0%b7%d0%be%d0%b2%d0%b0%d1%82%d0%b5%d0%bb%d1%8f">Заблокировать пользователя</a>
</h2><ul>
<li>Заблокировать пользователя <code>username</code>:</li>
</ul>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-3
shortcode-codeblock-bash">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-9afad69ffabfcda1be276bba9ef9f915" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="nv">u</span><span class="o">=</span><span class="s1">&#39;username&#39;</span><span class="p">;</span> usermod -L <span class="s2">&#34;</span><span class="si">${</span><span class="nv">u</span><span class="si">}</span><span class="s2">&#34;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-9afad69ffabfcda1be276bba9ef9f915"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<h2 id="разблокировать-пользователя">
  <a class="link-body-emphasis" href="#%d1%80%d0%b0%d0%b7%d0%b1%d0%bb%d0%be%d0%ba%d0%b8%d1%80%d0%be%d0%b2%d0%b0%d1%82%d1%8c-%d0%bf%d0%be%d0%bb%d1%8c%d0%b7%d0%be%d0%b2%d0%b0%d1%82%d0%b5%d0%bb%d1%8f">Разблокировать пользователя</a>
</h2><ul>
<li>Разблокировать пользователя <code>username</code>:</li>
</ul>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-4
shortcode-codeblock-bash">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-6e6f960e069abb2cde6716531cda7f25" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="nv">u</span><span class="o">=</span><span class="s1">&#39;username&#39;</span><span class="p">;</span> usermod -U <span class="s2">&#34;</span><span class="si">${</span><span class="nv">u</span><span class="si">}</span><span class="s2">&#34;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-6e6f960e069abb2cde6716531cda7f25"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<h2 id="добавить-пользователя-в-дополнительную-группу">
  <a class="link-body-emphasis" href="#%d0%b4%d0%be%d0%b1%d0%b0%d0%b2%d0%b8%d1%82%d1%8c-%d0%bf%d0%be%d0%bb%d1%8c%d0%b7%d0%be%d0%b2%d0%b0%d1%82%d0%b5%d0%bb%d1%8f-%d0%b2-%d0%b4%d0%be%d0%bf%d0%be%d0%bb%d0%bd%d0%b8%d1%82%d0%b5%d0%bb%d1%8c%d0%bd%d1%83%d1%8e-%d0%b3%d1%80%d1%83%d0%bf%d0%bf%d1%83">Добавить пользователя в дополнительную группу</a>
</h2><ul>
<li>Добавить пользователя <code>username</code> в группу <code>www</code>:</li>
</ul>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-5
shortcode-codeblock-bash">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-4fb0e1ff95e6d3b22d05f3f0ea7a71bc" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="nv">u</span><span class="o">=</span><span class="s1">&#39;username&#39;</span><span class="p">;</span> usermod -aG www <span class="s2">&#34;</span><span class="si">${</span><span class="nv">u</span><span class="si">}</span><span class="s2">&#34;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-4fb0e1ff95e6d3b22d05f3f0ea7a71bc"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<h2 id="удалить-пользователя-из-дополнительной-группы">
  <a class="link-body-emphasis" href="#%d1%83%d0%b4%d0%b0%d0%bb%d0%b8%d1%82%d1%8c-%d0%bf%d0%be%d0%bb%d1%8c%d0%b7%d0%be%d0%b2%d0%b0%d1%82%d0%b5%d0%bb%d1%8f-%d0%b8%d0%b7-%d0%b4%d0%be%d0%bf%d0%be%d0%bb%d0%bd%d0%b8%d1%82%d0%b5%d0%bb%d1%8c%d0%bd%d0%be%d0%b9-%d0%b3%d1%80%d1%83%d0%bf%d0%bf%d1%8b">Удалить пользователя из дополнительной группы</a>
</h2><ul>
<li>Удалить пользователя <code>username</code> из группы <code>www</code>:</li>
</ul>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-6
shortcode-codeblock-bash">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-10bee9d47f7b7b9e859a202d06bede73" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="nv">u</span><span class="o">=</span><span class="s1">&#39;username&#39;</span><span class="p">;</span> gpasswd -d <span class="s2">&#34;</span><span class="si">${</span><span class="nv">u</span><span class="si">}</span><span class="s2">&#34;</span> www</span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-10bee9d47f7b7b9e859a202d06bede73"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<h2 id="изменить-основную-группу-пользователя">
  <a class="link-body-emphasis" href="#%d0%b8%d0%b7%d0%bc%d0%b5%d0%bd%d0%b8%d1%82%d1%8c-%d0%be%d1%81%d0%bd%d0%be%d0%b2%d0%bd%d1%83%d1%8e-%d0%b3%d1%80%d1%83%d0%bf%d0%bf%d1%83-%d0%bf%d0%be%d0%bb%d1%8c%d0%b7%d0%be%d0%b2%d0%b0%d1%82%d0%b5%d0%bb%d1%8f">Изменить основную группу пользователя</a>
</h2><ul>
<li>Изменить основную группу пользователя <code>username</code> на группу <code>www</code>:</li>
</ul>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-7
shortcode-codeblock-bash">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-4cf678cda5578a86f3869b9da9ec1449" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="nv">u</span><span class="o">=</span><span class="s1">&#39;username&#39;</span><span class="p">;</span> usermod -g www <span class="s2">&#34;</span><span class="si">${</span><span class="nv">u</span><span class="si">}</span><span class="s2">&#34;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-4cf678cda5578a86f3869b9da9ec1449"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<h2 id="заменить-у-пользователя-дополнительные-группы">
  <a class="link-body-emphasis" href="#%d0%b7%d0%b0%d0%bc%d0%b5%d0%bd%d0%b8%d1%82%d1%8c-%d1%83-%d0%bf%d0%be%d0%bb%d1%8c%d0%b7%d0%be%d0%b2%d0%b0%d1%82%d0%b5%d0%bb%d1%8f-%d0%b4%d0%be%d0%bf%d0%be%d0%bb%d0%bd%d0%b8%d1%82%d0%b5%d0%bb%d1%8c%d0%bd%d1%8b%d0%b5-%d0%b3%d1%80%d1%83%d0%bf%d0%bf%d1%8b">Заменить у пользователя дополнительные группы</a>
</h2><ul>
<li>Заменить у пользователя <code>username</code> все дополнительные группы на группу <code>www</code>:</li>
</ul>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-8
shortcode-codeblock-bash">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-6de7834f9be7678e98a35f64226f8f79" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="nv">u</span><span class="o">=</span><span class="s1">&#39;username&#39;</span><span class="p">;</span> usermod -G www <span class="s2">&#34;</span><span class="si">${</span><span class="nv">u</span><span class="si">}</span><span class="s2">&#34;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-6de7834f9be7678e98a35f64226f8f79"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>]]></turbo:content></item><item turbo="true"><title>RHEL: Статический IP-адрес</title><link>https://lib.onl/ru/2024/06/66e74163-ecd3-51a3-bec4-aa91d3bf9da5/</link><pubDate>Mon, 03 Jun 2024 10:19:22 +0000</pubDate><dc:creator>Kai Kimera</dc:creator><category>Терминал</category><category>Linux</category><category>Сеть</category><category>В доработке</category><yandex:related><link url="https://lib.onl/ru/2021/05/ee559a6c-5cde-5166-9d2d-3ceb55878eb8/">Debian: Статический IP-адрес</link><link url="https://lib.onl/ru/2024/03/bd4f198b-907e-5c14-90c6-a7c032891ce0/">Проверка DNS-записей домена</link><link url="https://lib.onl/ru/2022/08/badb30a9-0471-5dab-a422-85422c0ac611/">Включение DNS over TLS (DoT) в OPNsense</link></yandex:related><turbo:extendedHtml>true</turbo:extendedHtml><turbo:source>https://lib.onl/ru/2024/06/66e74163-ecd3-51a3-bec4-aa91d3bf9da5/</turbo:source><turbo:topic>RHEL: Статический IP-адрес</turbo:topic><turbo:content><![CDATA[<p>Настройка статического IP-адреса в RHEL-based дистрибутивах.</p>
<h2 id="вводные-данные">
  <a class="link-body-emphasis" href="#%d0%b2%d0%b2%d0%be%d0%b4%d0%bd%d1%8b%d0%b5-%d0%b4%d0%b0%d0%bd%d0%bd%d1%8b%d0%b5">Вводные данные</a>
</h2><ul>
<li>Интерфейс: <code>eth0</code>.</li>
<li>IP-адрес: <code>192.168.10.55/24</code>.</li>
<li>Маска подсети: <code>192.168.10.0/24</code>.</li>
<li>Шлюз: <code>192.168.10.1</code>.</li>
<li>DNS-серверы:
<ul>
<li><code>192.168.10.2</code>.</li>
<li><code>192.168.10.3</code>.</li>
</ul>
</li>
</ul>
<h2 id="настройка-статического-ip-адреса">
  <a class="link-body-emphasis" href="#%d0%bd%d0%b0%d1%81%d1%82%d1%80%d0%be%d0%b9%d0%ba%d0%b0-%d1%81%d1%82%d0%b0%d1%82%d0%b8%d1%87%d0%b5%d1%81%d0%ba%d0%be%d0%b3%d0%be-ip-%d0%b0%d0%b4%d1%80%d0%b5%d1%81%d0%b0">Настройка статического IP-адреса</a>
</h2><h3 id="установка-ip-адреса">
  <a class="link-body-emphasis" href="#%d1%83%d1%81%d1%82%d0%b0%d0%bd%d0%be%d0%b2%d0%ba%d0%b0-ip-%d0%b0%d0%b4%d1%80%d0%b5%d1%81%d0%b0">Установка IP-адреса</a>
</h3>








  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-0
shortcode-codeblock-bash">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-98f37f321307a1f6f33b375d72380539" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">nmcli con modify eth0 ipv4.addresses <span class="s1">&#39;192.168.10.55/24&#39;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-98f37f321307a1f6f33b375d72380539"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<p>Где:</p>
<ul>
<li><code>eth0</code> - название интерфейса.</li>
<li><code>ipv4.addresses</code> - IP-адрес интерфейса.</li>
</ul>
<h3 id="установка-шлюза">
  <a class="link-body-emphasis" href="#%d1%83%d1%81%d1%82%d0%b0%d0%bd%d0%be%d0%b2%d0%ba%d0%b0-%d1%88%d0%bb%d1%8e%d0%b7%d0%b0">Установка шлюза</a>
</h3>








  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-1
shortcode-codeblock-bash">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-cf391561a3a632e1853d0115d0b5ed8b" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">nmcli con modify eth0 ipv4.gateway <span class="s1">&#39;192.168.10.1&#39;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-cf391561a3a632e1853d0115d0b5ed8b"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<p>Где:</p>
<ul>
<li><code>eth0</code> - название интерфейса.</li>
<li><code>ipv4.gateway</code> - шлюз.</li>
</ul>
<h3 id="установка-dns">
  <a class="link-body-emphasis" href="#%d1%83%d1%81%d1%82%d0%b0%d0%bd%d0%be%d0%b2%d0%ba%d0%b0-dns">Установка DNS</a>
</h3>








  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-2
shortcode-codeblock-bash">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-a37ec5baf04d792411ff2c7d93d6301e" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">nmcli con modify eth0 ipv4.dns <span class="s1">&#39;192.168.10.2,192.168.10.3&#39;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-a37ec5baf04d792411ff2c7d93d6301e"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<p>Где:</p>
<ul>
<li><code>eth0</code> - название интерфейса.</li>
<li><code>ipv4.dns</code> - IP-адрес DNS-сервера.</li>
</ul>
<h3 id="установка-статических-настроек">
  <a class="link-body-emphasis" href="#%d1%83%d1%81%d1%82%d0%b0%d0%bd%d0%be%d0%b2%d0%ba%d0%b0-%d1%81%d1%82%d0%b0%d1%82%d0%b8%d1%87%d0%b5%d1%81%d0%ba%d0%b8%d1%85-%d0%bd%d0%b0%d1%81%d1%82%d1%80%d0%be%d0%b5%d0%ba">Установка статических настроек</a>
</h3>








  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-3
shortcode-codeblock-bash">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-f5b5111a53e6c221466e0f95cf2c6e5e" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">nmcli con modify eth0 ipv4.method manual</span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-f5b5111a53e6c221466e0f95cf2c6e5e"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<p>Где:</p>
<ul>
<li><code>eth0</code> - название интерфейса.</li>
<li><code>ipv4.method</code> - тип настроек сети.
<ul>
<li><code>manual</code> - использовать статические настройки.</li>
<li><code>auto</code> - использовать настройки от DHCP-сервера.</li>
</ul>
</li>
</ul>
<h3 id="перезапуск-интерфейса">
  <a class="link-body-emphasis" href="#%d0%bf%d0%b5%d1%80%d0%b5%d0%b7%d0%b0%d0%bf%d1%83%d1%81%d0%ba-%d0%b8%d0%bd%d1%82%d0%b5%d1%80%d1%84%d0%b5%d0%b9%d1%81%d0%b0">Перезапуск интерфейса</a>
</h3>








  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-4
shortcode-codeblock-bash">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-6de77d415b7932ed571d8dc861159aa4" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">nmcli con down eth0 <span class="o">&amp;&amp;</span> nmcli con up eth0</span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-6de77d415b7932ed571d8dc861159aa4"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<p>Где:</p>
<ul>
<li><code>down</code> - отключить интерфейс.</li>
<li><code>up</code> - включить интерфейс.</li>
<li><code>eth0</code> - название интерфейса.</li>
</ul>
<h3 id="проверка-параметров">
  <a class="link-body-emphasis" href="#%d0%bf%d1%80%d0%be%d0%b2%d0%b5%d1%80%d0%ba%d0%b0-%d0%bf%d0%b0%d1%80%d0%b0%d0%bc%d0%b5%d1%82%d1%80%d0%be%d0%b2">Проверка параметров</a>
</h3>








  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-5
shortcode-codeblock-bash">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-693f1396effdbb413a45e1043f2e9642" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">nmcli device show eth0</span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-693f1396effdbb413a45e1043f2e9642"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<p>Где:</p>
<ul>
<li><code>eth0</code> - название интерфейса.</li>
</ul>]]></turbo:content></item><item turbo="true"><title>FreeBSD: Пользователи и группы</title><link>https://lib.onl/ru/2024/06/eea13ebc-7ca9-5721-b017-d911a8f6354d/</link><pubDate>Sun, 02 Jun 2024 09:33:30 +0000</pubDate><dc:creator>Kai Kimera</dc:creator><category>BSD</category><category>Терминал</category><yandex:related><link url="https://lib.onl/ru/2024/03/6c7a038f-f41e-5a45-a285-b99fdacf82d4/">Работа с ZFS</link><link url="https://lib.onl/ru/2024/02/f97dc310-9a6a-52f7-8441-bf7eb02087c2/">Первичная настройка FreeBSD</link></yandex:related><turbo:extendedHtml>true</turbo:extendedHtml><turbo:source>https://lib.onl/ru/2024/06/eea13ebc-7ca9-5721-b017-d911a8f6354d/</turbo:source><turbo:topic>FreeBSD: Пользователи и группы</turbo:topic><turbo:content><![CDATA[<p>Набор команд для работы с группами и пользователями в <span class="shortcode shortcode-tag"><a href="/ru/tags/freebsd/" target="_blank">#FreeBSD</a></span>.</p>
<p>Во <span class="shortcode shortcode-tag"><a href="/ru/tags/freebsd/" target="_blank">#FreeBSD</a></span> для работы с пользователями и группами, можно использовать несколько инструментов. Я использую мощную утилиту <code>pw</code>. Конфигурация утилиты <code>pw</code> находится в файле <code>/etc/pw.conf</code>.</p>
<h2 id="создать-пользователя">
  <a class="link-body-emphasis" href="#%d1%81%d0%be%d0%b7%d0%b4%d0%b0%d1%82%d1%8c-%d0%bf%d0%be%d0%bb%d1%8c%d0%b7%d0%be%d0%b2%d0%b0%d1%82%d0%b5%d0%bb%d1%8f">Создать пользователя</a>
</h2><ul>
<li>Создать пользователя <code>username</code>, добавить его в группу <code>wheel</code>, указать комментарий <code>User username</code> и задать пароль:</li>
</ul>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-0
shortcode-codeblock-bash">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-54cc82f1947a22aec150f154eb635685" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="nv">u</span><span class="o">=</span><span class="s1">&#39;username&#39;</span><span class="p">;</span> pw adduser <span class="s2">&#34;</span><span class="si">${</span><span class="nv">u</span><span class="si">}</span><span class="s2">&#34;</span> -m -G wheel -c <span class="s2">&#34;User </span><span class="si">${</span><span class="nv">u</span><span class="si">}</span><span class="s2">&#34;</span> <span class="o">&amp;&amp;</span> passwd <span class="s2">&#34;</span><span class="si">${</span><span class="nv">u</span><span class="si">}</span><span class="s2">&#34;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-54cc82f1947a22aec150f154eb635685"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<h2 id="переименовать-пользователя">
  <a class="link-body-emphasis" href="#%d0%bf%d0%b5%d1%80%d0%b5%d0%b8%d0%bc%d0%b5%d0%bd%d0%be%d0%b2%d0%b0%d1%82%d1%8c-%d0%bf%d0%be%d0%bb%d1%8c%d0%b7%d0%be%d0%b2%d0%b0%d1%82%d0%b5%d0%bb%d1%8f">Переименовать пользователя</a>
</h2><ul>
<li>Переименовать домашнюю директорию пользователя, переименовать пользователя и его группу:</li>
</ul>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-1
shortcode-codeblock-bash">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-7a46cd40c7571c0fc7178a4b245cab74" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="nv">u_old</span><span class="o">=</span><span class="s1">&#39;username_old&#39;</span><span class="p">;</span> <span class="nv">u_new</span><span class="o">=</span><span class="s1">&#39;username_new&#39;</span><span class="p">;</span> mv <span class="s2">&#34;/home/</span><span class="si">${</span><span class="nv">u_old</span><span class="si">}</span><span class="s2">&#34;</span> <span class="s2">&#34;/home/</span><span class="si">${</span><span class="nv">u_new</span><span class="si">}</span><span class="s2">&#34;</span> <span class="o">&amp;&amp;</span> pw usermod -n <span class="s2">&#34;</span><span class="si">${</span><span class="nv">u_old</span><span class="si">}</span><span class="s2">&#34;</span> -l <span class="s2">&#34;</span><span class="si">${</span><span class="nv">u_new</span><span class="si">}</span><span class="s2">&#34;</span> -d <span class="s2">&#34;/home/</span><span class="si">${</span><span class="nv">u_new</span><span class="si">}</span><span class="s2">&#34;</span> <span class="o">&amp;&amp;</span> pw groupmod -n <span class="s2">&#34;</span><span class="si">${</span><span class="nv">u_old</span><span class="si">}</span><span class="s2">&#34;</span> -l <span class="s2">&#34;</span><span class="si">${</span><span class="nv">u_new</span><span class="si">}</span><span class="s2">&#34;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-7a46cd40c7571c0fc7178a4b245cab74"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<h2 id="удалить-пользователя">
  <a class="link-body-emphasis" href="#%d1%83%d0%b4%d0%b0%d0%bb%d0%b8%d1%82%d1%8c-%d0%bf%d0%be%d0%bb%d1%8c%d0%b7%d0%be%d0%b2%d0%b0%d1%82%d0%b5%d0%bb%d1%8f">Удалить пользователя</a>
</h2><ul>
<li>Удалить пользователя <code>username</code> и его домашнюю директорию (<code>-r</code>):</li>
</ul>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-2
shortcode-codeblock-bash">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-f9f5f60690944d68a2c5e9b5304d30ce" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="nv">u</span><span class="o">=</span><span class="s1">&#39;username&#39;</span><span class="p">;</span> pw userdel <span class="s2">&#34;</span><span class="si">${</span><span class="nv">u</span><span class="si">}</span><span class="s2">&#34;</span> -r</span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-f9f5f60690944d68a2c5e9b5304d30ce"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<h2 id="заблокировать-пользователя">
  <a class="link-body-emphasis" href="#%d0%b7%d0%b0%d0%b1%d0%bb%d0%be%d0%ba%d0%b8%d1%80%d0%be%d0%b2%d0%b0%d1%82%d1%8c-%d0%bf%d0%be%d0%bb%d1%8c%d0%b7%d0%be%d0%b2%d0%b0%d1%82%d0%b5%d0%bb%d1%8f">Заблокировать пользователя</a>
</h2><ul>
<li>Заблокировать пользователя <code>username</code>:</li>
</ul>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-3
shortcode-codeblock-bash">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-0ea96591c7e4d71eb28f035dedab39de" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="nv">u</span><span class="o">=</span><span class="s1">&#39;username&#39;</span><span class="p">;</span> pw lock <span class="s2">&#34;</span><span class="si">${</span><span class="nv">u</span><span class="si">}</span><span class="s2">&#34;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-0ea96591c7e4d71eb28f035dedab39de"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<h2 id="разблокировать-пользователя">
  <a class="link-body-emphasis" href="#%d1%80%d0%b0%d0%b7%d0%b1%d0%bb%d0%be%d0%ba%d0%b8%d1%80%d0%be%d0%b2%d0%b0%d1%82%d1%8c-%d0%bf%d0%be%d0%bb%d1%8c%d0%b7%d0%be%d0%b2%d0%b0%d1%82%d0%b5%d0%bb%d1%8f">Разблокировать пользователя</a>
</h2><ul>
<li>Разблокировать пользователя <code>username</code>:</li>
</ul>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-4
shortcode-codeblock-bash">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-602dba78cdfebfc177eae9354ae482fb" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="nv">u</span><span class="o">=</span><span class="s1">&#39;username&#39;</span><span class="p">;</span> pw unlock <span class="s2">&#34;</span><span class="si">${</span><span class="nv">u</span><span class="si">}</span><span class="s2">&#34;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-602dba78cdfebfc177eae9354ae482fb"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<h2 id="добавить-пользователя-в-дополнительную-группу">
  <a class="link-body-emphasis" href="#%d0%b4%d0%be%d0%b1%d0%b0%d0%b2%d0%b8%d1%82%d1%8c-%d0%bf%d0%be%d0%bb%d1%8c%d0%b7%d0%be%d0%b2%d0%b0%d1%82%d0%b5%d0%bb%d1%8f-%d0%b2-%d0%b4%d0%be%d0%bf%d0%be%d0%bb%d0%bd%d0%b8%d1%82%d0%b5%d0%bb%d1%8c%d0%bd%d1%83%d1%8e-%d0%b3%d1%80%d1%83%d0%bf%d0%bf%d1%83">Добавить пользователя в дополнительную группу</a>
</h2><ul>
<li>Добавить пользователя <code>username</code> в группу <code>www</code>:</li>
</ul>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-5
shortcode-codeblock-bash">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-6cd43964388166dbc1dd89cd477d5cd0" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="nv">u</span><span class="o">=</span><span class="s1">&#39;username&#39;</span><span class="p">;</span> pw groupmod www -m <span class="s2">&#34;</span><span class="si">${</span><span class="nv">u</span><span class="si">}</span><span class="s2">&#34;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-6cd43964388166dbc1dd89cd477d5cd0"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<ul>
<li>Заменить все текущие группы пользователя <code>username</code> на группы <code>wheel</code> и <code>devels</code>:</li>
</ul>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-6
shortcode-codeblock-bash">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-bd863631496cc0241a094582b2667531" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="nv">u</span><span class="o">=</span><span class="s1">&#39;username&#39;</span><span class="p">;</span> pw usermod <span class="s2">&#34;</span><span class="si">${</span><span class="nv">u</span><span class="si">}</span><span class="s2">&#34;</span> -G wheel,devels</span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-bd863631496cc0241a094582b2667531"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<h2 id="удалить-пользователя-из-дополнительной-группы">
  <a class="link-body-emphasis" href="#%d1%83%d0%b4%d0%b0%d0%bb%d0%b8%d1%82%d1%8c-%d0%bf%d0%be%d0%bb%d1%8c%d0%b7%d0%be%d0%b2%d0%b0%d1%82%d0%b5%d0%bb%d1%8f-%d0%b8%d0%b7-%d0%b4%d0%be%d0%bf%d0%be%d0%bb%d0%bd%d0%b8%d1%82%d0%b5%d0%bb%d1%8c%d0%bd%d0%be%d0%b9-%d0%b3%d1%80%d1%83%d0%bf%d0%bf%d1%8b">Удалить пользователя из дополнительной группы</a>
</h2><ul>
<li>Удалить пользователя <code>username</code> из группы <code>www</code>:</li>
</ul>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-7
shortcode-codeblock-bash">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-55af61d8a5a24625615e5edaa58f4b6a" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="nv">u</span><span class="o">=</span><span class="s1">&#39;username&#39;</span><span class="p">;</span> pw groupmod www -d <span class="s2">&#34;</span><span class="si">${</span><span class="nv">u</span><span class="si">}</span><span class="s2">&#34;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-55af61d8a5a24625615e5edaa58f4b6a"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<h2 id="посмотреть-информацию-о-пользователе">
  <a class="link-body-emphasis" href="#%d0%bf%d0%be%d1%81%d0%bc%d0%be%d1%82%d1%80%d0%b5%d1%82%d1%8c-%d0%b8%d0%bd%d1%84%d0%be%d1%80%d0%bc%d0%b0%d1%86%d0%b8%d1%8e-%d0%be-%d0%bf%d0%be%d0%bb%d1%8c%d0%b7%d0%be%d0%b2%d0%b0%d1%82%d0%b5%d0%bb%d0%b5">Посмотреть информацию о пользователе</a>
</h2><ul>
<li>Посмотреть информацию о пользователе <code>username</code>:</li>
</ul>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-8
shortcode-codeblock-bash">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-3f6eeb5ff9fa80fc503f2936fc20e525" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="nv">u</span><span class="o">=</span><span class="s1">&#39;username&#39;</span><span class="p">;</span> pw show user <span class="s2">&#34;</span><span class="si">${</span><span class="nv">u</span><span class="si">}</span><span class="s2">&#34;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-3f6eeb5ff9fa80fc503f2936fc20e525"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>]]></turbo:content></item><item turbo="true"><title>iRedMail: Управление белым и чёрным списками</title><link>https://lib.onl/ru/2024/05/27b4071a-6d32-5517-83c7-dd77ee740e87/</link><pubDate>Sat, 25 May 2024 06:02:49 +0000</pubDate><dc:creator>Kai Kimera</dc:creator><category>Linux</category><category>Безопасность</category><category>Терминал</category><turbo:extendedHtml>true</turbo:extendedHtml><turbo:source>https://lib.onl/ru/2024/05/27b4071a-6d32-5517-83c7-dd77ee740e87/</turbo:source><turbo:topic>iRedMail: Управление белым и чёрным списками</turbo:topic><turbo:content><![CDATA[<p>Белый и чёрный списки являются списками фильтрации входящих электронных писем на уровне сервера.</p>
<p>Чёрный список позволяет заблокировать поступление электронных писем от определённого абонента, белый список, напротив, разрешить поступление электронных писем от отправителя вне зависимости от их содержания и дополнительных проверок почтовым сервером.</p>
<p>В <span class="shortcode shortcode-tag"><a href="/ru/tags/iredmail/" target="_blank">#iRedMail</a></span> чёрный и белый списки контролируются плагином <code>amavisd_wblist</code> (<code>/opt/iredapd/plugins/amavisd_wblist.py</code>). Самим же плагином можно управлять при помощи скрипта <code>wblist_admin.py</code> (<code>/opt/iredapd/tools/wblist_admin.py</code>).</p>
<h2 id="форматы-адресов">
  <a class="link-body-emphasis" href="#%d1%84%d0%be%d1%80%d0%bc%d0%b0%d1%82%d1%8b-%d0%b0%d0%b4%d1%80%d0%b5%d1%81%d0%be%d0%b2">Форматы адресов</a>
</h2><p>Допустимые форматы адресов для белого и чёрного списков:</p>
<ul>
<li><code>user@domain.com</code> - один пользователь.</li>
<li><code>@domain.com</code> / <code>@sub.domain.com</code> - один домен.</li>
<li><code>@.domain.com</code> - домен и все его суб-домены.</li>
<li><code>@.</code> - любой домен.</li>
<li><code>@.com</code> / <code>@.org</code> / <code>@.info</code> - домен верхнего уровня.</li>
<li><code>192.168.1.2</code> - один IP-адрес.</li>
<li><code>192.168.1.0/24</code> - Сеть CIDR.</li>
</ul>
<h2 id="примеры-для-белого-списка">
  <a class="link-body-emphasis" href="#%d0%bf%d1%80%d0%b8%d0%bc%d0%b5%d1%80%d1%8b-%d0%b4%d0%bb%d1%8f-%d0%b1%d0%b5%d0%bb%d0%be%d0%b3%d0%be-%d1%81%d0%bf%d0%b8%d1%81%d0%ba%d0%b0">Примеры для белого списка</a>
</h2><ul>
<li>Показать записи из белого списка:</li>
</ul>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-0
shortcode-codeblock-bash">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-fa8854298e5504fe7f6d3af98968c240" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">python3 <span class="s1">&#39;/opt/iredapd/tools/wblist_admin.py&#39;</span> --list --whitelist</span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-fa8854298e5504fe7f6d3af98968c240"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<ul>
<li>Добавить в белый список IP-адрес, email, домен и суб-домен:</li>
</ul>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-1
shortcode-codeblock-bash">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-95bcad94e5d48d74d3b5f93421473998" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">python3 <span class="s1">&#39;/opt/iredapd/tools/wblist_admin.py&#39;</span> --add --whitelist <span class="s1">&#39;192.168.1.10&#39;</span> <span class="s1">&#39;user@domain.com&#39;</span> <span class="s1">&#39;@iredmail.org&#39;</span> <span class="s1">&#39;@.example.com&#39;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-95bcad94e5d48d74d3b5f93421473998"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<ul>
<li>Создать для локального почтового домена <code>@domain.com</code> белый список и внести в него IP-адрес <code>192.168.1.10</code> и email <code>user@example.com</code>:</li>
</ul>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-2
shortcode-codeblock-bash">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-a7fb882abf7910fb4ac4aea22892ebeb" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">python3 <span class="s1">&#39;/opt/iredapd/tools/wblist_admin.py&#39;</span> --account <span class="s1">&#39;@domain.com&#39;</span> --add --whitelist <span class="s1">&#39;192.168.1.10&#39;</span> <span class="s1">&#39;user@example.com&#39;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-a7fb882abf7910fb4ac4aea22892ebeb"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<ul>
<li>Создать для локального почтового домена <code>@domain.com</code> и всех его суб-доменов белый список и внести в него IP-адрес <code>192.168.1.10</code> и email <code>user@example.com</code>:</li>
</ul>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-3
shortcode-codeblock-bash">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-aff54af3a10ec493df644f61aab57406" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">python3 <span class="s1">&#39;/opt/iredapd/tools/wblist_admin.py&#39;</span> --account <span class="s1">&#39;@.domain.com&#39;</span> --add --whitelist <span class="s1">&#39;192.168.1.10&#39;</span> <span class="s1">&#39;user@example.com&#39;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-aff54af3a10ec493df644f61aab57406"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<ul>
<li>Создать для локального пользователя <code>user@domain.com</code> белый список и внести в него IP-адрес <code>192.168.1.10</code> и email <code>user@example.com</code>:</li>
</ul>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-4
shortcode-codeblock-bash">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-f601ab82ccd970cbb5d3df1920863cf3" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">python3 <span class="s1">&#39;/opt/iredapd/tools/wblist_admin.py&#39;</span> --account <span class="s1">&#39;user@domain.com&#39;</span> --add --whitelist <span class="s1">&#39;192.168.1.10&#39;</span> <span class="s1">&#39;user@example.com&#39;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-f601ab82ccd970cbb5d3df1920863cf3"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<ul>
<li>Показать записи из белого списка для локального почтового домена <code>@domain.com</code>:</li>
</ul>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-5
shortcode-codeblock-bash">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-d471acfa164bcc568d3bdb3a669ed088" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">python3 <span class="s1">&#39;/opt/iredapd/tools/wblist_admin.py&#39;</span> --account <span class="s1">&#39;@domain.com&#39;</span> --list --whitelist</span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-d471acfa164bcc568d3bdb3a669ed088"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<ul>
<li>Показать записи из белого списка для локального пользователя <code>user@domain.com</code>:</li>
</ul>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-6
shortcode-codeblock-bash">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-0011f27dcc24c5509bbff21924aa9223" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">python3 <span class="s1">&#39;/opt/iredapd/tools/wblist_admin.py&#39;</span> --account <span class="s1">&#39;user@domain.com&#39;</span> --list --whitelist</span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-0011f27dcc24c5509bbff21924aa9223"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<h2 id="примеры-для-чёрного-списка">
  <a class="link-body-emphasis" href="#%d0%bf%d1%80%d0%b8%d0%bc%d0%b5%d1%80%d1%8b-%d0%b4%d0%bb%d1%8f-%d1%87%d1%91%d1%80%d0%bd%d0%be%d0%b3%d0%be-%d1%81%d0%bf%d0%b8%d1%81%d0%ba%d0%b0">Примеры для чёрного списка</a>
</h2><ul>
<li>Показать записи из чёрного списка:</li>
</ul>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-7
shortcode-codeblock-bash">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-c46448fcdb25c8d001de973ce1acf571" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">python3 <span class="s1">&#39;/opt/iredapd/tools/wblist_admin.py&#39;</span> --list --blacklist</span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-c46448fcdb25c8d001de973ce1acf571"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<ul>
<li>Добавить в чёрный список IP-адрес, email, домен и суб-домен:</li>
</ul>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-8
shortcode-codeblock-bash">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-0158d06afb4f71d95e8a7337e005e7c6" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">python3 <span class="s1">&#39;/opt/iredapd/tools/wblist_admin.py&#39;</span> --add --blacklist <span class="s1">&#39;202.96.134.133&#39;</span> <span class="s1">&#39;bad-user@domain.com&#39;</span> <span class="s1">&#39;@bad-domain.com&#39;</span> <span class="s1">&#39;@.sub-domain.com&#39;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-0158d06afb4f71d95e8a7337e005e7c6"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<ul>
<li>Создать для локального почтового домена <code>@domain.com</code> чёрный список и внести в него IP-адрес <code>172.16.1.10</code> и email <code>bad-user@example.com</code>:</li>
</ul>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-9
shortcode-codeblock-bash">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-6c0af32b875c70b3d195310c45d0f662" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">python3 <span class="s1">&#39;/opt/iredapd/tools/wblist_admin.py&#39;</span> --account <span class="s1">&#39;@domain.com&#39;</span> --add --blacklist <span class="s1">&#39;172.16.1.10&#39;</span> <span class="s1">&#39;bad-user@example.com&#39;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-6c0af32b875c70b3d195310c45d0f662"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<ul>
<li>Создать для локального почтового домена <code>@domain.com</code> и всех его суб-доменов чёрный список и внести в него IP-адрес <code>172.16.1.10</code> и email <code>bad-user@example.com</code>:</li>
</ul>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-10
shortcode-codeblock-bash">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-614b01cb2388d1931d3217616892e253" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">python3 <span class="s1">&#39;/opt/iredapd/tools/wblist_admin.py&#39;</span> --account <span class="s1">&#39;@.domain.com&#39;</span> --add --blacklist <span class="s1">&#39;172.16.1.10&#39;</span> <span class="s1">&#39;bad-user@example.com&#39;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-614b01cb2388d1931d3217616892e253"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<ul>
<li>Создать для локального пользователя <code>user@domain.com</code> чёрный список и внести в него IP-адрес <code>172.16.1.10</code> и email <code>bad-user@example.com</code>:</li>
</ul>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-11
shortcode-codeblock-bash">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-b04f1e7e29856433850ff9f705979aeb" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">python3 <span class="s1">&#39;/opt/iredapd/tools/wblist_admin.py&#39;</span> --account <span class="s1">&#39;user@domain.com&#39;</span> --add --blacklist <span class="s1">&#39;172.16.1.10&#39;</span> <span class="s1">&#39;bad-user@example.com&#39;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-b04f1e7e29856433850ff9f705979aeb"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<ul>
<li>Показать записи из чёрного списка для локального пользователя <code>user@domain.com</code>:</li>
</ul>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-12
shortcode-codeblock-bash">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-7e4eb31533a08c34b65de4120eb8a78b" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">python3 <span class="s1">&#39;/opt/iredapd/tools/wblist_admin.py&#39;</span> --account <span class="s1">&#39;user@domain.com&#39;</span> --list --blacklist</span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-7e4eb31533a08c34b65de4120eb8a78b"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<h2 id="серый-список">
  <a class="link-body-emphasis" href="#%d1%81%d0%b5%d1%80%d1%8b%d0%b9-%d1%81%d0%bf%d0%b8%d1%81%d0%be%d0%ba">Серый список</a>
</h2><p>За серый список отвечает плагин <code>greylisting</code> (<code>/opt/iredapd/plugins/greylisting.py</code>). Этим плагином можно управлять при помощи скрипта <code>greylisting_admin.py</code> (<code>/opt/iredapd/tools/greylisting_admin.py</code>).</p>
<h3 id="примеры-для-серого-списка">
  <a class="link-body-emphasis" href="#%d0%bf%d1%80%d0%b8%d0%bc%d0%b5%d1%80%d1%8b-%d0%b4%d0%bb%d1%8f-%d1%81%d0%b5%d1%80%d0%be%d0%b3%d0%be-%d1%81%d0%bf%d0%b8%d1%81%d0%ba%d0%b0">Примеры для серого списка</a>
</h3><ul>
<li>Отключить глобальный серый список:</li>
</ul>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-13
shortcode-codeblock-bash">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-4e108b9b1b18048d3058d823e9bf0389" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">python3 <span class="s1">&#39;/opt/iredapd/tools/greylisting_admin.py&#39;</span> --disable --from <span class="s1">&#39;@.&#39;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-4e108b9b1b18048d3058d823e9bf0389"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<ul>
<li>Показать все настройки серого списка:</li>
</ul>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-14
shortcode-codeblock-bash">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-0743478efb1aa580823ed2f8fac72e2c" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">python3 <span class="s1">&#39;/opt/iredapd/tools/greylisting_admin.py&#39;</span> --list</span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-0743478efb1aa580823ed2f8fac72e2c"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<ul>
<li>Показать все доменные имена отправителей из белого списка:</li>
</ul>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-15
shortcode-codeblock-bash">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-5c5db81e60b3ad588d1ba643d485ae50" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">python3 <span class="s1">&#39;/opt/iredapd/tools/greylisting_admin.py&#39;</span> --list-whitelist-domains</span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-5c5db81e60b3ad588d1ba643d485ae50"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<ul>
<li>Показать все адреса отправителей из белого списка:</li>
</ul>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-16
shortcode-codeblock-bash">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-f77a5fa1c3f6eac7b084240943934c57" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">python3 <span class="s1">&#39;/opt/iredapd/tools/greylisting_admin.py&#39;</span> --list-whitelists</span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-f77a5fa1c3f6eac7b084240943934c57"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<ul>
<li>Добавить домен отправителя <code>@example.com</code> в белый список:</li>
</ul>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-17
shortcode-codeblock-bash">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-b4b3e4310d52411f6e13d492fa27c1ed" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">python3 <span class="s1">&#39;/opt/iredapd/tools/greylisting_admin.py&#39;</span> --whitelist-domain --from <span class="s1">&#39;@example.com&#39;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-b4b3e4310d52411f6e13d492fa27c1ed"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<ul>
<li>Удалить домен отправителя <code>@example.com</code> из белого списка:</li>
</ul>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-18
shortcode-codeblock-bash">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-a6fe4ccda5d802aae36110233cae3479" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">python3 <span class="s1">&#39;/opt/iredapd/tools/greylisting_admin.py&#39;</span> --remove-whitelist-domain --from <span class="s1">&#39;@example.com&#39;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-a6fe4ccda5d802aae36110233cae3479"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<ul>
<li>Включить серый список для локального почтового домена <code>@example.com</code>:</li>
</ul>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-19
shortcode-codeblock-bash">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-8b6195b160c2887523f10a7223527d4a" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">python3 <span class="s1">&#39;/opt/iredapd/tools/greylisting_admin.py&#39;</span> --enable --to <span class="s1">&#39;@example.com&#39;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-8b6195b160c2887523f10a7223527d4a"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<ul>
<li>Отключить серый список для локального пользователя <code>user@example.com</code>:</li>
</ul>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-20
shortcode-codeblock-bash">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-7486a884cd5f73eb8f46a09227d81a42" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">python3 <span class="s1">&#39;/opt/iredapd/tools/greylisting_admin.py&#39;</span> --disable --to <span class="s1">&#39;user@example.com&#39;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-7486a884cd5f73eb8f46a09227d81a42"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<ul>
<li>Отключить серый список для писем, отправленных с домена <code>@gmail.com</code> локальному пользователю <code>user@example.com</code>:</li>
</ul>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-21
shortcode-codeblock-bash">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-5527a3c4b64c839544b83b6d99ea665d" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">python3 <span class="s1">&#39;/opt/iredapd/tools/greylisting_admin.py&#39;</span> --disable --from <span class="s1">&#39;@gmail.com&#39;</span> --to <span class="s1">&#39;user@example.com&#39;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-5527a3c4b64c839544b83b6d99ea665d"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<ul>
<li>Отключить серый список для писем, отправленных с IP-адреса <code>45.56.127.226</code>:</li>
</ul>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-22
shortcode-codeblock-bash">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-7bf287991bd966f945a7f3c6c1a7305b" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">python3 <span class="s1">&#39;/opt/iredapd/tools/greylisting_admin.py&#39;</span> --disable --from <span class="s1">&#39;45.56.127.226&#39;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-7bf287991bd966f945a7f3c6c1a7305b"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<ul>
<li>Удалить настройки серого списка для локального домена <code>@test.com</code>:</li>
</ul>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-23
shortcode-codeblock-bash">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-be9c4a889c44f84b926cbaa34a5e6ccb" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">python3 <span class="s1">&#39;/opt/iredapd/tools/greylisting_admin.py&#39;</span> --delete --to <span class="s1">&#39;@test.com&#39;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-be9c4a889c44f84b926cbaa34a5e6ccb"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>]]></turbo:content></item><item turbo="true"><title>Как изменить IP-адрес в Proxmox VE?</title><link>https://lib.onl/ru/2024/05/ffbb2491-6784-510a-a067-2f08cc76c221/</link><pubDate>Sat, 11 May 2024 12:43:38 +0000</pubDate><dc:creator>Kai Kimera</dc:creator><category>Proxmox</category><category>Ip</category><turbo:extendedHtml>true</turbo:extendedHtml><turbo:source>https://lib.onl/ru/2024/05/ffbb2491-6784-510a-a067-2f08cc76c221/</turbo:source><turbo:topic>Как изменить IP-адрес в Proxmox VE?</turbo:topic><turbo:content><![CDATA[<p>Есть несколько серверов на <span class="shortcode shortcode-tag"><a href="/ru/tags/proxmox/" target="_blank">#Proxmox</a></span> VE. Сейчас идёт реструктуризация сети. Необходимо поменять IP-адреса на серверах <span class="shortcode shortcode-tag"><a href="/ru/tags/proxmox/" target="_blank">#Proxmox</a></span> VE. Как это сделать?</p>]]></turbo:content></item><item turbo="true"><title>Cisco: Туннель GRE/IPsec (Site-to-Site) + OSPF</title><link>https://lib.onl/ru/2024/05/7b3bb6b3-c7db-550c-abf6-9d88c66a8a74/</link><pubDate>Fri, 03 May 2024 07:48:22 +0000</pubDate><dc:creator>Kai Kimera</dc:creator><category>Сеть</category><category>В доработке</category><yandex:related><link url="https://lib.onl/ru/2024/04/326618af-d950-5001-8114-57c66bb8a5af/">MikroTik: Туннель GRE/IPsec (Site-to-Site)</link><link url="https://lib.onl/ru/2024/03/b81f9cca-d723-5b72-929a-b88be9d329f9/">Cisco: Обновление IOS</link><link url="https://lib.onl/ru/2024/04/9538d25f-c145-5a84-8583-65f3a2ed4c84/">Cisco: Установка лицензий</link><link url="https://lib.onl/ru/2024/03/54a2b39f-38b4-5f0c-9b54-310f853da38f/">MikroTik: Туннель IPsec (Site-to-Site)</link><link url="https://lib.onl/ru/2024/03/4a7addb9-eff3-5482-902c-791fbe49899f/">Cisco: Загрузка и выгрузка конфигурации</link><link url="https://lib.onl/ru/2024/03/fc67eb74-8f7c-5de3-bd1e-2d823208eae2/">Cisco: Сброс пароля</link></yandex:related><turbo:extendedHtml>true</turbo:extendedHtml><turbo:source>https://lib.onl/ru/2024/05/7b3bb6b3-c7db-550c-abf6-9d88c66a8a74/</turbo:source><turbo:topic>Cisco: Туннель GRE/IPsec (Site-to-Site) + OSPF</turbo:topic><turbo:content><![CDATA[<p>Инструкция по созданию туннеля <span class="shortcode shortcode-tag"><a href="/ru/tags/gre/" target="_blank">#GRE</a></span> с шифрованием <span class="shortcode shortcode-tag"><a href="/ru/tags/ipsec/" target="_blank">#IPsec</a></span> на <span class="shortcode shortcode-tag"><a href="/ru/tags/cisco/" target="_blank">#Cisco</a></span>.</p>
<h2 id="вводные-данные">
  <a class="link-body-emphasis" href="#%d0%b2%d0%b2%d0%be%d0%b4%d0%bd%d1%8b%d0%b5-%d0%b4%d0%b0%d0%bd%d0%bd%d1%8b%d0%b5">Вводные данные</a>
</h2><ul>
<li>Маршрутизатор <code>R1</code>:
<ul>
<li>WAN IP: <code>1.1.1.1</code>.</li>
<li>LAN IP: <code>10.1.0.1</code>.</li>
<li>Network: <code>10.1.0.0/16</code>.</li>
<li>TUN0 IP: <code>10.255.255.1/24</code>.</li>
</ul>
</li>
<li>Маршрутизатор <code>R2</code>:
<ul>
<li>WAN IP: <code>2.2.2.2</code>.</li>
<li>LAN IP: <code>10.2.0.1</code>.</li>
<li>Network: <code>10.2.0.0/16</code>.</li>
<li>TUN0 IP: <code>10.255.255.2/24</code>.</li>
</ul>
</li>
</ul>
<h2 id="настройки-маршрутизаторов">
  <a class="link-body-emphasis" href="#%d0%bd%d0%b0%d1%81%d1%82%d1%80%d0%be%d0%b9%d0%ba%d0%b8-%d0%bc%d0%b0%d1%80%d1%88%d1%80%d1%83%d1%82%d0%b8%d0%b7%d0%b0%d1%82%d0%be%d1%80%d0%be%d0%b2">Настройки маршрутизаторов</a>
</h2><h3 id="router-1">
  <a class="link-body-emphasis" href="#router-1">Router #1</a>
</h3><ul>
<li>Создаём политику <span class="shortcode shortcode-tag"><a href="/ru/tags/ipsec/" target="_blank">#IPsec</a></span>:
<ul>
<li>Метод шифрования для <strong>Phase 1</strong>: <code>encr aes 256</code>.</li>
<li>Использование общего ключа для проверки подлинности: <code>authentication pre-share</code>.</li>
<li>Группа Diffie–Hellman: <code>group 2</code>.</li>
</ul>
</li>
</ul>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-0
shortcode-codeblock-plaintext">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-70858a50877fab06f06446375b4520b8" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-plaintext" data-lang="plaintext"><span class="line"><span class="cl">crypto isakmp policy 5
</span></span><span class="line"><span class="cl">  encr aes 256
</span></span><span class="line"><span class="cl">  authentication pre-share
</span></span><span class="line"><span class="cl">  group 2</span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-70858a50877fab06f06446375b4520b8"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<ul>
<li>Указываем общий ключ:
<ul>
<li>Общий ключ: <code>PassWord</code>.</li>
<li>IP-адрес удалённого маршрутизатора <code>R2</code>: <code>2.2.2.2</code>.</li>
</ul>
</li>
</ul>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-1
shortcode-codeblock-plaintext">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-d81853a852b2198e7b9a62b3c39245bb" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-plaintext" data-lang="plaintext"><span class="line"><span class="cl">crypto isakmp key PassWord address 2.2.2.2</span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-d81853a852b2198e7b9a62b3c39245bb"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<ul>
<li>Настраиваем набор преобразований для защиты данных:
<ul>
<li>Название набора преобразований: <code>GRE-TS</code>.</li>
<li>Метод шифрования: <code>esp-aes 256</code>.</li>
<li>Алгоритм хеширования: <code>esp-sha-hmac</code>.</li>
</ul>
</li>
</ul>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-2
shortcode-codeblock-plaintext">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-a2363f74f58aea44420eec7a3c98586e" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-plaintext" data-lang="plaintext"><span class="line"><span class="cl">crypto ipsec transform-set GRE-TS esp-aes 256 esp-sha-hmac</span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-a2363f74f58aea44420eec7a3c98586e"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<ul>
<li>Создаём профиль <span class="shortcode shortcode-tag"><a href="/ru/tags/ipsec/" target="_blank">#IPsec</a></span>:
<ul>
<li>Название туннеля: <code>GRE-STS</code>.</li>
<li>Название набора преобразований: <code>GRE-TS</code>.</li>
<li>Алгоритм Diffie–Hellman&rsquo;а (1024 бита): <code>pfs group2</code>. Использование данной опции позволяет повысить уровень защищенности трафика - при создании каждого IPsec SA производится выработка новых сессионных ключей.</li>
</ul>
</li>
</ul>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-3
shortcode-codeblock-plaintext">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-b254ed1dc83e430a393f656ad2931cc3" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-plaintext" data-lang="plaintext"><span class="line"><span class="cl">crypto ipsec profile GRE-STS
</span></span><span class="line"><span class="cl">  set transform-set GRE-TS
</span></span><span class="line"><span class="cl">  set pfs group2</span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-b254ed1dc83e430a393f656ad2931cc3"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<ul>
<li>Создаём туннель:
<ul>
<li>Название интерфейса: <code>Tunnel0</code>.</li>
<li>IP-адрес и маска интерфейса: <code>10.255.255.1 255.255.255.0</code>.</li>
<li>MTU: <code>1400</code>.</li>
<li>MSS: <code>1360</code>.</li>
<li>WAN IP-адрес локального маршрутизатора <code>R1</code>: <code>1.1.1.1</code>.</li>
<li>WAN IP-адрес удалённого маршрутизатора <code>R2</code>: <code>2.2.2.2</code>.</li>
<li>Профиль <span class="shortcode shortcode-tag"><a href="/ru/tags/ipsec/" target="_blank">#IPsec</a></span>: <code>GRE-STS</code>.</li>
</ul>
</li>
</ul>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-4
shortcode-codeblock-plaintext">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-487384542e60f42b2d711dde430e34c0" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-plaintext" data-lang="plaintext"><span class="line"><span class="cl">interface Tunnel0
</span></span><span class="line"><span class="cl">  ip address 10.255.255.1 255.255.255.0
</span></span><span class="line"><span class="cl">  tunnel source 1.1.1.1
</span></span><span class="line"><span class="cl">  tunnel destination 2.2.2.2
</span></span><span class="line"><span class="cl">  tunnel protection ipsec profile GRE-STS</span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-487384542e60f42b2d711dde430e34c0"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<ul>
<li>Прописываем маршрут до удалённого роутера <code>R2</code>:
<ul>
<li>Сеть удалённого роутера <code>R2</code>: <code>10.2.0.0</code>.</li>
<li>Маска подсети удалённого роутера <code>R2</code>: <code>255.255.0.0</code>.</li>
<li>IP-адрес шлюза удалённого роутера <code>R2</code>: <code>10.255.255.2</code>.</li>
</ul>
</li>
</ul>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-5
shortcode-codeblock-plaintext">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-e357138a29768148c59eeed94809fce6" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-plaintext" data-lang="plaintext"><span class="line"><span class="cl">ip route 10.2.0.0 255.255.0.0 10.255.255.2</span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-e357138a29768148c59eeed94809fce6"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<ul>
<li>Настройка <span class="shortcode shortcode-tag"><a href="/ru/tags/ospf/" target="_blank">#OSPF</a></span>:
<ul>
<li>Указание ID маршрутизатора: <code>router-id 10.1.0.1</code>.</li>
<li>Отключение HELLO-пакетов на всех интерфейсах: <code>passive-interface default</code>.</li>
<li>Включение HELLO-пакетов на интерфейсе <code>Tunnel0</code>: <code>no passive-interface Tunnel0</code>.</li>
<li>Анонсирование сети <code>10.1.0.0/16</code> в <span class="shortcode shortcode-tag"><a href="/ru/tags/ospf/" target="_blank">#OSPF</a></span>: <code>network 10.1.0.0 0.0.255.255 area 0</code>.</li>
</ul>
</li>
</ul>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-6
shortcode-codeblock-plaintext">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-0b38c9dc07a87b2e8bda44e884625d5a" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-plaintext" data-lang="plaintext"><span class="line"><span class="cl">router ospf 5
</span></span><span class="line"><span class="cl">  router-id 10.1.0.1
</span></span><span class="line"><span class="cl">  passive-interface default
</span></span><span class="line"><span class="cl">  no passive-interface Tunnel0
</span></span><span class="line"><span class="cl">  network 10.1.0.0 0.0.255.255 area 0</span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-0b38c9dc07a87b2e8bda44e884625d5a"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<h3 id="router-2">
  <a class="link-body-emphasis" href="#router-2">Router #2</a>
</h3><ul>
<li>Создаём политику <span class="shortcode shortcode-tag"><a href="/ru/tags/ipsec/" target="_blank">#IPsec</a></span>:
<ul>
<li>Метод шифрования для <strong>Phase 1</strong>: <code>encr aes 256</code>.</li>
<li>Использование общего ключа для проверки подлинности: <code>authentication pre-share</code>.</li>
<li>Группа Diffie–Hellman: <code>group 2</code>.</li>
</ul>
</li>
</ul>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-7
shortcode-codeblock-plaintext">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-cf757ecfca85e1ff62ca7ec7ffa111f3" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-plaintext" data-lang="plaintext"><span class="line"><span class="cl">crypto isakmp policy 5
</span></span><span class="line"><span class="cl">  encr aes 256
</span></span><span class="line"><span class="cl">  authentication pre-share
</span></span><span class="line"><span class="cl">  group 2</span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-cf757ecfca85e1ff62ca7ec7ffa111f3"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<ul>
<li>Указываем общий ключ:
<ul>
<li>Общий ключ: <code>PassWord</code>.</li>
<li>IP адрес удалённого маршрутизатора <code>R1</code>: <code>1.1.1.1</code>.</li>
</ul>
</li>
</ul>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-8
shortcode-codeblock-plaintext">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-6d609355681145144469710fd4b72e3f" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-plaintext" data-lang="plaintext"><span class="line"><span class="cl">crypto isakmp key PassWord address 1.1.1.1</span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-6d609355681145144469710fd4b72e3f"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<ul>
<li>Настраиваем набор преобразований для защиты данных:
<ul>
<li>Название набора преобразований: <code>GRE-TS</code>.</li>
<li>Метод шифрования: <code>esp-aes 256</code>.</li>
<li>Алгоритм хеширования: <code>esp-sha-hmac</code>.</li>
</ul>
</li>
</ul>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-9
shortcode-codeblock-plaintext">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-68781272429c3dd0231667a3de860b8f" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-plaintext" data-lang="plaintext"><span class="line"><span class="cl">crypto ipsec transform-set GRE-TS esp-aes 256 esp-sha-hmac</span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-68781272429c3dd0231667a3de860b8f"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<ul>
<li>Создаём профиль <span class="shortcode shortcode-tag"><a href="/ru/tags/ipsec/" target="_blank">#IPsec</a></span>:
<ul>
<li>Название туннеля: <code>GRE-STS</code>.</li>
<li>Название набора преобразований: <code>GRE-TS</code>.</li>
<li>Алгоритм Diffie–Hellman&rsquo;а (1024 бита): <code>pfs group2</code>. Использование данной опции позволяет повысить уровень защищенности трафика - при создании каждого IPsec SA производится выработка новых сессионных ключей.</li>
</ul>
</li>
</ul>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-10
shortcode-codeblock-plaintext">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-76aa4111cfb49439226e58b7a31b19ee" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-plaintext" data-lang="plaintext"><span class="line"><span class="cl">crypto ipsec profile GRE-STS
</span></span><span class="line"><span class="cl">  set transform-set GRE-TS
</span></span><span class="line"><span class="cl">  set pfs group2</span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-76aa4111cfb49439226e58b7a31b19ee"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<ul>
<li>Создаём туннель:
<ul>
<li>Название интерфейса: <code>Tunnel0</code>.</li>
<li>IP-адрес и маска интерфейса: <code>10.255.255.2 255.255.255.0</code>.</li>
<li>MTU: <code>1400</code>.</li>
<li>MSS: <code>1360</code>.</li>
<li>WAN IP-адрес локального маршрутизатора <code>R2</code>: <code>2.2.2.2</code>.</li>
<li>WAN IP-адрес удалённого маршрутизатора <code>R1</code>: <code>1.1.1.1</code>.</li>
<li>Профиль <span class="shortcode shortcode-tag"><a href="/ru/tags/ipsec/" target="_blank">#IPsec</a></span>: <code>GRE-STS</code>.</li>
</ul>
</li>
</ul>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-11
shortcode-codeblock-plaintext">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-93c59500be2a43014473d1bcc1d87a13" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-plaintext" data-lang="plaintext"><span class="line"><span class="cl">interface Tunnel0
</span></span><span class="line"><span class="cl">  ip address 10.255.255.2 255.255.255.0
</span></span><span class="line"><span class="cl">  tunnel source 2.2.2.2
</span></span><span class="line"><span class="cl">  tunnel destination 1.1.1.1
</span></span><span class="line"><span class="cl">  tunnel protection ipsec profile GRE-STS</span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-93c59500be2a43014473d1bcc1d87a13"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<ul>
<li>Прописываем маршрут до удалённого роутера <code>R1</code>:
<ul>
<li>Сеть удалённого роутера <code>R1</code>: <code>10.1.0.0</code>.</li>
<li>Маска подсети удалённого роутера <code>R1</code>: <code>255.255.0.0</code>.</li>
<li>IP-адрес шлюза удалённого роутера <code>R1</code>: <code>10.255.255.1</code>.</li>
</ul>
</li>
</ul>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-12
shortcode-codeblock-plaintext">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-085405be2dbd0291cb85af5f8332a2ed" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-plaintext" data-lang="plaintext"><span class="line"><span class="cl">ip route 10.1.0.0 255.255.0.0 10.255.255.1</span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-085405be2dbd0291cb85af5f8332a2ed"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<ul>
<li>Настройка <span class="shortcode shortcode-tag"><a href="/ru/tags/ospf/" target="_blank">#OSPF</a></span>:
<ul>
<li>Указание ID маршрутизатора: <code>router-id 10.2.0.1</code>.</li>
<li>Отключение HELLO-пакетов на всех интерфейсах: <code>passive-interface default</code>.</li>
<li>Включение HELLO-пакетов на интерфейсе <code>Tunnel0</code>: <code>no passive-interface Tunnel0</code>.</li>
<li>Анонсирование сети <code>10.1.0.0/16</code> в <span class="shortcode shortcode-tag"><a href="/ru/tags/ospf/" target="_blank">#OSPF</a></span>: <code>network 10.2.0.0 0.0.255.255 area 0</code>.</li>
</ul>
</li>
</ul>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-13
shortcode-codeblock-plaintext">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-229bb4f5087fbe26900833d0f6d1afbc" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-plaintext" data-lang="plaintext"><span class="line"><span class="cl">router ospf 5
</span></span><span class="line"><span class="cl">  router-id 10.2.0.1
</span></span><span class="line"><span class="cl">  passive-interface default
</span></span><span class="line"><span class="cl">  no passive-interface Tunnel0
</span></span><span class="line"><span class="cl">  network 10.2.0.0 0.0.255.255 area 0</span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-229bb4f5087fbe26900833d0f6d1afbc"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>]]></turbo:content></item><item turbo="true"><title>Cisco: Базовая настройка</title><link>https://lib.onl/ru/2024/04/8caf49e3-8f13-5145-90ab-8ba1f2cb1c37/</link><pubDate>Thu, 25 Apr 2024 19:16:43 +0000</pubDate><dc:creator>Kai Kimera</dc:creator><category>В доработке</category><category>Сеть</category><yandex:related><link url="https://lib.onl/ru/2024/05/7b3bb6b3-c7db-550c-abf6-9d88c66a8a74/">Cisco: Туннель GRE/IPsec (Site-to-Site) + OSPF</link><link url="https://lib.onl/ru/2024/03/b81f9cca-d723-5b72-929a-b88be9d329f9/">Cisco: Обновление IOS</link><link url="https://lib.onl/ru/2024/04/9538d25f-c145-5a84-8583-65f3a2ed4c84/">Cisco: Установка лицензий</link><link url="https://lib.onl/ru/2024/03/4a7addb9-eff3-5482-902c-791fbe49899f/">Cisco: Загрузка и выгрузка конфигурации</link><link url="https://lib.onl/ru/2024/03/fc67eb74-8f7c-5de3-bd1e-2d823208eae2/">Cisco: Сброс пароля</link></yandex:related><turbo:extendedHtml>true</turbo:extendedHtml><turbo:source>https://lib.onl/ru/2024/04/8caf49e3-8f13-5145-90ab-8ba1f2cb1c37/</turbo:source><turbo:topic>Cisco: Базовая настройка</turbo:topic><turbo:content><![CDATA[<p>Представлю базовый конфигурационный файл для маршрутизатора <span class="shortcode shortcode-tag"><a href="/ru/tags/cisco/" target="_blank">#Cisco</a></span>. При помощи него можно быстро запустить маршрутизатор, предварительно подставив свои значения.</p>
<h2 id="параметры-конфигурации">
  <a class="link-body-emphasis" href="#%d0%bf%d0%b0%d1%80%d0%b0%d0%bc%d0%b5%d1%82%d1%80%d1%8b-%d0%ba%d0%be%d0%bd%d1%84%d0%b8%d0%b3%d1%83%d1%80%d0%b0%d1%86%d0%b8%d0%b8">Параметры конфигурации</a>
</h2><ul>
<li>Пароль администратора (<code>enable</code>): <code>qwerty-en</code>.</li>
<li>Пользователи:
<ul>
<li><code>admin:qwerty-admin</code>.</li>
</ul>
</li>
<li>Интерфейсы:
<ul>
<li><code>FastEthernet0/0</code>:
<ul>
<li>IP: <code>DHCP</code>.</li>
</ul>
</li>
<li><code>FastEthernet0/1</code>:
<ul>
<li>IP: <code>10.88.0.1/16</code>.</li>
</ul>
</li>
<li><code>Loopback0</code>:
<ul>
<li>IP: <code>10.90.10.1/32</code>.</li>
</ul>
</li>
<li><code>Loopback1</code>:
<ul>
<li>IP: <code>10.90.20.1/32</code>.</li>
</ul>
</li>
</ul>
</li>
<li>Локальная сеть:
<ul>
<li>Маска: <code>10.88.0.0/16</code>.</li>
<li>Домен: <code>home.lan</code>.</li>
</ul>
</li>
</ul>
<h3 id="сервисы">
  <a class="link-body-emphasis" href="#%d1%81%d0%b5%d1%80%d0%b2%d0%b8%d1%81%d1%8b">Сервисы</a>
</h3><ul>
<li><code>service password-encryption</code> - включить шифрования паролей в консоли, терминале и конфигурации.</li>
<li><code>service timestamps debug datetime msec localtime show-timezone</code> - установить местное время в режиме отладки.</li>
<li><code>service timestamps log datetime msec localtime show-timezone</code> - установить местное время в режиме логирования.</li>
<li><code>service tcp-keepalives-in</code> и <code>service tcp-keepalives-out</code> - включить поддержку активности сеансов TCP для входящих и исходящих подключений. Эти параметры позволяют проверять доступность удалённого устройства при помощи специальных keepalive-пакетов, а полуоткрытые и потерянные соединения убудут удалены с локального устройства Cisco.</li>
<li><code>service sequence-numbers</code> - включить нумерование сообщений при логировании событий. Параметр позволяет выяснить потерянные сообщения из-за <code>rate-limit</code> на Cisco или когда эти сообщения передаются по сети с использованием syslog по протоколу UDP.</li>
<li><code>no service pad</code> - отключить сервис PAD (X.25).</li>
<li><code>no service udp-small-servers</code> и <code>no service tcp-small-servers</code> - отключить использование небольших TCP &amp; UDP серверов.</li>
<li><code>no service finger</code> - отключить протокол Finger.</li>
</ul>
<h3 id="основные-настройки">
  <a class="link-body-emphasis" href="#%d0%be%d1%81%d0%bd%d0%be%d0%b2%d0%bd%d1%8b%d0%b5-%d0%bd%d0%b0%d1%81%d1%82%d1%80%d0%be%d0%b9%d0%ba%d0%b8">Основные настройки</a>
</h3><ul>
<li><code>clock timezone UTC 3</code> и <code>clock update-calendar</code> - установить часовой пояс <code>+3</code> и обновить встроенные часы Cisco согласно пользовательским настройкам.</li>
<li><code>hostname gw1</code> - установить имя хоста в Cisco.</li>
<li><code>logging buffered 4096</code> - зарезервировать в оперативной памяти 4096 КБ для записи логов. При заполнении буфера, старые сообщения будут перезаписаны новыми.</li>
<li><code>logging console critical</code> - включить отображение в консоли (RS-232) только критических сообщений.</li>
<li><code>ip cef</code> - включить Cisco Express Forwarding (CEF). Cisco Express Forwarding (CEF) - технология высокоскоростной маршрутизации/коммутации пакетов, использующаяся в маршрутизаторах и коммутаторах третьего уровня фирмы Cisco Systems, и позволяющая добиться более быстрой и эффективной обработки транзитного трафика.</li>
<li><code>ip multicast-routing</code> - включить пересылку multicast-пакетов.</li>
<li><code>ip tcp path-mtu-discovery</code> - включить функцию обнаружения пути TCP MTU для соединений TCP, инициированных маршрутизаторами (например, BGP и Telnet).</li>
<li><code>ip tcp selective-ack</code> - повысить производительность TCP на каналах, где есть потери пакетов. Если в пределах окна было потеряно несколько пакетов, SACK позволяет повторно отправить только потерянные пакеты, а не все пакеты. <a title="" href="http://www.ietf.org/rfc/rfc2018.txt" target="_blank"
   rel="noopener noreferrer">RFC2018</a>.</li>
<li><code>ip tcp timestamp</code> - включить более точное измерение RTT для повышения производительности TCP. <a title="" href="http://www.ietf.org/rfc/rfc1323.txt" target="_blank"
   rel="noopener noreferrer">RFC1323</a>.</li>
<li><code>no ip source-route</code> - отключить функцию указания отдельными пакетами маршрута. В современных сетях эта функция не используется и является небезопасной.</li>
<li><code>no ip bootp server</code> - отключить Bootstrap Protocol (BOOTP). BootP это сетевой протокол прикладного уровня, используемый для автоматического получения клиентом IP-адреса.</li>
<li><code>memory reserve critical 4096</code> - зарезервировать в оперативной памяти 4096 КБ для отображения критических уведомлений. Этот объём памяти не может превышать 25% от общего объёма оперативной памяти. По умолчанию: 100 КБ.</li>
<li><code>memory reserve console 512</code> - зарезервировать в оперативной памяти 512 КБ для доступа к консоли. Увеличение памяти обеспечивает доступ к консоли для устранения неполадок или других административных задач и поддерживает оптимальный уровень производительности. По умолчанию: 256 КБ.</li>
</ul>
<h3 id="аккаунты">
  <a class="link-body-emphasis" href="#%d0%b0%d0%ba%d0%ba%d0%b0%d1%83%d0%bd%d1%82%d1%8b">Аккаунты</a>
</h3><ul>
<li><code>aaa new-model</code> - включение новой модели системы аутентификации авторизации и учета событий, встроенная в операционную систему <span class="shortcode shortcode-tag"><a href="/ru/tags/cisco/" target="_blank">#Cisco</a></span> IOS.</li>
<li><code>aaa authentication login default local</code> - база логинов и паролей хранится на устройстве <span class="shortcode shortcode-tag"><a href="/ru/tags/cisco/" target="_blank">#Cisco</a></span>.</li>
<li><code>aaa authentication ppp default local</code> - локальная аутентификация для сеансов PPP.</li>
<li><code>enable password qwerty-en</code> - пароль для режима <code>enable</code>.</li>
<li><code>username admin privilege 15 password qwerty-admin</code> - добавление нового пользователя <code>admin</code>.
<ul>
<li><code>admin</code> - имя нового пользователя.</li>
<li><code>privilege 15</code> - уровень привилегий (15 - максимальный).</li>
<li><code>qwerty-admin</code> - пароль нового пользователя.</li>
</ul>
</li>
</ul>
<h3 id="терминал">
  <a class="link-body-emphasis" href="#%d1%82%d0%b5%d1%80%d0%bc%d0%b8%d0%bd%d0%b0%d0%bb">Терминал</a>
</h3><ul>
<li><code>line con 0</code>
<ul>
<li><code>logging synchronous</code></li>
<li><code>exec-timeout 60 0</code></li>
</ul>
</li>
<li><code>line vty 0 4</code>
<ul>
<li><code>access-class ACL_VTY in</code></li>
<li><code>logging synchronous</code></li>
<li><code>privilege level 15</code></li>
<li><code>transport input telnet ssh</code></li>
<li><code>exec-timeout 60 0</code></li>
</ul>
</li>
<li><code>line aux 0</code>
<ul>
<li><code>transport input none</code></li>
<li><code>transport output none</code></li>
<li><code>no exec</code></li>
<li><code>exec-timeout 0 1</code></li>
<li><code>no password</code></li>
</ul>
</li>
</ul>
<h3 id="ssh">
  <a class="link-body-emphasis" href="#ssh">SSH</a>
</h3><ul>
<li><code>ip ssh authentication-retries 5</code> - установить 5 попыток аутентификации на локальном SSH-сервере Cisco.</li>
<li><code>ip ssh version 2</code> - явно указать использование SSH версии 2.</li>
</ul>
<h3 id="snmp">
  <a class="link-body-emphasis" href="#snmp">SNMP</a>
</h3><ul>
<li><code>snmp-server community CISCO_ID ro ACL_SNMP_RO</code> - разрешить хостам из <code>ACL_SNMP_RO</code> получать информацию от SNMP-сервера Cisco с идентификатором <code>CISCO_ID</code>.
<ul>
<li><code>CISCO_ID</code> - идентификатор SNMP Cisco.</li>
<li><code>ro</code> - доступ только на чтение.</li>
<li><code>ACL_SNMP_RO</code> - лист доступа для подключения к SNMP Cisco.</li>
</ul>
</li>
<li><code>snmp-server location Petrovka 37, 2 floor, room 220</code> - указать информацию по местонахождению устройства в SNMP-сервере Cisco.
<ul>
<li><code>Petrovka 37, 2 floor, room 220</code> - адрес устройства Cisco.</li>
</ul>
</li>
<li><code>snmp-server contact mail@example.com</code> - указать контактную информацию в SNMP-сервере Cisco.
<ul>
<li><code>mail@example.com</code> - контактный адрес электронной почты.</li>
</ul>
</li>
</ul>
<h3 id="интерфейсы">
  <a class="link-body-emphasis" href="#%d0%b8%d0%bd%d1%82%d0%b5%d1%80%d1%84%d0%b5%d0%b9%d1%81%d1%8b">Интерфейсы</a>
</h3><ul>
<li><code>interface FastEthernet0/0</code> - внешний интерфейс <code>FastEthernet0/0</code>.
<ul>
<li><code>ip address dhcp</code> - включение получения IP-адреса от DHCP-сервера.</li>
<li><code>ip nat outside</code> - определение интерфейса в качестве внешнего.</li>
</ul>
</li>
<li><code>interface FastEthernet0/1</code> - внутренний интерфейс <code>FastEthernet0/1</code>.
<ul>
<li><code>ip address 10.88.0.1 255.255.0.0</code> - IP-адрес интерфейса и маска подсети.</li>
<li><code>ip nat inside</code> - определение интерфейса в качестве внутреннего.</li>
</ul>
</li>
<li><code>interface Loopback0</code> - loopback-интерфейс <code>Loopback0</code>.
<ul>
<li><code>ip address 10.90.10.1 255.255.255.255</code> - IP-адрес интерфейса и маска подсети.</li>
</ul>
</li>
<li><code>interface Loopback1</code> - loopback-интерфейс <code>Loopback1</code>.
<ul>
<li><code>ip address 10.90.20.1 255.255.255.255</code> - IP-адрес интерфейса и маска подсети.</li>
</ul>
</li>
<li><code>no ip http server</code> - отключить встроенный HTTP-сервер.</li>
<li><code>no ip http secure-server</code> - отключить встроенный HTTPS-сервер.</li>
</ul>
<h3 id="ntp">
  <a class="link-body-emphasis" href="#ntp">NTP</a>
</h3><ul>
<li><code>ntp update-calendar</code> - обновить встроенные часы Cisco согласно настройкам NTP.</li>
<li><code>ntp server 194.190.168.1</code> - сервер NTP.
<ul>
<li><code>194.190.168.1</code> - IP-адрес сервера NTP.</li>
</ul>
</li>
</ul>
<h3 id="dns">
  <a class="link-body-emphasis" href="#dns">DNS</a>
</h3><ul>
<li><code>ip domain timeout 2</code> - число попыток отрезолвить хост.</li>
<li><code>ip domain name home.lan</code> - имя домена по умолчанию. Используется для определения имени домена, которое будет использоваться для дополнения неполных имен хостов (имен, состоящих только из имени хоста).</li>
<li><code>ip name-server 1.1.1.1</code> - внешний DNS-сервер #1.
<ul>
<li><code>1.1.1.1</code> - IP-адрес внешнего DNS-сервера #1.</li>
</ul>
</li>
<li><code>ip name-server 8.8.8.8</code> - внешний DNS-сервер #1.
<ul>
<li><code>8.8.8.8</code> - IP-адрес внешнего DNS-сервера #2.</li>
</ul>
</li>
<li><code>ip dns server</code> - включить локальный DNS-сервер Cisco.</li>
</ul>
<h3 id="dhcp">
  <a class="link-body-emphasis" href="#dhcp">DHCP</a>
</h3><ul>
<li><code>service dhcp FastEthernet0/1</code> - включить локальный DHCP-сервер только на интерфейсе <code>FastEthernet0/1</code>.</li>
<li><code>ip dhcp excluded-address 10.88.0.1</code> - исключить адрес <code>10.88.0.1</code> из пула адресов локального DHCP-сервера.</li>
<li><code>ip dhcp excluded-address 10.88.0.2 10.88.200.0</code> - исключить диапазон от <code>10.88.0.2</code> до <code>10.88.200.0</code> из пула адресов локального DHCP-сервера.</li>
<li><code>ip dhcp pool LAN</code> - конфигурация локального DHCP-сервера.
<ul>
<li><code>network 10.88.0.0 255.255.0.0</code> - адрес локальной сети.</li>
<li><code>default-router 10.88.0.1</code> - шлюз по умолчанию.</li>
<li><code>domain-name home.lan</code> - домен локальной сети.</li>
<li><code>dns-server 10.88.0.1</code> - DNS-сервер локальной сети.</li>
</ul>
</li>
</ul>
<h3 id="nat">
  <a class="link-body-emphasis" href="#nat">NAT</a>
</h3><ul>
<li><code>ip nat inside source route-map MAP_ETH_00 interface FastEthernet0/0 overload</code></li>
</ul>
<h3 id="листы-доступа">
  <a class="link-body-emphasis" href="#%d0%bb%d0%b8%d1%81%d1%82%d1%8b-%d0%b4%d0%be%d1%81%d1%82%d1%83%d0%bf%d0%b0">Листы доступа</a>
</h3><ul>
<li><code>ip access-list standard ACL_VTY</code> - список хостов для доступа к терминалу.</li>
<li><code>ip access-list standard ACL_NAT</code> - список хостов за NAT. Разрешить эти адреса из локальной сети транслировать во внешний мир.</li>
</ul>
<h2 id="скрипт-конфигурации">
  <a class="link-body-emphasis" href="#%d1%81%d0%ba%d1%80%d0%b8%d0%bf%d1%82-%d0%ba%d0%be%d0%bd%d1%84%d0%b8%d0%b3%d1%83%d1%80%d0%b0%d1%86%d0%b8%d0%b8">Скрипт конфигурации</a>
</h2>
    

    
        
            
            <div class="shortcode shortcode-file mb-3">
              <div class="card overflow-hidden" data-bs-theme="dark">
                <div class="card-header">
                  <div class="d-flex align-items-center">
                    <div class="flex-shrink-0">
                      <i class="far fa-file-code fa-fw"></i>
                    </div>
                    <div class="flex-grow-1 mx-2 text-truncate">
                      <code>cisco.router.ios</code>
                    </div>
                    <div class="flex-shrink-0">
                      <ul class="list-inline mb-0">
                        <li class="list-inline-item" title='Копировать'>
                          <a class="text-body" href="#"
                             data-fn="clipboard" data-clipboard-target="#cp-f2fae4fa6c02b4041342d82b120a7899"
                             role="button" aria-label='Копировать'>
                            <i class="fas fa-copy fa-fw"></i>
                          </a>
                        </li>
                        <li class="list-inline-item" title='Скачать'>
                          <a class="text-body" href="/ru/2024/04/8caf49e3-8f13-5145-90ab-8ba1f2cb1c37/cisco.router.ios" download
                             role="button" aria-label='Скачать'>
                            <i class="fas fa-download fa-fw"></i>
                          </a>
                        </li>
                        <li class="list-inline-item" title='Открыть'>
                          <a class="text-body" href="/ru/2024/04/8caf49e3-8f13-5145-90ab-8ba1f2cb1c37/cisco.router.ios" target="_blank"
                             role="button" aria-label='Открыть'>
                            <i class="fas fa-arrow-up-right-from-square fa-fw"></i>
                          </a>
                        </li>
                      </ul>
                    </div>
                  </div>
                </div>
                <div class="card-body p-0 overflow-auto" id="cp-f2fae4fa6c02b4041342d82b120a7899">
                    
                    <div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">  1
</span><span class="lnt">  2
</span><span class="lnt">  3
</span><span class="lnt">  4
</span><span class="lnt">  5
</span><span class="lnt">  6
</span><span class="lnt">  7
</span><span class="lnt">  8
</span><span class="lnt">  9
</span><span class="lnt"> 10
</span><span class="lnt"> 11
</span><span class="lnt"> 12
</span><span class="lnt"> 13
</span><span class="lnt"> 14
</span><span class="lnt"> 15
</span><span class="lnt"> 16
</span><span class="lnt"> 17
</span><span class="lnt"> 18
</span><span class="lnt"> 19
</span><span class="lnt"> 20
</span><span class="lnt"> 21
</span><span class="lnt"> 22
</span><span class="lnt"> 23
</span><span class="lnt"> 24
</span><span class="lnt"> 25
</span><span class="lnt"> 26
</span><span class="lnt"> 27
</span><span class="lnt"> 28
</span><span class="lnt"> 29
</span><span class="lnt"> 30
</span><span class="lnt"> 31
</span><span class="lnt"> 32
</span><span class="lnt"> 33
</span><span class="lnt"> 34
</span><span class="lnt"> 35
</span><span class="lnt"> 36
</span><span class="lnt"> 37
</span><span class="lnt"> 38
</span><span class="lnt"> 39
</span><span class="lnt"> 40
</span><span class="lnt"> 41
</span><span class="lnt"> 42
</span><span class="lnt"> 43
</span><span class="lnt"> 44
</span><span class="lnt"> 45
</span><span class="lnt"> 46
</span><span class="lnt"> 47
</span><span class="lnt"> 48
</span><span class="lnt"> 49
</span><span class="lnt"> 50
</span><span class="lnt"> 51
</span><span class="lnt"> 52
</span><span class="lnt"> 53
</span><span class="lnt"> 54
</span><span class="lnt"> 55
</span><span class="lnt"> 56
</span><span class="lnt"> 57
</span><span class="lnt"> 58
</span><span class="lnt"> 59
</span><span class="lnt"> 60
</span><span class="lnt"> 61
</span><span class="lnt"> 62
</span><span class="lnt"> 63
</span><span class="lnt"> 64
</span><span class="lnt"> 65
</span><span class="lnt"> 66
</span><span class="lnt"> 67
</span><span class="lnt"> 68
</span><span class="lnt"> 69
</span><span class="lnt"> 70
</span><span class="lnt"> 71
</span><span class="lnt"> 72
</span><span class="lnt"> 73
</span><span class="lnt"> 74
</span><span class="lnt"> 75
</span><span class="lnt"> 76
</span><span class="lnt"> 77
</span><span class="lnt"> 78
</span><span class="lnt"> 79
</span><span class="lnt"> 80
</span><span class="lnt"> 81
</span><span class="lnt"> 82
</span><span class="lnt"> 83
</span><span class="lnt"> 84
</span><span class="lnt"> 85
</span><span class="lnt"> 86
</span><span class="lnt"> 87
</span><span class="lnt"> 88
</span><span class="lnt"> 89
</span><span class="lnt"> 90
</span><span class="lnt"> 91
</span><span class="lnt"> 92
</span><span class="lnt"> 93
</span><span class="lnt"> 94
</span><span class="lnt"> 95
</span><span class="lnt"> 96
</span><span class="lnt"> 97
</span><span class="lnt"> 98
</span><span class="lnt"> 99
</span><span class="lnt">100
</span><span class="lnt">101
</span><span class="lnt">102
</span><span class="lnt">103
</span><span class="lnt">104
</span><span class="lnt">105
</span><span class="lnt">106
</span><span class="lnt">107
</span><span class="lnt">108
</span><span class="lnt">109
</span><span class="lnt">110
</span><span class="lnt">111
</span><span class="lnt">112
</span><span class="lnt">113
</span><span class="lnt">114
</span><span class="lnt">115
</span><span class="lnt">116
</span><span class="lnt">117
</span><span class="lnt">118
</span><span class="lnt">119
</span><span class="lnt">120
</span><span class="lnt">121
</span><span class="lnt">122
</span><span class="lnt">123
</span><span class="lnt">124
</span><span class="lnt">125
</span><span class="lnt">126
</span><span class="lnt">127
</span><span class="lnt">128
</span><span class="lnt">129
</span><span class="lnt">130
</span><span class="lnt">131
</span><span class="lnt">132
</span><span class="lnt">133
</span><span class="lnt">134
</span><span class="lnt">135
</span><span class="lnt">136
</span><span class="lnt">137
</span><span class="lnt">138
</span><span class="lnt">139
</span><span class="lnt">140
</span><span class="lnt">141
</span><span class="lnt">142
</span><span class="lnt">143
</span><span class="lnt">144
</span><span class="lnt">145
</span><span class="lnt">146
</span><span class="lnt">147
</span><span class="lnt">148
</span><span class="lnt">149
</span><span class="lnt">150
</span><span class="lnt">151
</span><span class="lnt">152
</span><span class="lnt">153
</span><span class="lnt">154
</span><span class="lnt">155
</span><span class="lnt">156
</span><span class="lnt">157
</span><span class="lnt">158
</span><span class="lnt">159
</span><span class="lnt">160
</span><span class="lnt">161
</span><span class="lnt">162
</span><span class="lnt">163
</span><span class="lnt">164
</span><span class="lnt">165
</span><span class="lnt">166
</span><span class="lnt">167
</span><span class="lnt">168
</span><span class="lnt">169
</span><span class="lnt">170
</span><span class="lnt">171
</span><span class="lnt">172
</span><span class="lnt">173
</span><span class="lnt">174
</span><span class="lnt">175
</span><span class="lnt">176
</span><span class="lnt">177
</span><span class="lnt">178
</span><span class="lnt">179
</span><span class="lnt">180
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-properties" data-lang="properties"><span class="line"><span class="cl"><span class="c1">! @package    Cisco / IOS</span>
</span></span><span class="line"><span class="cl"><span class="c1">! @author     Kai Kimera &lt;mail@kai.kim&gt;</span>
</span></span><span class="line"><span class="cl"><span class="c1">! @copyright  2024 Library Online</span>
</span></span><span class="line"><span class="cl"><span class="c1">! @license    MIT</span>
</span></span><span class="line"><span class="cl"><span class="c1">! @version    0.1.0</span>
</span></span><span class="line"><span class="cl"><span class="c1">! @link       https://lib.onl/ru/2024/04/8caf49e3-8f13-5145-90ab-8ba1f2cb1c37/</span>
</span></span><span class="line"><span class="cl"><span class="c1">! -------------------------------------------------------------------------------------------------------------------- !</span>
</span></span><span class="line"><span class="cl"><span class="c1">!</span>
</span></span><span class="line"><span class="cl"><span class="c1">! -------------------------------------------------------------------------------------------------------------------- !</span>
</span></span><span class="line"><span class="cl"><span class="c1">! SERVICES.</span>
</span></span><span class="line"><span class="cl"><span class="c1">! -------------------------------------------------------------------------------------------------------------------- !</span>
</span></span><span class="line"><span class="cl"><span class="na">service</span> <span class="s">password-encryption</span>
</span></span><span class="line"><span class="cl"><span class="na">service</span> <span class="s">timestamps debug datetime msec localtime show-timezone</span>
</span></span><span class="line"><span class="cl"><span class="na">service</span> <span class="s">timestamps log datetime msec localtime show-timezone</span>
</span></span><span class="line"><span class="cl"><span class="na">service</span> <span class="s">tcp-keepalives-in</span>
</span></span><span class="line"><span class="cl"><span class="na">service</span> <span class="s">tcp-keepalives-out</span>
</span></span><span class="line"><span class="cl"><span class="na">service</span> <span class="s">sequence-numbers</span>
</span></span><span class="line"><span class="cl"><span class="na">no</span> <span class="s">service pad</span>
</span></span><span class="line"><span class="cl"><span class="na">no</span> <span class="s">service udp-small-servers</span>
</span></span><span class="line"><span class="cl"><span class="na">no</span> <span class="s">service tcp-small-servers</span>
</span></span><span class="line"><span class="cl"><span class="na">no</span> <span class="s">service finger</span>
</span></span><span class="line"><span class="cl"><span class="c1">! -------------------------------------------------------------------------------------------------------------------- !</span>
</span></span><span class="line"><span class="cl"><span class="c1">! GENERAL.</span>
</span></span><span class="line"><span class="cl"><span class="c1">! -------------------------------------------------------------------------------------------------------------------- !</span>
</span></span><span class="line"><span class="cl"><span class="na">clock</span> <span class="s">timezone UTC 3</span>
</span></span><span class="line"><span class="cl"><span class="c1">!clock update-calendar</span>
</span></span><span class="line"><span class="cl"><span class="na">hostname</span> <span class="s">gw1</span>
</span></span><span class="line"><span class="cl"><span class="na">logging</span> <span class="s">buffered 4096</span>
</span></span><span class="line"><span class="cl"><span class="na">logging</span> <span class="s">console critical</span>
</span></span><span class="line"><span class="cl"><span class="na">ip</span> <span class="s">cef</span>
</span></span><span class="line"><span class="cl"><span class="na">ip</span> <span class="s">multicast-routing</span>
</span></span><span class="line"><span class="cl"><span class="na">ip</span> <span class="s">tcp path-mtu-discovery</span>
</span></span><span class="line"><span class="cl"><span class="na">ip</span> <span class="s">tcp selective-ack</span>
</span></span><span class="line"><span class="cl"><span class="na">ip</span> <span class="s">tcp timestamp</span>
</span></span><span class="line"><span class="cl"><span class="na">no</span> <span class="s">ip source-route</span>
</span></span><span class="line"><span class="cl"><span class="na">no</span> <span class="s">ip bootp server</span>
</span></span><span class="line"><span class="cl"><span class="na">memory</span> <span class="s">reserve critical 4096</span>
</span></span><span class="line"><span class="cl"><span class="c1">!memory reserve console 512</span>
</span></span><span class="line"><span class="cl"><span class="c1">! -------------------------------------------------------------------------------------------------------------------- !</span>
</span></span><span class="line"><span class="cl"><span class="c1">! Authentication, Authorization, and Accounting (AAA).</span>
</span></span><span class="line"><span class="cl"><span class="c1">! -------------------------------------------------------------------------------------------------------------------- !</span>
</span></span><span class="line"><span class="cl"><span class="na">aaa</span> <span class="s">new-model</span>
</span></span><span class="line"><span class="cl"><span class="na">aaa</span> <span class="s">authentication login default local</span>
</span></span><span class="line"><span class="cl"><span class="na">aaa</span> <span class="s">authentication ppp default local</span>
</span></span><span class="line"><span class="cl"><span class="na">enable</span> <span class="s">password qwerty-en</span>
</span></span><span class="line"><span class="cl"><span class="na">username</span> <span class="s">admin privilege 15 password qwerty-admin</span>
</span></span><span class="line"><span class="cl"><span class="c1">! -------------------------------------------------------------------------------------------------------------------- !</span>
</span></span><span class="line"><span class="cl"><span class="c1">! LOGIN.</span>
</span></span><span class="line"><span class="cl"><span class="c1">! -------------------------------------------------------------------------------------------------------------------- !</span>
</span></span><span class="line"><span class="cl"><span class="c1">!login block-for 60 attempts 3 within 10</span>
</span></span><span class="line"><span class="cl"><span class="c1">!login delay 5</span>
</span></span><span class="line"><span class="cl"><span class="c1">!login quiet-mode access-class 10</span>
</span></span><span class="line"><span class="cl"><span class="c1">!login on-failure log every 5</span>
</span></span><span class="line"><span class="cl"><span class="c1">!login on-success log every 3</span>
</span></span><span class="line"><span class="cl"><span class="c1">! -------------------------------------------------------------------------------------------------------------------- !</span>
</span></span><span class="line"><span class="cl"><span class="c1">! TERMINAL.</span>
</span></span><span class="line"><span class="cl"><span class="c1">! -------------------------------------------------------------------------------------------------------------------- !</span>
</span></span><span class="line"><span class="cl"><span class="na">line</span> <span class="s">con 0</span>
</span></span><span class="line"><span class="cl">  <span class="na">logging</span> <span class="s">synchronous</span>
</span></span><span class="line"><span class="cl">  <span class="na">exec-timeout</span> <span class="s">60 0</span>
</span></span><span class="line"><span class="cl"><span class="na">line</span> <span class="s">vty 0 4</span>
</span></span><span class="line"><span class="cl">  <span class="na">access-class</span> <span class="s">ACL_VTY in</span>
</span></span><span class="line"><span class="cl">  <span class="na">logging</span> <span class="s">synchronous</span>
</span></span><span class="line"><span class="cl">  <span class="na">privilege</span> <span class="s">level 15</span>
</span></span><span class="line"><span class="cl">  <span class="na">transport</span> <span class="s">input telnet ssh</span>
</span></span><span class="line"><span class="cl">  <span class="na">exec-timeout</span> <span class="s">60 0</span>
</span></span><span class="line"><span class="cl"><span class="na">line</span> <span class="s">aux 0</span>
</span></span><span class="line"><span class="cl">  <span class="na">transport</span> <span class="s">input none</span>
</span></span><span class="line"><span class="cl">  <span class="na">transport</span> <span class="s">output none</span>
</span></span><span class="line"><span class="cl">  <span class="na">no</span> <span class="s">exec</span>
</span></span><span class="line"><span class="cl">  <span class="na">exec-timeout</span> <span class="s">0 1</span>
</span></span><span class="line"><span class="cl">  <span class="na">no</span> <span class="s">password</span>
</span></span><span class="line"><span class="cl"><span class="c1">! -------------------------------------------------------------------------------------------------------------------- !</span>
</span></span><span class="line"><span class="cl"><span class="c1">! SSH.</span>
</span></span><span class="line"><span class="cl"><span class="c1">! Generate RSA key pairs for SSH Public-Key Authentication:</span>
</span></span><span class="line"><span class="cl"><span class="c1">! - crypto key generate rsa modulus 2048</span>
</span></span><span class="line"><span class="cl"><span class="c1">! -------------------------------------------------------------------------------------------------------------------- !</span>
</span></span><span class="line"><span class="cl"><span class="na">ip</span> <span class="s">ssh authentication-retries 5</span>
</span></span><span class="line"><span class="cl"><span class="na">ip</span> <span class="s">ssh version 2</span>
</span></span><span class="line"><span class="cl"><span class="c1">! -------------------------------------------------------------------------------------------------------------------- !</span>
</span></span><span class="line"><span class="cl"><span class="c1">! SNMP server.</span>
</span></span><span class="line"><span class="cl"><span class="c1">! -------------------------------------------------------------------------------------------------------------------- !</span>
</span></span><span class="line"><span class="cl"><span class="na">snmp-server</span> <span class="s">community CISCO_ID ro ACL_SNMP_RO</span>
</span></span><span class="line"><span class="cl"><span class="na">snmp-server</span> <span class="s">location Petrovka 37, 2 floor, room 220</span>
</span></span><span class="line"><span class="cl"><span class="na">snmp-server</span> <span class="s">contact mail@example.com</span>
</span></span><span class="line"><span class="cl"><span class="c1">!</span>
</span></span><span class="line"><span class="cl"><span class="na">ip</span> <span class="s">access-list standard ACL_SNMP_RO</span>
</span></span><span class="line"><span class="cl">  <span class="na">remark</span> <span class="s">Hosts permitted to read SNMP MIBs.</span>
</span></span><span class="line"><span class="cl">  <span class="na">permit</span> <span class="s">host 10.88.10.22</span>
</span></span><span class="line"><span class="cl"><span class="c1">! -------------------------------------------------------------------------------------------------------------------- !</span>
</span></span><span class="line"><span class="cl"><span class="c1">! INTERFACES.</span>
</span></span><span class="line"><span class="cl"><span class="c1">! -------------------------------------------------------------------------------------------------------------------- !</span>
</span></span><span class="line"><span class="cl"><span class="na">interface</span> <span class="s">FastEthernet0/0</span>
</span></span><span class="line"><span class="cl">  <span class="na">ip</span> <span class="s">address dhcp</span>
</span></span><span class="line"><span class="cl">  <span class="na">ip</span> <span class="s">nat outside</span>
</span></span><span class="line"><span class="cl"><span class="na">interface</span> <span class="s">FastEthernet0/1</span>
</span></span><span class="line"><span class="cl">  <span class="na">ip</span> <span class="s">address 10.88.0.1 255.255.0.0</span>
</span></span><span class="line"><span class="cl">  <span class="na">ip</span> <span class="s">nat inside</span>
</span></span><span class="line"><span class="cl"><span class="na">interface</span> <span class="s">Loopback0</span>
</span></span><span class="line"><span class="cl">  <span class="na">ip</span> <span class="s">address 10.90.10.1 255.255.255.255</span>
</span></span><span class="line"><span class="cl"><span class="na">interface</span> <span class="s">Loopback1</span>
</span></span><span class="line"><span class="cl">  <span class="na">ip</span> <span class="s">address 10.90.20.1 255.255.255.255</span>
</span></span><span class="line"><span class="cl"><span class="na">no</span> <span class="s">ip http server</span>
</span></span><span class="line"><span class="cl"><span class="na">no</span> <span class="s">ip http secure-server</span>
</span></span><span class="line"><span class="cl"><span class="c1">! -------------------------------------------------------------------------------------------------------------------- !</span>
</span></span><span class="line"><span class="cl"><span class="c1">! NTP.</span>
</span></span><span class="line"><span class="cl"><span class="c1">! -------------------------------------------------------------------------------------------------------------------- !</span>
</span></span><span class="line"><span class="cl"><span class="na">ntp</span> <span class="s">update-calendar</span>
</span></span><span class="line"><span class="cl"><span class="na">ntp</span> <span class="s">server 194.190.168.1</span>
</span></span><span class="line"><span class="cl"><span class="c1">! -------------------------------------------------------------------------------------------------------------------- !</span>
</span></span><span class="line"><span class="cl"><span class="c1">! DNS.</span>
</span></span><span class="line"><span class="cl"><span class="c1">! -------------------------------------------------------------------------------------------------------------------- !</span>
</span></span><span class="line"><span class="cl"><span class="na">ip</span> <span class="s">domain timeout 2</span>
</span></span><span class="line"><span class="cl"><span class="na">ip</span> <span class="s">domain name home.lan</span>
</span></span><span class="line"><span class="cl"><span class="na">ip</span> <span class="s">name-server 1.1.1.1</span>
</span></span><span class="line"><span class="cl"><span class="na">ip</span> <span class="s">name-server 8.8.8.8</span>
</span></span><span class="line"><span class="cl"><span class="na">ip</span> <span class="s">dns server</span>
</span></span><span class="line"><span class="cl"><span class="c1">! -------------------------------------------------------------------------------------------------------------------- !</span>
</span></span><span class="line"><span class="cl"><span class="c1">! DHCP.</span>
</span></span><span class="line"><span class="cl"><span class="c1">! -------------------------------------------------------------------------------------------------------------------- !</span>
</span></span><span class="line"><span class="cl"><span class="na">service</span> <span class="s">dhcp FastEthernet0/1</span>
</span></span><span class="line"><span class="cl"><span class="na">ip</span> <span class="s">dhcp excluded-address 10.88.0.1</span>
</span></span><span class="line"><span class="cl"><span class="na">ip</span> <span class="s">dhcp excluded-address 10.88.0.2 10.88.200.0</span>
</span></span><span class="line"><span class="cl"><span class="na">ip</span> <span class="s">dhcp pool LAN</span>
</span></span><span class="line"><span class="cl">  <span class="na">network</span> <span class="s">10.88.0.0 255.255.0.0</span>
</span></span><span class="line"><span class="cl">  <span class="na">default-router</span> <span class="s">10.88.0.1</span>
</span></span><span class="line"><span class="cl">  <span class="na">domain-name</span> <span class="s">home.lan</span>
</span></span><span class="line"><span class="cl">  <span class="na">dns-server</span> <span class="s">10.88.0.1</span>
</span></span><span class="line"><span class="cl"><span class="c1">! -------------------------------------------------------------------------------------------------------------------- !</span>
</span></span><span class="line"><span class="cl"><span class="c1">! NAT.</span>
</span></span><span class="line"><span class="cl"><span class="c1">! -------------------------------------------------------------------------------------------------------------------- !</span>
</span></span><span class="line"><span class="cl"><span class="na">ip</span> <span class="s">nat inside source route-map RM_NAT_ISP0 interface FastEthernet0/0 overload</span>
</span></span><span class="line"><span class="cl"><span class="c1">!ip nat inside source route-map RM_NAT_ISP1 interface FastEthernet0/1 overload</span>
</span></span><span class="line"><span class="cl"><span class="c1">! -------------------------------------------------------------------------------------------------------------------- !</span>
</span></span><span class="line"><span class="cl"><span class="c1">! ACL.</span>
</span></span><span class="line"><span class="cl"><span class="c1">! -------------------------------------------------------------------------------------------------------------------- !</span>
</span></span><span class="line"><span class="cl"><span class="na">ip</span> <span class="s">access-list standard ACL_VTY</span>
</span></span><span class="line"><span class="cl">  <span class="na">remark</span> <span class="s">Hosts permitted to VTY.</span>
</span></span><span class="line"><span class="cl">  <span class="na">permit</span> <span class="s">10.0.0.0 0.255.255.255</span>
</span></span><span class="line"><span class="cl">  <span class="na">permit</span> <span class="s">172.16.0.0 0.15.255.255</span>
</span></span><span class="line"><span class="cl">  <span class="na">permit</span> <span class="s">192.168.0.0 0.0.255.255</span>
</span></span><span class="line"><span class="cl"><span class="na">ip</span> <span class="s">access-list standard ACL_NAT</span>
</span></span><span class="line"><span class="cl">  <span class="na">remark</span> <span class="s">Hosts permitted to NAT.</span>
</span></span><span class="line"><span class="cl">  <span class="na">permit</span> <span class="s">10.88.0.0 0.0.255.255</span>
</span></span><span class="line"><span class="cl"><span class="c1">! -------------------------------------------------------------------------------------------------------------------- !</span>
</span></span><span class="line"><span class="cl"><span class="c1">! ROUTE MAPS.</span>
</span></span><span class="line"><span class="cl"><span class="c1">! -------------------------------------------------------------------------------------------------------------------- !</span>
</span></span><span class="line"><span class="cl"><span class="c1">! Internet Service Provider #0.</span>
</span></span><span class="line"><span class="cl"><span class="na">route-map</span> <span class="s">RM_NAT_ISP0 permit 10</span>
</span></span><span class="line"><span class="cl">  <span class="na">match</span> <span class="s">ip address ACL_NAT</span>
</span></span><span class="line"><span class="cl">  <span class="na">match</span> <span class="s">interface FastEthernet0/0</span>
</span></span><span class="line"><span class="cl"><span class="c1">! Internet Service Provider #1.</span>
</span></span><span class="line"><span class="cl"><span class="c1">!route-map RM_NAT_ISP1 permit 20</span>
</span></span><span class="line"><span class="cl"><span class="c1">!  match ip address ACL_NAT</span>
</span></span><span class="line"><span class="cl"><span class="c1">!  match interface FastEthernet0/1</span>
</span></span><span class="line"><span class="cl"><span class="c1">! -------------------------------------------------------------------------------------------------------------------- !</span>
</span></span><span class="line"><span class="cl"><span class="c1">! SLA.</span>
</span></span><span class="line"><span class="cl"><span class="c1">! -------------------------------------------------------------------------------------------------------------------- !</span>
</span></span><span class="line"><span class="cl"><span class="na">ip</span> <span class="s">sla 100</span>
</span></span><span class="line"><span class="cl">  <span class="na">icmp-echo</span> <span class="s">8.8.8.8 source-interface FastEthernet0/0</span>
</span></span><span class="line"><span class="cl">  <span class="na">threshold</span> <span class="s">1000</span>
</span></span><span class="line"><span class="cl">  <span class="na">timeout</span> <span class="s">1000</span>
</span></span><span class="line"><span class="cl">  <span class="na">frequency</span> <span class="s">10</span>
</span></span><span class="line"><span class="cl"><span class="na">ip</span> <span class="s">sla schedule 100 life forever start-time now</span>
</span></span><span class="line"><span class="cl"><span class="na">ip</span> <span class="s">sla 101</span>
</span></span><span class="line"><span class="cl">  <span class="na">icmp-echo</span> <span class="s">77.88.8.8 source-interface FastEthernet0/0</span>
</span></span><span class="line"><span class="cl">  <span class="na">threshold</span> <span class="s">1000</span>
</span></span><span class="line"><span class="cl">  <span class="na">timeout</span> <span class="s">1000</span>
</span></span><span class="line"><span class="cl">  <span class="na">frequency</span> <span class="s">10</span>
</span></span><span class="line"><span class="cl"><span class="na">ip</span> <span class="s">sla schedule 101 life forever start-time now</span>
</span></span><span class="line"><span class="cl"><span class="c1">! -------------------------------------------------------------------------------------------------------------------- !</span>
</span></span><span class="line"><span class="cl"><span class="c1">! TRACKs.</span>
</span></span><span class="line"><span class="cl"><span class="c1">! -------------------------------------------------------------------------------------------------------------------- !</span>
</span></span><span class="line"><span class="cl"><span class="na">track</span> <span class="s">100 ip sla 100 reachability</span>
</span></span><span class="line"><span class="cl"><span class="na">track</span> <span class="s">101 ip sla 101 reachability</span>
</span></span><span class="line"><span class="cl"><span class="na">track</span> <span class="s">105 list boolean or</span>
</span></span><span class="line"><span class="cl">  <span class="na">object</span> <span class="s">100</span>
</span></span><span class="line"><span class="cl">  <span class="na">object</span> <span class="s">101</span>
</span></span><span class="line"><span class="cl"><span class="c1">!</span>
</span></span><span class="line"><span class="cl"><span class="na">end</span></span></span></code></pre></td></tr></table>
</div>
</div>
                </div>
              </div>
            </div>]]></turbo:content></item><item turbo="true"><title>Cisco: Установка лицензий</title><link>https://lib.onl/ru/2024/04/9538d25f-c145-5a84-8583-65f3a2ed4c84/</link><pubDate>Sat, 13 Apr 2024 19:45:46 +0000</pubDate><dc:creator>Kai Kimera</dc:creator><category>Сеть</category><category>Терминал</category><yandex:related><link url="https://lib.onl/ru/2024/03/b81f9cca-d723-5b72-929a-b88be9d329f9/">Cisco: Обновление IOS</link><link url="https://lib.onl/ru/2024/03/4a7addb9-eff3-5482-902c-791fbe49899f/">Cisco: Загрузка и выгрузка конфигурации</link><link url="https://lib.onl/ru/2024/03/fc67eb74-8f7c-5de3-bd1e-2d823208eae2/">Cisco: Сброс пароля</link></yandex:related><turbo:extendedHtml>true</turbo:extendedHtml><turbo:source>https://lib.onl/ru/2024/04/9538d25f-c145-5a84-8583-65f3a2ed4c84/</turbo:source><turbo:topic>Cisco: Установка лицензий</turbo:topic><turbo:content><![CDATA[<p>Рассмотрим этапы установки лицензии на оборудование <span class="shortcode shortcode-tag"><a href="/ru/tags/cisco/" target="_blank">#Cisco</a></span>, а также экспортирование уже установленных лицензий в специальный файл.</p>
<p>Лицензия привязывается к уникальному идентификатору устройства (<strong>U</strong>nique <strong>D</strong>evice <strong>I</strong>dentifier). <strong>UDI</strong> представляет собой строку, состоящую из <strong>PID</strong> (идентификатор продукта) и <strong>SN</strong> (серийный номер). Посмотреть UDI можно командой:</p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-0
shortcode-codeblock-plaintext">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-6b019d8524cffe17ff3149902bd5ce14" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-plaintext" data-lang="plaintext"><span class="line"><span class="cl"># show license udi</span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-6b019d8524cffe17ff3149902bd5ce14"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<h2 id="импортирование-лицензий">
  <a class="link-body-emphasis" href="#%d0%b8%d0%bc%d0%bf%d0%be%d1%80%d1%82%d0%b8%d1%80%d0%be%d0%b2%d0%b0%d0%bd%d0%b8%d0%b5-%d0%bb%d0%b8%d1%86%d0%b5%d0%bd%d0%b7%d0%b8%d0%b9">Импортирование лицензий</a>
</h2><p>Необходимо предварительно настроить сетевой интерфейс компьютера со следующими параметрами:</p>
<ul>
<li>IP-адрес: <code>192.168.1.2</code>.</li>
<li>Маска подсети: <code>255.255.255.0</code>.</li>
<li>Шлюз: <code>192.168.1.1</code>.</li>
<li>DNS: <code>8.8.8.8</code>.</li>
</ul>
<p>Теперь настроим сетевой интерфейс <code>FE0/1</code> на <span class="shortcode shortcode-tag"><a href="/ru/tags/cisco/" target="_blank">#Cisco</a></span>:</p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-1
shortcode-codeblock-plaintext">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-7c3c073a4f4f0af39b1314956b6aa5f5" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-plaintext" data-lang="plaintext"><span class="line"><span class="cl"># conf t
</span></span><span class="line"><span class="cl">(config)# int fa0/1
</span></span><span class="line"><span class="cl">(config-if)# ip address 192.168.1.1 255.255.255.0
</span></span><span class="line"><span class="cl">(config-if)# no shutdown
</span></span><span class="line"><span class="cl">(config-if)# exit
</span></span><span class="line"><span class="cl">(config)# exit
</span></span><span class="line"><span class="cl">#</span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-7c3c073a4f4f0af39b1314956b6aa5f5"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<p>После предварительных настроек, подключим сетевой интерфейс компьютера к сетевому интерфейсу <span class="shortcode shortcode-tag"><a href="/ru/tags/cisco/" target="_blank">#Cisco</a></span> <code>FE0/1</code> и запустим TFTP-сервер на компьютере c IP <code>192.168.1.2</code>.</p>
<h3 id="установка-лицензий">
  <a class="link-body-emphasis" href="#%d1%83%d1%81%d1%82%d0%b0%d0%bd%d0%be%d0%b2%d0%ba%d0%b0-%d0%bb%d0%b8%d1%86%d0%b5%d0%bd%d0%b7%d0%b8%d0%b9">Установка лицензий</a>
</h3><p>Загружаем файл лицензии <code>LICENSE_FILE.lic</code> на флэш-карту <span class="shortcode shortcode-tag"><a href="/ru/tags/cisco/" target="_blank">#Cisco</a></span>:</p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-2
shortcode-codeblock-plaintext">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-ad6b850a3a7736bd912af497f6978756" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-plaintext" data-lang="plaintext"><span class="line"><span class="cl"># copy tftp://192.168.1.2/LICENSE_FILE.lic flash:</span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-ad6b850a3a7736bd912af497f6978756"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<p>Импортируем файл лицензии <code>LICENSE_FILE.lic</code> с флэш-карты в память <span class="shortcode shortcode-tag"><a href="/ru/tags/cisco/" target="_blank">#Cisco</a></span>:</p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-3
shortcode-codeblock-plaintext">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-614d3fd44622c2bcfe4e42dc54f89312" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-plaintext" data-lang="plaintext"><span class="line"><span class="cl"># license install flash:LICENSE_FILE.lic</span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-614d3fd44622c2bcfe4e42dc54f89312"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<p>И перезапускаем оборудование:</p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-4
shortcode-codeblock-plaintext">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-d19ff2fe96a6b587dfa7ec1dfab9351a" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-plaintext" data-lang="plaintext"><span class="line"><span class="cl"># reload</span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-d19ff2fe96a6b587dfa7ec1dfab9351a"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<p>После перезапуска, <span class="shortcode shortcode-tag"><a href="/ru/tags/cisco/" target="_blank">#Cisco</a></span> включит дополнительные функции согласно установленным лицензиям.</p>
<h3 id="информация-о-лицензиях">
  <a class="link-body-emphasis" href="#%d0%b8%d0%bd%d1%84%d0%be%d1%80%d0%bc%d0%b0%d1%86%d0%b8%d1%8f-%d0%be-%d0%bb%d0%b8%d1%86%d0%b5%d0%bd%d0%b7%d0%b8%d1%8f%d1%85">Информация о лицензиях</a>
</h3><p>Посмотреть версию оборудования и установленные лицензии можно следующей командой:</p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-5
shortcode-codeblock-plaintext">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-e2fcf31fc2dacbfa033e2943d40b9041" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-plaintext" data-lang="plaintext"><span class="line"><span class="cl"># show version</span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-e2fcf31fc2dacbfa033e2943d40b9041"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<ul>
<li>В столбце <code>Type</code> должно быть указано <code>Permanent</code>.</li>
</ul>
<p>Более подробную информацию о лицензиях на оборудовании можно посмотреть следующей командой:</p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-6
shortcode-codeblock-plaintext">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-91b512be2131aa0f54f9726df5c0625d" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-plaintext" data-lang="plaintext"><span class="line"><span class="cl"># show license</span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-91b512be2131aa0f54f9726df5c0625d"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<p>При корректно установленной лицензии, в её параметрах должны быть следующие сведения:</p>
<ul>
<li>В строке <code>Period left</code> должно быть указано <code>Life time</code>.</li>
<li>в строке <code>License Type</code> должно быть указано <code>Permanent</code>.</li>
</ul>
<h2 id="экспортирование-лицензий">
  <a class="link-body-emphasis" href="#%d1%8d%d0%ba%d1%81%d0%bf%d0%be%d1%80%d1%82%d0%b8%d1%80%d0%be%d0%b2%d0%b0%d0%bd%d0%b8%d0%b5-%d0%bb%d0%b8%d1%86%d0%b5%d0%bd%d0%b7%d0%b8%d0%b9">Экспортирование лицензий</a>
</h2>



    








    
    






<div class="shortcode shortcode-alert">
  <div class="alert alert-warning d-flex overflow-hidden" role="alert">
    <div class="flex-shrink-0 align-self-center">
      <i class="fas fa-exclamation-triangle fa-fw fa-2x"></i>
    </div>
    <div class="flex-grow-1 ms-3 overflow-hidden">
        <p>Файл с лицензиями следует сохранить в надёжном месте!</p>

    </div>
  </div>
</div>

<p>Если потребуется заменить флэш-карту или сдать оборудование в ремонт, можно экспортировать существующие лицензии в файл:</p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-7
shortcode-codeblock-plaintext">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-f4dc184e33400d7a2a8a7d31a777eea3" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-plaintext" data-lang="plaintext"><span class="line"><span class="cl"># license save flash:ALL_LICENSE.lic</span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-f4dc184e33400d7a2a8a7d31a777eea3"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<p>Где:</p>
<ul>
<li><code>ALL_LICENSE.lic</code> - название создаваемого файла с лицензиями.</li>
</ul>]]></turbo:content></item><item turbo="true"><title>MikroTik: Туннель GRE/IPsec (Site-to-Site)</title><link>https://lib.onl/ru/2024/04/326618af-d950-5001-8114-57c66bb8a5af/</link><pubDate>Mon, 08 Apr 2024 10:04:21 +0000</pubDate><dc:creator>Kai Kimera</dc:creator><category>Сеть</category><category>Скрипты</category><yandex:related><link url="https://lib.onl/ru/2024/03/54a2b39f-38b4-5f0c-9b54-310f853da38f/">MikroTik: Туннель IPsec (Site-to-Site)</link><link url="https://lib.onl/ru/2024/04/146e83d5-f571-5273-9a29-172bf5dc10fe/">MikroTik: Туннель WireGuard (Site-to-Site) + OSPF</link><link url="https://lib.onl/ru/2023/10/cc13623b-970c-5950-867e-168f9ba9025a/">MikroTik: Добавление корневых сертификатов в RouterOS</link><link url="https://lib.onl/ru/2020/07/ff2ae66e-8e14-5c4a-baa6-0cd2e59f6517/">MikroTik и CloudFlare: Динамический IP для домена</link><link url="https://lib.onl/ru/2023/12/b6c7c5cd-1b0d-5fcd-8dd2-f28f87a5064c/">MikroTik: Настройка DoH</link></yandex:related><turbo:extendedHtml>true</turbo:extendedHtml><turbo:source>https://lib.onl/ru/2024/04/326618af-d950-5001-8114-57c66bb8a5af/</turbo:source><turbo:topic>MikroTik: Туннель GRE/IPsec (Site-to-Site)</turbo:topic><turbo:content><![CDATA[<p>Продолжаем серию статей по настройке туннеля между двумя маршрутизаторами. На этот раз создадим <span class="shortcode shortcode-tag"><a href="/ru/tags/gre/" target="_blank">#GRE</a></span> туннель.</p>
<p>На обоих маршрутизаторах у меня используются динамические WAN IP. <span class="shortcode shortcode-tag"><a href="/ru/tags/gre/" target="_blank">#GRE</a></span> предпочитает только статические IP-адреса. Чтобы обойти данное ограничение, я использую скрипт из статьи <span class="shortcode shortcode-uuid"><a href="/ru/2020/07/ff2ae66e-8e14-5c4a-baa6-0cd2e59f6517/">MikroTik и CloudFlare: Динамический IP для домена</a></span>, который обновляет IP-адреса маршрутизаторов в суб-доменах, далее скриптом в конце статьи я забираю актуальные IP-адреса суб-доменов и обновляю их в настройках интерфейса <span class="shortcode shortcode-tag"><a href="/ru/tags/gre/" target="_blank">#GRE</a></span>.</p>
<h2 id="вводные-данные">
  <a class="link-body-emphasis" href="#%d0%b2%d0%b2%d0%be%d0%b4%d0%bd%d1%8b%d0%b5-%d0%b4%d0%b0%d0%bd%d0%bd%d1%8b%d0%b5">Вводные данные</a>
</h2><ul>
<li>Маршрутизатор <code>R1</code>:
<ul>
<li>WAN IP: <code>gw1.example.com</code>.</li>
<li>LAN IP: <code>10.1.0.1</code>.</li>
<li>Network: <code>10.1.0.0/16</code>.</li>
</ul>
</li>
<li>Маршрутизатор <code>R2</code>:
<ul>
<li>WAN IP: <code>gw2.example.com</code>.</li>
<li>LAN IP: <code>10.2.0.1</code>.</li>
<li>Network: <code>10.2.0.0/16</code>.</li>
</ul>
</li>
</ul>
<h2 id="настройка-маршрутизаторов">
  <a class="link-body-emphasis" href="#%d0%bd%d0%b0%d1%81%d1%82%d1%80%d0%be%d0%b9%d0%ba%d0%b0-%d0%bc%d0%b0%d1%80%d1%88%d1%80%d1%83%d1%82%d0%b8%d0%b7%d0%b0%d1%82%d0%be%d1%80%d0%be%d0%b2">Настройка маршрутизаторов</a>
</h2>



    






    
    








<div class="shortcode shortcode-alert">
  <div class="alert alert-info d-flex overflow-hidden" role="alert">
    <div class="flex-shrink-0 align-self-center">
      <i class="fas fa-info fa-fw fa-2x"></i>
    </div>
    <div class="flex-grow-1 ms-3 overflow-hidden">
        <p>В моём случае, первоначальные адреса WAN IP маршрутизаторов не имею значения. Они всё равно будут обновлены скриптом на актуальные, взятые у суб-доменов.</p>

    </div>
  </div>
</div>

<h3 id="router-1">
  <a class="link-body-emphasis" href="#router-1">Router #1</a>
</h3><ul>
<li>Создаём интерфейс <span class="shortcode shortcode-tag"><a href="/ru/tags/gre/" target="_blank">#GRE</a></span>:
<ul>
<li>Имя интерфейса: <code>gre-sts</code>.</li>
<li>Секретная фраза для IPsec: <code>PassWord</code>.</li>
<li>WAN IP-адрес локального маршрутизатора <code>R1</code>: <code>1.1.1.1</code>.</li>
<li>WAN IP-адрес удалённого маршрутизатора <code>R2</code>: <code>2.2.2.2</code>.</li>
<li>Комментарий: <code>HOST: gw2.example.com</code>.</li>
</ul>
</li>
</ul>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-0
shortcode-codeblock-text">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-243ac36be50da5b04decc4dea8f4ffc6" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-text" data-lang="text"><span class="line"><span class="cl">/interface gre
</span></span><span class="line"><span class="cl">add allow-fast-path=no ipsec-secret=&#34;PassWord&#34; name=&#34;gre-sts&#34; remote-address=2.2.2.2 comment=&#34;HOST: gw2.example.com&#34;</span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-243ac36be50da5b04decc4dea8f4ffc6"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<ul>
<li>Прописываем интерфейсу IP-адрес <code>10.255.255.1/24</code>:
<ul>
<li>Адрес интерфейса: <code>10.255.255.1/24</code>.</li>
<li>Интерфейс: <code>gre-sts</code>.</li>
<li>Комментарий: <code>[GRE] GRE-STS</code>.</li>
</ul>
</li>
</ul>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-1
shortcode-codeblock-text">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-d8fe205b0a5c96b19e077d884cc7353d" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-text" data-lang="text"><span class="line"><span class="cl">/ip address
</span></span><span class="line"><span class="cl">add address=10.255.255.1/24 interface=&#34;gre-sts&#34; comment=&#34;[GRE] GRE-STS&#34;</span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-d8fe205b0a5c96b19e077d884cc7353d"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<ul>
<li>Указываем маршрут до удалённой сети <code>R2</code>:
<ul>
<li>Адрес удалённой сети <code>R2</code>: <code>10.2.0.0/16</code>.</li>
<li>Шлюз <code>R2</code>: <code>10.255.255.2</code>.</li>
<li>Комментарий: <code>[GRE] GW2</code>.</li>
</ul>
</li>
</ul>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-2
shortcode-codeblock-text">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-5edb4c55325ad50a9cbe0e323b2bc4e8" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-text" data-lang="text"><span class="line"><span class="cl">/ip route
</span></span><span class="line"><span class="cl">add distance=1 dst-address=10.2.0.0/16 gateway=10.255.255.2 comment=&#34;[GRE] GW2&#34;</span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-5edb4c55325ad50a9cbe0e323b2bc4e8"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<h3 id="router-2">
  <a class="link-body-emphasis" href="#router-2">Router #2</a>
</h3><ul>
<li>Создаём интерфейс <span class="shortcode shortcode-tag"><a href="/ru/tags/gre/" target="_blank">#GRE</a></span>:
<ul>
<li>Имя интерфейса: <code>gre-sts</code>.</li>
<li>Секретная фраза для IPsec: <code>PassWord</code>.</li>
<li>WAN IP-адрес локального маршрутизатора <code>R2</code>: <code>2.2.2.2</code>.</li>
<li>WAN IP-адрес удалённого маршрутизатора <code>R1</code>: <code>1.1.1.1</code>.</li>
<li>Комментарий: <code>HOST: gw1.example.com</code>.</li>
</ul>
</li>
</ul>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-3
shortcode-codeblock-text">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-48ccea094faa393080aa65e9b5a7cf71" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-text" data-lang="text"><span class="line"><span class="cl">/interface gre
</span></span><span class="line"><span class="cl">add allow-fast-path=no ipsec-secret=&#34;PassWord&#34; name=&#34;gre-sts&#34; remote-address=1.1.1.1 comment=&#34;HOST: gw1.example.com&#34;</span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-48ccea094faa393080aa65e9b5a7cf71"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<ul>
<li>Прописываем интерфейсу IP-адрес <code>10.255.255.2/24</code>:
<ul>
<li>Адрес интерфейса: <code>10.255.255.2/24</code>.</li>
<li>Интерфейс: <code>gre-sts</code>.</li>
<li>Комментарий: <code>[GRE] GRE-STS</code>.</li>
</ul>
</li>
</ul>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-4
shortcode-codeblock-text">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-7edf6c9d68e7c631a94dcc9d60c35079" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-text" data-lang="text"><span class="line"><span class="cl">/ip address
</span></span><span class="line"><span class="cl">add address=10.255.255.2/24 interface=&#34;gre-sts&#34; comment=&#34;[GRE] GRE-STS&#34;</span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-7edf6c9d68e7c631a94dcc9d60c35079"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<ul>
<li>Указываем маршрут до удалённой сети <code>R1</code>:
<ul>
<li>Адрес удалённой сети <code>R1</code>: <code>10.1.0.0/16</code>.</li>
<li>Шлюз <code>R1</code>: <code>10.255.255.1</code>.</li>
<li>Комментарий: <code>[GRE] GW1</code>.</li>
</ul>
</li>
</ul>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-5
shortcode-codeblock-text">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-36d2dadfd2a7e3a535abcff6dbac0a92" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-text" data-lang="text"><span class="line"><span class="cl">/ip route
</span></span><span class="line"><span class="cl">add distance=1 dst-address=10.1.0.0/16 gateway=10.255.255.1 comment=&#34;[GRE] GW1&#34;</span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-36d2dadfd2a7e3a535abcff6dbac0a92"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<h2 id="скрипт-для-динамического-ip">
  <a class="link-body-emphasis" href="#%d1%81%d0%ba%d1%80%d0%b8%d0%bf%d1%82-%d0%b4%d0%bb%d1%8f-%d0%b4%d0%b8%d0%bd%d0%b0%d0%bc%d0%b8%d1%87%d0%b5%d1%81%d0%ba%d0%be%d0%b3%d0%be-ip">Скрипт для динамического IP</a>
</h2><p>К сожалению, <span class="shortcode shortcode-tag"><a href="/ru/tags/mikrotik/" target="_blank">#MikroTik</a></span> для интерфейса <span class="shortcode shortcode-tag"><a href="/ru/tags/gre/" target="_blank">#GRE</a></span> использует только IP-адреса, нельзя указать имя суб-домена. Но на форуме <span class="shortcode shortcode-tag"><a href="/ru/tags/mikrotik/" target="_blank">#MikroTik</a></span> я нашёл скрипт, который парсит доменное имя удалённого маршрутизатора в специально составленном комментарии (<code>HOST: sub.example.com</code>) к интерфейсу и запрашивает IP-адрес этого домена. Этот IP-адрес автоматически вставляется в поле <code>remote-address</code> интерфейса <span class="shortcode shortcode-tag"><a href="/ru/tags/gre/" target="_blank">#GRE</a></span>.</p>
<h3 id="приложение">
  <a class="link-body-emphasis" href="#%d0%bf%d1%80%d0%b8%d0%bb%d0%be%d0%b6%d0%b5%d0%bd%d0%b8%d0%b5">Приложение</a>
</h3>
    

    
        
            
            <div class="shortcode shortcode-file mb-3">
              <div class="card overflow-hidden" data-bs-theme="dark">
                <div class="card-header">
                  <div class="d-flex align-items-center">
                    <div class="flex-shrink-0">
                      <i class="far fa-file-code fa-fw"></i>
                    </div>
                    <div class="flex-grow-1 mx-2 text-truncate">
                      <code>ros.gre.ip.rsc</code>
                    </div>
                    <div class="flex-shrink-0">
                      <ul class="list-inline mb-0">
                        <li class="list-inline-item" title='Копировать'>
                          <a class="text-body" href="#"
                             data-fn="clipboard" data-clipboard-target="#cp-d1cfa6945430ab0760d61f3933d3f1d8"
                             role="button" aria-label='Копировать'>
                            <i class="fas fa-copy fa-fw"></i>
                          </a>
                        </li>
                        <li class="list-inline-item" title='Скачать'>
                          <a class="text-body" href="/ru/2024/04/326618af-d950-5001-8114-57c66bb8a5af/ros.gre.ip.rsc" download
                             role="button" aria-label='Скачать'>
                            <i class="fas fa-download fa-fw"></i>
                          </a>
                        </li>
                        <li class="list-inline-item" title='Открыть'>
                          <a class="text-body" href="/ru/2024/04/326618af-d950-5001-8114-57c66bb8a5af/ros.gre.ip.rsc" target="_blank"
                             role="button" aria-label='Открыть'>
                            <i class="fas fa-arrow-up-right-from-square fa-fw"></i>
                          </a>
                        </li>
                      </ul>
                    </div>
                  </div>
                </div>
                <div class="card-body p-0 overflow-auto" id="cp-d1cfa6945430ab0760d61f3933d3f1d8">
                    
                    <div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-text" data-lang="text"><span class="line"><span class="cl"># GRE DYNAMIC IP
</span></span><span class="line"><span class="cl"># -------------------------------------------------------------------------------------------------------------------- #
</span></span><span class="line"><span class="cl"># @package    RouterOS
</span></span><span class="line"><span class="cl"># @author     Kai Kimera &lt;mail@kai.kim&gt;
</span></span><span class="line"><span class="cl"># @copyright  2024 Library Online
</span></span><span class="line"><span class="cl"># @license    MIT
</span></span><span class="line"><span class="cl"># @version    0.1.0
</span></span><span class="line"><span class="cl"># @policy     read, write, test
</span></span><span class="line"><span class="cl"># @schedule:  00:15:00
</span></span><span class="line"><span class="cl"># @link       https://lib.onl/ru/articles/2024/04/326618af-d950-5001-8114-57c66bb8a5af/
</span></span><span class="line"><span class="cl"># -------------------------------------------------------------------------------------------------------------------- #
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">:local wanInterface &#34;ether1&#34;
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"># -------------------------------------------------------------------------------------------------------------------- #
</span></span><span class="line"><span class="cl"># -----------------------------------------------------&lt; SCRIPT &gt;----------------------------------------------------- #
</span></span><span class="line"><span class="cl"># -------------------------------------------------------------------------------------------------------------------- #
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">:local wanAddress [/ip address get [find interface=$wanInterface] address]
</span></span><span class="line"><span class="cl">:set wanAddress [:pick $wanAddress 0 [:find $wanAddress &#34;/&#34;]]
</span></span><span class="line"><span class="cl">:local greComment
</span></span><span class="line"><span class="cl">:local greHost
</span></span><span class="line"><span class="cl">:local greRemoteAddrNew
</span></span><span class="line"><span class="cl">:local greRemoteAddrOld
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">:foreach i in=[/interface gre find where comment~&#34;^HOST: &#34;] do={
</span></span><span class="line"><span class="cl">  :set greComment [/interface gre get $i comment]
</span></span><span class="line"><span class="cl">  :set greHost [:pick $greComment 6 [:len $greComment]]
</span></span><span class="line"><span class="cl">  :set greRemoteAddrOld [/interface gre get $i remote-address]
</span></span><span class="line"><span class="cl">  :set greRemoteAddrNew [:resolve $greHost]
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  :if ($greRemoteAddrNew != $greRemoteAddrOld) do={
</span></span><span class="line"><span class="cl">    /interface gre set $i remote-address=$greRemoteAddrNew
</span></span><span class="line"><span class="cl">    :log info (&#34;GRE: Updating remote address ($greHost) from $greRemoteAddrOld to $greRemoteAddrNew.&#34;)
</span></span><span class="line"><span class="cl">  }
</span></span><span class="line"><span class="cl">}</span></span></code></pre></td></tr></table>
</div>
</div>
                </div>
              </div>
            </div>
        
    
<h4 id="параметры">
  <a class="link-body-emphasis" href="#%d0%bf%d0%b0%d1%80%d0%b0%d0%bc%d0%b5%d1%82%d1%80%d1%8b">Параметры</a>
</h4><ul>
<li><code>wanInterface</code> - название WAN-интерфейса.</li>
</ul>
<h3 id="установка">
  <a class="link-body-emphasis" href="#%d1%83%d1%81%d1%82%d0%b0%d0%bd%d0%be%d0%b2%d0%ba%d0%b0">Установка</a>
</h3><p>После настройки скрипта, его нужно добавить в репозиторий скриптов <span class="shortcode shortcode-tag"><a href="/ru/tags/routeros/" target="_blank">#RouterOS</a></span>. Находится репозиторий в System / Scripts. При добавлении скрипта, необходимо выбрать политики <code>read</code>, <code>write</code>, <code>test</code>.</p>
<h3 id="планировщик">
  <a class="link-body-emphasis" href="#%d0%bf%d0%bb%d0%b0%d0%bd%d0%b8%d1%80%d0%be%d0%b2%d1%89%d0%b8%d0%ba">Планировщик</a>
</h3><p>Скрипт должен переодически запускаться для проверки и синхронизации IP адресов интерфейсов и домена. В этом поможет планировщик <span class="shortcode shortcode-tag"><a href="/ru/tags/routeros/" target="_blank">#RouterOS</a></span>. Заходим в System / Scheduler и создаём задачу с политиками <code>read</code>, <code>write</code>, <code>test</code>. В поле <strong>On Event</strong> вписываем точное название скрипта, ранее добавленного в репозиторий <span class="shortcode shortcode-tag"><a href="/ru/tags/routeros/" target="_blank">#RouterOS</a></span>.</p>]]></turbo:content></item><item turbo="true"><title>MikroTik: Туннель WireGuard (Site-to-Site) + OSPF</title><link>https://lib.onl/ru/2024/04/146e83d5-f571-5273-9a29-172bf5dc10fe/</link><pubDate>Sat, 06 Apr 2024 09:27:28 +0000</pubDate><dc:creator>Kai Kimera</dc:creator><category>Сеть</category><category>Скрипты</category><yandex:related><link url="https://lib.onl/ru/2024/03/54a2b39f-38b4-5f0c-9b54-310f853da38f/">MikroTik: Туннель IPsec (Site-to-Site)</link><link url="https://lib.onl/ru/2023/10/cc13623b-970c-5950-867e-168f9ba9025a/">MikroTik: Добавление корневых сертификатов в RouterOS</link><link url="https://lib.onl/ru/2020/07/ff2ae66e-8e14-5c4a-baa6-0cd2e59f6517/">MikroTik и CloudFlare: Динамический IP для домена</link><link url="https://lib.onl/ru/2023/12/b6c7c5cd-1b0d-5fcd-8dd2-f28f87a5064c/">MikroTik: Настройка DoH</link></yandex:related><turbo:extendedHtml>true</turbo:extendedHtml><turbo:source>https://lib.onl/ru/2024/04/146e83d5-f571-5273-9a29-172bf5dc10fe/</turbo:source><turbo:topic>MikroTik: Туннель WireGuard (Site-to-Site) + OSPF</turbo:topic><turbo:content><![CDATA[<p>Объединение двух маршрутизаторов между собой при помощи туннеля <span class="shortcode shortcode-tag"><a href="/ru/tags/wireguard/" target="_blank">#WireGuard</a></span>. При этом, обмениваться маршрутами эти маршрутизаторы будут через протокол <span class="shortcode shortcode-tag"><a href="/ru/tags/ospf/" target="_blank">#OSPF</a></span>.</p>
<p>В качестве WAN IP я использую суб-домены. <span class="shortcode shortcode-tag"><a href="/ru/tags/wireguard/" target="_blank">#WireGuard</a></span> позволяет использовать суб-домены как EndPoint&rsquo;ы, а уже к суб-доменам приписываются IP-адреса маршрутизаторов. Подобная схема наиболее универсальная, так как не в каждом случае имеется внешний статический IP-адрес, но при использовании скрипта из статьи <span class="shortcode shortcode-uuid"><a href="/ru/2020/07/ff2ae66e-8e14-5c4a-baa6-0cd2e59f6517/">MikroTik и CloudFlare: Динамический IP для домена</a></span> любой адрес маршрутизатора можно превратить в статический через суб-домен.</p>
<h2 id="вводные-данные">
  <a class="link-body-emphasis" href="#%d0%b2%d0%b2%d0%be%d0%b4%d0%bd%d1%8b%d0%b5-%d0%b4%d0%b0%d0%bd%d0%bd%d1%8b%d0%b5">Вводные данные</a>
</h2><ul>
<li>Маршрутизатор <code>R1</code>:
<ul>
<li>WAN IP: <code>gw1.example.com</code>.</li>
<li>LAN IP: <code>10.1.0.1</code>.</li>
<li>Network: <code>10.1.0.0/16</code>.</li>
</ul>
</li>
<li>Маршрутизатор <code>R2</code>:
<ul>
<li>WAN IP: <code>gw2.example.com</code>.</li>
<li>LAN IP: <code>10.2.0.1</code>.</li>
<li>Network: <code>10.2.0.0/16</code>.</li>
</ul>
</li>
</ul>
<h2 id="настройка-маршрутизаторов">
  <a class="link-body-emphasis" href="#%d0%bd%d0%b0%d1%81%d1%82%d1%80%d0%be%d0%b9%d0%ba%d0%b0-%d0%bc%d0%b0%d1%80%d1%88%d1%80%d1%83%d1%82%d0%b8%d0%b7%d0%b0%d1%82%d0%be%d1%80%d0%be%d0%b2">Настройка маршрутизаторов</a>
</h2><h3 id="router-1">
  <a class="link-body-emphasis" href="#router-1">Router #1</a>
</h3><ul>
<li>Создаём интерфейс <span class="shortcode shortcode-tag"><a href="/ru/tags/wireguard/" target="_blank">#WireGuard</a></span>:
<ul>
<li>Номер порта: <code>51820</code>.</li>
<li>Название интерфейса: <code>wireguard-sts</code>.</li>
<li>Комментарий: <code>WireGuard (Site-to-Site)</code>.</li>
</ul>
</li>
</ul>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-0
shortcode-codeblock-text">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-424b189233ea58304fdfbebf7b2f66e8" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-text" data-lang="text"><span class="line"><span class="cl">/interface wireguard
</span></span><span class="line"><span class="cl">add listen-port=51820 name=wireguard-sts comment=&#34;WireGuard (Site-to-Site)&#34;</span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-424b189233ea58304fdfbebf7b2f66e8"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<ul>
<li>Прописываем интерфейсу IP-адрес <code>10.255.255.1/24</code>:
<ul>
<li>Адрес интерфейса: <code>10.255.255.1/24</code>.</li>
<li>Интерфейс: <code>wireguard-sts</code>.</li>
<li>Комментарий: <code>[WG] WireGuard (Site-to-Site)</code>.</li>
</ul>
</li>
</ul>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-1
shortcode-codeblock-text">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-616c843368a56224252cded319561d16" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-text" data-lang="text"><span class="line"><span class="cl">/ip address
</span></span><span class="line"><span class="cl">add address=10.255.255.1/24 interface=wireguard-sts comment=&#34;[WG] WireGuard (Site-to-Site)&#34;</span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-616c843368a56224252cded319561d16"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<ul>
<li>Указываем маршрут до удалённой сети <code>R2</code>:
<ul>
<li>Адрес удалённой сети <code>R2</code>: <code>10.2.0.0/16</code>.</li>
<li>Шлюз <code>R2</code>: <code>10.255.255.2</code>.</li>
<li>Комментарий: <code>[WG] GW1-GW2</code>.</li>
</ul>
</li>
</ul>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-2
shortcode-codeblock-text">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-f85cdd91ff297e02e791f10c9adad631" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-text" data-lang="text"><span class="line"><span class="cl">/ip route
</span></span><span class="line"><span class="cl">add dst-address=10.2.0.0/16 gateway=10.255.255.2 comment=&#34;[WG] GW1-GW2&#34;</span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-f85cdd91ff297e02e791f10c9adad631"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<ul>
<li>Настраиваем фильтры брандмауэра:
<ul>
<li>Открыть порт <code>51820</code>.</li>
<li>Разрешить трафик из удалённой сети <code>R2</code> <code>10.2.0.0/16</code> в локальную сеть <code>R1</code> <code>10.1.0.0/16</code>.</li>
<li>Разрешить трафик из локальной сети <code>R1</code> <code>10.1.0.0/16</code> в удалённую сеть <code>R2</code> <code>10.2.0.0/16</code>.</li>
</ul>
</li>
</ul>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-3
shortcode-codeblock-text">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-753a3f43f0e04f090366cfb01ba96643" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-text" data-lang="text"><span class="line"><span class="cl">/ip firewall filter
</span></span><span class="line"><span class="cl">add action=accept chain=input dst-port=51820 in-interface-list=WAN protocol=udp comment=&#34;[WG] WireGuard (Site-to-Site)&#34;
</span></span><span class="line"><span class="cl">add action=accept chain=forward src-address=10.2.0.0/16 dst-address=10.1.0.0/16 comment=&#34;[WG] GW2-GW1&#34;
</span></span><span class="line"><span class="cl">add action=accept chain=forward src-address=10.1.0.0/16 dst-address=10.2.0.0/16 comment=&#34;[WG] GW1-GW2&#34;</span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-753a3f43f0e04f090366cfb01ba96643"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<h3 id="router-2">
  <a class="link-body-emphasis" href="#router-2">Router #2</a>
</h3><ul>
<li>Создаём интерфейс <span class="shortcode shortcode-tag"><a href="/ru/tags/wireguard/" target="_blank">#WireGuard</a></span>:
<ul>
<li>Номер порта: <code>51820</code>.</li>
<li>Название интерфейса: <code>wireguard-sts</code>.</li>
<li>Комментарий: <code>WireGuard (Site-to-Site)</code>.</li>
</ul>
</li>
</ul>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-4
shortcode-codeblock-text">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-900d221e72856877fb15ea4c7ddae785" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-text" data-lang="text"><span class="line"><span class="cl">/interface wireguard
</span></span><span class="line"><span class="cl">add listen-port=51820 name=wireguard-sts comment=&#34;WireGuard (Site-to-Site)&#34;</span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-900d221e72856877fb15ea4c7ddae785"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<ul>
<li>Прописываем интерфейсу IP-адрес <code>10.255.255.2/24</code>:
<ul>
<li>Адрес интерфейса: <code>10.255.255.2/24</code>.</li>
<li>Интерфейс: <code>wireguard-sts</code>.</li>
<li>Комментарий: <code>[WG] WireGuard (Site-to-Site)</code>.</li>
</ul>
</li>
</ul>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-5
shortcode-codeblock-text">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-839f4437aa37bf74f8e454eb98ee57be" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-text" data-lang="text"><span class="line"><span class="cl">/ip address
</span></span><span class="line"><span class="cl">add address=10.255.255.2/24 interface=wireguard-sts comment=&#34;WireGuard (Site-to-Site)&#34;</span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-839f4437aa37bf74f8e454eb98ee57be"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<ul>
<li>Указываем маршрут до удалённой сети <code>R1</code>:
<ul>
<li>Адрес удалённой сети <code>R1</code>: <code>10.1.0.0/16</code>.</li>
<li>Шлюз <code>R1</code>: <code>10.255.255.1</code>.</li>
<li>Комментарий: <code>[WG] GW2-GW1</code>.</li>
</ul>
</li>
</ul>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-6
shortcode-codeblock-text">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-0e0828a59dcbdc6a4742591afcddd700" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-text" data-lang="text"><span class="line"><span class="cl">/ip route
</span></span><span class="line"><span class="cl">add dst-address=10.1.0.0/16 gateway=10.255.255.1 comment=&#34;[WG] GW2-GW1&#34;</span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-0e0828a59dcbdc6a4742591afcddd700"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<ul>
<li>Настраиваем фильтры брандмауэра:
<ul>
<li>Открыть порт <code>51820</code>.</li>
<li>Разрешить трафик из удалённой сети <code>R1</code> <code>10.1.0.0/16</code> в локальную сеть <code>R2</code> <code>10.2.0.0/16</code>.</li>
<li>Разрешить трафик из локальной сети <code>R2</code> <code>10.2.0.0/16</code> в удалённую сеть <code>R1</code> <code>10.1.0.0/16</code>.</li>
</ul>
</li>
</ul>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-7
shortcode-codeblock-text">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-97a1f1dd2c13098dfd1be11f9022206f" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-text" data-lang="text"><span class="line"><span class="cl">/ip firewall filter
</span></span><span class="line"><span class="cl">add action=accept chain=input dst-port=51820 in-interface-list=WAN protocol=udp comment=&#34;[WG] WireGuard (Site-to-Site)&#34;
</span></span><span class="line"><span class="cl">add action=accept chain=forward src-address=10.1.0.0/16 dst-address=10.2.0.0/16 comment=&#34;[WG] GW1-GW2&#34;
</span></span><span class="line"><span class="cl">add action=accept chain=forward src-address=10.2.0.0/16 dst-address=10.1.0.0/16 comment=&#34;[WG] GW2-GW1&#34;</span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-97a1f1dd2c13098dfd1be11f9022206f"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<h3 id="автоматизация">
  <a class="link-body-emphasis" href="#%d0%b0%d0%b2%d1%82%d0%be%d0%bc%d0%b0%d1%82%d0%b8%d0%b7%d0%b0%d1%86%d0%b8%d1%8f">Автоматизация</a>
</h3><p>Написал небольшой сценарий для разворачивания интерфейса WireGuard на маршрутизаторах. Настройки сценария, естественно, разные под каждый из маршрутизаторов. А вот добавлять peer&rsquo;ы придётся вручную.</p>

    

    
        
            
            <div class="shortcode shortcode-file mb-3">
              <div class="card overflow-hidden" data-bs-theme="dark">
                <div class="card-header">
                  <div class="d-flex align-items-center">
                    <div class="flex-shrink-0">
                      <i class="far fa-file-code fa-fw"></i>
                    </div>
                    <div class="flex-grow-1 mx-2 text-truncate">
                      <code>ros.wg.rsc</code>
                    </div>
                    <div class="flex-shrink-0">
                      <ul class="list-inline mb-0">
                        <li class="list-inline-item" title='Копировать'>
                          <a class="text-body" href="#"
                             data-fn="clipboard" data-clipboard-target="#cp-0ca65c7bf362cc7fb14eb4a906bfa5e6"
                             role="button" aria-label='Копировать'>
                            <i class="fas fa-copy fa-fw"></i>
                          </a>
                        </li>
                        <li class="list-inline-item" title='Скачать'>
                          <a class="text-body" href="/ru/2024/04/146e83d5-f571-5273-9a29-172bf5dc10fe/ros.wg.rsc" download
                             role="button" aria-label='Скачать'>
                            <i class="fas fa-download fa-fw"></i>
                          </a>
                        </li>
                        <li class="list-inline-item" title='Открыть'>
                          <a class="text-body" href="/ru/2024/04/146e83d5-f571-5273-9a29-172bf5dc10fe/ros.wg.rsc" target="_blank"
                             role="button" aria-label='Открыть'>
                            <i class="fas fa-arrow-up-right-from-square fa-fw"></i>
                          </a>
                        </li>
                      </ul>
                    </div>
                  </div>
                </div>
                <div class="card-body p-0 overflow-auto" id="cp-0ca65c7bf362cc7fb14eb4a906bfa5e6">
                    
                    <div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span><span class="lnt">56
</span><span class="lnt">57
</span><span class="lnt">58
</span><span class="lnt">59
</span><span class="lnt">60
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-text" data-lang="text"><span class="line"><span class="cl"># @package    MikroTik / RouterOS / WireGuard
</span></span><span class="line"><span class="cl"># @author     Kai Kimera &lt;mail@kai.kim&gt;
</span></span><span class="line"><span class="cl"># @copyright  2024 Library Online
</span></span><span class="line"><span class="cl"># @license    MIT
</span></span><span class="line"><span class="cl"># @version    0.1.0
</span></span><span class="line"><span class="cl"># @link       https://lib.onl/ru/2024/04/146e83d5-f571-5273-9a29-172bf5dc10fe/
</span></span><span class="line"><span class="cl"># -------------------------------------------------------------------------------------------------------------------- #
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"># WireGuard interface name.
</span></span><span class="line"><span class="cl">:local wgName &#34;wireguard-sts&#34;
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"># WireGuard interface IP address.
</span></span><span class="line"><span class="cl">:local wgIp &#34;10.255.255.1/24&#34;
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"># WireGuard port number.
</span></span><span class="line"><span class="cl">:local wgPort &#34;51820&#34;
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"># -------------------------------------------------------------------------------------------------------------------- #
</span></span><span class="line"><span class="cl"># Local router.
</span></span><span class="line"><span class="cl"># -------------------------------------------------------------------------------------------------------------------- #
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"># Local router name.
</span></span><span class="line"><span class="cl">:local wgLocalName &#34;GW1&#34;
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"># Local network address.
</span></span><span class="line"><span class="cl">:local wgLocalNetwork &#34;10.1.0.0/16&#34;
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"># -------------------------------------------------------------------------------------------------------------------- #
</span></span><span class="line"><span class="cl"># Remote router.
</span></span><span class="line"><span class="cl"># -------------------------------------------------------------------------------------------------------------------- #
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"># Remote router name.
</span></span><span class="line"><span class="cl">:local wgRemoteName &#34;GW2&#34;
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"># Remote network address.
</span></span><span class="line"><span class="cl">:local wgRemoteNetwork &#34;10.2.0.0/16&#34;
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"># -------------------------------------------------------------------------------------------------------------------- #
</span></span><span class="line"><span class="cl"># -----------------------------------------------------&lt; SCRIPT &gt;----------------------------------------------------- #
</span></span><span class="line"><span class="cl"># -------------------------------------------------------------------------------------------------------------------- #
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">/interface wireguard
</span></span><span class="line"><span class="cl">add listen-port=$wgPort name=$wgName \
</span></span><span class="line"><span class="cl">  comment=&#34;[WG] $wgName:$wgPort&#34;
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">/ip address
</span></span><span class="line"><span class="cl">add address=$wgIp interface=$wgName \
</span></span><span class="line"><span class="cl">  comment=&#34;[WG] $wgName:$wgPort&#34;
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">/ip route
</span></span><span class="line"><span class="cl">add dst-address=$wgRemoteNetwork gateway=$wgName \
</span></span><span class="line"><span class="cl">  comment=&#34;[WG] $wgLocalName-$wgRemoteName&#34;
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">/ip firewall filter
</span></span><span class="line"><span class="cl">add action=accept chain=input dst-port=$wgPort in-interface-list=WAN protocol=udp \
</span></span><span class="line"><span class="cl">  comment=&#34;[WG] $wgName:$wgPort&#34;
</span></span><span class="line"><span class="cl">add action=accept chain=forward src-address=$wgRemoteNetwork dst-address=$wgLocalNetwork \
</span></span><span class="line"><span class="cl">  comment=&#34;[WG] $wgRemoteName-$wgLocalName&#34;
</span></span><span class="line"><span class="cl">add action=accept chain=forward src-address=$wgLocalNetwork dst-address=$wgRemoteNetwork \
</span></span><span class="line"><span class="cl">  comment=&#34;[WG] $wgLocalName-$wgRemoteName&#34;</span></span></code></pre></td></tr></table>
</div>
</div>
                </div>
              </div>
            </div>
        
    
<h2 id="добавление-peerов">
  <a class="link-body-emphasis" href="#%d0%b4%d0%be%d0%b1%d0%b0%d0%b2%d0%bb%d0%b5%d0%bd%d0%b8%d0%b5-peer%d0%be%d0%b2">Добавление peer&rsquo;ов</a>
</h2><h3 id="router-1-1">
  <a class="link-body-emphasis" href="#router-1-1">Router #1</a>
</h3><ul>
<li>Добавить маршрутизатор <code>R2</code> в <strong>Peers</strong>:
<ul>
<li>Интерфейс: <code>wireguard-sts</code>.</li>
<li>Публичный ключ маршрутизатора <code>R2</code>: <code>&lt;public-key&gt;</code>.<br>
<em>Публичный ключ берём от маршрутизатора <code>R2</code>.</em></li>
<li>Адрес EndPoint маршрутизатора <code>R2</code>: <code>gw2.example.com</code>.</li>
<li>Порт EndPoint маршрутизатора <code>R2</code>: <code>51820</code>.</li>
<li>Разрешённые адреса:
<ul>
<li><code>10.2.0.0/16</code> - адрес удалённой сети маршрутизатора <code>R2</code>.</li>
<li><code>10.255.255.0/24</code> - общий адрес интерфейсов <code>wireguard-sts</code> обоих маршрутизаторов.</li>
<li><code>224.0.0.5/32</code> - мультикастовый адрес протокола <span class="shortcode shortcode-tag"><a href="/ru/tags/ospf/" target="_blank">#OSPF</a></span>.<br>
<em>Без этого параметра не будет работать протокол <span class="shortcode shortcode-tag"><a href="/ru/tags/ospf/" target="_blank">#OSPF</a></span>.</em></li>
</ul>
</li>
<li>Комментарий: <code>[WG] GW2</code>.</li>
</ul>
</li>
</ul>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-8
shortcode-codeblock-text">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-4f3a0d83d1460ec30293c24418db728d" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-text" data-lang="text"><span class="line"><span class="cl">/interface wireguard peers
</span></span><span class="line"><span class="cl">add allowed-address=10.2.0.0/16,10.255.255.0/24,224.0.0.5/32 endpoint-address=gw2.example.com endpoint-port=51820 interface=wireguard-sts public-key=&#34;&lt;public-key&gt;&#34; comment=&#34;[WG] GW2&#34;</span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-4f3a0d83d1460ec30293c24418db728d"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<h3 id="router-2-1">
  <a class="link-body-emphasis" href="#router-2-1">Router #2</a>
</h3><ul>
<li>Добавить маршрутизатор <code>R1</code> в <strong>Peers</strong>:
<ul>
<li>Интерфейс: <code>wireguard-sts</code>.</li>
<li>Публичный ключ маршрутизатора <code>R1</code>: <code>&lt;public-key&gt;</code>.<br>
<em>Публичный ключ берём от маршрутизатора <code>R1</code>.</em></li>
<li>Адрес EndPoint маршрутизатора <code>R1</code>: <code>gw1.example.com</code>.</li>
<li>Порт EndPoint маршрутизатора <code>R1</code>: <code>51820</code>.</li>
<li>Разрешённые адреса:
<ul>
<li><code>10.1.0.0/16</code> - адрес удалённой сети маршрутизатора <code>R1</code>.</li>
<li><code>10.255.255.0/24</code> - общий адрес интерфейсов <code>wireguard-sts</code> обоих маршрутизаторов.</li>
<li><code>224.0.0.5/32</code> - мультикастовый адрес протокола <span class="shortcode shortcode-tag"><a href="/ru/tags/ospf/" target="_blank">#OSPF</a></span>.<br>
<em>Без этого параметра не будет работать протокол <span class="shortcode shortcode-tag"><a href="/ru/tags/ospf/" target="_blank">#OSPF</a></span>.</em></li>
</ul>
</li>
<li>Комментарий: <code>[WG] GW1</code>.</li>
</ul>
</li>
</ul>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-9
shortcode-codeblock-text">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-d80c85202005803a31a2a22ed4055ba6" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-text" data-lang="text"><span class="line"><span class="cl">/interface wireguard peers
</span></span><span class="line"><span class="cl">add allowed-address=10.1.0.0/16,10.255.255.0/24,224.0.0.5/32 endpoint-address=gw1.example.com endpoint-port=51820 interface=wireguard-sts public-key=&#34;&lt;public-key&gt;&#34; comment=&#34;[WG] GW1&#34;</span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-d80c85202005803a31a2a22ed4055ba6"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<h2 id="настройка-ospf">
  <a class="link-body-emphasis" href="#%d0%bd%d0%b0%d1%81%d1%82%d1%80%d0%be%d0%b9%d0%ba%d0%b0-ospf">Настройка OSPF</a>
</h2>



    






    
    








<div class="shortcode shortcode-alert">
  <div class="alert alert-info d-flex overflow-hidden" role="alert">
    <div class="flex-shrink-0 align-self-center">
      <i class="fas fa-info fa-fw fa-2x"></i>
    </div>
    <div class="flex-grow-1 ms-3 overflow-hidden">
        <p>На каждом маршрутизаторе настройки полностью идентичные.</p>

    </div>
  </div>
</div>

<ul>
<li>Создаём инстанс:
<ul>
<li>Название: <code>ospf-instance-wg</code>.</li>
</ul>
</li>
</ul>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-10
shortcode-codeblock-text">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-c1bd80ab4fcc7e4942176687f05ae373" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-text" data-lang="text"><span class="line"><span class="cl">/routing ospf instance
</span></span><span class="line"><span class="cl">add name=ospf-instance-wg</span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-c1bd80ab4fcc7e4942176687f05ae373"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<ul>
<li>Добавляем Area:
<ul>
<li>Название Area: <code>backbone</code>.</li>
<li>Название инстанса: <code>ospf-instance-wg</code>.</li>
</ul>
</li>
</ul>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-11
shortcode-codeblock-text">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-363259da5d48b7e0828743383959e892" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-text" data-lang="text"><span class="line"><span class="cl">/routing ospf area
</span></span><span class="line"><span class="cl">add instance=ospf-instance-wg name=backbone</span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-363259da5d48b7e0828743383959e892"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<ul>
<li>Настраиваем шаблоны:
<ul>
<li>Интерфейс <code>bridge1</code>.
<ul>
<li>Area: <code>backbone</code>.</li>
</ul>
</li>
<li>Интерфейс <code>wireguard-sts</code>.
<ul>
<li>Area: <code>backbone</code>.</li>
<li>Type: <code>PTP</code> (Point-to-Point).</li>
</ul>
</li>
</ul>
</li>
</ul>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-12
shortcode-codeblock-text">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-883d8b6e70a64b39585a067d9e4a89e1" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-text" data-lang="text"><span class="line"><span class="cl">/routing ospf interface-template
</span></span><span class="line"><span class="cl">add area=backbone interfaces=bridge1
</span></span><span class="line"><span class="cl">add area=backbone interfaces=wireguard-sts type=ptp</span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-883d8b6e70a64b39585a067d9e4a89e1"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<ul>
<li>Настраиваем фильтры брандмауэра:
<ul>
<li>Разрешить протокол <span class="shortcode shortcode-tag"><a href="/ru/tags/ospf/" target="_blank">#OSPF</a></span> на интерфейсе <code>wireguard-sts</code>.</li>
</ul>
</li>
</ul>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-13
shortcode-codeblock-text">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-716b70ae9a359959474f60b997e00819" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-text" data-lang="text"><span class="line"><span class="cl">/ip firewall filter
</span></span><span class="line"><span class="cl">add action=accept chain=input in-interface=wireguard-sts protocol=ospf comment=&#34;[WG] OSPF&#34;</span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-716b70ae9a359959474f60b997e00819"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>]]></turbo:content></item><item turbo="true"><title>Установка и настройка Asterisk</title><link>https://lib.onl/ru/2024/04/2e00b43b-b0da-59c2-ae92-60dcf2ba1d52/</link><pubDate>Thu, 04 Apr 2024 11:44:11 +0000</pubDate><dc:creator>Kai Kimera</dc:creator><category>В доработке</category><category>Сеть</category><yandex:related><link url="https://lib.onl/ru/2023/11/4dfa15a8-44f0-5590-a04d-f940dac12aad/">Переход Debian между релизами</link><link url="https://lib.onl/ru/2022/01/06ef2fab-2ae2-5356-9154-7ca1e486d27d/">Установка ядра XanMod в Debian</link><link url="https://lib.onl/ru/2022/01/ddddd243-d182-5e26-a161-d2ea7812214a/">Установка Vivaldi в Debian</link><link url="https://lib.onl/ru/2021/09/581804b8-0613-52a8-a5c4-fdae90e7bc8a/">Чёрный экран с курсором при старте GDM</link><link url="https://lib.onl/ru/2021/09/1cf305cd-85d0-5e02-aabb-e01346bfee0f/">Proxmox VE: Установка на Debian 11 (Bullseye)</link><link url="https://lib.onl/ru/2021/09/ff829d15-4a19-52e3-a3aa-ad70aa38854a/">Debian: Wired Networks are Unmanaged</link><link url="https://lib.onl/ru/2021/09/b2caccc7-92bf-57ed-970f-136c546f18e2/">Распаковка пакетов DEB / RPM</link><link url="https://lib.onl/ru/2021/09/43b40b92-c29a-504b-87fa-5eac368dcf95/">Отключение установки дополнительных пакетов в Debian APT</link><link url="https://lib.onl/ru/2021/09/aeed7c90-003a-532a-b2c4-3807aaee88fa/">dhclient отправляет 36-значный идентификатор вместо MAC</link><link url="https://lib.onl/ru/2021/05/ee559a6c-5cde-5166-9d2d-3ceb55878eb8/">Debian: Статический IP-адрес</link></yandex:related><turbo:extendedHtml>true</turbo:extendedHtml><turbo:source>https://lib.onl/ru/2024/04/2e00b43b-b0da-59c2-ae92-60dcf2ba1d52/</turbo:source><turbo:topic>Установка и настройка Asterisk</turbo:topic><turbo:content><![CDATA[<p>Устанавливаем <span class="shortcode shortcode-tag"><a href="/ru/tags/asterisk/" target="_blank">#Asterisk</a></span> на ОС <span class="shortcode shortcode-tag"><a href="/ru/tags/debian/" target="_blank">#Debian</a></span> и создаём под него отдельного пользователя.</p>
<h2 id="обновление-ос-и-установка-пакетов">
  <a class="link-body-emphasis" href="#%d0%be%d0%b1%d0%bd%d0%be%d0%b2%d0%bb%d0%b5%d0%bd%d0%b8%d0%b5-%d0%be%d1%81-%d0%b8-%d1%83%d1%81%d1%82%d0%b0%d0%bd%d0%be%d0%b2%d0%ba%d0%b0-%d0%bf%d0%b0%d0%ba%d0%b5%d1%82%d0%be%d0%b2">Обновление ОС и установка пакетов</a>
</h2><p>Перед сборкой <span class="shortcode shortcode-tag"><a href="/ru/tags/asterisk/" target="_blank">#Asterisk</a></span> необходимо обновить пакеты ОС <span class="shortcode shortcode-tag"><a href="/ru/tags/debian/" target="_blank">#Debian</a></span>:</p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-0
shortcode-codeblock-bash">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-1e659cf8d3dd2ee191496d18a1599533" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">apt update <span class="o">&amp;&amp;</span> apt --yes full-upgrade</span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-1e659cf8d3dd2ee191496d18a1599533"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<h2 id="установка-asterisk">
  <a class="link-body-emphasis" href="#%d1%83%d1%81%d1%82%d0%b0%d0%bd%d0%be%d0%b2%d0%ba%d0%b0-asterisk">Установка Asterisk</a>
</h2><p>Сборку <span class="shortcode shortcode-tag"><a href="/ru/tags/asterisk/" target="_blank">#Asterisk</a></span> необходимо выполнять находясь в его директории.</p>
<h3 id="установка-компонентов">
  <a class="link-body-emphasis" href="#%d1%83%d1%81%d1%82%d0%b0%d0%bd%d0%be%d0%b2%d0%ba%d0%b0-%d0%ba%d0%be%d0%bc%d0%bf%d0%be%d0%bd%d0%b5%d0%bd%d1%82%d0%be%d0%b2">Установка компонентов</a>
</h3><p>Добавляем возможность использования MP3 и устанавливаем все зависимости для сборки:</p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-1
shortcode-codeblock-bash">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-ccd6c73962e25bbabeb71f899b81ba3b" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">bash ./contrib/scripts/get_mp3_source.sh <span class="o">&amp;&amp;</span> bash ./contrib/scripts/install_prereq install</span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-ccd6c73962e25bbabeb71f899b81ba3b"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<h3 id="конфигурация-сборки">
  <a class="link-body-emphasis" href="#%d0%ba%d0%be%d0%bd%d1%84%d0%b8%d0%b3%d1%83%d1%80%d0%b0%d1%86%d0%b8%d1%8f-%d1%81%d0%b1%d0%be%d1%80%d0%ba%d0%b8">Конфигурация сборки</a>
</h3><p>Выполняем конфигурирование и настройку компонентов:</p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-2
shortcode-codeblock-bash">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-c9518ca0abd3533ffd0f1665c4c9d564" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">./configure <span class="o">&amp;&amp;</span> make menuselect.makeopts <span class="o">&amp;&amp;</span> menuselect/menuselect --enable app_macro --enable chan_ooh323 --enable format_mp3 --enable codec_opus --enable CORE-SOUNDS-EN-WAV --enable CORE-SOUNDS-EN-ULAW --enable CORE-SOUNDS-EN-ALAW --enable CORE-SOUNDS-EN-GSM --enable CORE-SOUNDS-RU-WAV --enable CORE-SOUNDS-RU-ULAW --enable CORE-SOUNDS-RU-ALAW --enable CORE-SOUNDS-RU-GSM menuselect.makeopts</span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-c9518ca0abd3533ffd0f1665c4c9d564"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<p>Устанавливаются следующие компоненты:</p>
<ul>
<li><code>app_macro</code></li>
<li><code>chan_ooh323</code></li>
<li><code>format_mp3</code></li>
<li><code>codec_opus</code></li>
<li><code>CORE-SOUNDS-EN-WAV</code></li>
<li><code>CORE-SOUNDS-EN-ULAW</code></li>
<li><code>CORE-SOUNDS-EN-ALAW</code></li>
<li><code>CORE-SOUNDS-EN-GSM</code></li>
<li><code>CORE-SOUNDS-RU-WAV</code></li>
<li><code>CORE-SOUNDS-RU-ULAW</code></li>
<li><code>CORE-SOUNDS-RU-ALAW</code></li>
<li><code>CORE-SOUNDS-RU-GSM</code></li>
</ul>
<h3 id="сборка-и-установка-asterisk">
  <a class="link-body-emphasis" href="#%d1%81%d0%b1%d0%be%d1%80%d0%ba%d0%b0-%d0%b8-%d1%83%d1%81%d1%82%d0%b0%d0%bd%d0%be%d0%b2%d0%ba%d0%b0-asterisk">Сборка и установка Asterisk</a>
</h3><p>После конфигурирования, начинаем сборку:</p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-3
shortcode-codeblock-bash">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-231cbd12efeb1ee6fbf307b9a8f19c97" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">make <span class="o">&amp;&amp;</span> make install <span class="o">&amp;&amp;</span> make basic-pbx <span class="o">&amp;&amp;</span> make config <span class="o">&amp;&amp;</span> ldconfig</span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-231cbd12efeb1ee6fbf307b9a8f19c97"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<h2 id="настройка-asterisk">
  <a class="link-body-emphasis" href="#%d0%bd%d0%b0%d1%81%d1%82%d1%80%d0%be%d0%b9%d0%ba%d0%b0-asterisk">Настройка Asterisk</a>
</h2><h3 id="настройка-пользователя">
  <a class="link-body-emphasis" href="#%d0%bd%d0%b0%d1%81%d1%82%d1%80%d0%be%d0%b9%d0%ba%d0%b0-%d0%bf%d0%be%d0%bb%d1%8c%d0%b7%d0%be%d0%b2%d0%b0%d1%82%d0%b5%d0%bb%d1%8f">Настройка пользователя</a>
</h3><p>По умолчанию, <span class="shortcode shortcode-tag"><a href="/ru/tags/asterisk/" target="_blank">#Asterisk</a></span> использует пользователя <code>root</code> для работы. Это немного не правильно, сделаем так, чтобы <span class="shortcode shortcode-tag"><a href="/ru/tags/asterisk/" target="_blank">#Asterisk</a></span> работал под своим пользователем. Создаём пользователя:</p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-4
shortcode-codeblock-bash">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-dc3b9044adcaf57074313ccc7c121340" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="nv">u</span><span class="o">=</span><span class="s1">&#39;asterisk&#39;</span><span class="p">;</span> groupadd <span class="si">${</span><span class="nv">u</span><span class="si">}</span> <span class="o">&amp;&amp;</span> useradd -r -d /var/lib/<span class="si">${</span><span class="nv">u</span><span class="si">}</span> -g <span class="si">${</span><span class="nv">u</span><span class="si">}</span> <span class="si">${</span><span class="nv">u</span><span class="si">}</span> <span class="o">&amp;&amp;</span> usermod -aG audio,dialout <span class="si">${</span><span class="nv">u</span><span class="si">}</span> <span class="o">&amp;&amp;</span> chown -R <span class="si">${</span><span class="nv">u</span><span class="si">}</span>:<span class="si">${</span><span class="nv">u</span><span class="si">}</span> /etc/<span class="si">${</span><span class="nv">u</span><span class="si">}</span> <span class="o">&amp;&amp;</span> chown -R <span class="si">${</span><span class="nv">u</span><span class="si">}</span>:<span class="si">${</span><span class="nv">u</span><span class="si">}</span> /var/<span class="o">{</span>lib,log,spool<span class="o">}</span>/<span class="si">${</span><span class="nv">u</span><span class="si">}</span> <span class="o">&amp;&amp;</span> chown -R <span class="si">${</span><span class="nv">u</span><span class="si">}</span>:<span class="si">${</span><span class="nv">u</span><span class="si">}</span> /usr/lib/<span class="si">${</span><span class="nv">u</span><span class="si">}</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-dc3b9044adcaf57074313ccc7c121340"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<p>После создания пользователя, необходимо отредактировать конфигурационные файлы, чтобы указать Asterisk&rsquo;у под каким пользователем осуществлять запуск:</p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-5
shortcode-codeblock-bash">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-8e7589f994ed2966a56bc7f57cd91e61" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">sed -i -e <span class="s1">&#39;s|#AST_USER=&#34;asterisk&#34;|AST_USER=&#34;asterisk&#34;|g&#39;</span> -e <span class="s1">&#39;s|#AST_GROUP=&#34;asterisk&#34;|AST_GROUP=&#34;asterisk&#34;|g&#39;</span> <span class="s1">&#39;/etc/default/asterisk&#39;</span> <span class="o">&amp;&amp;</span> sed -i -e <span class="s1">&#39;s|;runuser = asterisk|runuser = asterisk|g&#39;</span> -e <span class="s1">&#39;s|;rungroup = asterisk|rungroup = asterisk|g&#39;</span> <span class="s1">&#39;/etc/asterisk/asterisk.conf&#39;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-8e7589f994ed2966a56bc7f57cd91e61"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<h2 id="запуск-asterisk">
  <a class="link-body-emphasis" href="#%d0%b7%d0%b0%d0%bf%d1%83%d1%81%d0%ba-asterisk">Запуск Asterisk</a>
</h2><p>Указываем автоматический запуск службы <span class="shortcode shortcode-tag"><a href="/ru/tags/asterisk/" target="_blank">#Asterisk</a></span>:</p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-6
shortcode-codeblock-bash">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-f9921822445b1707a6658f86b31515df" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">systemctl <span class="nb">enable</span> --now asterisk</span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-f9921822445b1707a6658f86b31515df"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<p>Проверяем:</p>











<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-7 shortcode-codeblock-terminal
shortcode-codeblock-terminal-linux
shortcode-codeblock-terminal-linux-root">
  <div class="card overflow-hidden" data-bs-theme="dark">
    <div class="card-header">
      <div class="d-flex align-items-center">
        <div class="flex-shrink-0 text-danger">
          <i class="fas fa-terminal fa-fw"></i>
        </div>
        <div class="flex-grow-1 mx-2">
          <h5 class="mb-0">Терминал</h5>
        </div>
        <div class="flex-shrink-0">
          <ul class="list-inline mb-0">
            <li class="list-inline-item" title='Копировать'>
              <a class="text-body" href="#"
                 data-fn="clipboard" data-clipboard-target="#cp-19ffedb9ded80050618745262af3e015"
                 role="button" aria-label='Копировать'>
                <i class="fas fa-copy fa-fw"></i>
              </a>
            </li>
          </ul>
        </div>
      </div>
    </div>
    <div class="card-body p-0 overflow-auto" id="cp-19ffedb9ded80050618745262af3e015"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-plaintext" data-lang="plaintext"><span class="line"><span class="cl">systemctl status asterisk
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">● asterisk.service - LSB: Asterisk PBX
</span></span><span class="line"><span class="cl">     Loaded: loaded (/etc/init.d/asterisk; generated)
</span></span><span class="line"><span class="cl">     Active: active (running) since Thu 2024-04-04 11:51:43 UTC; 2h 5min ago
</span></span><span class="line"><span class="cl">       Docs: man:systemd-sysv-generator(8)
</span></span><span class="line"><span class="cl">    Process: 791 ExecStart=/etc/init.d/asterisk start (code=exited, status=0/SUCCESS)
</span></span><span class="line"><span class="cl">      Tasks: 35 (limit: 1013)
</span></span><span class="line"><span class="cl">     Memory: 61.1M
</span></span><span class="line"><span class="cl">        CPU: 36.239s
</span></span><span class="line"><span class="cl">     CGroup: /system.slice/asterisk.service
</span></span><span class="line"><span class="cl">             └─871 /usr/sbin/asterisk -U asterisk -G asterisk
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Apr 04 11:51:42 phone systemd[1]: Starting LSB: Asterisk PBX...
</span></span><span class="line"><span class="cl">Apr 04 11:51:43 phone asterisk[791]:  * Starting Asterisk PBX: asterisk
</span></span><span class="line"><span class="cl">Apr 04 11:51:43 phone asterisk[791]:    ...done.
</span></span><span class="line"><span class="cl">Apr 04 11:51:43 phone systemd[1]: Started LSB: Asterisk PBX.</span></span></code></pre></td></tr></table>
</div>
</div></div>
  </div>
</div>
<p>Заходим в консоль <span class="shortcode shortcode-tag"><a href="/ru/tags/asterisk/" target="_blank">#Asterisk</a></span> и проверяем работу:</p>











<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-8 shortcode-codeblock-terminal
shortcode-codeblock-terminal-linux
shortcode-codeblock-terminal-linux-root">
  <div class="card overflow-hidden" data-bs-theme="dark">
    <div class="card-header">
      <div class="d-flex align-items-center">
        <div class="flex-shrink-0 text-danger">
          <i class="fas fa-terminal fa-fw"></i>
        </div>
        <div class="flex-grow-1 mx-2">
          <h5 class="mb-0">Терминал</h5>
        </div>
        <div class="flex-shrink-0">
          <ul class="list-inline mb-0">
            <li class="list-inline-item" title='Копировать'>
              <a class="text-body" href="#"
                 data-fn="clipboard" data-clipboard-target="#cp-5ef4e0af444cb5423844e684c7f7f748"
                 role="button" aria-label='Копировать'>
                <i class="fas fa-copy fa-fw"></i>
              </a>
            </li>
          </ul>
        </div>
      </div>
    </div>
    <div class="card-body p-0 overflow-auto" id="cp-5ef4e0af444cb5423844e684c7f7f748"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-plaintext" data-lang="plaintext"><span class="line"><span class="cl">asterisk -rvv
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Asterisk 20.7.0, Copyright (C) 1999 - 2022, Sangoma Technologies Corporation and others.
</span></span><span class="line"><span class="cl">Created by Mark Spencer &lt;markster@digium.com&gt;
</span></span><span class="line"><span class="cl">Asterisk comes with ABSOLUTELY NO WARRANTY; type &#39;core show warranty&#39; for details.
</span></span><span class="line"><span class="cl">This is free software, with components licensed under the GNU General Public
</span></span><span class="line"><span class="cl">License version 2 and other licenses; you are welcome to redistribute it under
</span></span><span class="line"><span class="cl">certain conditions. Type &#39;core show license&#39; for details.
</span></span><span class="line"><span class="cl">=========================================================================
</span></span><span class="line"><span class="cl">Running as user &#39;asterisk&#39;
</span></span><span class="line"><span class="cl">Running under group &#39;asterisk&#39;
</span></span><span class="line"><span class="cl">Connected to Asterisk 20.7.0 currently running on phone (pid = 871)
</span></span><span class="line"><span class="cl">phone*CLI&gt;</span></span></code></pre></td></tr></table>
</div>
</div></div>
  </div>
</div>
<h2 id="tls">
  <a class="link-body-emphasis" href="#tls">TLS</a>
</h2>








  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-9
shortcode-codeblock-bash">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-60a0bce84822a1d73b773d2d5a09e946" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">mkdir /etc/asterisk/keys</span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-60a0bce84822a1d73b773d2d5a09e946"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>











  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-10
shortcode-codeblock-bash">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-f70c6e7b6dab0cd14a9c92a6cdce99d3" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">nano /etc/asterisk/pjsip.conf</span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-f70c6e7b6dab0cd14a9c92a6cdce99d3"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>











  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-11
shortcode-codeblock-ini">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-f0bd6cfc8505f2b43062d898695fd9bd" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-ini" data-lang="ini"><span class="line"><span class="cl"><span class="k">[transport-tls]</span>
</span></span><span class="line"><span class="cl"><span class="na">type</span><span class="o">=</span><span class="s">transport</span>
</span></span><span class="line"><span class="cl"><span class="na">protocol</span><span class="o">=</span><span class="s">tls</span>
</span></span><span class="line"><span class="cl"><span class="na">bind</span><span class="o">=</span><span class="s">0.0.0.0:5061</span>
</span></span><span class="line"><span class="cl"><span class="na">cert_file</span><span class="o">=</span><span class="s">/etc/asterisk/keys/asterisk.crt</span>
</span></span><span class="line"><span class="cl"><span class="na">priv_key_file</span><span class="o">=</span><span class="s">/etc/asterisk/keys/asterisk.key</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-f0bd6cfc8505f2b43062d898695fd9bd"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>]]></turbo:content></item><item turbo="true"><title>MikroTik: Туннель IPsec (Site-to-Site)</title><link>https://lib.onl/ru/2024/03/54a2b39f-38b4-5f0c-9b54-310f853da38f/</link><pubDate>Sun, 31 Mar 2024 20:46:24 +0000</pubDate><dc:creator>Kai Kimera</dc:creator><category>Сеть</category><category>Скрипты</category><yandex:related><link url="https://lib.onl/ru/2023/10/cc13623b-970c-5950-867e-168f9ba9025a/">MikroTik: Добавление корневых сертификатов в RouterOS</link><link url="https://lib.onl/ru/2020/07/ff2ae66e-8e14-5c4a-baa6-0cd2e59f6517/">MikroTik и CloudFlare: Динамический IP для домена</link><link url="https://lib.onl/ru/2023/12/b6c7c5cd-1b0d-5fcd-8dd2-f28f87a5064c/">MikroTik: Настройка DoH</link></yandex:related><turbo:extendedHtml>true</turbo:extendedHtml><turbo:source>https://lib.onl/ru/2024/03/54a2b39f-38b4-5f0c-9b54-310f853da38f/</turbo:source><turbo:topic>MikroTik: Туннель IPsec (Site-to-Site)</turbo:topic><turbo:content><![CDATA[<p>Объединение двух маршрутизаторов между собой при помощи туннеля <span class="shortcode shortcode-tag"><a href="/ru/tags/ipsec/" target="_blank">#IPsec</a></span>.</p>
<p>В WAN IP у меня используются суб-домены. К суб-доменам через A-запись в <span class="shortcode shortcode-tag"><a href="/ru/tags/dns/" target="_blank">#DNS</a></span> прописаны внешние IP-адреса маршрутизаторов. При помощи скрипта из статьи <span class="shortcode shortcode-uuid"><a href="/ru/2020/07/ff2ae66e-8e14-5c4a-baa6-0cd2e59f6517/">MikroTik и CloudFlare: Динамический IP для домена</a></span> у меня каждый маршрутизатор имеет актуальный IP-адрес в суб-домене.</p>
<h2 id="вводные-данные">
  <a class="link-body-emphasis" href="#%d0%b2%d0%b2%d0%be%d0%b4%d0%bd%d1%8b%d0%b5-%d0%b4%d0%b0%d0%bd%d0%bd%d1%8b%d0%b5">Вводные данные</a>
</h2><ul>
<li>Маршрутизатор <code>R1</code>:
<ul>
<li>WAN IP: <code>gw1.example.com</code>.</li>
<li>LAN IP: <code>10.1.0.1</code>.</li>
<li>Network: <code>10.1.0.0/16</code>.</li>
</ul>
</li>
<li>Маршрутизатор <code>R2</code>:
<ul>
<li>WAN IP: <code>gw2.example.com</code>.</li>
<li>LAN IP: <code>10.2.0.1</code>.</li>
<li>Network: <code>10.2.0.0/16</code>.</li>
</ul>
</li>
</ul>
<h2 id="настройка-маршрутизаторов">
  <a class="link-body-emphasis" href="#%d0%bd%d0%b0%d1%81%d1%82%d1%80%d0%be%d0%b9%d0%ba%d0%b0-%d0%bc%d0%b0%d1%80%d1%88%d1%80%d1%83%d1%82%d0%b8%d0%b7%d0%b0%d1%82%d0%be%d1%80%d0%be%d0%b2">Настройка маршрутизаторов</a>
</h2><h3 id="router-1">
  <a class="link-body-emphasis" href="#router-1">Router #1</a>
</h3><ul>
<li>Добавляем профиль <span class="shortcode shortcode-tag"><a href="/ru/tags/ipsec/" target="_blank">#IPsec</a></span>:
<ul>
<li>Имя профиля: <code>ipsec-sts</code>.</li>
<li>Группа Diffie-Hellman (стойкость шифрования): <code>ecp384</code>.</li>
<li>Алгоритм шифрования: <code>aes-256</code>.</li>
</ul>
</li>
</ul>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-0
shortcode-codeblock-text">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-a4c91596a0820ae82ec7a33bdeb22c17" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-text" data-lang="text"><span class="line"><span class="cl">/ip ipsec profile
</span></span><span class="line"><span class="cl">add dh-group=ecp384 enc-algorithm=aes-256 name=ipsec-sts</span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-a4c91596a0820ae82ec7a33bdeb22c17"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<ul>
<li>Добавляем представление <span class="shortcode shortcode-tag"><a href="/ru/tags/ipsec/" target="_blank">#IPsec</a></span>:
<ul>
<li>Имя представления: <code>ipsec-sts</code>.</li>
<li>Алгоритм аутентификации: <code>sha256</code>.</li>
<li>Алгоритм шифрования: <code>aes-256-cbc</code>.</li>
<li>Группа Diffie-Hellman (стойкость шифрования): <code>ecp384</code>.</li>
</ul>
</li>
</ul>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-1
shortcode-codeblock-text">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-f879afc886591f72d4caaee55dd7cd9b" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-text" data-lang="text"><span class="line"><span class="cl">/ip ipsec proposal
</span></span><span class="line"><span class="cl">add auth-algorithms=sha256 enc-algorithms=aes-256-cbc name=ipsec-sts pfs-group=ecp384</span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-f879afc886591f72d4caaee55dd7cd9b"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<ul>
<li>Добавляем <span class="shortcode shortcode-tag"><a href="/ru/tags/ipsec/" target="_blank">#IPsec</a></span> peer:
<ul>
<li>Имя peer&rsquo;а: <code>GW2</code>.</li>
<li>Внешний адрес <code>R2</code>: <code>gw2.example.com</code>.</li>
<li>Профиль: <code>ipsec-sts</code>.</li>
<li>Режим обмена: <code>ike2</code>.</li>
<li>Комментарий: <code>GW2</code>.</li>
</ul>
</li>
</ul>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-2
shortcode-codeblock-text">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-85d4015071ef586881aa0c6b6258885d" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-text" data-lang="text"><span class="line"><span class="cl">/ip ipsec peer
</span></span><span class="line"><span class="cl">add address=&#34;gw2.example.com&#34; exchange-mode=ike2 name=GW2 profile=ipsec-sts comment=&#34;GW2&#34;</span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-85d4015071ef586881aa0c6b6258885d"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<ul>
<li>Добавляем идентификацию:
<ul>
<li>Peer: <code>GW2</code>.</li>
<li>Секретная фраза: <code>PassWord</code>.<br>
<em>Секретная фраза должна быть одинаковой на обоих маршрутизаторах.</em></li>
<li>Комментарий: <code>GW2</code>.</li>
</ul>
</li>
</ul>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-3
shortcode-codeblock-text">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-25b0b1709e1458da8fb552c46d4abe04" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-text" data-lang="text"><span class="line"><span class="cl">/ip ipsec identity
</span></span><span class="line"><span class="cl">add peer=GW2 secret=&#34;PassWord&#34; comment=&#34;GW2&#34;</span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-25b0b1709e1458da8fb552c46d4abe04"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<ul>
<li>Добавляем политику <span class="shortcode shortcode-tag"><a href="/ru/tags/ipsec/" target="_blank">#IPsec</a></span>:
<ul>
<li>Peer: <code>GW2</code>.</li>
<li>Туннель: <code>yes</code>.</li>
<li>Адрес локальной сети <code>R1</code>: <code>10.1.0.0/16</code>.</li>
<li>Адрес удалённой сети <code>R2</code>: <code>10.2.0.0/16</code>.</li>
<li>Действие: <code>encrypt</code>.</li>
<li>Представление: <code>ipsec-sts</code>.</li>
<li>Комментарий: <code>GW1-GW2</code>.</li>
</ul>
</li>
</ul>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-4
shortcode-codeblock-text">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-64dd5428ab793cdfc5d7715981b4c358" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-text" data-lang="text"><span class="line"><span class="cl">/ip ipsec policy
</span></span><span class="line"><span class="cl">add src-address=10.1.0.0/16 dst-address=10.2.0.0/16 tunnel=yes action=encrypt proposal=ipsec-sts peer=GW2 comment=&#34;GW1-GW2&#34;</span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-64dd5428ab793cdfc5d7715981b4c358"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<ul>
<li>Исключаем обработку трафика <span class="shortcode shortcode-tag"><a href="/ru/tags/ipsec/" target="_blank">#IPsec</a></span>:
<ul>
<li>Адрес локальной сети <code>R1</code>: <code>10.1.0.0/16</code>.</li>
<li>Адрес удалённой сети <code>R2</code>: <code>10.2.0.0/16</code>.</li>
<li>Комментарий: <code>[IPsec] GW1-GW2</code>.</li>
</ul>
</li>
</ul>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-5
shortcode-codeblock-text">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-0142e8716a79625e07dfeb589d59488b" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-text" data-lang="text"><span class="line"><span class="cl">/ip firewall nat
</span></span><span class="line"><span class="cl">add chain=srcnat action=accept src-address=10.1.0.0/16 dst-address=10.2.0.0/16 place-before=0 comment=&#34;[IPsec] GW1-GW2&#34;</span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-0142e8716a79625e07dfeb589d59488b"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<ul>
<li>Настраивает фильтры брандмауэра:
<ul>
<li>Открыть порты <code>500</code> и <code>4500</code> по протоколу <code>UDP</code>.</li>
<li>Разрешить трафик по протоколу <code>ipsec-esp</code>.</li>
</ul>
</li>
</ul>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-6
shortcode-codeblock-text">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-4c0f764c70e7bc8b9b9b1317576822a4" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-text" data-lang="text"><span class="line"><span class="cl">/ip firewall filter
</span></span><span class="line"><span class="cl">add action=accept chain=input dst-port=500,4500 in-interface-list=WAN protocol=udp comment=&#34;[ROS] IPsec&#34;
</span></span><span class="line"><span class="cl">add action=accept chain=input in-interface-list=WAN protocol=ipsec-esp comment=&#34;[ROS] IPsec&#34;</span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-4c0f764c70e7bc8b9b9b1317576822a4"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<ul>
<li>Настраиваем обход отслеживания соединений <span class="shortcode shortcode-tag"><a href="/ru/tags/ipsec/" target="_blank">#IPsec</a></span> для снижения нагрузки на CPU маршрутизатора:
<ul>
<li>Пакеты из удалённой сети <code>R2</code> <code>10.2.0.0/16</code> в локальную сеть <code>R1</code> <code>10.1.0.0/16</code>.</li>
<li>Пакеты из локальной сети <code>R1</code> <code>10.1.0.0/16</code> в удалённую сеть <code>R2</code> <code>10.2.0.0/16</code>.</li>
</ul>
</li>
</ul>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-7
shortcode-codeblock-text">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-819106ac9dac63681a91f58d48eb75ff" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-text" data-lang="text"><span class="line"><span class="cl">/ip firewall raw
</span></span><span class="line"><span class="cl">add action=notrack chain=prerouting src-address=10.2.0.0/16 dst-address=10.1.0.0/16 comment=&#34;[IPsec] GW2-GW1&#34;
</span></span><span class="line"><span class="cl">add action=notrack chain=prerouting src-address=10.1.0.0/16 dst-address=10.2.0.0/16 comment=&#34;[IPsec] GW1-GW2&#34;</span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-819106ac9dac63681a91f58d48eb75ff"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<h3 id="router-2">
  <a class="link-body-emphasis" href="#router-2">Router #2</a>
</h3><ul>
<li>Добавляем профиль <span class="shortcode shortcode-tag"><a href="/ru/tags/ipsec/" target="_blank">#IPsec</a></span>:
<ul>
<li>Имя профиля: <code>ipsec-sts</code>.</li>
<li>Группа Diffie-Hellman (стойкость шифрования): <code>ecp384</code>.</li>
<li>Алгоритм шифрования: <code>aes-256</code>.</li>
</ul>
</li>
</ul>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-8
shortcode-codeblock-text">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-95366e32f487a3f250e18ca36fd044eb" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-text" data-lang="text"><span class="line"><span class="cl">/ip ipsec profile
</span></span><span class="line"><span class="cl">add dh-group=ecp384 enc-algorithm=aes-256 name=ipsec-sts</span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-95366e32f487a3f250e18ca36fd044eb"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<ul>
<li>Добавляем представление <span class="shortcode shortcode-tag"><a href="/ru/tags/ipsec/" target="_blank">#IPsec</a></span>:
<ul>
<li>Имя представления: <code>ipsec-sts</code>.</li>
<li>Алгоритм аутентификации: <code>sha256</code>.</li>
<li>Алгоритм шифрования: <code>aes-256-cbc</code>.</li>
<li>Группа Diffie-Hellman (стойкость шифрования): <code>ecp384</code>.</li>
</ul>
</li>
</ul>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-9
shortcode-codeblock-text">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-1a8d5573539db38fbb9174fd919c4514" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-text" data-lang="text"><span class="line"><span class="cl">/ip ipsec proposal
</span></span><span class="line"><span class="cl">add auth-algorithms=sha256 enc-algorithms=aes-256-cbc name=ipsec-sts pfs-group=ecp384</span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-1a8d5573539db38fbb9174fd919c4514"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<ul>
<li>Добавляем <span class="shortcode shortcode-tag"><a href="/ru/tags/ipsec/" target="_blank">#IPsec</a></span> peer:
<ul>
<li>Имя peer&rsquo;а: <code>GW1</code>.</li>
<li>Внешний адрес <code>R1</code>: <code>gw1.example.com</code>.</li>
<li>Профиль: <code>ipsec-sts</code>.</li>
<li>Режим обмена: <code>ike2</code>.</li>
<li>Комментарий: <code>GW1</code>.</li>
</ul>
</li>
</ul>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-10
shortcode-codeblock-text">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-87ae8d298eaaaf1fec64f33c4569b45e" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-text" data-lang="text"><span class="line"><span class="cl">/ip ipsec peer
</span></span><span class="line"><span class="cl">add address=&#34;gw1.example.com&#34; exchange-mode=ike2 name=GW1 profile=ipsec-sts comment=&#34;GW1&#34;</span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-87ae8d298eaaaf1fec64f33c4569b45e"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<ul>
<li>Добавляем идентификацию:
<ul>
<li>Peer: <code>GW1</code>.</li>
<li>Секретная фраза: <code>PassWord</code>.<br>
<em>Секретная фраза должна быть одинаковой на обоих маршрутизаторах.</em></li>
<li>Комментарий: <code>GW1</code>.</li>
</ul>
</li>
</ul>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-11
shortcode-codeblock-text">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-d408cf737002ab16b59a9fe5f9f01fc6" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-text" data-lang="text"><span class="line"><span class="cl">/ip ipsec identity
</span></span><span class="line"><span class="cl">add peer=GW1 secret=&#34;PassWord&#34; comment=&#34;GW1&#34;</span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-d408cf737002ab16b59a9fe5f9f01fc6"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<ul>
<li>Добавляем политику <span class="shortcode shortcode-tag"><a href="/ru/tags/ipsec/" target="_blank">#IPsec</a></span>:
<ul>
<li>Peer: <code>GW1</code>.</li>
<li>Туннель: <code>yes</code>.</li>
<li>Адрес локальной сети <code>R2</code>: <code>10.2.0.0/16</code>.</li>
<li>Адрес удалённой сети <code>R1</code>: <code>10.1.0.0/16</code>.</li>
<li>Действие: <code>encrypt</code>.</li>
<li>Представление: <code>ipsec-sts</code>.</li>
<li>Комментарий: <code>GW2-GW1</code>.</li>
</ul>
</li>
</ul>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-12
shortcode-codeblock-text">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-27685faa6b8e5088485c38d8c7acb44b" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-text" data-lang="text"><span class="line"><span class="cl">/ip ipsec policy
</span></span><span class="line"><span class="cl">add src-address=10.2.0.0/16 dst-address=10.1.0.0/16 tunnel=yes action=encrypt proposal=ipsec-sts peer=GW1 comment=&#34;GW2-GW1&#34;</span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-27685faa6b8e5088485c38d8c7acb44b"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<ul>
<li>Исключаем обработку трафика <span class="shortcode shortcode-tag"><a href="/ru/tags/ipsec/" target="_blank">#IPsec</a></span>:
<ul>
<li>Адрес локальной сети <code>R2</code>: <code>10.2.0.0/16</code>.</li>
<li>Адрес удалённой сети <code>R1</code>: <code>10.1.0.0/16</code>.</li>
<li>Комментарий: <code>[IPsec] GW2-GW1</code>.</li>
</ul>
</li>
</ul>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-13
shortcode-codeblock-text">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-2c30e1ff719b84dce61408ab54913e04" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-text" data-lang="text"><span class="line"><span class="cl">/ip firewall nat
</span></span><span class="line"><span class="cl">add chain=srcnat action=accept src-address=10.2.0.0/16 dst-address=10.1.0.0/16 place-before=0 comment=&#34;[IPsec] GW2-GW1&#34;</span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-2c30e1ff719b84dce61408ab54913e04"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<ul>
<li>Настраивает фильтры брандмауэра:
<ul>
<li>Открыть порты <code>500</code> и <code>4500</code> по протоколу <code>UDP</code>.</li>
<li>Разрешить трафик по протоколу <code>ipsec-esp</code>.</li>
</ul>
</li>
</ul>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-14
shortcode-codeblock-text">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-b1e1abda8db2614731dd9fc35f61a1c6" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-text" data-lang="text"><span class="line"><span class="cl">/ip firewall filter
</span></span><span class="line"><span class="cl">add action=accept chain=input dst-port=500,4500 in-interface-list=WAN protocol=udp comment=&#34;[ROS] IPsec&#34;
</span></span><span class="line"><span class="cl">add action=accept chain=input in-interface-list=WAN protocol=ipsec-esp comment=&#34;[ROS] IPsec&#34;</span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-b1e1abda8db2614731dd9fc35f61a1c6"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<ul>
<li>Настраиваем обход отслеживания соединений <span class="shortcode shortcode-tag"><a href="/ru/tags/ipsec/" target="_blank">#IPsec</a></span> для снижения нагрузки на CPU маршрутизатора:
<ul>
<li>Пакеты из удалённой сети <code>R1</code> <code>10.1.0.0/16</code> в локальную сеть <code>R2</code> <code>10.2.0.0/16</code>.</li>
<li>Пакеты из локальной сети <code>R2</code> <code>10.2.0.0/16</code> в удалённую сеть <code>R1</code> <code>10.1.0.0/16</code>.</li>
</ul>
</li>
</ul>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-15
shortcode-codeblock-text">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-c71b0f53a1f66b7fd56a4cbc3cc81295" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-text" data-lang="text"><span class="line"><span class="cl">/ip firewall raw
</span></span><span class="line"><span class="cl">add action=notrack chain=prerouting src-address=10.1.0.0/16 dst-address=10.2.0.0/16 comment=&#34;[IPsec] GW1-GW2&#34;
</span></span><span class="line"><span class="cl">add action=notrack chain=prerouting src-address=10.2.0.0/16 dst-address=10.1.0.0/16 comment=&#34;[IPsec] GW2-GW1&#34;</span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-c71b0f53a1f66b7fd56a4cbc3cc81295"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<h2 id="автоматизация">
  <a class="link-body-emphasis" href="#%d0%b0%d0%b2%d1%82%d0%be%d0%bc%d0%b0%d1%82%d0%b8%d0%b7%d0%b0%d1%86%d0%b8%d1%8f">Автоматизация</a>
</h2><p>Сделал небольшой скрипт, который позволяет быстро развернуть туннель между двумя маршрутизаторами. Скрипт запускается отдельно на каждом из маршрутизаторов со своими настройками.</p>

    

    
        
            
            <div class="shortcode shortcode-file mb-3">
              <div class="card overflow-hidden" data-bs-theme="dark">
                <div class="card-header">
                  <div class="d-flex align-items-center">
                    <div class="flex-shrink-0">
                      <i class="far fa-file-code fa-fw"></i>
                    </div>
                    <div class="flex-grow-1 mx-2 text-truncate">
                      <code>ros.ipsec.rsc</code>
                    </div>
                    <div class="flex-shrink-0">
                      <ul class="list-inline mb-0">
                        <li class="list-inline-item" title='Копировать'>
                          <a class="text-body" href="#"
                             data-fn="clipboard" data-clipboard-target="#cp-b3c8a0117281a97e9fd3876f75a042dd"
                             role="button" aria-label='Копировать'>
                            <i class="fas fa-copy fa-fw"></i>
                          </a>
                        </li>
                        <li class="list-inline-item" title='Скачать'>
                          <a class="text-body" href="/ru/2024/03/54a2b39f-38b4-5f0c-9b54-310f853da38f/ros.ipsec.rsc" download
                             role="button" aria-label='Скачать'>
                            <i class="fas fa-download fa-fw"></i>
                          </a>
                        </li>
                        <li class="list-inline-item" title='Открыть'>
                          <a class="text-body" href="/ru/2024/03/54a2b39f-38b4-5f0c-9b54-310f853da38f/ros.ipsec.rsc" target="_blank"
                             role="button" aria-label='Открыть'>
                            <i class="fas fa-arrow-up-right-from-square fa-fw"></i>
                          </a>
                        </li>
                      </ul>
                    </div>
                  </div>
                </div>
                <div class="card-body p-0 overflow-auto" id="cp-b3c8a0117281a97e9fd3876f75a042dd">
                    
                    <div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span><span class="lnt">56
</span><span class="lnt">57
</span><span class="lnt">58
</span><span class="lnt">59
</span><span class="lnt">60
</span><span class="lnt">61
</span><span class="lnt">62
</span><span class="lnt">63
</span><span class="lnt">64
</span><span class="lnt">65
</span><span class="lnt">66
</span><span class="lnt">67
</span><span class="lnt">68
</span><span class="lnt">69
</span><span class="lnt">70
</span><span class="lnt">71
</span><span class="lnt">72
</span><span class="lnt">73
</span><span class="lnt">74
</span><span class="lnt">75
</span><span class="lnt">76
</span><span class="lnt">77
</span><span class="lnt">78
</span><span class="lnt">79
</span><span class="lnt">80
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-text" data-lang="text"><span class="line"><span class="cl"># @package    MikroTik / RouterOS / IPsec
</span></span><span class="line"><span class="cl"># @author     Kai Kimera &lt;mail@kai.kim&gt;
</span></span><span class="line"><span class="cl"># @copyright  2024 Library Online
</span></span><span class="line"><span class="cl"># @license    MIT
</span></span><span class="line"><span class="cl"># @version    0.1.0
</span></span><span class="line"><span class="cl"># @link       https://lib.onl/ru/2024/03/54a2b39f-38b4-5f0c-9b54-310f853da38f/
</span></span><span class="line"><span class="cl"># -------------------------------------------------------------------------------------------------------------------- #
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"># IPsec secret phrase.
</span></span><span class="line"><span class="cl">:local ipsSecret &#34;PassWord&#34;
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"># IPsec external interface.
</span></span><span class="line"><span class="cl">:local ipsInterface &#34;WAN&#34;
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"># IPsec profile name.
</span></span><span class="line"><span class="cl">:local ipsProfileName &#34;ipsec-sts&#34;
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"># -------------------------------------------------------------------------------------------------------------------- #
</span></span><span class="line"><span class="cl"># Local router.
</span></span><span class="line"><span class="cl"># -------------------------------------------------------------------------------------------------------------------- #
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"># Local router name.
</span></span><span class="line"><span class="cl">:local ipsLocalName &#34;GW1&#34;
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"># Local network address.
</span></span><span class="line"><span class="cl">:local ipsLocalNetwork &#34;10.1.0.0/16&#34;
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"># -------------------------------------------------------------------------------------------------------------------- #
</span></span><span class="line"><span class="cl"># Remote router.
</span></span><span class="line"><span class="cl"># -------------------------------------------------------------------------------------------------------------------- #
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"># Remote router name.
</span></span><span class="line"><span class="cl">:local ipsRemoteName &#34;GW2&#34;
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"># Remote network address.
</span></span><span class="line"><span class="cl">:local ipsRemoteNetwork &#34;10.2.0.0/16&#34;
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"># Remote external IP address.
</span></span><span class="line"><span class="cl">:local ipsRemoteWanIp &#34;gw2.example.com&#34;
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"># -------------------------------------------------------------------------------------------------------------------- #
</span></span><span class="line"><span class="cl"># -----------------------------------------------------&lt; SCRIPT &gt;----------------------------------------------------- #
</span></span><span class="line"><span class="cl"># -------------------------------------------------------------------------------------------------------------------- #
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">/ip ipsec profile
</span></span><span class="line"><span class="cl">add dh-group=ecp384 enc-algorithm=aes-256 name=$ipsProfileName
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">/ip ipsec proposal
</span></span><span class="line"><span class="cl">add auth-algorithms=sha256 enc-algorithms=aes-256-cbc pfs-group=ecp384 name=$ipsProfileName
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">/ip ipsec peer
</span></span><span class="line"><span class="cl">add address=$ipsRemoteWanIp exchange-mode=ike2 name=$ipsRemoteName profile=$ipsProfileName \
</span></span><span class="line"><span class="cl">  comment=&#34;$ipsRemoteName&#34;
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">/ip ipsec identity
</span></span><span class="line"><span class="cl">add peer=$ipsRemoteName secret=&#34;$ipsSecret&#34; \
</span></span><span class="line"><span class="cl">  comment=&#34;$ipsRemoteName&#34;
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">/ip ipsec policy
</span></span><span class="line"><span class="cl">add src-address=$ipsLocalNetwork dst-address=$ipsRemoteNetwork tunnel=yes action=encrypt \
</span></span><span class="line"><span class="cl">  proposal=$ipsProfileName peer=$ipsRemoteName \
</span></span><span class="line"><span class="cl">  comment=&#34;$ipsLocalName-$ipsRemoteName&#34;
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">/ip firewall nat
</span></span><span class="line"><span class="cl">add chain=srcnat action=accept src-address=$ipsLocalNetwork dst-address=$ipsRemoteNetwork place-before=0 \
</span></span><span class="line"><span class="cl">  comment=&#34;[IPsec] $ipsLocalName-$ipsRemoteName&#34;
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">/ip firewall filter
</span></span><span class="line"><span class="cl">add action=accept chain=input dst-port=500,4500 in-interface-list=$ipsWan protocol=udp \
</span></span><span class="line"><span class="cl">  comment=&#34;[ROS] IPsec&#34;
</span></span><span class="line"><span class="cl">add action=accept chain=input in-interface-list=$ipsWan protocol=ipsec-esp \
</span></span><span class="line"><span class="cl">  comment=&#34;[ROS] IPsec&#34;
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"># Use IP/Firewall/Raw to bypass connection tracking, that way eliminating need of filter rules and reducing load on CPU
</span></span><span class="line"><span class="cl"># by approximately 30%.
</span></span><span class="line"><span class="cl">/ip firewall raw
</span></span><span class="line"><span class="cl">add action=notrack chain=prerouting src-address=$ipsRemoteNetwork dst-address=$ipsLocalNetwork \
</span></span><span class="line"><span class="cl">  comment=&#34;[IPsec] $ipsRemoteName-$ipsLocalName&#34;
</span></span><span class="line"><span class="cl">add action=notrack chain=prerouting src-address=$ipsLocalNetwork dst-address=$ipsRemoteNetwork \
</span></span><span class="line"><span class="cl">  comment=&#34;[IPsec] $ipsLocalName-$ipsRemoteName&#34;</span></span></code></pre></td></tr></table>
</div>
</div>
                </div>
              </div>
            </div>]]></turbo:content></item><item turbo="true"><title>Cisco: Обновление IOS</title><link>https://lib.onl/ru/2024/03/b81f9cca-d723-5b72-929a-b88be9d329f9/</link><pubDate>Wed, 27 Mar 2024 18:41:49 +0000</pubDate><dc:creator>Kai Kimera</dc:creator><category>Сеть</category><category>Терминал</category><yandex:related><link url="https://lib.onl/ru/2024/03/4a7addb9-eff3-5482-902c-791fbe49899f/">Cisco: Загрузка и выгрузка конфигурации</link><link url="https://lib.onl/ru/2024/03/fc67eb74-8f7c-5de3-bd1e-2d823208eae2/">Cisco: Сброс пароля</link><link url="https://lib.onl/ru/2021/05/0acd3f9d-07b7-52b8-9fac-b5cb1cc579e0/">Обновление Fedora Linux до актуальной версии</link></yandex:related><turbo:extendedHtml>true</turbo:extendedHtml><turbo:source>https://lib.onl/ru/2024/03/b81f9cca-d723-5b72-929a-b88be9d329f9/</turbo:source><turbo:topic>Cisco: Обновление IOS</turbo:topic><turbo:content><![CDATA[<p>Инструкция по резервному копированию и обновлению <span class="shortcode shortcode-tag"><a href="/ru/tags/cisco/" target="_blank">#Cisco</a></span> <span class="shortcode shortcode-tag"><a href="/ru/tags/ios/" target="_blank">#IOS</a></span>.</p>
<h2 id="общая-настройка">
  <a class="link-body-emphasis" href="#%d0%be%d0%b1%d1%89%d0%b0%d1%8f-%d0%bd%d0%b0%d1%81%d1%82%d1%80%d0%be%d0%b9%d0%ba%d0%b0">Общая настройка</a>
</h2><p>Необходимо предварительно настроить сетевой интерфейс компьютера со следующими параметрами:</p>
<ul>
<li>IP-адрес: <code>192.168.1.2</code>.</li>
<li>Маска подсети: <code>255.255.255.0</code>.</li>
<li>Шлюз: <code>192.168.1.1</code>.</li>
<li>DNS: <code>8.8.8.8</code>.</li>
</ul>
<p>Теперь настроим сетевой интерфейс <code>FE0/1</code> на <span class="shortcode shortcode-tag"><a href="/ru/tags/cisco/" target="_blank">#Cisco</a></span>:</p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-0
shortcode-codeblock-plaintext">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-1672fa9735176c4018039831b2092b8a" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-plaintext" data-lang="plaintext"><span class="line"><span class="cl"># conf t
</span></span><span class="line"><span class="cl">(config)# int fa0/1
</span></span><span class="line"><span class="cl">(config-if)# ip address 192.168.1.1 255.255.255.0
</span></span><span class="line"><span class="cl">(config-if)# no shutdown
</span></span><span class="line"><span class="cl">(config-if)# exit
</span></span><span class="line"><span class="cl">(config)# exit
</span></span><span class="line"><span class="cl">#</span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-1672fa9735176c4018039831b2092b8a"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<p>После предварительных настроек, подключим сетевой интерфейс компьютера к сетевому интерфейсу <span class="shortcode shortcode-tag"><a href="/ru/tags/cisco/" target="_blank">#Cisco</a></span> <code>FE0/1</code> и запустим TFTP-сервер на компьютере c IP <code>192.168.1.2</code>.</p>
<h2 id="резервное-копирование-текущего-образа-ios">
  <a class="link-body-emphasis" href="#%d1%80%d0%b5%d0%b7%d0%b5%d1%80%d0%b2%d0%bd%d0%be%d0%b5-%d0%ba%d0%be%d0%bf%d0%b8%d1%80%d0%be%d0%b2%d0%b0%d0%bd%d0%b8%d0%b5-%d1%82%d0%b5%d0%ba%d1%83%d1%89%d0%b5%d0%b3%d0%be-%d0%be%d0%b1%d1%80%d0%b0%d0%b7%d0%b0-ios">Резервное копирование текущего образа IOS</a>
</h2><p>Смотрим текущую версию <span class="shortcode shortcode-tag"><a href="/ru/tags/ios/" target="_blank">#IOS</a></span>:</p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-1
shortcode-codeblock-plaintext">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-1ead3b0721367ec554ed9a0e17d23853" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-plaintext" data-lang="plaintext"><span class="line"><span class="cl"># show version</span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-1ead3b0721367ec554ed9a0e17d23853"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<p>На всякий случай, делаем резервную копию текущего образа <span class="shortcode shortcode-tag"><a href="/ru/tags/ios/" target="_blank">#IOS</a></span> на TFTP-сервер:</p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-2
shortcode-codeblock-plaintext">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-cfee0e3227754495bee32c2dc5fd0da6" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-plaintext" data-lang="plaintext"><span class="line"><span class="cl"># show flash: | include .bin
</span></span><span class="line"><span class="cl"># copy flash:IOS_FW.bin tftp://192.168.1.2</span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-cfee0e3227754495bee32c2dc5fd0da6"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<p>Где:</p>
<ul>
<li><code>flash:IOS_FW.bin</code> - источник, файл текущего образа <span class="shortcode shortcode-tag"><a href="/ru/tags/ios/" target="_blank">#IOS</a></span> на flash-карте (<code>IOS_FW.bin</code>).</li>
<li><code>tftp://192.168.1.2</code> - назначение, IP-адрес TFTP-сервера.</li>
</ul>
<h2 id="загрузка-нового-образа-ios">
  <a class="link-body-emphasis" href="#%d0%b7%d0%b0%d0%b3%d1%80%d1%83%d0%b7%d0%ba%d0%b0-%d0%bd%d0%be%d0%b2%d0%be%d0%b3%d0%be-%d0%be%d0%b1%d1%80%d0%b0%d0%b7%d0%b0-ios">Загрузка нового образа IOS</a>
</h2><p>Загружаем на флэш-карту новый образ <span class="shortcode shortcode-tag"><a href="/ru/tags/ios/" target="_blank">#IOS</a></span>:</p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-3
shortcode-codeblock-plaintext">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-e33fdf476ffa04f292abd03efb4a3c99" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-plaintext" data-lang="plaintext"><span class="line"><span class="cl"># copy tftp://192.168.1.2/IOS_FW.bin flash:</span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-e33fdf476ffa04f292abd03efb4a3c99"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<p>Где:</p>
<ul>
<li><code>tftp://192.168.1.2/IOS_FW.bin</code> - источник, адрес TFTP-сервера и путь к файлу с образом <span class="shortcode shortcode-tag"><a href="/ru/tags/ios/" target="_blank">#IOS</a></span> (<code>IOS_FW.bin</code>).</li>
<li><code>flash:</code> - назначение, flash-карта.</li>
</ul>
<h2 id="верификация-нового-образа-ios">
  <a class="link-body-emphasis" href="#%d0%b2%d0%b5%d1%80%d0%b8%d1%84%d0%b8%d0%ba%d0%b0%d1%86%d0%b8%d1%8f-%d0%bd%d0%be%d0%b2%d0%be%d0%b3%d0%be-%d0%be%d0%b1%d1%80%d0%b0%d0%b7%d0%b0-ios">Верификация нового образа IOS</a>
</h2><p>Проверяем контрольную сумму загруженного образа <span class="shortcode shortcode-tag"><a href="/ru/tags/ios/" target="_blank">#IOS</a></span>:</p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-4
shortcode-codeblock-plaintext">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-728b3f44680396641d6a4f3377c54848" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-plaintext" data-lang="plaintext"><span class="line"><span class="cl"># show flash: | include .bin
</span></span><span class="line"><span class="cl"># verify /md5 flash:IOS_FW.bin</span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-728b3f44680396641d6a4f3377c54848"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<p>Где:</p>
<ul>
<li><code>flash:IOS_FW.bin</code> - образ <span class="shortcode shortcode-tag"><a href="/ru/tags/ios/" target="_blank">#IOS</a></span> (<code>IOS_FW.bin</code>) на flash-карте.</li>
</ul>
<h2 id="обновление-ios">
  <a class="link-body-emphasis" href="#%d0%be%d0%b1%d0%bd%d0%be%d0%b2%d0%bb%d0%b5%d0%bd%d0%b8%d0%b5-ios">Обновление IOS</a>
</h2>



    








    
    






<div class="shortcode shortcode-alert">
  <div class="alert alert-warning d-flex overflow-hidden" role="alert">
    <div class="flex-shrink-0 align-self-center">
      <i class="fas fa-exclamation-triangle fa-fw fa-2x"></i>
    </div>
    <div class="flex-grow-1 ms-3 overflow-hidden">
        <p>Перед обновлением рекомендуется сделать резервную копию лицензий:</p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-0
shortcode-codeblock-plaintext">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-04468a5d210253908e2c97843a7c2de8" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-plaintext" data-lang="plaintext"><span class="line"><span class="cl"># license save flash:ALL_LICENSE.lic</span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-04468a5d210253908e2c97843a7c2de8"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>



    </div>
  </div>
</div>

<p>Прописываем в конфигурации <span class="shortcode shortcode-tag"><a href="/ru/tags/cisco/" target="_blank">#Cisco</a></span> загрузку нового образа <span class="shortcode shortcode-tag"><a href="/ru/tags/ios/" target="_blank">#IOS</a></span> и перезагружаем оборудование:</p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-5
shortcode-codeblock-plaintext">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-84803917131b194fb87a5354e661633a" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-plaintext" data-lang="plaintext"><span class="line"><span class="cl"># conf t
</span></span><span class="line"><span class="cl">(config)# boot system flash IOS_FW.bin
</span></span><span class="line"><span class="cl">(config)# exit
</span></span><span class="line"><span class="cl"># reload</span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-84803917131b194fb87a5354e661633a"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<p>Где:</p>
<ul>
<li><code>flash:IOS_FW.bin</code> - образ <span class="shortcode shortcode-tag"><a href="/ru/tags/ios/" target="_blank">#IOS</a></span> (<code>IOS_FW.bin</code>) на flash-карте.</li>
</ul>
<h2 id="проверка-новой-версии-ios">
  <a class="link-body-emphasis" href="#%d0%bf%d1%80%d0%be%d0%b2%d0%b5%d1%80%d0%ba%d0%b0-%d0%bd%d0%be%d0%b2%d0%be%d0%b9-%d0%b2%d0%b5%d1%80%d1%81%d0%b8%d0%b8-ios">Проверка новой версии IOS</a>
</h2><p>После перезагрузки смотрим версию <span class="shortcode shortcode-tag"><a href="/ru/tags/ios/" target="_blank">#IOS</a></span>:</p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-6
shortcode-codeblock-plaintext">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-4ed9e26416976107b4203045ae6d2448" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-plaintext" data-lang="plaintext"><span class="line"><span class="cl"># show version</span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-4ed9e26416976107b4203045ae6d2448"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<p>Готово!</p>]]></turbo:content></item><item turbo="true"><title>Проверка DNS-записей домена</title><link>https://lib.onl/ru/2024/03/bd4f198b-907e-5c14-90c6-a7c032891ce0/</link><pubDate>Wed, 27 Mar 2024 14:25:34 +0000</pubDate><dc:creator>Kai Kimera</dc:creator><category>Сеть</category><category>Linux</category><category>MS Windows</category><yandex:related><link url="https://lib.onl/ru/2022/08/badb30a9-0471-5dab-a422-85422c0ac611/">Включение DNS over TLS (DoT) в OPNsense</link><link url="https://lib.onl/ru/2021/05/ee559a6c-5cde-5166-9d2d-3ceb55878eb8/">Debian: Статический IP-адрес</link></yandex:related><turbo:extendedHtml>true</turbo:extendedHtml><turbo:source>https://lib.onl/ru/2024/03/bd4f198b-907e-5c14-90c6-a7c032891ce0/</turbo:source><turbo:topic>Проверка DNS-записей домена</turbo:topic><turbo:content><![CDATA[<p>Когда требуется узнать информацию о домене, можно воспользоваться локальными утилитами для диагностики его DNS-записей.</p>
<h2 id="общая-информация">
  <a class="link-body-emphasis" href="#%d0%be%d0%b1%d1%89%d0%b0%d1%8f-%d0%b8%d0%bd%d1%84%d0%be%d1%80%d0%bc%d0%b0%d1%86%d0%b8%d1%8f">Общая информация</a>
</h2><p>Рассмотрим запросы общей информации по доменам.</p>
<h3 id="dig">
  <a class="link-body-emphasis" href="#dig">Dig</a>
</h3><p>Получить общую информацию по домену в <code>Dig</code>:</p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-0
shortcode-codeblock-bash">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-e2fa149cd4ef1309bd2663fe61363f66" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">dig example.com</span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-e2fa149cd4ef1309bd2663fe61363f66"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<p>Результат запроса:</p>











<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-1 shortcode-codeblock-terminal
shortcode-codeblock-terminal-linux
shortcode-codeblock-terminal-linux-user">
  <div class="card overflow-hidden" data-bs-theme="dark">
    <div class="card-header">
      <div class="d-flex align-items-center">
        <div class="flex-shrink-0 ">
          <i class="fas fa-terminal fa-fw"></i>
        </div>
        <div class="flex-grow-1 mx-2">
          <h5 class="mb-0">Терминал</h5>
        </div>
        <div class="flex-shrink-0">
          <ul class="list-inline mb-0">
            <li class="list-inline-item" title='Копировать'>
              <a class="text-body" href="#"
                 data-fn="clipboard" data-clipboard-target="#cp-dbcbeb7267432c0460250a084772b8aa"
                 role="button" aria-label='Копировать'>
                <i class="fas fa-copy fa-fw"></i>
              </a>
            </li>
          </ul>
        </div>
      </div>
    </div>
    <div class="card-body p-0 overflow-auto" id="cp-dbcbeb7267432c0460250a084772b8aa"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-dns" data-lang="dns"><span class="line"><span class="cl"><span class="nc">dig</span><span class="w"> </span><span class="nc">google.com</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c">; &lt;&lt;&gt;&gt; DiG 9.18.24-1-Debian &lt;&lt;&gt;&gt; google.com</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c">;; global options: +cmd</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c">;; Got answer:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c">;; -&gt;&gt;HEADER&lt;&lt;- opcode: QUERY, status: NOERROR, id: 19217</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c">;; flags: qr rd ra; QUERY: 1, ANSWER: 6, AUTHORITY: 0, ADDITIONAL: 1</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c">;; OPT PSEUDOSECTION:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c">; EDNS: version: 0, flags:; udp: 4000</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c">;; QUESTION SECTION:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c">;google.com.                    IN      A</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c">;; ANSWER SECTION:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="py">google.com. </span><span class="w">            </span><span class="sc">112</span><span class="w">     </span><span class="k">IN</span><span class="w">      </span><span class="k">A</span><span class="w">       </span><span class="mi">173.194.222.101</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="py">google.com. </span><span class="w">            </span><span class="sc">112</span><span class="w">     </span><span class="k">IN</span><span class="w">      </span><span class="k">A</span><span class="w">       </span><span class="mi">173.194.222.139</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="py">google.com. </span><span class="w">            </span><span class="sc">112</span><span class="w">     </span><span class="k">IN</span><span class="w">      </span><span class="k">A</span><span class="w">       </span><span class="mi">173.194.222.113</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="py">google.com. </span><span class="w">            </span><span class="sc">112</span><span class="w">     </span><span class="k">IN</span><span class="w">      </span><span class="k">A</span><span class="w">       </span><span class="mi">173.194.222.138</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="py">google.com. </span><span class="w">            </span><span class="sc">112</span><span class="w">     </span><span class="k">IN</span><span class="w">      </span><span class="k">A</span><span class="w">       </span><span class="mi">173.194.222.100</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="py">google.com. </span><span class="w">            </span><span class="sc">112</span><span class="w">     </span><span class="k">IN</span><span class="w">      </span><span class="k">A</span><span class="w">       </span><span class="mi">173.194.222.102</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c">;; Query time: 4 msec</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c">;; SERVER: 172.16.18.22#53(172.16.18.22) (UDP)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c">;; WHEN: Mon Apr 15 09:14:51 UTC 2024</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c">;; MSG SIZE  rcvd: 135</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
  </div>
</div>
<p>Где:</p>
<ul>
<li><code>;; SERVER: 172.16.18.22#53(172.16.18.22) (UDP)</code> - сервер DNS, с которого пришёл ответ.</li>
</ul>
<h3 id="drill">
  <a class="link-body-emphasis" href="#drill">Drill</a>
</h3><p>Получить общую информацию по домену в <code>Drill</code>:</p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-2
shortcode-codeblock-bash">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-5203deddbc7344eed5345c62ce3185f9" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">drill example.com</span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-5203deddbc7344eed5345c62ce3185f9"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<p>Результат запроса:</p>











<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-3 shortcode-codeblock-terminal
shortcode-codeblock-terminal-linux
shortcode-codeblock-terminal-linux-user">
  <div class="card overflow-hidden" data-bs-theme="dark">
    <div class="card-header">
      <div class="d-flex align-items-center">
        <div class="flex-shrink-0 ">
          <i class="fas fa-terminal fa-fw"></i>
        </div>
        <div class="flex-grow-1 mx-2">
          <h5 class="mb-0">Терминал</h5>
        </div>
        <div class="flex-shrink-0">
          <ul class="list-inline mb-0">
            <li class="list-inline-item" title='Копировать'>
              <a class="text-body" href="#"
                 data-fn="clipboard" data-clipboard-target="#cp-ea8030997a8ca2330570da346c2f74b4"
                 role="button" aria-label='Копировать'>
                <i class="fas fa-copy fa-fw"></i>
              </a>
            </li>
          </ul>
        </div>
      </div>
    </div>
    <div class="card-body p-0 overflow-auto" id="cp-ea8030997a8ca2330570da346c2f74b4"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-dns" data-lang="dns"><span class="line"><span class="cl"><span class="nc">drill</span><span class="w"> </span><span class="nc">google.com</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c">;; -&gt;&gt;HEADER&lt;&lt;- opcode: QUERY, rcode: NOERROR, id: 45117</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c">;; flags: qr rd ra ; QUERY: 1, ANSWER: 1, AUTHORITY: 0, ADDITIONAL: 0</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c">;; QUESTION SECTION:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c">;; google.com.  IN      A</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c">;; ANSWER SECTION:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="py">google.com. </span><span class="w">    </span><span class="sc">184</span><span class="w">     </span><span class="k">IN</span><span class="w">      </span><span class="k">A</span><span class="w">       </span><span class="mi">216.58.210.142</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c">;; AUTHORITY SECTION:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c">;; ADDITIONAL SECTION:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c">;; Query time: 3 msec</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c">;; SERVER: 10.1.0.1</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c">;; WHEN: Wed Mar 27 17:41:27 2024</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c">;; MSG SIZE  rcvd: 44</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
  </div>
</div>
<p>Где:</p>
<ul>
<li><code>;; SERVER: 172.16.18.22#53(172.16.18.22) (UDP)</code> - сервер DNS, с которого пришёл ответ.</li>
</ul>
<h3 id="nslookup">
  <a class="link-body-emphasis" href="#nslookup">NSLookUp</a>
</h3><p>Получить общую информацию по домену в <code>NSLookUp</code>:</p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-4
shortcode-codeblock-bash">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-00998df4039887ff8b456e19e86203ae" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">nslookup example.com</span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-00998df4039887ff8b456e19e86203ae"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<p>Результат запроса:</p>











<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-5 shortcode-codeblock-terminal
shortcode-codeblock-terminal-linux
shortcode-codeblock-terminal-linux-user">
  <div class="card overflow-hidden" data-bs-theme="dark">
    <div class="card-header">
      <div class="d-flex align-items-center">
        <div class="flex-shrink-0 ">
          <i class="fas fa-terminal fa-fw"></i>
        </div>
        <div class="flex-grow-1 mx-2">
          <h5 class="mb-0">Терминал</h5>
        </div>
        <div class="flex-shrink-0">
          <ul class="list-inline mb-0">
            <li class="list-inline-item" title='Копировать'>
              <a class="text-body" href="#"
                 data-fn="clipboard" data-clipboard-target="#cp-09a4dcc39e89995a612bba19eaf0ee6e"
                 role="button" aria-label='Копировать'>
                <i class="fas fa-copy fa-fw"></i>
              </a>
            </li>
          </ul>
        </div>
      </div>
    </div>
    <div class="card-body p-0 overflow-auto" id="cp-09a4dcc39e89995a612bba19eaf0ee6e"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-dns" data-lang="dns"><span class="line"><span class="cl"><span class="nc">nslookup</span><span class="w"> </span><span class="nc">google.com</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nc">Server</span><span class="err">:</span><span class="w">         </span><span class="mi">172.16.18.22</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nc">Address</span><span class="err">:</span><span class="w">        </span><span class="mi">172.16.18.22</span><span class="err">#</span><span class="sc">53</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nc">Non-authoritative</span><span class="w"> </span><span class="err">answer:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nc">Name</span><span class="err">:</span><span class="w">   </span><span class="nc">google.com</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nc">Address</span><span class="err">:</span><span class="w"> </span><span class="mi">173.194.222.138</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nc">Name</span><span class="err">:</span><span class="w">   </span><span class="nc">google.com</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nc">Address</span><span class="err">:</span><span class="w"> </span><span class="mi">173.194.222.101</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nc">Name</span><span class="err">:</span><span class="w">   </span><span class="nc">google.com</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nc">Address</span><span class="err">:</span><span class="w"> </span><span class="mi">173.194.222.100</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nc">Name</span><span class="err">:</span><span class="w">   </span><span class="nc">google.com</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nc">Address</span><span class="err">:</span><span class="w"> </span><span class="mi">173.194.222.102</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nc">Name</span><span class="err">:</span><span class="w">   </span><span class="nc">google.com</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nc">Address</span><span class="err">:</span><span class="w"> </span><span class="mi">173.194.222.113</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nc">Name</span><span class="err">:</span><span class="w">   </span><span class="nc">google.com</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nc">Address</span><span class="err">:</span><span class="w"> </span><span class="mi">173.194.222.139</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nc">Name</span><span class="err">:</span><span class="w">   </span><span class="nc">google.com</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nc">Address</span><span class="err">:</span><span class="w"> </span><span class="il">2a00:1450:4010:c0b::71</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nc">Name</span><span class="err">:</span><span class="w">   </span><span class="nc">google.com</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nc">Address</span><span class="err">:</span><span class="w"> </span><span class="il">2a00:1450:4010:c0b::66</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nc">Name</span><span class="err">:</span><span class="w">   </span><span class="nc">google.com</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nc">Address</span><span class="err">:</span><span class="w"> </span><span class="il">2a00:1450:4010:c0b::64</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nc">Name</span><span class="err">:</span><span class="w">   </span><span class="nc">google.com</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nc">Address</span><span class="err">:</span><span class="w"> </span><span class="il">2a00:1450:4010:c0b::65</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
  </div>
</div>
<p>Где:</p>
<ul>
<li><code>Server: 172.16.18.22</code> - сервер DNS, с которого пришёл ответ.</li>
</ul>
<h2 id="информация-по-dns-записям">
  <a class="link-body-emphasis" href="#%d0%b8%d0%bd%d1%84%d0%be%d1%80%d0%bc%d0%b0%d1%86%d0%b8%d1%8f-%d0%bf%d0%be-dns-%d0%b7%d0%b0%d0%bf%d0%b8%d1%81%d1%8f%d0%bc">Информация по DNS-записям</a>
</h2><p>В отдельных случаях требуется получить информацию по конкретным DNS-записям домена.</p>
<h3 id="dig-1">
  <a class="link-body-emphasis" href="#dig-1">Dig</a>
</h3><p>Получить информацию по MX-записи домена в <code>Dig</code>:</p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-6
shortcode-codeblock-bash">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-f2554b98bf59904b3de92db22d863b4a" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">dig mx example.com</span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-f2554b98bf59904b3de92db22d863b4a"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<p>Результат запроса:</p>











<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-7 shortcode-codeblock-terminal
shortcode-codeblock-terminal-linux
shortcode-codeblock-terminal-linux-user">
  <div class="card overflow-hidden" data-bs-theme="dark">
    <div class="card-header">
      <div class="d-flex align-items-center">
        <div class="flex-shrink-0 ">
          <i class="fas fa-terminal fa-fw"></i>
        </div>
        <div class="flex-grow-1 mx-2">
          <h5 class="mb-0">Терминал</h5>
        </div>
        <div class="flex-shrink-0">
          <ul class="list-inline mb-0">
            <li class="list-inline-item" title='Копировать'>
              <a class="text-body" href="#"
                 data-fn="clipboard" data-clipboard-target="#cp-a2003702f0f031ff497edc5a4af4c998"
                 role="button" aria-label='Копировать'>
                <i class="fas fa-copy fa-fw"></i>
              </a>
            </li>
          </ul>
        </div>
      </div>
    </div>
    <div class="card-body p-0 overflow-auto" id="cp-a2003702f0f031ff497edc5a4af4c998"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-dns" data-lang="dns"><span class="line"><span class="cl"><span class="nc">dig</span><span class="w"> </span><span class="err">mx</span><span class="w"> </span><span class="nc">google.com</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c">; &lt;&lt;&gt;&gt; DiG 9.18.24-1-Debian &lt;&lt;&gt;&gt; mx google.com</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c">;; global options: +cmd</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c">;; Got answer:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c">;; -&gt;&gt;HEADER&lt;&lt;- opcode: QUERY, status: NOERROR, id: 61308</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c">;; flags: qr rd ra; QUERY: 1, ANSWER: 1, AUTHORITY: 0, ADDITIONAL: 10</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c">;; OPT PSEUDOSECTION:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c">; EDNS: version: 0, flags:; udp: 4000</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c">;; QUESTION SECTION:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c">;google.com.                    IN      MX</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c">;; ANSWER SECTION:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="py">google.com. </span><span class="w">            </span><span class="sc">300</span><span class="w">     </span><span class="k">IN</span><span class="w">      </span><span class="k">MX</span><span class="w">      </span><span class="sc">10</span><span class="w"> </span><span class="py">smtp.google.com.</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c">;; ADDITIONAL SECTION:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="py">smtp.google.com. </span><span class="w">       </span><span class="sc">300</span><span class="w">     </span><span class="k">IN</span><span class="w">      </span><span class="k">A</span><span class="w">       </span><span class="mi">64.233.161.26</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="py">smtp.google.com. </span><span class="w">       </span><span class="sc">300</span><span class="w">     </span><span class="k">IN</span><span class="w">      </span><span class="k">A</span><span class="w">       </span><span class="mi">64.233.162.27</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="py">smtp.google.com. </span><span class="w">       </span><span class="sc">300</span><span class="w">     </span><span class="k">IN</span><span class="w">      </span><span class="k">A</span><span class="w">       </span><span class="mi">64.233.163.26</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="py">smtp.google.com. </span><span class="w">       </span><span class="sc">300</span><span class="w">     </span><span class="k">IN</span><span class="w">      </span><span class="k">A</span><span class="w">       </span><span class="mi">64.233.163.27</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="py">smtp.google.com. </span><span class="w">       </span><span class="sc">300</span><span class="w">     </span><span class="k">IN</span><span class="w">      </span><span class="k">A</span><span class="w">       </span><span class="mi">173.194.220.26</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="py">smtp.google.com. </span><span class="w">       </span><span class="sc">300</span><span class="w">     </span><span class="k">IN</span><span class="w">      </span><span class="k">AAAA</span><span class="w">    </span><span class="il">2a00:1450:4010:c01::1b</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="py">smtp.google.com. </span><span class="w">       </span><span class="sc">300</span><span class="w">     </span><span class="k">IN</span><span class="w">      </span><span class="k">AAAA</span><span class="w">    </span><span class="il">2a00:1450:4010:c05::1b</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="py">smtp.google.com. </span><span class="w">       </span><span class="sc">300</span><span class="w">     </span><span class="k">IN</span><span class="w">      </span><span class="k">AAAA</span><span class="w">    </span><span class="il">2a00:1450:4010:c06::1a</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="py">smtp.google.com. </span><span class="w">       </span><span class="sc">300</span><span class="w">     </span><span class="k">IN</span><span class="w">      </span><span class="k">AAAA</span><span class="w">    </span><span class="il">2a00:1450:4010:c06::1b</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c">;; Query time: 48 msec</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c">;; SERVER: 172.16.18.22#53(172.16.18.22) (UDP)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c">;; WHEN: Mon Apr 15 09:17:29 UTC 2024</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c">;; MSG SIZE  rcvd: 252</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
  </div>
</div>
<p>Где:</p>
<ul>
<li><code>google.com. 300 IN MX 10 smtp.google.com.</code> - MX-запись домена <code>google.com</code>.</li>
</ul>
<h3 id="drill-1">
  <a class="link-body-emphasis" href="#drill-1">Drill</a>
</h3><p>Получить информацию по MX-записи домена в <code>Drill</code>:</p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-8
shortcode-codeblock-bash">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-c87a54c2d31593de296f752e94b4a1c2" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">drill mx example.com</span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-c87a54c2d31593de296f752e94b4a1c2"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<p>Результат запроса:</p>











<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-9 shortcode-codeblock-terminal
shortcode-codeblock-terminal-linux
shortcode-codeblock-terminal-linux-user">
  <div class="card overflow-hidden" data-bs-theme="dark">
    <div class="card-header">
      <div class="d-flex align-items-center">
        <div class="flex-shrink-0 ">
          <i class="fas fa-terminal fa-fw"></i>
        </div>
        <div class="flex-grow-1 mx-2">
          <h5 class="mb-0">Терминал</h5>
        </div>
        <div class="flex-shrink-0">
          <ul class="list-inline mb-0">
            <li class="list-inline-item" title='Копировать'>
              <a class="text-body" href="#"
                 data-fn="clipboard" data-clipboard-target="#cp-60e54f3caed0e02c6f70c9d0a73f5d1e"
                 role="button" aria-label='Копировать'>
                <i class="fas fa-copy fa-fw"></i>
              </a>
            </li>
          </ul>
        </div>
      </div>
    </div>
    <div class="card-body p-0 overflow-auto" id="cp-60e54f3caed0e02c6f70c9d0a73f5d1e"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-dns" data-lang="dns"><span class="line"><span class="cl"><span class="nc">drill</span><span class="w"> </span><span class="err">mx</span><span class="w"> </span><span class="nc">google.com</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c">;; -&gt;&gt;HEADER&lt;&lt;- opcode: QUERY, rcode: NOERROR, id: 51703</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c">;; flags: qr rd ra ; QUERY: 1, ANSWER: 1, AUTHORITY: 0, ADDITIONAL: 5</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c">;; QUESTION SECTION:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c">;; google.com.  IN      MX</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c">;; ANSWER SECTION:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="py">google.com. </span><span class="w">    </span><span class="sc">30</span><span class="w">      </span><span class="k">IN</span><span class="w">      </span><span class="k">MX</span><span class="w">      </span><span class="sc">10</span><span class="w"> </span><span class="py">smtp.google.com.</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c">;; AUTHORITY SECTION:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c">;; ADDITIONAL SECTION:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="py">smtp.google.com. </span><span class="w">       </span><span class="sc">30</span><span class="w">      </span><span class="k">IN</span><span class="w">      </span><span class="k">A</span><span class="w">       </span><span class="mi">142.250.150.27</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="py">smtp.google.com. </span><span class="w">       </span><span class="sc">30</span><span class="w">      </span><span class="k">IN</span><span class="w">      </span><span class="k">A</span><span class="w">       </span><span class="mi">64.233.161.27</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="py">smtp.google.com. </span><span class="w">       </span><span class="sc">30</span><span class="w">      </span><span class="k">IN</span><span class="w">      </span><span class="k">A</span><span class="w">       </span><span class="mi">64.233.161.26</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="py">smtp.google.com. </span><span class="w">       </span><span class="sc">30</span><span class="w">      </span><span class="k">IN</span><span class="w">      </span><span class="k">A</span><span class="w">       </span><span class="mi">64.233.162.27</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="py">smtp.google.com. </span><span class="w">       </span><span class="sc">30</span><span class="w">      </span><span class="k">IN</span><span class="w">      </span><span class="k">A</span><span class="w">       </span><span class="mi">142.250.150.26</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c">;; Query time: 4 msec</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c">;; SERVER: 10.1.0.1</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c">;; WHEN: Wed Mar 27 17:41:53 2024</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c">;; MSG SIZE  rcvd: 136</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
  </div>
</div>
<p>Где:</p>
<ul>
<li><code>google.com. 300 IN MX 10 smtp.google.com.</code> - MX-запись домена <code>google.com</code>.</li>
</ul>
<h3 id="nslookup-1">
  <a class="link-body-emphasis" href="#nslookup-1">NSLookUp</a>
</h3><p>Получить информацию по MX-записи домена в <code>NSLookUp</code>:</p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-10
shortcode-codeblock-bash">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-3cc1dd9aad8644cbfa7970b6a35c4cb3" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">nslookup -type<span class="o">=</span>mx example.com</span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-3cc1dd9aad8644cbfa7970b6a35c4cb3"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<p>Результат запроса:</p>











<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-11 shortcode-codeblock-terminal
shortcode-codeblock-terminal-linux
shortcode-codeblock-terminal-linux-user">
  <div class="card overflow-hidden" data-bs-theme="dark">
    <div class="card-header">
      <div class="d-flex align-items-center">
        <div class="flex-shrink-0 ">
          <i class="fas fa-terminal fa-fw"></i>
        </div>
        <div class="flex-grow-1 mx-2">
          <h5 class="mb-0">Терминал</h5>
        </div>
        <div class="flex-shrink-0">
          <ul class="list-inline mb-0">
            <li class="list-inline-item" title='Копировать'>
              <a class="text-body" href="#"
                 data-fn="clipboard" data-clipboard-target="#cp-8ba21e4dd26c89a71df75c86063e7c51"
                 role="button" aria-label='Копировать'>
                <i class="fas fa-copy fa-fw"></i>
              </a>
            </li>
          </ul>
        </div>
      </div>
    </div>
    <div class="card-body p-0 overflow-auto" id="cp-8ba21e4dd26c89a71df75c86063e7c51"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-dns" data-lang="dns"><span class="line"><span class="cl"><span class="nc">nslookup</span><span class="w"> </span><span class="err">-type=mx</span><span class="w"> </span><span class="nc">google.com</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nc">Server</span><span class="err">:</span><span class="w">  </span><span class="nc">gw1.lan</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nc">Address</span><span class="err">:</span><span class="w">  </span><span class="mi">10.1.0.1</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nc">Non-authoritative</span><span class="w"> </span><span class="err">answer:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nc">google.com</span><span class="w">      </span><span class="k">MX</span><span class="w"> </span><span class="err">preference</span><span class="w"> </span><span class="err">=</span><span class="w"> </span><span class="sc">10</span><span class="err">,</span><span class="w"> </span><span class="err">mail</span><span class="w"> </span><span class="err">exchanger</span><span class="w"> </span><span class="err">=</span><span class="w"> </span><span class="nc">smtp.google.com</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nc">smtp.google.com</span><span class="w"> </span><span class="err">internet</span><span class="w"> </span><span class="err">address</span><span class="w"> </span><span class="err">=</span><span class="w"> </span><span class="mi">173.194.221.27</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nc">smtp.google.com</span><span class="w"> </span><span class="err">internet</span><span class="w"> </span><span class="err">address</span><span class="w"> </span><span class="err">=</span><span class="w"> </span><span class="mi">173.194.222.27</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nc">smtp.google.com</span><span class="w"> </span><span class="err">internet</span><span class="w"> </span><span class="err">address</span><span class="w"> </span><span class="err">=</span><span class="w"> </span><span class="mi">173.194.222.26</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nc">smtp.google.com</span><span class="w"> </span><span class="err">internet</span><span class="w"> </span><span class="err">address</span><span class="w"> </span><span class="err">=</span><span class="w"> </span><span class="mi">74.125.205.27</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nc">smtp.google.com</span><span class="w"> </span><span class="err">internet</span><span class="w"> </span><span class="err">address</span><span class="w"> </span><span class="err">=</span><span class="w"> </span><span class="mi">173.194.220.26</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
  </div>
</div>
<p>Где:</p>
<ul>
<li><code>google.com MX preference = 10, mail exchanger = smtp.google.com</code> - MX-запись домена <code>google.com</code>.</li>
</ul>
<h2 id="трассировка">
  <a class="link-body-emphasis" href="#%d1%82%d1%80%d0%b0%d1%81%d1%81%d0%b8%d1%80%d0%be%d0%b2%d0%ba%d0%b0">Трассировка</a>
</h2><p>Трассировка запросов к домену.</p>
<h3 id="dig-2">
  <a class="link-body-emphasis" href="#dig-2">Dig</a>
</h3><p>Получить информацию по трассировке запросов к домену в <code>Dig</code>:</p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-12
shortcode-codeblock-bash">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-fdc31ccadd05ec41eccef80a0f224c37" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">dig +trace example.com</span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-fdc31ccadd05ec41eccef80a0f224c37"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<p>Результат запроса:</p>











<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-13 shortcode-codeblock-terminal
shortcode-codeblock-terminal-linux
shortcode-codeblock-terminal-linux-user">
  <div class="card overflow-hidden" data-bs-theme="dark">
    <div class="card-header">
      <div class="d-flex align-items-center">
        <div class="flex-shrink-0 ">
          <i class="fas fa-terminal fa-fw"></i>
        </div>
        <div class="flex-grow-1 mx-2">
          <h5 class="mb-0">Терминал</h5>
        </div>
        <div class="flex-shrink-0">
          <ul class="list-inline mb-0">
            <li class="list-inline-item" title='Копировать'>
              <a class="text-body" href="#"
                 data-fn="clipboard" data-clipboard-target="#cp-47fb90af8dff5d91b70949bb6a60e69b"
                 role="button" aria-label='Копировать'>
                <i class="fas fa-copy fa-fw"></i>
              </a>
            </li>
          </ul>
        </div>
      </div>
    </div>
    <div class="card-body p-0 overflow-auto" id="cp-47fb90af8dff5d91b70949bb6a60e69b"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-dns" data-lang="dns"><span class="line"><span class="cl"><span class="nc">dig</span><span class="w"> </span><span class="err">+trace</span><span class="w"> </span><span class="nc">google.com</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c">; &lt;&lt;&gt;&gt; DiG 9.18.24-1-Debian &lt;&lt;&gt;&gt; +trace google.com</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c">;; global options: +cmd</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="err">.</span><span class="w">                       </span><span class="sc">86400</span><span class="w">   </span><span class="k">IN</span><span class="w">      </span><span class="k">NS</span><span class="w">      </span><span class="py">k.root-servers.net.</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="err">.</span><span class="w">                       </span><span class="sc">86400</span><span class="w">   </span><span class="k">IN</span><span class="w">      </span><span class="k">NS</span><span class="w">      </span><span class="py">d.root-servers.net.</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="err">.</span><span class="w">                       </span><span class="sc">86400</span><span class="w">   </span><span class="k">IN</span><span class="w">      </span><span class="k">NS</span><span class="w">      </span><span class="py">h.root-servers.net.</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="err">.</span><span class="w">                       </span><span class="sc">86400</span><span class="w">   </span><span class="k">IN</span><span class="w">      </span><span class="k">NS</span><span class="w">      </span><span class="py">f.root-servers.net.</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="err">.</span><span class="w">                       </span><span class="sc">86400</span><span class="w">   </span><span class="k">IN</span><span class="w">      </span><span class="k">NS</span><span class="w">      </span><span class="py">g.root-servers.net.</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="err">.</span><span class="w">                       </span><span class="sc">86400</span><span class="w">   </span><span class="k">IN</span><span class="w">      </span><span class="k">NS</span><span class="w">      </span><span class="py">l.root-servers.net.</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="err">.</span><span class="w">                       </span><span class="sc">86400</span><span class="w">   </span><span class="k">IN</span><span class="w">      </span><span class="k">NS</span><span class="w">      </span><span class="py">j.root-servers.net.</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="err">.</span><span class="w">                       </span><span class="sc">86400</span><span class="w">   </span><span class="k">IN</span><span class="w">      </span><span class="k">NS</span><span class="w">      </span><span class="py">e.root-servers.net.</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="err">.</span><span class="w">                       </span><span class="sc">86400</span><span class="w">   </span><span class="k">IN</span><span class="w">      </span><span class="k">NS</span><span class="w">      </span><span class="py">a.root-servers.net.</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="err">.</span><span class="w">                       </span><span class="sc">86400</span><span class="w">   </span><span class="k">IN</span><span class="w">      </span><span class="k">NS</span><span class="w">      </span><span class="py">b.root-servers.net.</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="err">.</span><span class="w">                       </span><span class="sc">86400</span><span class="w">   </span><span class="k">IN</span><span class="w">      </span><span class="k">NS</span><span class="w">      </span><span class="py">m.root-servers.net.</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="err">.</span><span class="w">                       </span><span class="sc">86400</span><span class="w">   </span><span class="k">IN</span><span class="w">      </span><span class="k">NS</span><span class="w">      </span><span class="py">c.root-servers.net.</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="err">.</span><span class="w">                       </span><span class="sc">86400</span><span class="w">   </span><span class="k">IN</span><span class="w">      </span><span class="k">NS</span><span class="w">      </span><span class="py">i.root-servers.net.</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c">;; Received 824 bytes from 172.16.18.22#53(172.16.18.22) in 4 ms</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="py">com. </span><span class="w">                   </span><span class="sc">172800</span><span class="w">  </span><span class="k">IN</span><span class="w">      </span><span class="k">NS</span><span class="w">      </span><span class="py">a.gtld-servers.net.</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="py">com. </span><span class="w">                   </span><span class="sc">172800</span><span class="w">  </span><span class="k">IN</span><span class="w">      </span><span class="k">NS</span><span class="w">      </span><span class="py">b.gtld-servers.net.</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="py">com. </span><span class="w">                   </span><span class="sc">172800</span><span class="w">  </span><span class="k">IN</span><span class="w">      </span><span class="k">NS</span><span class="w">      </span><span class="py">c.gtld-servers.net.</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="py">com. </span><span class="w">                   </span><span class="sc">172800</span><span class="w">  </span><span class="k">IN</span><span class="w">      </span><span class="k">NS</span><span class="w">      </span><span class="py">d.gtld-servers.net.</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="py">com. </span><span class="w">                   </span><span class="sc">172800</span><span class="w">  </span><span class="k">IN</span><span class="w">      </span><span class="k">NS</span><span class="w">      </span><span class="py">e.gtld-servers.net.</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="py">com. </span><span class="w">                   </span><span class="sc">172800</span><span class="w">  </span><span class="k">IN</span><span class="w">      </span><span class="k">NS</span><span class="w">      </span><span class="py">f.gtld-servers.net.</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="py">com. </span><span class="w">                   </span><span class="sc">172800</span><span class="w">  </span><span class="k">IN</span><span class="w">      </span><span class="k">NS</span><span class="w">      </span><span class="py">g.gtld-servers.net.</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="py">com. </span><span class="w">                   </span><span class="sc">172800</span><span class="w">  </span><span class="k">IN</span><span class="w">      </span><span class="k">NS</span><span class="w">      </span><span class="py">h.gtld-servers.net.</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="py">com. </span><span class="w">                   </span><span class="sc">172800</span><span class="w">  </span><span class="k">IN</span><span class="w">      </span><span class="k">NS</span><span class="w">      </span><span class="py">i.gtld-servers.net.</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="py">com. </span><span class="w">                   </span><span class="sc">172800</span><span class="w">  </span><span class="k">IN</span><span class="w">      </span><span class="k">NS</span><span class="w">      </span><span class="py">j.gtld-servers.net.</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="py">com. </span><span class="w">                   </span><span class="sc">172800</span><span class="w">  </span><span class="k">IN</span><span class="w">      </span><span class="k">NS</span><span class="w">      </span><span class="py">k.gtld-servers.net.</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="py">com. </span><span class="w">                   </span><span class="sc">172800</span><span class="w">  </span><span class="k">IN</span><span class="w">      </span><span class="k">NS</span><span class="w">      </span><span class="py">l.gtld-servers.net.</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="py">com. </span><span class="w">                   </span><span class="sc">172800</span><span class="w">  </span><span class="k">IN</span><span class="w">      </span><span class="k">NS</span><span class="w">      </span><span class="py">m.gtld-servers.net.</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="py">com. </span><span class="w">                   </span><span class="sc">86400</span><span class="w">   </span><span class="k">IN</span><span class="w">      </span><span class="k">DS</span><span class="w">      </span><span class="sc">19718</span><span class="w"> </span><span class="sc">13</span><span class="w"> </span><span class="sc">2</span><span class="w"> </span><span class="sc">8</span><span class="err">ACBB0CD28F41250A80A491389424D341522D946B0DA0C0291F2D3D7</span><span class="w"> </span><span class="sc">71</span><span class="err">D7805A</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="py">com. </span><span class="w">                   </span><span class="sc">86400</span><span class="w">   </span><span class="k">IN</span><span class="w">      </span><span class="k">RRSIG</span><span class="w">   </span><span class="k">DS</span><span class="w"> </span><span class="sc">8</span><span class="w"> </span><span class="sc">1</span><span class="w"> </span><span class="sc">86400</span><span class="w"> </span><span class="sc">20240428050000</span><span class="w"> </span><span class="sc">20240415040000</span><span class="w"> </span><span class="sc">5613</span><span class="w"> </span><span class="err">.</span><span class="w"> </span><span class="err">B5vi45DiEHj1RSe0d4ZMvighZNLSPj6ORov+tN+g4MASLSudADHgjP9i</span><span class="w"> </span><span class="sc">32</span><span class="err">HBqh6IyFeK8aIR3Jvuvk61Z+</span><span class="sc">2</span><span class="err">Z0oKjX6rUisVxf9RcQ3/uYZEBYUlp</span><span class="w"> </span><span class="err">JD32jNFY1qFXRfWiijTFhq8detfDVvczcwv0v6Lln0fcRIYDnzgHkqQV</span><span class="w"> </span><span class="sc">38</span><span class="err">LonWnfWLuOOjt6drrmsc6NqMvzBNM62ctqdajOd1SYFduk5JadzLZa</span><span class="w"> </span><span class="err">YhUooeLpfTNmBQtPjsrZeXVE9UUpLrOVW9Up3NV+kfusBCG5iBkepw/p</span><span class="w"> </span><span class="err">daza94/</span><span class="sc">0</span><span class="err">N5Q2xqTVCoHHUnaPmdZwp78AsLdpeJ347OyJQ/gO+pIz8WYT</span><span class="w"> </span><span class="err">aNi7FA==</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c">;; Received 1170 bytes from 193.0.14.129#53(k.root-servers.net) in 68 ms</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="py">google.com. </span><span class="w">            </span><span class="sc">172800</span><span class="w">  </span><span class="k">IN</span><span class="w">      </span><span class="k">NS</span><span class="w">      </span><span class="py">ns2.google.com.</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="py">google.com. </span><span class="w">            </span><span class="sc">172800</span><span class="w">  </span><span class="k">IN</span><span class="w">      </span><span class="k">NS</span><span class="w">      </span><span class="py">ns1.google.com.</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="py">google.com. </span><span class="w">            </span><span class="sc">172800</span><span class="w">  </span><span class="k">IN</span><span class="w">      </span><span class="k">NS</span><span class="w">      </span><span class="py">ns3.google.com.</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="py">google.com. </span><span class="w">            </span><span class="sc">172800</span><span class="w">  </span><span class="k">IN</span><span class="w">      </span><span class="k">NS</span><span class="w">      </span><span class="py">ns4.google.com.</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="py">CK0POJMG874LJREF7EFN8430QVIT8BSM.com. </span><span class="sc">86400</span><span class="w"> </span><span class="k">IN</span><span class="w"> </span><span class="k">NSEC3</span><span class="w"> </span><span class="sc">1</span><span class="w"> </span><span class="sc">1</span><span class="w"> </span><span class="sc">0</span><span class="w"> </span><span class="err">-</span><span class="w"> </span><span class="err">CK0Q2D6NI4I7EQH8NA30NS61O48UL8G5</span><span class="w"> </span><span class="k">NS</span><span class="w"> </span><span class="k">SOA</span><span class="w"> </span><span class="k">RRSIG</span><span class="w"> </span><span class="k">DNSKEY</span><span class="w"> </span><span class="k">NSEC3PARAM</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="py">CK0POJMG874LJREF7EFN8430QVIT8BSM.com. </span><span class="sc">86400</span><span class="w"> </span><span class="k">IN</span><span class="w"> </span><span class="k">RRSIG</span><span class="w"> </span><span class="k">NSEC3</span><span class="w"> </span><span class="sc">13</span><span class="w"> </span><span class="sc">2</span><span class="w"> </span><span class="sc">86400</span><span class="w"> </span><span class="sc">20240422042504</span><span class="w"> </span><span class="sc">20240415031504</span><span class="w"> </span><span class="sc">4534</span><span class="w"> </span><span class="py">com. </span><span class="err">ecgUBNoIjF0/</span><span class="sc">2</span><span class="err">NK5qbLLoESdr1gCp2UQeruasASkce/</span><span class="sc">2</span><span class="err">OC1+tbNorpx2</span><span class="w"> </span><span class="err">zr2HsO8bFW7BEvnN11MdmPyQBU3Csg==</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="py">S84BKCIBC38P58340AKVNFN5KR9O59QC.com. </span><span class="sc">86400</span><span class="w"> </span><span class="k">IN</span><span class="w"> </span><span class="k">NSEC3</span><span class="w"> </span><span class="sc">1</span><span class="w"> </span><span class="sc">1</span><span class="w"> </span><span class="sc">0</span><span class="w"> </span><span class="err">-</span><span class="w"> </span><span class="err">S84BR9CIB2A20L3ETR1M2415ENPP99L8</span><span class="w"> </span><span class="k">NS</span><span class="w"> </span><span class="k">DS</span><span class="w"> </span><span class="k">RRSIG</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="py">S84BKCIBC38P58340AKVNFN5KR9O59QC.com. </span><span class="sc">86400</span><span class="w"> </span><span class="k">IN</span><span class="w"> </span><span class="k">RRSIG</span><span class="w"> </span><span class="k">NSEC3</span><span class="w"> </span><span class="sc">13</span><span class="w"> </span><span class="sc">2</span><span class="w"> </span><span class="sc">86400</span><span class="w"> </span><span class="sc">20240419042537</span><span class="w"> </span><span class="sc">20240412031537</span><span class="w"> </span><span class="sc">4534</span><span class="w"> </span><span class="py">com. </span><span class="sc">5</span><span class="err">lFoSTkTYKY8oMvoj3TJbMvg72dB8RNZ3hvC5xkh9u6iZtqSZS+</span><span class="sc">7</span><span class="err">bjJH</span><span class="w"> </span><span class="err">nVL6cstRpACJKNLpTaWmI1NE9WsPWg==</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c">;; Received 644 bytes from 192.42.93.30#53(g.gtld-servers.net) in 44 ms</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="py">google.com. </span><span class="w">            </span><span class="sc">300</span><span class="w">     </span><span class="k">IN</span><span class="w">      </span><span class="k">A</span><span class="w">       </span><span class="mi">74.125.131.139</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="py">google.com. </span><span class="w">            </span><span class="sc">300</span><span class="w">     </span><span class="k">IN</span><span class="w">      </span><span class="k">A</span><span class="w">       </span><span class="mi">74.125.131.102</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="py">google.com. </span><span class="w">            </span><span class="sc">300</span><span class="w">     </span><span class="k">IN</span><span class="w">      </span><span class="k">A</span><span class="w">       </span><span class="mi">74.125.131.100</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="py">google.com. </span><span class="w">            </span><span class="sc">300</span><span class="w">     </span><span class="k">IN</span><span class="w">      </span><span class="k">A</span><span class="w">       </span><span class="mi">74.125.131.113</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="py">google.com. </span><span class="w">            </span><span class="sc">300</span><span class="w">     </span><span class="k">IN</span><span class="w">      </span><span class="k">A</span><span class="w">       </span><span class="mi">74.125.131.138</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="py">google.com. </span><span class="w">            </span><span class="sc">300</span><span class="w">     </span><span class="k">IN</span><span class="w">      </span><span class="k">A</span><span class="w">       </span><span class="mi">74.125.131.101</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c">;; Received 135 bytes from 216.239.36.10#53(ns3.google.com) in 20 ms</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
  </div>
</div>
<h3 id="drill-2">
  <a class="link-body-emphasis" href="#drill-2">Drill</a>
</h3><p>Получить информацию по трассировке запросов к домену в <code>Drill</code>:</p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-14
shortcode-codeblock-bash">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-d6505a0734953c43932125bbf9788310" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">drill -T example.com</span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-d6505a0734953c43932125bbf9788310"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<p>Результат запроса:</p>











<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-15 shortcode-codeblock-terminal
shortcode-codeblock-terminal-linux
shortcode-codeblock-terminal-linux-user">
  <div class="card overflow-hidden" data-bs-theme="dark">
    <div class="card-header">
      <div class="d-flex align-items-center">
        <div class="flex-shrink-0 ">
          <i class="fas fa-terminal fa-fw"></i>
        </div>
        <div class="flex-grow-1 mx-2">
          <h5 class="mb-0">Терминал</h5>
        </div>
        <div class="flex-shrink-0">
          <ul class="list-inline mb-0">
            <li class="list-inline-item" title='Копировать'>
              <a class="text-body" href="#"
                 data-fn="clipboard" data-clipboard-target="#cp-ae6b481711ae1fa7802ef354bd52e3a1"
                 role="button" aria-label='Копировать'>
                <i class="fas fa-copy fa-fw"></i>
              </a>
            </li>
          </ul>
        </div>
      </div>
    </div>
    <div class="card-body p-0 overflow-auto" id="cp-ae6b481711ae1fa7802ef354bd52e3a1"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-dns" data-lang="dns"><span class="line"><span class="cl"><span class="nc">drill</span><span class="w"> </span><span class="err">-T</span><span class="w"> </span><span class="nc">google.com</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="err">.</span><span class="w">       </span><span class="sc">518400</span><span class="w">  </span><span class="k">IN</span><span class="w">      </span><span class="k">NS</span><span class="w">      </span><span class="py">a.root-servers.net.</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="err">.</span><span class="w">       </span><span class="sc">518400</span><span class="w">  </span><span class="k">IN</span><span class="w">      </span><span class="k">NS</span><span class="w">      </span><span class="py">b.root-servers.net.</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="err">.</span><span class="w">       </span><span class="sc">518400</span><span class="w">  </span><span class="k">IN</span><span class="w">      </span><span class="k">NS</span><span class="w">      </span><span class="py">c.root-servers.net.</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="err">.</span><span class="w">       </span><span class="sc">518400</span><span class="w">  </span><span class="k">IN</span><span class="w">      </span><span class="k">NS</span><span class="w">      </span><span class="py">d.root-servers.net.</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="err">.</span><span class="w">       </span><span class="sc">518400</span><span class="w">  </span><span class="k">IN</span><span class="w">      </span><span class="k">NS</span><span class="w">      </span><span class="py">e.root-servers.net.</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="err">.</span><span class="w">       </span><span class="sc">518400</span><span class="w">  </span><span class="k">IN</span><span class="w">      </span><span class="k">NS</span><span class="w">      </span><span class="py">f.root-servers.net.</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="err">.</span><span class="w">       </span><span class="sc">518400</span><span class="w">  </span><span class="k">IN</span><span class="w">      </span><span class="k">NS</span><span class="w">      </span><span class="py">g.root-servers.net.</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="err">.</span><span class="w">       </span><span class="sc">518400</span><span class="w">  </span><span class="k">IN</span><span class="w">      </span><span class="k">NS</span><span class="w">      </span><span class="py">h.root-servers.net.</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="err">.</span><span class="w">       </span><span class="sc">518400</span><span class="w">  </span><span class="k">IN</span><span class="w">      </span><span class="k">NS</span><span class="w">      </span><span class="py">i.root-servers.net.</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="err">.</span><span class="w">       </span><span class="sc">518400</span><span class="w">  </span><span class="k">IN</span><span class="w">      </span><span class="k">NS</span><span class="w">      </span><span class="py">j.root-servers.net.</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="err">.</span><span class="w">       </span><span class="sc">518400</span><span class="w">  </span><span class="k">IN</span><span class="w">      </span><span class="k">NS</span><span class="w">      </span><span class="py">k.root-servers.net.</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="err">.</span><span class="w">       </span><span class="sc">518400</span><span class="w">  </span><span class="k">IN</span><span class="w">      </span><span class="k">NS</span><span class="w">      </span><span class="py">l.root-servers.net.</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="err">.</span><span class="w">       </span><span class="sc">518400</span><span class="w">  </span><span class="k">IN</span><span class="w">      </span><span class="k">NS</span><span class="w">      </span><span class="py">m.root-servers.net.</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="py">com. </span><span class="w">   </span><span class="sc">172800</span><span class="w">  </span><span class="k">IN</span><span class="w">      </span><span class="k">NS</span><span class="w">      </span><span class="py">m.gtld-servers.net.</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="py">com. </span><span class="w">   </span><span class="sc">172800</span><span class="w">  </span><span class="k">IN</span><span class="w">      </span><span class="k">NS</span><span class="w">      </span><span class="py">j.gtld-servers.net.</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="py">com. </span><span class="w">   </span><span class="sc">172800</span><span class="w">  </span><span class="k">IN</span><span class="w">      </span><span class="k">NS</span><span class="w">      </span><span class="py">f.gtld-servers.net.</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="py">com. </span><span class="w">   </span><span class="sc">172800</span><span class="w">  </span><span class="k">IN</span><span class="w">      </span><span class="k">NS</span><span class="w">      </span><span class="py">l.gtld-servers.net.</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="py">com. </span><span class="w">   </span><span class="sc">172800</span><span class="w">  </span><span class="k">IN</span><span class="w">      </span><span class="k">NS</span><span class="w">      </span><span class="py">g.gtld-servers.net.</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="py">com. </span><span class="w">   </span><span class="sc">172800</span><span class="w">  </span><span class="k">IN</span><span class="w">      </span><span class="k">NS</span><span class="w">      </span><span class="py">c.gtld-servers.net.</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="py">com. </span><span class="w">   </span><span class="sc">172800</span><span class="w">  </span><span class="k">IN</span><span class="w">      </span><span class="k">NS</span><span class="w">      </span><span class="py">k.gtld-servers.net.</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="py">com. </span><span class="w">   </span><span class="sc">172800</span><span class="w">  </span><span class="k">IN</span><span class="w">      </span><span class="k">NS</span><span class="w">      </span><span class="py">b.gtld-servers.net.</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="py">com. </span><span class="w">   </span><span class="sc">172800</span><span class="w">  </span><span class="k">IN</span><span class="w">      </span><span class="k">NS</span><span class="w">      </span><span class="py">d.gtld-servers.net.</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="py">com. </span><span class="w">   </span><span class="sc">172800</span><span class="w">  </span><span class="k">IN</span><span class="w">      </span><span class="k">NS</span><span class="w">      </span><span class="py">h.gtld-servers.net.</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="py">com. </span><span class="w">   </span><span class="sc">172800</span><span class="w">  </span><span class="k">IN</span><span class="w">      </span><span class="k">NS</span><span class="w">      </span><span class="py">a.gtld-servers.net.</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="py">com. </span><span class="w">   </span><span class="sc">172800</span><span class="w">  </span><span class="k">IN</span><span class="w">      </span><span class="k">NS</span><span class="w">      </span><span class="py">i.gtld-servers.net.</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="py">com. </span><span class="w">   </span><span class="sc">172800</span><span class="w">  </span><span class="k">IN</span><span class="w">      </span><span class="k">NS</span><span class="w">      </span><span class="py">e.gtld-servers.net.</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="py">google.com. </span><span class="w">    </span><span class="sc">172800</span><span class="w">  </span><span class="k">IN</span><span class="w">      </span><span class="k">NS</span><span class="w">      </span><span class="py">ns2.google.com.</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="py">google.com. </span><span class="w">    </span><span class="sc">172800</span><span class="w">  </span><span class="k">IN</span><span class="w">      </span><span class="k">NS</span><span class="w">      </span><span class="py">ns1.google.com.</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="py">google.com. </span><span class="w">    </span><span class="sc">172800</span><span class="w">  </span><span class="k">IN</span><span class="w">      </span><span class="k">NS</span><span class="w">      </span><span class="py">ns3.google.com.</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="py">google.com. </span><span class="w">    </span><span class="sc">172800</span><span class="w">  </span><span class="k">IN</span><span class="w">      </span><span class="k">NS</span><span class="w">      </span><span class="py">ns4.google.com.</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="py">google.com. </span><span class="w">    </span><span class="sc">300</span><span class="w">     </span><span class="k">IN</span><span class="w">      </span><span class="k">A</span><span class="w">       </span><span class="mi">108.177.14.139</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="py">google.com. </span><span class="w">    </span><span class="sc">300</span><span class="w">     </span><span class="k">IN</span><span class="w">      </span><span class="k">A</span><span class="w">       </span><span class="mi">108.177.14.102</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="py">google.com. </span><span class="w">    </span><span class="sc">300</span><span class="w">     </span><span class="k">IN</span><span class="w">      </span><span class="k">A</span><span class="w">       </span><span class="mi">108.177.14.138</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="py">google.com. </span><span class="w">    </span><span class="sc">300</span><span class="w">     </span><span class="k">IN</span><span class="w">      </span><span class="k">A</span><span class="w">       </span><span class="mi">108.177.14.100</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="py">google.com. </span><span class="w">    </span><span class="sc">300</span><span class="w">     </span><span class="k">IN</span><span class="w">      </span><span class="k">A</span><span class="w">       </span><span class="mi">108.177.14.101</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="py">google.com. </span><span class="w">    </span><span class="sc">300</span><span class="w">     </span><span class="k">IN</span><span class="w">      </span><span class="k">A</span><span class="w">       </span><span class="mi">108.177.14.113</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
  </div>
</div>
<h2 id="ptr-запись-домена">
  <a class="link-body-emphasis" href="#ptr-%d0%b7%d0%b0%d0%bf%d0%b8%d1%81%d1%8c-%d0%b4%d0%be%d0%bc%d0%b5%d0%bd%d0%b0">PTR-запись домена</a>
</h2><h3 id="dig-3">
  <a class="link-body-emphasis" href="#dig-3">Dig</a>
</h3><p>Получить информацию по PTR-записи домена в <code>Dig</code>:</p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-16
shortcode-codeblock-bash">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-3d4cb3af2a00f8806fbe660e787e66c6" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">dig -x IP_ADDRESS</span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-3d4cb3af2a00f8806fbe660e787e66c6"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<p>Результат запроса:</p>











<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-17 shortcode-codeblock-terminal
shortcode-codeblock-terminal-linux
shortcode-codeblock-terminal-linux-user">
  <div class="card overflow-hidden" data-bs-theme="dark">
    <div class="card-header">
      <div class="d-flex align-items-center">
        <div class="flex-shrink-0 ">
          <i class="fas fa-terminal fa-fw"></i>
        </div>
        <div class="flex-grow-1 mx-2">
          <h5 class="mb-0">Терминал</h5>
        </div>
        <div class="flex-shrink-0">
          <ul class="list-inline mb-0">
            <li class="list-inline-item" title='Копировать'>
              <a class="text-body" href="#"
                 data-fn="clipboard" data-clipboard-target="#cp-e840ed2f5484e26fc2fa9fe8968e8b88"
                 role="button" aria-label='Копировать'>
                <i class="fas fa-copy fa-fw"></i>
              </a>
            </li>
          </ul>
        </div>
      </div>
    </div>
    <div class="card-body p-0 overflow-auto" id="cp-e840ed2f5484e26fc2fa9fe8968e8b88"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-dns" data-lang="dns"><span class="line"><span class="cl"><span class="nc">dig</span><span class="w"> </span><span class="err">-x</span><span class="w"> </span><span class="mi">108.177.14.100</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c">; &lt;&lt;&gt;&gt; DiG 9.18.24-1-Debian &lt;&lt;&gt;&gt; -x 108.177.14.100</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c">;; global options: +cmd</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c">;; Got answer:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c">;; -&gt;&gt;HEADER&lt;&lt;- opcode: QUERY, status: NOERROR, id: 649</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c">;; flags: qr rd ra; QUERY: 1, ANSWER: 1, AUTHORITY: 0, ADDITIONAL: 1</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c">;; OPT PSEUDOSECTION:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c">; EDNS: version: 0, flags:; udp: 4000</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c">;; QUESTION SECTION:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c">;100.14.177.108.in-addr.arpa.   IN      PTR</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c">;; ANSWER SECTION:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="mi">100.14.177.108</span><span class="py">.in-addr.arpa. </span><span class="sc">815</span><span class="w"> </span><span class="k">IN</span><span class="w">     </span><span class="k">PTR</span><span class="w">     </span><span class="py">lt-in-f100.1e100.net.</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c">;; Query time: 0 msec</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c">;; SERVER: 172.16.18.22#53(172.16.18.22) (UDP)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c">;; WHEN: Mon Apr 15 09:21:53 UTC 2024</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c">;; MSG SIZE  rcvd: 90</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
  </div>
</div>
<h3 id="drill-3">
  <a class="link-body-emphasis" href="#drill-3">Drill</a>
</h3><p>Получить информацию по PTR-записи домена в <code>Drill</code>:</p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-18
shortcode-codeblock-bash">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-a01ae3e61c2c8d2cbcdd58549ca4dc14" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">drill -x IP_ADDRESS</span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-a01ae3e61c2c8d2cbcdd58549ca4dc14"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<p>Результат запроса:</p>











<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-19 shortcode-codeblock-terminal
shortcode-codeblock-terminal-linux
shortcode-codeblock-terminal-linux-user">
  <div class="card overflow-hidden" data-bs-theme="dark">
    <div class="card-header">
      <div class="d-flex align-items-center">
        <div class="flex-shrink-0 ">
          <i class="fas fa-terminal fa-fw"></i>
        </div>
        <div class="flex-grow-1 mx-2">
          <h5 class="mb-0">Терминал</h5>
        </div>
        <div class="flex-shrink-0">
          <ul class="list-inline mb-0">
            <li class="list-inline-item" title='Копировать'>
              <a class="text-body" href="#"
                 data-fn="clipboard" data-clipboard-target="#cp-33caa2a32514d343982a24ea692386eb"
                 role="button" aria-label='Копировать'>
                <i class="fas fa-copy fa-fw"></i>
              </a>
            </li>
          </ul>
        </div>
      </div>
    </div>
    <div class="card-body p-0 overflow-auto" id="cp-33caa2a32514d343982a24ea692386eb"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-dns" data-lang="dns"><span class="line"><span class="cl"><span class="nc">drill</span><span class="w"> </span><span class="err">-x</span><span class="w"> </span><span class="mi">108.177.14.100</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c">;; -&gt;&gt;HEADER&lt;&lt;- opcode: QUERY, rcode: NOERROR, id: 55533</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c">;; flags: qr rd ra ; QUERY: 1, ANSWER: 1, AUTHORITY: 0, ADDITIONAL: 0</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c">;; QUESTION SECTION:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c">;; 100.14.177.108.in-addr.arpa. IN      PTR</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c">;; ANSWER SECTION:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="mi">100.14.177.108</span><span class="py">.in-addr.arpa. </span><span class="w">   </span><span class="sc">14366</span><span class="w">   </span><span class="k">IN</span><span class="w">      </span><span class="k">PTR</span><span class="w">     </span><span class="py">lt-in-f100.1e100.net.</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c">;; AUTHORITY SECTION:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c">;; ADDITIONAL SECTION:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c">;; Query time: 3 msec</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c">;; SERVER: 10.1.0.1</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c">;; WHEN: Wed Mar 27 17:44:49 2024</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c">;; MSG SIZE  rcvd: 79</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
  </div>
</div>
<h3 id="nslookup-2">
  <a class="link-body-emphasis" href="#nslookup-2">NSLookUp</a>
</h3><p>Получить информацию по PTR-записи домена в <code>NSLookUp</code>:</p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-20
shortcode-codeblock-bash">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-1b719c9f9d782c126945d8447bccda88" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">nslookup -debug IP_ADDRESS</span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-1b719c9f9d782c126945d8447bccda88"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<p>Результат запроса:</p>











<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-21 shortcode-codeblock-terminal
shortcode-codeblock-terminal-linux
shortcode-codeblock-terminal-linux-user">
  <div class="card overflow-hidden" data-bs-theme="dark">
    <div class="card-header">
      <div class="d-flex align-items-center">
        <div class="flex-shrink-0 ">
          <i class="fas fa-terminal fa-fw"></i>
        </div>
        <div class="flex-grow-1 mx-2">
          <h5 class="mb-0">Терминал</h5>
        </div>
        <div class="flex-shrink-0">
          <ul class="list-inline mb-0">
            <li class="list-inline-item" title='Копировать'>
              <a class="text-body" href="#"
                 data-fn="clipboard" data-clipboard-target="#cp-e61d296e5a78a19ab98ff3a1f4accbfd"
                 role="button" aria-label='Копировать'>
                <i class="fas fa-copy fa-fw"></i>
              </a>
            </li>
          </ul>
        </div>
      </div>
    </div>
    <div class="card-body p-0 overflow-auto" id="cp-e61d296e5a78a19ab98ff3a1f4accbfd"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-dns" data-lang="dns"><span class="line"><span class="cl"><span class="nc">nslookup</span><span class="w"> </span><span class="err">-debug</span><span class="w"> </span><span class="mi">108.177.14.100</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nc">------------</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nc">Got</span><span class="w"> </span><span class="err">answer:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="err">HEADER:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="err">opcode</span><span class="w"> </span><span class="err">=</span><span class="w"> </span><span class="err">QUERY,</span><span class="w"> </span><span class="err">id</span><span class="w"> </span><span class="err">=</span><span class="w"> </span><span class="sc">1</span><span class="err">,</span><span class="w"> </span><span class="err">rcode</span><span class="w"> </span><span class="err">=</span><span class="w"> </span><span class="err">NOERROR</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="err">header</span><span class="w"> </span><span class="err">flags:</span><span class="w">  </span><span class="err">response,</span><span class="w"> </span><span class="err">want</span><span class="w"> </span><span class="err">recursion,</span><span class="w"> </span><span class="err">recursion</span><span class="w"> </span><span class="py">avail.</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="err">questions</span><span class="w"> </span><span class="err">=</span><span class="w"> </span><span class="sc">1</span><span class="err">,</span><span class="w">  </span><span class="err">answers</span><span class="w"> </span><span class="err">=</span><span class="w"> </span><span class="sc">1</span><span class="err">,</span><span class="w">  </span><span class="err">authority</span><span class="w"> </span><span class="err">records</span><span class="w"> </span><span class="err">=</span><span class="w"> </span><span class="sc">0</span><span class="err">,</span><span class="w">  </span><span class="err">additional</span><span class="w"> </span><span class="err">=</span><span class="w"> </span><span class="sc">1</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="err">QUESTIONS:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="mi">1.0.1.10</span><span class="nc">.in-addr.arpa</span><span class="err">,</span><span class="w"> </span><span class="err">type</span><span class="w"> </span><span class="err">=</span><span class="w"> </span><span class="k">PTR</span><span class="err">,</span><span class="w"> </span><span class="err">class</span><span class="w"> </span><span class="err">=</span><span class="w"> </span><span class="k">IN</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="err">ANSWERS:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="err">-&gt;</span><span class="w">  </span><span class="mi">1.0.1.10</span><span class="nc">.in-addr.arpa</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="err">name</span><span class="w"> </span><span class="err">=</span><span class="w"> </span><span class="nc">gw1.lan</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="err">ttl</span><span class="w"> </span><span class="err">=</span><span class="w"> </span><span class="sc">86400</span><span class="w"> </span><span class="p">(</span><span class="sc">1</span><span class="w"> </span><span class="err">day</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="err">ADDITIONAL</span><span class="w"> </span><span class="err">RECORDS:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="err">-&gt;</span><span class="w">  </span><span class="nc">gw1.lan</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="err">internet</span><span class="w"> </span><span class="err">address</span><span class="w"> </span><span class="err">=</span><span class="w"> </span><span class="mi">10.1.0.1</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="err">ttl</span><span class="w"> </span><span class="err">=</span><span class="w"> </span><span class="sc">86400</span><span class="w"> </span><span class="p">(</span><span class="sc">1</span><span class="w"> </span><span class="err">day</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nc">------------</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nc">Server</span><span class="err">:</span><span class="w">  </span><span class="nc">gw1.lan</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nc">Address</span><span class="err">:</span><span class="w">  </span><span class="mi">10.1.0.1</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nc">------------</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nc">Got</span><span class="w"> </span><span class="err">answer:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="err">HEADER:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="err">opcode</span><span class="w"> </span><span class="err">=</span><span class="w"> </span><span class="err">QUERY,</span><span class="w"> </span><span class="err">id</span><span class="w"> </span><span class="err">=</span><span class="w"> </span><span class="sc">2</span><span class="err">,</span><span class="w"> </span><span class="err">rcode</span><span class="w"> </span><span class="err">=</span><span class="w"> </span><span class="err">NOERROR</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="err">header</span><span class="w"> </span><span class="err">flags:</span><span class="w">  </span><span class="err">response,</span><span class="w"> </span><span class="err">want</span><span class="w"> </span><span class="err">recursion,</span><span class="w"> </span><span class="err">recursion</span><span class="w"> </span><span class="py">avail.</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="err">questions</span><span class="w"> </span><span class="err">=</span><span class="w"> </span><span class="sc">1</span><span class="err">,</span><span class="w">  </span><span class="err">answers</span><span class="w"> </span><span class="err">=</span><span class="w"> </span><span class="sc">1</span><span class="err">,</span><span class="w">  </span><span class="err">authority</span><span class="w"> </span><span class="err">records</span><span class="w"> </span><span class="err">=</span><span class="w"> </span><span class="sc">0</span><span class="err">,</span><span class="w">  </span><span class="err">additional</span><span class="w"> </span><span class="err">=</span><span class="w"> </span><span class="sc">0</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="err">QUESTIONS:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="mi">100.14.177.108</span><span class="nc">.in-addr.arpa</span><span class="err">,</span><span class="w"> </span><span class="err">type</span><span class="w"> </span><span class="err">=</span><span class="w"> </span><span class="k">PTR</span><span class="err">,</span><span class="w"> </span><span class="err">class</span><span class="w"> </span><span class="err">=</span><span class="w"> </span><span class="k">IN</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="err">ANSWERS:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="err">-&gt;</span><span class="w">  </span><span class="mi">100.14.177.108</span><span class="nc">.in-addr.arpa</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="err">name</span><span class="w"> </span><span class="err">=</span><span class="w"> </span><span class="nc">lt-in-f100.1e100.net</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="err">ttl</span><span class="w"> </span><span class="err">=</span><span class="w"> </span><span class="sc">14305</span><span class="w"> </span><span class="p">(</span><span class="sc">3</span><span class="w"> </span><span class="err">hours</span><span class="w"> </span><span class="sc">58</span><span class="w"> </span><span class="err">mins</span><span class="w"> </span><span class="sc">25</span><span class="w"> </span><span class="err">secs</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nc">------------</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nc">Name</span><span class="err">:</span><span class="w">    </span><span class="nc">lt-in-f100.1e100.net</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nc">Address</span><span class="err">:</span><span class="w">  </span><span class="mi">108.177.14.100</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
  </div>
</div>]]></turbo:content></item><item turbo="true"><title>Как проверить PTR-запись?</title><link>https://lib.onl/ru/2024/03/4db553f9-8a24-5807-bce0-bbbcc59fb4e1/</link><pubDate>Wed, 27 Mar 2024 13:49:08 +0000</pubDate><dc:creator>Kai Kimera</dc:creator><category>Dns</category><category>Ptr</category><category>Nslookup</category><turbo:extendedHtml>true</turbo:extendedHtml><turbo:source>https://lib.onl/ru/2024/03/4db553f9-8a24-5807-bce0-bbbcc59fb4e1/</turbo:source><turbo:topic>Как проверить PTR-запись?</turbo:topic><turbo:content>&lt;p>Как проверить запись PTR у домена?&lt;/p></turbo:content></item><item turbo="true"><title>Cisco: Загрузка и выгрузка конфигурации</title><link>https://lib.onl/ru/2024/03/4a7addb9-eff3-5482-902c-791fbe49899f/</link><pubDate>Tue, 26 Mar 2024 13:00:25 +0000</pubDate><dc:creator>Kai Kimera</dc:creator><category>Сеть</category><category>Терминал</category><yandex:related><link url="https://lib.onl/ru/2024/03/fc67eb74-8f7c-5de3-bd1e-2d823208eae2/">Cisco: Сброс пароля</link></yandex:related><turbo:extendedHtml>true</turbo:extendedHtml><turbo:source>https://lib.onl/ru/2024/03/4a7addb9-eff3-5482-902c-791fbe49899f/</turbo:source><turbo:topic>Cisco: Загрузка и выгрузка конфигурации</turbo:topic><turbo:content><![CDATA[<p>Рассмотрим способ загрузки и выгрузки (backup) конфигурации на устройствах <span class="shortcode shortcode-tag"><a href="/ru/tags/cisco/" target="_blank">#Cisco</a></span>.</p>
<h2 id="общая-настройка">
  <a class="link-body-emphasis" href="#%d0%be%d0%b1%d1%89%d0%b0%d1%8f-%d0%bd%d0%b0%d1%81%d1%82%d1%80%d0%be%d0%b9%d0%ba%d0%b0">Общая настройка</a>
</h2><p>Необходимо предварительно настроить сетевой интерфейс компьютера со следующими параметрами:</p>
<ul>
<li>IP-адрес: <code>192.168.1.2</code>.</li>
<li>Маска подсети: <code>255.255.255.0</code>.</li>
<li>Шлюз: <code>192.168.1.1</code>.</li>
<li>DNS: <code>8.8.8.8</code>.</li>
</ul>
<p>Теперь настроим сетевой интерфейс <code>FE0/1</code> на <span class="shortcode shortcode-tag"><a href="/ru/tags/cisco/" target="_blank">#Cisco</a></span>:</p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-0
shortcode-codeblock-plaintext">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-7f771db6210a9dc72456cc715807f537" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-plaintext" data-lang="plaintext"><span class="line"><span class="cl"># conf t
</span></span><span class="line"><span class="cl">(config)# int fa0/1
</span></span><span class="line"><span class="cl">(config-if)# ip address 192.168.1.1 255.255.255.0
</span></span><span class="line"><span class="cl">(config-if)# no shutdown
</span></span><span class="line"><span class="cl">(config-if)# exit
</span></span><span class="line"><span class="cl">(config)# exit
</span></span><span class="line"><span class="cl">#</span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-7f771db6210a9dc72456cc715807f537"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<p>После предварительных настроек, подключим сетевой интерфейс компьютера к сетевому интерфейсу <span class="shortcode shortcode-tag"><a href="/ru/tags/cisco/" target="_blank">#Cisco</a></span> <code>FE0/1</code> и запустим TFTP-сервер на компьютере c IP <code>192.168.1.2</code>.</p>
<h2 id="загрузка-конфигурации">
  <a class="link-body-emphasis" href="#%d0%b7%d0%b0%d0%b3%d1%80%d1%83%d0%b7%d0%ba%d0%b0-%d0%ba%d0%be%d0%bd%d1%84%d0%b8%d0%b3%d1%83%d1%80%d0%b0%d1%86%d0%b8%d0%b8">Загрузка конфигурации</a>
</h2><p>Для того, чтобы загрузить конфигурацию с TFTP-сервера, необходимо выполнить следующую команду:</p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-1
shortcode-codeblock-plaintext">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-1bf607c0523850253f45fee63bcca009" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-plaintext" data-lang="plaintext"><span class="line"><span class="cl"># copy tftp://192.168.1.2/BACKUP_CONF_FILE startup-config</span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-1bf607c0523850253f45fee63bcca009"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<p>Где:</p>
<ul>
<li><code>tftp://192.168.1.2/BACKUP_CONF_FILE</code> - источник, адрес TFTP-сервера и путь к файлу конфигурации.</li>
<li><code>startup-config</code> - назначение, хранилище стартовой конфигурации.</li>
</ul>
<h2 id="выгрузка-конфигурации">
  <a class="link-body-emphasis" href="#%d0%b2%d1%8b%d0%b3%d1%80%d1%83%d0%b7%d0%ba%d0%b0-%d0%ba%d0%be%d0%bd%d1%84%d0%b8%d0%b3%d1%83%d1%80%d0%b0%d1%86%d0%b8%d0%b8">Выгрузка конфигурации</a>
</h2><p>Для выгрузки конфигурации <span class="shortcode shortcode-tag"><a href="/ru/tags/cisco/" target="_blank">#Cisco</a></span> на внешний TFTP-сервер, можно воспользоваться следующей командой:</p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-2
shortcode-codeblock-plaintext">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-3c321ead4fa05ec6da3471f64d6c93e2" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-plaintext" data-lang="plaintext"><span class="line"><span class="cl"># copy startup-config tftp://192.168.1.2/BACKUP_CONF_FILE</span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-3c321ead4fa05ec6da3471f64d6c93e2"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<p>Где:</p>
<ul>
<li><code>startup-config</code> - источник, хранилище стартовой конфигурации.</li>
<li><code>tftp://192.168.1.2/BACKUP_CONF_FILE</code> - назначение, адрес TFTP-сервера и название файла конфигурации.</li>
</ul>]]></turbo:content></item><item turbo="true"><title>Cisco: Сброс пароля</title><link>https://lib.onl/ru/2024/03/fc67eb74-8f7c-5de3-bd1e-2d823208eae2/</link><pubDate>Tue, 26 Mar 2024 12:07:17 +0000</pubDate><dc:creator>Kai Kimera</dc:creator><category>Сеть</category><category>Терминал</category><turbo:extendedHtml>true</turbo:extendedHtml><turbo:source>https://lib.onl/ru/2024/03/fc67eb74-8f7c-5de3-bd1e-2d823208eae2/</turbo:source><turbo:topic>Cisco: Сброс пароля</turbo:topic><turbo:content><![CDATA[<p>Инструкция по сбросу пароля администратора в готовой конфигурации на устройствах <span class="shortcode shortcode-tag"><a href="/ru/tags/cisco/" target="_blank">#Cisco</a></span>.</p>
<ol>
<li>Подключиться к COM-порту <span class="shortcode shortcode-tag"><a href="/ru/tags/cisco/" target="_blank">#Cisco</a></span>.</li>
<li>Загрузиться в <strong>ROMMON</strong> (при старте <span class="shortcode shortcode-tag"><a href="/ru/tags/cisco/" target="_blank">#Cisco</a></span> нажать клавишу <span class="shortcode shortcode-key d-inline-block"><kbd>Break</kbd></span>).</li>
</ol>
<p>Далее, необходимо переключить регистр с <code>0x2102</code> на <code>0x2142</code> и перезагрузить оборудование:</p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-0
shortcode-codeblock-plaintext">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-fc8f26dab9ad331c4b0f6c7702b1941c" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-plaintext" data-lang="plaintext"><span class="line"><span class="cl">rommon&gt; confreg 0x2142
</span></span><span class="line"><span class="cl">rommon&gt; reset</span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-fc8f26dab9ad331c4b0f6c7702b1941c"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<p>После перезагрузки оборудования, можно сбросить пароль. Переходим  режим конфигурирования:</p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-1
shortcode-codeblock-plaintext">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-b4c53803ec6f460547d8845a1c869d94" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-plaintext" data-lang="plaintext"><span class="line"><span class="cl">&gt; en</span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-b4c53803ec6f460547d8845a1c869d94"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<p>Импортируем стартовую конфигурацию в текущую:</p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-2
shortcode-codeblock-plaintext">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-d76b4bd864773aae8ae878f690995323" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-plaintext" data-lang="plaintext"><span class="line"><span class="cl"># copy startup-config running-config</span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-d76b4bd864773aae8ae878f690995323"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<p>Отлично. Сейчас мы находимся в режиме полного контроля и в конфигурации, к которой ранее не было доступа. Теперь сбрасываем пароль у необходимого пользователя:</p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-3
shortcode-codeblock-plaintext">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-0625edb88dbff279b10d2c8f54e94889" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-plaintext" data-lang="plaintext"><span class="line"><span class="cl"># config t
</span></span><span class="line"><span class="cl">(config)# en secret PassWord
</span></span><span class="line"><span class="cl">(config)# username USER privilege 15 secret PassWord</span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-0625edb88dbff279b10d2c8f54e94889"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<p>Далее, нужно не забыть переключить регистр обратно, с <code>0x2142</code> на <code>0x2102</code>:</p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-4
shortcode-codeblock-plaintext">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-cbf90b52c619d359af16091bf367208f" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-plaintext" data-lang="plaintext"><span class="line"><span class="cl">(config)# config-register 0x2102
</span></span><span class="line"><span class="cl">(config)# exit</span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-cbf90b52c619d359af16091bf367208f"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<p>Теперь экспортируем текущую конфигурацию обратно в стартовую:</p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-5
shortcode-codeblock-plaintext">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-bf6ff5eac35db4ba994d36531214128f" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-plaintext" data-lang="plaintext"><span class="line"><span class="cl"># copy running-config startup-config
</span></span><span class="line"><span class="cl"># reload</span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-bf6ff5eac35db4ba994d36531214128f"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<p>Таким образом мы &ldquo;обманули&rdquo; Cisco. Мы загрузились в чистую конфигурацию под администратором и импортировали в неё стартовую конфигурацию, к которой у нас не было доступа. Поменяли пароль и экспортировали текущую конфигурацию обратно в стартовую.</p>
<p>Готово!</p>]]></turbo:content></item><item turbo="true"><title>Работа с ZFS</title><link>https://lib.onl/ru/2024/03/6c7a038f-f41e-5a45-a285-b99fdacf82d4/</link><pubDate>Fri, 08 Mar 2024 10:29:06 +0000</pubDate><dc:creator>Kai Kimera</dc:creator><category>BSD</category><category>Linux</category><category>В доработке</category><yandex:related><link url="https://lib.onl/ru/2024/02/f97dc310-9a6a-52f7-8441-bf7eb02087c2/">Первичная настройка FreeBSD</link></yandex:related><turbo:extendedHtml>true</turbo:extendedHtml><turbo:source>https://lib.onl/ru/2024/03/6c7a038f-f41e-5a45-a285-b99fdacf82d4/</turbo:source><turbo:topic>Работа с ZFS</turbo:topic><turbo:content><![CDATA[<p>Я всё чаще стал использовать файловую систему <span class="shortcode shortcode-tag"><a href="/ru/tags/zfs/" target="_blank">#ZFS</a></span> и для себя составил шпаргалку по работе с ней. Может быть, кому то ещё пригодится.</p>
<h2 id="вводные-данные">
  <a class="link-body-emphasis" href="#%d0%b2%d0%b2%d0%be%d0%b4%d0%bd%d1%8b%d0%b5-%d0%b4%d0%b0%d0%bd%d0%bd%d1%8b%d0%b5">Вводные данные</a>
</h2><p>В работе с <span class="shortcode shortcode-tag"><a href="/ru/tags/zfs/" target="_blank">#ZFS</a></span> я использую ОС <span class="shortcode shortcode-tag"><a href="/ru/tags/debian/" target="_blank">#Debian</a></span> и пути к дискам (<code>by-path</code>). Если кто-то захочет использовать идентификаторы (<code>by-id</code>) дисков, то просто замените в командах пути на идентификаторы.</p>
<p>В командах этой статьи я работаю в пулом под названием <code>data</code>. Все вводные переменные я выношу за пределы команды и объявляю отдельно. Не знаю откуда у меня возникла такая привычка. <span class="shortcode shortcode-emoji">😄</span></p>
<h3 id="список-дисков-и-их-расположение">
  <a class="link-body-emphasis" href="#%d1%81%d0%bf%d0%b8%d1%81%d0%be%d0%ba-%d0%b4%d0%b8%d1%81%d0%ba%d0%be%d0%b2-%d0%b8-%d0%b8%d1%85-%d1%80%d0%b0%d1%81%d0%bf%d0%be%d0%bb%d0%be%d0%b6%d0%b5%d0%bd%d0%b8%d0%b5">Список дисков и их расположение</a>
</h3><p>Вывести список дисков и их расположение (путь) в системе:</p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-0
shortcode-codeblock-bash">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-727fe9566553e3a970bea7b98b268c5a" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">ls -l <span class="s1">&#39;/dev/disk/by-path/&#39;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-727fe9566553e3a970bea7b98b268c5a"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<h3 id="список-дисков-и-их-идентификаторы">
  <a class="link-body-emphasis" href="#%d1%81%d0%bf%d0%b8%d1%81%d0%be%d0%ba-%d0%b4%d0%b8%d1%81%d0%ba%d0%be%d0%b2-%d0%b8-%d0%b8%d1%85-%d0%b8%d0%b4%d0%b5%d0%bd%d1%82%d0%b8%d1%84%d0%b8%d0%ba%d0%b0%d1%82%d0%be%d1%80%d1%8b">Список дисков и их идентификаторы</a>
</h3><p>Вывести список дисков и их идентификаторы в системе:</p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-1
shortcode-codeblock-bash">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-7a3c4fea6e2e971e2e4f5f5e82c038a4" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">ls -l <span class="s1">&#39;/dev/disk/by-id/&#39;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-7a3c4fea6e2e971e2e4f5f5e82c038a4"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<h2 id="пулы">
  <a class="link-body-emphasis" href="#%d0%bf%d1%83%d0%bb%d1%8b">Пулы</a>
</h2><p>Рассмотрим различные варианты работы с пулами <span class="shortcode shortcode-tag"><a href="/ru/tags/zfs/" target="_blank">#ZFS</a></span>.</p>
<h3 id="создание-пула">
  <a class="link-body-emphasis" href="#%d1%81%d0%be%d0%b7%d0%b4%d0%b0%d0%bd%d0%b8%d0%b5-%d0%bf%d1%83%d0%bb%d0%b0">Создание пула</a>
</h3><p>Создание обычного пула <code>data</code> из одного диска <code>pci-0000:01:00.0-scsi-0:1:0:0</code>:</p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-2
shortcode-codeblock-bash">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-a3f923cb07c74f3731bb3134dca80f07" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="nv">p</span><span class="o">=</span><span class="s1">&#39;data&#39;</span><span class="p">;</span> zpool create -o <span class="s1">&#39;ashift=12&#39;</span> -O <span class="s1">&#39;atime=off&#39;</span> <span class="s2">&#34;</span><span class="si">${</span><span class="nv">p</span><span class="si">}</span><span class="s2">&#34;</span> <span class="s1">&#39;pci-0000:01:00.0-scsi-0:1:0:0&#39;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-a3f923cb07c74f3731bb3134dca80f07"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<h3 id="расширение-пула">
  <a class="link-body-emphasis" href="#%d1%80%d0%b0%d1%81%d1%88%d0%b8%d1%80%d0%b5%d0%bd%d0%b8%d0%b5-%d0%bf%d1%83%d0%bb%d0%b0">Расширение пула</a>
</h3><p>Расширение пула происходит путём добавления дополнительного диска или увеличением размера виртуального диска.</p>
<h4 id="добавление-диска-в-пул">
  <a class="link-body-emphasis" href="#%d0%b4%d0%be%d0%b1%d0%b0%d0%b2%d0%bb%d0%b5%d0%bd%d0%b8%d0%b5-%d0%b4%d0%b8%d1%81%d0%ba%d0%b0-%d0%b2-%d0%bf%d1%83%d0%bb">Добавление диска в пул</a>
</h4><p>Добавление диска <code>pci-0000:01:00.0-scsi-0:1:1:0</code> в пул <code>data</code>:</p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-3
shortcode-codeblock-bash">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-83ddeb1b8c3284213aa27f67f4062895" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="nv">p</span><span class="o">=</span><span class="s1">&#39;data&#39;</span><span class="p">;</span> zpool add <span class="s2">&#34;</span><span class="si">${</span><span class="nv">p</span><span class="si">}</span><span class="s2">&#34;</span> <span class="s1">&#39;pci-0000:01:00.0-scsi-0:1:1:0&#39;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-83ddeb1b8c3284213aa27f67f4062895"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<h4 id="расширение-диска-в-пуле">
  <a class="link-body-emphasis" href="#%d1%80%d0%b0%d1%81%d1%88%d0%b8%d1%80%d0%b5%d0%bd%d0%b8%d0%b5-%d0%b4%d0%b8%d1%81%d0%ba%d0%b0-%d0%b2-%d0%bf%d1%83%d0%bb%d0%b5">Расширение диска в пуле</a>
</h4><p>Расширение существующего диска <code>pci-0000:03:00.0-scsi-0:1:0:0</code> в пуле <code>data</code>:</p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-4
shortcode-codeblock-bash">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-2a1a41c606be8d83afe2308269cd69a6" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="nv">p</span><span class="o">=</span><span class="s1">&#39;data&#39;</span><span class="p">;</span> zpool online -e <span class="s2">&#34;</span><span class="si">${</span><span class="nv">p</span><span class="si">}</span><span class="s2">&#34;</span> <span class="s1">&#39;pci-0000:03:00.0-scsi-0:1:0:0&#39;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-2a1a41c606be8d83afe2308269cd69a6"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<p>Включение автоматического расширения пула <code>data</code>:</p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-5
shortcode-codeblock-bash">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-431de00897f52a3a754360269b1a113c" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="nv">p</span><span class="o">=</span><span class="s1">&#39;data&#39;</span><span class="p">;</span> zpool <span class="nb">set</span> <span class="s1">&#39;autoexpand=on&#39;</span> <span class="s2">&#34;</span><span class="si">${</span><span class="nv">p</span><span class="si">}</span><span class="s2">&#34;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-431de00897f52a3a754360269b1a113c"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<h3 id="подключение-и-отключение-дисков">
  <a class="link-body-emphasis" href="#%d0%bf%d0%be%d0%b4%d0%ba%d0%bb%d1%8e%d1%87%d0%b5%d0%bd%d0%b8%d0%b5-%d0%b8-%d0%be%d1%82%d0%ba%d0%bb%d1%8e%d1%87%d0%b5%d0%bd%d0%b8%d0%b5-%d0%b4%d0%b8%d1%81%d0%ba%d0%be%d0%b2">Подключение и отключение дисков</a>
</h3><p>Подключение и отключение дисков осуществляются командами <code>attach</code> и <code>detach</code>, соответственно.</p>
<h4 id="подключение-второго-диска-для-создания-зеркала">
  <a class="link-body-emphasis" href="#%d0%bf%d0%be%d0%b4%d0%ba%d0%bb%d1%8e%d1%87%d0%b5%d0%bd%d0%b8%d0%b5-%d0%b2%d1%82%d0%be%d1%80%d0%be%d0%b3%d0%be-%d0%b4%d0%b8%d1%81%d0%ba%d0%b0-%d0%b4%d0%bb%d1%8f-%d1%81%d0%be%d0%b7%d0%b4%d0%b0%d0%bd%d0%b8%d1%8f-%d0%b7%d0%b5%d1%80%d0%ba%d0%b0%d0%bb%d0%b0">Подключение второго диска (для создания зеркала)</a>
</h4><p>Подключение нового диска <code>pci-0000:03:00.0-scsi-0:1:1:0</code> к существующему диску <code>pci-0000:03:00.0-scsi-0:1:0:0</code> в пуле <code>data</code> для создания зеркала:</p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-6
shortcode-codeblock-bash">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-fb8ff63305e52400684c7af4b43be862" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="nv">p</span><span class="o">=</span><span class="s1">&#39;data&#39;</span><span class="p">;</span> zpool attach <span class="s2">&#34;</span><span class="si">${</span><span class="nv">p</span><span class="si">}</span><span class="s2">&#34;</span> <span class="s1">&#39;pci-0000:03:00.0-scsi-0:1:0:0&#39;</span> <span class="s1">&#39;pci-0000:03:00.0-scsi-0:1:1:0&#39;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-fb8ff63305e52400684c7af4b43be862"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<h4 id="отключение-второго-диска">
  <a class="link-body-emphasis" href="#%d0%be%d1%82%d0%ba%d0%bb%d1%8e%d1%87%d0%b5%d0%bd%d0%b8%d0%b5-%d0%b2%d1%82%d0%be%d1%80%d0%be%d0%b3%d0%be-%d0%b4%d0%b8%d1%81%d0%ba%d0%b0">Отключение второго диска</a>
</h4><p>Отключение нового диска <code>pci-0000:03:00.0-scsi-0:1:1:0</code> в пуле <code>data</code>:</p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-7
shortcode-codeblock-bash">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-55fc8c2b6400b19c484ac768c9479cfc" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="nv">p</span><span class="o">=</span><span class="s1">&#39;data&#39;</span><span class="p">;</span> zpool detach <span class="s2">&#34;</span><span class="si">${</span><span class="nv">p</span><span class="si">}</span><span class="s2">&#34;</span> <span class="s1">&#39;pci-0000:03:00.0-scsi-0:1:1:0&#39;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-55fc8c2b6400b19c484ac768c9479cfc"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<h3 id="импортирование-пула">
  <a class="link-body-emphasis" href="#%d0%b8%d0%bc%d0%bf%d0%be%d1%80%d1%82%d0%b8%d1%80%d0%be%d0%b2%d0%b0%d0%bd%d0%b8%d0%b5-%d0%bf%d1%83%d0%bb%d0%b0">Импортирование пула</a>
</h3><p>Импортировать пул <code>data</code>, состоящий из дисков <code>pci-0000:01:00.0-scsi-0:1:0:0</code> и <code>pci-0000:01:00.0-scsi-0:1:1:0</code>:</p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-8
shortcode-codeblock-bash">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-d02277bbd59d5b97392aa16f6c1ef744" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="nv">p</span><span class="o">=</span><span class="s1">&#39;data&#39;</span><span class="p">;</span> zpool import -d <span class="s1">&#39;pci-0000:01:00.0-scsi-0:1:0:0&#39;</span> -d <span class="s1">&#39;pci-0000:01:00.0-scsi-0:1:1:0&#39;</span> <span class="s2">&#34;</span><span class="si">${</span><span class="nv">p</span><span class="si">}</span><span class="s2">&#34;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-d02277bbd59d5b97392aa16f6c1ef744"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<p>Или можно разрешить <span class="shortcode shortcode-tag"><a href="/ru/tags/zfs/" target="_blank">#ZFS</a></span> автоматически поискать диски пула <code>data</code>:</p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-9
shortcode-codeblock-bash">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-c09df19b630f9273c65d93203dea439f" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="nv">p</span><span class="o">=</span><span class="s1">&#39;data&#39;</span><span class="p">;</span> zpool import -d <span class="s1">&#39;/dev/disk/by-path/&#39;</span> <span class="s2">&#34;</span><span class="si">${</span><span class="nv">p</span><span class="si">}</span><span class="s2">&#34;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-c09df19b630f9273c65d93203dea439f"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<h3 id="переименования-пула">
  <a class="link-body-emphasis" href="#%d0%bf%d0%b5%d1%80%d0%b5%d0%b8%d0%bc%d0%b5%d0%bd%d0%be%d0%b2%d0%b0%d0%bd%d0%b8%d1%8f-%d0%bf%d1%83%d0%bb%d0%b0">Переименования пула</a>
</h3><p>Для переименования пула, необходимо сначала его экспортировать:</p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-10
shortcode-codeblock-bash">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-0c938b6cfd0c9d3c2f718101ccf5eb0b" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="nv">p</span><span class="o">=</span><span class="s1">&#39;data&#39;</span><span class="p">;</span> zpool <span class="nb">export</span> <span class="s2">&#34;</span><span class="si">${</span><span class="nv">p</span><span class="si">}</span><span class="s2">&#34;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-0c938b6cfd0c9d3c2f718101ccf5eb0b"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<p>И импортировать с новым именем:</p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-11
shortcode-codeblock-bash">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-a53477c3ab1036c58cc80ee9fe19dd2e" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="nv">p</span><span class="o">=</span><span class="s1">&#39;data_old&#39;</span><span class="p">;</span> <span class="nv">n</span><span class="o">=</span><span class="s1">&#39;data_new&#39;</span><span class="p">;</span> zpool import <span class="s2">&#34;</span><span class="si">${</span><span class="nv">p</span><span class="si">}</span><span class="s2">&#34;</span> <span class="s2">&#34;</span><span class="si">${</span><span class="nv">n</span><span class="si">}</span><span class="s2">&#34;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-a53477c3ab1036c58cc80ee9fe19dd2e"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<h3 id="обновление-пула">
  <a class="link-body-emphasis" href="#%d0%be%d0%b1%d0%bd%d0%be%d0%b2%d0%bb%d0%b5%d0%bd%d0%b8%d0%b5-%d0%bf%d1%83%d0%bb%d0%b0">Обновление пула</a>
</h3><p>Проверим необходимость обновления пула:</p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-12
shortcode-codeblock-bash">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-b7247521cc8e6a957e61dd9e726de5b7" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">zpool status -v</span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-b7247521cc8e6a957e61dd9e726de5b7"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<p>Если появится надпись <code>status: Some supported features are not enabled on the pool...</code>, то можно начать обновление пула <code>data</code>:</p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-13
shortcode-codeblock-bash">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-7a56177547935c6033aab58561b0ce39" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="nv">p</span><span class="o">=</span><span class="s1">&#39;data&#39;</span><span class="p">;</span> zpool upgrade <span class="s2">&#34;</span><span class="si">${</span><span class="nv">p</span><span class="si">}</span><span class="s2">&#34;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-7a56177547935c6033aab58561b0ce39"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<p>Или обновить сразу все пулы:</p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-14
shortcode-codeblock-bash">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-800b56b6777129f59b46d4313a9ebd28" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">zpool upgrade -a</span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-800b56b6777129f59b46d4313a9ebd28"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<h3 id="удаление-пула">
  <a class="link-body-emphasis" href="#%d1%83%d0%b4%d0%b0%d0%bb%d0%b5%d0%bd%d0%b8%d0%b5-%d0%bf%d1%83%d0%bb%d0%b0">Удаление пула</a>
</h3><p>Если пул <code>data</code> стал не нужен, его можно удалить:</p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-15
shortcode-codeblock-bash">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-7aab46aa89572e5dfc33bd28d59bd54b" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="nv">p</span><span class="o">=</span><span class="s1">&#39;data&#39;</span><span class="p">;</span> zpool destroy <span class="s2">&#34;</span><span class="si">${</span><span class="nv">p</span><span class="si">}</span><span class="s2">&#34;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-7aab46aa89572e5dfc33bd28d59bd54b"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<h3 id="список-пулов">
  <a class="link-body-emphasis" href="#%d1%81%d0%bf%d0%b8%d1%81%d0%be%d0%ba-%d0%bf%d1%83%d0%bb%d0%be%d0%b2">Список пулов</a>
</h3><p>Вывести список всех пулов в системе:</p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-16
shortcode-codeblock-bash">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-ff44aa572d492faa5c1e99cd55ce69ca" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">zpool list</span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-ff44aa572d492faa5c1e99cd55ce69ca"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<h3 id="статус-пула">
  <a class="link-body-emphasis" href="#%d1%81%d1%82%d0%b0%d1%82%d1%83%d1%81-%d0%bf%d1%83%d0%bb%d0%b0">Статус пула</a>
</h3><p>Проверить статус пула <code>data</code>:</p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-17
shortcode-codeblock-bash">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-4a71d3b75e01822121a09e55e578634a" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="nv">p</span><span class="o">=</span><span class="s1">&#39;data&#39;</span><span class="p">;</span> zpool status -v <span class="s2">&#34;</span><span class="si">${</span><span class="nv">p</span><span class="si">}</span><span class="s2">&#34;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-4a71d3b75e01822121a09e55e578634a"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<h3 id="работа-с-raid">
  <a class="link-body-emphasis" href="#%d1%80%d0%b0%d0%b1%d0%be%d1%82%d0%b0-%d1%81-raid">Работа с RAID</a>
</h3><p>Рассмотрим команды создания пула <span class="shortcode shortcode-tag"><a href="/ru/tags/zfs/" target="_blank">#ZFS</a></span> из нескольких дисков.</p>
<h4 id="stripe-raid0">
  <a class="link-body-emphasis" href="#stripe-raid0">Stripe (RAID0)</a>
</h4><p>Создать <strong>RAID-0</strong> из дисков <code>pci-0000:01:00.0-scsi-0:1:0:0</code> и <code>pci-0000:01:00.0-scsi-0:1:1:0</code>:</p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-18
shortcode-codeblock-bash">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-7478814a7997da84561473cbf67bf460" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="nv">p</span><span class="o">=</span><span class="s1">&#39;data&#39;</span><span class="p">;</span> zpool create -o <span class="s1">&#39;ashift=12&#39;</span> -O <span class="s1">&#39;atime=off&#39;</span> <span class="s2">&#34;</span><span class="si">${</span><span class="nv">p</span><span class="si">}</span><span class="s2">&#34;</span> <span class="s1">&#39;pci-0000:01:00.0-scsi-0:1:0:0&#39;</span> <span class="s1">&#39;pci-0000:01:00.0-scsi-0:1:1:0&#39;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-7478814a7997da84561473cbf67bf460"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<h4 id="mirror-raid1">
  <a class="link-body-emphasis" href="#mirror-raid1">Mirror (RAID1)</a>
</h4><p>Создать зеркало (<strong>RAID-1</strong>) из дисков <code>pci-0000:01:00.0-scsi-0:1:0:0</code> и <code>pci-0000:01:00.0-scsi-0:1:1:0</code>:</p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-19
shortcode-codeblock-bash">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-150b199ee65eb074c6c0b281bda018f4" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="nv">p</span><span class="o">=</span><span class="s1">&#39;data&#39;</span><span class="p">;</span> zpool create -o <span class="s1">&#39;ashift=12&#39;</span> -O <span class="s1">&#39;atime=off&#39;</span> <span class="s2">&#34;</span><span class="si">${</span><span class="nv">p</span><span class="si">}</span><span class="s2">&#34;</span> mirror <span class="s1">&#39;pci-0000:01:00.0-scsi-0:1:0:0&#39;</span> <span class="s1">&#39;pci-0000:01:00.0-scsi-0:1:1:0&#39;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-150b199ee65eb074c6c0b281bda018f4"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<h4 id="raid10">
  <a class="link-body-emphasis" href="#raid10">RAID10</a>
</h4><p>Создать <strong>RAID-10</strong> из дисков <code>pci-0000:01:00.0-scsi-0:1:0:0</code>, <code>pci-0000:01:00.0-scsi-0:1:1:0</code>, <code>pci-0000:01:00.0-scsi-0:1:2:0</code> и <code>pci-0000:01:00.0-scsi-0:1:3:0</code>:</p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-20
shortcode-codeblock-bash">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-18e3b345d6cffb4a9274c9b914322f1d" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="nv">p</span><span class="o">=</span><span class="s1">&#39;data&#39;</span><span class="p">;</span> zpool create -o <span class="s1">&#39;ashift=12&#39;</span> -O <span class="s1">&#39;atime=off&#39;</span> <span class="s2">&#34;</span><span class="si">${</span><span class="nv">p</span><span class="si">}</span><span class="s2">&#34;</span> mirror <span class="s1">&#39;pci-0000:01:00.0-scsi-0:1:0:0&#39;</span> <span class="s1">&#39;pci-0000:01:00.0-scsi-0:1:1:0&#39;</span> mirror <span class="s1">&#39;pci-0000:01:00.0-scsi-0:1:2:0&#39;</span> <span class="s1">&#39;pci-0000:01:00.0-scsi-0:1:3:0&#39;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-18e3b345d6cffb4a9274c9b914322f1d"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<h4 id="raidz-1-raid5">
  <a class="link-body-emphasis" href="#raidz-1-raid5">RAIDZ-1 (RAID5)</a>
</h4><p>Создать <strong>RAID-5</strong> из дисков <code>pci-0000:01:00.0-scsi-0:1:0:0</code>, <code>pci-0000:01:00.0-scsi-0:1:1:0</code> и <code>pci-0000:01:00.0-scsi-0:1:2:0</code>:</p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-21
shortcode-codeblock-bash">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-1c97f2794de6d9e5fbc7d309f3988893" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="nv">p</span><span class="o">=</span><span class="s1">&#39;data&#39;</span><span class="p">;</span> zpool create -o <span class="s1">&#39;ashift=12&#39;</span> -O <span class="s1">&#39;atime=off&#39;</span> <span class="s2">&#34;</span><span class="si">${</span><span class="nv">p</span><span class="si">}</span><span class="s2">&#34;</span> raidz <span class="s1">&#39;pci-0000:01:00.0-scsi-0:1:0:0&#39;</span> <span class="s1">&#39;pci-0000:01:00.0-scsi-0:1:1:0&#39;</span> <span class="s1">&#39;pci-0000:01:00.0-scsi-0:1:2:0&#39;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-1c97f2794de6d9e5fbc7d309f3988893"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<h4 id="raidz-2-raid6">
  <a class="link-body-emphasis" href="#raidz-2-raid6">RAIDZ-2 (RAID6)</a>
</h4><p>Создать <strong>RAID-6</strong> из дисков <code>pci-0000:01:00.0-scsi-0:1:0:0</code>, <code>pci-0000:01:00.0-scsi-0:1:1:0</code>, <code>pci-0000:01:00.0-scsi-0:1:2:0</code> и <code>pci-0000:01:00.0-scsi-0:1:3:0</code></p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-22
shortcode-codeblock-bash">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-60a24ef535547540c480d48dea384e2c" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="nv">p</span><span class="o">=</span><span class="s1">&#39;data&#39;</span><span class="p">;</span> zpool create -o <span class="s1">&#39;ashift=12&#39;</span> -O <span class="s1">&#39;atime=off&#39;</span> <span class="s2">&#34;</span><span class="si">${</span><span class="nv">p</span><span class="si">}</span><span class="s2">&#34;</span> raidz2 <span class="s1">&#39;pci-0000:01:00.0-scsi-0:1:0:0&#39;</span> <span class="s1">&#39;pci-0000:01:00.0-scsi-0:1:1:0&#39;</span> <span class="s1">&#39;pci-0000:01:00.0-scsi-0:1:2:0&#39;</span> <span class="s1">&#39;pci-0000:01:00.0-scsi-0:1:3:0&#39;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-60a24ef535547540c480d48dea384e2c"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<h4 id="raidz-3">
  <a class="link-body-emphasis" href="#raidz-3">RAIDZ-3</a>
</h4><p>Создать <strong>RAIDZ-3</strong> из дисков <code>pci-0000:01:00.0-scsi-0:1:0:0</code> <code>pci-0000:01:00.0-scsi-0:1:1:0</code> <code>pci-0000:01:00.0-scsi-0:1:2:0</code> <code>pci-0000:01:00.0-scsi-0:1:3:0</code> и <code>pci-0000:01:00.0-scsi-0:1:4:0</code>:</p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-23
shortcode-codeblock-bash">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-cdb68fb2ab6fd928d81e5e561e1f3ca0" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="nv">p</span><span class="o">=</span><span class="s1">&#39;data&#39;</span><span class="p">;</span> zpool create -o <span class="s1">&#39;ashift=12&#39;</span> -O <span class="s1">&#39;atime=off&#39;</span> <span class="s2">&#34;</span><span class="si">${</span><span class="nv">p</span><span class="si">}</span><span class="s2">&#34;</span> raidz3 <span class="s1">&#39;pci-0000:01:00.0-scsi-0:1:0:0&#39;</span> <span class="s1">&#39;pci-0000:01:00.0-scsi-0:1:1:0&#39;</span> <span class="s1">&#39;pci-0000:01:00.0-scsi-0:1:2:0&#39;</span> <span class="s1">&#39;pci-0000:01:00.0-scsi-0:1:3:0&#39;</span> <span class="s1">&#39;pci-0000:01:00.0-scsi-0:1:4:0&#39;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-cdb68fb2ab6fd928d81e5e561e1f3ca0"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<h3 id="работа-с-arc-и-zil">
  <a class="link-body-emphasis" href="#%d1%80%d0%b0%d0%b1%d0%be%d1%82%d0%b0-%d1%81-arc-%d0%b8-zil">Работа с ARC и ZIL</a>
</h3><p>Добавляем отдельные устройства для работы с <strong>ARC</strong> и <strong>ZIL</strong>.</p>
<h4 id="arc">
  <a class="link-body-emphasis" href="#arc">ARC</a>
</h4><p>Добавить отдельный диск (<strong>L2ARC</strong>) <code>pci-0000:01:00.0-scsi-0:1:4:0</code> для работы с <strong>ARC</strong> в пул <code>data</code>:</p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-24
shortcode-codeblock-bash">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-7fbf3e7c789641923dcb7a8d88c028b4" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="nv">p</span><span class="o">=</span><span class="s1">&#39;data&#39;</span><span class="p">;</span> zpool add <span class="s2">&#34;</span><span class="si">${</span><span class="nv">p</span><span class="si">}</span><span class="s2">&#34;</span> cache <span class="s1">&#39;pci-0000:01:00.0-scsi-0:1:4:0&#39;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-7fbf3e7c789641923dcb7a8d88c028b4"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<h4 id="zil">
  <a class="link-body-emphasis" href="#zil">ZIL</a>
</h4><p>Добавить отдельный диск (<strong>SLOG</strong>) <code>pci-0000:01:00.0-scsi-0:1:5:0</code> для работы с <strong>ZIL</strong>  в пул <code>data</code>:</p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-25
shortcode-codeblock-bash">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-78a0e5517e6f23235e4170623b2580d1" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="nv">p</span><span class="o">=</span><span class="s1">&#39;data&#39;</span><span class="p">;</span> zpool add <span class="s2">&#34;</span><span class="si">${</span><span class="nv">p</span><span class="si">}</span><span class="s2">&#34;</span> log <span class="s1">&#39;pci-0000:01:00.0-scsi-0:1:5:0&#39;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-78a0e5517e6f23235e4170623b2580d1"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<h2 id="тома">
  <a class="link-body-emphasis" href="#%d1%82%d0%be%d0%bc%d0%b0">Тома</a>
</h2><h3 id="создание-тома">
  <a class="link-body-emphasis" href="#%d1%81%d0%be%d0%b7%d0%b4%d0%b0%d0%bd%d0%b8%d0%b5-%d1%82%d0%be%d0%bc%d0%b0">Создание тома</a>
</h3><p>Создать том <code>cloud</code> в пуле <code>data</code>:</p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-26
shortcode-codeblock-bash">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-bf44f4325683c9c3dfefc9d385b52577" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="nv">p</span><span class="o">=</span><span class="s1">&#39;data&#39;</span><span class="p">;</span> <span class="nv">v</span><span class="o">=</span><span class="s1">&#39;cloud&#39;</span><span class="p">;</span> zfs create <span class="s2">&#34;</span><span class="si">${</span><span class="nv">p</span><span class="si">}</span><span class="s2">/</span><span class="si">${</span><span class="nv">v</span><span class="si">}</span><span class="s2">&#34;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-bf44f4325683c9c3dfefc9d385b52577"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<p>Создать том <code>cloud</code> в пуле <code>data</code> и с точкой монтирования <code>/opt/cloud</code>:</p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-27
shortcode-codeblock-bash">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-4b3e404c6443168f6c6eb45e7f1b5f89" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="nv">p</span><span class="o">=</span><span class="s1">&#39;data&#39;</span><span class="p">;</span> <span class="nv">v</span><span class="o">=</span><span class="s1">&#39;cloud&#39;</span><span class="p">;</span> zfs create -o <span class="s2">&#34;mountpoint=/opt/</span><span class="si">${</span><span class="nv">v</span><span class="si">}</span><span class="s2">&#34;</span> <span class="s2">&#34;</span><span class="si">${</span><span class="nv">p</span><span class="si">}</span><span class="s2">/</span><span class="si">${</span><span class="nv">v</span><span class="si">}</span><span class="s2">&#34;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-4b3e404c6443168f6c6eb45e7f1b5f89"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<p>Создать том <code>cloud</code> в пуле <code>data</code> и с алгоритмом компрессии <code>zstd</code>:</p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-28
shortcode-codeblock-bash">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-df1309b8e610883c4774e6be330a2f97" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="nv">p</span><span class="o">=</span><span class="s1">&#39;data&#39;</span><span class="p">;</span> <span class="nv">v</span><span class="o">=</span><span class="s1">&#39;cloud&#39;</span><span class="p">;</span> zfs create -o <span class="s1">&#39;compression=zstd&#39;</span> <span class="s2">&#34;</span><span class="si">${</span><span class="nv">p</span><span class="si">}</span><span class="s2">/</span><span class="si">${</span><span class="nv">v</span><span class="si">}</span><span class="s2">&#34;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-df1309b8e610883c4774e6be330a2f97"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<p>Создать том <code>cloud</code> в пуле <code>data</code> с алгоритмом компрессии <code>zstd</code> и точкой монтирования <code>/opt/cloud</code>:</p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-29
shortcode-codeblock-bash">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-952d35df253c552b89405fb81c5591a6" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="nv">p</span><span class="o">=</span><span class="s1">&#39;data&#39;</span><span class="p">;</span> <span class="nv">v</span><span class="o">=</span><span class="s1">&#39;cloud&#39;</span><span class="p">;</span> zfs create -o <span class="s1">&#39;compression=zstd&#39;</span> -o <span class="s2">&#34;mountpoint=/opt/</span><span class="si">${</span><span class="nv">v</span><span class="si">}</span><span class="s2">&#34;</span> <span class="s2">&#34;</span><span class="si">${</span><span class="nv">p</span><span class="si">}</span><span class="s2">/</span><span class="si">${</span><span class="nv">v</span><span class="si">}</span><span class="s2">&#34;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-952d35df253c552b89405fb81c5591a6"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<h3 id="удаление-тома">
  <a class="link-body-emphasis" href="#%d1%83%d0%b4%d0%b0%d0%bb%d0%b5%d0%bd%d0%b8%d0%b5-%d1%82%d0%be%d0%bc%d0%b0">Удаление тома</a>
</h3><p>Удалить том <code>cloud</code> в пуле <code>data</code>:</p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-30
shortcode-codeblock-bash">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-6eb938dc041c0648506d6485f914f895" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="nv">p</span><span class="o">=</span><span class="s1">&#39;data&#39;</span><span class="p">;</span> <span class="nv">v</span><span class="o">=</span><span class="s1">&#39;cloud&#39;</span><span class="p">;</span> zfs destroy <span class="s2">&#34;</span><span class="si">${</span><span class="nv">p</span><span class="si">}</span><span class="s2">/</span><span class="si">${</span><span class="nv">v</span><span class="si">}</span><span class="s2">&#34;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-6eb938dc041c0648506d6485f914f895"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<h3 id="создание-зашифрованного-тома">
  <a class="link-body-emphasis" href="#%d1%81%d0%be%d0%b7%d0%b4%d0%b0%d0%bd%d0%b8%d0%b5-%d0%b7%d0%b0%d1%88%d0%b8%d1%84%d1%80%d0%be%d0%b2%d0%b0%d0%bd%d0%bd%d0%be%d0%b3%d0%be-%d1%82%d0%be%d0%bc%d0%b0">Создание зашифрованного тома</a>
</h3><p>Создать том <code>secret</code> в пуле <code>data</code> и зашифровать его парольной фразой:</p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-31
shortcode-codeblock-bash">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-f65bdb1710bd0f96e345f1cc5e5a1594" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="nv">p</span><span class="o">=</span><span class="s1">&#39;data&#39;</span><span class="p">;</span> <span class="nv">v</span><span class="o">=</span><span class="s1">&#39;secret&#39;</span><span class="p">;</span> zfs create -o <span class="s1">&#39;encryption=on&#39;</span> -o <span class="s1">&#39;keyformat=passphrase&#39;</span> <span class="s2">&#34;</span><span class="si">${</span><span class="nv">p</span><span class="si">}</span><span class="s2">/</span><span class="si">${</span><span class="nv">v</span><span class="si">}</span><span class="s2">&#34;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-f65bdb1710bd0f96e345f1cc5e5a1594"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<p>Где:</p>
<ul>
<li><code>encryption=on</code> - включение шифрования.</li>
<li><code>keyformat=passphrase</code> - тип шифрования &ldquo;парольная фраза&rdquo;.</li>
</ul>
<p>При создании тома <code>secret</code>, <span class="shortcode shortcode-tag"><a href="/ru/tags/zfs/" target="_blank">#ZFS</a></span> попросит ввести парольную фразу для шифрования данных.</p>
<h2 id="снимки">
  <a class="link-body-emphasis" href="#%d1%81%d0%bd%d0%b8%d0%bc%d0%ba%d0%b8">Снимки</a>
</h2><h3 id="список-снимков">
  <a class="link-body-emphasis" href="#%d1%81%d0%bf%d0%b8%d1%81%d0%be%d0%ba-%d1%81%d0%bd%d0%b8%d0%bc%d0%ba%d0%be%d0%b2">Список снимков</a>
</h3><p>Показать список всех снимков:</p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-32
shortcode-codeblock-bash">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-6c04af060c9db4266393cdd2d69d5499" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">zfs list -t <span class="s1">&#39;snapshot&#39;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-6c04af060c9db4266393cdd2d69d5499"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<p>Показать список снимков тома <code>cloud</code> в пуле <code>data</code>:</p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-33
shortcode-codeblock-bash">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-56ec2f45b33814876d5b84ba691210db" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="nv">p</span><span class="o">=</span><span class="s1">&#39;data&#39;</span><span class="p">;</span> <span class="nv">v</span><span class="o">=</span><span class="s1">&#39;cloud&#39;</span><span class="p">;</span> zfs list -r -t <span class="s1">&#39;snapshot&#39;</span> -o <span class="s1">&#39;name,creation&#39;</span> <span class="s2">&#34;</span><span class="si">${</span><span class="nv">p</span><span class="si">}</span><span class="s2">/</span><span class="si">${</span><span class="nv">v</span><span class="si">}</span><span class="s2">&#34;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-56ec2f45b33814876d5b84ba691210db"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<h3 id="создание-снимков">
  <a class="link-body-emphasis" href="#%d1%81%d0%be%d0%b7%d0%b4%d0%b0%d0%bd%d0%b8%d0%b5-%d1%81%d0%bd%d0%b8%d0%bc%d0%ba%d0%be%d0%b2">Создание снимков</a>
</h3><p>Создать снимок <code>2024-08-21.19-32-02</code> тома <code>cloud</code> в пуле <code>data</code>:</p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-34
shortcode-codeblock-bash">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-f3fcfc5c7df5dd54e16af00df0263bcb" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="nv">p</span><span class="o">=</span><span class="s1">&#39;data&#39;</span><span class="p">;</span> <span class="nv">v</span><span class="o">=</span><span class="s1">&#39;cloud&#39;</span><span class="p">;</span> <span class="nv">s</span><span class="o">=</span><span class="k">$(</span> date <span class="s1">&#39;+%F.%H-%M-%S&#39;</span> <span class="k">)</span><span class="p">;</span> zfs snapshot <span class="s2">&#34;</span><span class="si">${</span><span class="nv">p</span><span class="si">}</span><span class="s2">/</span><span class="si">${</span><span class="nv">v</span><span class="si">}</span><span class="s2">@</span><span class="si">${</span><span class="nv">s</span><span class="si">}</span><span class="s2">&#34;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-f3fcfc5c7df5dd54e16af00df0263bcb"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<p>Создать снимок <code>2024-08-21.19-32-02</code> тома <code>cloud</code> и всех его дочерних томов в пуле <code>data</code>:</p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-35
shortcode-codeblock-bash">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-d50c51a452082befe135c010cb8faff3" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="nv">p</span><span class="o">=</span><span class="s1">&#39;data&#39;</span><span class="p">;</span> <span class="nv">v</span><span class="o">=</span><span class="s1">&#39;cloud&#39;</span><span class="p">;</span> <span class="nv">s</span><span class="o">=</span><span class="k">$(</span> date <span class="s1">&#39;+%F.%H-%M-%S&#39;</span> <span class="k">)</span><span class="p">;</span> zfs snapshot -r <span class="s2">&#34;</span><span class="si">${</span><span class="nv">p</span><span class="si">}</span><span class="s2">/</span><span class="si">${</span><span class="nv">v</span><span class="si">}</span><span class="s2">@</span><span class="si">${</span><span class="nv">s</span><span class="si">}</span><span class="s2">&#34;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-d50c51a452082befe135c010cb8faff3"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<h3 id="переименование-снимков">
  <a class="link-body-emphasis" href="#%d0%bf%d0%b5%d1%80%d0%b5%d0%b8%d0%bc%d0%b5%d0%bd%d0%be%d0%b2%d0%b0%d0%bd%d0%b8%d0%b5-%d1%81%d0%bd%d0%b8%d0%bc%d0%ba%d0%be%d0%b2">Переименование снимков</a>
</h3><p>Переименовать снимок <code>name_OLD</code> тома <code>cloud</code> в пуле <code>data</code>:</p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-36
shortcode-codeblock-bash">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-852f92a095571a1f95250e3757ba3606" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="nv">p</span><span class="o">=</span><span class="s1">&#39;data&#39;</span><span class="p">;</span> <span class="nv">v</span><span class="o">=</span><span class="s1">&#39;cloud&#39;</span><span class="p">;</span> zfs rename <span class="s2">&#34;</span><span class="si">${</span><span class="nv">p</span><span class="si">}</span><span class="s2">/</span><span class="si">${</span><span class="nv">v</span><span class="si">}</span><span class="s2">@name_OLD&#34;</span> <span class="s1">&#39;name_NEW&#39;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-852f92a095571a1f95250e3757ba3606"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<p>Переименовать снимок <code>name_OLD</code> тома <code>cloud</code> и во всех его дочерних томов в пуле <code>data</code>:</p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-37
shortcode-codeblock-bash">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-7fd3d0c116420125f5fbaf87926f9a8b" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="nv">p</span><span class="o">=</span><span class="s1">&#39;data&#39;</span><span class="p">;</span> <span class="nv">v</span><span class="o">=</span><span class="s1">&#39;cloud&#39;</span><span class="p">;</span> zfs rename -r <span class="s2">&#34;</span><span class="si">${</span><span class="nv">p</span><span class="si">}</span><span class="s2">/</span><span class="si">${</span><span class="nv">v</span><span class="si">}</span><span class="s2">@name_OLD&#34;</span> <span class="s1">&#39;name_NEW&#39;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-7fd3d0c116420125f5fbaf87926f9a8b"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<h3 id="откат-данных-к-снимку">
  <a class="link-body-emphasis" href="#%d0%be%d1%82%d0%ba%d0%b0%d1%82-%d0%b4%d0%b0%d0%bd%d0%bd%d1%8b%d1%85-%d0%ba-%d1%81%d0%bd%d0%b8%d0%bc%d0%ba%d1%83">Откат данных к снимку</a>
</h3><p>Выполнить откат данных к снимку <code>2024-08-21.19-32-02</code> тома <code>cloud</code> в пуле <code>data</code>:</p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-38
shortcode-codeblock-bash">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-723a411d9dd9eeb4a3575365eda0a941" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="nv">p</span><span class="o">=</span><span class="s1">&#39;data&#39;</span><span class="p">;</span> <span class="nv">v</span><span class="o">=</span><span class="s1">&#39;cloud&#39;</span><span class="p">;</span> zfs rollback <span class="s2">&#34;</span><span class="si">${</span><span class="nv">p</span><span class="si">}</span><span class="s2">/</span><span class="si">${</span><span class="nv">v</span><span class="si">}</span><span class="s2">@2024-08-21.19-32-02&#34;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-723a411d9dd9eeb4a3575365eda0a941"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<h3 id="удаление-снимков">
  <a class="link-body-emphasis" href="#%d1%83%d0%b4%d0%b0%d0%bb%d0%b5%d0%bd%d0%b8%d0%b5-%d1%81%d0%bd%d0%b8%d0%bc%d0%ba%d0%be%d0%b2">Удаление снимков</a>
</h3><p>Удалить снимок <code>2024-08-21.19-32-02</code> тома <code>cloud</code> в пуле <code>data</code>:</p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-39
shortcode-codeblock-bash">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-8b74e3039dcbed6d182f30755373f4d4" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="nv">p</span><span class="o">=</span><span class="s1">&#39;data&#39;</span><span class="p">;</span> <span class="nv">v</span><span class="o">=</span><span class="s1">&#39;cloud&#39;</span><span class="p">;</span> zfs destroy <span class="s2">&#34;</span><span class="si">${</span><span class="nv">p</span><span class="si">}</span><span class="s2">/</span><span class="si">${</span><span class="nv">v</span><span class="si">}</span><span class="s2">@2024-08-21.19-32-02&#34;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-8b74e3039dcbed6d182f30755373f4d4"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<h2 id="оптимизации">
  <a class="link-body-emphasis" href="#%d0%be%d0%bf%d1%82%d0%b8%d0%bc%d0%b8%d0%b7%d0%b0%d1%86%d0%b8%d0%b8">Оптимизации</a>
</h2><p>Специализированные настройки <span class="shortcode shortcode-tag"><a href="/ru/tags/zfs/" target="_blank">#ZFS</a></span> под конкретные задачи.</p>
<h3 id="postgresql">
  <a class="link-body-emphasis" href="#postgresql">PostgreSQL</a>
</h3><p>Создать основной том <code>pgsql</code> с алгоритмом компрессии <code>zstd</code>:</p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-40
shortcode-codeblock-bash">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-b84a71f5a59a5a03b8ca07d2fe3a7765" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="nv">p</span><span class="o">=</span><span class="s1">&#39;data&#39;</span><span class="p">;</span> <span class="nv">v</span><span class="o">=</span><span class="s1">&#39;pgsql&#39;</span><span class="p">;</span> zfs create -o <span class="s1">&#39;compression=zstd&#39;</span> <span class="s2">&#34;</span><span class="si">${</span><span class="nv">p</span><span class="si">}</span><span class="s2">/</span><span class="si">${</span><span class="nv">v</span><span class="si">}</span><span class="s2">&#34;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-b84a71f5a59a5a03b8ca07d2fe3a7765"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<p>Создать специальный том <code>pgsql/main</code> с алгоритмом компрессии <code>zstd</code> и размером блока <code>32K</code> для баз данных:</p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-41
shortcode-codeblock-bash">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-830cd329a7c2c79ede3616950d626a06" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="nv">p</span><span class="o">=</span><span class="s1">&#39;data&#39;</span><span class="p">;</span> <span class="nv">v</span><span class="o">=</span><span class="s1">&#39;pgsql/main&#39;</span><span class="p">;</span> zfs create -o <span class="s1">&#39;recordsize=32K&#39;</span> <span class="s2">&#34;</span><span class="si">${</span><span class="nv">p</span><span class="si">}</span><span class="s2">/</span><span class="si">${</span><span class="nv">v</span><span class="si">}</span><span class="s2">&#34;</span> <span class="o">&amp;&amp;</span> chmod <span class="m">700</span> <span class="s2">&#34;/</span><span class="si">${</span><span class="nv">p</span><span class="si">}</span><span class="s2">/</span><span class="si">${</span><span class="nv">v</span><span class="si">}</span><span class="s2">&#34;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-830cd329a7c2c79ede3616950d626a06"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<p>Создать специальный том <code>pgsql/wal</code> с алгоритмом компрессии <code>zstd</code> и размером блока <code>32K</code> для WAL:</p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-42
shortcode-codeblock-bash">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-5ccf992a07e63bb7fc822c8b31326ca0" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="nv">p</span><span class="o">=</span><span class="s1">&#39;data&#39;</span><span class="p">;</span> <span class="nv">v</span><span class="o">=</span><span class="s1">&#39;pgsql/wal&#39;</span><span class="p">;</span> zfs create -o <span class="s1">&#39;recordsize=32K&#39;</span> <span class="s2">&#34;</span><span class="si">${</span><span class="nv">p</span><span class="si">}</span><span class="s2">/</span><span class="si">${</span><span class="nv">v</span><span class="si">}</span><span class="s2">&#34;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-5ccf992a07e63bb7fc822c8b31326ca0"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<p>Откорректировать настройки <span class="shortcode shortcode-tag">PostgreSQL</span>:</p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-43
shortcode-codeblock-ini">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-22426c85b69463aa3565cecb436e5867" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-ini" data-lang="ini"><span class="line"><span class="cl"><span class="na">data_directory</span> <span class="o">=</span> <span class="s">&#39;/data/pgsql/main&#39;</span>
</span></span><span class="line"><span class="cl"><span class="na">full_page_writes</span> <span class="o">=</span> <span class="s">off</span>
</span></span><span class="line"><span class="cl"><span class="na">wal_init_zero</span> <span class="o">=</span> <span class="s">off</span>
</span></span><span class="line"><span class="cl"><span class="na">wal_recycle</span> <span class="o">=</span> <span class="s">off</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-22426c85b69463aa3565cecb436e5867"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<h3 id="mysql">
  <a class="link-body-emphasis" href="#mysql">MySQL</a>
</h3><p>Создать основной том <code>mysql</code> с алгоритмом компрессии <code>zstd</code>:</p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-44
shortcode-codeblock-bash">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-0887bb336e3ef1bf44aacdf0ddf15ab1" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="nv">p</span><span class="o">=</span><span class="s1">&#39;data&#39;</span><span class="p">;</span> <span class="nv">v</span><span class="o">=</span><span class="s1">&#39;mysql&#39;</span><span class="p">;</span> zfs create -o <span class="s1">&#39;compression=zstd&#39;</span> <span class="s2">&#34;</span><span class="si">${</span><span class="nv">p</span><span class="si">}</span><span class="s2">/</span><span class="si">${</span><span class="nv">v</span><span class="si">}</span><span class="s2">&#34;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-0887bb336e3ef1bf44aacdf0ddf15ab1"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<p>Создать специальный том <code>mysql/main</code> с алгоритмом компрессии <code>zstd</code> и размером блока <code>16K</code> для баз данных:</p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-45
shortcode-codeblock-bash">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-2c20369642c6b23a94d7fa09d9392911" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="nv">p</span><span class="o">=</span><span class="s1">&#39;data&#39;</span><span class="p">;</span> <span class="nv">v</span><span class="o">=</span><span class="s1">&#39;mysql/main&#39;</span><span class="p">;</span> zfs create -o <span class="s1">&#39;recordsize=16K&#39;</span> <span class="s2">&#34;</span><span class="si">${</span><span class="nv">p</span><span class="si">}</span><span class="s2">/</span><span class="si">${</span><span class="nv">v</span><span class="si">}</span><span class="s2">&#34;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-2c20369642c6b23a94d7fa09d9392911"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<p>Создать специальный том <code>mysql/log</code> с алгоритмом компрессии <code>zstd</code> для логирования:</p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-46
shortcode-codeblock-bash">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-e66869b11afb900d35d4378199905df4" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="nv">p</span><span class="o">=</span><span class="s1">&#39;data&#39;</span><span class="p">;</span> <span class="nv">v</span><span class="o">=</span><span class="s1">&#39;mysql/log&#39;</span><span class="p">;</span> zfs create <span class="s2">&#34;</span><span class="si">${</span><span class="nv">p</span><span class="si">}</span><span class="s2">/</span><span class="si">${</span><span class="nv">v</span><span class="si">}</span><span class="s2">&#34;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-e66869b11afb900d35d4378199905df4"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<p>Откорректировать настройки <span class="shortcode shortcode-tag">MySQL</span>:</p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-47
shortcode-codeblock-ini">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-6b82109077254e9efd5ef515c6ba4536" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-ini" data-lang="ini"><span class="line"><span class="cl"><span class="na">datadir</span> <span class="o">=</span> <span class="s">&#39;data/mysql/main&#39;</span>
</span></span><span class="line"><span class="cl"><span class="na">innodb_doublewrite</span> <span class="o">=</span> <span class="s">0</span>
</span></span><span class="line"><span class="cl"><span class="na">innodb_use_native_aio</span> <span class="o">=</span> <span class="s">0</span>
</span></span><span class="line"><span class="cl"><span class="na">innodb_use_atomic_writes</span> <span class="o">=</span> <span class="s">0</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-6b82109077254e9efd5ef515c6ba4536"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>]]></turbo:content></item><item turbo="true"><title>Как скрыть листинг директории, при этом разрешить просмотр содержимого файлов?</title><link>https://lib.onl/ru/2024/02/0a853441-d526-52ab-b5b2-48a57be6c33f/</link><pubDate>Fri, 16 Feb 2024 13:28:52 +0000</pubDate><dc:creator>Kai Kimera</dc:creator><category>Linux</category><category>Freebsd</category><category>Listing</category><category>Chmod</category><category>Permissions</category><yandex:related><link url="https://lib.onl/ru/2024/02/2589b2dc-ae2a-53a0-91d8-b3475c10401e/">Как создать директорию с общим доступом в Linux?</link><link url="https://lib.onl/ru/2024/02/936da675-3366-5344-a14a-5963d84c136d/">Как исправить ошибки сетевой карты Realtek в FreeBSD?</link></yandex:related><turbo:extendedHtml>true</turbo:extendedHtml><turbo:source>https://lib.onl/ru/2024/02/0a853441-d526-52ab-b5b2-48a57be6c33f/</turbo:source><turbo:topic>Как скрыть листинг директории, при этом разрешить просмотр содержимого файлов?</turbo:topic><turbo:content>&lt;p>Как скрыть содержимое директории от просмотра, но разрешить читать содержимое её файлов?&lt;/p></turbo:content></item><item turbo="true"><title>Как создать директорию с общим доступом в Linux?</title><link>https://lib.onl/ru/2024/02/2589b2dc-ae2a-53a0-91d8-b3475c10401e/</link><pubDate>Tue, 13 Feb 2024 12:47:40 +0000</pubDate><dc:creator>Kai Kimera</dc:creator><category>Linux</category><category>Freebsd</category><category>Chmod</category><category>Groupadd</category><category>Usermod</category><category>Chgrp</category><category>Permissions</category><yandex:related><link url="https://lib.onl/ru/2024/02/936da675-3366-5344-a14a-5963d84c136d/">Как исправить ошибки сетевой карты Realtek в FreeBSD?</link></yandex:related><turbo:extendedHtml>true</turbo:extendedHtml><turbo:source>https://lib.onl/ru/2024/02/2589b2dc-ae2a-53a0-91d8-b3475c10401e/</turbo:source><turbo:topic>Как создать директорию с общим доступом в Linux?</turbo:topic><turbo:content><![CDATA[<p>Нужна директория, в которой пользователи могут создавать общие файлы и папки в <span class="shortcode shortcode-tag"><a href="/ru/tags/linux/" target="_blank">#Linux</a></span> (<span class="shortcode shortcode-tag"><a href="/ru/tags/freebsd/" target="_blank">#FreeBSD</a></span>). Как такое можно сделать?</p>]]></turbo:content></item><item turbo="true"><title>Как проверить сервер Postfix?</title><link>https://lib.onl/ru/2024/02/404156e2-2ffb-535a-9b83-e40e1890f36a/</link><pubDate>Tue, 13 Feb 2024 02:49:47 +0000</pubDate><dc:creator>Kai Kimera</dc:creator><category>Postfix</category><category>Telnet</category><turbo:extendedHtml>true</turbo:extendedHtml><turbo:source>https://lib.onl/ru/2024/02/404156e2-2ffb-535a-9b83-e40e1890f36a/</turbo:source><turbo:topic>Как проверить сервер Postfix?</turbo:topic><turbo:content><![CDATA[<p>У меня есть почтовый сервер на базе <span class="shortcode shortcode-tag"><a href="/ru/tags/postfix/" target="_blank">#Postfix</a></span>. Как мне проверить его работоспособность?</p>]]></turbo:content></item><item turbo="true"><title>Как исправить ошибки сетевой карты Realtek в FreeBSD?</title><link>https://lib.onl/ru/2024/02/936da675-3366-5344-a14a-5963d84c136d/</link><pubDate>Sun, 11 Feb 2024 12:27:09 +0000</pubDate><dc:creator>Kai Kimera</dc:creator><category>Freebsd</category><category>Realtek</category><yandex:related><link url="https://lib.onl/ru/2024/02/a87c514f-4a5e-52e3-ad76-4dd11218c6d1/">Как исправить ошибки сетевой карты Realtek в OPNsense?</link></yandex:related><turbo:extendedHtml>true</turbo:extendedHtml><turbo:source>https://lib.onl/ru/2024/02/936da675-3366-5344-a14a-5963d84c136d/</turbo:source><turbo:topic>Как исправить ошибки сетевой карты Realtek в FreeBSD?</turbo:topic><turbo:content><![CDATA[<p>Сетевая карта <span class="shortcode shortcode-tag"><a href="/ru/tags/realtek/" target="_blank">#Realtek</a></span> в <span class="shortcode shortcode-tag"><a href="/ru/tags/freebsd/" target="_blank">#FreeBSD</a></span> работает не совсем корректно. Почему?</p>]]></turbo:content></item><item turbo="true"><title>Как исправить ошибки сетевой карты Realtek в OPNsense?</title><link>https://lib.onl/ru/2024/02/a87c514f-4a5e-52e3-ad76-4dd11218c6d1/</link><pubDate>Sun, 11 Feb 2024 12:12:57 +0000</pubDate><dc:creator>Kai Kimera</dc:creator><category>Opnsense</category><category>Realtek</category><category>Nat</category><turbo:extendedHtml>true</turbo:extendedHtml><turbo:source>https://lib.onl/ru/2024/02/a87c514f-4a5e-52e3-ad76-4dd11218c6d1/</turbo:source><turbo:topic>Как исправить ошибки сетевой карты Realtek в OPNsense?</turbo:topic><turbo:content><![CDATA[<p>Сетевая карта <span class="shortcode shortcode-tag"><a href="/ru/tags/realtek/" target="_blank">#Realtek</a></span> в <span class="shortcode shortcode-tag"><a href="/ru/tags/opnsense/" target="_blank">#OPNsense</a></span> ведёт себя странно: разрывает соединение или понижает скорость передачи данных. В чём проблема?</p>]]></turbo:content></item><item turbo="true"><title>Как правильно настроить PuTTY?</title><link>https://lib.onl/ru/2024/02/fa01d796-4d5e-51f8-968a-9937c299b86c/</link><pubDate>Sun, 11 Feb 2024 12:08:56 +0000</pubDate><dc:creator>Kai Kimera</dc:creator><category>Putty</category><category>Kitty</category><turbo:extendedHtml>true</turbo:extendedHtml><turbo:source>https://lib.onl/ru/2024/02/fa01d796-4d5e-51f8-968a-9937c299b86c/</turbo:source><turbo:topic>Как правильно настроить PuTTY?</turbo:topic><turbo:content><![CDATA[<p>У меня <span class="shortcode shortcode-tag"><a href="/ru/tags/putty/" target="_blank">#PuTTY</a></span> / <span class="shortcode shortcode-tag"><a href="/ru/tags/kitty/" target="_blank">#KiTTY</a></span> неправильно отображает шрифт и некорректно рисует интерфейсы. Как это исправить?</p>]]></turbo:content></item><item turbo="true"><title>Первичная настройка FreeBSD</title><link>https://lib.onl/ru/2024/02/f97dc310-9a6a-52f7-8441-bf7eb02087c2/</link><pubDate>Thu, 08 Feb 2024 08:59:09 +0000</pubDate><dc:creator>Kai Kimera</dc:creator><category>BSD</category><turbo:extendedHtml>true</turbo:extendedHtml><turbo:source>https://lib.onl/ru/2024/02/f97dc310-9a6a-52f7-8441-bf7eb02087c2/</turbo:source><turbo:topic>Первичная настройка FreeBSD</turbo:topic><turbo:content><![CDATA[<p>Надумал я как-то на днях изучить ОС <span class="shortcode shortcode-tag"><a href="/ru/tags/freebsd/" target="_blank">#FreeBSD</a></span>. Система обладает своими особенностями, но кто работает в <span class="shortcode shortcode-tag"><a href="/ru/tags/linux/" target="_blank">#Linux</a></span>, тот легко разберётся в FreeBSD.</p>
<h2 id="обновление-системы">
  <a class="link-body-emphasis" href="#%d0%be%d0%b1%d0%bd%d0%be%d0%b2%d0%bb%d0%b5%d0%bd%d0%b8%d0%b5-%d1%81%d0%b8%d1%81%d1%82%d0%b5%d0%bc%d1%8b">Обновление системы</a>
</h2><p>После установки базовой системы, рекомендуется запустить обновление.</p>
<ol>
<li>Запросить и применить обновления:</li>
</ol>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-0
shortcode-codeblock-bash">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-cd8d5193e88397353071e412448b229c" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">freebsd-update fetch <span class="o">&amp;&amp;</span> freebsd-update install</span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-cd8d5193e88397353071e412448b229c"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<h2 id="обновление-пакетов">
  <a class="link-body-emphasis" href="#%d0%be%d0%b1%d0%bd%d0%be%d0%b2%d0%bb%d0%b5%d0%bd%d0%b8%d0%b5-%d0%bf%d0%b0%d0%ba%d0%b5%d1%82%d0%be%d0%b2">Обновление пакетов</a>
</h2><ol>
<li>Запросить и применить обновления пакетов:</li>
</ol>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-1
shortcode-codeblock-bash">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-18a6240a697e96e421d57e554a3707b9" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">pkg update -f <span class="o">&amp;&amp;</span> pkg upgrade --yes</span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-18a6240a697e96e421d57e554a3707b9"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<h2 id="переключение-ветки-пакетов">
  <a class="link-body-emphasis" href="#%d0%bf%d0%b5%d1%80%d0%b5%d0%ba%d0%bb%d1%8e%d1%87%d0%b5%d0%bd%d0%b8%d0%b5-%d0%b2%d0%b5%d1%82%d0%ba%d0%b8-%d0%bf%d0%b0%d0%ba%d0%b5%d1%82%d0%be%d0%b2">Переключение ветки пакетов</a>
</h2><p>По умолчанию, <span class="shortcode shortcode-tag"><a href="/ru/tags/freebsd/" target="_blank">#FreeBSD</a></span> берёт обновления пакетов из квартальной (<code>quarterly</code>) ветки. Если хочется получить свежие пакеты здесь и сейчас, то нужно переключить ветку на <code>latest</code>.</p>
<ol>
<li>Создать файл <code>/usr/local/etc/pkg/repos/FreeBSD.conf</code>:</li>
</ol>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-2
shortcode-codeblock-bash">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-6b6cb267ee83191c135e955ab2ab9dcb" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">mkdir -p /usr/local/etc/pkg/repos <span class="o">&amp;&amp;</span> <span class="nb">echo</span> <span class="s1">&#39;FreeBSD: { url: &#34;pkg+http://pkg.FreeBSD.org/${ABI}/latest&#34; }&#39;</span> &gt; /usr/local/etc/pkg/repos/FreeBSD.conf</span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-6b6cb267ee83191c135e955ab2ab9dcb"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<ol start="2">
<li>Обновить базу данных пакетов и обновить пакеты:</li>
</ol>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-3
shortcode-codeblock-bash">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-739f6707b41a76245d850f58170d1122" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">pkg update -f <span class="o">&amp;&amp;</span> pkg upgrade --yes</span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-739f6707b41a76245d850f58170d1122"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<h2 id="установка-пакетов">
  <a class="link-body-emphasis" href="#%d1%83%d1%81%d1%82%d0%b0%d0%bd%d0%be%d0%b2%d0%ba%d0%b0-%d0%bf%d0%b0%d0%ba%d0%b5%d1%82%d0%be%d0%b2">Установка пакетов</a>
</h2><p>Для установки пакетов используется пакетный менеджер <code>pkg</code>. В интернете есть информация о том, что не рекомендуется смешивать пакеты и порты. То есть, если вы уже начали использовать пакеты, то надо продолжать только ими пользоваться.</p>
<h3 id="установка-сервиса-обновления-микрокода-cpu">
  <a class="link-body-emphasis" href="#%d1%83%d1%81%d1%82%d0%b0%d0%bd%d0%be%d0%b2%d0%ba%d0%b0-%d1%81%d0%b5%d1%80%d0%b2%d0%b8%d1%81%d0%b0-%d0%be%d0%b1%d0%bd%d0%be%d0%b2%d0%bb%d0%b5%d0%bd%d0%b8%d1%8f-%d0%bc%d0%b8%d0%ba%d1%80%d0%be%d0%ba%d0%be%d0%b4%d0%b0-cpu">Установка сервиса обновления микрокода CPU</a>
</h3><ol>
<li>Установить пакет.</li>
<li>Добавить в <code>rc.conf</code> автозапуск сервиса.</li>
<li>Запустить сервис.</li>
</ol>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-4
shortcode-codeblock-bash">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-3564ac87525fbfe16f071d368edb6e03" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">pkg install cpu-microcode <span class="o">&amp;&amp;</span> sysrc <span class="nv">microcode_update_enable</span><span class="o">=</span>YES <span class="o">&amp;&amp;</span> service microcode_update start</span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-3564ac87525fbfe16f071d368edb6e03"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<h3 id="установка-дополнительных-пакетов">
  <a class="link-body-emphasis" href="#%d1%83%d1%81%d1%82%d0%b0%d0%bd%d0%be%d0%b2%d0%ba%d0%b0-%d0%b4%d0%be%d0%bf%d0%be%d0%bb%d0%bd%d0%b8%d1%82%d0%b5%d0%bb%d1%8c%d0%bd%d1%8b%d1%85-%d0%bf%d0%b0%d0%ba%d0%b5%d1%82%d0%be%d0%b2">Установка дополнительных пакетов</a>
</h3><p>Для работы на сервере, я устанавливаю следующие пакеты:</p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-5
shortcode-codeblock-bash">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-718ee8d48aad38dff203539b2feae6bc" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">pkg install bash ca_root_nss curl git gnupg htop mc nano smartmontools wget zsh</span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-718ee8d48aad38dff203539b2feae6bc"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<h2 id="настройка-ядра">
  <a class="link-body-emphasis" href="#%d0%bd%d0%b0%d1%81%d1%82%d1%80%d0%be%d0%b9%d0%ba%d0%b0-%d1%8f%d0%b4%d1%80%d0%b0">Настройка ядра</a>
</h2><h3 id="увеличение-числа-дескрипторов-файлов">
  <a class="link-body-emphasis" href="#%d1%83%d0%b2%d0%b5%d0%bb%d0%b8%d1%87%d0%b5%d0%bd%d0%b8%d0%b5-%d1%87%d0%b8%d1%81%d0%bb%d0%b0-%d0%b4%d0%b5%d1%81%d0%ba%d1%80%d0%b8%d0%bf%d1%82%d0%be%d1%80%d0%be%d0%b2-%d1%84%d0%b0%d0%b9%d0%bb%d0%be%d0%b2">Увеличение числа дескрипторов файлов</a>
</h3><p>У меня используется синхронизация данных при помощи <span class="shortcode shortcode-tag"><a href="/ru/tags/syncthing/" target="_blank">#Syncthing</a></span>, данных много. Иногда случается ступор из-за лимита на дескрипторы файлов. Открываем <code>/etc/sysctl.conf</code>, добавляем:</p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-6
shortcode-codeblock-ini">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-066cacdcc4ec1c88f5c38bfb64581c46" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-ini" data-lang="ini"><span class="line"><span class="cl"><span class="na">kern.maxfiles</span><span class="o">=</span><span class="s">500000</span>
</span></span><span class="line"><span class="cl"><span class="na">kern.maxfilesperproc</span><span class="o">=</span><span class="s">500000</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-066cacdcc4ec1c88f5c38bfb64581c46"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<p>Перезагружаем систему:</p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-7
shortcode-codeblock-bash">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-0d6cfefd2ca61f8f2f65c002ffa58c6e" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">shutdown -r now</span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-0d6cfefd2ca61f8f2f65c002ffa58c6e"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<h2 id="настройка-терминала">
  <a class="link-body-emphasis" href="#%d0%bd%d0%b0%d1%81%d1%82%d1%80%d0%be%d0%b9%d0%ba%d0%b0-%d1%82%d0%b5%d1%80%d0%bc%d0%b8%d0%bd%d0%b0%d0%bb%d0%b0">Настройка терминала</a>
</h2><p>В своей работе я предпочитаю <span class="shortcode shortcode-tag"><a href="/ru/tags/zsh/" target="_blank">#Zsh</a></span>.</p>
<h3 id="установка-zsh-для-пользователей">
  <a class="link-body-emphasis" href="#%d1%83%d1%81%d1%82%d0%b0%d0%bd%d0%be%d0%b2%d0%ba%d0%b0-zsh-%d0%b4%d0%bb%d1%8f-%d0%bf%d0%be%d0%bb%d1%8c%d0%b7%d0%be%d0%b2%d0%b0%d1%82%d0%b5%d0%bb%d0%b5%d0%b9">Установка Zsh для пользователей</a>
</h3><ol>
<li>Изменить стандартную оболочку на <span class="shortcode shortcode-tag"><a href="/ru/tags/zsh/" target="_blank">#Zsh</a></span> для <strong>root</strong>:</li>
</ol>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-8
shortcode-codeblock-bash">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-07e54096db10b9cb7ecbe0a39036d7f4" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">chsh -s zsh root</span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-07e54096db10b9cb7ecbe0a39036d7f4"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<ol start="2">
<li>Изменить стандартную оболочку на <span class="shortcode shortcode-tag"><a href="/ru/tags/zsh/" target="_blank">#Zsh</a></span> для <strong>обычного пользователя</strong>:</li>
</ol>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-9
shortcode-codeblock-bash">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-1f400ea2f07a6d58cc655940fa5357f8" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">chsh -s zsh user</span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-1f400ea2f07a6d58cc655940fa5357f8"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<p>Где:</p>
<ul>
<li><code>user</code> - логин пользователя.</li>
</ul>
<h3 id="конфигурация-zsh">
  <a class="link-body-emphasis" href="#%d0%ba%d0%be%d0%bd%d1%84%d0%b8%d0%b3%d1%83%d1%80%d0%b0%d1%86%d0%b8%d1%8f-zsh">Конфигурация Zsh</a>
</h3><p>Использую конфигурацию от <span class="shortcode shortcode-tag">GRML</span>.</p>
<ol>
<li>Скачиваем конфигурацию:</li>
</ol>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-10
shortcode-codeblock-bash">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-7888f3327ac00e72bf6c1c9ea6e0ffcd" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">wget -O ~/.zshrc.grml https://git.grml.org/f/grml-etc-core/etc/zsh/zshrc</span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-7888f3327ac00e72bf6c1c9ea6e0ffcd"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<ol start="2">
<li>Открываем файл <code>~/.zshrc</code> и добавляем следующие строки:</li>
</ol>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-11
shortcode-codeblock-bash">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-bccc431be08bd0a445dadfc66f9d396a" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">. <span class="s2">&#34;</span><span class="si">${</span><span class="nv">HOME</span><span class="si">}</span><span class="s2">/.zshrc.grml&#34;</span>
</span></span><span class="line"><span class="cl"><span class="nb">export</span> <span class="nv">GPG_TTY</span><span class="o">=</span><span class="k">$(</span>tty<span class="k">)</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-bccc431be08bd0a445dadfc66f9d396a"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<p>Я работаю на ОС Windows и к серверам подключаюсь через <span class="shortcode shortcode-tag"><a href="/ru/tags/kitty/" target="_blank">#KiTTY</a></span>. При работе с <span class="shortcode shortcode-tag"><a href="/ru/tags/gpg/" target="_blank">#GPG</a></span>, она иногда не понимает куда ей выбрасывать запрос на парольную фразу. Поэтому, у меня здесь добавлен фикс <code>export GPG_TTY=$(tty)</code>.</p>
<h2 id="настройка-файловой-системы">
  <a class="link-body-emphasis" href="#%d0%bd%d0%b0%d1%81%d1%82%d1%80%d0%be%d0%b9%d0%ba%d0%b0-%d1%84%d0%b0%d0%b9%d0%bb%d0%be%d0%b2%d0%be%d0%b9-%d1%81%d0%b8%d1%81%d1%82%d0%b5%d0%bc%d1%8b">Настройка файловой системы</a>
</h2><h3 id="отключение-atime">
  <a class="link-body-emphasis" href="#%d0%be%d1%82%d0%ba%d0%bb%d1%8e%d1%87%d0%b5%d0%bd%d0%b8%d0%b5-atime">Отключение <code>atime</code></a>
</h3><p><code>atime</code> это время доступа к файлу. В обычной работе такая метрика бесполезна. На диск могут быть тысячи файлов и для каждого файла ядро ОС будет фиксировать и обновлять время доступа. Подобная операция весьма дорогая.</p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-12
shortcode-codeblock-bash">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-b136b18077142ca16ee5f223708b76e0" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">zfs <span class="nb">set</span> <span class="nv">atime</span><span class="o">=</span>off zroot</span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-b136b18077142ca16ee5f223708b76e0"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<p>Где:</p>
<ul>
<li><code>zroot</code> - пул файловой системы <span class="shortcode shortcode-tag"><a href="/ru/tags/zfs/" target="_blank">#ZFS</a></span>.</li>
</ul>]]></turbo:content></item><item turbo="true"><title>MikroTik: Настройка DoH</title><link>https://lib.onl/ru/2023/12/b6c7c5cd-1b0d-5fcd-8dd2-f28f87a5064c/</link><pubDate>Wed, 27 Dec 2023 08:07:16 +0000</pubDate><dc:creator>Kai Kimera</dc:creator><category>Сеть</category><category>Безопасность</category><yandex:related><link url="https://lib.onl/ru/2023/10/cc13623b-970c-5950-867e-168f9ba9025a/">MikroTik: Добавление корневых сертификатов в RouterOS</link><link url="https://lib.onl/ru/2020/07/ff2ae66e-8e14-5c4a-baa6-0cd2e59f6517/">MikroTik и CloudFlare: Динамический IP для домена</link></yandex:related><turbo:extendedHtml>true</turbo:extendedHtml><turbo:source>https://lib.onl/ru/2023/12/b6c7c5cd-1b0d-5fcd-8dd2-f28f87a5064c/</turbo:source><turbo:topic>MikroTik: Настройка DoH</turbo:topic><turbo:content><![CDATA[<p>Небольшая заметка по настройке DNS over HTTPS (<span class="shortcode shortcode-tag"><a href="/ru/tags/doh/" target="_blank">#DoH</a></span>) на <span class="shortcode shortcode-tag"><a href="/ru/tags/mikrotik/" target="_blank">#MikroTik</a></span>.</p>
<h2 id="установка-набора-сертификатов">
  <a class="link-body-emphasis" href="#%d1%83%d1%81%d1%82%d0%b0%d0%bd%d0%be%d0%b2%d0%ba%d0%b0-%d0%bd%d0%b0%d0%b1%d0%be%d1%80%d0%b0-%d1%81%d0%b5%d1%80%d1%82%d0%b8%d1%84%d0%b8%d0%ba%d0%b0%d1%82%d0%be%d0%b2">Установка набора сертификатов</a>
</h2><p>Для работы DoH необходимо наличие сертификатов в базе MikroTik. Пакет сертификатов я беру с сайта <code>curl.se</code>:</p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-0
shortcode-codeblock-text">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-6e274061407012fff73cc4576a6d3a08" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-text" data-lang="text"><span class="line"><span class="cl">/tool fetch url=&#34;https://curl.se/ca/cacert.pem&#34; dst-path=&#34;ros.cacert.pem&#34;</span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-6e274061407012fff73cc4576a6d3a08"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<p>Импортируем сертификаты:</p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-1
shortcode-codeblock-text">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-3112ee0a9ce83ac4ce106eb769ba0dba" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-text" data-lang="text"><span class="line"><span class="cl">/certificate import file-name=&#34;ros.cacert.pem&#34; passphrase=&#34;&#34; name=&#34;CA&#34;</span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-3112ee0a9ce83ac4ce106eb769ba0dba"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<h2 id="настройка-doh">
  <a class="link-body-emphasis" href="#%d0%bd%d0%b0%d1%81%d1%82%d1%80%d0%be%d0%b9%d0%ba%d0%b0-doh">Настройка DoH</a>
</h2><p>После установки сертификатов, приступаем к настройке DoH.</p>
<h3 id="стандартные-dns">
  <a class="link-body-emphasis" href="#%d1%81%d1%82%d0%b0%d0%bd%d0%b4%d0%b0%d1%80%d1%82%d0%bd%d1%8b%d0%b5-dns">Стандартные DNS</a>
</h3>








  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-2
shortcode-codeblock-text">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-2500e33ae85f70cd5bf83bfe87fcf09c" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-text" data-lang="text"><span class="line"><span class="cl">/ip dns set allow-remote-requests=yes servers=1.1.1.1,1.0.0.1 use-doh-server=&#34;https://cloudflare-dns.com/dns-query&#34; verify-doh-cert=yes</span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-2500e33ae85f70cd5bf83bfe87fcf09c"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<p>В этой команде присутствуют следующие параметры:</p>
<ul>
<li>DNS 01: <code>1.1.1.1</code>.</li>
<li>DNS 02: <code>1.0.0.1</code>.</li>
<li>Сервер DoH: <code>https://cloudflare-dns.com/dns-query</code>.</li>
</ul>
<h3 id="dns-с-блокировкой-вредоносного-по">
  <a class="link-body-emphasis" href="#dns-%d1%81-%d0%b1%d0%bb%d0%be%d0%ba%d0%b8%d1%80%d0%be%d0%b2%d0%ba%d0%be%d0%b9-%d0%b2%d1%80%d0%b5%d0%b4%d0%be%d0%bd%d0%be%d1%81%d0%bd%d0%be%d0%b3%d0%be-%d0%bf%d0%be">DNS с блокировкой вредоносного ПО</a>
</h3>








  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-3
shortcode-codeblock-text">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-b618316285be620983ab99ba9756780f" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-text" data-lang="text"><span class="line"><span class="cl">/ip dns set allow-remote-requests=yes servers=1.1.1.2,1.0.0.2 use-doh-server=&#34;https://security.cloudflare-dns.com/dns-query&#34; verify-doh-cert=yes</span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-b618316285be620983ab99ba9756780f"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<p>В этой команде присутствуют следующие параметры:</p>
<ul>
<li>DNS 01: <code>1.1.1.2</code>.</li>
<li>DNS 02: <code>1.0.0.2</code>.</li>
<li>Сервер DoH: <code>https://security.cloudflare-dns.com/dns-query</code>.</li>
</ul>
<h3 id="dns-с-блокировкой-вредоносного-по-и-контента-для-взрослых">
  <a class="link-body-emphasis" href="#dns-%d1%81-%d0%b1%d0%bb%d0%be%d0%ba%d0%b8%d1%80%d0%be%d0%b2%d0%ba%d0%be%d0%b9-%d0%b2%d1%80%d0%b5%d0%b4%d0%be%d0%bd%d0%be%d1%81%d0%bd%d0%be%d0%b3%d0%be-%d0%bf%d0%be-%d0%b8-%d0%ba%d0%be%d0%bd%d1%82%d0%b5%d0%bd%d1%82%d0%b0-%d0%b4%d0%bb%d1%8f-%d0%b2%d0%b7%d1%80%d0%be%d1%81%d0%bb%d1%8b%d1%85">DNS с блокировкой вредоносного ПО и контента для взрослых</a>
</h3>








  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-4
shortcode-codeblock-text">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-71a630f54e949d29b6b5d85e97f6acaf" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-text" data-lang="text"><span class="line"><span class="cl">/ip dns set allow-remote-requests=yes servers=1.1.1.3,1.0.0.3 use-doh-server=&#34;https://family.cloudflare-dns.com/dns-query&#34; verify-doh-cert=yes</span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-71a630f54e949d29b6b5d85e97f6acaf"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<p>В этой команде присутствуют следующие параметры:</p>
<ul>
<li>DNS 01: <code>1.1.1.3</code>.</li>
<li>DNS 02: <code>1.0.0.3</code>.</li>
<li>Сервер DoH: <code>https://family.cloudflare-dns.com/dns-query</code>.</li>
</ul>]]></turbo:content></item><item turbo="true"><title>MikroTik: Базовая настройка</title><link>https://lib.onl/ru/2023/12/0f3478b3-9fde-59aa-a424-ff160431fa35/</link><pubDate>Wed, 20 Dec 2023 06:53:34 +0000</pubDate><dc:creator>Kai Kimera</dc:creator><category>Сеть</category><category>Скрипты</category><category>В доработке</category><yandex:related><link url="https://lib.onl/ru/2023/10/cc13623b-970c-5950-867e-168f9ba9025a/">MikroTik: Добавление корневых сертификатов в RouterOS</link><link url="https://lib.onl/ru/2024/04/326618af-d950-5001-8114-57c66bb8a5af/">MikroTik: Туннель GRE/IPsec (Site-to-Site)</link><link url="https://lib.onl/ru/2024/04/146e83d5-f571-5273-9a29-172bf5dc10fe/">MikroTik: Туннель WireGuard (Site-to-Site) + OSPF</link><link url="https://lib.onl/ru/2024/03/54a2b39f-38b4-5f0c-9b54-310f853da38f/">MikroTik: Туннель IPsec (Site-to-Site)</link><link url="https://lib.onl/ru/2020/07/ff2ae66e-8e14-5c4a-baa6-0cd2e59f6517/">MikroTik и CloudFlare: Динамический IP для домена</link><link url="https://lib.onl/ru/2023/12/b6c7c5cd-1b0d-5fcd-8dd2-f28f87a5064c/">MikroTik: Настройка DoH</link></yandex:related><turbo:extendedHtml>true</turbo:extendedHtml><turbo:source>https://lib.onl/ru/2023/12/0f3478b3-9fde-59aa-a424-ff160431fa35/</turbo:source><turbo:topic>MikroTik: Базовая настройка</turbo:topic><turbo:content><![CDATA[<p>После покупки <span class="shortcode shortcode-tag"><a href="/ru/tags/mikrotik/" target="_blank">#MikroTik</a></span> советуют обнулить все его настройки и начать конфигурацию с чистого листа.</p>
<p>Я написал небольший скрип для автоматизации действий по базовой настройки маршрутизатора. В скрипте есть параметры, которые необходимо предварительно настроить под себя.</p>
<h2 id="настройка-основного-роутера">
  <a class="link-body-emphasis" href="#%d0%bd%d0%b0%d1%81%d1%82%d1%80%d0%be%d0%b9%d0%ba%d0%b0-%d0%be%d1%81%d0%bd%d0%be%d0%b2%d0%bd%d0%be%d0%b3%d0%be-%d1%80%d0%be%d1%83%d1%82%d0%b5%d1%80%d0%b0">Настройка основного роутера</a>
</h2><ul>
<li>Загрузить скрипт в память <span class="shortcode shortcode-tag"><a href="/ru/tags/mikrotik/" target="_blank">#MikroTik</a></span>, предварительно настроив параметры скрипта под себя.</li>
<li>Зайти в <strong>Terminal</strong> и выполнить следующую команду:</li>
</ul>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-0
shortcode-codeblock-text">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-39c0e46deb68e6f2899616f560c820e4" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-text" data-lang="text"><span class="line"><span class="cl">/system reset-configuration no-defaults=yes skip-backup=yes run-after-reset=&#34;ros.router.rsc&#34;</span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-39c0e46deb68e6f2899616f560c820e4"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<h3 id="параметры-конфигурации">
  <a class="link-body-emphasis" href="#%d0%bf%d0%b0%d1%80%d0%b0%d0%bc%d0%b5%d1%82%d1%80%d1%8b-%d0%ba%d0%be%d0%bd%d1%84%d0%b8%d0%b3%d1%83%d1%80%d0%b0%d1%86%d0%b8%d0%b8">Параметры конфигурации</a>
</h3><ul>
<li>Пароль администратора: <code>PassWord</code>.</li>
<li>Мост:
<ul>
<li>Имя: <code>bridge1</code>.</li>
<li>Порты: <code>2-5</code>.</li>
</ul>
</li>
<li>Шлюз:
<ul>
<li>Название: <code>GW1</code>.</li>
<li>IP: <code>10.1.0.1</code>.</li>
<li>Домен: <code>gw1.lan</code>.</li>
</ul>
</li>
<li>Подсеть:
<ul>
<li>Маска: <code>10.1.0.0/16</code>.</li>
<li>Домен: <code>home.lan</code>.</li>
<li>Адресация DHCP: <code>10.1.200.1-10.1.200.254</code>.</li>
</ul>
</li>
<li>Порты:
<ul>
<li>SSH: <code>22022</code>.</li>
<li>Winbox: <code>9090</code>.</li>
</ul>
</li>
</ul>
<h3 id="скрипт-конфигурации">
  <a class="link-body-emphasis" href="#%d1%81%d0%ba%d1%80%d0%b8%d0%bf%d1%82-%d0%ba%d0%be%d0%bd%d1%84%d0%b8%d0%b3%d1%83%d1%80%d0%b0%d1%86%d0%b8%d0%b8">Скрипт конфигурации</a>
</h3>
    

    
        
            
            <div class="shortcode shortcode-file mb-3">
              <div class="card overflow-hidden" data-bs-theme="dark">
                <div class="card-header">
                  <div class="d-flex align-items-center">
                    <div class="flex-shrink-0">
                      <i class="far fa-file-code fa-fw"></i>
                    </div>
                    <div class="flex-grow-1 mx-2 text-truncate">
                      <code>mt.router.rsc</code>
                    </div>
                    <div class="flex-shrink-0">
                      <ul class="list-inline mb-0">
                        <li class="list-inline-item" title='Копировать'>
                          <a class="text-body" href="#"
                             data-fn="clipboard" data-clipboard-target="#cp-020627e6cf93e0aa1e54d4ea77b1bc05"
                             role="button" aria-label='Копировать'>
                            <i class="fas fa-copy fa-fw"></i>
                          </a>
                        </li>
                        <li class="list-inline-item" title='Скачать'>
                          <a class="text-body" href="/ru/2023/12/0f3478b3-9fde-59aa-a424-ff160431fa35/mt.router.rsc" download
                             role="button" aria-label='Скачать'>
                            <i class="fas fa-download fa-fw"></i>
                          </a>
                        </li>
                        <li class="list-inline-item" title='Открыть'>
                          <a class="text-body" href="/ru/2023/12/0f3478b3-9fde-59aa-a424-ff160431fa35/mt.router.rsc" target="_blank"
                             role="button" aria-label='Открыть'>
                            <i class="fas fa-arrow-up-right-from-square fa-fw"></i>
                          </a>
                        </li>
                      </ul>
                    </div>
                  </div>
                </div>
                <div class="card-body p-0 overflow-auto" id="cp-020627e6cf93e0aa1e54d4ea77b1bc05">
                    
                    <div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">  1
</span><span class="lnt">  2
</span><span class="lnt">  3
</span><span class="lnt">  4
</span><span class="lnt">  5
</span><span class="lnt">  6
</span><span class="lnt">  7
</span><span class="lnt">  8
</span><span class="lnt">  9
</span><span class="lnt"> 10
</span><span class="lnt"> 11
</span><span class="lnt"> 12
</span><span class="lnt"> 13
</span><span class="lnt"> 14
</span><span class="lnt"> 15
</span><span class="lnt"> 16
</span><span class="lnt"> 17
</span><span class="lnt"> 18
</span><span class="lnt"> 19
</span><span class="lnt"> 20
</span><span class="lnt"> 21
</span><span class="lnt"> 22
</span><span class="lnt"> 23
</span><span class="lnt"> 24
</span><span class="lnt"> 25
</span><span class="lnt"> 26
</span><span class="lnt"> 27
</span><span class="lnt"> 28
</span><span class="lnt"> 29
</span><span class="lnt"> 30
</span><span class="lnt"> 31
</span><span class="lnt"> 32
</span><span class="lnt"> 33
</span><span class="lnt"> 34
</span><span class="lnt"> 35
</span><span class="lnt"> 36
</span><span class="lnt"> 37
</span><span class="lnt"> 38
</span><span class="lnt"> 39
</span><span class="lnt"> 40
</span><span class="lnt"> 41
</span><span class="lnt"> 42
</span><span class="lnt"> 43
</span><span class="lnt"> 44
</span><span class="lnt"> 45
</span><span class="lnt"> 46
</span><span class="lnt"> 47
</span><span class="lnt"> 48
</span><span class="lnt"> 49
</span><span class="lnt"> 50
</span><span class="lnt"> 51
</span><span class="lnt"> 52
</span><span class="lnt"> 53
</span><span class="lnt"> 54
</span><span class="lnt"> 55
</span><span class="lnt"> 56
</span><span class="lnt"> 57
</span><span class="lnt"> 58
</span><span class="lnt"> 59
</span><span class="lnt"> 60
</span><span class="lnt"> 61
</span><span class="lnt"> 62
</span><span class="lnt"> 63
</span><span class="lnt"> 64
</span><span class="lnt"> 65
</span><span class="lnt"> 66
</span><span class="lnt"> 67
</span><span class="lnt"> 68
</span><span class="lnt"> 69
</span><span class="lnt"> 70
</span><span class="lnt"> 71
</span><span class="lnt"> 72
</span><span class="lnt"> 73
</span><span class="lnt"> 74
</span><span class="lnt"> 75
</span><span class="lnt"> 76
</span><span class="lnt"> 77
</span><span class="lnt"> 78
</span><span class="lnt"> 79
</span><span class="lnt"> 80
</span><span class="lnt"> 81
</span><span class="lnt"> 82
</span><span class="lnt"> 83
</span><span class="lnt"> 84
</span><span class="lnt"> 85
</span><span class="lnt"> 86
</span><span class="lnt"> 87
</span><span class="lnt"> 88
</span><span class="lnt"> 89
</span><span class="lnt"> 90
</span><span class="lnt"> 91
</span><span class="lnt"> 92
</span><span class="lnt"> 93
</span><span class="lnt"> 94
</span><span class="lnt"> 95
</span><span class="lnt"> 96
</span><span class="lnt"> 97
</span><span class="lnt"> 98
</span><span class="lnt"> 99
</span><span class="lnt">100
</span><span class="lnt">101
</span><span class="lnt">102
</span><span class="lnt">103
</span><span class="lnt">104
</span><span class="lnt">105
</span><span class="lnt">106
</span><span class="lnt">107
</span><span class="lnt">108
</span><span class="lnt">109
</span><span class="lnt">110
</span><span class="lnt">111
</span><span class="lnt">112
</span><span class="lnt">113
</span><span class="lnt">114
</span><span class="lnt">115
</span><span class="lnt">116
</span><span class="lnt">117
</span><span class="lnt">118
</span><span class="lnt">119
</span><span class="lnt">120
</span><span class="lnt">121
</span><span class="lnt">122
</span><span class="lnt">123
</span><span class="lnt">124
</span><span class="lnt">125
</span><span class="lnt">126
</span><span class="lnt">127
</span><span class="lnt">128
</span><span class="lnt">129
</span><span class="lnt">130
</span><span class="lnt">131
</span><span class="lnt">132
</span><span class="lnt">133
</span><span class="lnt">134
</span><span class="lnt">135
</span><span class="lnt">136
</span><span class="lnt">137
</span><span class="lnt">138
</span><span class="lnt">139
</span><span class="lnt">140
</span><span class="lnt">141
</span><span class="lnt">142
</span><span class="lnt">143
</span><span class="lnt">144
</span><span class="lnt">145
</span><span class="lnt">146
</span><span class="lnt">147
</span><span class="lnt">148
</span><span class="lnt">149
</span><span class="lnt">150
</span><span class="lnt">151
</span><span class="lnt">152
</span><span class="lnt">153
</span><span class="lnt">154
</span><span class="lnt">155
</span><span class="lnt">156
</span><span class="lnt">157
</span><span class="lnt">158
</span><span class="lnt">159
</span><span class="lnt">160
</span><span class="lnt">161
</span><span class="lnt">162
</span><span class="lnt">163
</span><span class="lnt">164
</span><span class="lnt">165
</span><span class="lnt">166
</span><span class="lnt">167
</span><span class="lnt">168
</span><span class="lnt">169
</span><span class="lnt">170
</span><span class="lnt">171
</span><span class="lnt">172
</span><span class="lnt">173
</span><span class="lnt">174
</span><span class="lnt">175
</span><span class="lnt">176
</span><span class="lnt">177
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-text" data-lang="text"><span class="line"><span class="cl"># @package    MikroTik / RouterOS
</span></span><span class="line"><span class="cl"># @author     Kai Kimera &lt;mail@kai.kim&gt;
</span></span><span class="line"><span class="cl"># @copyright  2023 Library Online
</span></span><span class="line"><span class="cl"># @license    MIT
</span></span><span class="line"><span class="cl"># @version    0.1.0
</span></span><span class="line"><span class="cl"># @link       https://lib.onl/ru/2023/12/0f3478b3-9fde-59aa-a424-ff160431fa35/
</span></span><span class="line"><span class="cl"># -------------------------------------------------------------------------------------------------------------------- #
</span></span><span class="line"><span class="cl"># Set MAC:
</span></span><span class="line"><span class="cl"># /interface ethernet set [find default-name=&#34;ether1&#34;] mac-address=&#34;00:00:00:00:00:00&#34;
</span></span><span class="line"><span class="cl"># -------------------------------------------------------------------------------------------------------------------- #
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"># Administrator password.
</span></span><span class="line"><span class="cl">:local rosAdminPassword &#34;PassWord&#34;
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"># Bridge.
</span></span><span class="line"><span class="cl">:local rosBridgeName &#34;bridge1&#34;
</span></span><span class="line"><span class="cl">:local rosBridgeMinPort 2
</span></span><span class="line"><span class="cl">:local rosBridgeMaxPort 5
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"># Router name.
</span></span><span class="line"><span class="cl">:local rosRouterName &#34;GW1&#34;
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"># Static gateway name.
</span></span><span class="line"><span class="cl">:local rosGwDomain &#34;gw1.lan&#34;
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"># Network domain name.
</span></span><span class="line"><span class="cl">:local rosNwDomain &#34;home.lan&#34;
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"># Port knocking.
</span></span><span class="line"><span class="cl">:local rosIcmpKnockSize 100
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"># -------------------------------------------------------------------------------------------------------------------- #
</span></span><span class="line"><span class="cl"># -----------------------------------------------------&lt; SCRIPT &gt;----------------------------------------------------- #
</span></span><span class="line"><span class="cl"># -------------------------------------------------------------------------------------------------------------------- #
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">/interface bridge
</span></span><span class="line"><span class="cl">add name=$rosBridgeName
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">/interface list
</span></span><span class="line"><span class="cl">add name=WAN
</span></span><span class="line"><span class="cl">add name=LAN
</span></span><span class="line"><span class="cl">add name=GRE
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">/interface bridge port
</span></span><span class="line"><span class="cl">:for i from=$rosBridgeMinPort to=$rosBridgeMaxPort do={
</span></span><span class="line"><span class="cl">  add bridge=$rosBridgeName interface=(&#34;ether&#34; . $i)
</span></span><span class="line"><span class="cl">}
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">/interface list member
</span></span><span class="line"><span class="cl">add interface=ether1 list=WAN
</span></span><span class="line"><span class="cl">add interface=$rosBridgeName list=LAN
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">/ipv6 settings
</span></span><span class="line"><span class="cl">set disable-ipv6=yes
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">/ip ipsec profile
</span></span><span class="line"><span class="cl">set [find default=yes] dh-group=ecp384 enc-algorithm=aes-256 hash-algorithm=sha256
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">/ip ipsec proposal
</span></span><span class="line"><span class="cl">set [find default=yes] auth-algorithms=sha256 enc-algorithms=aes-256-cbc pfs-group=ecp384
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">/ip pool
</span></span><span class="line"><span class="cl">add name=dhcp ranges=10.1.200.1-10.1.200.254
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">/ip dhcp-server
</span></span><span class="line"><span class="cl">add address-pool=dhcp interface=$rosBridgeName name=dhcp1
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">/ip neighbor discovery-settings
</span></span><span class="line"><span class="cl">set discover-interface-list=LAN
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">/ip address
</span></span><span class="line"><span class="cl">add address=10.1.0.1/16 interface=$rosBridgeName network=10.1.0.0
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">/ip dhcp-client
</span></span><span class="line"><span class="cl">add interface=ether1
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">/ip dhcp-server lease
</span></span><span class="line"><span class="cl"># add address=10.1.0.40 mac-address=00:00:00:00:00:00 comment=&#34;SERVER01&#34;
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">/ip dhcp-server network
</span></span><span class="line"><span class="cl">add address=10.1.0.0/16 dns-server=10.1.0.1 domain=$rosNwDomain gateway=10.1.0.1 ntp-server=10.1.0.1
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">/ip dns
</span></span><span class="line"><span class="cl">set allow-remote-requests=yes servers=1.1.1.1,8.8.8.8,77.88.8.8
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">/ip dns static
</span></span><span class="line"><span class="cl">add address=10.1.0.1 name=$rosGwDomain
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">/ip firewall filter
</span></span><span class="line"><span class="cl">add action=accept chain=input connection-state=established,related,untracked \
</span></span><span class="line"><span class="cl">  comment=&#34;[ROS] Established, Related, Untracked&#34;
</span></span><span class="line"><span class="cl">add action=drop chain=input connection-state=invalid \
</span></span><span class="line"><span class="cl">  comment=&#34;[ROS] Invalid&#34;
</span></span><span class="line"><span class="cl">add action=add-src-to-address-list address-list=&#34;AdminCP&#34; address-list-timeout=30m chain=input in-interface-list=WAN \
</span></span><span class="line"><span class="cl">  packet-size=($rosIcmpKnockSize + 28) protocol=icmp \
</span></span><span class="line"><span class="cl">  comment=&#34;[ROS] ICMP port knocking for AdminCP&#34;
</span></span><span class="line"><span class="cl">add action=accept chain=input protocol=icmp \
</span></span><span class="line"><span class="cl">  comment=&#34;[ROS] ICMP&#34;
</span></span><span class="line"><span class="cl">add action=accept chain=input in-interface-list=GRE protocol=ospf disabled=yes \
</span></span><span class="line"><span class="cl">  comment=&#34;[ROS] OSPF&#34;
</span></span><span class="line"><span class="cl">add action=accept chain=input dst-port=53 in-interface-list=GRE protocol=udp disabled=yes \
</span></span><span class="line"><span class="cl">  comment=&#34;[ROS] DNS&#34;
</span></span><span class="line"><span class="cl">add action=accept chain=input dst-port=9090,22022 protocol=tcp src-address-list=&#34;AdminCP&#34; \
</span></span><span class="line"><span class="cl">  comment=&#34;[ROS] WinBox and SSH&#34;
</span></span><span class="line"><span class="cl">add action=accept chain=input dst-port=9090,22022 in-interface-list=GRE protocol=tcp disabled=yes \
</span></span><span class="line"><span class="cl">  comment=&#34;[ROS] WinBox and SSH&#34;
</span></span><span class="line"><span class="cl">add action=drop chain=input in-interface-list=!LAN \
</span></span><span class="line"><span class="cl">  comment=&#34;[ROS] All not coming from LAN&#34;
</span></span><span class="line"><span class="cl">add action=accept chain=forward ipsec-policy=in,ipsec disabled=yes \
</span></span><span class="line"><span class="cl">  comment=&#34;[ROS] In IPsec policy&#34;
</span></span><span class="line"><span class="cl">add action=accept chain=forward ipsec-policy=out,ipsec disabled=yes \
</span></span><span class="line"><span class="cl">  comment=&#34;[ROS] Out IPsec policy&#34;
</span></span><span class="line"><span class="cl">add action=fasttrack-connection chain=forward connection-state=established,related \
</span></span><span class="line"><span class="cl">  comment=&#34;[ROS] FastTrack&#34;
</span></span><span class="line"><span class="cl">add action=accept chain=forward connection-state=established,related,untracked \
</span></span><span class="line"><span class="cl">  comment=&#34;[ROS] FastTrack&#34;
</span></span><span class="line"><span class="cl">add action=drop chain=forward connection-state=invalid \
</span></span><span class="line"><span class="cl">  comment=&#34;[ROS] Invalid&#34;
</span></span><span class="line"><span class="cl">add action=drop chain=forward connection-nat-state=!dstnat connection-state=new in-interface-list=WAN \
</span></span><span class="line"><span class="cl">  comment=&#34;[ROS] All from WAN not DSTNATed&#34;
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">/ip firewall nat
</span></span><span class="line"><span class="cl">add action=masquerade chain=srcnat ipsec-policy=out,none out-interface-list=WAN \
</span></span><span class="line"><span class="cl">  comment=&#34;[ROS] Masquerade&#34;
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">/ip service
</span></span><span class="line"><span class="cl">set telnet disabled=yes
</span></span><span class="line"><span class="cl">set ftp disabled=yes
</span></span><span class="line"><span class="cl">set www disabled=yes
</span></span><span class="line"><span class="cl">set ssh port=22022
</span></span><span class="line"><span class="cl">set api disabled=yes
</span></span><span class="line"><span class="cl">set winbox port=9090
</span></span><span class="line"><span class="cl">set api-ssl disabled=yes
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">/system clock
</span></span><span class="line"><span class="cl">set time-zone-name=Europe/Moscow
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">/system identity
</span></span><span class="line"><span class="cl">set name=$rosRouterName
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">/system ntp client
</span></span><span class="line"><span class="cl">set enabled=yes
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">/system ntp server
</span></span><span class="line"><span class="cl">set enabled=yes manycast=yes multicast=yes
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">/system ntp client servers
</span></span><span class="line"><span class="cl">add address=&#34;0.ru.pool.ntp.org&#34;
</span></span><span class="line"><span class="cl">add address=&#34;1.ru.pool.ntp.org&#34;
</span></span><span class="line"><span class="cl">add address=&#34;time.google.com&#34;
</span></span><span class="line"><span class="cl">add address=&#34;time.cloudflare.com&#34;
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">/system routerboard settings
</span></span><span class="line"><span class="cl">set silent-boot=yes
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">/system watchdog
</span></span><span class="line"><span class="cl">set automatic-supout=no
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">/tool bandwidth-server
</span></span><span class="line"><span class="cl">set enabled=no
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">/tool mac-server
</span></span><span class="line"><span class="cl">set allowed-interface-list=none
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">/tool mac-server ping
</span></span><span class="line"><span class="cl">set enabled=no
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">/user
</span></span><span class="line"><span class="cl">set [find name=&#34;admin&#34;] password=&#34;$rosAdminPassword&#34;
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"># -------------------------------------------------------------------------------------------------------------------- #
</span></span><span class="line"><span class="cl"># Router ID.
</span></span><span class="line"><span class="cl"># -------------------------------------------------------------------------------------------------------------------- #
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">/routing id
</span></span><span class="line"><span class="cl">add id=10.1.0.1 name=lo select-dynamic-id=only-loopback \
</span></span><span class="line"><span class="cl">  comment=&#34;[ROS] Router ID (Loopback)&#34;</span></span></code></pre></td></tr></table>
</div>
</div>
                </div>
              </div>
            </div>]]></turbo:content></item><item turbo="true"><title>Переход Debian между релизами</title><link>https://lib.onl/ru/2023/11/4dfa15a8-44f0-5590-a04d-f940dac12aad/</link><pubDate>Sat, 25 Nov 2023 18:31:16 +0000</pubDate><dc:creator>Kai Kimera</dc:creator><category>Linux</category><category>Терминал</category><yandex:related><link url="https://lib.onl/ru/2023/10/6733cb51-62a0-5ed9-b421-8f08c4e0cb18/">Создание сертификатов при помощи OpenSSL</link><link url="https://lib.onl/ru/2023/10/75075788-9308-56b7-b531-2008cb35f7d0/">Установка сертификата НУЦ Минцифры</link><link url="https://lib.onl/ru/2022/01/06ef2fab-2ae2-5356-9154-7ca1e486d27d/">Установка ядра XanMod в Debian</link><link url="https://lib.onl/ru/2022/01/ddddd243-d182-5e26-a161-d2ea7812214a/">Установка Vivaldi в Debian</link><link url="https://lib.onl/ru/2021/09/581804b8-0613-52a8-a5c4-fdae90e7bc8a/">Чёрный экран с курсором при старте GDM</link><link url="https://lib.onl/ru/2021/09/1cf305cd-85d0-5e02-aabb-e01346bfee0f/">Proxmox VE: Установка на Debian 11 (Bullseye)</link><link url="https://lib.onl/ru/2021/09/ff829d15-4a19-52e3-a3aa-ad70aa38854a/">Debian: Wired Networks are Unmanaged</link><link url="https://lib.onl/ru/2021/09/b2caccc7-92bf-57ed-970f-136c546f18e2/">Распаковка пакетов DEB / RPM</link><link url="https://lib.onl/ru/2021/09/43b40b92-c29a-504b-87fa-5eac368dcf95/">Отключение установки дополнительных пакетов в Debian APT</link><link url="https://lib.onl/ru/2021/09/aeed7c90-003a-532a-b2c4-3807aaee88fa/">dhclient отправляет 36-значный идентификатор вместо MAC</link><link url="https://lib.onl/ru/2021/08/ca744dce-e607-52e6-9952-8ae04e052a5b/">Скрипт автоматического удаления устаревших файлов</link><link url="https://lib.onl/ru/2021/05/ee559a6c-5cde-5166-9d2d-3ceb55878eb8/">Debian: Статический IP-адрес</link></yandex:related><turbo:extendedHtml>true</turbo:extendedHtml><turbo:source>https://lib.onl/ru/2023/11/4dfa15a8-44f0-5590-a04d-f940dac12aad/</turbo:source><turbo:topic>Переход Debian между релизами</turbo:topic><turbo:content><![CDATA[<p><span class="shortcode shortcode-tag"><a href="/ru/tags/debian/" target="_blank">#Debian</a></span> позволяет выполнять обновление системы между релизами, и для успешного выполнения этого процесса, необходимо выполнять команды строго в определённом порядке.</p>
<h2 id="обновление-пакетов-в-текущей-системе">
  <a class="link-body-emphasis" href="#%d0%be%d0%b1%d0%bd%d0%be%d0%b2%d0%bb%d0%b5%d0%bd%d0%b8%d0%b5-%d0%bf%d0%b0%d0%ba%d0%b5%d1%82%d0%be%d0%b2-%d0%b2-%d1%82%d0%b5%d0%ba%d1%83%d1%89%d0%b5%d0%b9-%d1%81%d0%b8%d1%81%d1%82%d0%b5%d0%bc%d0%b5">Обновление пакетов в текущей системе</a>
</h2><p>Перед переходом на новый релиз, необходимо обновить все пакеты на текущей системе. Для этого выполняем последовательно ниже приведённые команды.</p>
<ol>
<li>Обновление базы пакетов, пакетов и системы в целом:</li>
</ol>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-0
shortcode-codeblock-bash">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-f67088293d146cf13939169868fed07d" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">apt update <span class="o">&amp;&amp;</span> apt upgrade <span class="o">&amp;&amp;</span> apt full-upgrade</span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-f67088293d146cf13939169868fed07d"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<ol start="2">
<li>Удаление не используемых пакетов:</li>
</ol>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-1
shortcode-codeblock-bash">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-6a076bb168a912f1b49d0764692bb116" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">apt --purge autoremove</span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-6a076bb168a912f1b49d0764692bb116"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<h2 id="обновление-файла-sourceslist">
  <a class="link-body-emphasis" href="#%d0%be%d0%b1%d0%bd%d0%be%d0%b2%d0%bb%d0%b5%d0%bd%d0%b8%d0%b5-%d1%84%d0%b0%d0%b9%d0%bb%d0%b0-sourceslist">Обновление файла <code>sources.list</code></a>
</h2><p>После завершения полного обновления пакетов, нужно перезаписать пути к репозиториям, указав имя нового релиза:</p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-2
shortcode-codeblock-bash">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-c9da4b4bdfd9b899f645fa74b39b9227" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">sed -i <span class="s1">&#39;s|RELEASE_OLD|RELEASE_NEW|g&#39;</span> <span class="s1">&#39;/etc/apt/sources.list&#39;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-c9da4b4bdfd9b899f645fa74b39b9227"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<p>Где:</p>
<ul>
<li><code>RELEASE_OLD</code> - старое имя релиза.</li>
<li><code>RELEASE_NEW</code> - новое имя релиза.</li>
</ul>
<h2 id="обновление-системны-на-новую-версию">
  <a class="link-body-emphasis" href="#%d0%be%d0%b1%d0%bd%d0%be%d0%b2%d0%bb%d0%b5%d0%bd%d0%b8%d0%b5-%d1%81%d0%b8%d1%81%d1%82%d0%b5%d0%bc%d0%bd%d1%8b-%d0%bd%d0%b0-%d0%bd%d0%be%d0%b2%d1%83%d1%8e-%d0%b2%d0%b5%d1%80%d1%81%d0%b8%d1%8e">Обновление системны на новую версию</a>
</h2><p>Теперь пришло время перейти на новый релиз. Выполняем шаги последовательно.</p>
<ol>
<li>Обновление базы пакетов и обновление пакетов в минимальном варианте:</li>
</ol>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-3
shortcode-codeblock-bash">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-6535586c86e83b8230a754d13d1ecb36" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">apt update <span class="o">&amp;&amp;</span> apt upgrade --without-new-pkgs</span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-6535586c86e83b8230a754d13d1ecb36"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<p>На запрос &ldquo;Restart services during package upgrades without asking?&rdquo; отвечаем <span class="shortcode shortcode-btn d-inline-block"><kbd class="bg-primary">Yes</kbd></span>.</p>
<ol start="2">
<li>Обновление всей системы:</li>
</ol>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-4
shortcode-codeblock-bash">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-a88018b9b837f11ac9c5aac99543ca92" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">apt full-upgrade</span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-a88018b9b837f11ac9c5aac99543ca92"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<ol start="3">
<li>Проверка обновлённого релиза:</li>
</ol>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-5
shortcode-codeblock-bash">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-32e122ccce309f3f4ec92ecddaca15c8" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">cat /etc/debian_version</span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-32e122ccce309f3f4ec92ecddaca15c8"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>]]></turbo:content></item><item turbo="true"><title>Как при помощи AWK разбить строку на поля?</title><link>https://lib.onl/ru/2023/11/632ccab2-18e6-550d-bd8e-0374dc9025f4/</link><pubDate>Sat, 04 Nov 2023 21:54:09 +0000</pubDate><dc:creator>Kai Kimera</dc:creator><category>Bash</category><category>Awk</category><turbo:extendedHtml>true</turbo:extendedHtml><turbo:source>https://lib.onl/ru/2023/11/632ccab2-18e6-550d-bd8e-0374dc9025f4/</turbo:source><turbo:topic>Как при помощи AWK разбить строку на поля?</turbo:topic><turbo:content>&lt;p>Нужно разделить строку в терминале на отдельные поля. Как для этого использовать AWK?&lt;/p></turbo:content></item><item turbo="true"><title>Как переименовать компьютер в PowerShell?</title><link>https://lib.onl/ru/2023/11/e153bb1d-7cea-5bd8-acce-2dbe63b26c91/</link><pubDate>Sat, 04 Nov 2023 06:06:25 +0000</pubDate><dc:creator>Kai Kimera</dc:creator><category>Powershell</category><yandex:related><link url="https://lib.onl/ru/2023/11/8c2e7adc-9431-5bb7-a9b6-e9397b1116b3/">Как переключить PowerShell в кодировку UTF-8?</link><link url="https://lib.onl/ru/2023/10/edf74517-3e6e-5e1c-aa6b-8ee0335670b4/">Многоточие в выводе PowerShell в табличном формате. Как исправить?</link></yandex:related><turbo:extendedHtml>true</turbo:extendedHtml><turbo:source>https://lib.onl/ru/2023/11/e153bb1d-7cea-5bd8-acce-2dbe63b26c91/</turbo:source><turbo:topic>Как переименовать компьютер в PowerShell?</turbo:topic><turbo:content>&lt;p>Хочу переименовать компьютер через терминал PowerShell. Как это сделать?&lt;/p></turbo:content></item><item turbo="true"><title>Как распаковать Intel SetupChipset.exe?</title><link>https://lib.onl/ru/2023/11/4531cb6d-5c3a-5b2d-8a53-6eccd8534dfa/</link><pubDate>Fri, 03 Nov 2023 14:48:08 +0000</pubDate><dc:creator>Kai Kimera</dc:creator><category>Intel</category><category>Chipset</category><category>Driver</category><category>Inf</category><turbo:extendedHtml>true</turbo:extendedHtml><turbo:source>https://lib.onl/ru/2023/11/4531cb6d-5c3a-5b2d-8a53-6eccd8534dfa/</turbo:source><turbo:topic>Как распаковать Intel SetupChipset.exe?</turbo:topic><turbo:content><![CDATA[<p>Нужно интегрировать драйверы чипсета Intel в дистрибутив ОС. Драйверы находятся в файле <code>SetupChipset.exe</code>. Как распаковать файл <code>SetupChipset.exe</code> для того, чтобы забрать драйверы чипсетов?</p>]]></turbo:content></item><item turbo="true"><title>Как переключить PowerShell в кодировку UTF-8?</title><link>https://lib.onl/ru/2023/11/8c2e7adc-9431-5bb7-a9b6-e9397b1116b3/</link><pubDate>Thu, 02 Nov 2023 20:50:36 +0000</pubDate><dc:creator>Kai Kimera</dc:creator><category>Powershell</category><yandex:related><link url="https://lib.onl/ru/2023/10/edf74517-3e6e-5e1c-aa6b-8ee0335670b4/">Многоточие в выводе PowerShell в табличном формате. Как исправить?</link></yandex:related><turbo:extendedHtml>true</turbo:extendedHtml><turbo:source>https://lib.onl/ru/2023/11/8c2e7adc-9431-5bb7-a9b6-e9397b1116b3/</turbo:source><turbo:topic>Как переключить PowerShell в кодировку UTF-8?</turbo:topic><turbo:content>&lt;p>Когда запускаю скрипт на PowerShell, кодировка ломается и вместо текста появляются нечитаемые символы. Это проблем кодировки, как включить поддержку символов UTF-8?&lt;/p></turbo:content></item><item turbo="true"><title>Многоточие в выводе PowerShell в табличном формате. Как исправить?</title><link>https://lib.onl/ru/2023/10/edf74517-3e6e-5e1c-aa6b-8ee0335670b4/</link><pubDate>Tue, 31 Oct 2023 19:52:35 +0000</pubDate><dc:creator>Kai Kimera</dc:creator><category>Powershell</category><turbo:extendedHtml>true</turbo:extendedHtml><turbo:source>https://lib.onl/ru/2023/10/edf74517-3e6e-5e1c-aa6b-8ee0335670b4/</turbo:source><turbo:topic>Многоточие в выводе PowerShell в табличном формате. Как исправить?</turbo:topic><turbo:content><![CDATA[<p>Когда PowerShell выводит информацию в табличном формате, некоторые строки не влезают в ширину столбца и происходит обрезание контента. Как сделать так, чтобы PowerShell подстраивал ширину столбца под размер контента?</p>











<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-0 shortcode-codeblock-terminal
shortcode-codeblock-terminal-windows
shortcode-codeblock-terminal-windows-user">
  <div class="card overflow-hidden" data-bs-theme="dark">
    <div class="card-header">
      <div class="d-flex align-items-center">
        <div class="flex-shrink-0 ">
          <i class="fas fa-terminal fa-fw"></i>
        </div>
        <div class="flex-grow-1 mx-2">
          <h5 class="mb-0">Терминал</h5>
        </div>
        <div class="flex-shrink-0">
          <ul class="list-inline mb-0">
            <li class="list-inline-item" title='Копировать'>
              <a class="text-body" href="#"
                 data-fn="clipboard" data-clipboard-target="#cp-53da231e3ffafa5e15fccd1fcc3569aa"
                 role="button" aria-label='Копировать'>
                <i class="fas fa-copy fa-fw"></i>
              </a>
            </li>
          </ul>
        </div>
      </div>
    </div>
    <div class="card-body p-0 overflow-auto" id="cp-53da231e3ffafa5e15fccd1fcc3569aa"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-plaintext" data-lang="plaintext"><span class="line"><span class="cl">Get-Service -DisplayName &#39;win*&#39;
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Status   Name               DisplayName
</span></span><span class="line"><span class="cl">------   ----               -----------
</span></span><span class="line"><span class="cl">Running  AudioEndpointBuil… Windows Audio Endpoint Builder
</span></span><span class="line"><span class="cl">Running  Audiosrv           Windows Audio
</span></span><span class="line"><span class="cl">Running  EventLog           Windows Event Log
</span></span><span class="line"><span class="cl">Running  FontCache          Windows Font Cache Service
</span></span><span class="line"><span class="cl">Stopped  FrameServer        Windows Camera Frame Server
</span></span><span class="line"><span class="cl">Stopped  FrameServerMonitor Windows Camera Frame Server Monitor
</span></span><span class="line"><span class="cl">Stopped  icssvc             Windows Mobile Hotspot Service
</span></span><span class="line"><span class="cl">Running  LicenseManager     Windows License Manager Service
</span></span><span class="line"><span class="cl">Stopped  MixedRealityOpenX… Windows Mixed Reality OpenXR Service
</span></span><span class="line"><span class="cl">Running  mpssvc             Windows Defender Firewall
</span></span><span class="line"><span class="cl">Stopped  msiserver          Windows Installer
</span></span><span class="line"><span class="cl">Stopped  perceptionsimulat… Windows Perception Simulation Service
</span></span><span class="line"><span class="cl">Stopped  PushToInstall      Windows PushToInstall Service
</span></span><span class="line"><span class="cl">Stopped  SDRSVC             Windows Backup
</span></span><span class="line"><span class="cl">Running  SecurityHealthSer… Windows Security Service</span></span></code></pre></td></tr></table>
</div>
</div></div>
  </div>
</div>]]></turbo:content></item><item turbo="true"><title>Работа с сетевыми интерфейсами в PowerShell</title><link>https://lib.onl/ru/2023/10/430b916d-fd5c-5d44-8c24-8b98f41e0355/</link><pubDate>Tue, 31 Oct 2023 17:16:31 +0000</pubDate><dc:creator>Kai Kimera</dc:creator><category>MS Windows</category><category>Терминал</category><category>Сеть</category><category>Скрипты</category><yandex:related><link url="https://lib.onl/ru/2023/10/1f062637-3227-56d7-93e3-126d1c80f5a8/">Работа с переменной среды окружения PATH</link><link url="https://lib.onl/ru/2023/10/fb64d665-3e56-5fa5-a9eb-2e2e251949d8/">Автоматическая настройка Windows Server 2022 под рабочую станцию</link><link url="https://lib.onl/ru/2023/10/38fc94dd-8d37-5f9e-b556-676304976a9f/">Восстановление доверительных отношений между PC и Active Directory</link><link url="https://lib.onl/ru/2023/10/616da78a-eb16-575a-9119-65f0c0c7baee/">Изменение порта RDP</link><link url="https://lib.onl/ru/2023/10/c6e32349-8fc2-53f9-9a42-790878a64076/">PowerShell: Полезные функции</link><link url="https://lib.onl/ru/2023/10/52d75b90-0637-5ba6-91d6-b1bff40e1d67/">PowerShell: Стирание диска</link><link url="https://lib.onl/ru/2023/10/2a73410a-6611-570c-9ab4-dc8cc8998146/">PowerShell: Сжатие видео при помощи FFmpeg</link><link url="https://lib.onl/ru/2023/10/0028821e-c96c-5014-a1dd-8963c161b170/">PowerShell: Определение разрядности ОС Windows</link><link url="https://lib.onl/ru/2023/10/4c7aba7c-f5a6-589a-9975-fdb16f2e2862/">PowerShell Vault</link><link url="https://lib.onl/ru/2023/10/eb39e3f7-b194-53d4-8bad-01edf9fdac47/">Дефрагментация в ОС Windows</link><link url="https://lib.onl/ru/2023/10/75075788-9308-56b7-b531-2008cb35f7d0/">Установка сертификата НУЦ Минцифры</link><link url="https://lib.onl/ru/2022/05/36058650-3f35-5ed5-9565-0aa7d8800c28/">Windows Server 2022 для рабочей станции</link></yandex:related><turbo:extendedHtml>true</turbo:extendedHtml><turbo:source>https://lib.onl/ru/2023/10/430b916d-fd5c-5d44-8c24-8b98f41e0355/</turbo:source><turbo:topic>Работа с сетевыми интерфейсами в PowerShell</turbo:topic><turbo:content><![CDATA[<p>Разберём основные команды, которые пригодятся нам при настройке сети в ОС <span class="shortcode shortcode-tag"><a href="/ru/tags/windows/" target="_blank">#Windows</a></span> через <span class="shortcode shortcode-tag"><a href="/ru/tags/powershell/" target="_blank">#PowerShell</a></span>.</p>
<h2 id="сетевые-адаптеры">
  <a class="link-body-emphasis" href="#%d1%81%d0%b5%d1%82%d0%b5%d0%b2%d1%8b%d0%b5-%d0%b0%d0%b4%d0%b0%d0%bf%d1%82%d0%b5%d1%80%d1%8b">Сетевые адаптеры</a>
</h2><p>Получить список сетевых адаптеров и их интерфейсов:</p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-0
shortcode-codeblock-powershell">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-9ecf9abe7280d667f4a72699dad7679c" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-powershell" data-lang="powershell"><span class="line"><span class="cl"><span class="nb">Get-NetAdapter</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-9ecf9abe7280d667f4a72699dad7679c"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<p>Получить список обычных и скрытых сетевых адаптеров:</p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-1
shortcode-codeblock-powershell">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-518f25e54050d769d91ea1529d41848f" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-powershell" data-lang="powershell"><span class="line"><span class="cl"><span class="nb">Get-NetAdapter</span> <span class="err">–</span><span class="n">IncludeHidden</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-518f25e54050d769d91ea1529d41848f"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<p>Получить конфигурацию по интерфейсу <code>5</code>:</p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-2
shortcode-codeblock-powershell">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-8680ad623bffd104c7d81c80d2e5d2aa" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-powershell" data-lang="powershell"><span class="line"><span class="cl"><span class="nb">Get-NetAdapter</span> <span class="n">-InterfaceIndex</span> <span class="mf">5</span> <span class="p">|</span> <span class="nb">Get-NetIPConfiguration</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-8680ad623bffd104c7d81c80d2e5d2aa"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<p>Получить детальную конфигурацию по интерфейсу <code>5</code>:</p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-3
shortcode-codeblock-powershell">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-f9c658f1a8745e2b2945d8e3387053c1" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-powershell" data-lang="powershell"><span class="line"><span class="cl"><span class="nb">Get-NetAdapter</span> <span class="n">-InterfaceIndex</span> <span class="mf">5</span> <span class="p">|</span> <span class="nb">Get-NetIPConfiguration</span> <span class="n">-Detailed</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-f9c658f1a8745e2b2945d8e3387053c1"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<p>Отключить адаптер с интерфейсом <code>5</code>:</p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-4
shortcode-codeblock-powershell">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-cc536dd151c88d9398c1f9e35a27d8f6" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-powershell" data-lang="powershell"><span class="line"><span class="cl"><span class="nb">Get-NetAdapter</span> <span class="n">-InterfaceIndex</span> <span class="mf">5</span> <span class="p">|</span> <span class="nb">Disable-NetAdapter</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-cc536dd151c88d9398c1f9e35a27d8f6"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<h2 id="сетевые-профили">
  <a class="link-body-emphasis" href="#%d1%81%d0%b5%d1%82%d0%b5%d0%b2%d1%8b%d0%b5-%d0%bf%d1%80%d0%be%d1%84%d0%b8%d0%bb%d0%b8">Сетевые профили</a>
</h2><p>Вывести информацию по текущим сетевым профилям:</p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-5
shortcode-codeblock-powershell">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-bbe74a4f57c5313c5aac611367bd02ae" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-powershell" data-lang="powershell"><span class="line"><span class="cl"><span class="nb">Get-NetConnectionProfile</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-bbe74a4f57c5313c5aac611367bd02ae"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<p>Получить информацию только по профилю сети интерфейса <code>5</code>:</p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-6
shortcode-codeblock-powershell">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-b410b7a0f54f1d2afb3a7ec5fb109013" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-powershell" data-lang="powershell"><span class="line"><span class="cl"><span class="nb">Get-NetAdapter</span> <span class="n">-InterfaceIndex</span> <span class="mf">5</span> <span class="p">|</span> <span class="nb">Get-NetConnectionProfile</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-b410b7a0f54f1d2afb3a7ec5fb109013"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<p>Изменить профиль сети интерфейса <code>5</code> на публичный (<code>Public</code>).</p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-7
shortcode-codeblock-powershell">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-b66a5758504b7a349a1c6d5f8a02af57" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-powershell" data-lang="powershell"><span class="line"><span class="cl"><span class="nb">Get-NetAdapter</span> <span class="n">-InterfaceIndex</span> <span class="mf">5</span> <span class="p">|</span> <span class="nb">Set-NetConnectionProfile</span> <span class="n">-NetworkCategory</span> <span class="s1">&#39;Public&#39;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-b66a5758504b7a349a1c6d5f8a02af57"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<p>Изменить профиль сети интерфейса <code>5</code> на приватный (<code>Private</code>).</p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-8
shortcode-codeblock-powershell">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-b7d3f7a868a6995260c7b8dac50b4ba8" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-powershell" data-lang="powershell"><span class="line"><span class="cl"><span class="nb">Get-NetAdapter</span> <span class="n">-InterfaceIndex</span> <span class="mf">5</span> <span class="p">|</span> <span class="nb">Set-NetConnectionProfile</span> <span class="n">-NetworkCategory</span> <span class="s1">&#39;Private&#39;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-b7d3f7a868a6995260c7b8dac50b4ba8"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<p>Изменить профиль сети интерфейса <code>5</code> на доменный (<code>DomainAuthenticated</code>).</p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-9
shortcode-codeblock-powershell">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-e75f01f72d86a8ae17bf47e5a3e4a8ab" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-powershell" data-lang="powershell"><span class="line"><span class="cl"><span class="nb">Get-NetAdapter</span> <span class="n">-InterfaceIndex</span> <span class="mf">5</span> <span class="p">|</span> <span class="nb">Set-NetConnectionProfile</span> <span class="n">-NetworkCategory</span> <span class="s1">&#39;DomainAuthenticated&#39;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-e75f01f72d86a8ae17bf47e5a3e4a8ab"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<h2 id="настройка-ip-адреса">
  <a class="link-body-emphasis" href="#%d0%bd%d0%b0%d1%81%d1%82%d1%80%d0%be%d0%b9%d0%ba%d0%b0-ip-%d0%b0%d0%b4%d1%80%d0%b5%d1%81%d0%b0">Настройка IP-адреса</a>
</h2><p>Отключить DHCP на интерфейсе <code>5</code>:</p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-10
shortcode-codeblock-powershell">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-35b2f1b8b3ee32785a273b473dda3912" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-powershell" data-lang="powershell"><span class="line"><span class="cl"><span class="nb">Get-NetAdapter</span> <span class="n">-InterfaceIndex</span> <span class="mf">5</span> <span class="p">|</span> <span class="nb">Set-NetIPInterface</span> <span class="n">-Dhcp</span> <span class="s1">&#39;Disabled&#39;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-35b2f1b8b3ee32785a273b473dda3912"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<p>Установить новый IP-адрес и шлюз на интерфейсе <code>5</code>:</p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-11
shortcode-codeblock-powershell">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-caeefa2701dfdbf5312796c408415c2d" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-powershell" data-lang="powershell"><span class="line"><span class="cl"><span class="nb">Get-NetAdapter</span> <span class="n">-InterfaceIndex</span> <span class="mf">5</span> <span class="p">|</span> <span class="nb">New-NetIPAddress</span> <span class="err">–</span><span class="n">IPAddress</span> <span class="s1">&#39;192.168.0.10&#39;</span> <span class="n">-PrefixLength</span> <span class="s1">&#39;24&#39;</span> <span class="n">-DefaultGateway</span> <span class="s1">&#39;192.168.0.1&#39;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-caeefa2701dfdbf5312796c408415c2d"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<p>Изменить IP-адрес на интерфейсе <code>5</code>:</p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-12
shortcode-codeblock-powershell">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-5dbdfc6754637c19f15cad2ca118bf41" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-powershell" data-lang="powershell"><span class="line"><span class="cl"><span class="nb">Get-NetAdapter</span> <span class="n">-InterfaceIndex</span> <span class="mf">5</span> <span class="p">|</span> <span class="nb">Set-NetIPAddress</span> <span class="n">-IPAddress</span> <span class="s1">&#39;192.168.0.12&#39;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-5dbdfc6754637c19f15cad2ca118bf41"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<p>Удалить IP-адрес на интерфейсе <code>5</code>:</p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-13
shortcode-codeblock-powershell">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-4d85f5c147616d0ce306d0d262b54587" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-powershell" data-lang="powershell"><span class="line"><span class="cl"><span class="nb">Get-NetAdapter</span> <span class="n">-InterfaceIndex</span> <span class="mf">5</span> <span class="p">|</span> <span class="nb">Remove-NetIPAddress</span> <span class="n">-Confirm:</span><span class="vm">$false</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-4d85f5c147616d0ce306d0d262b54587"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<p>Удаление шлюза на интерфейсе <code>5</code>:</p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-14
shortcode-codeblock-powershell">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-792188976544023d8b03eeb9ac075ab0" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-powershell" data-lang="powershell"><span class="line"><span class="cl"><span class="nb">Get-NetAdapter</span> <span class="n">-InterfaceIndex</span> <span class="mf">5</span> <span class="p">|</span> <span class="nb">Remove-NetRoute</span> <span class="n">-Confirm:</span><span class="vm">$false</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-792188976544023d8b03eeb9ac075ab0"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<h2 id="настройка-dns">
  <a class="link-body-emphasis" href="#%d0%bd%d0%b0%d1%81%d1%82%d1%80%d0%be%d0%b9%d0%ba%d0%b0-dns">Настройка DNS</a>
</h2><p>Установить IP-адреса серверов <span class="shortcode shortcode-tag"><a href="/ru/tags/dns/" target="_blank">#DNS</a></span> на интерфейсе <code>5</code>:</p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-15
shortcode-codeblock-powershell">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-1625165d5dd32d9fef3d35e6141d8d63" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-powershell" data-lang="powershell"><span class="line"><span class="cl"><span class="nb">Get-NetAdapter</span> <span class="n">-InterfaceIndex</span> <span class="mf">5</span> <span class="p">|</span> <span class="nb">Set-DNSClientServerAddress</span> <span class="err">–</span><span class="n">ServerAddresses</span> <span class="p">(</span><span class="s1">&#39;192.168.0.2&#39;</span><span class="p">,</span><span class="s1">&#39;192.168.1.2&#39;</span><span class="p">)</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-1625165d5dd32d9fef3d35e6141d8d63"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<p>Сбросить IP-адреса серверов DNS на параметры по умолчанию на интерфейсе <code>5</code>:</p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-16
shortcode-codeblock-powershell">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-02601114845824cf13ad5f27a2b04043" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-powershell" data-lang="powershell"><span class="line"><span class="cl"><span class="nb">Get-NetAdapter</span> <span class="n">-InterfaceIndex</span> <span class="mf">5</span> <span class="p">|</span> <span class="nb">Set-DnsClientServerAddress</span> <span class="n">-ResetServerAddresses</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-02601114845824cf13ad5f27a2b04043"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<p>Очистить кэш <span class="shortcode shortcode-tag"><a href="/ru/tags/dns/" target="_blank">#DNS</a></span>:</p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-17
shortcode-codeblock-powershell">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-b5fdf6389f94e27fb7b1ba173750a52e" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-powershell" data-lang="powershell"><span class="line"><span class="cl"><span class="nb">Clear-DnsClientCache</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-b5fdf6389f94e27fb7b1ba173750a52e"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<h2 id="настройка-dhcp">
  <a class="link-body-emphasis" href="#%d0%bd%d0%b0%d1%81%d1%82%d1%80%d0%be%d0%b9%d0%ba%d0%b0-dhcp">Настройка DHCP</a>
</h2><p>Включить <span class="shortcode shortcode-tag"><a href="/ru/tags/dhcp/" target="_blank">#DHCP</a></span> на интерфейсе <code>5</code>:</p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-18
shortcode-codeblock-powershell">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-2b68ebc96f975d8f4a981a28831aa8f8" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-powershell" data-lang="powershell"><span class="line"><span class="cl"><span class="nb">Get-NetAdapter</span> <span class="n">-InterfaceIndex</span> <span class="mf">5</span> <span class="p">|</span> <span class="nb">Set-NetIPInterface</span> <span class="n">-Dhcp</span> <span class="s1">&#39;Enabled&#39;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-2b68ebc96f975d8f4a981a28831aa8f8"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<p>Перезапустить интерфейс с именем <code>Ethernet</code> для получения параметров от <span class="shortcode shortcode-tag"><a href="/ru/tags/dhcp/" target="_blank">#DHCP</a></span>:</p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-19
shortcode-codeblock-powershell">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-1eafd04000e1cc2228ee09dffcc0a6e3" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-powershell" data-lang="powershell"><span class="line"><span class="cl"><span class="nb">Get-NetAdapter</span> <span class="n">-InterfaceIndex</span> <span class="mf">5</span> <span class="p">|</span> <span class="nb">Restart-NetAdapter</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-1eafd04000e1cc2228ee09dffcc0a6e3"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<h2 id="автоматизация">
  <a class="link-body-emphasis" href="#%d0%b0%d0%b2%d1%82%d0%be%d0%bc%d0%b0%d1%82%d0%b8%d0%b7%d0%b0%d1%86%d0%b8%d1%8f">Автоматизация</a>
</h2><p>Скрипт не имеет вводных параметров. Все параметры настраиваются вручную через редактирование скрипта. Далее, скрипт запускается и применяет указанные параметры.</p>

    

    
        
            
            <div class="shortcode shortcode-file mb-3">
              <div class="card overflow-hidden" data-bs-theme="dark">
                <div class="card-header">
                  <div class="d-flex align-items-center">
                    <div class="flex-shrink-0">
                      <i class="far fa-file-code fa-fw"></i>
                    </div>
                    <div class="flex-grow-1 mx-2 text-truncate">
                      <code>pwsh.set.ip.ps1</code>
                    </div>
                    <div class="flex-shrink-0">
                      <ul class="list-inline mb-0">
                        <li class="list-inline-item" title='Копировать'>
                          <a class="text-body" href="#"
                             data-fn="clipboard" data-clipboard-target="#cp-38e93f1d0688c1990c424448e71ccf5a"
                             role="button" aria-label='Копировать'>
                            <i class="fas fa-copy fa-fw"></i>
                          </a>
                        </li>
                        <li class="list-inline-item" title='Скачать'>
                          <a class="text-body" href="/ru/2023/10/430b916d-fd5c-5d44-8c24-8b98f41e0355/pwsh.set.ip.ps1" download
                             role="button" aria-label='Скачать'>
                            <i class="fas fa-download fa-fw"></i>
                          </a>
                        </li>
                        <li class="list-inline-item" title='Открыть'>
                          <a class="text-body" href="/ru/2023/10/430b916d-fd5c-5d44-8c24-8b98f41e0355/pwsh.set.ip.ps1" target="_blank"
                             role="button" aria-label='Открыть'>
                            <i class="fas fa-arrow-up-right-from-square fa-fw"></i>
                          </a>
                        </li>
                      </ul>
                    </div>
                  </div>
                </div>
                <div class="card-body p-0 overflow-auto" id="cp-38e93f1d0688c1990c424448e71ccf5a">
                    
                        
                    
                    <div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-ps1" data-lang="ps1"><span class="line"><span class="cl"><span class="cm">&lt;#PSScriptInfo
</span></span></span><span class="line"><span class="cl"><span class="cm">.VERSION      0.1.0
</span></span></span><span class="line"><span class="cl"><span class="cm">.GUID         b42524a4-c0d0-4402-951c-e97aa140698e
</span></span></span><span class="line"><span class="cl"><span class="cm">.AUTHOR       Kai Kimera
</span></span></span><span class="line"><span class="cl"><span class="cm">.AUTHOREMAIL  mail@kai.kim
</span></span></span><span class="line"><span class="cl"><span class="cm">.COMPANYNAME  Library Online
</span></span></span><span class="line"><span class="cl"><span class="cm">.COPYRIGHT    2023 Library Online. All rights reserved.
</span></span></span><span class="line"><span class="cl"><span class="cm">.LICENSEURI   https://choosealicense.com/licenses/mit/
</span></span></span><span class="line"><span class="cl"><span class="cm">.PROJECTURI   https://lib.onl/ru/2023/10/430b916d-fd5c-5d44-8c24-8b98f41e0355/
</span></span></span><span class="line"><span class="cl"><span class="cm">#&gt;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c">#</span><span class="k">Requires</span><span class="w"> </span><span class="kd">-Version</span><span class="na"> 7.2</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c">#</span><span class="k">Requires</span><span class="w"> </span><span class="kd">-RunAsAdministrator</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c"># -------------------------------------------------------------------------------------------------------------------- #</span>
</span></span><span class="line"><span class="cl"><span class="c"># CONFIGURATION</span>
</span></span><span class="line"><span class="cl"><span class="c"># -------------------------------------------------------------------------------------------------------------------- #</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nv">$Adapter</span> <span class="p">=</span> <span class="vm">@</span><span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="c"># Interface index.</span>
</span></span><span class="line"><span class="cl">  <span class="n">InterfaceIndex</span> <span class="p">=</span> <span class="mf">0</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nv">$IP</span> <span class="p">=</span> <span class="vm">@</span><span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="c"># IP address.</span>
</span></span><span class="line"><span class="cl">  <span class="n">IPAddress</span> <span class="p">=</span> <span class="s1">&#39;192.168.0.10&#39;</span>
</span></span><span class="line"><span class="cl">  <span class="c"># Subnet mask.</span>
</span></span><span class="line"><span class="cl">  <span class="n">PrefixLength</span> <span class="p">=</span> <span class="s1">&#39;24&#39;</span>
</span></span><span class="line"><span class="cl">  <span class="c"># Gateway.</span>
</span></span><span class="line"><span class="cl">  <span class="n">DefaultGateway</span> <span class="p">=</span> <span class="s1">&#39;192.168.0.1&#39;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nv">$DNS</span> <span class="p">=</span> <span class="vm">@</span><span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="c"># DNS servers.</span>
</span></span><span class="line"><span class="cl">  <span class="n">ServerAddresses</span> <span class="p">=</span> <span class="p">(</span>
</span></span><span class="line"><span class="cl">    <span class="s1">&#39;192.168.0.2&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="s1">&#39;192.168.1.2&#39;</span>
</span></span><span class="line"><span class="cl">  <span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c"># -------------------------------------------------------------------------------------------------------------------- #</span>
</span></span><span class="line"><span class="cl"><span class="c"># -------------------------------------------------&lt; RUNNING SCRIPT &gt;------------------------------------------------- #</span>
</span></span><span class="line"><span class="cl"><span class="c"># -------------------------------------------------------------------------------------------------------------------- #</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nb">Get-NetAdapter</span> <span class="nv">@Adapter</span> <span class="p">|</span> <span class="nb">Remove-NetIPAddress</span> <span class="n">-Confirm:</span><span class="vm">$false</span>   <span class="c"># Removing current IP address.</span>
</span></span><span class="line"><span class="cl"><span class="nb">Get-NetAdapter</span> <span class="nv">@Adapter</span> <span class="p">|</span> <span class="nb">Remove-NetRoute</span> <span class="n">-Confirm:</span><span class="vm">$false</span>       <span class="c"># Removing current gateway.</span>
</span></span><span class="line"><span class="cl"><span class="nb">Get-NetAdapter</span> <span class="nv">@Adapter</span> <span class="p">|</span> <span class="nb">New-NetIPAddress</span> <span class="nv">@IP</span>                  <span class="c"># Setting new IP address.</span>
</span></span><span class="line"><span class="cl"><span class="nb">Get-NetAdapter</span> <span class="nv">@Adapter</span> <span class="p">|</span> <span class="nb">Set-DNSClientServerAddress</span> <span class="nv">@DNS</span>       <span class="c"># Setting new DNS servers.</span></span></span></code></pre></td></tr></table>
</div>
</div>
                </div>
              </div>
            </div>]]></turbo:content></item><item turbo="true"><title>Как при помощи CloudFlare заменить в URL одну директорию на другую?</title><link>https://lib.onl/ru/2023/10/3c4c6709-69a6-54be-9404-e4b7ede6ab90/</link><pubDate>Tue, 31 Oct 2023 06:16:50 +0000</pubDate><dc:creator>Kai Kimera</dc:creator><category>Cloudflare</category><turbo:extendedHtml>true</turbo:extendedHtml><turbo:source>https://lib.onl/ru/2023/10/3c4c6709-69a6-54be-9404-e4b7ede6ab90/</turbo:source><turbo:topic>Как при помощи CloudFlare заменить в URL одну директорию на другую?</turbo:topic><turbo:content><![CDATA[<p>Здравствуйте! Страницы сайта переехали в другой раздел. Было <code>domain.com/[pages]/post_1</code>, стало <code>domain.com/[posts]/post_1</code>. Надо сделать перенаправление. Но как?</p>]]></turbo:content></item><item turbo="true"><title>Работа с правилами CloudFlare</title><link>https://lib.onl/ru/2023/10/e191797e-d558-5017-8ac4-c28c6e0871ff/</link><pubDate>Sun, 29 Oct 2023 06:55:05 +0000</pubDate><dc:creator>Kai Kimera</dc:creator><category>В доработке</category><category>Сеть</category><yandex:related><link url="https://lib.onl/ru/2020/07/ff2ae66e-8e14-5c4a-baa6-0cd2e59f6517/">MikroTik и CloudFlare: Динамический IP для домена</link></yandex:related><turbo:extendedHtml>true</turbo:extendedHtml><turbo:source>https://lib.onl/ru/2023/10/e191797e-d558-5017-8ac4-c28c6e0871ff/</turbo:source><turbo:topic>Работа с правилами CloudFlare</turbo:topic><turbo:content><![CDATA[<p><span class="shortcode shortcode-tag"><a href="/ru/tags/cloudflare/" target="_blank">#CloudFlare</a></span> предоставляет мощный инструмент по работе с различными правилами, зависящими от запросов клиентов. Разберём составление этих правил и приведём несколько примеров.</p>
<h2 id="настройки-правила">
  <a class="link-body-emphasis" href="#%d0%bd%d0%b0%d1%81%d1%82%d1%80%d0%be%d0%b9%d0%ba%d0%b8-%d0%bf%d1%80%d0%b0%d0%b2%d0%b8%d0%bb%d0%b0">Настройки правила</a>
</h2><p>Правила работаю на, так называемом, <a title="" href="https://developers.cloudflare.com/ruleset-engine/" target="_blank"
   rel="noopener noreferrer">Cloudflare Ruleset Engine</a> и позволяют максимально гибко себя конфигурировать при помощи специальных полей, условий и переменных.</p>
<p>Каждое правило состоит из двух этапов:</p>
<ol>
<li>If&hellip; - если.</li>
<li>Then&hellip; - тогда.</li>
</ol>
<p>Рассмотрим всё это дело подробнее&hellip;</p>
<h3 id="if">
  <a class="link-body-emphasis" href="#if">If&hellip;</a>
</h3><p>Этап &ldquo;Если&rdquo; означает условие, по которому будут фильтроваться клиенты. Этап состоит из поля, оператора сравнения и значения, которое будет участвовать в составленном условии.</p>
<h4 id="поля">
  <a class="link-body-emphasis" href="#%d0%bf%d0%be%d0%bb%d1%8f">Поля</a>
</h4><p>Поля это переменные, значения которых вычисляются из запроса, инициируемого клиентом. Ниже приведён частичный список полей, которые доступны из графического интерфейса. Полный список полей находится в <a title="" href="https://developers.cloudflare.com/ruleset-engine/rules-language/fields/" target="_blank"
   rel="noopener noreferrer">документации CloudFlare</a>.</p>
<ul>
<li>AS Num <code>ip.src.asnum</code>.<br>
16- или 32-разрядное целое число, представляющее номер автономной системы (AS), связанной с IP-адресом клиента. Это поле эквивалентно устаревшему <code>ip.geoip.asnum</code>.</li>
<li>Cookie <code>http.cookie</code>.<br>
Файл cookie в строке. Пример: <code>session=8521F670545D7865F79C3D7BEDC29CCE;-background=light</code>.</li>
<li>Country <code>ip.src.country</code>.<br>
Двухбуквенный код страны в формате ISO 3166-1 Alpha 2. Пример: GB. Это поле эквивалентно устаревшему <code>ip.geoip.country</code>.</li>
<li>Continent <code>ip.src.continent</code>.<br>
Код континента, связанный с IP-адресом клиента. Это поле эквивалентно устаревшему <code>ip.geoip.continent</code>.
<ul>
<li><code>AF</code> - Africa.</li>
<li><code>AN</code> - Antarctica.</li>
<li><code>AS</code> - Asia.</li>
<li><code>EU</code> - Europe.</li>
<li><code>NA</code> - North America.</li>
<li><code>OC</code> - Oceania.</li>
<li><code>SA</code> - South America.</li>
<li><code>T1</code> - Tor network.</li>
</ul>
</li>
<li>Hostname <code>http.host</code>.<br>
Имя хоста. Пример: <code>www.example.org</code>.</li>
<li>IP Source Address <code>ip.src</code>.<br>
IP-адрес клиента. Пример: <code>93.184.216.34</code>.</li>
<li>Referer <code>http.referer</code>.<br>
Заголовок запроса HTTP Referer, который содержит адрес веб-страницы, с которой пришёл запрос. Пример: <code>Referer: htt­ps://developer.example.org/en-US/docs/Web/JavaScript</code>.</li>
<li>Request Method <code>http.request.method</code>.<br>
Метод HTTP-запроса. Пример: <code>GET</code>.</li>
<li>SSL/HTTPS <code>ssl</code>.<br>
Возвращает <code>true</code>, когда используется зашифрованное соединение с клиентом.</li>
<li>URI Full <code>http.request.full_uri</code>.<br>
Весь URI, полученный сервером. Пример: <code>htt­ps://www.example.org/articles/index?section=539061&amp;expand=comments</code>.</li>
<li>URI <code>http.request.uri</code>.<br>
Путь URI и строка запроса. Пример: <code>/articles/index?section=539061&amp;expand=comments</code>.</li>
<li>URI Path <code>http.request.uri.path</code>.<br>
Путь URI. Пример: <code>/articles/index</code>.</li>
<li>URI Query String <code>http.request.uri.query</code>.<br>
Строка запроса без разделителя <code>?</code>. Пример: <code>section=539061&amp;expand=comments</code>.</li>
<li>HTTP Version <code>http.request.version</code>.<br>
Версия используемого протокола HTTP. Пример: <code>HTTP/1.1</code> или <code>HTTP/3</code>.</li>
<li>User Agent <code>http.user_agent</code>.<br>
User Agent клиента, строка, позволяющая идентифицировать клиентскую операционную систему и веб-браузер. Пример: <code>Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/65.0.3325.181 Safari/537.36</code>.</li>
<li>X-Forward-For <code>http.x_forwarded_for</code>.<br>
Заголовок X-Forwarded-For. Пример: <code>203.0.113.195, 70.41.3.18</code>.</li>
<li>Client Certificate Verified <code>cf.tls_client_auth.cert_verified</code>.<br>
Возвращает <code>true</code>, когда запрос предоставляет действительный сертификат клиента.</li>
</ul>
<h4 id="операторы">
  <a class="link-body-emphasis" href="#%d0%be%d0%bf%d0%b5%d1%80%d0%b0%d1%82%d0%be%d1%80%d1%8b">Операторы</a>
</h4><p>Операторы сравнения возвращают true, когда значение запроса клиента совпадает со значением в выражении. Подробнее в <a title="" href="https://developers.cloudflare.com/ruleset-engine/rules-language/operators/" target="_blank"
   rel="noopener noreferrer">документации</a>.</p>
<ul>
<li>equals <code>eq</code> - равно.</li>
<li>does not equal <code>ne</code> -  не равно.</li>
<li>greater than <code>gt</code> - больше чем.</li>
<li>less than <code>lt</code> - меньше чем.</li>
<li>greater than or equal to <code>ge</code> - больше или равно.</li>
<li>less than or equal to <code>le</code> - меньше или равно.</li>
<li>is in <code>in {}</code> - значение находится в массиве.</li>
<li>is not in <code>not &lt;field&gt; in {}</code> - значение не находится в массиве.</li>
</ul>
<h3 id="then">
  <a class="link-body-emphasis" href="#then">Then&hellip;</a>
</h3><p>Этап &ldquo;Тогда&rdquo; подразумевает под собой действие, которое будет применено к отфильтрованному клиенту.</p>
<h4 id="тип-поля-url">
  <a class="link-body-emphasis" href="#%d1%82%d0%b8%d0%bf-%d0%bf%d0%be%d0%bb%d1%8f-url">Тип поля URL</a>
</h4><ul>
<li>Dynamic - в поле URL содержит динамические параметры (переменные полей) и их необходимо вычислять и обрабатывать.</li>
<li>Static - в поле URL содержится обычные статические параметры.</li>
</ul>
<h4 id="коды-статуса">
  <a class="link-body-emphasis" href="#%d0%ba%d0%be%d0%b4%d1%8b-%d1%81%d1%82%d0%b0%d1%82%d1%83%d1%81%d0%b0">Коды статуса</a>
</h4><ul>
<li>301 (Moved Permanently).<br>
Запрошенный ресурс был окончательно перемещён в URL, указанный в заголовке <code>Location</code>. Браузер в случае такого ответа перенаправляется на эту страницу, а поисковые системы обновляют свои ссылки на ресурс (говоря языком SEO, вес страницы переносится на новый URL-адрес).</li>
<li>302 (Moved Temporarily).<br>
Запрошенный ресурс был временно перемещён по адресу, указанному в заголовке <code>Location</code>. Получив такой ответ браузер перенаправляется на новую страницу, но поисковые системы не обновляют свои ссылки на ресурс (в жаргоне SEO говорят, что вес ссылки (link-juice) не меняется и не отправляется на новый URL-адрес).</li>
<li>303 (See Other).<br>
Перенаправление производится не на новый (только что загруженный) ресурс, а на другую страницу, например, страницу подтверждения или страницу с результатами загрузки.</li>
<li>307 (Temporary Redirect).<br>
Запрошенный ресурс был временно перемещён в URL-адрес, указанный в заголовке <code>Location</code>. Единственное различие между 307 и 302 состоит в том, что 307 гарантирует, что метод и тело не будут изменены при выполнении перенаправленного запроса. В случае с кодом 302 некоторые старые клиенты неправильно меняли метод на <code>GET</code>, из-за чего поведение запросов с методом отличным от <code>GET</code> и ответа с кодом 302 непредсказуемо, тогда как поведение в случае ответа с кодом 307 предсказуемо. Для запросов <code>GET</code> поведение идентично.</li>
<li>308 (Permanent Redirect).<br>
Запрошенный ресурс был окончательно перемещён в URL-адрес, указанный в <code>Location</code>. Браузер перенаправляется на эту страницу, а поисковые системы обновляют свои ссылки на ресурс (в SEO-speak говорится, что link-juice отправляется на новый URL-адрес). Метод запроса и тело не будут изменены, тогда как 301 иногда может быть неправильно заменён на <code>GET</code> метод.</li>
</ul>
<p>В примерах я буду приводить шаблон, который вписывается в редактор выражения. Поэтому, можно не щёлкать по удобным кнопочкам, а сразу нажимать <span class="shortcode shortcode-btn d-inline-block"><kbd class="bg-primary">Edit expression</kbd></span> и вписывать нужный шаблон.</p>
<h2 id="переадресация">
  <a class="link-body-emphasis" href="#%d0%bf%d0%b5%d1%80%d0%b5%d0%b0%d0%b4%d1%80%d0%b5%d1%81%d0%b0%d1%86%d0%b8%d1%8f">Переадресация</a>
</h2><p>Самый часто используемый тип правил, это правила по работе с переадресацией. Привожу несколько примеров. Их можно брать готовыми и вставлять в редактор выражения, не забыв отредактировать под себя некоторые входные параметры, например, название домена или адрес куда переадресовывать клиентов.</p>
<h3 id="примеры">
  <a class="link-body-emphasis" href="#%d0%bf%d1%80%d0%b8%d0%bc%d0%b5%d1%80%d1%8b">Примеры</a>
</h3><p>Ниже я привёл примеры, которые позволяют реализовать наиболее популярные правила переадресации запросов.</p>
<h4 id="пути">
  <a class="link-body-emphasis" href="#%d0%bf%d1%83%d1%82%d0%b8">Пути</a>
</h4><p>Переадресация запроса с одного ресурса (или страницы) на другой ресурс (или страницу).</p>


<div class="accordion mb-3 shortcode shortcode-accordion" id="sc-a8ec36334fe29993bc73f5d4b48c1c5e">
    




    
    <div class="accordion-item">
      <div class="accordion-header">
        <a class="accordion-button collapsed" href="#" role="button" tabindex="0"
           data-bs-toggle="collapse" data-bs-target="#sc-37ec03d3465cd84a0c3190c3ab0d9282"
           aria-expanded="false" aria-controls="sc-37ec03d3465cd84a0c3190c3ab0d9282" aria-label="example.com | www.example.com">
            example.com | www.example.com
        </a>
      </div>
      <div class="accordion-collapse collapse" id="sc-37ec03d3465cd84a0c3190c3ab0d9282" data-bs-parent="#sc-a8ec36334fe29993bc73f5d4b48c1c5e">
        <div class="accordion-body">
            <p><code>https://example.com</code> <code>-&gt;</code> <code>https://www.example.com</code></p>
<p><strong>When incoming requests match:</strong></p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-0
shortcode-codeblock-lua">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-78cda25f3f6e246dc4e19d762d7b213a" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-lua" data-lang="lua"><span class="line"><span class="cl"><span class="p">(</span><span class="n">http.host</span> <span class="n">eq</span> <span class="s2">&#34;example.com&#34;</span><span class="p">)</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-78cda25f3f6e246dc4e19d762d7b213a"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<p><strong>Then&hellip;</strong></p>
<ul>
<li>Type: <code>Dynamic</code></li>
<li>Status code: <code>301</code></li>
</ul>
<p><strong>URL:</strong></p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-1
shortcode-codeblock-lua">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-9989e73f9f6504c9a9d8ba6f5fba3b65" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-lua" data-lang="lua"><span class="line"><span class="cl"><span class="n">concat</span><span class="p">(</span><span class="s2">&#34;https://www.&#34;</span><span class="p">,</span> <span class="n">http.host</span><span class="p">,</span> <span class="n">http.request</span><span class="p">.</span><span class="n">uri.path</span><span class="p">)</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-9989e73f9f6504c9a9d8ba6f5fba3b65"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>



        </div>
      </div>
    </div>






    
    <div class="accordion-item">
      <div class="accordion-header">
        <a class="accordion-button collapsed" href="#" role="button" tabindex="0"
           data-bs-toggle="collapse" data-bs-target="#sc-da08ba8e53f82bc75ff3918010afa011"
           aria-expanded="false" aria-controls="sc-da08ba8e53f82bc75ff3918010afa011" aria-label="www.example.com | example.com">
            www.example.com | example.com
        </a>
      </div>
      <div class="accordion-collapse collapse" id="sc-da08ba8e53f82bc75ff3918010afa011" data-bs-parent="#sc-a8ec36334fe29993bc73f5d4b48c1c5e">
        <div class="accordion-body">
            <p><code>https://www.example.com</code> <code>-&gt;</code> <code>https://example.com</code></p>
<p><strong>When incoming requests match:</strong></p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-0
shortcode-codeblock-lua">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-5cb8d63e7691416a2c7fe4ae83b551bb" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-lua" data-lang="lua"><span class="line"><span class="cl"><span class="p">(</span><span class="n">http.host</span> <span class="n">eq</span> <span class="s2">&#34;www.example.com&#34;</span><span class="p">)</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-5cb8d63e7691416a2c7fe4ae83b551bb"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<p><strong>Then&hellip;</strong></p>
<ul>
<li>Type: <code>Dynamic</code></li>
<li>Status code: <code>301</code></li>
</ul>
<p><strong>URL:</strong></p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-1
shortcode-codeblock-lua">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-ed31f7e5cf543924aacb330f6b37e73f" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-lua" data-lang="lua"><span class="line"><span class="cl"><span class="n">concat</span><span class="p">(</span><span class="s2">&#34;https://&#34;</span><span class="p">,</span> <span class="n">http.host</span><span class="p">,</span> <span class="n">http.request</span><span class="p">.</span><span class="n">uri.path</span><span class="p">)</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-ed31f7e5cf543924aacb330f6b37e73f"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>



        </div>
      </div>
    </div>






    
    <div class="accordion-item">
      <div class="accordion-header">
        <a class="accordion-button collapsed" href="#" role="button" tabindex="0"
           data-bs-toggle="collapse" data-bs-target="#sc-d39ea59fde5e0b7bc52d224744590ab0"
           aria-expanded="false" aria-controls="sc-d39ea59fde5e0b7bc52d224744590ab0" aria-label="example.com/path | example.org/path">
            example.com/path | example.org/path
        </a>
      </div>
      <div class="accordion-collapse collapse" id="sc-d39ea59fde5e0b7bc52d224744590ab0" data-bs-parent="#sc-a8ec36334fe29993bc73f5d4b48c1c5e">
        <div class="accordion-body">
            <p><code>https://example.com/path</code> <code>-&gt;</code> <code>https://example.org/path</code></p>
<p><strong>When incoming requests match:</strong></p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-0
shortcode-codeblock-lua">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-ac386776e741bb6ce7fee0de8618b208" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-lua" data-lang="lua"><span class="line"><span class="cl"><span class="p">(</span><span class="n">http.host</span> <span class="n">eq</span> <span class="s2">&#34;example.com&#34;</span><span class="p">)</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-ac386776e741bb6ce7fee0de8618b208"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<p><strong>Then&hellip;</strong></p>
<ul>
<li>Type: <code>Dynamic</code></li>
<li>Status code: <code>301</code></li>
</ul>
<p><strong>URL:</strong></p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-1
shortcode-codeblock-lua">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-10925d296d9a5a1f334d30498ffcc03f" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-lua" data-lang="lua"><span class="line"><span class="cl"><span class="n">concat</span><span class="p">(</span><span class="s2">&#34;https://example.org&#34;</span><span class="p">,</span> <span class="n">http.request</span><span class="p">.</span><span class="n">uri.path</span><span class="p">)</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-10925d296d9a5a1f334d30498ffcc03f"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>



        </div>
      </div>
    </div>






    
    <div class="accordion-item">
      <div class="accordion-header">
        <a class="accordion-button collapsed" href="#" role="button" tabindex="0"
           data-bs-toggle="collapse" data-bs-target="#sc-0e16cfda8a9a949a7dfa6ae17d3cf5ad"
           aria-expanded="false" aria-controls="sc-0e16cfda8a9a949a7dfa6ae17d3cf5ad" aria-label="example.com | example.org">
            example.com | example.org
        </a>
      </div>
      <div class="accordion-collapse collapse" id="sc-0e16cfda8a9a949a7dfa6ae17d3cf5ad" data-bs-parent="#sc-a8ec36334fe29993bc73f5d4b48c1c5e">
        <div class="accordion-body">
            <p><code>https://example.com</code> <code>-&gt;</code> <code>https://example.org</code></p>
<p><strong>When incoming requests match:</strong></p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-0
shortcode-codeblock-lua">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-5669596c96c9b7ab12b9262632942e97" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-lua" data-lang="lua"><span class="line"><span class="cl"><span class="p">(</span><span class="n">http.host</span> <span class="n">contains</span> <span class="s2">&#34;example.com&#34;</span><span class="p">)</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-5669596c96c9b7ab12b9262632942e97"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<p><strong>Then&hellip;</strong></p>
<ul>
<li>Type: <code>Static</code></li>
<li>Status code: <code>301</code></li>
</ul>
<p><strong>URL:</strong></p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-1
shortcode-codeblock-lua">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-37046c69a3683cdef4b218a2e994ae3c" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-lua" data-lang="lua"><span class="line"><span class="cl"><span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">example.org</span><span class="o">/</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-37046c69a3683cdef4b218a2e994ae3c"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>



        </div>
      </div>
    </div>






    
    <div class="accordion-item">
      <div class="accordion-header">
        <a class="accordion-button collapsed" href="#" role="button" tabindex="0"
           data-bs-toggle="collapse" data-bs-target="#sc-323d50c2c21ff3f6459897fb22d73f85"
           aria-expanded="false" aria-controls="sc-323d50c2c21ff3f6459897fb22d73f85" aria-label="sub.example.com | example.com/sub">
            sub.example.com | example.com/sub
        </a>
      </div>
      <div class="accordion-collapse collapse" id="sc-323d50c2c21ff3f6459897fb22d73f85" data-bs-parent="#sc-a8ec36334fe29993bc73f5d4b48c1c5e">
        <div class="accordion-body">
            <p><code>https://sub.example.com</code> <code>-&gt;</code> <code>https://example.com/sub</code></p>
<p><strong>When incoming requests match:</strong></p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-0
shortcode-codeblock-lua">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-41e473be28064427087d343bef86f3d9" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-lua" data-lang="lua"><span class="line"><span class="cl"><span class="p">(</span><span class="n">http.host</span> <span class="n">eq</span> <span class="s2">&#34;sub.example.com&#34;</span><span class="p">)</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-41e473be28064427087d343bef86f3d9"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<p><strong>Then&hellip;</strong></p>
<ul>
<li>Type: <code>Dynamic</code></li>
<li>Status code: <code>301</code></li>
</ul>
<p><strong>URL:</strong></p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-1
shortcode-codeblock-lua">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-6a8827e43f02c8e5e85e41811f657f05" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-lua" data-lang="lua"><span class="line"><span class="cl"><span class="n">concat</span><span class="p">(</span><span class="s2">&#34;https://&#34;</span><span class="p">,</span> <span class="n">http.host</span><span class="p">,</span> <span class="s2">&#34;/sub&#34;</span><span class="p">,</span> <span class="n">http.request</span><span class="p">.</span><span class="n">uri.path</span><span class="p">)</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-6a8827e43f02c8e5e85e41811f657f05"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>



        </div>
      </div>
    </div>






    
    <div class="accordion-item">
      <div class="accordion-header">
        <a class="accordion-button collapsed" href="#" role="button" tabindex="0"
           data-bs-toggle="collapse" data-bs-target="#sc-626515a52062ddb7ec605ce74dd59181"
           aria-expanded="false" aria-controls="sc-626515a52062ddb7ec605ce74dd59181" aria-label="example.com/sub | sub.example.com">
            example.com/sub | sub.example.com
        </a>
      </div>
      <div class="accordion-collapse collapse" id="sc-626515a52062ddb7ec605ce74dd59181" data-bs-parent="#sc-a8ec36334fe29993bc73f5d4b48c1c5e">
        <div class="accordion-body">
            <p><code>https://example.com/sub</code> <code>-&gt;</code> <code>https://sub.example.com</code></p>
<p><strong>When incoming requests match:</strong></p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-0
shortcode-codeblock-lua">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-bef5aa145e9bffe39584bed533ecb467" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-lua" data-lang="lua"><span class="line"><span class="cl"><span class="p">(</span><span class="n">starts_with</span><span class="p">(</span><span class="n">http.request</span><span class="p">.</span><span class="n">uri.path</span><span class="p">,</span> <span class="s2">&#34;/sub/&#34;</span><span class="p">))</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-bef5aa145e9bffe39584bed533ecb467"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<p><strong>Then&hellip;</strong></p>
<ul>
<li>Type: <code>Dynamic</code></li>
<li>Status code: <code>301</code></li>
</ul>
<p><strong>URL:</strong></p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-1
shortcode-codeblock-lua">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-95f629358a27d0fec2701dbefcf70904" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-lua" data-lang="lua"><span class="line"><span class="cl"><span class="n">concat</span><span class="p">(</span><span class="s2">&#34;https://sub.&#34;</span><span class="p">,</span> <span class="n">http.host</span><span class="p">,</span> <span class="n">substring</span><span class="p">(</span><span class="n">http.request</span><span class="p">.</span><span class="n">uri.path</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-95f629358a27d0fec2701dbefcf70904"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<p>Число в функции <code>substring()</code> - это количество символов в названии директории <code>sub</code> + 1 символ.</p>

        </div>
      </div>
    </div>






    
    <div class="accordion-item">
      <div class="accordion-header">
        <a class="accordion-button collapsed" href="#" role="button" tabindex="0"
           data-bs-toggle="collapse" data-bs-target="#sc-8810abc7a59ea10aa3748dc34cd97bc8"
           aria-expanded="false" aria-controls="sc-8810abc7a59ea10aa3748dc34cd97bc8" aria-label="example.com/contact-us/ | example.com/contact/">
            example.com/contact-us/ | example.com/contact/
        </a>
      </div>
      <div class="accordion-collapse collapse" id="sc-8810abc7a59ea10aa3748dc34cd97bc8" data-bs-parent="#sc-a8ec36334fe29993bc73f5d4b48c1c5e">
        <div class="accordion-body">
            <p><code>https://example.com/contact-us/</code> <code>-&gt;</code> <code>https://example.com/contact/</code></p>
<p><strong>When incoming requests match:</strong></p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-0
shortcode-codeblock-lua">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-6f8bd0f5cbb98a47c0b9ab6e7723270e" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-lua" data-lang="lua"><span class="line"><span class="cl"><span class="p">(</span><span class="n">http.request</span><span class="p">.</span><span class="n">uri.path</span> <span class="n">eq</span> <span class="s2">&#34;/contact-us/&#34;</span><span class="p">)</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-6f8bd0f5cbb98a47c0b9ab6e7723270e"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<p><strong>Then&hellip;</strong></p>
<ul>
<li>Type: <code>Static</code></li>
<li>Status code: <code>301</code></li>
</ul>
<p><strong>URL:</strong></p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-1
shortcode-codeblock-lua">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-634315639f7dadd5057f2a8378139c40" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-lua" data-lang="lua"><span class="line"><span class="cl"><span class="o">/</span><span class="n">contacts</span><span class="o">/</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-634315639f7dadd5057f2a8378139c40"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>



        </div>
      </div>
    </div>



</div>

<h4 id="порты">
  <a class="link-body-emphasis" href="#%d0%bf%d0%be%d1%80%d1%82%d1%8b">Порты</a>
</h4><p>Переадресация в зависимости от запроса, пришедшего на определённый порт.</p>


<div class="accordion mb-3 shortcode shortcode-accordion" id="sc-f219ae2813b1772c6cb60161e095a344">
    




    
    <div class="accordion-item">
      <div class="accordion-header">
        <a class="accordion-button collapsed" href="#" role="button" tabindex="0"
           data-bs-toggle="collapse" data-bs-target="#sc-3965b408924925c2a8011129f92ed793"
           aria-expanded="false" aria-controls="sc-3965b408924925c2a8011129f92ed793" aria-label="Переадресовать запрос к любым портам (кроме &#39;80&#39; и &#39;443&#39;) на порт &#39;443&#39; (HTTPS)">
            Переадресовать запрос к любым портам (кроме &#39;80&#39; и &#39;443&#39;) на порт &#39;443&#39; (HTTPS)
        </a>
      </div>
      <div class="accordion-collapse collapse" id="sc-3965b408924925c2a8011129f92ed793" data-bs-parent="#sc-f219ae2813b1772c6cb60161e095a344">
        <div class="accordion-body">
            <p><code>https://example.com:1212</code> <code>-&gt;</code> <code>https://example.com</code></p>
<p><strong>When incoming requests match:</strong></p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-0
shortcode-codeblock-lua">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-fdfb40773c0719cbc902d13779d387e8" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-lua" data-lang="lua"><span class="line"><span class="cl"><span class="p">(</span><span class="ow">not</span> <span class="p">(</span><span class="n">cf.edge</span><span class="p">.</span><span class="n">server_port</span> <span class="kr">in</span> <span class="p">{</span><span class="mi">80</span> <span class="mi">443</span><span class="p">}))</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-fdfb40773c0719cbc902d13779d387e8"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<p><strong>Then&hellip;</strong></p>
<ul>
<li>Type: <code>Dynamic</code></li>
<li>Status code: <code>301</code></li>
</ul>
<p><strong>URL:</strong></p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-1
shortcode-codeblock-lua">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-11dc88f59bf94b09104aa59c2cf39c28" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-lua" data-lang="lua"><span class="line"><span class="cl"><span class="n">concat</span><span class="p">(</span><span class="s2">&#34;https://&#34;</span><span class="p">,</span> <span class="n">http.host</span><span class="p">,</span> <span class="n">http.request</span><span class="p">.</span><span class="n">uri.path</span><span class="p">)</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-11dc88f59bf94b09104aa59c2cf39c28"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>



        </div>
      </div>
    </div>



</div>

<h4 id="страны">
  <a class="link-body-emphasis" href="#%d1%81%d1%82%d1%80%d0%b0%d0%bd%d1%8b">Страны</a>
</h4><p>Переадресация в зависимости от страны клиента.</p>


<div class="accordion mb-3 shortcode shortcode-accordion" id="sc-0987ff57b5bf0e6cf679bde17b1f2724">
    




    
    <div class="accordion-item">
      <div class="accordion-header">
        <a class="accordion-button collapsed" href="#" role="button" tabindex="0"
           data-bs-toggle="collapse" data-bs-target="#sc-bf68d3523f9c3b8152978505328ff2c9"
           aria-expanded="false" aria-controls="sc-bf68d3523f9c3b8152978505328ff2c9" aria-label="Переадресовать пользователей из стран RU/BY/UA в директорию &#39;/ru&#39;">
            Переадресовать пользователей из стран RU/BY/UA в директорию &#39;/ru&#39;
        </a>
      </div>
      <div class="accordion-collapse collapse" id="sc-bf68d3523f9c3b8152978505328ff2c9" data-bs-parent="#sc-0987ff57b5bf0e6cf679bde17b1f2724">
        <div class="accordion-body">
            <p><code>https://example.com</code> <code>-&gt;</code> <code>https://example.com/ru/</code></p>
<p><strong>When incoming requests match:</strong></p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-0
shortcode-codeblock-lua">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-0750642c35e09183d96dbec116837a0a" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-lua" data-lang="lua"><span class="line"><span class="cl"><span class="p">(((</span><span class="n">ip.src</span><span class="p">.</span><span class="n">country</span> <span class="n">eq</span> <span class="s2">&#34;RU&#34;</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="n">ip.src</span><span class="p">.</span><span class="n">country</span> <span class="n">eq</span> <span class="s2">&#34;BY&#34;</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="n">ip.src</span><span class="p">.</span><span class="n">country</span> <span class="n">eq</span> <span class="s2">&#34;UA&#34;</span><span class="p">))</span> <span class="ow">and</span> <span class="p">(</span><span class="n">http.request</span><span class="p">.</span><span class="n">uri.path</span> <span class="n">eq</span> <span class="s2">&#34;/&#34;</span><span class="p">))</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-0750642c35e09183d96dbec116837a0a"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<p><strong>Then&hellip;</strong></p>
<ul>
<li>Type: <code>Dynamic</code></li>
<li>Status code: <code>301</code></li>
</ul>
<p><strong>URL:</strong></p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-1
shortcode-codeblock-lua">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-cc1122a6841b2ae43d0438a14b497180" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-lua" data-lang="lua"><span class="line"><span class="cl"><span class="n">lower</span><span class="p">(</span><span class="n">concat</span><span class="p">(</span><span class="s2">&#34;https://&#34;</span><span class="p">,</span> <span class="n">http.host</span><span class="p">,</span> <span class="s2">&#34;/ru/&#34;</span><span class="p">))</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-cc1122a6841b2ae43d0438a14b497180"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>



        </div>
      </div>
    </div>






    
    <div class="accordion-item">
      <div class="accordion-header">
        <a class="accordion-button collapsed" href="#" role="button" tabindex="0"
           data-bs-toggle="collapse" data-bs-target="#sc-aa3eff0706da91e3dba6573ebb1332a7"
           aria-expanded="false" aria-controls="sc-aa3eff0706da91e3dba6573ebb1332a7" aria-label="Переадресовать пользователей НЕ из стран RU/BY/UA в директорию &#39;/en&#39;">
            Переадресовать пользователей НЕ из стран RU/BY/UA в директорию &#39;/en&#39;
        </a>
      </div>
      <div class="accordion-collapse collapse" id="sc-aa3eff0706da91e3dba6573ebb1332a7" data-bs-parent="#sc-0987ff57b5bf0e6cf679bde17b1f2724">
        <div class="accordion-body">
            <p><code>https://example.com</code> <code>-&gt;</code> <code>https://example.com/en/</code></p>
<p><strong>When incoming requests match:</strong></p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-0
shortcode-codeblock-lua">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-73f03823eddab887a37f0f10e4cc8c0e" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-lua" data-lang="lua"><span class="line"><span class="cl"><span class="p">(((</span><span class="n">ip.src</span><span class="p">.</span><span class="n">country</span> <span class="n">ne</span> <span class="s2">&#34;RU&#34;</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="n">ip.src</span><span class="p">.</span><span class="n">country</span> <span class="n">ne</span> <span class="s2">&#34;BY&#34;</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="n">ip.src</span><span class="p">.</span><span class="n">country</span> <span class="n">ne</span> <span class="s2">&#34;UA&#34;</span><span class="p">))</span> <span class="ow">and</span> <span class="p">(</span><span class="n">http.request</span><span class="p">.</span><span class="n">uri.path</span> <span class="n">eq</span> <span class="s2">&#34;/&#34;</span><span class="p">))</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-73f03823eddab887a37f0f10e4cc8c0e"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<p><strong>Then&hellip;</strong></p>
<ul>
<li>Type: <code>Dynamic</code></li>
<li>Status code: <code>301</code></li>
</ul>
<p><strong>URL:</strong></p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-1
shortcode-codeblock-lua">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-4a0ca9b5d8cc192e6be9dd8cec7a18f5" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-lua" data-lang="lua"><span class="line"><span class="cl"><span class="n">lower</span><span class="p">(</span><span class="n">concat</span><span class="p">(</span><span class="s2">&#34;https://&#34;</span><span class="p">,</span> <span class="n">http.host</span><span class="p">,</span> <span class="s2">&#34;/en/&#34;</span><span class="p">))</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-4a0ca9b5d8cc192e6be9dd8cec7a18f5"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>



        </div>
      </div>
    </div>



</div>]]></turbo:content></item><item turbo="true"><title>Работа с переменной среды окружения PATH</title><link>https://lib.onl/ru/2023/10/1f062637-3227-56d7-93e3-126d1c80f5a8/</link><pubDate>Sat, 28 Oct 2023 12:27:07 +0000</pubDate><dc:creator>Kai Kimera</dc:creator><category>MS Windows</category><category>Терминал</category><category>Скрипты</category><yandex:related><link url="https://lib.onl/ru/2023/10/eb39e3f7-b194-53d4-8bad-01edf9fdac47/">Дефрагментация в ОС Windows</link><link url="https://lib.onl/ru/2023/10/fb64d665-3e56-5fa5-a9eb-2e2e251949d8/">Автоматическая настройка Windows Server 2022 под рабочую станцию</link><link url="https://lib.onl/ru/2023/10/38fc94dd-8d37-5f9e-b556-676304976a9f/">Восстановление доверительных отношений между PC и Active Directory</link><link url="https://lib.onl/ru/2023/10/616da78a-eb16-575a-9119-65f0c0c7baee/">Изменение порта RDP</link><link url="https://lib.onl/ru/2023/10/c6e32349-8fc2-53f9-9a42-790878a64076/">PowerShell: Полезные функции</link><link url="https://lib.onl/ru/2023/10/52d75b90-0637-5ba6-91d6-b1bff40e1d67/">PowerShell: Стирание диска</link><link url="https://lib.onl/ru/2023/10/2a73410a-6611-570c-9ab4-dc8cc8998146/">PowerShell: Сжатие видео при помощи FFmpeg</link><link url="https://lib.onl/ru/2023/10/0028821e-c96c-5014-a1dd-8963c161b170/">PowerShell: Определение разрядности ОС Windows</link><link url="https://lib.onl/ru/2023/10/4c7aba7c-f5a6-589a-9975-fdb16f2e2862/">PowerShell Vault</link><link url="https://lib.onl/ru/2023/10/75075788-9308-56b7-b531-2008cb35f7d0/">Установка сертификата НУЦ Минцифры</link><link url="https://lib.onl/ru/2023/09/dd5a3e1a-596b-50d5-b070-b2a065f99f32/">Получение и установка MS Office 2021 LTSC</link><link url="https://lib.onl/ru/2022/05/862226e6-cbb1-58f8-bc8e-0cfef747f475/">Интеграция обновлений в дистрибутив ОС MS Windows</link><link url="https://lib.onl/ru/2022/05/36058650-3f35-5ed5-9565-0aa7d8800c28/">Windows Server 2022 для рабочей станции</link></yandex:related><turbo:extendedHtml>true</turbo:extendedHtml><turbo:source>https://lib.onl/ru/2023/10/1f062637-3227-56d7-93e3-126d1c80f5a8/</turbo:source><turbo:topic>Работа с переменной среды окружения PATH</turbo:topic><turbo:content><![CDATA[<p>Переменная <code>Path</code> является переменной среды окружения, при помощи которой ОС <span class="shortcode shortcode-tag"><a href="/ru/tags/windows/" target="_blank">#Windows</a></span> находит нужные приложения в терминале. Рассмотрим способы редактирования значений этой переменной.</p>
<p>Проще говоря, в переменную <code>Path</code> можно добавлять пути к директориям приложений, для того чтобы при работе в терминале не прописывать полные пути к исполняемым файлам этих приложений. Например, в терминале, чтобы вызвать <span class="shortcode shortcode-tag"><a href="/ru/tags/git/" target="_blank">#Git</a></span> и зафиксировать изменения нужно ввести <code>C:\Apps\Git\git.exe commit -m 'bla-bla'</code>. Но если добавить значение <code>C:\Apps\Git</code> в переменную <code>Path</code>, то в терминале можно просто писать <code>git.exe commit -m 'bla-bla'</code>, больше не нужно указывать полный путь к Git&rsquo;у.</p>
<h2 id="уровни-переменной-path">
  <a class="link-body-emphasis" href="#%d1%83%d1%80%d0%be%d0%b2%d0%bd%d0%b8-%d0%bf%d0%b5%d1%80%d0%b5%d0%bc%d0%b5%d0%bd%d0%bd%d0%be%d0%b9-path">Уровни переменной <code>Path</code></a>
</h2><p>Существует два уровня переменной <code>Path</code>:</p>
<ul>
<li>Системный - является глобальным и его значения доступны для каждого аккаунта пользователя.</li>
<li>Пользовательский - работает в контексте конкретного аккаунта и содержит значения только этого пользователя. Под другим аккаунтом, переменная на пользовательском уровне может содержать другие значения.</li>
</ul>
<p>В пределах аккаунта пользователя эти два уровня переменной <code>Path</code> объединяют свои значения.</p>
<h2 id="добавление-значений-в-переменную-path">
  <a class="link-body-emphasis" href="#%d0%b4%d0%be%d0%b1%d0%b0%d0%b2%d0%bb%d0%b5%d0%bd%d0%b8%d0%b5-%d0%b7%d0%bd%d0%b0%d1%87%d0%b5%d0%bd%d0%b8%d0%b9-%d0%b2-%d0%bf%d0%b5%d1%80%d0%b5%d0%bc%d0%b5%d0%bd%d0%bd%d1%83%d1%8e-path">Добавление значений в переменную <code>Path</code></a>
</h2><p>Добавить свои значения в переменную <code>Path</code> можно несколькими способами:</p>
<ul>
<li>Графический интерфейс ОС.</li>
<li>Команда в CMD при помощи утилиты <code>setx</code>.</li>
<li>Команда в PowerShell.</li>
</ul>
<p>Значения в переменной <code>Path</code> разделяются символом <code>;</code>.</p>
<p>Так как я приверженец работы в терминале и считаю, что каждый администратор должен уметь работать с командной строкой, то привожу только два последних способа.</p>
<h3 id="командная-строка-cmd">
  <a class="link-body-emphasis" href="#%d0%ba%d0%be%d0%bc%d0%b0%d0%bd%d0%b4%d0%bd%d0%b0%d1%8f-%d1%81%d1%82%d1%80%d0%be%d0%ba%d0%b0-cmd">Командная строка CMD</a>
</h3><p>Управление переменными среды окружения в <span class="shortcode shortcode-tag"><a href="/ru/tags/cmd/" target="_blank">#CMD</a></span> происходит при помощи утилиты <code>setx</code>.</p>
<h4 id="системный-уровень">
  <a class="link-body-emphasis" href="#%d1%81%d0%b8%d1%81%d1%82%d0%b5%d0%bc%d0%bd%d1%8b%d0%b9-%d1%83%d1%80%d0%be%d0%b2%d0%b5%d0%bd%d1%8c">Системный уровень</a>
</h4><p>Чтобы добавить свои значения в переменную <code>Path</code> на системном уровне, необходимо указать ключ <code>/m</code>:</p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-0
shortcode-codeblock-bat">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-c75983eb279cffd72e86cea6c7e87dec" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bat" data-lang="bat"><span class="line"><span class="cl">setx /m Path <span class="s2">&#34;</span><span class="nv">%Path%</span><span class="s2">C:\Apps\App_01;C:\Apps\App_02&#34;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-c75983eb279cffd72e86cea6c7e87dec"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>






    












    
    


<div class="shortcode shortcode-alert">
  <div class="alert alert-danger d-flex overflow-hidden" role="alert">
    <div class="flex-shrink-0 align-self-center">
      <i class="fas fa-circle-radiation fa-fw fa-2x"></i>
    </div>
    <div class="flex-grow-1 ms-3 overflow-hidden">
        <p>Ни в коем случае нельзя прописывать в <code>setx</code> свои значения БЕЗ вызова переменной <code>Path</code>: при такой команде утилита <code>setx</code> обнулит все существующие значения в <code>Path</code> и запишет указанные вами. А значения, добавленные программами, пропадут.</p>
<p>Правильная команда должны быть такой:</p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-0
shortcode-codeblock-bat">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-94da61b5ba96ef969e5f9fa096f3516d" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bat" data-lang="bat"><span class="line"><span class="cl">setx /m Path <span class="s2">&#34;</span><span class="nv">%Path%</span><span class="s2">C:\MyCustomDir&#34;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-94da61b5ba96ef969e5f9fa096f3516d"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<p>Здесь мы заранее вызываем переменную <code>Path</code> конструкцией <code>%Path%</code>, которая добавит существующие значения к вашим и всё это дело пропишется утилитой <code>setx</code> обратно в <code>Path</code>.</p>

    </div>
  </div>
</div>

<p>Необходимости в скрипте, который добавляет значения в переменную <code>Path</code> на системном уровне, нет. Но я всё же его написал, пусть будет.</p>

    

    
        
            
            <div class="shortcode shortcode-file mb-3">
              <div class="card overflow-hidden" data-bs-theme="dark">
                <div class="card-header">
                  <div class="d-flex align-items-center">
                    <div class="flex-shrink-0">
                      <i class="far fa-file-code fa-fw"></i>
                    </div>
                    <div class="flex-grow-1 mx-2 text-truncate">
                      <code>cmd.set.env.path.system.bat</code>
                    </div>
                    <div class="flex-shrink-0">
                      <ul class="list-inline mb-0">
                        <li class="list-inline-item" title='Копировать'>
                          <a class="text-body" href="#"
                             data-fn="clipboard" data-clipboard-target="#cp-826298dd211110bbc30bec0680af14b9"
                             role="button" aria-label='Копировать'>
                            <i class="fas fa-copy fa-fw"></i>
                          </a>
                        </li>
                        <li class="list-inline-item" title='Скачать'>
                          <a class="text-body" href="/ru/2023/10/1f062637-3227-56d7-93e3-126d1c80f5a8/cmd.set.env.path.system.bat" download
                             role="button" aria-label='Скачать'>
                            <i class="fas fa-download fa-fw"></i>
                          </a>
                        </li>
                        <li class="list-inline-item" title='Открыть'>
                          <a class="text-body" href="/ru/2023/10/1f062637-3227-56d7-93e3-126d1c80f5a8/cmd.set.env.path.system.bat" target="_blank"
                             role="button" aria-label='Открыть'>
                            <i class="fas fa-arrow-up-right-from-square fa-fw"></i>
                          </a>
                        </li>
                      </ul>
                    </div>
                  </div>
                </div>
                <div class="card-body p-0 overflow-auto" id="cp-826298dd211110bbc30bec0680af14b9">
                    
                        
                    
                    <div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bat" data-lang="bat"><span class="line"><span class="cl"><span class="c1">rem # Setting PATH variable for system.</span>
</span></span><span class="line"><span class="cl"><span class="c1">rem #</span>
</span></span><span class="line"><span class="cl"><span class="c1">rem # @package   CMD</span>
</span></span><span class="line"><span class="cl"><span class="c1">rem # @author    Kai Kimera &lt;mail@kai.kim&gt;</span>
</span></span><span class="line"><span class="cl"><span class="c1">rem # @copyright 2023 Library Online</span>
</span></span><span class="line"><span class="cl"><span class="c1">rem # @license   MIT</span>
</span></span><span class="line"><span class="cl"><span class="c1">rem # @version   0.1.0</span>
</span></span><span class="line"><span class="cl"><span class="c1">rem # @link      https://lib.onl/ru/2023/10/1f062637-3227-56d7-93e3-126d1c80f5a8/</span>
</span></span><span class="line"><span class="cl"><span class="c1">rem # ---------------------------------------------------------------------------------------------------------------- #</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="p">@</span><span class="k">echo</span> off
</span></span><span class="line"><span class="cl"><span class="k">setLocal</span> EnableDelayedExpansion
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">rem Custom PATH.</span>
</span></span><span class="line"><span class="cl"><span class="k">set</span> <span class="s2">&#34;pathArray=C:\Apps\App_01 C:\Apps\App_02 C:\Apps\App_03&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">rem Building a system PATH variable.</span>
</span></span><span class="line"><span class="cl"><span class="k">for</span> <span class="se">%%</span>p <span class="k">in</span> <span class="p">(</span> <span class="nv">%pathArray%</span> <span class="p">)</span> <span class="k">do</span> <span class="p">(</span> <span class="k">set</span> <span class="s2">&#34;pathCustom=</span><span class="se">%%</span><span class="s2">p;!pathCustom!&#34;</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">rem Setting a new PATH variable.</span>
</span></span><span class="line"><span class="cl">setx /m Path <span class="s2">&#34;</span><span class="nv">%Path%!pathCustom!</span><span class="s2">&#34;</span></span></span></code></pre></td></tr></table>
</div>
</div>
                </div>
              </div>
            </div>
        
    
<p>В переменной <code>pathArray</code> указывается массив из путей, которые необходимо добавить в <code>Path</code> на системном уровне.</p>
<h4 id="пользовательский-уровень">
  <a class="link-body-emphasis" href="#%d0%bf%d0%be%d0%bb%d1%8c%d0%b7%d0%be%d0%b2%d0%b0%d1%82%d0%b5%d0%bb%d1%8c%d1%81%d0%ba%d0%b8%d0%b9-%d1%83%d1%80%d0%be%d0%b2%d0%b5%d0%bd%d1%8c">Пользовательский уровень</a>
</h4><p>Добавить свои значения в переменную <code>Path</code> на пользовательском уровне:</p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-1
shortcode-codeblock-bat">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-467a099d360350995dbfbc2fef74db60" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bat" data-lang="bat"><span class="line"><span class="cl">setx Path <span class="s2">&#34;</span><span class="nv">%Path%</span><span class="s2">C:\Apps\App_01;C:\Apps\App_02&#34;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-467a099d360350995dbfbc2fef74db60"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<p>Но есть одна особенность: так как переменная <code>Path</code> объединяет значения системного и пользовательского уровней, то при такой команде, утилита <code>setx</code> пропишет в <code>Path</code> пользовательского уровня все значения из системного. Таким образом, получится дублирование содержимого <code>Path</code> системного уровня в пользовательском. Это не критично, но можно сделать более элегантно&hellip;</p>
<p>Для того, чтобы обойти вышеуказанную особенность, необходимо написать скрипт, который будет при вызове переменной <code>Path</code> вырезать из неё значения системного уровня. Собственно, скрипт я написал.</p>

    

    
        
            
            <div class="shortcode shortcode-file mb-3">
              <div class="card overflow-hidden" data-bs-theme="dark">
                <div class="card-header">
                  <div class="d-flex align-items-center">
                    <div class="flex-shrink-0">
                      <i class="far fa-file-code fa-fw"></i>
                    </div>
                    <div class="flex-grow-1 mx-2 text-truncate">
                      <code>cmd.set.env.path.user.bat</code>
                    </div>
                    <div class="flex-shrink-0">
                      <ul class="list-inline mb-0">
                        <li class="list-inline-item" title='Копировать'>
                          <a class="text-body" href="#"
                             data-fn="clipboard" data-clipboard-target="#cp-33d2f6af7b1f4893be0c89a8ecdf52b2"
                             role="button" aria-label='Копировать'>
                            <i class="fas fa-copy fa-fw"></i>
                          </a>
                        </li>
                        <li class="list-inline-item" title='Скачать'>
                          <a class="text-body" href="/ru/2023/10/1f062637-3227-56d7-93e3-126d1c80f5a8/cmd.set.env.path.user.bat" download
                             role="button" aria-label='Скачать'>
                            <i class="fas fa-download fa-fw"></i>
                          </a>
                        </li>
                        <li class="list-inline-item" title='Открыть'>
                          <a class="text-body" href="/ru/2023/10/1f062637-3227-56d7-93e3-126d1c80f5a8/cmd.set.env.path.user.bat" target="_blank"
                             role="button" aria-label='Открыть'>
                            <i class="fas fa-arrow-up-right-from-square fa-fw"></i>
                          </a>
                        </li>
                      </ul>
                    </div>
                  </div>
                </div>
                <div class="card-body p-0 overflow-auto" id="cp-33d2f6af7b1f4893be0c89a8ecdf52b2">
                    
                        
                    
                    <div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bat" data-lang="bat"><span class="line"><span class="cl"><span class="c1">rem # Setting PATH variable for user.</span>
</span></span><span class="line"><span class="cl"><span class="c1">rem #</span>
</span></span><span class="line"><span class="cl"><span class="c1">rem # @package   CMD</span>
</span></span><span class="line"><span class="cl"><span class="c1">rem # @author    Kai Kimera &lt;mail@kai.kim&gt;</span>
</span></span><span class="line"><span class="cl"><span class="c1">rem # @copyright 2023 Library Online</span>
</span></span><span class="line"><span class="cl"><span class="c1">rem # @license   MIT</span>
</span></span><span class="line"><span class="cl"><span class="c1">rem # @version   0.1.0</span>
</span></span><span class="line"><span class="cl"><span class="c1">rem # @link      https://lib.onl/ru/2023/10/1f062637-3227-56d7-93e3-126d1c80f5a8/</span>
</span></span><span class="line"><span class="cl"><span class="c1">rem # ---------------------------------------------------------------------------------------------------------------- #</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="p">@</span><span class="k">echo</span> off
</span></span><span class="line"><span class="cl"><span class="k">setLocal</span> EnableDelayedExpansion
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">rem Custom PATH.</span>
</span></span><span class="line"><span class="cl"><span class="k">set</span> <span class="s2">&#34;pathArray=C:\Apps\App_01 C:\Apps\App_02 C:\Apps\App_03&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">rem Getting the current PATH variable.</span>
</span></span><span class="line"><span class="cl"><span class="k">for</span> <span class="k">/f</span> <span class="s2">&#34;tokens=2,*&#34;</span> <span class="se">%%</span>a <span class="k">in</span> <span class="p">(</span> <span class="s1">&#39;reg query HKCU\Environment /v Path&#39;</span> <span class="p">)</span> <span class="k">do</span> <span class="p">(</span> <span class="k">set</span> <span class="s2">&#34;pathUser=</span><span class="se">%%</span><span class="s2">b&#34;</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">rem Building a user PATH variable.</span>
</span></span><span class="line"><span class="cl"><span class="k">for</span> <span class="se">%%</span>p <span class="k">in</span> <span class="p">(</span> <span class="nv">%pathArray%</span> <span class="p">)</span> <span class="k">do</span> <span class="p">(</span> <span class="k">set</span> <span class="s2">&#34;pathCustom=</span><span class="se">%%</span><span class="s2">p;!pathCustom!&#34;</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">rem Setting a new PATH variable.</span>
</span></span><span class="line"><span class="cl">setx Path <span class="s2">&#34;</span><span class="nv">!pathUser!!pathCustom!</span><span class="s2">&#34;</span></span></span></code></pre></td></tr></table>
</div>
</div>
                </div>
              </div>
            </div>
        
    
<p>В переменной <code>pathArray</code> указывается массив из путей, которые необходимо добавить в <code>Path</code> на пользовательском уровне. При этом, добавление значений из системного уровня не произойдёт. Наша переменная <code>Path</code> пользовательского уровня останется чистенькой и красивой.</p>
<h3 id="терминал-powershell">
  <a class="link-body-emphasis" href="#%d1%82%d0%b5%d1%80%d0%bc%d0%b8%d0%bd%d0%b0%d0%bb-powershell">Терминал PowerShell</a>
</h3><p>В <span class="shortcode shortcode-tag"><a href="/ru/tags/powershell/" target="_blank">#PowerShell</a></span> для управления переменными окружения существуют методы:</p>
<ul>
<li><code>[Environment]::GetEnvironmentVariables()</code> - получение значения переменной среды окружения.</li>
<li><code>[Environment]::SetEnvironmentVariable()</code> - установка значения переменной среды окружения.</li>
</ul>
<h4 id="системный-уровень-1">
  <a class="link-body-emphasis" href="#%d1%81%d0%b8%d1%81%d1%82%d0%b5%d0%bc%d0%bd%d1%8b%d0%b9-%d1%83%d1%80%d0%be%d0%b2%d0%b5%d0%bd%d1%8c-1">Системный уровень</a>
</h4><p>Для добавления значений в переменную <code>Path</code> на системном уровне, я написал небольшой скрипт.</p>

    

    
        
            
            <div class="shortcode shortcode-file mb-3">
              <div class="card overflow-hidden" data-bs-theme="dark">
                <div class="card-header">
                  <div class="d-flex align-items-center">
                    <div class="flex-shrink-0">
                      <i class="far fa-file-code fa-fw"></i>
                    </div>
                    <div class="flex-grow-1 mx-2 text-truncate">
                      <code>pwsh.set.env.path.system.ps1</code>
                    </div>
                    <div class="flex-shrink-0">
                      <ul class="list-inline mb-0">
                        <li class="list-inline-item" title='Копировать'>
                          <a class="text-body" href="#"
                             data-fn="clipboard" data-clipboard-target="#cp-4c54782355a69af026ef6eb716f8f34b"
                             role="button" aria-label='Копировать'>
                            <i class="fas fa-copy fa-fw"></i>
                          </a>
                        </li>
                        <li class="list-inline-item" title='Скачать'>
                          <a class="text-body" href="/ru/2023/10/1f062637-3227-56d7-93e3-126d1c80f5a8/pwsh.set.env.path.system.ps1" download
                             role="button" aria-label='Скачать'>
                            <i class="fas fa-download fa-fw"></i>
                          </a>
                        </li>
                        <li class="list-inline-item" title='Открыть'>
                          <a class="text-body" href="/ru/2023/10/1f062637-3227-56d7-93e3-126d1c80f5a8/pwsh.set.env.path.system.ps1" target="_blank"
                             role="button" aria-label='Открыть'>
                            <i class="fas fa-arrow-up-right-from-square fa-fw"></i>
                          </a>
                        </li>
                      </ul>
                    </div>
                  </div>
                </div>
                <div class="card-body p-0 overflow-auto" id="cp-4c54782355a69af026ef6eb716f8f34b">
                    
                        
                    
                    <div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-ps1" data-lang="ps1"><span class="line"><span class="cl"><span class="cm">&lt;#PSScriptInfo
</span></span></span><span class="line"><span class="cl"><span class="cm">.VERSION      0.1.0
</span></span></span><span class="line"><span class="cl"><span class="cm">.GUID         41643d28-3808-4a6f-a322-d87ed4384d5f
</span></span></span><span class="line"><span class="cl"><span class="cm">.AUTHOR       Kai Kimera
</span></span></span><span class="line"><span class="cl"><span class="cm">.AUTHOREMAIL  mail@kai.kim
</span></span></span><span class="line"><span class="cl"><span class="cm">.COMPANYNAME  Library Online
</span></span></span><span class="line"><span class="cl"><span class="cm">.COPYRIGHT    2023 Library Online. All rights reserved.
</span></span></span><span class="line"><span class="cl"><span class="cm">.LICENSEURI   https://choosealicense.com/licenses/mit/
</span></span></span><span class="line"><span class="cl"><span class="cm">.PROJECTURI   https://lib.onl/ru/2023/10/1f062637-3227-56d7-93e3-126d1c80f5a8/
</span></span></span><span class="line"><span class="cl"><span class="cm">#&gt;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c">#</span><span class="k">Requires</span><span class="w"> </span><span class="kd">-Version</span><span class="na"> 7.2</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c">#</span><span class="k">Requires</span><span class="w"> </span><span class="kd">-RunAsAdministrator</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="cm">&lt;#
</span></span></span><span class="line"><span class="cl"><span class="cm">.</span><span class="sd">SYNOPSIS</span><span class="cm">
</span></span></span><span class="line"><span class="cl"><span class="cm">Setting PATH variable for system.
</span></span></span><span class="line"><span class="cl"><span class="cm">
</span></span></span><span class="line"><span class="cl"><span class="cm">.</span><span class="sd">DESCRIPTION</span><span class="cm">
</span></span></span><span class="line"><span class="cl"><span class="cm">The script configures the PATH variable values for the system.
</span></span></span><span class="line"><span class="cl"><span class="cm">
</span></span></span><span class="line"><span class="cl"><span class="cm">.</span><span class="sd">EXAMPLE</span><span class="cm">
</span></span></span><span class="line"><span class="cl"><span class="cm">.\pwsh.set.env.path.system.ps1 -P &#39;C:\Apps\App_01&#39;, &#39;C:\Apps\App_02&#39;, &#39;C:\Apps\App_03&#39;
</span></span></span><span class="line"><span class="cl"><span class="cm">
</span></span></span><span class="line"><span class="cl"><span class="cm">.</span><span class="sd">LINK</span><span class="cm">
</span></span></span><span class="line"><span class="cl"><span class="cm">https://lib.onl/ru/2023/10/1f062637-3227-56d7-93e3-126d1c80f5a8/
</span></span></span><span class="line"><span class="cl"><span class="cm">#&gt;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">param</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">  <span class="p">[</span><span class="nb">Alias</span><span class="p">(</span><span class="s1">&#39;P&#39;</span><span class="p">)][</span><span class="no">string[]</span><span class="p">]</span><span class="nv">$Path</span>
</span></span><span class="line"><span class="cl"><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kd">function</span><span class="w"> </span><span class="nb">Set-EnvPathSystem</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="nv">$Path</span> <span class="p">|</span> <span class="nb">ForEach-Object</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="p">[</span><span class="no">Environment</span><span class="p">]::</span><span class="n">SetEnvironmentVariable</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">      <span class="s1">&#39;Path&#39;</span><span class="p">,</span> <span class="p">([</span><span class="no">Environment</span><span class="p">]::</span><span class="n">GetEnvironmentVariables</span><span class="p">(</span><span class="s1">&#39;Machine&#39;</span><span class="p">)).</span><span class="py">Path</span> <span class="p">+</span> <span class="s2">&#34;</span><span class="nv">${_}</span><span class="s2">&#34;</span> <span class="p">+</span> <span class="p">[</span><span class="no">IO.Path</span><span class="p">]::</span><span class="n">PathSeparator</span><span class="p">,</span> <span class="s1">&#39;Machine&#39;</span>
</span></span><span class="line"><span class="cl">    <span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nb">Set-EnvPathSystem</span></span></span></code></pre></td></tr></table>
</div>
</div>
                </div>
              </div>
            </div>
        
    
<p>Вызов скрипта осуществляется следующим образом:</p>











<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-2 shortcode-codeblock-terminal
shortcode-codeblock-terminal-windows
shortcode-codeblock-terminal-windows-root">
  <div class="card overflow-hidden" data-bs-theme="dark">
    <div class="card-header">
      <div class="d-flex align-items-center">
        <div class="flex-shrink-0 text-danger">
          <i class="fas fa-terminal fa-fw"></i>
        </div>
        <div class="flex-grow-1 mx-2">
          <h5 class="mb-0">Терминал</h5>
        </div>
        <div class="flex-shrink-0">
          <ul class="list-inline mb-0">
            <li class="list-inline-item" title='Копировать'>
              <a class="text-body" href="#"
                 data-fn="clipboard" data-clipboard-target="#cp-0b3e48194b8d51ac67241495d4ca8ff8"
                 role="button" aria-label='Копировать'>
                <i class="fas fa-copy fa-fw"></i>
              </a>
            </li>
          </ul>
        </div>
      </div>
    </div>
    <div class="card-body p-0 overflow-auto" id="cp-0b3e48194b8d51ac67241495d4ca8ff8"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-plaintext" data-lang="plaintext"><span class="line"><span class="cl">.\pwsh.set.env.path.system.ps1 -P &#39;C:\Apps\App_01&#39;, &#39;C:\Apps\App_02&#39;, &#39;C:\Apps\App_03&#39;</span></span></code></pre></td></tr></table>
</div>
</div></div>
  </div>
</div>
<p>В параметре <code>-P</code> указываются значения, которые необходимо добавить в переменную <code>Path</code> системного уровня.</p>
<h4 id="пользовательский-уровень-1">
  <a class="link-body-emphasis" href="#%d0%bf%d0%be%d0%bb%d1%8c%d0%b7%d0%be%d0%b2%d0%b0%d1%82%d0%b5%d0%bb%d1%8c%d1%81%d0%ba%d0%b8%d0%b9-%d1%83%d1%80%d0%be%d0%b2%d0%b5%d0%bd%d1%8c-1">Пользовательский уровень</a>
</h4><p>А здесь скрипт, который отвечает за добавление в переменную <code>Path</code> значений на пользовательском уровне.</p>

    

    
        
            
            <div class="shortcode shortcode-file mb-3">
              <div class="card overflow-hidden" data-bs-theme="dark">
                <div class="card-header">
                  <div class="d-flex align-items-center">
                    <div class="flex-shrink-0">
                      <i class="far fa-file-code fa-fw"></i>
                    </div>
                    <div class="flex-grow-1 mx-2 text-truncate">
                      <code>pwsh.set.env.path.user.ps1</code>
                    </div>
                    <div class="flex-shrink-0">
                      <ul class="list-inline mb-0">
                        <li class="list-inline-item" title='Копировать'>
                          <a class="text-body" href="#"
                             data-fn="clipboard" data-clipboard-target="#cp-9378ea65b73d4ebd45aaeac0e348b3cd"
                             role="button" aria-label='Копировать'>
                            <i class="fas fa-copy fa-fw"></i>
                          </a>
                        </li>
                        <li class="list-inline-item" title='Скачать'>
                          <a class="text-body" href="/ru/2023/10/1f062637-3227-56d7-93e3-126d1c80f5a8/pwsh.set.env.path.user.ps1" download
                             role="button" aria-label='Скачать'>
                            <i class="fas fa-download fa-fw"></i>
                          </a>
                        </li>
                        <li class="list-inline-item" title='Открыть'>
                          <a class="text-body" href="/ru/2023/10/1f062637-3227-56d7-93e3-126d1c80f5a8/pwsh.set.env.path.user.ps1" target="_blank"
                             role="button" aria-label='Открыть'>
                            <i class="fas fa-arrow-up-right-from-square fa-fw"></i>
                          </a>
                        </li>
                      </ul>
                    </div>
                  </div>
                </div>
                <div class="card-body p-0 overflow-auto" id="cp-9378ea65b73d4ebd45aaeac0e348b3cd">
                    
                        
                    
                    <div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-ps1" data-lang="ps1"><span class="line"><span class="cl"><span class="cm">&lt;#PSScriptInfo
</span></span></span><span class="line"><span class="cl"><span class="cm">.VERSION      0.1.0
</span></span></span><span class="line"><span class="cl"><span class="cm">.GUID         79f23918-308a-412c-8835-b1bb9c9193e3
</span></span></span><span class="line"><span class="cl"><span class="cm">.AUTHOR       Kai Kimera
</span></span></span><span class="line"><span class="cl"><span class="cm">.AUTHOREMAIL  mail@kai.kim
</span></span></span><span class="line"><span class="cl"><span class="cm">.COMPANYNAME  Library Online
</span></span></span><span class="line"><span class="cl"><span class="cm">.COPYRIGHT    2023 Library Online. All rights reserved.
</span></span></span><span class="line"><span class="cl"><span class="cm">.LICENSEURI   https://choosealicense.com/licenses/mit/
</span></span></span><span class="line"><span class="cl"><span class="cm">.PROJECTURI   https://lib.onl/ru/2023/10/1f062637-3227-56d7-93e3-126d1c80f5a8/
</span></span></span><span class="line"><span class="cl"><span class="cm">#&gt;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c">#</span><span class="k">Requires</span><span class="w"> </span><span class="kd">-Version</span><span class="na"> 7.2</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="cm">&lt;#
</span></span></span><span class="line"><span class="cl"><span class="cm">.</span><span class="sd">SYNOPSIS</span><span class="cm">
</span></span></span><span class="line"><span class="cl"><span class="cm">Setting PATH variable for user.
</span></span></span><span class="line"><span class="cl"><span class="cm">
</span></span></span><span class="line"><span class="cl"><span class="cm">.</span><span class="sd">DESCRIPTION</span><span class="cm">
</span></span></span><span class="line"><span class="cl"><span class="cm">The script configures the PATH variable values for the user.
</span></span></span><span class="line"><span class="cl"><span class="cm">
</span></span></span><span class="line"><span class="cl"><span class="cm">.</span><span class="sd">EXAMPLE</span><span class="cm">
</span></span></span><span class="line"><span class="cl"><span class="cm">.\pwsh.set.env.path.user.ps1 -P &#39;C:\Apps\App_01&#39;, &#39;C:\Apps\App_02&#39;, &#39;C:\Apps\App_03&#39;
</span></span></span><span class="line"><span class="cl"><span class="cm">
</span></span></span><span class="line"><span class="cl"><span class="cm">.</span><span class="sd">LINK</span><span class="cm">
</span></span></span><span class="line"><span class="cl"><span class="cm">https://lib.onl/ru/2023/10/1f062637-3227-56d7-93e3-126d1c80f5a8/
</span></span></span><span class="line"><span class="cl"><span class="cm">#&gt;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">param</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">  <span class="p">[</span><span class="nb">Alias</span><span class="p">(</span><span class="s1">&#39;P&#39;</span><span class="p">)][</span><span class="no">string[]</span><span class="p">]</span><span class="nv">$Path</span>
</span></span><span class="line"><span class="cl"><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kd">function</span><span class="w"> </span><span class="nb">Set-EnvPathUser</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="nv">$Path</span> <span class="p">|</span> <span class="nb">ForEach-Object</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="p">[</span><span class="no">Environment</span><span class="p">]::</span><span class="n">SetEnvironmentVariable</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">      <span class="s1">&#39;Path&#39;</span><span class="p">,</span> <span class="p">([</span><span class="no">Environment</span><span class="p">]::</span><span class="n">GetEnvironmentVariables</span><span class="p">(</span><span class="s1">&#39;User&#39;</span><span class="p">)).</span><span class="py">Path</span> <span class="p">+</span> <span class="s2">&#34;</span><span class="nv">${_}</span><span class="s2">&#34;</span> <span class="p">+</span> <span class="p">[</span><span class="no">IO.Path</span><span class="p">]::</span><span class="n">PathSeparator</span><span class="p">,</span> <span class="s1">&#39;User&#39;</span>
</span></span><span class="line"><span class="cl">    <span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nb">Set-EnvPathUser</span></span></span></code></pre></td></tr></table>
</div>
</div>
                </div>
              </div>
            </div>
        
    
<p>Вызов скрипта осуществляется следующим образом:</p>











<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-3 shortcode-codeblock-terminal
shortcode-codeblock-terminal-windows
shortcode-codeblock-terminal-windows-user">
  <div class="card overflow-hidden" data-bs-theme="dark">
    <div class="card-header">
      <div class="d-flex align-items-center">
        <div class="flex-shrink-0 ">
          <i class="fas fa-terminal fa-fw"></i>
        </div>
        <div class="flex-grow-1 mx-2">
          <h5 class="mb-0">Терминал</h5>
        </div>
        <div class="flex-shrink-0">
          <ul class="list-inline mb-0">
            <li class="list-inline-item" title='Копировать'>
              <a class="text-body" href="#"
                 data-fn="clipboard" data-clipboard-target="#cp-accd4744015d90e5cf21178e6be19765"
                 role="button" aria-label='Копировать'>
                <i class="fas fa-copy fa-fw"></i>
              </a>
            </li>
          </ul>
        </div>
      </div>
    </div>
    <div class="card-body p-0 overflow-auto" id="cp-accd4744015d90e5cf21178e6be19765"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-plaintext" data-lang="plaintext"><span class="line"><span class="cl">.\pwsh.set.env.path.user.ps1 -P &#39;C:\Apps\App_01&#39;, &#39;C:\Apps\App_02&#39;, &#39;C:\Apps\App_03&#39;</span></span></code></pre></td></tr></table>
</div>
</div></div>
  </div>
</div>
<p>В параметре <code>-P</code> указываются значения, которые необходимо добавить в переменную <code>Path</code> пользовательского уровня.</p>
<h4 id="общий-скрипт">
  <a class="link-body-emphasis" href="#%d0%be%d0%b1%d1%89%d0%b8%d0%b9-%d1%81%d0%ba%d1%80%d0%b8%d0%bf%d1%82">Общий скрипт</a>
</h4><p>Не знаю, почему я сразу не написал общий скрипт для всех уровней&hellip; Решил под завершение статьи реализовать подобную штуку.</p>

    

    
        
            
            <div class="shortcode shortcode-file mb-3">
              <div class="card overflow-hidden" data-bs-theme="dark">
                <div class="card-header">
                  <div class="d-flex align-items-center">
                    <div class="flex-shrink-0">
                      <i class="far fa-file-code fa-fw"></i>
                    </div>
                    <div class="flex-grow-1 mx-2 text-truncate">
                      <code>pwsh.set.env.path.ps1</code>
                    </div>
                    <div class="flex-shrink-0">
                      <ul class="list-inline mb-0">
                        <li class="list-inline-item" title='Копировать'>
                          <a class="text-body" href="#"
                             data-fn="clipboard" data-clipboard-target="#cp-4b2c14a905eefeccdcb30e4f10cb3efd"
                             role="button" aria-label='Копировать'>
                            <i class="fas fa-copy fa-fw"></i>
                          </a>
                        </li>
                        <li class="list-inline-item" title='Скачать'>
                          <a class="text-body" href="/ru/2023/10/1f062637-3227-56d7-93e3-126d1c80f5a8/pwsh.set.env.path.ps1" download
                             role="button" aria-label='Скачать'>
                            <i class="fas fa-download fa-fw"></i>
                          </a>
                        </li>
                        <li class="list-inline-item" title='Открыть'>
                          <a class="text-body" href="/ru/2023/10/1f062637-3227-56d7-93e3-126d1c80f5a8/pwsh.set.env.path.ps1" target="_blank"
                             role="button" aria-label='Открыть'>
                            <i class="fas fa-arrow-up-right-from-square fa-fw"></i>
                          </a>
                        </li>
                      </ul>
                    </div>
                  </div>
                </div>
                <div class="card-body p-0 overflow-auto" id="cp-4b2c14a905eefeccdcb30e4f10cb3efd">
                    
                        
                    
                    <div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-ps1" data-lang="ps1"><span class="line"><span class="cl"><span class="cm">&lt;#PSScriptInfo
</span></span></span><span class="line"><span class="cl"><span class="cm">.VERSION      0.1.0
</span></span></span><span class="line"><span class="cl"><span class="cm">.GUID         14efdc7d-1edd-4b40-b6d2-623288ce1659
</span></span></span><span class="line"><span class="cl"><span class="cm">.AUTHOR       Kai Kimera
</span></span></span><span class="line"><span class="cl"><span class="cm">.AUTHOREMAIL  mail@kai.kim
</span></span></span><span class="line"><span class="cl"><span class="cm">.COMPANYNAME  Library Online
</span></span></span><span class="line"><span class="cl"><span class="cm">.COPYRIGHT    2023 Library Online. All rights reserved.
</span></span></span><span class="line"><span class="cl"><span class="cm">.LICENSEURI   https://choosealicense.com/licenses/mit/
</span></span></span><span class="line"><span class="cl"><span class="cm">.PROJECTURI   https://lib.onl/ru/2023/10/1f062637-3227-56d7-93e3-126d1c80f5a8/
</span></span></span><span class="line"><span class="cl"><span class="cm">#&gt;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c">#</span><span class="k">Requires</span><span class="w"> </span><span class="kd">-Version</span><span class="na"> 7.2</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="cm">&lt;#
</span></span></span><span class="line"><span class="cl"><span class="cm">.</span><span class="sd">SYNOPSIS</span><span class="cm">
</span></span></span><span class="line"><span class="cl"><span class="cm">Setting the PATH variable.
</span></span></span><span class="line"><span class="cl"><span class="cm">
</span></span></span><span class="line"><span class="cl"><span class="cm">.</span><span class="sd">DESCRIPTION</span><span class="cm">
</span></span></span><span class="line"><span class="cl"><span class="cm">The script configures the PATH variable values.
</span></span></span><span class="line"><span class="cl"><span class="cm">
</span></span></span><span class="line"><span class="cl"><span class="cm">.</span><span class="sd">EXAMPLE</span><span class="cm">
</span></span></span><span class="line"><span class="cl"><span class="cm">.\pwsh.set.env.path.ps1 -P &#39;C:\Apps\App_01&#39;, &#39;C:\Apps\App_02&#39;, &#39;C:\Apps\App_03&#39; -T &#39;Machine&#39;
</span></span></span><span class="line"><span class="cl"><span class="cm">
</span></span></span><span class="line"><span class="cl"><span class="cm">.</span><span class="sd">EXAMPLE</span><span class="cm">
</span></span></span><span class="line"><span class="cl"><span class="cm">.\pwsh.set.env.path.ps1 -P &#39;C:\Apps\App_01&#39;, &#39;C:\Apps\App_02&#39;, &#39;C:\Apps\App_03&#39; -T &#39;User&#39;
</span></span></span><span class="line"><span class="cl"><span class="cm">
</span></span></span><span class="line"><span class="cl"><span class="cm">.</span><span class="sd">LINK</span><span class="cm">
</span></span></span><span class="line"><span class="cl"><span class="cm">https://lib.onl/ru/2023/10/1f062637-3227-56d7-93e3-126d1c80f5a8/
</span></span></span><span class="line"><span class="cl"><span class="cm">#&gt;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">param</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">  <span class="p">[</span><span class="nb">Alias</span><span class="p">(</span><span class="s1">&#39;P&#39;</span><span class="p">)][</span><span class="no">string[]</span><span class="p">]</span><span class="nv">$Path</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">  <span class="p">[</span><span class="nb">Parameter</span><span class="p">(</span><span class="na">Mandatory</span><span class="p">)][</span><span class="nb">ValidateSet</span><span class="p">(</span><span class="s1">&#39;Machine&#39;</span><span class="p">,</span> <span class="s1">&#39;User&#39;</span><span class="p">)][</span><span class="nb">Alias</span><span class="p">(</span><span class="s1">&#39;T&#39;</span><span class="p">)][</span><span class="no">string[]</span><span class="p">]</span><span class="nv">$Target</span>
</span></span><span class="line"><span class="cl"><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kd">function</span><span class="w"> </span><span class="nb">Set-EnvPath</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="nv">$Path</span> <span class="p">|</span> <span class="nb">ForEach-Object</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="p">[</span><span class="no">Environment</span><span class="p">]::</span><span class="n">SetEnvironmentVariable</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">      <span class="s1">&#39;Path&#39;</span><span class="p">,</span> <span class="p">([</span><span class="no">Environment</span><span class="p">]::</span><span class="n">GetEnvironmentVariables</span><span class="p">(</span><span class="s2">&#34;</span><span class="nv">${Target}</span><span class="s2">&#34;</span><span class="p">)).</span><span class="py">Path</span> <span class="p">+</span> <span class="s2">&#34;</span><span class="nv">${_}</span><span class="s2">&#34;</span> <span class="p">+</span> <span class="p">[</span><span class="no">IO.Path</span><span class="p">]::</span><span class="n">PathSeparator</span><span class="p">,</span> <span class="s2">&#34;</span><span class="nv">${Target}</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nb">Set-EnvPath</span></span></span></code></pre></td></tr></table>
</div>
</div>
                </div>
              </div>
            </div>
        
    
<p>Вызывается скрипт обычным способом:</p>











<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-4 shortcode-codeblock-terminal
shortcode-codeblock-terminal-windows
shortcode-codeblock-terminal-windows-user">
  <div class="card overflow-hidden" data-bs-theme="dark">
    <div class="card-header">
      <div class="d-flex align-items-center">
        <div class="flex-shrink-0 ">
          <i class="fas fa-terminal fa-fw"></i>
        </div>
        <div class="flex-grow-1 mx-2">
          <h5 class="mb-0">Терминал</h5>
        </div>
        <div class="flex-shrink-0">
          <ul class="list-inline mb-0">
            <li class="list-inline-item" title='Копировать'>
              <a class="text-body" href="#"
                 data-fn="clipboard" data-clipboard-target="#cp-ef50bfd594a04af79d73675c733b2f68"
                 role="button" aria-label='Копировать'>
                <i class="fas fa-copy fa-fw"></i>
              </a>
            </li>
          </ul>
        </div>
      </div>
    </div>
    <div class="card-body p-0 overflow-auto" id="cp-ef50bfd594a04af79d73675c733b2f68"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-plaintext" data-lang="plaintext"><span class="line"><span class="cl">.\pwsh.set.env.path.ps1 -P &#39;C:\Apps\App_01&#39;, &#39;C:\Apps\App_02&#39;, &#39;C:\Apps\App_03&#39; -T &#39;User&#39;</span></span></code></pre></td></tr></table>
</div>
</div></div>
  </div>
</div>
<p>Но отличается от выше приведённых скриптов дополнительным параметром <code>-T</code>, который указывает уровень переменной <code>Path</code> и может принимать следующие значения:</p>
<ul>
<li><code>Machine</code> - для системного уровня.</li>
<li><code>User</code> - для пользовательского уровня.</li>
</ul>]]></turbo:content></item><item turbo="true"><title>Автоматическая настройка Windows Server 2022 под рабочую станцию</title><link>https://lib.onl/ru/2023/10/fb64d665-3e56-5fa5-a9eb-2e2e251949d8/</link><pubDate>Fri, 27 Oct 2023 19:46:08 +0000</pubDate><dc:creator>Kai Kimera</dc:creator><category>MS Windows</category><category>Терминал</category><category>Скрипты</category><yandex:related><link url="https://lib.onl/ru/2022/05/36058650-3f35-5ed5-9565-0aa7d8800c28/">Windows Server 2022 для рабочей станции</link><link url="https://lib.onl/ru/2023/10/38fc94dd-8d37-5f9e-b556-676304976a9f/">Восстановление доверительных отношений между PC и Active Directory</link><link url="https://lib.onl/ru/2023/10/616da78a-eb16-575a-9119-65f0c0c7baee/">Изменение порта RDP</link><link url="https://lib.onl/ru/2023/10/c6e32349-8fc2-53f9-9a42-790878a64076/">PowerShell: Полезные функции</link><link url="https://lib.onl/ru/2023/10/52d75b90-0637-5ba6-91d6-b1bff40e1d67/">PowerShell: Стирание диска</link><link url="https://lib.onl/ru/2023/10/2a73410a-6611-570c-9ab4-dc8cc8998146/">PowerShell: Сжатие видео при помощи FFmpeg</link><link url="https://lib.onl/ru/2023/10/0028821e-c96c-5014-a1dd-8963c161b170/">PowerShell: Определение разрядности ОС Windows</link><link url="https://lib.onl/ru/2023/10/4c7aba7c-f5a6-589a-9975-fdb16f2e2862/">PowerShell Vault</link><link url="https://lib.onl/ru/2023/10/eb39e3f7-b194-53d4-8bad-01edf9fdac47/">Дефрагментация в ОС Windows</link><link url="https://lib.onl/ru/2023/10/75075788-9308-56b7-b531-2008cb35f7d0/">Установка сертификата НУЦ Минцифры</link></yandex:related><turbo:extendedHtml>true</turbo:extendedHtml><turbo:source>https://lib.onl/ru/2023/10/fb64d665-3e56-5fa5-a9eb-2e2e251949d8/</turbo:source><turbo:topic>Автоматическая настройка Windows Server 2022 под рабочую станцию</turbo:topic><turbo:content><![CDATA[<p>Ранее я уже публиковал инструкцию по превращению серверной ОС в ОС для рабочей станции. Но этот процесс можно автоматизировать при помощи <span class="shortcode shortcode-tag"><a href="/ru/tags/powershell/" target="_blank">#PowerShell</a></span>.</p>
<p>В статье <span class="shortcode shortcode-uuid"><a href="/ru/2022/05/36058650-3f35-5ed5-9565-0aa7d8800c28/">Windows Server 2022 для рабочей станции</a></span> рассматривалось ручная адаптация Windows Server 2022 под рабочую станцию. Я решил написать специальный скрипт, который берёт на себя часть действий. Но окончательная настройка, например, такая как редактирование <span class="shortcode shortcode-tag"><a href="/ru/tags/gpo/" target="_blank">#GPO</a></span> остаётся за пользователем.</p>
<h2 id="автоматизация">
  <a class="link-body-emphasis" href="#%d0%b0%d0%b2%d1%82%d0%be%d0%bc%d0%b0%d1%82%d0%b8%d0%b7%d0%b0%d1%86%d0%b8%d1%8f">Автоматизация</a>
</h2><p>Рассмотрим скрипт по адаптации серверной ОС под рабочую станцию.</p>
<h3 id="примеры">
  <a class="link-body-emphasis" href="#%d0%bf%d1%80%d0%b8%d0%bc%d0%b5%d1%80%d1%8b">Примеры</a>
</h3><p>Скрипт требует административных прав доступа, поэтому его необходимо запускать под аккаунтом администратора.</p>











<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-0 shortcode-codeblock-terminal
shortcode-codeblock-terminal-windows
shortcode-codeblock-terminal-windows-root">
  <div class="card overflow-hidden" data-bs-theme="dark">
    <div class="card-header">
      <div class="d-flex align-items-center">
        <div class="flex-shrink-0 text-danger">
          <i class="fas fa-terminal fa-fw"></i>
        </div>
        <div class="flex-grow-1 mx-2">
          <h5 class="mb-0">Терминал</h5>
        </div>
        <div class="flex-shrink-0">
          <ul class="list-inline mb-0">
            <li class="list-inline-item" title='Копировать'>
              <a class="text-body" href="#"
                 data-fn="clipboard" data-clipboard-target="#cp-a6f2e27105bc5f13ede4f9f9b2fbe062"
                 role="button" aria-label='Копировать'>
                <i class="fas fa-copy fa-fw"></i>
              </a>
            </li>
          </ul>
        </div>
      </div>
    </div>
    <div class="card-body p-0 overflow-auto" id="cp-a6f2e27105bc5f13ede4f9f9b2fbe062"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-plaintext" data-lang="plaintext"><span class="line"><span class="cl">.\pwsh.win.srv.ws.ps1</span></span></code></pre></td></tr></table>
</div>
</div></div>
  </div>
</div>
<h3 id="алгоритм-работы">
  <a class="link-body-emphasis" href="#%d0%b0%d0%bb%d0%b3%d0%be%d1%80%d0%b8%d1%82%d0%bc-%d1%80%d0%b0%d0%b1%d0%be%d1%82%d1%8b">Алгоритм работы</a>
</h3><ul>
<li>Включение дополнительных компонентов <span class="shortcode shortcode-tag"><a href="/ru/tags/windows/" target="_blank">#Windows</a></span>.</li>
<li>Настройка необходимых для рабочей станции служб.</li>
<li>Отключение <strong>IE Enhanced Security Configuration</strong> для аккаунтов администраторов и пользователей.</li>
<li>Переключение приоритета процессора в сторону приложений.</li>
<li>Настройка <strong>MMAgent</strong>.</li>
<li>Переключение <strong>DEP</strong> только на программы <span class="shortcode shortcode-tag"><a href="/ru/tags/windows/" target="_blank">#Windows</a></span> и службы.</li>
</ul>
<h3 id="скрипт">
  <a class="link-body-emphasis" href="#%d1%81%d0%ba%d1%80%d0%b8%d0%bf%d1%82">Скрипт</a>
</h3>
    

    
        
            
            <div class="shortcode shortcode-file mb-3">
              <div class="card overflow-hidden" data-bs-theme="dark">
                <div class="card-header">
                  <div class="d-flex align-items-center">
                    <div class="flex-shrink-0">
                      <i class="far fa-file-code fa-fw"></i>
                    </div>
                    <div class="flex-grow-1 mx-2 text-truncate">
                      <code>pwsh.win.srv.ws.ps1</code>
                    </div>
                    <div class="flex-shrink-0">
                      <ul class="list-inline mb-0">
                        <li class="list-inline-item" title='Копировать'>
                          <a class="text-body" href="#"
                             data-fn="clipboard" data-clipboard-target="#cp-090902c63b0f67cebf08c2133bb359f5"
                             role="button" aria-label='Копировать'>
                            <i class="fas fa-copy fa-fw"></i>
                          </a>
                        </li>
                        <li class="list-inline-item" title='Скачать'>
                          <a class="text-body" href="/ru/2023/10/fb64d665-3e56-5fa5-a9eb-2e2e251949d8/pwsh.win.srv.ws.ps1" download
                             role="button" aria-label='Скачать'>
                            <i class="fas fa-download fa-fw"></i>
                          </a>
                        </li>
                        <li class="list-inline-item" title='Открыть'>
                          <a class="text-body" href="/ru/2023/10/fb64d665-3e56-5fa5-a9eb-2e2e251949d8/pwsh.win.srv.ws.ps1" target="_blank"
                             role="button" aria-label='Открыть'>
                            <i class="fas fa-arrow-up-right-from-square fa-fw"></i>
                          </a>
                        </li>
                      </ul>
                    </div>
                  </div>
                </div>
                <div class="card-body p-0 overflow-auto" id="cp-090902c63b0f67cebf08c2133bb359f5">
                    
                        
                    
                    <div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">  1
</span><span class="lnt">  2
</span><span class="lnt">  3
</span><span class="lnt">  4
</span><span class="lnt">  5
</span><span class="lnt">  6
</span><span class="lnt">  7
</span><span class="lnt">  8
</span><span class="lnt">  9
</span><span class="lnt"> 10
</span><span class="lnt"> 11
</span><span class="lnt"> 12
</span><span class="lnt"> 13
</span><span class="lnt"> 14
</span><span class="lnt"> 15
</span><span class="lnt"> 16
</span><span class="lnt"> 17
</span><span class="lnt"> 18
</span><span class="lnt"> 19
</span><span class="lnt"> 20
</span><span class="lnt"> 21
</span><span class="lnt"> 22
</span><span class="lnt"> 23
</span><span class="lnt"> 24
</span><span class="lnt"> 25
</span><span class="lnt"> 26
</span><span class="lnt"> 27
</span><span class="lnt"> 28
</span><span class="lnt"> 29
</span><span class="lnt"> 30
</span><span class="lnt"> 31
</span><span class="lnt"> 32
</span><span class="lnt"> 33
</span><span class="lnt"> 34
</span><span class="lnt"> 35
</span><span class="lnt"> 36
</span><span class="lnt"> 37
</span><span class="lnt"> 38
</span><span class="lnt"> 39
</span><span class="lnt"> 40
</span><span class="lnt"> 41
</span><span class="lnt"> 42
</span><span class="lnt"> 43
</span><span class="lnt"> 44
</span><span class="lnt"> 45
</span><span class="lnt"> 46
</span><span class="lnt"> 47
</span><span class="lnt"> 48
</span><span class="lnt"> 49
</span><span class="lnt"> 50
</span><span class="lnt"> 51
</span><span class="lnt"> 52
</span><span class="lnt"> 53
</span><span class="lnt"> 54
</span><span class="lnt"> 55
</span><span class="lnt"> 56
</span><span class="lnt"> 57
</span><span class="lnt"> 58
</span><span class="lnt"> 59
</span><span class="lnt"> 60
</span><span class="lnt"> 61
</span><span class="lnt"> 62
</span><span class="lnt"> 63
</span><span class="lnt"> 64
</span><span class="lnt"> 65
</span><span class="lnt"> 66
</span><span class="lnt"> 67
</span><span class="lnt"> 68
</span><span class="lnt"> 69
</span><span class="lnt"> 70
</span><span class="lnt"> 71
</span><span class="lnt"> 72
</span><span class="lnt"> 73
</span><span class="lnt"> 74
</span><span class="lnt"> 75
</span><span class="lnt"> 76
</span><span class="lnt"> 77
</span><span class="lnt"> 78
</span><span class="lnt"> 79
</span><span class="lnt"> 80
</span><span class="lnt"> 81
</span><span class="lnt"> 82
</span><span class="lnt"> 83
</span><span class="lnt"> 84
</span><span class="lnt"> 85
</span><span class="lnt"> 86
</span><span class="lnt"> 87
</span><span class="lnt"> 88
</span><span class="lnt"> 89
</span><span class="lnt"> 90
</span><span class="lnt"> 91
</span><span class="lnt"> 92
</span><span class="lnt"> 93
</span><span class="lnt"> 94
</span><span class="lnt"> 95
</span><span class="lnt"> 96
</span><span class="lnt"> 97
</span><span class="lnt"> 98
</span><span class="lnt"> 99
</span><span class="lnt">100
</span><span class="lnt">101
</span><span class="lnt">102
</span><span class="lnt">103
</span><span class="lnt">104
</span><span class="lnt">105
</span><span class="lnt">106
</span><span class="lnt">107
</span><span class="lnt">108
</span><span class="lnt">109
</span><span class="lnt">110
</span><span class="lnt">111
</span><span class="lnt">112
</span><span class="lnt">113
</span><span class="lnt">114
</span><span class="lnt">115
</span><span class="lnt">116
</span><span class="lnt">117
</span><span class="lnt">118
</span><span class="lnt">119
</span><span class="lnt">120
</span><span class="lnt">121
</span><span class="lnt">122
</span><span class="lnt">123
</span><span class="lnt">124
</span><span class="lnt">125
</span><span class="lnt">126
</span><span class="lnt">127
</span><span class="lnt">128
</span><span class="lnt">129
</span><span class="lnt">130
</span><span class="lnt">131
</span><span class="lnt">132
</span><span class="lnt">133
</span><span class="lnt">134
</span><span class="lnt">135
</span><span class="lnt">136
</span><span class="lnt">137
</span><span class="lnt">138
</span><span class="lnt">139
</span><span class="lnt">140
</span><span class="lnt">141
</span><span class="lnt">142
</span><span class="lnt">143
</span><span class="lnt">144
</span><span class="lnt">145
</span><span class="lnt">146
</span><span class="lnt">147
</span><span class="lnt">148
</span><span class="lnt">149
</span><span class="lnt">150
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-ps1" data-lang="ps1"><span class="line"><span class="cl"><span class="cm">&lt;#PSScriptInfo
</span></span></span><span class="line"><span class="cl"><span class="cm">.VERSION      0.1.0
</span></span></span><span class="line"><span class="cl"><span class="cm">.GUID         c050355b-ecbd-4b13-b805-3a422dc0c995
</span></span></span><span class="line"><span class="cl"><span class="cm">.AUTHOR       Kai Kimera
</span></span></span><span class="line"><span class="cl"><span class="cm">.AUTHOREMAIL  mail@kai.kim
</span></span></span><span class="line"><span class="cl"><span class="cm">.COMPANYNAME  Library Online
</span></span></span><span class="line"><span class="cl"><span class="cm">.COPYRIGHT    2023 Library Online. All rights reserved.
</span></span></span><span class="line"><span class="cl"><span class="cm">.LICENSEURI   https://choosealicense.com/licenses/mit/
</span></span></span><span class="line"><span class="cl"><span class="cm">.PROJECTURI   https://lib.onl/ru/2023/10/fb64d665-3e56-5fa5-a9eb-2e2e251949d8/
</span></span></span><span class="line"><span class="cl"><span class="cm">#&gt;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c">#</span><span class="k">Requires</span><span class="w"> </span><span class="kd">-Version</span><span class="na"> 7.2</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c">#</span><span class="k">Requires</span><span class="w"> </span><span class="kd">-RunAsAdministrator</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="cm">&lt;#
</span></span></span><span class="line"><span class="cl"><span class="cm">.</span><span class="sd">SYNOPSIS</span><span class="cm">
</span></span></span><span class="line"><span class="cl"><span class="cm">Windows Server configuration script.
</span></span></span><span class="line"><span class="cl"><span class="cm">
</span></span></span><span class="line"><span class="cl"><span class="cm">.</span><span class="sd">DESCRIPTION</span><span class="cm">
</span></span></span><span class="line"><span class="cl"><span class="cm">The script allows you to set up Windows Server as a workstation.
</span></span></span><span class="line"><span class="cl"><span class="cm">
</span></span></span><span class="line"><span class="cl"><span class="cm">.</span><span class="sd">EXAMPLE</span><span class="cm">
</span></span></span><span class="line"><span class="cl"><span class="cm">.\pwsh.win.srv.ws.ps1
</span></span></span><span class="line"><span class="cl"><span class="cm">
</span></span></span><span class="line"><span class="cl"><span class="cm">.</span><span class="sd">LINK</span><span class="cm">
</span></span></span><span class="line"><span class="cl"><span class="cm">https://lib.onl/ru/2023/10/fb64d665-3e56-5fa5-a9eb-2e2e251949d8/
</span></span></span><span class="line"><span class="cl"><span class="cm">#&gt;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c"># -------------------------------------------------------------------------------------------------------------------- #</span>
</span></span><span class="line"><span class="cl"><span class="c"># INITIALIZATION</span>
</span></span><span class="line"><span class="cl"><span class="c"># -------------------------------------------------------------------------------------------------------------------- #</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kd">function</span><span class="w"> </span><span class="nb">Start-Script</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="nb">Start-FeatureConfig</span>
</span></span><span class="line"><span class="cl">  <span class="nb">Start-ServiceConfig</span>
</span></span><span class="line"><span class="cl">  <span class="nb">Start-IEConfig</span>
</span></span><span class="line"><span class="cl">  <span class="nb">Start-PriorityControlConfig</span>
</span></span><span class="line"><span class="cl">  <span class="nb">Start-MMAgentConfig</span>
</span></span><span class="line"><span class="cl">  <span class="nb">Start-DEPConfig</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c"># -------------------------------------------------------------------------------------------------------------------- #</span>
</span></span><span class="line"><span class="cl"><span class="c"># CONFIGURING FEATURES</span>
</span></span><span class="line"><span class="cl"><span class="c"># -------------------------------------------------------------------------------------------------------------------- #</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kd">function</span><span class="w"> </span><span class="nb">Start-FeatureConfig</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="nv">$Param</span> <span class="p">=</span> <span class="vm">@</span><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">Name</span> <span class="p">=</span> <span class="s1">&#39;Wireless-Networking&#39;</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="nb">Install-WindowsFeature</span> <span class="nv">@Param</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c"># -------------------------------------------------------------------------------------------------------------------- #</span>
</span></span><span class="line"><span class="cl"><span class="c"># CONFIGURING SERVICES</span>
</span></span><span class="line"><span class="cl"><span class="c"># -------------------------------------------------------------------------------------------------------------------- #</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kd">function</span><span class="w"> </span><span class="nb">Start-ServiceConfig</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="nv">$Name</span> <span class="p">=</span> <span class="vm">@</span><span class="p">(</span><span class="s1">&#39;Audiosrv&#39;</span><span class="p">,</span> <span class="s1">&#39;AudioEndpointBuilder&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="nv">$Name</span> <span class="p">|</span> <span class="nb">ForEach-Object</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nv">$Param</span> <span class="p">=</span> <span class="vm">@</span><span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="n">Name</span> <span class="p">=</span> <span class="s2">&#34;</span><span class="nv">${_}</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl">      <span class="n">StartupType</span> <span class="p">=</span> <span class="s1">&#39;Automatic&#39;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="nb">Set-Service</span> <span class="nv">@Param</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="nv">$WSearch</span> <span class="p">=</span> <span class="vm">@</span><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">Name</span> <span class="p">=</span> <span class="s1">&#39;WSearch&#39;</span>
</span></span><span class="line"><span class="cl">    <span class="n">StartupType</span> <span class="p">=</span> <span class="s1">&#39;AutomaticDelayedStart&#39;</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="nb">Set-Service</span> <span class="nv">@WSearch</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c"># -------------------------------------------------------------------------------------------------------------------- #</span>
</span></span><span class="line"><span class="cl"><span class="c"># DISABLE IE ENHANCED SECURITY CONFIGURATION (ESC)</span>
</span></span><span class="line"><span class="cl"><span class="c"># -------------------------------------------------------------------------------------------------------------------- #</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kd">function</span><span class="w"> </span><span class="nb">Start-IEConfig</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="nv">$Path</span> <span class="p">=</span> <span class="vm">@</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">    <span class="s1">&#39;HKLM:\SOFTWARE\Microsoft\Active Setup\Installed Components\{A509B1A7-37EF-4b3f-8CFC-4F3A74704073}&#39;</span>
</span></span><span class="line"><span class="cl">    <span class="s1">&#39;HKLM:\SOFTWARE\Microsoft\Active Setup\Installed Components\{A509B1A8-37EF-4b3f-8CFC-4F3A74704073}&#39;</span>
</span></span><span class="line"><span class="cl">  <span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="nv">$Path</span> <span class="p">|</span> <span class="nb">ForEach-Object</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nv">$Param</span> <span class="p">=</span> <span class="vm">@</span><span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="n">LiteralPath</span> <span class="p">=</span> <span class="s2">&#34;</span><span class="nv">${_}</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl">      <span class="n">Name</span> <span class="p">=</span> <span class="s1">&#39;IsInstalled&#39;</span>
</span></span><span class="line"><span class="cl">      <span class="n">Value</span> <span class="p">=</span> <span class="mf">0</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="p">(</span><span class="nb">Test-Path</span> <span class="n">-LiteralPath</span> <span class="s2">&#34;</span><span class="nv">${_}</span><span class="s2">&#34;</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="nb">Set-ItemProperty</span> <span class="nv">@Param</span>
</span></span><span class="line"><span class="cl">      <span class="nb">Write-Host</span> <span class="s1">&#39;IE Enhanced Security Configuration (ESC) has been disabled.&#39;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="nb">Write-Error</span> <span class="n">-Message</span> <span class="s2">&#34;&#39;</span><span class="nv">${_}</span><span class="s2">&#39; not found!&#34;</span> <span class="n">-ErrorAction</span> <span class="s1">&#39;Stop&#39;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c"># -------------------------------------------------------------------------------------------------------------------- #</span>
</span></span><span class="line"><span class="cl"><span class="c"># ADJUST PROCESSOR RESOURCES FOR BEST PERFORMANCE OF PROGRAMS</span>
</span></span><span class="line"><span class="cl"><span class="c"># -------------------------------------------------------------------------------------------------------------------- #</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kd">function</span><span class="w"> </span><span class="nb">Start-PriorityControlConfig</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="nv">$Path</span> <span class="p">=</span> <span class="s1">&#39;HKLM:\SYSTEM\CurrentControlSet\Control\PriorityControl&#39;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="nv">$Param</span> <span class="p">=</span> <span class="vm">@</span><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">LiteralPath</span> <span class="p">=</span> <span class="s2">&#34;</span><span class="nv">${Path}</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="n">Name</span> <span class="p">=</span> <span class="s1">&#39;Win32PrioritySeparation&#39;</span>
</span></span><span class="line"><span class="cl">    <span class="n">Value</span> <span class="p">=</span> <span class="mf">38</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="k">if</span> <span class="p">(</span><span class="nb">Test-Path</span> <span class="n">-LiteralPath</span> <span class="s2">&#34;</span><span class="nv">${Path}</span><span class="s2">&#34;</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nb">Set-ItemProperty</span> <span class="nv">@Param</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nb">Write-Error</span> <span class="n">-Message</span> <span class="s2">&#34;&#39;</span><span class="nv">${Path}</span><span class="s2">&#39; not found!&#34;</span> <span class="n">-ErrorAction</span> <span class="s1">&#39;Stop&#39;</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c"># -------------------------------------------------------------------------------------------------------------------- #</span>
</span></span><span class="line"><span class="cl"><span class="c"># CONFIGURING MMAGENT</span>
</span></span><span class="line"><span class="cl"><span class="c"># -------------------------------------------------------------------------------------------------------------------- #</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kd">function</span><span class="w"> </span><span class="nb">Start-MMAgentConfig</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="nv">$Param</span> <span class="p">=</span> <span class="vm">@</span><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">MemoryCompression</span> <span class="p">=</span> <span class="vm">$true</span>
</span></span><span class="line"><span class="cl">    <span class="n">OperationAPI</span> <span class="p">=</span> <span class="vm">$true</span>
</span></span><span class="line"><span class="cl">    <span class="n">PageCombining</span> <span class="p">=</span> <span class="vm">$true</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="nb">Enable-MMAgent</span> <span class="nv">@Param</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c"># -------------------------------------------------------------------------------------------------------------------- #</span>
</span></span><span class="line"><span class="cl"><span class="c"># CONFIGURING DEP</span>
</span></span><span class="line"><span class="cl"><span class="c"># -------------------------------------------------------------------------------------------------------------------- #</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kd">function</span><span class="w"> </span><span class="nb">Start-DEPConfig</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="n">cmd</span><span class="p">.</span><span class="py">exe</span> <span class="p">/</span><span class="n">c</span> <span class="s1">&#39;bcdedit.exe /set {current} nx OptIn&#39;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c"># -------------------------------------------------------------------------------------------------------------------- #</span>
</span></span><span class="line"><span class="cl"><span class="c"># -------------------------------------------------&lt; RUNNING SCRIPT &gt;------------------------------------------------- #</span>
</span></span><span class="line"><span class="cl"><span class="c"># -------------------------------------------------------------------------------------------------------------------- #</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nb">Start-Script</span></span></span></code></pre></td></tr></table>
</div>
</div>
                </div>
              </div>
            </div>]]></turbo:content></item><item turbo="true"><title>Восстановление доверительных отношений между PC и Active Directory</title><link>https://lib.onl/ru/2023/10/38fc94dd-8d37-5f9e-b556-676304976a9f/</link><pubDate>Fri, 27 Oct 2023 09:25:25 +0000</pubDate><dc:creator>Kai Kimera</dc:creator><category>MS Windows</category><category>Скрипты</category><category>Терминал</category><yandex:related><link url="https://lib.onl/ru/2023/10/616da78a-eb16-575a-9119-65f0c0c7baee/">Изменение порта RDP</link><link url="https://lib.onl/ru/2023/10/c6e32349-8fc2-53f9-9a42-790878a64076/">PowerShell: Полезные функции</link><link url="https://lib.onl/ru/2023/10/52d75b90-0637-5ba6-91d6-b1bff40e1d67/">PowerShell: Стирание диска</link><link url="https://lib.onl/ru/2023/10/2a73410a-6611-570c-9ab4-dc8cc8998146/">PowerShell: Сжатие видео при помощи FFmpeg</link><link url="https://lib.onl/ru/2023/10/0028821e-c96c-5014-a1dd-8963c161b170/">PowerShell: Определение разрядности ОС Windows</link><link url="https://lib.onl/ru/2023/10/4c7aba7c-f5a6-589a-9975-fdb16f2e2862/">PowerShell Vault</link><link url="https://lib.onl/ru/2023/10/eb39e3f7-b194-53d4-8bad-01edf9fdac47/">Дефрагментация в ОС Windows</link><link url="https://lib.onl/ru/2023/10/75075788-9308-56b7-b531-2008cb35f7d0/">Установка сертификата НУЦ Минцифры</link><link url="https://lib.onl/ru/2022/05/36058650-3f35-5ed5-9565-0aa7d8800c28/">Windows Server 2022 для рабочей станции</link></yandex:related><turbo:extendedHtml>true</turbo:extendedHtml><turbo:source>https://lib.onl/ru/2023/10/38fc94dd-8d37-5f9e-b556-676304976a9f/</turbo:source><turbo:topic>Восстановление доверительных отношений между PC и Active Directory</turbo:topic><turbo:content><![CDATA[<p>Рассмотрим способы решения распространённой проблемы потери доверительных отношений между рабочей станцией и доменом Active Directory (<span class="shortcode shortcode-tag"><a href="/ru/tags/ad/" target="_blank">#AD</a></span>). Из-за этой проблемы пользователь не может авторизоваться под своей учётной записью.</p>
<p>При попытке входа пользователя под доменной учётной записью, могут произойти следующие ошибки.</p>






    




<div class="shortcode shortcode-window">
  <div class="card text-bg-danger mb-3 overflow-hidden">
    <div class="card-header">
      <div class="d-flex align-items-center">
        <div class="flex-shrink-0">
          <i class="fas fa-computer fa-fw"></i>
        </div>
        <div class="flex-grow-1 mx-2">
          <h5 class="mb-0">Trust relationship</h5>
        </div>
        <div class="flex-shrink-0">
          <ul class="list-inline mb-0">
            <li class="list-inline-item"><i class="fas fa-circle fa-fw"></i></li>
            <li class="list-inline-item"><i class="fas fa-circle fa-fw"></i></li>
            <li class="list-inline-item"><i class="fas fa-circle fa-fw"></i></li>
          </ul>
        </div>
      </div>
    </div>
    <div class="card-body">
        <p>The trust relationship between this workstation and the primary domain failed.</p>
<p>(Не удалось восстановить доверительные отношения между рабочей станцией и доменом.)</p>

    </div>
  </div>
</div>







    




<div class="shortcode shortcode-window">
  <div class="card text-bg-danger mb-3 overflow-hidden">
    <div class="card-header">
      <div class="d-flex align-items-center">
        <div class="flex-shrink-0">
          <i class="fas fa-computer fa-fw"></i>
        </div>
        <div class="flex-grow-1 mx-2">
          <h5 class="mb-0">Security database</h5>
        </div>
        <div class="flex-shrink-0">
          <ul class="list-inline mb-0">
            <li class="list-inline-item"><i class="fas fa-circle fa-fw"></i></li>
            <li class="list-inline-item"><i class="fas fa-circle fa-fw"></i></li>
            <li class="list-inline-item"><i class="fas fa-circle fa-fw"></i></li>
          </ul>
        </div>
      </div>
    </div>
    <div class="card-body">
        <p>The security database on the server does not have a computer account for this workstation trust relationship.</p>
<p>(База данных диспетчера учетных записей на сервере не содержит записи для регистрации компьютера через доверительные отношения с этой рабочей станцией.)</p>

    </div>
  </div>
</div>

<p>Ошибка может возникнуть по различным факторам. Например, когда новый компьютер присоединился к домену под уже существующем именем другого компьютера, или когда виртуальная машина восстановилась с контрольной точки.</p>
<h2 id="ручной-способ">
  <a class="link-body-emphasis" href="#%d1%80%d1%83%d1%87%d0%bd%d0%be%d0%b9-%d1%81%d0%bf%d0%be%d1%81%d0%be%d0%b1">Ручной способ</a>
</h2><p>Для того, чтобы исправить ошибку, необходимо последовательно выполнить следующие пункты:</p>
<ol>
<li>Сбросить аккаунт компьютера в <span class="shortcode shortcode-tag"><a href="/ru/tags/ad/" target="_blank">#AD</a></span>.</li>
<li>На проблемном компьютере зайти под локальным администратором и вывести компьютер из домена в рабочую группу.</li>
<li>Перезагрузить компьютер.</li>
<li>Вывести компьютер из рабочей группы и ввести обратно в домен.</li>
<li>Еще раз перезагрузить компьютер.</li>
</ol>
<h2 id="автоматизация">
  <a class="link-body-emphasis" href="#%d0%b0%d0%b2%d1%82%d0%be%d0%bc%d0%b0%d1%82%d0%b8%d0%b7%d0%b0%d1%86%d0%b8%d1%8f">Автоматизация</a>
</h2><p>Как обычно, привожу скрипт по автоматизации восстановления доверительных отношений. Скрипт решит проблему быстро и без перезагрузок. Запускается под администратором.</p>
<h3 id="параметры">
  <a class="link-body-emphasis" href="#%d0%bf%d0%b0%d1%80%d0%b0%d0%bc%d0%b5%d1%82%d1%80%d1%8b">Параметры</a>
</h3><p>Параметр у скрипта один, это название сервера Domain Controller <span class="shortcode shortcode-tag">DC</span>.</p>
<ul>
<li><code>-S</code> <code>-P_Server</code> - название сервера DC (контроллера домена). Если параметр не задан, скрипт выбирает для операции контроллер домена по умолчанию.</li>
</ul>
<h3 id="примеры">
  <a class="link-body-emphasis" href="#%d0%bf%d1%80%d0%b8%d0%bc%d0%b5%d1%80%d1%8b">Примеры</a>
</h3><p>Восстановить доверительные отношения с доменом по умолчанию:</p>











<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-0 shortcode-codeblock-terminal
shortcode-codeblock-terminal-windows
shortcode-codeblock-terminal-windows-root">
  <div class="card overflow-hidden" data-bs-theme="dark">
    <div class="card-header">
      <div class="d-flex align-items-center">
        <div class="flex-shrink-0 text-danger">
          <i class="fas fa-terminal fa-fw"></i>
        </div>
        <div class="flex-grow-1 mx-2">
          <h5 class="mb-0">Терминал</h5>
        </div>
        <div class="flex-shrink-0">
          <ul class="list-inline mb-0">
            <li class="list-inline-item" title='Копировать'>
              <a class="text-body" href="#"
                 data-fn="clipboard" data-clipboard-target="#cp-6685a0ba99a5b8c88dc9ac2c2642c461"
                 role="button" aria-label='Копировать'>
                <i class="fas fa-copy fa-fw"></i>
              </a>
            </li>
          </ul>
        </div>
      </div>
    </div>
    <div class="card-body p-0 overflow-auto" id="cp-6685a0ba99a5b8c88dc9ac2c2642c461"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-plaintext" data-lang="plaintext"><span class="line"><span class="cl">.\pwsh.csc.repair.ps1</span></span></code></pre></td></tr></table>
</div>
</div></div>
  </div>
</div>
<p>Восстановить доверительные отношения с доменом <code>DC-server.domain.com</code>:</p>











<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-1 shortcode-codeblock-terminal
shortcode-codeblock-terminal-windows
shortcode-codeblock-terminal-windows-root">
  <div class="card overflow-hidden" data-bs-theme="dark">
    <div class="card-header">
      <div class="d-flex align-items-center">
        <div class="flex-shrink-0 text-danger">
          <i class="fas fa-terminal fa-fw"></i>
        </div>
        <div class="flex-grow-1 mx-2">
          <h5 class="mb-0">Терминал</h5>
        </div>
        <div class="flex-shrink-0">
          <ul class="list-inline mb-0">
            <li class="list-inline-item" title='Копировать'>
              <a class="text-body" href="#"
                 data-fn="clipboard" data-clipboard-target="#cp-fbb2cec6cba9a33e323fbeb91b10304e"
                 role="button" aria-label='Копировать'>
                <i class="fas fa-copy fa-fw"></i>
              </a>
            </li>
          </ul>
        </div>
      </div>
    </div>
    <div class="card-body p-0 overflow-auto" id="cp-fbb2cec6cba9a33e323fbeb91b10304e"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-plaintext" data-lang="plaintext"><span class="line"><span class="cl">.\pwsh.csc.repair.ps1 -DC &#39;DC-server.domain.com&#39;</span></span></code></pre></td></tr></table>
</div>
</div></div>
  </div>
</div>
<h3 id="алгоритм-работы">
  <a class="link-body-emphasis" href="#%d0%b0%d0%bb%d0%b3%d0%be%d1%80%d0%b8%d1%82%d0%bc-%d1%80%d0%b0%d0%b1%d0%be%d1%82%d1%8b">Алгоритм работы</a>
</h3><ul>
<li>Запускается проверка доверительных отношений при помощи cmdlet&rsquo;а <code>Test-ComputerSecureChannel</code>.</li>
<li>Если проверка пройдена, скрипт завершает работу.</li>
<li>Если проверка не пройдена, запускается цикл восстановления доверительных отношений с контроллером домена с временным интервалом в 5 секунд.</li>
</ul>
<h3 id="скрипт">
  <a class="link-body-emphasis" href="#%d1%81%d0%ba%d1%80%d0%b8%d0%bf%d1%82">Скрипт</a>
</h3>
    

    
        
            
            <div class="shortcode shortcode-file mb-3">
              <div class="card overflow-hidden" data-bs-theme="dark">
                <div class="card-header">
                  <div class="d-flex align-items-center">
                    <div class="flex-shrink-0">
                      <i class="far fa-file-code fa-fw"></i>
                    </div>
                    <div class="flex-grow-1 mx-2 text-truncate">
                      <code>pwsh.csc.repair.ps1</code>
                    </div>
                    <div class="flex-shrink-0">
                      <ul class="list-inline mb-0">
                        <li class="list-inline-item" title='Копировать'>
                          <a class="text-body" href="#"
                             data-fn="clipboard" data-clipboard-target="#cp-1ca86b46dc3231be20c258245e025d28"
                             role="button" aria-label='Копировать'>
                            <i class="fas fa-copy fa-fw"></i>
                          </a>
                        </li>
                        <li class="list-inline-item" title='Скачать'>
                          <a class="text-body" href="/ru/2023/10/38fc94dd-8d37-5f9e-b556-676304976a9f/pwsh.csc.repair.ps1" download
                             role="button" aria-label='Скачать'>
                            <i class="fas fa-download fa-fw"></i>
                          </a>
                        </li>
                        <li class="list-inline-item" title='Открыть'>
                          <a class="text-body" href="/ru/2023/10/38fc94dd-8d37-5f9e-b556-676304976a9f/pwsh.csc.repair.ps1" target="_blank"
                             role="button" aria-label='Открыть'>
                            <i class="fas fa-arrow-up-right-from-square fa-fw"></i>
                          </a>
                        </li>
                      </ul>
                    </div>
                  </div>
                </div>
                <div class="card-body p-0 overflow-auto" id="cp-1ca86b46dc3231be20c258245e025d28">
                    
                        
                    
                    <div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span><span class="lnt">56
</span><span class="lnt">57
</span><span class="lnt">58
</span><span class="lnt">59
</span><span class="lnt">60
</span><span class="lnt">61
</span><span class="lnt">62
</span><span class="lnt">63
</span><span class="lnt">64
</span><span class="lnt">65
</span><span class="lnt">66
</span><span class="lnt">67
</span><span class="lnt">68
</span><span class="lnt">69
</span><span class="lnt">70
</span><span class="lnt">71
</span><span class="lnt">72
</span><span class="lnt">73
</span><span class="lnt">74
</span><span class="lnt">75
</span><span class="lnt">76
</span><span class="lnt">77
</span><span class="lnt">78
</span><span class="lnt">79
</span><span class="lnt">80
</span><span class="lnt">81
</span><span class="lnt">82
</span><span class="lnt">83
</span><span class="lnt">84
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-ps1" data-lang="ps1"><span class="line"><span class="cl"><span class="cm">&lt;#PSScriptInfo
</span></span></span><span class="line"><span class="cl"><span class="cm">.VERSION      0.1.0
</span></span></span><span class="line"><span class="cl"><span class="cm">.GUID         52672f5d-e2c0-467a-ae1d-c0fc9009a1eb
</span></span></span><span class="line"><span class="cl"><span class="cm">.AUTHOR       Kai Kimera
</span></span></span><span class="line"><span class="cl"><span class="cm">.AUTHOREMAIL  mail@kai.kim
</span></span></span><span class="line"><span class="cl"><span class="cm">.COMPANYNAME  Library Online
</span></span></span><span class="line"><span class="cl"><span class="cm">.COPYRIGHT    2023 Library Online. All rights reserved.
</span></span></span><span class="line"><span class="cl"><span class="cm">.LICENSEURI   https://choosealicense.com/licenses/mit/
</span></span></span><span class="line"><span class="cl"><span class="cm">.PROJECTURI   https://lib.onl/ru/2023/10/38fc94dd-8d37-5f9e-b556-676304976a9f/
</span></span></span><span class="line"><span class="cl"><span class="cm">#&gt;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c">#</span><span class="k">Requires</span><span class="w"> </span><span class="kd">-Version</span><span class="na"> 7.2</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c">#</span><span class="k">Requires</span><span class="w"> </span><span class="kd">-RunAsAdministrator</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="cm">&lt;#
</span></span></span><span class="line"><span class="cl"><span class="cm">.</span><span class="sd">SYNOPSIS</span><span class="cm">
</span></span></span><span class="line"><span class="cl"><span class="cm">Testing and repairing the secure channel between the local computer and its domain.
</span></span></span><span class="line"><span class="cl"><span class="cm">
</span></span></span><span class="line"><span class="cl"><span class="cm">.</span><span class="sd">DESCRIPTION</span><span class="cm">
</span></span></span><span class="line"><span class="cl"><span class="cm">Verifying that the channel between the local computer and its domain is working correctly by checking the status of its trust relationships. If a connection fails, trying to restore it.
</span></span></span><span class="line"><span class="cl"><span class="cm">
</span></span></span><span class="line"><span class="cl"><span class="cm">.PARAMETER P_Server
</span></span></span><span class="line"><span class="cl"><span class="cm">Specifies the domain controller to run the command. If this parameter is not specified, this script selects a default domain controller for the operation.
</span></span></span><span class="line"><span class="cl"><span class="cm">
</span></span></span><span class="line"><span class="cl"><span class="cm">.PARAMETER P_Sleep
</span></span></span><span class="line"><span class="cl"><span class="cm">Sleep time (in seconds).
</span></span></span><span class="line"><span class="cl"><span class="cm">
</span></span></span><span class="line"><span class="cl"><span class="cm">.</span><span class="sd">EXAMPLE</span><span class="cm">
</span></span></span><span class="line"><span class="cl"><span class="cm">.\pwsh.csc.repair.ps1
</span></span></span><span class="line"><span class="cl"><span class="cm">
</span></span></span><span class="line"><span class="cl"><span class="cm">.</span><span class="sd">EXAMPLE</span><span class="cm">
</span></span></span><span class="line"><span class="cl"><span class="cm">.\pwsh.csc.repair.ps1 -DC &#39;DC-server.domain.com&#39;
</span></span></span><span class="line"><span class="cl"><span class="cm">
</span></span></span><span class="line"><span class="cl"><span class="cm">.</span><span class="sd">LINK</span><span class="cm">
</span></span></span><span class="line"><span class="cl"><span class="cm">https://lib.onl/ru/2023/10/38fc94dd-8d37-5f9e-b556-676304976a9f/
</span></span></span><span class="line"><span class="cl"><span class="cm">#&gt;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c"># -------------------------------------------------------------------------------------------------------------------- #</span>
</span></span><span class="line"><span class="cl"><span class="c"># CONFIGURATION</span>
</span></span><span class="line"><span class="cl"><span class="c"># -------------------------------------------------------------------------------------------------------------------- #</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">param</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">  <span class="p">[</span><span class="nb">Parameter</span><span class="p">(</span><span class="na">HelpMessage</span><span class="p">=</span><span class="s2">&#34;Specifies the domain controller to run the command.&#34;</span><span class="p">)]</span>
</span></span><span class="line"><span class="cl">  <span class="p">[</span><span class="nb">Alias</span><span class="p">(</span><span class="s1">&#39;DC&#39;</span><span class="p">)][</span><span class="no">string</span><span class="p">]</span><span class="nv">$P_Server</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="p">[</span><span class="nb">Parameter</span><span class="p">(</span><span class="na">HelpMessage</span><span class="p">=</span><span class="s2">&#34;Sleep time (in seconds).&#34;</span><span class="p">)]</span>
</span></span><span class="line"><span class="cl">  <span class="p">[</span><span class="nb">Alias</span><span class="p">(</span><span class="s1">&#39;S&#39;</span><span class="p">)][</span><span class="no">int</span><span class="p">]</span><span class="nv">$P_Sleep</span> <span class="p">=</span> <span class="mf">5</span>
</span></span><span class="line"><span class="cl"><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c"># -------------------------------------------------------------------------------------------------------------------- #</span>
</span></span><span class="line"><span class="cl"><span class="c"># INITIALIZATION</span>
</span></span><span class="line"><span class="cl"><span class="c"># -------------------------------------------------------------------------------------------------------------------- #</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kd">function</span><span class="w"> </span><span class="nb">Start-Script</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="nb">Start-CSCRepair</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c"># -------------------------------------------------------------------------------------------------------------------- #</span>
</span></span><span class="line"><span class="cl"><span class="c"># EDITING THE REGISTRY</span>
</span></span><span class="line"><span class="cl"><span class="c"># -------------------------------------------------------------------------------------------------------------------- #</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kd">function</span><span class="w"> </span><span class="nb">Start-CSCRepair</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="nv">$Param</span> <span class="p">=</span> <span class="vm">@</span><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">Server</span> <span class="p">=</span> <span class="s2">&#34;</span><span class="nv">${P_Server}</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="n">Repair</span> <span class="p">=</span> <span class="vm">$true</span>
</span></span><span class="line"><span class="cl">    <span class="n">Credential</span> <span class="p">=</span> <span class="p">(</span><span class="nb">Get-Credential</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="k">do</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="p">(</span><span class="nb">Test-ComputerSecureChannel</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="nb">Write-Host</span> <span class="s1">&#39;Connection successful. Everything is fine!&#39;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="nb">Write-Host</span> <span class="s1">&#39;Connection failed! The secure channel between the local computer and the domain is broken. Removing and then rebuilds the channel established by the NetLogon service...&#39;</span>
</span></span><span class="line"><span class="cl">      <span class="nb">Test-ComputerSecureChannel</span> <span class="nv">@Param</span>
</span></span><span class="line"><span class="cl">      <span class="nb">Start-Sleep</span> <span class="n">-s</span> <span class="nv">$P_Sleep</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span> <span class="k">until</span> <span class="p">(</span><span class="nb">Test-ComputerSecureChannel</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c"># -------------------------------------------------------------------------------------------------------------------- #</span>
</span></span><span class="line"><span class="cl"><span class="c"># -------------------------------------------------&lt; RUNNING SCRIPT &gt;------------------------------------------------- #</span>
</span></span><span class="line"><span class="cl"><span class="c"># -------------------------------------------------------------------------------------------------------------------- #</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nb">Start-Script</span></span></span></code></pre></td></tr></table>
</div>
</div>
                </div>
              </div>
            </div>]]></turbo:content></item><item turbo="true"><title>Изменение порта RDP</title><link>https://lib.onl/ru/2023/10/616da78a-eb16-575a-9119-65f0c0c7baee/</link><pubDate>Thu, 26 Oct 2023 23:35:50 +0000</pubDate><dc:creator>Kai Kimera</dc:creator><category>MS Windows</category><category>Терминал</category><category>Скрипты</category><yandex:related><link url="https://lib.onl/ru/2023/10/c6e32349-8fc2-53f9-9a42-790878a64076/">PowerShell: Полезные функции</link><link url="https://lib.onl/ru/2023/10/52d75b90-0637-5ba6-91d6-b1bff40e1d67/">PowerShell: Стирание диска</link><link url="https://lib.onl/ru/2023/10/2a73410a-6611-570c-9ab4-dc8cc8998146/">PowerShell: Сжатие видео при помощи FFmpeg</link><link url="https://lib.onl/ru/2023/10/0028821e-c96c-5014-a1dd-8963c161b170/">PowerShell: Определение разрядности ОС Windows</link><link url="https://lib.onl/ru/2023/10/4c7aba7c-f5a6-589a-9975-fdb16f2e2862/">PowerShell Vault</link><link url="https://lib.onl/ru/2023/10/eb39e3f7-b194-53d4-8bad-01edf9fdac47/">Дефрагментация в ОС Windows</link><link url="https://lib.onl/ru/2023/10/75075788-9308-56b7-b531-2008cb35f7d0/">Установка сертификата НУЦ Минцифры</link><link url="https://lib.onl/ru/2022/05/36058650-3f35-5ed5-9565-0aa7d8800c28/">Windows Server 2022 для рабочей станции</link></yandex:related><turbo:extendedHtml>true</turbo:extendedHtml><turbo:source>https://lib.onl/ru/2023/10/616da78a-eb16-575a-9119-65f0c0c7baee/</turbo:source><turbo:topic>Изменение порта RDP</turbo:topic><turbo:content><![CDATA[<p>По умолчанию, <span class="shortcode shortcode-tag"><a href="/ru/tags/rdp/" target="_blank">#RDP</a></span> использует порт <span class="shortcode shortcode-tag">TCP</span> <code>3389</code>, но по каким-либо обстоятельствам приходится его менять. Рассмотрим два способа изменения порта RDP.</p>
<h2 id="ручное-изменение-порта">
  <a class="link-body-emphasis" href="#%d1%80%d1%83%d1%87%d0%bd%d0%be%d0%b5-%d0%b8%d0%b7%d0%bc%d0%b5%d0%bd%d0%b5%d0%bd%d0%b8%d0%b5-%d0%bf%d0%be%d1%80%d1%82%d0%b0">Ручное изменение порта</a>
</h2><p>Для изменения порта <span class="shortcode shortcode-tag"><a href="/ru/tags/rdp/" target="_blank">#RDP</a></span>, нужно отредактировать реестр:</p>
<ol>
<li>Открыть редактор реестра <code>regedit.exe</code>.</li>
<li>Пройти по пути <code>HKEY_LOCAL_MACHINE\System\CurrentControlSet\Control\Terminal Server\WinStations\RDP-Tcp</code>.</li>
<li>Найти параметр <code>PortNumber</code>.</li>
<li>Ввести новый номер порта (decimal).</li>
<li>Перезагрузить компьютер.</li>
</ol>




    








    
    






<div class="shortcode shortcode-alert">
  <div class="alert alert-warning d-flex overflow-hidden" role="alert">
    <div class="flex-shrink-0 align-self-center">
      <i class="fas fa-exclamation-triangle fa-fw fa-2x"></i>
    </div>
    <div class="flex-grow-1 ms-3 overflow-hidden">
        <p>Если включён брандмауэр, необходимо в нём разрешить подключение через новый порт <!-- raw HTML omitted --><!-- raw HTML omitted -->#RDP<!-- raw HTML omitted --><!-- raw HTML omitted -->.</p>

    </div>
  </div>
</div>

<h2 id="автоматизация">
  <a class="link-body-emphasis" href="#%d0%b0%d0%b2%d1%82%d0%be%d0%bc%d0%b0%d1%82%d0%b8%d0%b7%d0%b0%d1%86%d0%b8%d1%8f">Автоматизация</a>
</h2><p>Весь процесс можно автоматизировать при помощи скрипта.</p>
<h3 id="параметры">
  <a class="link-body-emphasis" href="#%d0%bf%d0%b0%d1%80%d0%b0%d0%bc%d0%b5%d1%82%d1%80%d1%8b">Параметры</a>
</h3><p>Скрипт имеет один единственный параметр, это номер порта.</p>
<ul>
<li><code>-P</code> <code>-P_Port</code> - номер порта <span class="shortcode shortcode-tag"><a href="/ru/tags/rdp/" target="_blank">#RDP</a></span>.</li>
</ul>
<h3 id="примеры">
  <a class="link-body-emphasis" href="#%d0%bf%d1%80%d0%b8%d0%bc%d0%b5%d1%80%d1%8b">Примеры</a>
</h3><p>Запускается скрипт обычным способом. В параметре <code>-P</code> указывается новый номер порта <span class="shortcode shortcode-tag"><a href="/ru/tags/rdp/" target="_blank">#RDP</a></span>.</p>











<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-0 shortcode-codeblock-terminal
shortcode-codeblock-terminal-windows
shortcode-codeblock-terminal-windows-root">
  <div class="card overflow-hidden" data-bs-theme="dark">
    <div class="card-header">
      <div class="d-flex align-items-center">
        <div class="flex-shrink-0 text-danger">
          <i class="fas fa-terminal fa-fw"></i>
        </div>
        <div class="flex-grow-1 mx-2">
          <h5 class="mb-0">Терминал</h5>
        </div>
        <div class="flex-shrink-0">
          <ul class="list-inline mb-0">
            <li class="list-inline-item" title='Копировать'>
              <a class="text-body" href="#"
                 data-fn="clipboard" data-clipboard-target="#cp-f385eb5e165a2569d00678040fd2427f"
                 role="button" aria-label='Копировать'>
                <i class="fas fa-copy fa-fw"></i>
              </a>
            </li>
          </ul>
        </div>
      </div>
    </div>
    <div class="card-body p-0 overflow-auto" id="cp-f385eb5e165a2569d00678040fd2427f"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-plaintext" data-lang="plaintext"><span class="line"><span class="cl">.\pwsh.rdp.port.ps1 -P 50102</span></span></code></pre></td></tr></table>
</div>
</div></div>
  </div>
</div>
<h3 id="алгоритм-работы">
  <a class="link-body-emphasis" href="#%d0%b0%d0%bb%d0%b3%d0%be%d1%80%d0%b8%d1%82%d0%bc-%d1%80%d0%b0%d0%b1%d0%be%d1%82%d1%8b">Алгоритм работы</a>
</h3><ul>
<li>Проверяется в реестре корректность пути и изменяется номер порта <span class="shortcode shortcode-tag"><a href="/ru/tags/rdp/" target="_blank">#RDP</a></span>. Если путь не найден, то скрипт аварийно завершает работу без дальнейших изменений.</li>
<li>В брандмауэр вносится два правила, которые разрешают подключение к новому порту <span class="shortcode shortcode-tag"><a href="/ru/tags/rdp/" target="_blank">#RDP</a></span>.</li>
<li>Если служба <code>TermService</code> (служба удаленных рабочих столов) запущена, она перезапускается, применяя новые параметры порта <span class="shortcode shortcode-tag"><a href="/ru/tags/rdp/" target="_blank">#RDP</a></span>.</li>
</ul>
<h3 id="скрипт">
  <a class="link-body-emphasis" href="#%d1%81%d0%ba%d1%80%d0%b8%d0%bf%d1%82">Скрипт</a>
</h3>
    

    
        
            
            <div class="shortcode shortcode-file mb-3">
              <div class="card overflow-hidden" data-bs-theme="dark">
                <div class="card-header">
                  <div class="d-flex align-items-center">
                    <div class="flex-shrink-0">
                      <i class="far fa-file-code fa-fw"></i>
                    </div>
                    <div class="flex-grow-1 mx-2 text-truncate">
                      <code>pwsh.rdp.port.ps1</code>
                    </div>
                    <div class="flex-shrink-0">
                      <ul class="list-inline mb-0">
                        <li class="list-inline-item" title='Копировать'>
                          <a class="text-body" href="#"
                             data-fn="clipboard" data-clipboard-target="#cp-c0b0d5ce5384cf37932ce259e06804d1"
                             role="button" aria-label='Копировать'>
                            <i class="fas fa-copy fa-fw"></i>
                          </a>
                        </li>
                        <li class="list-inline-item" title='Скачать'>
                          <a class="text-body" href="/ru/2023/10/616da78a-eb16-575a-9119-65f0c0c7baee/pwsh.rdp.port.ps1" download
                             role="button" aria-label='Скачать'>
                            <i class="fas fa-download fa-fw"></i>
                          </a>
                        </li>
                        <li class="list-inline-item" title='Открыть'>
                          <a class="text-body" href="/ru/2023/10/616da78a-eb16-575a-9119-65f0c0c7baee/pwsh.rdp.port.ps1" target="_blank"
                             role="button" aria-label='Открыть'>
                            <i class="fas fa-arrow-up-right-from-square fa-fw"></i>
                          </a>
                        </li>
                      </ul>
                    </div>
                  </div>
                </div>
                <div class="card-body p-0 overflow-auto" id="cp-c0b0d5ce5384cf37932ce259e06804d1">
                    
                        
                    
                    <div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">  1
</span><span class="lnt">  2
</span><span class="lnt">  3
</span><span class="lnt">  4
</span><span class="lnt">  5
</span><span class="lnt">  6
</span><span class="lnt">  7
</span><span class="lnt">  8
</span><span class="lnt">  9
</span><span class="lnt"> 10
</span><span class="lnt"> 11
</span><span class="lnt"> 12
</span><span class="lnt"> 13
</span><span class="lnt"> 14
</span><span class="lnt"> 15
</span><span class="lnt"> 16
</span><span class="lnt"> 17
</span><span class="lnt"> 18
</span><span class="lnt"> 19
</span><span class="lnt"> 20
</span><span class="lnt"> 21
</span><span class="lnt"> 22
</span><span class="lnt"> 23
</span><span class="lnt"> 24
</span><span class="lnt"> 25
</span><span class="lnt"> 26
</span><span class="lnt"> 27
</span><span class="lnt"> 28
</span><span class="lnt"> 29
</span><span class="lnt"> 30
</span><span class="lnt"> 31
</span><span class="lnt"> 32
</span><span class="lnt"> 33
</span><span class="lnt"> 34
</span><span class="lnt"> 35
</span><span class="lnt"> 36
</span><span class="lnt"> 37
</span><span class="lnt"> 38
</span><span class="lnt"> 39
</span><span class="lnt"> 40
</span><span class="lnt"> 41
</span><span class="lnt"> 42
</span><span class="lnt"> 43
</span><span class="lnt"> 44
</span><span class="lnt"> 45
</span><span class="lnt"> 46
</span><span class="lnt"> 47
</span><span class="lnt"> 48
</span><span class="lnt"> 49
</span><span class="lnt"> 50
</span><span class="lnt"> 51
</span><span class="lnt"> 52
</span><span class="lnt"> 53
</span><span class="lnt"> 54
</span><span class="lnt"> 55
</span><span class="lnt"> 56
</span><span class="lnt"> 57
</span><span class="lnt"> 58
</span><span class="lnt"> 59
</span><span class="lnt"> 60
</span><span class="lnt"> 61
</span><span class="lnt"> 62
</span><span class="lnt"> 63
</span><span class="lnt"> 64
</span><span class="lnt"> 65
</span><span class="lnt"> 66
</span><span class="lnt"> 67
</span><span class="lnt"> 68
</span><span class="lnt"> 69
</span><span class="lnt"> 70
</span><span class="lnt"> 71
</span><span class="lnt"> 72
</span><span class="lnt"> 73
</span><span class="lnt"> 74
</span><span class="lnt"> 75
</span><span class="lnt"> 76
</span><span class="lnt"> 77
</span><span class="lnt"> 78
</span><span class="lnt"> 79
</span><span class="lnt"> 80
</span><span class="lnt"> 81
</span><span class="lnt"> 82
</span><span class="lnt"> 83
</span><span class="lnt"> 84
</span><span class="lnt"> 85
</span><span class="lnt"> 86
</span><span class="lnt"> 87
</span><span class="lnt"> 88
</span><span class="lnt"> 89
</span><span class="lnt"> 90
</span><span class="lnt"> 91
</span><span class="lnt"> 92
</span><span class="lnt"> 93
</span><span class="lnt"> 94
</span><span class="lnt"> 95
</span><span class="lnt"> 96
</span><span class="lnt"> 97
</span><span class="lnt"> 98
</span><span class="lnt"> 99
</span><span class="lnt">100
</span><span class="lnt">101
</span><span class="lnt">102
</span><span class="lnt">103
</span><span class="lnt">104
</span><span class="lnt">105
</span><span class="lnt">106
</span><span class="lnt">107
</span><span class="lnt">108
</span><span class="lnt">109
</span><span class="lnt">110
</span><span class="lnt">111
</span><span class="lnt">112
</span><span class="lnt">113
</span><span class="lnt">114
</span><span class="lnt">115
</span><span class="lnt">116
</span><span class="lnt">117
</span><span class="lnt">118
</span><span class="lnt">119
</span><span class="lnt">120
</span><span class="lnt">121
</span><span class="lnt">122
</span><span class="lnt">123
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-ps1" data-lang="ps1"><span class="line"><span class="cl"><span class="cm">&lt;#PSScriptInfo
</span></span></span><span class="line"><span class="cl"><span class="cm">.VERSION      0.1.0
</span></span></span><span class="line"><span class="cl"><span class="cm">.GUID         5d2bddd9-4eed-42f0-a0ba-7d30efcb81e2
</span></span></span><span class="line"><span class="cl"><span class="cm">.AUTHOR       Kai Kimera
</span></span></span><span class="line"><span class="cl"><span class="cm">.AUTHOREMAIL  mail@kai.kim
</span></span></span><span class="line"><span class="cl"><span class="cm">.COMPANYNAME  Library Online
</span></span></span><span class="line"><span class="cl"><span class="cm">.COPYRIGHT    2023 Library Online. All rights reserved.
</span></span></span><span class="line"><span class="cl"><span class="cm">.LICENSEURI   https://choosealicense.com/licenses/mit/
</span></span></span><span class="line"><span class="cl"><span class="cm">.PROJECTURI   https://lib.onl/ru/2023/10/616da78a-eb16-575a-9119-65f0c0c7baee/
</span></span></span><span class="line"><span class="cl"><span class="cm">#&gt;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c">#</span><span class="k">Requires</span><span class="w"> </span><span class="kd">-Version</span><span class="na"> 7.2</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c">#</span><span class="k">Requires</span><span class="w"> </span><span class="kd">-RunAsAdministrator</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="cm">&lt;#
</span></span></span><span class="line"><span class="cl"><span class="cm">.</span><span class="sd">SYNOPSIS</span><span class="cm">
</span></span></span><span class="line"><span class="cl"><span class="cm">Changing the RDP port number.
</span></span></span><span class="line"><span class="cl"><span class="cm">
</span></span></span><span class="line"><span class="cl"><span class="cm">.</span><span class="sd">DESCRIPTION</span><span class="cm">
</span></span></span><span class="line"><span class="cl"><span class="cm">Changing the listening port for Remote Desktop on your computer.
</span></span></span><span class="line"><span class="cl"><span class="cm">
</span></span></span><span class="line"><span class="cl"><span class="cm">.PARAMETER P_Port
</span></span></span><span class="line"><span class="cl"><span class="cm">RDP port number.
</span></span></span><span class="line"><span class="cl"><span class="cm">Default: 3389.
</span></span></span><span class="line"><span class="cl"><span class="cm">
</span></span></span><span class="line"><span class="cl"><span class="cm">.</span><span class="sd">EXAMPLE</span><span class="cm">
</span></span></span><span class="line"><span class="cl"><span class="cm">.\pwsh.rdp.port.ps1 -P 50102
</span></span></span><span class="line"><span class="cl"><span class="cm">
</span></span></span><span class="line"><span class="cl"><span class="cm">.</span><span class="sd">LINK</span><span class="cm">
</span></span></span><span class="line"><span class="cl"><span class="cm">https://lib.onl/ru/2023/10/616da78a-eb16-575a-9119-65f0c0c7baee/
</span></span></span><span class="line"><span class="cl"><span class="cm">#&gt;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c"># -------------------------------------------------------------------------------------------------------------------- #</span>
</span></span><span class="line"><span class="cl"><span class="c"># CONFIGURATION</span>
</span></span><span class="line"><span class="cl"><span class="c"># -------------------------------------------------------------------------------------------------------------------- #</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">param</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">  <span class="p">[</span><span class="nb">Parameter</span><span class="p">(</span><span class="na">HelpMessage</span><span class="p">=</span><span class="s2">&#34;RDP port number.&#34;</span><span class="p">)]</span>
</span></span><span class="line"><span class="cl">  <span class="p">[</span><span class="nb">ValidatePattern</span><span class="p">(</span><span class="s1">&#39;^[0-9]+$&#39;</span><span class="p">)]</span>
</span></span><span class="line"><span class="cl">  <span class="p">[</span><span class="nb">Alias</span><span class="p">(</span><span class="s1">&#39;P&#39;</span><span class="p">)][</span><span class="no">int</span><span class="p">]</span><span class="nv">$P_Port</span> <span class="p">=</span> <span class="mf">3389</span>
</span></span><span class="line"><span class="cl"><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c"># -------------------------------------------------------------------------------------------------------------------- #</span>
</span></span><span class="line"><span class="cl"><span class="c"># INITIALIZATION</span>
</span></span><span class="line"><span class="cl"><span class="c"># -------------------------------------------------------------------------------------------------------------------- #</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kd">function</span><span class="w"> </span><span class="nb">Start-Script</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="nb">Start-RdpRegistry</span>
</span></span><span class="line"><span class="cl">  <span class="nb">Start-RdpFirewall</span>
</span></span><span class="line"><span class="cl">  <span class="nb">Start-RdpService</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c"># -------------------------------------------------------------------------------------------------------------------- #</span>
</span></span><span class="line"><span class="cl"><span class="c"># EDITING THE REGISTRY</span>
</span></span><span class="line"><span class="cl"><span class="c"># -------------------------------------------------------------------------------------------------------------------- #</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kd">function</span><span class="w"> </span><span class="nb">Start-RdpRegistry</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="nv">$Path</span> <span class="p">=</span> <span class="s1">&#39;HKLM:\SYSTEM\CurrentControlSet\Control\Terminal Server\WinStations\RDP-Tcp&#39;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="nv">$Param</span> <span class="p">=</span> <span class="vm">@</span><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">LiteralPath</span> <span class="p">=</span> <span class="s2">&#34;</span><span class="nv">${Path}</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="n">Name</span> <span class="p">=</span> <span class="s1">&#39;PortNumber&#39;</span>
</span></span><span class="line"><span class="cl">    <span class="n">Value</span> <span class="p">=</span> <span class="nv">$P_Port</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="k">if</span> <span class="p">(</span><span class="nb">Test-Path</span> <span class="n">-LiteralPath</span> <span class="s2">&#34;</span><span class="nv">${Path}</span><span class="s2">&#34;</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nb">Set-ItemProperty</span> <span class="nv">@Param</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nb">Write-Error</span> <span class="n">-Message</span> <span class="s2">&#34;&#39;</span><span class="nv">${Path}</span><span class="s2">&#39; not found!&#34;</span> <span class="n">-ErrorAction</span> <span class="s1">&#39;Stop&#39;</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c"># -------------------------------------------------------------------------------------------------------------------- #</span>
</span></span><span class="line"><span class="cl"><span class="c"># EDITING THE FIREWALL</span>
</span></span><span class="line"><span class="cl"><span class="c"># -------------------------------------------------------------------------------------------------------------------- #</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kd">function</span><span class="w"> </span><span class="nb">Start-RdpFirewall</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="nv">$TCP</span> <span class="p">=</span> <span class="vm">@</span><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">DisplayName</span> <span class="p">=</span> <span class="s1">&#39;Custom RDP Port (TCP-In)&#39;</span>
</span></span><span class="line"><span class="cl">    <span class="n">Profile</span> <span class="p">=</span> <span class="s1">&#39;Public&#39;</span>
</span></span><span class="line"><span class="cl">    <span class="n">Direction</span> <span class="p">=</span> <span class="n">Inbound</span>
</span></span><span class="line"><span class="cl">    <span class="n">Action</span> <span class="p">=</span> <span class="n">Allow</span>
</span></span><span class="line"><span class="cl">    <span class="n">Protocol</span> <span class="p">=</span> <span class="n">TCP</span>
</span></span><span class="line"><span class="cl">    <span class="n">LocalPort</span> <span class="p">=</span> <span class="nv">$P_Port</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="nv">$UDP</span> <span class="p">=</span> <span class="vm">@</span><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">DisplayName</span> <span class="p">=</span> <span class="s1">&#39;Custom RDP Port (UDP-In)&#39;</span>
</span></span><span class="line"><span class="cl">    <span class="n">Profile</span> <span class="p">=</span> <span class="s1">&#39;Public&#39;</span>
</span></span><span class="line"><span class="cl">    <span class="n">Direction</span> <span class="p">=</span> <span class="n">Inbound</span>
</span></span><span class="line"><span class="cl">    <span class="n">Action</span> <span class="p">=</span> <span class="n">Allow</span>
</span></span><span class="line"><span class="cl">    <span class="n">Protocol</span> <span class="p">=</span> <span class="n">UDP</span>
</span></span><span class="line"><span class="cl">    <span class="n">LocalPort</span> <span class="p">=</span> <span class="nv">$P_Port</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="nb">New-NetFirewallRule</span> <span class="nv">@TCP</span>
</span></span><span class="line"><span class="cl">  <span class="nb">New-NetFirewallRule</span> <span class="nv">@UDP</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c"># -------------------------------------------------------------------------------------------------------------------- #</span>
</span></span><span class="line"><span class="cl"><span class="c"># RESTARTING THE REMOTE DESKTOP SERVICES</span>
</span></span><span class="line"><span class="cl"><span class="c"># -------------------------------------------------------------------------------------------------------------------- #</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kd">function</span><span class="w"> </span><span class="nb">Start-RdpService</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="nv">$Name</span> <span class="p">=</span> <span class="s1">&#39;TermService&#39;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="nv">$Param</span> <span class="p">=</span> <span class="vm">@</span><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">Name</span> <span class="p">=</span> <span class="s2">&#34;</span><span class="nv">${Name}</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="n">Force</span> <span class="p">=</span> <span class="vm">$true</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="k">if</span> <span class="p">((</span><span class="nb">Get-Service</span> <span class="n">-Name</span> <span class="s2">&#34;</span><span class="nv">${Name}</span><span class="s2">&#34;</span><span class="p">).</span><span class="py">Status</span> <span class="o">-eq</span> <span class="s1">&#39;Running&#39;</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nb">Restart-Service</span> <span class="nv">@Param</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nb">Write-Host</span> <span class="s2">&#34;Service &#39;</span><span class="nv">${Name}</span><span class="s2">&#39; not running!&#34;</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c"># -------------------------------------------------------------------------------------------------------------------- #</span>
</span></span><span class="line"><span class="cl"><span class="c"># -------------------------------------------------&lt; RUNNING SCRIPT &gt;------------------------------------------------- #</span>
</span></span><span class="line"><span class="cl"><span class="c"># -------------------------------------------------------------------------------------------------------------------- #</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nb">Start-Script</span></span></span></code></pre></td></tr></table>
</div>
</div>
                </div>
              </div>
            </div>]]></turbo:content></item><item turbo="true"><title>PowerShell: Полезные функции</title><link>https://lib.onl/ru/2023/10/c6e32349-8fc2-53f9-9a42-790878a64076/</link><pubDate>Tue, 24 Oct 2023 03:38:45 +0000</pubDate><dc:creator>Kai Kimera</dc:creator><category>MS Windows</category><category>Терминал</category><category>Скрипты</category><yandex:related><link url="https://lib.onl/ru/2023/10/52d75b90-0637-5ba6-91d6-b1bff40e1d67/">PowerShell: Стирание диска</link><link url="https://lib.onl/ru/2023/10/2a73410a-6611-570c-9ab4-dc8cc8998146/">PowerShell: Сжатие видео при помощи FFmpeg</link><link url="https://lib.onl/ru/2023/10/0028821e-c96c-5014-a1dd-8963c161b170/">PowerShell: Определение разрядности ОС Windows</link><link url="https://lib.onl/ru/2023/10/4c7aba7c-f5a6-589a-9975-fdb16f2e2862/">PowerShell Vault</link><link url="https://lib.onl/ru/2023/10/eb39e3f7-b194-53d4-8bad-01edf9fdac47/">Дефрагментация в ОС Windows</link><link url="https://lib.onl/ru/2023/10/75075788-9308-56b7-b531-2008cb35f7d0/">Установка сертификата НУЦ Минцифры</link><link url="https://lib.onl/ru/2022/05/36058650-3f35-5ed5-9565-0aa7d8800c28/">Windows Server 2022 для рабочей станции</link></yandex:related><turbo:extendedHtml>true</turbo:extendedHtml><turbo:source>https://lib.onl/ru/2023/10/c6e32349-8fc2-53f9-9a42-790878a64076/</turbo:source><turbo:topic>PowerShell: Полезные функции</turbo:topic><turbo:content><![CDATA[<p>Полезные функции <span class="shortcode shortcode-tag"><a href="/ru/tags/powershell/" target="_blank">#PowerShell</a></span>, которые я пишу сам или нахожу в интернете. Очень помогает в работе и в скриптах.</p>
<h2 id="найти-файлы-старше-x-дней-с-момента-создания">
  <a class="link-body-emphasis" href="#%d0%bd%d0%b0%d0%b9%d1%82%d0%b8-%d1%84%d0%b0%d0%b9%d0%bb%d1%8b-%d1%81%d1%82%d0%b0%d1%80%d1%88%d0%b5-x-%d0%b4%d0%bd%d0%b5%d0%b9-%d1%81-%d0%bc%d0%be%d0%bc%d0%b5%d0%bd%d1%82%d0%b0-%d1%81%d0%be%d0%b7%d0%b4%d0%b0%d0%bd%d0%b8%d1%8f">Найти файлы старше X дней с момента создания</a>
</h2><p>Функция позволяет найти и вывести элементы старше X дней по свойству <code>CreationTime</code>.</p>
<h3 id="параметры">
  <a class="link-body-emphasis" href="#%d0%bf%d0%b0%d1%80%d0%b0%d0%bc%d0%b5%d1%82%d1%80%d1%8b">Параметры</a>
</h3><ul>
<li><code>-P</code> - путь к директории, в которой необходимо найти файлы.</li>
<li><code>-T</code> - время, прошедшее с момента создания файла (в секундах).</li>
</ul>

    

    
        
            
            <div class="shortcode shortcode-file mb-3">
              <div class="card overflow-hidden" data-bs-theme="dark">
                <div class="card-header">
                  <div class="d-flex align-items-center">
                    <div class="flex-shrink-0">
                      <i class="far fa-file-code fa-fw"></i>
                    </div>
                    <div class="flex-grow-1 mx-2 text-truncate">
                      <code>pwsh.find.ct.ps1</code>
                    </div>
                    <div class="flex-shrink-0">
                      <ul class="list-inline mb-0">
                        <li class="list-inline-item" title='Копировать'>
                          <a class="text-body" href="#"
                             data-fn="clipboard" data-clipboard-target="#cp-e3687d3c5ec797199cb269e177f69828"
                             role="button" aria-label='Копировать'>
                            <i class="fas fa-copy fa-fw"></i>
                          </a>
                        </li>
                        <li class="list-inline-item" title='Скачать'>
                          <a class="text-body" href="/ru/2023/10/c6e32349-8fc2-53f9-9a42-790878a64076/pwsh.find.ct.ps1" download
                             role="button" aria-label='Скачать'>
                            <i class="fas fa-download fa-fw"></i>
                          </a>
                        </li>
                        <li class="list-inline-item" title='Открыть'>
                          <a class="text-body" href="/ru/2023/10/c6e32349-8fc2-53f9-9a42-790878a64076/pwsh.find.ct.ps1" target="_blank"
                             role="button" aria-label='Открыть'>
                            <i class="fas fa-arrow-up-right-from-square fa-fw"></i>
                          </a>
                        </li>
                      </ul>
                    </div>
                  </div>
                </div>
                <div class="card-body p-0 overflow-auto" id="cp-e3687d3c5ec797199cb269e177f69828">
                    
                        
                    
                    <div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-ps1" data-lang="ps1"><span class="line"><span class="cl"><span class="k">param</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">  <span class="p">[</span><span class="nb">Alias</span><span class="p">(</span><span class="s1">&#39;P&#39;</span><span class="p">)][</span><span class="no">string</span><span class="p">]</span><span class="nv">$Path</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">  <span class="p">[</span><span class="nb">Alias</span><span class="p">(</span><span class="s1">&#39;T&#39;</span><span class="p">)][</span><span class="no">long</span><span class="p">]</span><span class="nv">$Time</span>
</span></span><span class="line"><span class="cl"><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kd">function</span><span class="w"> </span><span class="nb">Find-CreationTime</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="nb">Get-ChildItem</span> <span class="n">-Path</span> <span class="s2">&#34;</span><span class="nv">${Path}</span><span class="s2">&#34;</span> <span class="n">-Recurse</span> <span class="o">-File</span>
</span></span><span class="line"><span class="cl">    <span class="p">|</span> <span class="nb">Sort-Object</span> <span class="n">-Property</span> <span class="s1">&#39;LastAccessTime&#39;</span>
</span></span><span class="line"><span class="cl">    <span class="p">|</span> <span class="nb">Where-Object</span> <span class="p">{</span> <span class="p">((</span><span class="nv">$_</span><span class="p">.</span><span class="n">CreationTime</span><span class="p">)</span> <span class="o">-lt</span> <span class="p">((</span><span class="nb">Get-Date</span><span class="p">).</span><span class="py">AddSeconds</span><span class="p">(-</span><span class="nv">$Time</span><span class="p">)))</span> <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nb">Find-CreationTime</span></span></span></code></pre></td></tr></table>
</div>
</div>
                </div>
              </div>
            </div>
        
    




    










    
    




<div class="shortcode shortcode-alert">
  <div class="alert alert-success d-flex overflow-hidden" role="alert">
    <div class="flex-shrink-0 align-self-center">
      <i class="fas fa-lightbulb fa-fw fa-2x"></i>
    </div>
    <div class="flex-grow-1 ms-3 overflow-hidden">
        <p><code>.AddSeconds</code> можно заменить на <code>.AddDays</code>, чтобы отсчитывать дату не в секундах, а в днях.</p>

    </div>
  </div>
</div>

<h2 id="найти-файлы-старше-x-дней-с-момента-изменения">
  <a class="link-body-emphasis" href="#%d0%bd%d0%b0%d0%b9%d1%82%d0%b8-%d1%84%d0%b0%d0%b9%d0%bb%d1%8b-%d1%81%d1%82%d0%b0%d1%80%d1%88%d0%b5-x-%d0%b4%d0%bd%d0%b5%d0%b9-%d1%81-%d0%bc%d0%be%d0%bc%d0%b5%d0%bd%d1%82%d0%b0-%d0%b8%d0%b7%d0%bc%d0%b5%d0%bd%d0%b5%d0%bd%d0%b8%d1%8f">Найти файлы старше X дней с момента изменения</a>
</h2><p>Функция позволяет найти и вывести элементы старше X дней по свойству <code>LastWriteTime</code>.</p>
<h3 id="параметры-1">
  <a class="link-body-emphasis" href="#%d0%bf%d0%b0%d1%80%d0%b0%d0%bc%d0%b5%d1%82%d1%80%d1%8b-1">Параметры</a>
</h3><ul>
<li><code>-P</code> - путь к директории, в которой необходимо найти файлы.</li>
<li><code>-T</code> - время, прошедшее с момента изменения файла (в секундах).</li>
</ul>




    










    
    




<div class="shortcode shortcode-alert">
  <div class="alert alert-success d-flex overflow-hidden" role="alert">
    <div class="flex-shrink-0 align-self-center">
      <i class="fas fa-lightbulb fa-fw fa-2x"></i>
    </div>
    <div class="flex-grow-1 ms-3 overflow-hidden">
        <p><code>.AddSeconds</code> можно заменить на <code>.AddDays</code>, чтобы отсчитывать дату не в секундах, а в днях.</p>

    </div>
  </div>
</div>


    

    
        
            
            <div class="shortcode shortcode-file mb-3">
              <div class="card overflow-hidden" data-bs-theme="dark">
                <div class="card-header">
                  <div class="d-flex align-items-center">
                    <div class="flex-shrink-0">
                      <i class="far fa-file-code fa-fw"></i>
                    </div>
                    <div class="flex-grow-1 mx-2 text-truncate">
                      <code>pwsh.find.lwt.ps1</code>
                    </div>
                    <div class="flex-shrink-0">
                      <ul class="list-inline mb-0">
                        <li class="list-inline-item" title='Копировать'>
                          <a class="text-body" href="#"
                             data-fn="clipboard" data-clipboard-target="#cp-f44d4df4f908750f24969a8b485d1752"
                             role="button" aria-label='Копировать'>
                            <i class="fas fa-copy fa-fw"></i>
                          </a>
                        </li>
                        <li class="list-inline-item" title='Скачать'>
                          <a class="text-body" href="/ru/2023/10/c6e32349-8fc2-53f9-9a42-790878a64076/pwsh.find.lwt.ps1" download
                             role="button" aria-label='Скачать'>
                            <i class="fas fa-download fa-fw"></i>
                          </a>
                        </li>
                        <li class="list-inline-item" title='Открыть'>
                          <a class="text-body" href="/ru/2023/10/c6e32349-8fc2-53f9-9a42-790878a64076/pwsh.find.lwt.ps1" target="_blank"
                             role="button" aria-label='Открыть'>
                            <i class="fas fa-arrow-up-right-from-square fa-fw"></i>
                          </a>
                        </li>
                      </ul>
                    </div>
                  </div>
                </div>
                <div class="card-body p-0 overflow-auto" id="cp-f44d4df4f908750f24969a8b485d1752">
                    
                        
                    
                    <div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-ps1" data-lang="ps1"><span class="line"><span class="cl"><span class="k">param</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">  <span class="p">[</span><span class="nb">Alias</span><span class="p">(</span><span class="s1">&#39;P&#39;</span><span class="p">)][</span><span class="no">string</span><span class="p">]</span><span class="nv">$Path</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">  <span class="p">[</span><span class="nb">Alias</span><span class="p">(</span><span class="s1">&#39;T&#39;</span><span class="p">)][</span><span class="no">long</span><span class="p">]</span><span class="nv">$Time</span>
</span></span><span class="line"><span class="cl"><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kd">function</span><span class="w"> </span><span class="nb">Find-LastWriteTime</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="nb">Get-ChildItem</span> <span class="n">-Path</span> <span class="s2">&#34;</span><span class="nv">${Path}</span><span class="s2">&#34;</span> <span class="n">-Recurse</span> <span class="o">-File</span>
</span></span><span class="line"><span class="cl">    <span class="p">|</span> <span class="nb">Sort-Object</span> <span class="n">-Property</span> <span class="s1">&#39;LastAccessTime&#39;</span>
</span></span><span class="line"><span class="cl">    <span class="p">|</span> <span class="nb">Where-Object</span> <span class="p">{</span> <span class="p">((</span><span class="nv">$_</span><span class="p">.</span><span class="n">LastWriteTime</span><span class="p">)</span> <span class="o">-lt</span> <span class="p">((</span><span class="nb">Get-Date</span><span class="p">).</span><span class="py">AddSeconds</span><span class="p">(-</span><span class="nv">$Time</span><span class="p">)))</span> <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nb">Find-LastWriteTime</span></span></span></code></pre></td></tr></table>
</div>
</div>
                </div>
              </div>
            </div>
        
    
<h2 id="создать-новый-элемент">
  <a class="link-body-emphasis" href="#%d1%81%d0%be%d0%b7%d0%b4%d0%b0%d1%82%d1%8c-%d0%bd%d0%be%d0%b2%d1%8b%d0%b9-%d1%8d%d0%bb%d0%b5%d0%bc%d0%b5%d0%bd%d1%82">Создать новый элемент</a>
</h2><p>Функция позволяет создавать элементы. Ничего экстраординарного здесь нет, просто функция, укорачивающая стандартный cmdlet <code>New-Item</code>.</p>
<h3 id="параметры-2">
  <a class="link-body-emphasis" href="#%d0%bf%d0%b0%d1%80%d0%b0%d0%bc%d0%b5%d1%82%d1%80%d1%8b-2">Параметры</a>
</h3><ul>
<li><code>-T</code> - тип элемента.
<ul>
<li><code>'D'</code> - директория.</li>
<li><code>'F'</code> - файл.</li>
</ul>
</li>
<li><code>-P</code> - путь к директории, в которой необходимо создать элемент.</li>
<li><code>-N</code> - название элемента.</li>
</ul>

    

    
        
            
            <div class="shortcode shortcode-file mb-3">
              <div class="card overflow-hidden" data-bs-theme="dark">
                <div class="card-header">
                  <div class="d-flex align-items-center">
                    <div class="flex-shrink-0">
                      <i class="far fa-file-code fa-fw"></i>
                    </div>
                    <div class="flex-grow-1 mx-2 text-truncate">
                      <code>pwsh.new.item.ps1</code>
                    </div>
                    <div class="flex-shrink-0">
                      <ul class="list-inline mb-0">
                        <li class="list-inline-item" title='Копировать'>
                          <a class="text-body" href="#"
                             data-fn="clipboard" data-clipboard-target="#cp-3708da6074417f419cdde723bbeebbef"
                             role="button" aria-label='Копировать'>
                            <i class="fas fa-copy fa-fw"></i>
                          </a>
                        </li>
                        <li class="list-inline-item" title='Скачать'>
                          <a class="text-body" href="/ru/2023/10/c6e32349-8fc2-53f9-9a42-790878a64076/pwsh.new.item.ps1" download
                             role="button" aria-label='Скачать'>
                            <i class="fas fa-download fa-fw"></i>
                          </a>
                        </li>
                        <li class="list-inline-item" title='Открыть'>
                          <a class="text-body" href="/ru/2023/10/c6e32349-8fc2-53f9-9a42-790878a64076/pwsh.new.item.ps1" target="_blank"
                             role="button" aria-label='Открыть'>
                            <i class="fas fa-arrow-up-right-from-square fa-fw"></i>
                          </a>
                        </li>
                      </ul>
                    </div>
                  </div>
                </div>
                <div class="card-body p-0 overflow-auto" id="cp-3708da6074417f419cdde723bbeebbef">
                    
                        
                    
                    <div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-ps1" data-lang="ps1"><span class="line"><span class="cl"><span class="k">param</span> <span class="p">(</span>
</span></span><span class="line"><span class="cl">  <span class="p">[</span><span class="nb">Alias</span><span class="p">(</span><span class="s1">&#39;T&#39;</span><span class="p">)][</span><span class="no">string</span><span class="p">]</span><span class="nv">$Type</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">  <span class="p">[</span><span class="nb">Alias</span><span class="p">(</span><span class="s1">&#39;P&#39;</span><span class="p">)][</span><span class="no">string</span><span class="p">]</span><span class="nv">$Path</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">  <span class="p">[</span><span class="nb">Alias</span><span class="p">(</span><span class="s1">&#39;N&#39;</span><span class="p">)][</span><span class="no">string</span><span class="p">]</span><span class="nv">$Name</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">  <span class="p">[</span><span class="nb">Alias</span><span class="p">(</span><span class="s1">&#39;A&#39;</span><span class="p">)][</span><span class="no">string</span><span class="p">]</span><span class="nv">$Action</span> <span class="p">=</span> <span class="s1">&#39;SilentlyContinue&#39;</span>
</span></span><span class="line"><span class="cl"><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kd">function</span><span class="w"> </span><span class="nb">New-Data</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="k">switch</span> <span class="p">(</span><span class="nv">$Type</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="s1">&#39;D&#39;</span> <span class="p">{</span> <span class="nv">$Type</span> <span class="p">=</span> <span class="s1">&#39;Directory&#39;</span> <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="s1">&#39;F&#39;</span> <span class="p">{</span> <span class="nv">$Type</span> <span class="p">=</span> <span class="s1">&#39;File&#39;</span> <span class="p">}</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="nb">New-Item</span> <span class="n">-Path</span> <span class="s2">&#34;</span><span class="nv">${Path}</span><span class="s2">&#34;</span> <span class="n">-Name</span> <span class="s2">&#34;</span><span class="nv">${Name}</span><span class="s2">&#34;</span> <span class="n">-ItemType</span> <span class="s2">&#34;</span><span class="nv">${Type}</span><span class="s2">&#34;</span> <span class="n">-ErrorAction</span> <span class="s2">&#34;</span><span class="nv">${Action}</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nb">New-Data</span></span></span></code></pre></td></tr></table>
</div>
</div>
                </div>
              </div>
            </div>
        
    
<h2 id="проверить-существование-элемента">
  <a class="link-body-emphasis" href="#%d0%bf%d1%80%d0%be%d0%b2%d0%b5%d1%80%d0%b8%d1%82%d1%8c-%d1%81%d1%83%d1%89%d0%b5%d1%81%d1%82%d0%b2%d0%be%d0%b2%d0%b0%d0%bd%d0%b8%d0%b5-%d1%8d%d0%bb%d0%b5%d0%bc%d0%b5%d0%bd%d1%82%d0%b0">Проверить существование элемента</a>
</h2><p>Функция позволяет &ldquo;безопасно&rdquo; проверить существование элемента. Применяется параметр <code>-LiteralPath</code>, который интерпретирует путь без какой-либо обработки.</p>
<h3 id="параметры-3">
  <a class="link-body-emphasis" href="#%d0%bf%d0%b0%d1%80%d0%b0%d0%bc%d0%b5%d1%82%d1%80%d1%8b-3">Параметры</a>
</h3><ul>
<li><code>-T</code> - тип элемента.</li>
<li><code>-P</code> - путь к директории, в которой необходимо проверить элемент.</li>
</ul>

    

    
        
            
            <div class="shortcode shortcode-file mb-3">
              <div class="card overflow-hidden" data-bs-theme="dark">
                <div class="card-header">
                  <div class="d-flex align-items-center">
                    <div class="flex-shrink-0">
                      <i class="far fa-file-code fa-fw"></i>
                    </div>
                    <div class="flex-grow-1 mx-2 text-truncate">
                      <code>pwsh.test.item.ps1</code>
                    </div>
                    <div class="flex-shrink-0">
                      <ul class="list-inline mb-0">
                        <li class="list-inline-item" title='Копировать'>
                          <a class="text-body" href="#"
                             data-fn="clipboard" data-clipboard-target="#cp-2876fb4eace4eee77b316c4cf67f8b2a"
                             role="button" aria-label='Копировать'>
                            <i class="fas fa-copy fa-fw"></i>
                          </a>
                        </li>
                        <li class="list-inline-item" title='Скачать'>
                          <a class="text-body" href="/ru/2023/10/c6e32349-8fc2-53f9-9a42-790878a64076/pwsh.test.item.ps1" download
                             role="button" aria-label='Скачать'>
                            <i class="fas fa-download fa-fw"></i>
                          </a>
                        </li>
                        <li class="list-inline-item" title='Открыть'>
                          <a class="text-body" href="/ru/2023/10/c6e32349-8fc2-53f9-9a42-790878a64076/pwsh.test.item.ps1" target="_blank"
                             role="button" aria-label='Открыть'>
                            <i class="fas fa-arrow-up-right-from-square fa-fw"></i>
                          </a>
                        </li>
                      </ul>
                    </div>
                  </div>
                </div>
                <div class="card-body p-0 overflow-auto" id="cp-2876fb4eace4eee77b316c4cf67f8b2a">
                    
                        
                    
                    <div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-ps1" data-lang="ps1"><span class="line"><span class="cl"><span class="k">param</span> <span class="p">(</span>
</span></span><span class="line"><span class="cl">  <span class="p">[</span><span class="nb">Alias</span><span class="p">(</span><span class="s1">&#39;T&#39;</span><span class="p">)][</span><span class="no">string</span><span class="p">]</span><span class="nv">$Type</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">  <span class="p">[</span><span class="nb">Alias</span><span class="p">(</span><span class="s1">&#39;P&#39;</span><span class="p">)][</span><span class="no">string</span><span class="p">]</span><span class="nv">$Path</span>
</span></span><span class="line"><span class="cl"><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kd">function</span><span class="w"> </span><span class="nb">Test-Data</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="k">switch</span> <span class="p">(</span><span class="nv">$Type</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="s1">&#39;D&#39;</span> <span class="p">{</span> <span class="nv">$Type</span> <span class="p">=</span> <span class="s1">&#39;Container&#39;</span> <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="s1">&#39;F&#39;</span> <span class="p">{</span> <span class="nv">$Type</span> <span class="p">=</span> <span class="s1">&#39;Leaf&#39;</span> <span class="p">}</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="nb">Test-Path</span> <span class="n">-LiteralPath</span> <span class="s2">&#34;</span><span class="nv">${Path}</span><span class="s2">&#34;</span> <span class="n">-PathType</span> <span class="s2">&#34;</span><span class="nv">${Type}</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nb">Test-Data</span></span></span></code></pre></td></tr></table>
</div>
</div>
                </div>
              </div>
            </div>
        
    
<h2 id="проверить-существование-модуля">
  <a class="link-body-emphasis" href="#%d0%bf%d1%80%d0%be%d0%b2%d0%b5%d1%80%d0%b8%d1%82%d1%8c-%d1%81%d1%83%d1%89%d0%b5%d1%81%d1%82%d0%b2%d0%be%d0%b2%d0%b0%d0%bd%d0%b8%d0%b5-%d0%bc%d0%be%d0%b4%d1%83%d0%bb%d1%8f">Проверить существование модуля</a>
</h2><p>Функция позволяет проверить существование модуля PowerShell в памяти компьютера.</p>
<h3 id="параметры-4">
  <a class="link-body-emphasis" href="#%d0%bf%d0%b0%d1%80%d0%b0%d0%bc%d0%b5%d1%82%d1%80%d1%8b-4">Параметры</a>
</h3><ul>
<li><code>-N</code> - название модуля.</li>
</ul>

    

    
        
            
            <div class="shortcode shortcode-file mb-3">
              <div class="card overflow-hidden" data-bs-theme="dark">
                <div class="card-header">
                  <div class="d-flex align-items-center">
                    <div class="flex-shrink-0">
                      <i class="far fa-file-code fa-fw"></i>
                    </div>
                    <div class="flex-grow-1 mx-2 text-truncate">
                      <code>pwsh.test.module.ps1</code>
                    </div>
                    <div class="flex-shrink-0">
                      <ul class="list-inline mb-0">
                        <li class="list-inline-item" title='Копировать'>
                          <a class="text-body" href="#"
                             data-fn="clipboard" data-clipboard-target="#cp-5b80f62278485614d726358c12963f0b"
                             role="button" aria-label='Копировать'>
                            <i class="fas fa-copy fa-fw"></i>
                          </a>
                        </li>
                        <li class="list-inline-item" title='Скачать'>
                          <a class="text-body" href="/ru/2023/10/c6e32349-8fc2-53f9-9a42-790878a64076/pwsh.test.module.ps1" download
                             role="button" aria-label='Скачать'>
                            <i class="fas fa-download fa-fw"></i>
                          </a>
                        </li>
                        <li class="list-inline-item" title='Открыть'>
                          <a class="text-body" href="/ru/2023/10/c6e32349-8fc2-53f9-9a42-790878a64076/pwsh.test.module.ps1" target="_blank"
                             role="button" aria-label='Открыть'>
                            <i class="fas fa-arrow-up-right-from-square fa-fw"></i>
                          </a>
                        </li>
                      </ul>
                    </div>
                  </div>
                </div>
                <div class="card-body p-0 overflow-auto" id="cp-5b80f62278485614d726358c12963f0b">
                    
                        
                    
                    <div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-ps1" data-lang="ps1"><span class="line"><span class="cl"><span class="k">param</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">  <span class="p">[</span><span class="nb">Alias</span><span class="p">(</span><span class="s1">&#39;N&#39;</span><span class="p">)][</span><span class="no">string[]</span><span class="p">]</span><span class="nv">$Names</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">  <span class="p">[</span><span class="nb">Alias</span><span class="p">(</span><span class="s1">&#39;A&#39;</span><span class="p">)][</span><span class="no">string</span><span class="p">]</span><span class="nv">$Action</span> <span class="p">=</span> <span class="s1">&#39;Stop&#39;</span>
</span></span><span class="line"><span class="cl"><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kd">function</span><span class="w"> </span><span class="nb">Test-Module</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="k">ForEach</span> <span class="p">(</span><span class="nv">$Name</span> <span class="k">in</span> <span class="nv">$Names</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="p">(</span><span class="o">-not</span> <span class="p">(</span><span class="nb">Get-Module</span> <span class="n">-ListAvailable</span> <span class="n">-Name</span> <span class="s2">&#34;</span><span class="nv">${Name}</span><span class="s2">&#34;</span><span class="p">))</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="nb">Write-Error</span> <span class="n">-Message</span> <span class="s2">&#34;Module &#39;</span><span class="nv">${Name}</span><span class="s2">&#39; not installed!&#34;</span> <span class="n">-ErrorAction</span> <span class="s2">&#34;</span><span class="nv">${Action}</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nb">Test-Module</span></span></span></code></pre></td></tr></table>
</div>
</div>
                </div>
              </div>
            </div>
        
    
<h2 id="вывести-сообщение-в-терминал">
  <a class="link-body-emphasis" href="#%d0%b2%d1%8b%d0%b2%d0%b5%d1%81%d1%82%d0%b8-%d1%81%d0%be%d0%be%d0%b1%d1%89%d0%b5%d0%bd%d0%b8%d0%b5-%d0%b2-%d1%82%d0%b5%d1%80%d0%bc%d0%b8%d0%bd%d0%b0%d0%bb">Вывести сообщение в терминал</a>
</h2><p>Функция выводит информацию в терминал по типу сообщений.</p>
<h3 id="параметры-5">
  <a class="link-body-emphasis" href="#%d0%bf%d0%b0%d1%80%d0%b0%d0%bc%d0%b5%d1%82%d1%80%d1%8b-5">Параметры</a>
</h3><ul>
<li><code>-T</code> - тип сообщения.
<ul>
<li><code>'HL'</code> - заголовок.</li>
<li><code>'I'</code> - информационное сообщение.</li>
<li><code>'W'</code> - предупреждение (warning).</li>
<li><code>'E'</code> - ошибка (error).</li>
</ul>
</li>
<li><code>-M</code> - текст сообщения.</li>
<li><code>-A</code> - действие, которое необходимо выполнить при выводе сообщения в терминал.</li>
</ul>

    

    
        
            
            <div class="shortcode shortcode-file mb-3">
              <div class="card overflow-hidden" data-bs-theme="dark">
                <div class="card-header">
                  <div class="d-flex align-items-center">
                    <div class="flex-shrink-0">
                      <i class="far fa-file-code fa-fw"></i>
                    </div>
                    <div class="flex-grow-1 mx-2 text-truncate">
                      <code>pwsh.write.msg.ps1</code>
                    </div>
                    <div class="flex-shrink-0">
                      <ul class="list-inline mb-0">
                        <li class="list-inline-item" title='Копировать'>
                          <a class="text-body" href="#"
                             data-fn="clipboard" data-clipboard-target="#cp-30dbbe39665207a18539af30dd6e2a7e"
                             role="button" aria-label='Копировать'>
                            <i class="fas fa-copy fa-fw"></i>
                          </a>
                        </li>
                        <li class="list-inline-item" title='Скачать'>
                          <a class="text-body" href="/ru/2023/10/c6e32349-8fc2-53f9-9a42-790878a64076/pwsh.write.msg.ps1" download
                             role="button" aria-label='Скачать'>
                            <i class="fas fa-download fa-fw"></i>
                          </a>
                        </li>
                        <li class="list-inline-item" title='Открыть'>
                          <a class="text-body" href="/ru/2023/10/c6e32349-8fc2-53f9-9a42-790878a64076/pwsh.write.msg.ps1" target="_blank"
                             role="button" aria-label='Открыть'>
                            <i class="fas fa-arrow-up-right-from-square fa-fw"></i>
                          </a>
                        </li>
                      </ul>
                    </div>
                  </div>
                </div>
                <div class="card-body p-0 overflow-auto" id="cp-30dbbe39665207a18539af30dd6e2a7e">
                    
                        
                    
                    <div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-ps1" data-lang="ps1"><span class="line"><span class="cl"><span class="k">param</span> <span class="p">(</span>
</span></span><span class="line"><span class="cl">  <span class="p">[</span><span class="nb">Alias</span><span class="p">(</span><span class="s1">&#39;T&#39;</span><span class="p">)][</span><span class="no">string</span><span class="p">]</span><span class="nv">$Type</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">  <span class="p">[</span><span class="nb">Alias</span><span class="p">(</span><span class="s1">&#39;M&#39;</span><span class="p">)][</span><span class="no">string</span><span class="p">]</span><span class="nv">$Message</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">  <span class="p">[</span><span class="nb">Alias</span><span class="p">(</span><span class="s1">&#39;A&#39;</span><span class="p">)][</span><span class="no">string</span><span class="p">]</span><span class="nv">$Action</span> <span class="p">=</span> <span class="s1">&#39;Continue&#39;</span>
</span></span><span class="line"><span class="cl"><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kd">function</span><span class="w"> </span><span class="nb">Write-Msg</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="k">switch</span> <span class="p">(</span><span class="nv">$Type</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="s1">&#39;HL&#39;</span>    <span class="p">{</span> <span class="nb">Write-Host</span> <span class="s2">&#34;</span><span class="nv">${NL}</span><span class="s2">--- </span><span class="nv">${Message}</span><span class="s2">&#34;</span><span class="p">.</span><span class="py">ToUpper</span><span class="p">()</span> <span class="n">-ForegroundColor</span> <span class="n">Blue</span> <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="s1">&#39;I&#39;</span>     <span class="p">{</span> <span class="nb">Write-Information</span> <span class="n">-MessageData</span> <span class="s2">&#34;</span><span class="nv">${Message}</span><span class="s2">&#34;</span> <span class="n">-InformationAction</span> <span class="s2">&#34;</span><span class="nv">${Action}</span><span class="s2">&#34;</span> <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="s1">&#39;W&#39;</span>     <span class="p">{</span> <span class="nb">Write-Warning</span> <span class="n">-Message</span> <span class="s2">&#34;</span><span class="nv">${Message}</span><span class="s2">&#34;</span> <span class="n">-WarningAction</span> <span class="s2">&#34;</span><span class="nv">${Action}</span><span class="s2">&#34;</span> <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="s1">&#39;E&#39;</span>     <span class="p">{</span> <span class="nb">Write-Error</span> <span class="n">-Message</span> <span class="s2">&#34;</span><span class="nv">${Message}</span><span class="s2">&#34;</span> <span class="n">-ErrorAction</span> <span class="s2">&#34;</span><span class="nv">${Action}</span><span class="s2">&#34;</span> <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="k">default</span> <span class="p">{</span> <span class="nb">Write-Host</span> <span class="s2">&#34;</span><span class="nv">${Message}</span><span class="s2">&#34;</span> <span class="p">}</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nb">Write-Msg</span></span></span></code></pre></td></tr></table>
</div>
</div>
                </div>
              </div>
            </div>
        
    
<h2 id="найти-свободную-букву-диска">
  <a class="link-body-emphasis" href="#%d0%bd%d0%b0%d0%b9%d1%82%d0%b8-%d1%81%d0%b2%d0%be%d0%b1%d0%be%d0%b4%d0%bd%d1%83%d1%8e-%d0%b1%d1%83%d0%ba%d0%b2%d1%83-%d0%b4%d0%b8%d1%81%d0%ba%d0%b0">Найти свободную букву диска</a>
</h2><p>Небольшая функция, которая возвращает не занятую букву диска. Используется в <span class="shortcode shortcode-uuid"><a href="/ru/2023/10/52d75b90-0637-5ba6-91d6-b1bff40e1d67/">PowerShell: Стирание диска</a></span>.</p>

    

    
        
            
            <div class="shortcode shortcode-file mb-3">
              <div class="card overflow-hidden" data-bs-theme="dark">
                <div class="card-header">
                  <div class="d-flex align-items-center">
                    <div class="flex-shrink-0">
                      <i class="far fa-file-code fa-fw"></i>
                    </div>
                    <div class="flex-grow-1 mx-2 text-truncate">
                      <code>pwsh.find.adl.ps1</code>
                    </div>
                    <div class="flex-shrink-0">
                      <ul class="list-inline mb-0">
                        <li class="list-inline-item" title='Копировать'>
                          <a class="text-body" href="#"
                             data-fn="clipboard" data-clipboard-target="#cp-4636ee5fccdcdfaaa205c7f468c5a7c8"
                             role="button" aria-label='Копировать'>
                            <i class="fas fa-copy fa-fw"></i>
                          </a>
                        </li>
                        <li class="list-inline-item" title='Скачать'>
                          <a class="text-body" href="/ru/2023/10/c6e32349-8fc2-53f9-9a42-790878a64076/pwsh.find.adl.ps1" download
                             role="button" aria-label='Скачать'>
                            <i class="fas fa-download fa-fw"></i>
                          </a>
                        </li>
                        <li class="list-inline-item" title='Открыть'>
                          <a class="text-body" href="/ru/2023/10/c6e32349-8fc2-53f9-9a42-790878a64076/pwsh.find.adl.ps1" target="_blank"
                             role="button" aria-label='Открыть'>
                            <i class="fas fa-arrow-up-right-from-square fa-fw"></i>
                          </a>
                        </li>
                      </ul>
                    </div>
                  </div>
                </div>
                <div class="card-body p-0 overflow-auto" id="cp-4636ee5fccdcdfaaa205c7f468c5a7c8">
                    
                        
                    
                    <div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-ps1" data-lang="ps1"><span class="line"><span class="cl"><span class="kd">function</span><span class="w"> </span><span class="nb">Find-AvailableDriveLetter</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="p">(</span><span class="mf">68</span><span class="p">.</span><span class="mf">.90</span> <span class="p">|</span> <span class="nb">ForEach-Object</span> <span class="p">{</span> <span class="nv">$L</span><span class="p">=[</span><span class="no">char</span><span class="p">]</span><span class="nv">$_</span><span class="p">;</span> <span class="k">if</span> <span class="p">((</span><span class="nb">Get-PSDrive</span><span class="p">).</span><span class="py">Name</span> <span class="o">-notContains</span> <span class="nv">$L</span><span class="p">)</span> <span class="p">{</span> <span class="nv">$L</span> <span class="p">}</span> <span class="p">})[</span><span class="mf">0</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></td></tr></table>
</div>
</div>
                </div>
              </div>
            </div>
        
    
<h2 id="получить-размер-файла">
  <a class="link-body-emphasis" href="#%d0%bf%d0%be%d0%bb%d1%83%d1%87%d0%b8%d1%82%d1%8c-%d1%80%d0%b0%d0%b7%d0%bc%d0%b5%d1%80-%d1%84%d0%b0%d0%b9%d0%bb%d0%b0">Получить размер файла</a>
</h2><p>Функция позволяет получить размер файла в различных единицах измерения.</p>
<h3 id="параметры-6">
  <a class="link-body-emphasis" href="#%d0%bf%d0%b0%d1%80%d0%b0%d0%bc%d0%b5%d1%82%d1%80%d1%8b-6">Параметры</a>
</h3><ul>
<li><code>-F</code> - название файла.</li>
</ul>

    

    
        
            
            <div class="shortcode shortcode-file mb-3">
              <div class="card overflow-hidden" data-bs-theme="dark">
                <div class="card-header">
                  <div class="d-flex align-items-center">
                    <div class="flex-shrink-0">
                      <i class="far fa-file-code fa-fw"></i>
                    </div>
                    <div class="flex-grow-1 mx-2 text-truncate">
                      <code>pwsh.get.filesize.ps1</code>
                    </div>
                    <div class="flex-shrink-0">
                      <ul class="list-inline mb-0">
                        <li class="list-inline-item" title='Копировать'>
                          <a class="text-body" href="#"
                             data-fn="clipboard" data-clipboard-target="#cp-ea597903d628a59be2eddbf603466c29"
                             role="button" aria-label='Копировать'>
                            <i class="fas fa-copy fa-fw"></i>
                          </a>
                        </li>
                        <li class="list-inline-item" title='Скачать'>
                          <a class="text-body" href="/ru/2023/10/c6e32349-8fc2-53f9-9a42-790878a64076/pwsh.get.filesize.ps1" download
                             role="button" aria-label='Скачать'>
                            <i class="fas fa-download fa-fw"></i>
                          </a>
                        </li>
                        <li class="list-inline-item" title='Открыть'>
                          <a class="text-body" href="/ru/2023/10/c6e32349-8fc2-53f9-9a42-790878a64076/pwsh.get.filesize.ps1" target="_blank"
                             role="button" aria-label='Открыть'>
                            <i class="fas fa-arrow-up-right-from-square fa-fw"></i>
                          </a>
                        </li>
                      </ul>
                    </div>
                  </div>
                </div>
                <div class="card-body p-0 overflow-auto" id="cp-ea597903d628a59be2eddbf603466c29">
                    
                        
                    
                    <div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-ps1" data-lang="ps1"><span class="line"><span class="cl"><span class="k">param</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">  <span class="p">[</span><span class="nb">Alias</span><span class="p">(</span><span class="s1">&#39;F&#39;</span><span class="p">)][</span><span class="no">string</span><span class="p">]</span><span class="nv">$File</span>
</span></span><span class="line"><span class="cl"><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kd">function</span><span class="w"> </span><span class="nb">Get-FileSize</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="p">(</span><span class="nb">Get-Item</span> <span class="s2">&#34;</span><span class="nv">${File}</span><span class="s2">&#34;</span><span class="p">).</span><span class="py">Length</span>      <span class="c"># Size in bytes.</span>
</span></span><span class="line"><span class="cl">  <span class="p">(</span><span class="nb">Get-Item</span> <span class="s2">&#34;</span><span class="nv">${File}</span><span class="s2">&#34;</span><span class="p">).</span><span class="n">Length</span><span class="p">/</span><span class="mf">1</span><span class="p">KB</span>  <span class="c"># Size in KB.</span>
</span></span><span class="line"><span class="cl">  <span class="p">(</span><span class="nb">Get-Item</span> <span class="s2">&#34;</span><span class="nv">${File}</span><span class="s2">&#34;</span><span class="p">).</span><span class="n">Length</span><span class="p">/</span><span class="mf">1</span><span class="p">MB</span>  <span class="c"># Size in MB.</span>
</span></span><span class="line"><span class="cl">  <span class="p">(</span><span class="nb">Get-Item</span> <span class="s2">&#34;</span><span class="nv">${File}</span><span class="s2">&#34;</span><span class="p">).</span><span class="n">Length</span><span class="p">/</span><span class="mf">1</span><span class="p">GB</span>  <span class="c"># Size in GB.</span>
</span></span><span class="line"><span class="cl">  <span class="p">(</span><span class="nb">Get-Item</span> <span class="s2">&#34;</span><span class="nv">${File}</span><span class="s2">&#34;</span><span class="p">).</span><span class="n">Length</span><span class="p">/</span><span class="mf">1</span><span class="p">TB</span>  <span class="c"># Size in TB.</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nb">Get-FileSize</span></span></span></code></pre></td></tr></table>
</div>
</div>
                </div>
              </div>
            </div>
        
    
<h2 id="работа-с-архивами-7-zip">
  <a class="link-body-emphasis" href="#%d1%80%d0%b0%d0%b1%d0%be%d1%82%d0%b0-%d1%81-%d0%b0%d1%80%d1%85%d0%b8%d0%b2%d0%b0%d0%bc%d0%b8-7-zip">Работа с архивами 7-Zip</a>
</h2><p>Функции по работе с архивами 7-Zip.</p>
<h3 id="параметры-7">
  <a class="link-body-emphasis" href="#%d0%bf%d0%b0%d1%80%d0%b0%d0%bc%d0%b5%d1%82%d1%80%d1%8b-7">Параметры</a>
</h3><ul>
<li><code>-F</code> - путь к файлу.</li>
</ul>
<h3 id="упаковка">
  <a class="link-body-emphasis" href="#%d1%83%d0%bf%d0%b0%d0%ba%d0%be%d0%b2%d0%ba%d0%b0">Упаковка</a>
</h3>
    

    
        
            
            <div class="shortcode shortcode-file mb-3">
              <div class="card overflow-hidden" data-bs-theme="dark">
                <div class="card-header">
                  <div class="d-flex align-items-center">
                    <div class="flex-shrink-0">
                      <i class="far fa-file-code fa-fw"></i>
                    </div>
                    <div class="flex-grow-1 mx-2 text-truncate">
                      <code>pwsh.compress.7z.ps1</code>
                    </div>
                    <div class="flex-shrink-0">
                      <ul class="list-inline mb-0">
                        <li class="list-inline-item" title='Копировать'>
                          <a class="text-body" href="#"
                             data-fn="clipboard" data-clipboard-target="#cp-521c07747916f3b90d2e1a34a726f79b"
                             role="button" aria-label='Копировать'>
                            <i class="fas fa-copy fa-fw"></i>
                          </a>
                        </li>
                        <li class="list-inline-item" title='Скачать'>
                          <a class="text-body" href="/ru/2023/10/c6e32349-8fc2-53f9-9a42-790878a64076/pwsh.compress.7z.ps1" download
                             role="button" aria-label='Скачать'>
                            <i class="fas fa-download fa-fw"></i>
                          </a>
                        </li>
                        <li class="list-inline-item" title='Открыть'>
                          <a class="text-body" href="/ru/2023/10/c6e32349-8fc2-53f9-9a42-790878a64076/pwsh.compress.7z.ps1" target="_blank"
                             role="button" aria-label='Открыть'>
                            <i class="fas fa-arrow-up-right-from-square fa-fw"></i>
                          </a>
                        </li>
                      </ul>
                    </div>
                  </div>
                </div>
                <div class="card-body p-0 overflow-auto" id="cp-521c07747916f3b90d2e1a34a726f79b">
                    
                        
                    
                    <div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-ps1" data-lang="ps1"><span class="line"><span class="cl"><span class="k">param</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">  <span class="p">[</span><span class="nb">Alias</span><span class="p">(</span><span class="s1">&#39;F&#39;</span><span class="p">)][</span><span class="no">string</span><span class="p">]</span><span class="nv">$File</span>
</span></span><span class="line"><span class="cl"><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kd">function</span><span class="w"> </span><span class="nb">Compress-A7z</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="nb">Get-ChildItem</span> <span class="s2">&#34;</span><span class="nv">${File}</span><span class="s2">&#34;</span> <span class="p">|</span> <span class="nb">ForEach-Object</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="p">&amp;</span> <span class="s2">&#34;</span><span class="p">$(</span><span class="nv">$Env:ProgramFiles</span><span class="p">)</span><span class="s2">\7-Zip\7z.exe&#34;</span> <span class="n">a</span> <span class="s2">&#34;</span><span class="p">$(</span><span class="nv">$_</span><span class="p">.</span><span class="py">FullName</span> <span class="p">+</span> <span class="s1">&#39;.7z&#39;</span><span class="p">)</span><span class="s2">&#34;</span> <span class="s2">&#34;</span><span class="p">$(</span><span class="nv">$_</span><span class="p">.</span><span class="n">FullName</span><span class="p">)</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nb">Compress-A7z</span></span></span></code></pre></td></tr></table>
</div>
</div>
                </div>
              </div>
            </div>
        
    
<h3 id="распаковка">
  <a class="link-body-emphasis" href="#%d1%80%d0%b0%d1%81%d0%bf%d0%b0%d0%ba%d0%be%d0%b2%d0%ba%d0%b0">Распаковка</a>
</h3>
    

    
        
            
            <div class="shortcode shortcode-file mb-3">
              <div class="card overflow-hidden" data-bs-theme="dark">
                <div class="card-header">
                  <div class="d-flex align-items-center">
                    <div class="flex-shrink-0">
                      <i class="far fa-file-code fa-fw"></i>
                    </div>
                    <div class="flex-grow-1 mx-2 text-truncate">
                      <code>pwsh.expand.7z.ps1</code>
                    </div>
                    <div class="flex-shrink-0">
                      <ul class="list-inline mb-0">
                        <li class="list-inline-item" title='Копировать'>
                          <a class="text-body" href="#"
                             data-fn="clipboard" data-clipboard-target="#cp-b007fb00f7e7887235d54b41e3ecbe29"
                             role="button" aria-label='Копировать'>
                            <i class="fas fa-copy fa-fw"></i>
                          </a>
                        </li>
                        <li class="list-inline-item" title='Скачать'>
                          <a class="text-body" href="/ru/2023/10/c6e32349-8fc2-53f9-9a42-790878a64076/pwsh.expand.7z.ps1" download
                             role="button" aria-label='Скачать'>
                            <i class="fas fa-download fa-fw"></i>
                          </a>
                        </li>
                        <li class="list-inline-item" title='Открыть'>
                          <a class="text-body" href="/ru/2023/10/c6e32349-8fc2-53f9-9a42-790878a64076/pwsh.expand.7z.ps1" target="_blank"
                             role="button" aria-label='Открыть'>
                            <i class="fas fa-arrow-up-right-from-square fa-fw"></i>
                          </a>
                        </li>
                      </ul>
                    </div>
                  </div>
                </div>
                <div class="card-body p-0 overflow-auto" id="cp-b007fb00f7e7887235d54b41e3ecbe29">
                    
                        
                    
                    <div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-ps1" data-lang="ps1"><span class="line"><span class="cl"><span class="k">param</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">  <span class="p">[</span><span class="nb">Alias</span><span class="p">(</span><span class="s1">&#39;F&#39;</span><span class="p">)][</span><span class="no">string</span><span class="p">]</span><span class="nv">$File</span>
</span></span><span class="line"><span class="cl"><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kd">function</span><span class="w"> </span><span class="nb">Expand-A7z</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="nb">Get-ChildItem</span> <span class="s2">&#34;</span><span class="nv">${File}</span><span class="s2">&#34;</span> <span class="p">|</span> <span class="nb">ForEach-Object</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="p">&amp;</span> <span class="s2">&#34;</span><span class="p">$(</span><span class="nv">$Env:ProgramFiles</span><span class="p">)</span><span class="s2">\7-Zip\7z.exe&#34;</span> <span class="n">x</span> <span class="s2">&#34;</span><span class="p">$(</span><span class="nv">$_</span><span class="p">.</span><span class="n">FullName</span><span class="p">)</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nb">Expand-A7z</span></span></span></code></pre></td></tr></table>
</div>
</div>
                </div>
              </div>
            </div>
        
    
<h2 id="работа-с-архивами-winrar">
  <a class="link-body-emphasis" href="#%d1%80%d0%b0%d0%b1%d0%be%d1%82%d0%b0-%d1%81-%d0%b0%d1%80%d1%85%d0%b8%d0%b2%d0%b0%d0%bc%d0%b8-winrar">Работа с архивами WinRAR</a>
</h2><p>Функции по работе с архивами WinRAR.</p>
<h3 id="параметры-8">
  <a class="link-body-emphasis" href="#%d0%bf%d0%b0%d1%80%d0%b0%d0%bc%d0%b5%d1%82%d1%80%d1%8b-8">Параметры</a>
</h3><ul>
<li><code>-F</code> - путь к файлу.</li>
</ul>
<h3 id="упаковка-1">
  <a class="link-body-emphasis" href="#%d1%83%d0%bf%d0%b0%d0%ba%d0%be%d0%b2%d0%ba%d0%b0-1">Упаковка</a>
</h3>
    

    
        
            
            <div class="shortcode shortcode-file mb-3">
              <div class="card overflow-hidden" data-bs-theme="dark">
                <div class="card-header">
                  <div class="d-flex align-items-center">
                    <div class="flex-shrink-0">
                      <i class="far fa-file-code fa-fw"></i>
                    </div>
                    <div class="flex-grow-1 mx-2 text-truncate">
                      <code>pwsh.compress.rar.ps1</code>
                    </div>
                    <div class="flex-shrink-0">
                      <ul class="list-inline mb-0">
                        <li class="list-inline-item" title='Копировать'>
                          <a class="text-body" href="#"
                             data-fn="clipboard" data-clipboard-target="#cp-4b0342564aaf803e0df1c340adf3726b"
                             role="button" aria-label='Копировать'>
                            <i class="fas fa-copy fa-fw"></i>
                          </a>
                        </li>
                        <li class="list-inline-item" title='Скачать'>
                          <a class="text-body" href="/ru/2023/10/c6e32349-8fc2-53f9-9a42-790878a64076/pwsh.compress.rar.ps1" download
                             role="button" aria-label='Скачать'>
                            <i class="fas fa-download fa-fw"></i>
                          </a>
                        </li>
                        <li class="list-inline-item" title='Открыть'>
                          <a class="text-body" href="/ru/2023/10/c6e32349-8fc2-53f9-9a42-790878a64076/pwsh.compress.rar.ps1" target="_blank"
                             role="button" aria-label='Открыть'>
                            <i class="fas fa-arrow-up-right-from-square fa-fw"></i>
                          </a>
                        </li>
                      </ul>
                    </div>
                  </div>
                </div>
                <div class="card-body p-0 overflow-auto" id="cp-4b0342564aaf803e0df1c340adf3726b">
                    
                        
                    
                    <div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-ps1" data-lang="ps1"><span class="line"><span class="cl"><span class="k">param</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">  <span class="p">[</span><span class="nb">Alias</span><span class="p">(</span><span class="s1">&#39;F&#39;</span><span class="p">)][</span><span class="no">string</span><span class="p">]</span><span class="nv">$File</span>
</span></span><span class="line"><span class="cl"><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kd">function</span><span class="w"> </span><span class="nb">Compress-RAR</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="nb">Get-ChildItem</span> <span class="s2">&#34;</span><span class="nv">${File}</span><span class="s2">&#34;</span> <span class="p">|</span> <span class="nb">ForEach-Object</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="p">&amp;</span> <span class="s2">&#34;</span><span class="p">$(</span><span class="nv">$Env:ProgramFiles</span><span class="p">)</span><span class="s2">\WinRAR\Rar.exe&#34;</span> <span class="n">a</span> <span class="s2">&#34;</span><span class="p">$(</span><span class="nv">$_</span><span class="p">.</span><span class="py">FullName</span> <span class="p">+</span> <span class="s1">&#39;.rar&#39;</span><span class="p">)</span><span class="s2">&#34;</span> <span class="s2">&#34;</span><span class="p">$(</span><span class="nv">$_</span><span class="p">.</span><span class="n">FullName</span><span class="p">)</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nb">Compress-RAR</span></span></span></code></pre></td></tr></table>
</div>
</div>
                </div>
              </div>
            </div>
        
    
<h3 id="распаковка-1">
  <a class="link-body-emphasis" href="#%d1%80%d0%b0%d1%81%d0%bf%d0%b0%d0%ba%d0%be%d0%b2%d0%ba%d0%b0-1">Распаковка</a>
</h3>
    

    
        
            
            <div class="shortcode shortcode-file mb-3">
              <div class="card overflow-hidden" data-bs-theme="dark">
                <div class="card-header">
                  <div class="d-flex align-items-center">
                    <div class="flex-shrink-0">
                      <i class="far fa-file-code fa-fw"></i>
                    </div>
                    <div class="flex-grow-1 mx-2 text-truncate">
                      <code>pwsh.expand.rar.ps1</code>
                    </div>
                    <div class="flex-shrink-0">
                      <ul class="list-inline mb-0">
                        <li class="list-inline-item" title='Копировать'>
                          <a class="text-body" href="#"
                             data-fn="clipboard" data-clipboard-target="#cp-31fe93070c72acca8c82ac69c464b4f0"
                             role="button" aria-label='Копировать'>
                            <i class="fas fa-copy fa-fw"></i>
                          </a>
                        </li>
                        <li class="list-inline-item" title='Скачать'>
                          <a class="text-body" href="/ru/2023/10/c6e32349-8fc2-53f9-9a42-790878a64076/pwsh.expand.rar.ps1" download
                             role="button" aria-label='Скачать'>
                            <i class="fas fa-download fa-fw"></i>
                          </a>
                        </li>
                        <li class="list-inline-item" title='Открыть'>
                          <a class="text-body" href="/ru/2023/10/c6e32349-8fc2-53f9-9a42-790878a64076/pwsh.expand.rar.ps1" target="_blank"
                             role="button" aria-label='Открыть'>
                            <i class="fas fa-arrow-up-right-from-square fa-fw"></i>
                          </a>
                        </li>
                      </ul>
                    </div>
                  </div>
                </div>
                <div class="card-body p-0 overflow-auto" id="cp-31fe93070c72acca8c82ac69c464b4f0">
                    
                        
                    
                    <div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-ps1" data-lang="ps1"><span class="line"><span class="cl"><span class="k">param</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">  <span class="p">[</span><span class="nb">Alias</span><span class="p">(</span><span class="s1">&#39;F&#39;</span><span class="p">)][</span><span class="no">string</span><span class="p">]</span><span class="nv">$File</span>
</span></span><span class="line"><span class="cl"><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kd">function</span><span class="w"> </span><span class="nb">Expand-RAR</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="nb">Get-ChildItem</span> <span class="s2">&#34;</span><span class="nv">${File}</span><span class="s2">&#34;</span> <span class="p">|</span> <span class="nb">ForEach-Object</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="p">&amp;</span> <span class="s2">&#34;</span><span class="p">$(</span><span class="nv">$Env:ProgramFiles</span><span class="p">)</span><span class="s2">\WinRAR\Rar.exe&#34;</span> <span class="n">x</span> <span class="s2">&#34;</span><span class="p">$(</span><span class="nv">$_</span><span class="p">.</span><span class="n">FullName</span><span class="p">)</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nb">Expand-RAR</span></span></span></code></pre></td></tr></table>
</div>
</div>
                </div>
              </div>
            </div>]]></turbo:content></item><item turbo="true"><title>PowerShell: Стирание диска</title><link>https://lib.onl/ru/2023/10/52d75b90-0637-5ba6-91d6-b1bff40e1d67/</link><pubDate>Mon, 23 Oct 2023 11:03:04 +0000</pubDate><dc:creator>Kai Kimera</dc:creator><category>MS Windows</category><category>Терминал</category><category>Скрипты</category><yandex:related><link url="https://lib.onl/ru/2023/10/eb39e3f7-b194-53d4-8bad-01edf9fdac47/">Дефрагментация в ОС Windows</link><link url="https://lib.onl/ru/2023/10/2a73410a-6611-570c-9ab4-dc8cc8998146/">PowerShell: Сжатие видео при помощи FFmpeg</link><link url="https://lib.onl/ru/2023/10/0028821e-c96c-5014-a1dd-8963c161b170/">PowerShell: Определение разрядности ОС Windows</link><link url="https://lib.onl/ru/2023/10/4c7aba7c-f5a6-589a-9975-fdb16f2e2862/">PowerShell Vault</link><link url="https://lib.onl/ru/2023/10/75075788-9308-56b7-b531-2008cb35f7d0/">Установка сертификата НУЦ Минцифры</link><link url="https://lib.onl/ru/2022/05/36058650-3f35-5ed5-9565-0aa7d8800c28/">Windows Server 2022 для рабочей станции</link></yandex:related><turbo:extendedHtml>true</turbo:extendedHtml><turbo:source>https://lib.onl/ru/2023/10/52d75b90-0637-5ba6-91d6-b1bff40e1d67/</turbo:source><turbo:topic>PowerShell: Стирание диска</turbo:topic><turbo:content><![CDATA[<p>Небольшой скрипт, который обнуляет <span class="shortcode shortcode-tag"><a href="/ru/tags/hdd/" target="_blank">#HDD</a></span> / <span class="shortcode shortcode-tag"><a href="/ru/tags/ssd/" target="_blank">#SSD</a></span> и создаёт файловую систему заново.</p>
<h2 id="параметры">
  <a class="link-body-emphasis" href="#%d0%bf%d0%b0%d1%80%d0%b0%d0%bc%d0%b5%d1%82%d1%80%d1%8b">Параметры</a>
</h2><ul>
<li><code>-DN</code> <code>-P_DiskNumber</code> - номер диска. Можно узнать командой <code>Get-Disk</code>. Но если не ввести номер диска в параметры скрипта при запуске, скрипт сам выведет информацию и спросит номер диска. Обязательный параметр.</li>
<li><code>-DL</code> <code>-P_DriveLetter</code> - буква будущего тома. При создании тома, ОС должна присвоить ему букву. Обязательный параметр.</li>
<li><code>-FS</code> <code>-P_FileSystem</code> - файловая система. Может принимать следующие значения:
<ul>
<li><code>'FAT'</code> - файловая система <span class="shortcode shortcode-tag">FAT</span>.</li>
<li><code>'FAT32'</code> - файловая система <span class="shortcode shortcode-tag">FAT32</span>.</li>
<li><code>'exFAT'</code> - файловая система <span class="shortcode shortcode-tag">exFAT</span>.</li>
<li><code>'NTFS'</code> - файловая система <span class="shortcode shortcode-tag">NTFS</span>.</li>
<li><code>'ReFS'</code> - новая файловая система <span class="shortcode shortcode-tag">ReFS</span>.</li>
</ul>
</li>
<li><code>-FSL</code> <code>-P_FileSystemLabel</code> - метка файловой системы.</li>
<li><code>-S</code> <code>-P_Sleep</code> - перерыв между командами (в секундах).</li>
</ul>
<h2 id="примеры">
  <a class="link-body-emphasis" href="#%d0%bf%d1%80%d0%b8%d0%bc%d0%b5%d1%80%d1%8b">Примеры</a>
</h2><p>Скрипт, запущенный без параметров, сам спросит необходимые данные:</p>











<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-0 shortcode-codeblock-terminal
shortcode-codeblock-terminal-windows
shortcode-codeblock-terminal-windows-root">
  <div class="card overflow-hidden" data-bs-theme="dark">
    <div class="card-header">
      <div class="d-flex align-items-center">
        <div class="flex-shrink-0 text-danger">
          <i class="fas fa-terminal fa-fw"></i>
        </div>
        <div class="flex-grow-1 mx-2">
          <h5 class="mb-0">Терминал</h5>
        </div>
        <div class="flex-shrink-0">
          <ul class="list-inline mb-0">
            <li class="list-inline-item" title='Копировать'>
              <a class="text-body" href="#"
                 data-fn="clipboard" data-clipboard-target="#cp-54787ab2c5e060936704ff47bc90dd44"
                 role="button" aria-label='Копировать'>
                <i class="fas fa-copy fa-fw"></i>
              </a>
            </li>
          </ul>
        </div>
      </div>
    </div>
    <div class="card-body p-0 overflow-auto" id="cp-54787ab2c5e060936704ff47bc90dd44"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-plaintext" data-lang="plaintext"><span class="line"><span class="cl">.\pwsh.disk.erase.ps1</span></span></code></pre></td></tr></table>
</div>
</div></div>
  </div>
</div>
<p>Обнулить диск <code>3</code>, новому разделу присвоить букву <code>E</code>, форматировать в <code>NTFS</code> и указать метку <code>USB-SSD</code>:</p>











<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-1 shortcode-codeblock-terminal
shortcode-codeblock-terminal-windows
shortcode-codeblock-terminal-windows-root">
  <div class="card overflow-hidden" data-bs-theme="dark">
    <div class="card-header">
      <div class="d-flex align-items-center">
        <div class="flex-shrink-0 text-danger">
          <i class="fas fa-terminal fa-fw"></i>
        </div>
        <div class="flex-grow-1 mx-2">
          <h5 class="mb-0">Терминал</h5>
        </div>
        <div class="flex-shrink-0">
          <ul class="list-inline mb-0">
            <li class="list-inline-item" title='Копировать'>
              <a class="text-body" href="#"
                 data-fn="clipboard" data-clipboard-target="#cp-6236c9ccbfd5910916aae7eb9ccf19e9"
                 role="button" aria-label='Копировать'>
                <i class="fas fa-copy fa-fw"></i>
              </a>
            </li>
          </ul>
        </div>
      </div>
    </div>
    <div class="card-body p-0 overflow-auto" id="cp-6236c9ccbfd5910916aae7eb9ccf19e9"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-plaintext" data-lang="plaintext"><span class="line"><span class="cl">.\pwsh.disk.erase.ps1 -DN 3 -DL &#39;E&#39; -FS &#39;NTFS&#39; -FSL &#39;USB-SSD&#39;</span></span></code></pre></td></tr></table>
</div>
</div></div>
  </div>
</div>
<h2 id="скрипт">
  <a class="link-body-emphasis" href="#%d1%81%d0%ba%d1%80%d0%b8%d0%bf%d1%82">Скрипт</a>
</h2>
    

    
        
            
            <div class="shortcode shortcode-file mb-3">
              <div class="card overflow-hidden" data-bs-theme="dark">
                <div class="card-header">
                  <div class="d-flex align-items-center">
                    <div class="flex-shrink-0">
                      <i class="far fa-file-code fa-fw"></i>
                    </div>
                    <div class="flex-grow-1 mx-2 text-truncate">
                      <code>pwsh.disk.erase.ps1</code>
                    </div>
                    <div class="flex-shrink-0">
                      <ul class="list-inline mb-0">
                        <li class="list-inline-item" title='Копировать'>
                          <a class="text-body" href="#"
                             data-fn="clipboard" data-clipboard-target="#cp-9eda5c35a8d1ce1d46183808649700ee"
                             role="button" aria-label='Копировать'>
                            <i class="fas fa-copy fa-fw"></i>
                          </a>
                        </li>
                        <li class="list-inline-item" title='Скачать'>
                          <a class="text-body" href="/ru/2023/10/52d75b90-0637-5ba6-91d6-b1bff40e1d67/pwsh.disk.erase.ps1" download
                             role="button" aria-label='Скачать'>
                            <i class="fas fa-download fa-fw"></i>
                          </a>
                        </li>
                        <li class="list-inline-item" title='Открыть'>
                          <a class="text-body" href="/ru/2023/10/52d75b90-0637-5ba6-91d6-b1bff40e1d67/pwsh.disk.erase.ps1" target="_blank"
                             role="button" aria-label='Открыть'>
                            <i class="fas fa-arrow-up-right-from-square fa-fw"></i>
                          </a>
                        </li>
                      </ul>
                    </div>
                  </div>
                </div>
                <div class="card-body p-0 overflow-auto" id="cp-9eda5c35a8d1ce1d46183808649700ee">
                    
                        
                    
                    <div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">  1
</span><span class="lnt">  2
</span><span class="lnt">  3
</span><span class="lnt">  4
</span><span class="lnt">  5
</span><span class="lnt">  6
</span><span class="lnt">  7
</span><span class="lnt">  8
</span><span class="lnt">  9
</span><span class="lnt"> 10
</span><span class="lnt"> 11
</span><span class="lnt"> 12
</span><span class="lnt"> 13
</span><span class="lnt"> 14
</span><span class="lnt"> 15
</span><span class="lnt"> 16
</span><span class="lnt"> 17
</span><span class="lnt"> 18
</span><span class="lnt"> 19
</span><span class="lnt"> 20
</span><span class="lnt"> 21
</span><span class="lnt"> 22
</span><span class="lnt"> 23
</span><span class="lnt"> 24
</span><span class="lnt"> 25
</span><span class="lnt"> 26
</span><span class="lnt"> 27
</span><span class="lnt"> 28
</span><span class="lnt"> 29
</span><span class="lnt"> 30
</span><span class="lnt"> 31
</span><span class="lnt"> 32
</span><span class="lnt"> 33
</span><span class="lnt"> 34
</span><span class="lnt"> 35
</span><span class="lnt"> 36
</span><span class="lnt"> 37
</span><span class="lnt"> 38
</span><span class="lnt"> 39
</span><span class="lnt"> 40
</span><span class="lnt"> 41
</span><span class="lnt"> 42
</span><span class="lnt"> 43
</span><span class="lnt"> 44
</span><span class="lnt"> 45
</span><span class="lnt"> 46
</span><span class="lnt"> 47
</span><span class="lnt"> 48
</span><span class="lnt"> 49
</span><span class="lnt"> 50
</span><span class="lnt"> 51
</span><span class="lnt"> 52
</span><span class="lnt"> 53
</span><span class="lnt"> 54
</span><span class="lnt"> 55
</span><span class="lnt"> 56
</span><span class="lnt"> 57
</span><span class="lnt"> 58
</span><span class="lnt"> 59
</span><span class="lnt"> 60
</span><span class="lnt"> 61
</span><span class="lnt"> 62
</span><span class="lnt"> 63
</span><span class="lnt"> 64
</span><span class="lnt"> 65
</span><span class="lnt"> 66
</span><span class="lnt"> 67
</span><span class="lnt"> 68
</span><span class="lnt"> 69
</span><span class="lnt"> 70
</span><span class="lnt"> 71
</span><span class="lnt"> 72
</span><span class="lnt"> 73
</span><span class="lnt"> 74
</span><span class="lnt"> 75
</span><span class="lnt"> 76
</span><span class="lnt"> 77
</span><span class="lnt"> 78
</span><span class="lnt"> 79
</span><span class="lnt"> 80
</span><span class="lnt"> 81
</span><span class="lnt"> 82
</span><span class="lnt"> 83
</span><span class="lnt"> 84
</span><span class="lnt"> 85
</span><span class="lnt"> 86
</span><span class="lnt"> 87
</span><span class="lnt"> 88
</span><span class="lnt"> 89
</span><span class="lnt"> 90
</span><span class="lnt"> 91
</span><span class="lnt"> 92
</span><span class="lnt"> 93
</span><span class="lnt"> 94
</span><span class="lnt"> 95
</span><span class="lnt"> 96
</span><span class="lnt"> 97
</span><span class="lnt"> 98
</span><span class="lnt"> 99
</span><span class="lnt">100
</span><span class="lnt">101
</span><span class="lnt">102
</span><span class="lnt">103
</span><span class="lnt">104
</span><span class="lnt">105
</span><span class="lnt">106
</span><span class="lnt">107
</span><span class="lnt">108
</span><span class="lnt">109
</span><span class="lnt">110
</span><span class="lnt">111
</span><span class="lnt">112
</span><span class="lnt">113
</span><span class="lnt">114
</span><span class="lnt">115
</span><span class="lnt">116
</span><span class="lnt">117
</span><span class="lnt">118
</span><span class="lnt">119
</span><span class="lnt">120
</span><span class="lnt">121
</span><span class="lnt">122
</span><span class="lnt">123
</span><span class="lnt">124
</span><span class="lnt">125
</span><span class="lnt">126
</span><span class="lnt">127
</span><span class="lnt">128
</span><span class="lnt">129
</span><span class="lnt">130
</span><span class="lnt">131
</span><span class="lnt">132
</span><span class="lnt">133
</span><span class="lnt">134
</span><span class="lnt">135
</span><span class="lnt">136
</span><span class="lnt">137
</span><span class="lnt">138
</span><span class="lnt">139
</span><span class="lnt">140
</span><span class="lnt">141
</span><span class="lnt">142
</span><span class="lnt">143
</span><span class="lnt">144
</span><span class="lnt">145
</span><span class="lnt">146
</span><span class="lnt">147
</span><span class="lnt">148
</span><span class="lnt">149
</span><span class="lnt">150
</span><span class="lnt">151
</span><span class="lnt">152
</span><span class="lnt">153
</span><span class="lnt">154
</span><span class="lnt">155
</span><span class="lnt">156
</span><span class="lnt">157
</span><span class="lnt">158
</span><span class="lnt">159
</span><span class="lnt">160
</span><span class="lnt">161
</span><span class="lnt">162
</span><span class="lnt">163
</span><span class="lnt">164
</span><span class="lnt">165
</span><span class="lnt">166
</span><span class="lnt">167
</span><span class="lnt">168
</span><span class="lnt">169
</span><span class="lnt">170
</span><span class="lnt">171
</span><span class="lnt">172
</span><span class="lnt">173
</span><span class="lnt">174
</span><span class="lnt">175
</span><span class="lnt">176
</span><span class="lnt">177
</span><span class="lnt">178
</span><span class="lnt">179
</span><span class="lnt">180
</span><span class="lnt">181
</span><span class="lnt">182
</span><span class="lnt">183
</span><span class="lnt">184
</span><span class="lnt">185
</span><span class="lnt">186
</span><span class="lnt">187
</span><span class="lnt">188
</span><span class="lnt">189
</span><span class="lnt">190
</span><span class="lnt">191
</span><span class="lnt">192
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-ps1" data-lang="ps1"><span class="line"><span class="cl"><span class="cm">&lt;#PSScriptInfo
</span></span></span><span class="line"><span class="cl"><span class="cm">.VERSION      0.1.0
</span></span></span><span class="line"><span class="cl"><span class="cm">.GUID         8d95f4d5-4d14-412c-9fa4-b75ebe79df09
</span></span></span><span class="line"><span class="cl"><span class="cm">.AUTHOR       Kai Kimera
</span></span></span><span class="line"><span class="cl"><span class="cm">.AUTHOREMAIL  mail@kai.kim
</span></span></span><span class="line"><span class="cl"><span class="cm">.COMPANYNAME  Library Online
</span></span></span><span class="line"><span class="cl"><span class="cm">.COPYRIGHT    2023 Library Online. All rights reserved.
</span></span></span><span class="line"><span class="cl"><span class="cm">.LICENSEURI   https://choosealicense.com/licenses/mit/
</span></span></span><span class="line"><span class="cl"><span class="cm">.PROJECTURI   https://lib.onl/ru/2023/10/52d75b90-0637-5ba6-91d6-b1bff40e1d67/
</span></span></span><span class="line"><span class="cl"><span class="cm">#&gt;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c">#</span><span class="k">Requires</span><span class="w"> </span><span class="kd">-Version</span><span class="na"> 7.2</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c">#</span><span class="k">Requires</span><span class="w"> </span><span class="kd">-RunAsAdministrator</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="cm">&lt;#
</span></span></span><span class="line"><span class="cl"><span class="cm">.</span><span class="sd">SYNOPSIS</span><span class="cm">
</span></span></span><span class="line"><span class="cl"><span class="cm">Disk erase script.
</span></span></span><span class="line"><span class="cl"><span class="cm">
</span></span></span><span class="line"><span class="cl"><span class="cm">.</span><span class="sd">DESCRIPTION</span><span class="cm">
</span></span></span><span class="line"><span class="cl"><span class="cm">Disk cleanup followed by partition creation.
</span></span></span><span class="line"><span class="cl"><span class="cm">
</span></span></span><span class="line"><span class="cl"><span class="cm">.PARAMETER P_DiskNumber
</span></span></span><span class="line"><span class="cl"><span class="cm">Specifies the disk number of the disk on which to perform the clear operation. For a list of available disks, see the &#39;Get-Disk&#39; cmdlet.
</span></span></span><span class="line"><span class="cl"><span class="cm">
</span></span></span><span class="line"><span class="cl"><span class="cm">.PARAMETER P_FileSystem
</span></span></span><span class="line"><span class="cl"><span class="cm">Specifies the file system with which to format the volume.
</span></span></span><span class="line"><span class="cl"><span class="cm">The acceptable values for this parameter are: &#39;NTFS&#39;, &#39;ReFS&#39;, &#39;exFAT&#39;, &#39;FAT32&#39; and &#39;FAT&#39;.
</span></span></span><span class="line"><span class="cl"><span class="cm">
</span></span></span><span class="line"><span class="cl"><span class="cm">.PARAMETER P_Sleep
</span></span></span><span class="line"><span class="cl"><span class="cm">Sleep time (in seconds).
</span></span></span><span class="line"><span class="cl"><span class="cm">
</span></span></span><span class="line"><span class="cl"><span class="cm">.</span><span class="sd">EXAMPLE</span><span class="cm">
</span></span></span><span class="line"><span class="cl"><span class="cm">.\pwsh.disk.erase.ps1 -DN 3 -DL &#39;E&#39; -FS &#39;NTFS&#39; -FSL &#39;USB-SSD&#39;
</span></span></span><span class="line"><span class="cl"><span class="cm">
</span></span></span><span class="line"><span class="cl"><span class="cm">.</span><span class="sd">LINK</span><span class="cm">
</span></span></span><span class="line"><span class="cl"><span class="cm">https://lib.onl/ru/2023/10/52d75b90-0637-5ba6-91d6-b1bff40e1d67/
</span></span></span><span class="line"><span class="cl"><span class="cm">#&gt;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c"># -------------------------------------------------------------------------------------------------------------------- #</span>
</span></span><span class="line"><span class="cl"><span class="c"># CONFIGURATION</span>
</span></span><span class="line"><span class="cl"><span class="c"># -------------------------------------------------------------------------------------------------------------------- #</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">param</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">  <span class="p">[</span><span class="nb">Parameter</span><span class="p">(</span><span class="na">HelpMessage</span><span class="p">=</span><span class="s2">&#34;Specify the disk number.&#34;</span><span class="p">)]</span>
</span></span><span class="line"><span class="cl">  <span class="p">[</span><span class="nb">ValidatePattern</span><span class="p">(</span><span class="s1">&#39;^[0-9]+$&#39;</span><span class="p">)]</span>
</span></span><span class="line"><span class="cl">  <span class="p">[</span><span class="nb">Alias</span><span class="p">(</span><span class="s1">&#39;DN&#39;</span><span class="p">)][</span><span class="no">int</span><span class="p">]</span><span class="nv">$P_DiskNumber</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="p">[</span><span class="nb">Parameter</span><span class="p">(</span><span class="na">HelpMessage</span><span class="p">=</span><span class="s2">&#34;Specify the file system to format the volume.&#34;</span><span class="p">)]</span>
</span></span><span class="line"><span class="cl">  <span class="p">[</span><span class="nb">ValidateSet</span><span class="p">(</span><span class="s1">&#39;FAT&#39;</span><span class="p">,</span> <span class="s1">&#39;FAT32&#39;</span><span class="p">,</span> <span class="s1">&#39;exFAT&#39;</span><span class="p">,</span> <span class="s1">&#39;NTFS&#39;</span><span class="p">,</span> <span class="s1">&#39;ReFS&#39;</span><span class="p">)]</span>
</span></span><span class="line"><span class="cl">  <span class="p">[</span><span class="nb">Alias</span><span class="p">(</span><span class="s1">&#39;FS&#39;</span><span class="p">)][</span><span class="no">string</span><span class="p">]</span><span class="nv">$P_FileSystem</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="p">[</span><span class="nb">Parameter</span><span class="p">(</span><span class="na">HelpMessage</span><span class="p">=</span><span class="s2">&#34;Sleep time (in seconds).&#34;</span><span class="p">)]</span>
</span></span><span class="line"><span class="cl">  <span class="p">[</span><span class="nb">Alias</span><span class="p">(</span><span class="s1">&#39;S&#39;</span><span class="p">)][</span><span class="no">int</span><span class="p">]</span><span class="nv">$P_Sleep</span> <span class="p">=</span> <span class="mf">2</span>
</span></span><span class="line"><span class="cl"><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c"># New line separator.</span>
</span></span><span class="line"><span class="cl"><span class="nv">$NL</span> <span class="p">=</span> <span class="s2">&#34;</span><span class="p">$([</span><span class="no">Environment</span><span class="p">]::</span><span class="n">NewLine</span><span class="p">)</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c"># Random number.</span>
</span></span><span class="line"><span class="cl"><span class="nv">$Random</span> <span class="p">=</span> <span class="s2">&#34;</span><span class="p">$(</span><span class="nb">Get-Random</span> <span class="n">-Minimum</span> <span class="mf">1000</span> <span class="n">-Maximum</span> <span class="mf">9999</span><span class="p">)</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c"># Getting free drive letter and to assign to the new partition.</span>
</span></span><span class="line"><span class="cl"><span class="nv">$DriveLetter</span> <span class="p">=</span> <span class="s2">&#34;</span><span class="p">$((</span><span class="mf">68</span><span class="p">.</span><span class="mf">.90</span> <span class="p">|</span> <span class="nb">ForEach-Object</span> <span class="p">{</span> <span class="nv">$L</span><span class="p">=[</span><span class="no">char</span><span class="p">]</span><span class="nv">$_</span><span class="p">;</span> <span class="k">if</span> <span class="p">((</span><span class="nb">Get-PSDrive</span><span class="p">).</span><span class="py">Name</span> <span class="o">-notContains</span> <span class="nv">$L</span><span class="p">)</span> <span class="p">{</span> <span class="nv">$L</span> <span class="p">}</span> <span class="p">})[</span><span class="mf">0</span><span class="p">])</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c"># Specifying a new label to use for the volume.</span>
</span></span><span class="line"><span class="cl"><span class="nv">$FileSystemLabel</span> <span class="p">=</span> <span class="s2">&#34;DISK_</span><span class="nv">${Random}</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c"># -------------------------------------------------------------------------------------------------------------------- #</span>
</span></span><span class="line"><span class="cl"><span class="c"># INITIALIZATION</span>
</span></span><span class="line"><span class="cl"><span class="c"># -------------------------------------------------------------------------------------------------------------------- #</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kd">function</span><span class="w"> </span><span class="nb">Start-Script</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="nb">Start-DPDiskList</span>        <span class="c"># Showing disk list.</span>
</span></span><span class="line"><span class="cl">  <span class="k">if</span> <span class="p">(</span><span class="o">-not</span> <span class="nv">$P_DiskNumber</span><span class="p">)</span> <span class="p">{</span> <span class="nv">$P_DiskNumber</span> <span class="p">=</span> <span class="p">(</span><span class="nb">Read-Host</span> <span class="n">-Prompt</span> <span class="s1">&#39;Disk number&#39;</span><span class="p">)</span> <span class="p">}</span>   <span class="c"># Getting disk number.</span>
</span></span><span class="line"><span class="cl">  <span class="k">if</span> <span class="p">(</span><span class="o">-not</span> <span class="nv">$P_FileSystem</span><span class="p">)</span> <span class="p">{</span> <span class="nv">$P_FileSystem</span> <span class="p">=</span> <span class="p">(</span><span class="nb">Read-Host</span> <span class="n">-Prompt</span> <span class="s1">&#39;File system&#39;</span><span class="p">)</span> <span class="p">}</span>   <span class="c"># Getting file system.</span>
</span></span><span class="line"><span class="cl">  <span class="nb">Start-DPDiskClear</span>       <span class="c"># Starting clearing disk.</span>
</span></span><span class="line"><span class="cl">  <span class="nb">Start-DPDiskInit</span>        <span class="c"># Initializing disk.</span>
</span></span><span class="line"><span class="cl">  <span class="nb">Start-DPDiskPartition</span>   <span class="c"># Creating partition.</span>
</span></span><span class="line"><span class="cl">  <span class="nb">Start-DPDiskFormat</span>      <span class="c"># Formatting volume.</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c"># -------------------------------------------------------------------------------------------------------------------- #</span>
</span></span><span class="line"><span class="cl"><span class="c"># DISK LIST</span>
</span></span><span class="line"><span class="cl"><span class="c"># -------------------------------------------------------------------------------------------------------------------- #</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kd">function</span><span class="w"> </span><span class="nb">Start-DPDiskList</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="nb">Write-Msg</span> <span class="n">-T</span> <span class="s1">&#39;HL&#39;</span> <span class="n">-M</span> <span class="s1">&#39;Disk List&#39;</span>
</span></span><span class="line"><span class="cl">  <span class="nb">Get-Disk</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c"># -------------------------------------------------------------------------------------------------------------------- #</span>
</span></span><span class="line"><span class="cl"><span class="c"># CLEAR DISK</span>
</span></span><span class="line"><span class="cl"><span class="c"># -------------------------------------------------------------------------------------------------------------------- #</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kd">function</span><span class="w"> </span><span class="nb">Start-DPDiskClear</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="nb">Write-Msg</span> <span class="n">-T</span> <span class="s1">&#39;HL&#39;</span> <span class="n">-M</span> <span class="s2">&#34;[DISK #</span><span class="nv">${P_DiskNumber}</span><span class="s2">] Clear Disk&#34;</span>
</span></span><span class="line"><span class="cl">  <span class="nb">Write-Msg</span> <span class="n">-T</span> <span class="s1">&#39;W&#39;</span> <span class="n">-A</span> <span class="s1">&#39;Inquire&#39;</span> <span class="n">-M</span> <span class="p">(</span><span class="s2">&#34;You specified drive number &#39;</span><span class="nv">${P_DiskNumber}</span><span class="s2">&#39;.</span><span class="nv">${NL}</span><span class="s2">&#34;</span> <span class="p">+</span>
</span></span><span class="line"><span class="cl">  <span class="s2">&#34;All data will be DELETED!&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="nv">$Param</span> <span class="p">=</span> <span class="vm">@</span><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">Number</span> <span class="p">=</span> <span class="nv">$P_DiskNumber</span>
</span></span><span class="line"><span class="cl">    <span class="n">RemoveData</span> <span class="p">=</span> <span class="vm">$true</span>
</span></span><span class="line"><span class="cl">    <span class="n">RemoveOEM</span> <span class="p">=</span> <span class="vm">$true</span>
</span></span><span class="line"><span class="cl">    <span class="n">Confirm</span> <span class="p">=</span> <span class="vm">$false</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="nb">Clear-Disk</span> <span class="nv">@Param</span>
</span></span><span class="line"><span class="cl">  <span class="nb">Start-Sleep</span> <span class="n">-s</span> <span class="nv">$P_Sleep</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c"># -------------------------------------------------------------------------------------------------------------------- #</span>
</span></span><span class="line"><span class="cl"><span class="c"># INITIALIZE DISK</span>
</span></span><span class="line"><span class="cl"><span class="c"># -------------------------------------------------------------------------------------------------------------------- #</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kd">function</span><span class="w"> </span><span class="nb">Start-DPDiskInit</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="nb">Write-Msg</span> <span class="n">-T</span> <span class="s1">&#39;HL&#39;</span> <span class="n">-M</span> <span class="s2">&#34;[DISK #</span><span class="nv">${P_DiskNumber}</span><span class="s2">] Initialize Disk&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="nv">$Param</span> <span class="p">=</span> <span class="vm">@</span><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">Number</span> <span class="p">=</span> <span class="nv">$P_DiskNumber</span>
</span></span><span class="line"><span class="cl">    <span class="n">PartitionStyle</span> <span class="p">=</span> <span class="s1">&#39;GPT&#39;</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="nb">Initialize-Disk</span> <span class="nv">@Param</span>
</span></span><span class="line"><span class="cl">  <span class="nb">Start-Sleep</span> <span class="n">-s</span> <span class="nv">$P_Sleep</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c"># -------------------------------------------------------------------------------------------------------------------- #</span>
</span></span><span class="line"><span class="cl"><span class="c"># CREATE PARTITION</span>
</span></span><span class="line"><span class="cl"><span class="c"># -------------------------------------------------------------------------------------------------------------------- #</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kd">function</span><span class="w"> </span><span class="nb">Start-DPDiskPartition</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="nb">Write-Msg</span> <span class="n">-T</span> <span class="s1">&#39;HL&#39;</span> <span class="n">-M</span> <span class="s2">&#34;[DISK #</span><span class="nv">${P_DiskNumber}</span><span class="s2">] Create Partition&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="nv">$Param</span> <span class="p">=</span> <span class="vm">@</span><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">DiskNumber</span> <span class="p">=</span> <span class="nv">$P_DiskNumber</span>
</span></span><span class="line"><span class="cl">    <span class="n">DriveLetter</span> <span class="p">=</span> <span class="s2">&#34;</span><span class="nv">${DriveLetter}</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="n">UseMaximumSize</span> <span class="p">=</span> <span class="vm">$true</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="nb">New-Partition</span> <span class="nv">@Param</span>
</span></span><span class="line"><span class="cl">  <span class="nb">Start-Sleep</span> <span class="n">-s</span> <span class="nv">$P_Sleep</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c"># -------------------------------------------------------------------------------------------------------------------- #</span>
</span></span><span class="line"><span class="cl"><span class="c"># FORMAT DISK VOLUME</span>
</span></span><span class="line"><span class="cl"><span class="c"># -------------------------------------------------------------------------------------------------------------------- #</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kd">function</span><span class="w"> </span><span class="nb">Start-DPDiskFormat</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="nb">Write-Msg</span> <span class="n">-T</span> <span class="s1">&#39;HL&#39;</span> <span class="n">-M</span> <span class="s2">&#34;[DISK #</span><span class="nv">${P_DiskNumber}</span><span class="s2">] Format Disk Volume (</span><span class="nv">${DriveLetter}</span><span class="s2"> / </span><span class="nv">${P_FileSystem}</span><span class="s2">)&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="k">if</span> <span class="p">(</span><span class="o">-not</span> <span class="nv">$P_FileSystem</span><span class="p">)</span> <span class="p">{</span> <span class="nv">$P_FileSystem</span> <span class="p">=</span> <span class="s1">&#39;NTFS&#39;</span> <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="nv">$Param</span> <span class="p">=</span> <span class="vm">@</span><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">DriveLetter</span> <span class="p">=</span> <span class="s2">&#34;</span><span class="nv">${DriveLetter}</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="n">FileSystem</span> <span class="p">=</span> <span class="s2">&#34;</span><span class="nv">${P_FileSystem}</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="n">NewFileSystemLabel</span> <span class="p">=</span> <span class="s2">&#34;</span><span class="nv">${FileSystemLabel}</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="n">Force</span> <span class="p">=</span> <span class="vm">$true</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="nb">Format-Volume</span> <span class="nv">@Param</span>
</span></span><span class="line"><span class="cl">  <span class="nb">Start-Sleep</span> <span class="n">-s</span> <span class="nv">$P_Sleep</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c"># -------------------------------------------------------------------------------------------------------------------- #</span>
</span></span><span class="line"><span class="cl"><span class="c"># ------------------------------------------------&lt; COMMON FUNCTIONS &gt;------------------------------------------------ #</span>
</span></span><span class="line"><span class="cl"><span class="c"># -------------------------------------------------------------------------------------------------------------------- #</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c"># -------------------------------------------------------------------------------------------------------------------- #</span>
</span></span><span class="line"><span class="cl"><span class="c"># SYSTEM MESSAGES</span>
</span></span><span class="line"><span class="cl"><span class="c"># -------------------------------------------------------------------------------------------------------------------- #</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kd">function</span><span class="w"> </span><span class="nb">Write-Msg</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="k">param</span> <span class="p">(</span>
</span></span><span class="line"><span class="cl">    <span class="p">[</span><span class="nb">Alias</span><span class="p">(</span><span class="s1">&#39;T&#39;</span><span class="p">)][</span><span class="no">string</span><span class="p">]</span><span class="nv">$Type</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="p">[</span><span class="nb">Alias</span><span class="p">(</span><span class="s1">&#39;M&#39;</span><span class="p">)][</span><span class="no">string</span><span class="p">]</span><span class="nv">$Message</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="p">[</span><span class="nb">Alias</span><span class="p">(</span><span class="s1">&#39;A&#39;</span><span class="p">)][</span><span class="no">string</span><span class="p">]</span><span class="nv">$Action</span> <span class="p">=</span> <span class="s1">&#39;Continue&#39;</span>
</span></span><span class="line"><span class="cl">  <span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="k">switch</span> <span class="p">(</span><span class="nv">$Type</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="s1">&#39;HL&#39;</span>    <span class="p">{</span> <span class="nb">Write-Host</span> <span class="s2">&#34;</span><span class="nv">${NL}</span><span class="s2">--- </span><span class="nv">${Message}</span><span class="s2">&#34;</span><span class="p">.</span><span class="py">ToUpper</span><span class="p">()</span> <span class="n">-ForegroundColor</span> <span class="n">Blue</span> <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="s1">&#39;I&#39;</span>     <span class="p">{</span> <span class="nb">Write-Information</span> <span class="n">-MessageData</span> <span class="s2">&#34;</span><span class="nv">${Message}</span><span class="s2">&#34;</span> <span class="n">-InformationAction</span> <span class="s2">&#34;</span><span class="nv">${Action}</span><span class="s2">&#34;</span> <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="s1">&#39;W&#39;</span>     <span class="p">{</span> <span class="nb">Write-Warning</span> <span class="n">-Message</span> <span class="s2">&#34;</span><span class="nv">${Message}</span><span class="s2">&#34;</span> <span class="n">-WarningAction</span> <span class="s2">&#34;</span><span class="nv">${Action}</span><span class="s2">&#34;</span> <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="s1">&#39;E&#39;</span>     <span class="p">{</span> <span class="nb">Write-Error</span> <span class="n">-Message</span> <span class="s2">&#34;</span><span class="nv">${Message}</span><span class="s2">&#34;</span> <span class="n">-ErrorAction</span> <span class="s2">&#34;</span><span class="nv">${Action}</span><span class="s2">&#34;</span> <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="k">default</span> <span class="p">{</span> <span class="nb">Write-Host</span> <span class="s2">&#34;</span><span class="nv">${Message}</span><span class="s2">&#34;</span> <span class="p">}</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c"># -------------------------------------------------------------------------------------------------------------------- #</span>
</span></span><span class="line"><span class="cl"><span class="c"># -------------------------------------------------&lt; RUNNING SCRIPT &gt;------------------------------------------------- #</span>
</span></span><span class="line"><span class="cl"><span class="c"># -------------------------------------------------------------------------------------------------------------------- #</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nb">Start-Script</span></span></span></code></pre></td></tr></table>
</div>
</div>
                </div>
              </div>
            </div>]]></turbo:content></item><item turbo="true"><title>PowerShell: Сжатие видео при помощи FFmpeg</title><link>https://lib.onl/ru/2023/10/2a73410a-6611-570c-9ab4-dc8cc8998146/</link><pubDate>Sun, 22 Oct 2023 14:06:44 +0000</pubDate><dc:creator>Kai Kimera</dc:creator><category>MS Windows</category><category>Терминал</category><category>Скрипты</category><yandex:related><link url="https://lib.onl/ru/2023/10/0028821e-c96c-5014-a1dd-8963c161b170/">PowerShell: Определение разрядности ОС Windows</link><link url="https://lib.onl/ru/2023/10/4c7aba7c-f5a6-589a-9975-fdb16f2e2862/">PowerShell Vault</link><link url="https://lib.onl/ru/2023/10/eb39e3f7-b194-53d4-8bad-01edf9fdac47/">Дефрагментация в ОС Windows</link><link url="https://lib.onl/ru/2023/10/75075788-9308-56b7-b531-2008cb35f7d0/">Установка сертификата НУЦ Минцифры</link><link url="https://lib.onl/ru/2022/05/36058650-3f35-5ed5-9565-0aa7d8800c28/">Windows Server 2022 для рабочей станции</link></yandex:related><turbo:extendedHtml>true</turbo:extendedHtml><turbo:source>https://lib.onl/ru/2023/10/2a73410a-6611-570c-9ab4-dc8cc8998146/</turbo:source><turbo:topic>PowerShell: Сжатие видео при помощи FFmpeg</turbo:topic><turbo:content><![CDATA[<p>Когда то в далёкой далёкой галактике&hellip; Ко мне на работе обратились с просьбой как то уменьшить видео, записанное на камеру в формате <code>.mov</code>. Естественно, я воспользовался библиотекой <span class="shortcode shortcode-tag"><a href="/ru/tags/ffmpeg/" target="_blank">#FFmpeg</a></span>. Но скрипт автоматизации решил написать только сейчас&hellip;</p>
<p>Скрипт прост как лапоть. Состоит из небольшого количества вводных параметров, большинство из которых изменять не требуется. Предназначен скрипт для быстрого пакетного конвертирования файлов видео из одного формата в другой, в основном, с целью уменьшения размера. Скрипт не предназначен для сложного редактирования видео!</p>
<h2 id="параметры">
  <a class="link-body-emphasis" href="#%d0%bf%d0%b0%d1%80%d0%b0%d0%bc%d0%b5%d1%82%d1%80%d1%8b">Параметры</a>
</h2><ul>
<li><code>-F</code> <code>-Files</code> - массив входящих файлов.</li>
<li><code>-CV</code> <code>-vCodec</code> - видео кодек, используемый для конвертации. По умолчанию: <code>libx265</code>. Поддерживаемые кодеки:
<ul>
<li><code>'libx264'</code> - кодек &ldquo;H.264&rdquo;.</li>
<li><code>'libx265'</code> - кодек &ldquo;H.265&rdquo;.</li>
<li><code>'libvpx-vp9'</code> - кодек &ldquo;VP9&rdquo; (&ldquo;WebM&rdquo;).</li>
<li><code>'libaom-av1'</code> - кодек &ldquo;AV1&rdquo;.</li>
</ul>
</li>
<li><code>-CA</code> <code>-aCodec</code> - аудио кодек, используемый для конвертации. По умолчанию: <code>copy</code>. Поддерживаемые кодеки:
<ul>
<li><code>'libfdk_aac'</code> - кодек &ldquo;Fraunhofer FDK AAC&rdquo;.</li>
<li><code>'aac'</code> - кодек &ldquo;FFmpeg AAC&rdquo;.</li>
<li><code>'libmp3lame'</code> - кодек &ldquo;FFmpeg MP3&rdquo;.</li>
</ul>
</li>
<li><code>-R</code> <code>-Framerate</code> - частота кадров выходящего файла (FPS). Сжатие кадров с учётом движения, где сцены движения кодируются с меньшим качеством, чем статичные сцены, что субъективно приводит к восприятию, как качественного, ибо визуально человек различает больше деталей в неподвижных объектах, чем в движущихся. Если параметр не указан, то значение берётся из входящего файла.</li>
<li><code>-C</code> <code>-CRF</code> - постоянный коэффициент потока (Constant Rate Factor). Это режим кодирования для кодеков &ldquo;H.264&rdquo; и &ldquo;H.265&rdquo; с постоянным воспринимаемым качеством, осуществляемый с помощью настройки качества (и управления скоростью). Если параметр не указан, то значение берётся по умолчанию, обычно это <code>28</code> при кодеке <code>libx265</code> и <code>23</code> при <code>libx264</code>.</li>
<li><code>-P</code> <code>-Preset</code> - пресеты. Это набор параметров, которые обеспечивают определённую скорость кодирования с степень сжатия. У каждого кодека видео свой набор пресетов. Нужно смотреть <a title="" href="https://trac.ffmpeg.org/wiki" target="_blank"
   rel="noopener noreferrer">документацию</a>.</li>
<li><code>-EXT</code> <code>-Extension</code> - расширение выходящих файлов.</li>
</ul>
<h2 id="примеры">
  <a class="link-body-emphasis" href="#%d0%bf%d1%80%d0%b8%d0%bc%d0%b5%d1%80%d1%8b">Примеры</a>
</h2><p>Конвертировать файлы <code>file_01.mov</code>, <code>file_02.mov</code> и <code>file_03.mov</code> в формат <code>mp4</code>:</p>











<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-0 shortcode-codeblock-terminal
shortcode-codeblock-terminal-windows
shortcode-codeblock-terminal-windows-user">
  <div class="card overflow-hidden" data-bs-theme="dark">
    <div class="card-header">
      <div class="d-flex align-items-center">
        <div class="flex-shrink-0 ">
          <i class="fas fa-terminal fa-fw"></i>
        </div>
        <div class="flex-grow-1 mx-2">
          <h5 class="mb-0">Терминал</h5>
        </div>
        <div class="flex-shrink-0">
          <ul class="list-inline mb-0">
            <li class="list-inline-item" title='Копировать'>
              <a class="text-body" href="#"
                 data-fn="clipboard" data-clipboard-target="#cp-4f2b6f1ce7a848cad0b2ae132b8b3601"
                 role="button" aria-label='Копировать'>
                <i class="fas fa-copy fa-fw"></i>
              </a>
            </li>
          </ul>
        </div>
      </div>
    </div>
    <div class="card-body p-0 overflow-auto" id="cp-4f2b6f1ce7a848cad0b2ae132b8b3601"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-plaintext" data-lang="plaintext"><span class="line"><span class="cl">Compress-Video -F &#39;file_01.mov&#39;, &#39;file_02.mov&#39;, &#39;file_03.mov&#39;</span></span></code></pre></td></tr></table>
</div>
</div></div>
  </div>
</div>
<p>Пакетная конвертация всех файлов с расширением <code>.mov</code> в формат <code>mp4</code>:</p>











<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-1 shortcode-codeblock-terminal
shortcode-codeblock-terminal-windows
shortcode-codeblock-terminal-windows-user">
  <div class="card overflow-hidden" data-bs-theme="dark">
    <div class="card-header">
      <div class="d-flex align-items-center">
        <div class="flex-shrink-0 ">
          <i class="fas fa-terminal fa-fw"></i>
        </div>
        <div class="flex-grow-1 mx-2">
          <h5 class="mb-0">Терминал</h5>
        </div>
        <div class="flex-shrink-0">
          <ul class="list-inline mb-0">
            <li class="list-inline-item" title='Копировать'>
              <a class="text-body" href="#"
                 data-fn="clipboard" data-clipboard-target="#cp-8cabfb513adba2a16088eeb75bb33394"
                 role="button" aria-label='Копировать'>
                <i class="fas fa-copy fa-fw"></i>
              </a>
            </li>
          </ul>
        </div>
      </div>
    </div>
    <div class="card-body p-0 overflow-auto" id="cp-8cabfb513adba2a16088eeb75bb33394"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-plaintext" data-lang="plaintext"><span class="line"><span class="cl">Compress-Video -F &#39;*.mov&#39;</span></span></code></pre></td></tr></table>
</div>
</div></div>
  </div>
</div>
<h2 id="алгоритм-работы">
  <a class="link-body-emphasis" href="#%d0%b0%d0%bb%d0%b3%d0%be%d1%80%d0%b8%d1%82%d0%bc-%d1%80%d0%b0%d0%b1%d0%be%d1%82%d1%8b">Алгоритм работы</a>
</h2><p>Скрипт предназначен для быстрого пакетного преобразования файлов видео из одного формата в другой.</p>




    








    
    






<div class="shortcode shortcode-alert">
  <div class="alert alert-warning d-flex overflow-hidden" role="alert">
    <div class="flex-shrink-0 align-self-center">
      <i class="fas fa-exclamation-triangle fa-fw fa-2x"></i>
    </div>
    <div class="flex-grow-1 ms-3 overflow-hidden">
        <p>Для работы скрипта необходим файл <code>ffmpeg.exe</code>, архив которого можно скачать с сайта <a title="" href="https://www.gyan.dev/ffmpeg/builds/" target="_blank"
   rel="noopener noreferrer">gyan.dev</a>, распаковать и разместить рядом с файлом скрипта или в любую дочернюю директорию. Скрипт сам найдёт файл <code>ffmpeg.exe</code> и начнёт его использовать.</p>

    </div>
  </div>
</div>

<h2 id="скрипт">
  <a class="link-body-emphasis" href="#%d1%81%d0%ba%d1%80%d0%b8%d0%bf%d1%82">Скрипт</a>
</h2>

    <div class="shortcode shortcode-gh-repo mb-3">
      <div class="row row-cols-1 row-cols-lg-2 g-3">
          
            <div class="col gh-repo" data-repos="pkgstore/pwsh-ffmpeg">
              <div class="card">
                <div class="row g-0">
                  <div class="col-md-4 p-1">
                    <a class="d-block gh-repo-avatar"
                       href="https://github.com/pkgstore/pwsh-ffmpeg" target="_blank"
                       rel="noopener noreferrer nofollow">
                      <img class="card-img gh-repo-avatar"
                           src="https://github.com/identicons/pkgstore.png"
                           alt="pkgstore/pwsh-ffmpeg" loading="lazy"/>
                    </a>
                  </div>
                  <div class="col">
                    <div class="card-body h-100">
                      <div class="d-flex flex-column h-100">
                        <div class="flex-shrink-0">
                          <h5 class="card-title">
                            <a class="gh-repo-name"
                               href="https://github.com/pkgstore/pwsh-ffmpeg" target="_blank"
                               rel="noopener noreferrer nofollow">pkgstore/pwsh-ffmpeg</a>
                          </h5>
                          <h6 class="card-subtitle mb-2 text-body-secondary gh-repo-owner"></h6>
                          <p class="card-text gh-repo-description"></p>
                        </div>
                        <div class="mt-auto">
                          <div class="row row-cols-auto g-2 mt-3">
                            <div class="col">
                              <div class="btn btn-light btn-sm"
                                   title='Язык разработки'>
                                <i class="fas fa-code fa-fw me-1"></i>
                                <span class="gh-repo-language">#</span>
                              </div>
                            </div>
                            <div class="col">
                              <div class="btn btn-light btn-sm"
                                   title='Подписки'>
                                <i class="fas fa-eye fa-fw me-1"></i>
                                <span class="gh-repo-subscribers">#</span>
                              </div>
                            </div>
                            <div class="col">
                              <div class="btn btn-light btn-sm"
                                   title='Звёзды'>
                                <i class="fas fa-star fa-fw me-1"></i>
                                <span class="gh-repo-stars">#</span>
                              </div>
                            </div>
                            <div class="col">
                              <div class="btn btn-light btn-sm"
                                   title='Вилки'>
                                <i class="fas fa-code-branch fa-fw me-1"></i>
                                <span class="gh-repo-forks">#</span>
                              </div>
                            </div>
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          
      </div>
    </div>]]></turbo:content></item><item turbo="true"><title>PowerShell: Определение разрядности ОС Windows</title><link>https://lib.onl/ru/2023/10/0028821e-c96c-5014-a1dd-8963c161b170/</link><pubDate>Sat, 21 Oct 2023 17:42:05 +0000</pubDate><dc:creator>Kai Kimera</dc:creator><category>MS Windows</category><category>Терминал</category><yandex:related><link url="https://lib.onl/ru/2023/10/4c7aba7c-f5a6-589a-9975-fdb16f2e2862/">PowerShell Vault</link><link url="https://lib.onl/ru/2023/10/eb39e3f7-b194-53d4-8bad-01edf9fdac47/">Дефрагментация в ОС Windows</link><link url="https://lib.onl/ru/2023/10/75075788-9308-56b7-b531-2008cb35f7d0/">Установка сертификата НУЦ Минцифры</link><link url="https://lib.onl/ru/2022/05/36058650-3f35-5ed5-9565-0aa7d8800c28/">Windows Server 2022 для рабочей станции</link></yandex:related><turbo:extendedHtml>true</turbo:extendedHtml><turbo:source>https://lib.onl/ru/2023/10/0028821e-c96c-5014-a1dd-8963c161b170/</turbo:source><turbo:topic>PowerShell: Определение разрядности ОС Windows</turbo:topic><turbo:content><![CDATA[<p>Нашёл на Stack Overflow хорошую функцию по определению разрядности ОС и процесса <span class="shortcode shortcode-tag"><a href="/ru/tags/powershell/" target="_blank">#PowerShell</a></span>. Запишу, обязательно пригодится.</p>
<h2 id="разрядность-ос">
  <a class="link-body-emphasis" href="#%d1%80%d0%b0%d0%b7%d1%80%d1%8f%d0%b4%d0%bd%d0%be%d1%81%d1%82%d1%8c-%d0%be%d1%81">Разрядность ОС</a>
</h2><p>Разрядность ОС можно определить следующей функцией:</p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-0
shortcode-codeblock-powershell">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-01c83d6478d092869184b250df7e55fb" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-powershell" data-lang="powershell"><span class="line"><span class="cl"><span class="kd">function</span><span class="w"> </span><span class="nb">Get-Architecture</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="c"># What bitness does Windows use.</span>
</span></span><span class="line"><span class="cl">  <span class="k">switch</span> <span class="p">([</span><span class="no">Environment</span><span class="p">]::</span><span class="n">Is64BitOperatingSystem</span><span class="p">)</span> <span class="p">{</span> <span class="c"># Needs &#39;.NET 4&#39;.</span>
</span></span><span class="line"><span class="cl">    <span class="vm">$true</span>   <span class="p">{</span> <span class="mf">64</span><span class="p">;</span> <span class="k">break</span> <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="vm">$false</span>  <span class="p">{</span> <span class="mf">32</span><span class="p">;</span> <span class="k">break</span> <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="k">default</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="p">(</span><span class="nb">Get-WmiObject</span> <span class="n">-Class</span> <span class="n">Win32_OperatingSystem</span><span class="p">).</span><span class="py">OSArchitecture</span> <span class="o">-replace</span> <span class="s1">&#39;\D&#39;</span>
</span></span><span class="line"><span class="cl">      <span class="c"># Or do any of these:</span>
</span></span><span class="line"><span class="cl">      <span class="c"># (Get-WmiObject -Class Win32_ComputerSystem).SystemType -replace &#39;\D&#39; -replace &#39;86&#39;, &#39;32&#39;</span>
</span></span><span class="line"><span class="cl">      <span class="c"># (Get-WmiObject -Class Win32_Processor).AddressWidth # This is slow...</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-01c83d6478d092869184b250df7e55fb"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<p>Можно записать эту функцию в файл и запустить файл в терминале, или же внедрить в крупный проект и вызывать по имени <code>Get-Architecture</code>.</p>
<h3 id="результат">
  <a class="link-body-emphasis" href="#%d1%80%d0%b5%d0%b7%d1%83%d0%bb%d1%8c%d1%82%d0%b0%d1%82">Результат</a>
</h3>










<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-1 shortcode-codeblock-terminal
shortcode-codeblock-terminal-windows
shortcode-codeblock-terminal-windows-user">
  <div class="card overflow-hidden" data-bs-theme="dark">
    <div class="card-header">
      <div class="d-flex align-items-center">
        <div class="flex-shrink-0 ">
          <i class="fas fa-terminal fa-fw"></i>
        </div>
        <div class="flex-grow-1 mx-2">
          <h5 class="mb-0">Терминал</h5>
        </div>
        <div class="flex-shrink-0">
          <ul class="list-inline mb-0">
            <li class="list-inline-item" title='Копировать'>
              <a class="text-body" href="#"
                 data-fn="clipboard" data-clipboard-target="#cp-f8ff5997bfd6a404f7b7f502f974245a"
                 role="button" aria-label='Копировать'>
                <i class="fas fa-copy fa-fw"></i>
              </a>
            </li>
          </ul>
        </div>
      </div>
    </div>
    <div class="card-body p-0 overflow-auto" id="cp-f8ff5997bfd6a404f7b7f502f974245a"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-plaintext" data-lang="plaintext"><span class="line"><span class="cl">.\arch.ps1
</span></span><span class="line"><span class="cl">64</span></span></code></pre></td></tr></table>
</div>
</div></div>
  </div>
</div>
<h2 id="разрядность-ос-и-powershell">
  <a class="link-body-emphasis" href="#%d1%80%d0%b0%d0%b7%d1%80%d1%8f%d0%b4%d0%bd%d0%be%d1%81%d1%82%d1%8c-%d0%be%d1%81-%d0%b8-powershell">Разрядность ОС и PowerShell</a>
</h2><p>Расширенная версия, которая позволяет определить разрядность ОС и процесса PowerShell, под которым выполняется функция.</p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-2
shortcode-codeblock-powershell">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-580ca5f7cf9d5c6ef7d3cfb270dd3aec" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-powershell" data-lang="powershell"><span class="line"><span class="cl"><span class="kd">function</span><span class="w"> </span><span class="nb">Get-Architecture</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="c"># What bitness does Windows use.</span>
</span></span><span class="line"><span class="cl">  <span class="nv">$windowsBitness</span> <span class="p">=</span> <span class="k">switch</span> <span class="p">([</span><span class="no">Environment</span><span class="p">]::</span><span class="n">Is64BitOperatingSystem</span><span class="p">)</span> <span class="p">{</span> <span class="c"># Needs &#39;.NET 4&#39;.</span>
</span></span><span class="line"><span class="cl">    <span class="vm">$true</span>   <span class="p">{</span> <span class="mf">64</span><span class="p">;</span> <span class="k">break</span> <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="vm">$false</span>  <span class="p">{</span> <span class="mf">32</span><span class="p">;</span> <span class="k">break</span> <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="k">default</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="p">(</span><span class="nb">Get-WmiObject</span> <span class="n">-Class</span> <span class="n">Win32_OperatingSystem</span><span class="p">).</span><span class="py">OSArchitecture</span> <span class="o">-replace</span> <span class="s1">&#39;\D&#39;</span>
</span></span><span class="line"><span class="cl">      <span class="c"># Or do any of these:</span>
</span></span><span class="line"><span class="cl">      <span class="c"># (Get-WmiObject -Class Win32_ComputerSystem).SystemType -replace &#39;\D&#39; -replace &#39;86&#39;, &#39;32&#39;</span>
</span></span><span class="line"><span class="cl">      <span class="c"># (Get-WmiObject -Class Win32_Processor).AddressWidth # Slow...</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="c"># What bitness does this PowerShell process use.</span>
</span></span><span class="line"><span class="cl">  <span class="nv">$processBitness</span> <span class="p">=</span> <span class="p">[</span><span class="no">IntPtr</span><span class="p">]::</span><span class="n">Size</span> <span class="p">*</span> <span class="mf">8</span>
</span></span><span class="line"><span class="cl">  <span class="c"># Or do any of these:</span>
</span></span><span class="line"><span class="cl">  <span class="c"># $processBitness = $env:PROCESSOR_ARCHITECTURE -replace &#39;\D&#39; -replace &#39;86|ARM&#39;, &#39;32&#39;</span>
</span></span><span class="line"><span class="cl">  <span class="c"># $processBitness = if ([Environment]::Is64BitProcess) { 64 } else { 32 }</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="c"># Return the info as object.</span>
</span></span><span class="line"><span class="cl">  <span class="nb">New-Object</span> <span class="n">-TypeName</span> <span class="n">PSObject</span> <span class="n">-Property</span> <span class="vm">@</span><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="s1">&#39;ProcessArchitecture&#39;</span> <span class="p">=</span> <span class="s2">&#34;{0} bit&#34;</span> <span class="o">-f</span> <span class="nv">$processBitness</span>
</span></span><span class="line"><span class="cl">    <span class="s1">&#39;WindowsArchitecture&#39;</span> <span class="p">=</span> <span class="s2">&#34;{0} bit&#34;</span> <span class="o">-f</span> <span class="nv">$windowsBitness</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-580ca5f7cf9d5c6ef7d3cfb270dd3aec"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<p>Можно записать эту функцию в файл и запустить файл в терминале, или же внедрить в крупный проект и вызывать по имени <code>Get-Architecture</code>.</p>
<h3 id="результат-1">
  <a class="link-body-emphasis" href="#%d1%80%d0%b5%d0%b7%d1%83%d0%bb%d1%8c%d1%82%d0%b0%d1%82-1">Результат</a>
</h3>










<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-3 shortcode-codeblock-terminal
shortcode-codeblock-terminal-windows
shortcode-codeblock-terminal-windows-user">
  <div class="card overflow-hidden" data-bs-theme="dark">
    <div class="card-header">
      <div class="d-flex align-items-center">
        <div class="flex-shrink-0 ">
          <i class="fas fa-terminal fa-fw"></i>
        </div>
        <div class="flex-grow-1 mx-2">
          <h5 class="mb-0">Терминал</h5>
        </div>
        <div class="flex-shrink-0">
          <ul class="list-inline mb-0">
            <li class="list-inline-item" title='Копировать'>
              <a class="text-body" href="#"
                 data-fn="clipboard" data-clipboard-target="#cp-6575b6dbd0693008d06cfa6df2c7b8fc"
                 role="button" aria-label='Копировать'>
                <i class="fas fa-copy fa-fw"></i>
              </a>
            </li>
          </ul>
        </div>
      </div>
    </div>
    <div class="card-body p-0 overflow-auto" id="cp-6575b6dbd0693008d06cfa6df2c7b8fc"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-plaintext" data-lang="plaintext"><span class="line"><span class="cl">.\arch.ps1
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">ProcessArchitecture WindowsArchitecture
</span></span><span class="line"><span class="cl">------------------- -------------------
</span></span><span class="line"><span class="cl">64 bit              64 bit</span></span></code></pre></td></tr></table>
</div>
</div></div>
  </div>
</div>]]></turbo:content></item><item turbo="true"><title>PowerShell Vault</title><link>https://lib.onl/ru/2023/10/4c7aba7c-f5a6-589a-9975-fdb16f2e2862/</link><pubDate>Fri, 20 Oct 2023 09:57:21 +0000</pubDate><dc:creator>Kai Kimera</dc:creator><category>MS Windows</category><category>Терминал</category><category>Скрипты</category><yandex:related><link url="https://lib.onl/ru/2023/10/eb39e3f7-b194-53d4-8bad-01edf9fdac47/">Дефрагментация в ОС Windows</link><link url="https://lib.onl/ru/2023/10/75075788-9308-56b7-b531-2008cb35f7d0/">Установка сертификата НУЦ Минцифры</link><link url="https://lib.onl/ru/2022/05/36058650-3f35-5ed5-9565-0aa7d8800c28/">Windows Server 2022 для рабочей станции</link></yandex:related><turbo:extendedHtml>true</turbo:extendedHtml><turbo:source>https://lib.onl/ru/2023/10/4c7aba7c-f5a6-589a-9975-fdb16f2e2862/</turbo:source><turbo:topic>PowerShell Vault</turbo:topic><turbo:content><![CDATA[<p>На работе в локальной сети использовалась задача, которая перемещала старые, по долгу не использовавшиеся, файлы из главного файлового хранилища в резервное. Но так как организация являлась проектной, то старые файлы могли понадобиться в любое время.</p>
<p>Задача использовала простой скрипт с фильтрацией файлов по параметрам <em>время создания</em> и <em>время изменения</em>. Я чуть доработали скрипт и решил опубликовать его для других администраторов. Вдруг, пригодится. Только перед использованием прошу проверить скрипт в какой-нибудь песочнице.</p>




    












    
    


<div class="shortcode shortcode-alert">
  <div class="alert alert-danger d-flex overflow-hidden" role="alert">
    <div class="flex-shrink-0 align-self-center">
      <i class="fas fa-circle-radiation fa-fw fa-2x"></i>
    </div>
    <div class="flex-grow-1 ms-3 overflow-hidden">
        <p>Есть вероятность, что скрипт удалит все файлы в вашем файловом хранилище, из-за того, что автор может оказаться <em>рукожопом</em>! Поэтому, перед боевой задачей, проверьте скрипт в какой-нибудь песочнице. А кто хорошо разбирается в <!-- raw HTML omitted --><!-- raw HTML omitted -->#PowerShell<!-- raw HTML omitted --><!-- raw HTML omitted --> - автор будет благодарен за оптимизацию и корректировку скрипта.</p>

    </div>
  </div>
</div>

<h2 id="параметры">
  <a class="link-body-emphasis" href="#%d0%bf%d0%b0%d1%80%d0%b0%d0%bc%d0%b5%d1%82%d1%80%d1%8b">Параметры</a>
</h2><ul>
<li><code>-M</code> <code>-Mode</code> - режим работы скрипта. По умолчанию <code>'MV'</code>.
<ul>
<li><code>'CP'</code> - копировать файлы из источника в хранилище.</li>
<li><code>'MV'</code> - перемещать файлы из источника в хранилище.</li>
<li><code>'RM'</code> - только удалять файлы из источника без копирования или перемещения куда-либо.</li>
</ul>
</li>
<li><code>-SRC</code> <code>-Source</code> - путь к директории откуда перемещать файлы. Например, <code>-SRC 'C:\Data\Source'</code>. По умолчанию: <code>${PSScriptRoot}\Source</code>.</li>
<li><code>-DST</code> <code>-Vault</code> - путь к директории куда перемещать файлы. Например, <code>-DST 'C:\Data\Vault'</code>. По умолчанию: <code>${PSScriptRoot}\Vault</code>.</li>
<li><code>-CT</code> <code>-CreationTime</code> - время создания файла в секундах. Например, <code>-CT 5270400</code>. По умолчанию: <code>5270400</code> (61 день).</li>
<li><code>-WT</code> <code>-LastWriteTime</code> - время изменения файла в секундах. Например, <code>-WT 5270400</code>. По умолчанию: <code>${P_CreationTime}</code>.</li>
<li><code>-FS</code> <code>-FileSize</code> - размер файла. Например, <code>-FS '5kb'</code> или <code>-FS '12mb'</code>. По умолчанию: <code>'0kb'</code>.</li>
<li><code>-E</code> <code>-Exclude</code> - путь к файлу с исключениями. Например, <code>-E 'C:\Data\exclude.txt'</code>. По умолчанию: <code>${PSScriptRoot}\vault.exclude.txt</code>.</li>
<li><code>-L</code> <code>-Logs</code> - путь к директории с журналами работы скрипта. Например, <code>-L 'C:\Data\Logs'</code>. По умолчанию: <code>${PSScriptRoot}\Logs</code>.</li>
<li><code>-RD</code> <code>-RemoveDirs</code> - удалять пустые каталоги.</li>
<li><code>-O</code> <code>-Overwrite</code> - перезаписать файлы в Vault.</li>
</ul>
<h2 id="примеры">
  <a class="link-body-emphasis" href="#%d0%bf%d1%80%d0%b8%d0%bc%d0%b5%d1%80%d1%8b">Примеры</a>
</h2><p>Запустить перемещение файлов из <code>Source</code> в <code>Vault</code> с сохранением структуры директорий:</p>











<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-0 shortcode-codeblock-terminal
shortcode-codeblock-terminal-windows
shortcode-codeblock-terminal-windows-user">
  <div class="card overflow-hidden" data-bs-theme="dark">
    <div class="card-header">
      <div class="d-flex align-items-center">
        <div class="flex-shrink-0 ">
          <i class="fas fa-terminal fa-fw"></i>
        </div>
        <div class="flex-grow-1 mx-2">
          <h5 class="mb-0">Терминал</h5>
        </div>
        <div class="flex-shrink-0">
          <ul class="list-inline mb-0">
            <li class="list-inline-item" title='Копировать'>
              <a class="text-body" href="#"
                 data-fn="clipboard" data-clipboard-target="#cp-019f57fc44099aa03db585a45f3b3dfb"
                 role="button" aria-label='Копировать'>
                <i class="fas fa-copy fa-fw"></i>
              </a>
            </li>
          </ul>
        </div>
      </div>
    </div>
    <div class="card-body p-0 overflow-auto" id="cp-019f57fc44099aa03db585a45f3b3dfb"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-plaintext" data-lang="plaintext"><span class="line"><span class="cl">Start-Vault -SRC &#39;C:\Data\Source&#39; -DST &#39;C:\Data\Vault&#39;</span></span></code></pre></td></tr></table>
</div>
</div></div>
  </div>
</div>
<p>Запустить перемещение файлов с временем создания и изменения от 10 дней (<code>864000</code>) из <code>Source</code> в <code>Vault</code> с сохранением структуры директорий:</p>











<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-1 shortcode-codeblock-terminal
shortcode-codeblock-terminal-windows
shortcode-codeblock-terminal-windows-user">
  <div class="card overflow-hidden" data-bs-theme="dark">
    <div class="card-header">
      <div class="d-flex align-items-center">
        <div class="flex-shrink-0 ">
          <i class="fas fa-terminal fa-fw"></i>
        </div>
        <div class="flex-grow-1 mx-2">
          <h5 class="mb-0">Терминал</h5>
        </div>
        <div class="flex-shrink-0">
          <ul class="list-inline mb-0">
            <li class="list-inline-item" title='Копировать'>
              <a class="text-body" href="#"
                 data-fn="clipboard" data-clipboard-target="#cp-a38063e24024b7aca5c05f8a6841049c"
                 role="button" aria-label='Копировать'>
                <i class="fas fa-copy fa-fw"></i>
              </a>
            </li>
          </ul>
        </div>
      </div>
    </div>
    <div class="card-body p-0 overflow-auto" id="cp-a38063e24024b7aca5c05f8a6841049c"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-plaintext" data-lang="plaintext"><span class="line"><span class="cl">Start-Vault -SRC &#39;C:\Data\Source&#39; -DST &#39;C:\Data\Vault&#39; -CT &#39;864000&#39; -WT &#39;864000&#39;</span></span></code></pre></td></tr></table>
</div>
</div></div>
  </div>
</div>
<p>Запустить перемещение файлов с временем создания и изменения от 10 дней (<code>864000</code>) и размером более 32 мегабайта (<code>32mb</code>) из <code>Source</code> в <code>Vault</code> с сохранением структуры директорий:</p>











<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-2 shortcode-codeblock-terminal
shortcode-codeblock-terminal-windows
shortcode-codeblock-terminal-windows-user">
  <div class="card overflow-hidden" data-bs-theme="dark">
    <div class="card-header">
      <div class="d-flex align-items-center">
        <div class="flex-shrink-0 ">
          <i class="fas fa-terminal fa-fw"></i>
        </div>
        <div class="flex-grow-1 mx-2">
          <h5 class="mb-0">Терминал</h5>
        </div>
        <div class="flex-shrink-0">
          <ul class="list-inline mb-0">
            <li class="list-inline-item" title='Копировать'>
              <a class="text-body" href="#"
                 data-fn="clipboard" data-clipboard-target="#cp-fee0869c734b3e5f2740cb8b553be332"
                 role="button" aria-label='Копировать'>
                <i class="fas fa-copy fa-fw"></i>
              </a>
            </li>
          </ul>
        </div>
      </div>
    </div>
    <div class="card-body p-0 overflow-auto" id="cp-fee0869c734b3e5f2740cb8b553be332"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-plaintext" data-lang="plaintext"><span class="line"><span class="cl">Start-Vault -SRC &#39;C:\Data\Source&#39; -DST &#39;C:\Data\Vault&#39; -CT &#39;864000&#39; -WT &#39;864000&#39; -FS &#39;32mb&#39;</span></span></code></pre></td></tr></table>
</div>
</div></div>
  </div>
</div>
<p>Запустить перемещение файлов с временем создания и изменения от 10 дней (<code>864000</code>), и с перезаписью файлов с одинаковыми названиями (<code>-O</code>) из <code>Source</code> в <code>Vault</code> с сохранением структуры директорий:</p>











<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-3 shortcode-codeblock-terminal
shortcode-codeblock-terminal-windows
shortcode-codeblock-terminal-windows-user">
  <div class="card overflow-hidden" data-bs-theme="dark">
    <div class="card-header">
      <div class="d-flex align-items-center">
        <div class="flex-shrink-0 ">
          <i class="fas fa-terminal fa-fw"></i>
        </div>
        <div class="flex-grow-1 mx-2">
          <h5 class="mb-0">Терминал</h5>
        </div>
        <div class="flex-shrink-0">
          <ul class="list-inline mb-0">
            <li class="list-inline-item" title='Копировать'>
              <a class="text-body" href="#"
                 data-fn="clipboard" data-clipboard-target="#cp-0ac41517a9724a2a0e57e9dfd04f4fd2"
                 role="button" aria-label='Копировать'>
                <i class="fas fa-copy fa-fw"></i>
              </a>
            </li>
          </ul>
        </div>
      </div>
    </div>
    <div class="card-body p-0 overflow-auto" id="cp-0ac41517a9724a2a0e57e9dfd04f4fd2"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-plaintext" data-lang="plaintext"><span class="line"><span class="cl">Start-Vault -SRC &#39;C:\Data\Source&#39; -DST &#39;C:\Data\Vault&#39; -CT &#39;864000&#39; -WT &#39;864000&#39; -O</span></span></code></pre></td></tr></table>
</div>
</div></div>
  </div>
</div>
<p>Параметр <code>-O</code> означает, что не нужно архивировать старый файл при перемещении нового с таким же названием. Старый файл в хранилище перезапишется новым.</p>
<h2 id="алгоритм-работы">
  <a class="link-body-emphasis" href="#%d0%b0%d0%bb%d0%b3%d0%be%d1%80%d0%b8%d1%82%d0%bc-%d1%80%d0%b0%d0%b1%d0%be%d1%82%d1%8b">Алгоритм работы</a>
</h2><p>Скрипт создаёт хранилище старых файлов. Это, своего рода, аналог резервного копирования. При перемещении файлов из источника в хранилище, скрипт обрабатывает несколько заданных параметров и фильтров. Всё настроить можно под себя. По умолчанию, скрипт перемещает файлы из источника в хранилище, и если в хранилище уже имеется старый файл с названием кау у нового перемещаемого, то старый файл архивируется с меткой <code>.[UnixTime].7z</code>.</p>




    








    
    






<div class="shortcode shortcode-alert">
  <div class="alert alert-warning d-flex overflow-hidden" role="alert">
    <div class="flex-shrink-0 align-self-center">
      <i class="fas fa-exclamation-triangle fa-fw fa-2x"></i>
    </div>
    <div class="flex-grow-1 ms-3 overflow-hidden">
        <p>Для работы скрипта необходим архиватор <strong>7-Zip</strong>, а конкретно его облегчённая версия <code>7za.exe</code> с библиотеками из <strong>7-Zip Extra</strong>. Скачать можно с <a title="" href="https://www.7-zip.org/download.html" target="_blank"
   rel="noopener noreferrer">официального сайта</a>. После скачивания архива, файлы <code>7za.exe</code>, <code>7za.dll</code> и <code>7zxa.dll</code> нужно разместить рядом со скриптом, или в любую дочернюю директорию. Скрипт сам найдёт путь к <code>7za.exe</code>.</p>

    </div>
  </div>
</div>

<h2 id="скрипт">
  <a class="link-body-emphasis" href="#%d1%81%d0%ba%d1%80%d0%b8%d0%bf%d1%82">Скрипт</a>
</h2>

    <div class="shortcode shortcode-gh-repo mb-3">
      <div class="row row-cols-1 row-cols-lg-2 g-3">
          
            <div class="col gh-repo" data-repos="pkgstore/pwsh-vault">
              <div class="card">
                <div class="row g-0">
                  <div class="col-md-4 p-1">
                    <a class="d-block gh-repo-avatar"
                       href="https://github.com/pkgstore/pwsh-vault" target="_blank"
                       rel="noopener noreferrer nofollow">
                      <img class="card-img gh-repo-avatar"
                           src="https://github.com/identicons/pkgstore.png"
                           alt="pkgstore/pwsh-vault" loading="lazy"/>
                    </a>
                  </div>
                  <div class="col">
                    <div class="card-body h-100">
                      <div class="d-flex flex-column h-100">
                        <div class="flex-shrink-0">
                          <h5 class="card-title">
                            <a class="gh-repo-name"
                               href="https://github.com/pkgstore/pwsh-vault" target="_blank"
                               rel="noopener noreferrer nofollow">pkgstore/pwsh-vault</a>
                          </h5>
                          <h6 class="card-subtitle mb-2 text-body-secondary gh-repo-owner"></h6>
                          <p class="card-text gh-repo-description"></p>
                        </div>
                        <div class="mt-auto">
                          <div class="row row-cols-auto g-2 mt-3">
                            <div class="col">
                              <div class="btn btn-light btn-sm"
                                   title='Язык разработки'>
                                <i class="fas fa-code fa-fw me-1"></i>
                                <span class="gh-repo-language">#</span>
                              </div>
                            </div>
                            <div class="col">
                              <div class="btn btn-light btn-sm"
                                   title='Подписки'>
                                <i class="fas fa-eye fa-fw me-1"></i>
                                <span class="gh-repo-subscribers">#</span>
                              </div>
                            </div>
                            <div class="col">
                              <div class="btn btn-light btn-sm"
                                   title='Звёзды'>
                                <i class="fas fa-star fa-fw me-1"></i>
                                <span class="gh-repo-stars">#</span>
                              </div>
                            </div>
                            <div class="col">
                              <div class="btn btn-light btn-sm"
                                   title='Вилки'>
                                <i class="fas fa-code-branch fa-fw me-1"></i>
                                <span class="gh-repo-forks">#</span>
                              </div>
                            </div>
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          
      </div>
    </div>]]></turbo:content></item><item turbo="true"><title>Дефрагментация в ОС Windows</title><link>https://lib.onl/ru/2023/10/eb39e3f7-b194-53d4-8bad-01edf9fdac47/</link><pubDate>Fri, 20 Oct 2023 00:46:16 +0000</pubDate><dc:creator>Kai Kimera</dc:creator><category>MS Windows</category><category>Терминал</category><yandex:related><link url="https://lib.onl/ru/2023/10/75075788-9308-56b7-b531-2008cb35f7d0/">Установка сертификата НУЦ Минцифры</link><link url="https://lib.onl/ru/2023/09/dd5a3e1a-596b-50d5-b070-b2a065f99f32/">Получение и установка MS Office 2021 LTSC</link><link url="https://lib.onl/ru/2022/05/862226e6-cbb1-58f8-bc8e-0cfef747f475/">Интеграция обновлений в дистрибутив ОС MS Windows</link><link url="https://lib.onl/ru/2022/05/36058650-3f35-5ed5-9565-0aa7d8800c28/">Windows Server 2022 для рабочей станции</link></yandex:related><turbo:extendedHtml>true</turbo:extendedHtml><turbo:source>https://lib.onl/ru/2023/10/eb39e3f7-b194-53d4-8bad-01edf9fdac47/</turbo:source><turbo:topic>Дефрагментация в ОС Windows</turbo:topic><turbo:content><![CDATA[<p>При работе с оборудованием, мне приходится сталкиваться с довольно старыми устройствами, их их работу нужно как-нибудь оптимизировать. Одним из вариантов оптимизации является дефрагментация <span class="shortcode shortcode-tag"><a href="/ru/tags/hdd/" target="_blank">#HDD</a></span>.</p>
<h2 id="powershell">
  <a class="link-body-emphasis" href="#powershell">PowerShell</a>
</h2><p>Командлет по дефрагментации для <span class="shortcode shortcode-tag"><a href="/ru/tags/powershell/" target="_blank">#PowerShell</a></span> называется <code>Optimize-Volume</code> и может принимать следующие параметры:</p>
<ul>
<li><code>-Analyze</code> - выполнение анализа указанного тома.</li>
<li><code>-Defrag</code> - выполнение дефрагментации указанного тома.</li>
<li><code>-DriveLetter</code> - буква тома.</li>
<li><code>-NormalPriority</code> - выполнение процесса с нормальным приоритетом (по умолчанию приоритет пониженный).</li>
<li><code>-ReTrim</code> - выполнение TRIM-операции для <span class="shortcode shortcode-tag"><a href="/ru/tags/ssd/" target="_blank">#SSD</a></span>.</li>
</ul>
<p>Это наиболее востребованные параметры. Остальные параметры можно посмотреть в <a title="" href="https://learn.microsoft.com/en-us/powershell/module/storage/optimize-volume" target="_blank"
   rel="noopener noreferrer">официальной документации</a>.</p>




    










    
    




<div class="shortcode shortcode-alert">
  <div class="alert alert-success d-flex overflow-hidden" role="alert">
    <div class="flex-shrink-0 align-self-center">
      <i class="fas fa-lightbulb fa-fw fa-2x"></i>
    </div>
    <div class="flex-grow-1 ms-3 overflow-hidden">
        <p>Для всех команд можно добавить параметр <code>-Verbose</code>, который выводит подробную информацию о происходящем процессе.</p>

    </div>
  </div>
</div>

<h3 id="анализ-тома">
  <a class="link-body-emphasis" href="#%d0%b0%d0%bd%d0%b0%d0%bb%d0%b8%d0%b7-%d1%82%d0%be%d0%bc%d0%b0">Анализ тома</a>
</h3>








  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-0
shortcode-codeblock-powershell">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-3735c2a52a54cd3c3693a8e34e8c22d9" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-powershell" data-lang="powershell"><span class="line"><span class="cl"><span class="nb">Optimize-Volume</span> <span class="n">-DriveLetter</span> <span class="n">C</span> <span class="n">-Analyze</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-3735c2a52a54cd3c3693a8e34e8c22d9"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<p>Где:</p>
<ul>
<li><code>-DriveLetter C</code> - буква тома (диск C:).</li>
<li><code>-Analyze</code> - анализ.</li>
</ul>
<h3 id="дефрагментация">
  <a class="link-body-emphasis" href="#%d0%b4%d0%b5%d1%84%d1%80%d0%b0%d0%b3%d0%bc%d0%b5%d0%bd%d1%82%d0%b0%d1%86%d0%b8%d1%8f">Дефрагментация</a>
</h3>








  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-1
shortcode-codeblock-powershell">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-f57b4e8afdc944159374594b14fb88bf" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-powershell" data-lang="powershell"><span class="line"><span class="cl"><span class="nb">Optimize-Volume</span> <span class="n">-DriveLetter</span> <span class="n">C</span> <span class="n">-Defrag</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-f57b4e8afdc944159374594b14fb88bf"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<p>Где:</p>
<ul>
<li><code>-DriveLetter C</code> - буква тома (диск C:).</li>
<li><code>-Defrag</code> - дефрагментация.</li>
</ul>
<h3 id="trim-операция-для-ssd">
  <a class="link-body-emphasis" href="#trim-%d0%be%d0%bf%d0%b5%d1%80%d0%b0%d1%86%d0%b8%d1%8f-%d0%b4%d0%bb%d1%8f-ssd">TRIM-операция для SSD</a>
</h3>








  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-2
shortcode-codeblock-powershell">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-50fb02f248ecf5bed5f4a89bf71a56b4" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-powershell" data-lang="powershell"><span class="line"><span class="cl"><span class="nb">Optimize-Volume</span> <span class="n">-DriveLetter</span> <span class="n">C</span> <span class="n">-ReTrim</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-50fb02f248ecf5bed5f4a89bf71a56b4"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<p>Где:</p>
<ul>
<li><code>-DriveLetter C</code> - буква тома (диск C:).</li>
<li><code>-ReTrim</code> - на дисках SSD запускает TRIM-операцию.</li>
</ul>
<h2 id="cmd-defrag">
  <a class="link-body-emphasis" href="#cmd-defrag">CMD Defrag</a>
</h2><p>Утилита <code>defrag.exe</code> выполняет анализ и оптимизацию томов через командную строку. Утилита может принимать следующие параметры:</p>
<ul>
<li>Тома:
<ul>
<li><code>/c</code> - выполнение операции на всех томах.</li>
<li><code>/e</code> - выполнение операции на всех томах, кроме указанных.</li>
</ul>
</li>
<li>Операции:
<ul>
<li><code>/a</code> - анализ указанных томов.</li>
<li><code>/d</code> - выполнение традиционной дефрагментации (по умолчанию). На многоуровневом томе традиционная дефрагментация выполняется только на уровне ёмкости.</li>
<li><code>/l</code> - выполнение TRIM-операции для SSD.</li>
<li><code>/o</code> - выполнение правильной оптимизации для каждого типа носителя.</li>
<li><code>/u</code> - отображение хода операции.</li>
</ul>
</li>
</ul>




    










    
    




<div class="shortcode shortcode-alert">
  <div class="alert alert-success d-flex overflow-hidden" role="alert">
    <div class="flex-shrink-0 align-self-center">
      <i class="fas fa-lightbulb fa-fw fa-2x"></i>
    </div>
    <div class="flex-grow-1 ms-3 overflow-hidden">
        <p>Для всех команд можно добавить параметр <code>/v</code>, который выводит подробную информацию о происходящем процессе.</p>

    </div>
  </div>
</div>

<h3 id="анализ-тома-1">
  <a class="link-body-emphasis" href="#%d0%b0%d0%bd%d0%b0%d0%bb%d0%b8%d0%b7-%d1%82%d0%be%d0%bc%d0%b0-1">Анализ тома</a>
</h3><p>Анализ тома, с отображением хода выполнения и выводом результатов в подробном формате:</p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-3
shortcode-codeblock-cmd">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-61b120a2eb38c1fd6a47d0e105d14f81" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-cmd" data-lang="cmd"><span class="line"><span class="cl">defrag c: /u /a</span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-61b120a2eb38c1fd6a47d0e105d14f81"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<p>Где:</p>
<ul>
<li><code>c:</code> - буква тома (диск <code>C:</code>).</li>
<li><code>/u</code> - отображение хода выполнения операции.</li>
<li><code>/a</code> - анализ.</li>
</ul>
<h3 id="параллельная-дефрагментация">
  <a class="link-body-emphasis" href="#%d0%bf%d0%b0%d1%80%d0%b0%d0%bb%d0%bb%d0%b5%d0%bb%d1%8c%d0%bd%d0%b0%d1%8f-%d0%b4%d0%b5%d1%84%d1%80%d0%b0%d0%b3%d0%bc%d0%b5%d0%bd%d1%82%d0%b0%d1%86%d0%b8%d1%8f">Параллельная дефрагментация</a>
</h3><p>Параллельная дефрагментация томов <code>C:</code> и <code>D:</code> в фоновом режиме:</p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-4
shortcode-codeblock-cmd">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-0206790e0d979637696f2714dd02c2ae" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-cmd" data-lang="cmd"><span class="line"><span class="cl">defrag c: d: /m</span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-0206790e0d979637696f2714dd02c2ae"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<p>Где:</p>
<ul>
<li><code>c:</code> - буква тома (диск <code>C:</code>).</li>
<li><code>d:</code> - буква тома (диск <code>D:</code>).</li>
<li><code>/m</code> - выполнение операции с каждым томом параллельно в фоновом режиме.</li>
</ul>
<h3 id="дефрагментация-всех-томах">
  <a class="link-body-emphasis" href="#%d0%b4%d0%b5%d1%84%d1%80%d0%b0%d0%b3%d0%bc%d0%b5%d0%bd%d1%82%d0%b0%d1%86%d0%b8%d1%8f-%d0%b2%d1%81%d0%b5%d1%85-%d1%82%d0%be%d0%bc%d0%b0%d1%85">Дефрагментация всех томах</a>
</h3><p>Выполнить дефрагментацию на всех локальных томах с нормальным приоритетом:</p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-5
shortcode-codeblock-cmd">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-9ff74ebe64bb5849d7f70839a7862880" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-cmd" data-lang="cmd"><span class="line"><span class="cl">defrag /u /c /h</span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-9ff74ebe64bb5849d7f70839a7862880"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<p>Где:</p>
<ul>
<li><code>/u</code> - отображение хода выполнения операции.</li>
<li><code>/c</code> - выполнение операции на всех томах.</li>
<li><code>/h</code> - выполнение операции с нормальным приоритетом (по умолчанию приоритет пониженный).</li>
</ul>
<h3 id="trim-операция-для-ssd-1">
  <a class="link-body-emphasis" href="#trim-%d0%be%d0%bf%d0%b5%d1%80%d0%b0%d1%86%d0%b8%d1%8f-%d0%b4%d0%bb%d1%8f-ssd-1">TRIM-операция для SSD</a>
</h3>








  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-6
shortcode-codeblock-cmd">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-6551a6b1563fe4720fe35b81aadcd8b4" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-cmd" data-lang="cmd"><span class="line"><span class="cl">defrag /u /c /l</span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-6551a6b1563fe4720fe35b81aadcd8b4"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<p>Где:</p>
<ul>
<li><code>/u</code> - отображение хода выполнения операции.</li>
<li><code>/c</code> - выполнение операции на всех томах.</li>
<li><code>/l</code> или <code>/retrim</code> - на дисках SSD запускает TRIM-операцию.</li>
</ul>]]></turbo:content></item><item turbo="true"><title>MikroTik: Добавление корневых сертификатов в RouterOS</title><link>https://lib.onl/ru/2023/10/cc13623b-970c-5950-867e-168f9ba9025a/</link><pubDate>Thu, 19 Oct 2023 08:56:43 +0000</pubDate><dc:creator>Kai Kimera</dc:creator><category>Сеть</category><category>Безопасность</category><yandex:related><link url="https://lib.onl/ru/2020/07/ff2ae66e-8e14-5c4a-baa6-0cd2e59f6517/">MikroTik и CloudFlare: Динамический IP для домена</link></yandex:related><turbo:extendedHtml>true</turbo:extendedHtml><turbo:source>https://lib.onl/ru/2023/10/cc13623b-970c-5950-867e-168f9ba9025a/</turbo:source><turbo:topic>MikroTik: Добавление корневых сертификатов в RouterOS</turbo:topic><turbo:content><![CDATA[<p>Репозиторий корневых сертификатов необходим для того, чтобы <span class="shortcode shortcode-tag"><a href="/ru/tags/routeros/" target="_blank">#RouterOS</a></span> имела представление какие вообще центры сертификации существуют.</p>
<p>Если репозиторий заполнен корневыми сертификатами центров сертификации, <span class="shortcode shortcode-tag"><a href="/ru/tags/routeros/" target="_blank">#RouterOS</a></span> сможет проверять подлинность выданных этими центрами сертификатов, работать с DNS over HTTPS (<span class="shortcode shortcode-tag"><a href="/ru/tags/doh/" target="_blank">#DoH</a></span>) и делать другую работу, связанную с шифрованием данных.</p>
<h2 id="загрузка-базы-сертификатов">
  <a class="link-body-emphasis" href="#%d0%b7%d0%b0%d0%b3%d1%80%d1%83%d0%b7%d0%ba%d0%b0-%d0%b1%d0%b0%d0%b7%d1%8b-%d1%81%d0%b5%d1%80%d1%82%d0%b8%d1%84%d0%b8%d0%ba%d0%b0%d1%82%d0%be%d0%b2">Загрузка базы сертификатов</a>
</h2><p>Файл <a title="" href="https://curl.se/docs/caextract.html" target="_blank"
   rel="noopener noreferrer">cacert.pem</a> с сайта <a title="" href="https://curl.se/" target="_blank"
   rel="noopener noreferrer">curl.se</a> переодически обновляется и содержит в себе корневые сертификаты центров сертификации. Откроем терминал в <span class="shortcode shortcode-tag"><a href="/ru/tags/routeros/" target="_blank">#RouterOS</a></span> и скачаем сразу на роутер командой:</p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-0
shortcode-codeblock-text">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-98cc54661e3a099eeffadc722a8ddf76" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-text" data-lang="text"><span class="line"><span class="cl">/tool fetch url=&#34;https://curl.se/ca/cacert.pem&#34; dst-path=&#34;ros.cacert.pem&#34;</span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-98cc54661e3a099eeffadc722a8ddf76"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<p>Где:</p>
<ul>
<li><code>url</code> - URL файла, который необходимо скачать.</li>
<li><code>dst-path</code> - название, под которым файл сохранится на роутере. Я добавляю префикс <code>ros.</code>, чтобы знать, что этот файл важен для <span class="shortcode shortcode-tag"><a href="/ru/tags/routeros/" target="_blank">#RouterOS</a></span>.</li>
</ul>
<h2 id="импортирование-сертификатов-в-репозиторий">
  <a class="link-body-emphasis" href="#%d0%b8%d0%bc%d0%bf%d0%be%d1%80%d1%82%d0%b8%d1%80%d0%be%d0%b2%d0%b0%d0%bd%d0%b8%d0%b5-%d1%81%d0%b5%d1%80%d1%82%d0%b8%d1%84%d0%b8%d0%ba%d0%b0%d1%82%d0%be%d0%b2-%d0%b2-%d1%80%d0%b5%d0%bf%d0%be%d0%b7%d0%b8%d1%82%d0%be%d1%80%d0%b8%d0%b9">Импортирование сертификатов в репозиторий</a>
</h2><p>Теперь когда файл на роутере, нужно импортировать его содержимое в репозиторий сертификатов. Делается это следующей командой:</p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-1
shortcode-codeblock-text">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-4bd2a8445cebfc53c50f066ad4e828fa" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-text" data-lang="text"><span class="line"><span class="cl">/certificate import file-name=&#34;ros.cacert.pem&#34; passphrase=&#34;&#34; name=&#34;CA&#34;</span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-4bd2a8445cebfc53c50f066ad4e828fa"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<p>Где:</p>
<ul>
<li><code>file-name</code> - название файла на  роутере.</li>
<li><code>name</code> - название, под которым сертификаты будут обозначаться в репозитории сертификатов. Здесь я указываю <code>CA</code>, чтобы знать, что сертификаты импортировались вручную и представляют собой сертификаты CA. Вы можете ввести любое своё название, главное, чтобы оно для вас что-то обозначало.</li>
</ul>




    










    
    




<div class="shortcode shortcode-alert">
  <div class="alert alert-success d-flex overflow-hidden" role="alert">
    <div class="flex-shrink-0 align-self-center">
      <i class="fas fa-lightbulb fa-fw fa-2x"></i>
    </div>
    <div class="flex-grow-1 ms-3 overflow-hidden">
        <p>Параметр <code>name</code> можно не указывать, тогда при импорте сертификатов, RouterOS в этот параметр автоматически подставит название файла.</p>

    </div>
  </div>
</div>]]></turbo:content></item><item turbo="true"><title>Создание сертификатов при помощи OpenSSL</title><link>https://lib.onl/ru/2023/10/6733cb51-62a0-5ed9-b421-8f08c4e0cb18/</link><pubDate>Tue, 17 Oct 2023 23:42:31 +0000</pubDate><dc:creator>Kai Kimera</dc:creator><category>Терминал</category><category>Скрипты</category><category>Linux</category><yandex:related><link url="https://lib.onl/ru/2023/10/75075788-9308-56b7-b531-2008cb35f7d0/">Установка сертификата НУЦ Минцифры</link><link url="https://lib.onl/ru/2021/08/ca744dce-e607-52e6-9952-8ae04e052a5b/">Скрипт автоматического удаления устаревших файлов</link></yandex:related><turbo:extendedHtml>true</turbo:extendedHtml><turbo:source>https://lib.onl/ru/2023/10/6733cb51-62a0-5ed9-b421-8f08c4e0cb18/</turbo:source><turbo:topic>Создание сертификатов при помощи OpenSSL</turbo:topic><turbo:content><![CDATA[<p><span class="shortcode shortcode-tag"><a href="/ru/tags/openssl/" target="_blank">#OpenSSL</a></span> является библиотекой по работе с криптографией, но в этой статье я затрону только часть функций этого инструмента, а именно создание само-подписанных сертификатов.</p>
<h2 id="создание-центра-сертификации">
  <a class="link-body-emphasis" href="#%d1%81%d0%be%d0%b7%d0%b4%d0%b0%d0%bd%d0%b8%d0%b5-%d1%86%d0%b5%d0%bd%d1%82%d1%80%d0%b0-%d1%81%d0%b5%d1%80%d1%82%d0%b8%d1%84%d0%b8%d0%ba%d0%b0%d1%86%d0%b8%d0%b8">Создание центра сертификации</a>
</h2><p>При помощи корневого сертификата, мы будем подписывать сертификаты клиентские. Создаём сертификат центра сертификации&hellip;</p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-0
shortcode-codeblock-bash">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-5c21545b078f3139f55373a7b651c878" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">openssl ecparam -genkey -name <span class="s1">&#39;secp384r1&#39;</span> <span class="p">|</span> openssl ec -aes256 -out <span class="s2">&#34;_CA.key&#34;</span> <span class="o">&amp;&amp;</span> openssl req -new -sha384 -key <span class="s2">&#34;_CA.key&#34;</span> -out <span class="s2">&#34;_CA.csr&#34;</span> <span class="o">&amp;&amp;</span> openssl x509 -req -sha384 -days <span class="m">3650</span> -key <span class="s2">&#34;_CA.key&#34;</span> -in <span class="s2">&#34;_CA.csr&#34;</span> -out <span class="s2">&#34;_CA.crt&#34;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-5c21545b078f3139f55373a7b651c878"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<p>Где:</p>
<ul>
<li><code>-days '3650'</code> - количество дней, по прошествии которого сертификат центра сертификации станет недействительным.</li>
<li><code>'_CA.key'</code> - название создаваемого файла с ключом центра сертификации.</li>
<li><code>'_CA.crt'</code> - название создаваемого файла с сертификатом центра сертификации.</li>
</ul>
<h2 id="создание-клиентского-сертификата">
  <a class="link-body-emphasis" href="#%d1%81%d0%be%d0%b7%d0%b4%d0%b0%d0%bd%d0%b8%d0%b5-%d0%ba%d0%bb%d0%b8%d0%b5%d0%bd%d1%82%d1%81%d0%ba%d0%be%d0%b3%d0%be-%d1%81%d0%b5%d1%80%d1%82%d0%b8%d1%84%d0%b8%d0%ba%d0%b0%d1%82%d0%b0">Создание клиентского сертификата</a>
</h2><p>Как только будет готов корневой сертификат, можно приступать к выпуску клиентских сертификатов.</p>
<h3 id="создание-приватного-ключа">
  <a class="link-body-emphasis" href="#%d1%81%d0%be%d0%b7%d0%b4%d0%b0%d0%bd%d0%b8%d0%b5-%d0%bf%d1%80%d0%b8%d0%b2%d0%b0%d1%82%d0%bd%d0%be%d0%b3%d0%be-%d0%ba%d0%bb%d1%8e%d1%87%d0%b0">Создание приватного ключа</a>
</h3><p>Для начала создаём приватный ключ.</p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-1
shortcode-codeblock-bash">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-455d3674e1c04b5dff106d5851e40946" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">openssl ecparam -genkey -name <span class="s1">&#39;prime256v1&#39;</span> <span class="p">|</span> openssl ec -out <span class="s1">&#39;client.key&#39;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-455d3674e1c04b5dff106d5851e40946"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<p>Где:</p>
<ul>
<li><code>-out 'client.key'</code> - название создаваемого файла с клиентским приватным ключом.</li>
</ul>
<h3 id="создание-запроса-на-подпись-сертификата">
  <a class="link-body-emphasis" href="#%d1%81%d0%be%d0%b7%d0%b4%d0%b0%d0%bd%d0%b8%d0%b5-%d0%b7%d0%b0%d0%bf%d1%80%d0%be%d1%81%d0%b0-%d0%bd%d0%b0-%d0%bf%d0%be%d0%b4%d0%bf%d0%b8%d1%81%d1%8c-%d1%81%d0%b5%d1%80%d1%82%d0%b8%d1%84%d0%b8%d0%ba%d0%b0%d1%82%d0%b0">Создание запроса на подпись сертификата</a>
</h3><p>Выполняем запрос на сертификат.</p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-2
shortcode-codeblock-bash">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-8f8bb1b1ab9280898a57245f6f4ed4fc" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">openssl req -new -key <span class="s1">&#39;client.key&#39;</span> -out <span class="s1">&#39;client.csr&#39;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-8f8bb1b1ab9280898a57245f6f4ed4fc"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<p>Где:</p>
<ul>
<li><code>-key 'client.key'</code> - файл с приватным ключом клиентского сертификата.</li>
<li><code>-out 'client.csr'</code> - название создаваемого файла с запросом на подпись клиентского сертификата.</li>
</ul>
<p>При выполнении запроса будет предложено ввести актуальные данные для будущего сертификата:</p>
<ul>
<li><code>Country Name (2 letter code)</code> - двухбуквенный код страны, в которой юридически находится ваша организация.</li>
<li><code>State or Province Name (full name)</code> - штат или провинция, в которой юридически находится ваша организация.</li>
<li><code>Locality Name (e.g., city)</code> - город, в котором юридически находится ваша организация.</li>
<li><code>Organization Name (e.g., company)</code> - юридически зарегистрированное название вашей организации.</li>
<li><code>Organizational Unit Name (e.g., section)</code> - название вашего отдела в организации (опционально).</li>
<li><code>Common Name (e.g., server FQDN)</code> - полное доменное имя (FQDN) (например, <a title="" href="https://www.example.com" target="_blank"
   rel="noopener noreferrer">www.example.com</a>).</li>
<li><code>Email Address</code> - ваш адрес email (опционально).</li>
<li><code>A challenge password</code> - пароль (опционально).</li>
<li><code>An optional company name</code> - необязательное название компании (опционально).</li>
</ul>
<p>Самое главное поле это <code>Common Name (e.g., server FQDN)</code> (<code>CN</code>), заполнять его необходимо очень внимательно.</p>
<h3 id="создание-и-подпись-сертификата">
  <a class="link-body-emphasis" href="#%d1%81%d0%be%d0%b7%d0%b4%d0%b0%d0%bd%d0%b8%d0%b5-%d0%b8-%d0%bf%d0%be%d0%b4%d0%bf%d0%b8%d1%81%d1%8c-%d1%81%d0%b5%d1%80%d1%82%d0%b8%d1%84%d0%b8%d0%ba%d0%b0%d1%82%d0%b0">Создание и подпись сертификата</a>
</h3><p>В заключительной части остаётся только создать сам сертификат и подписать его.</p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-3
shortcode-codeblock-bash">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-9777ac92c7af9a6f46f3cc360465939c" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">openssl x509 -req -days <span class="m">3650</span> -in <span class="s1">&#39;client.csr&#39;</span> -CA <span class="s1">&#39;_CA.crt&#39;</span> -CAkey <span class="s1">&#39;_CA.key&#39;</span> -out <span class="s1">&#39;client.crt&#39;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-9777ac92c7af9a6f46f3cc360465939c"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<p>Где:</p>
<ul>
<li><code>-in 'client.csr'</code> - файл с запросом клиентского сертификата.</li>
<li><code>-CA '_CA.crt'</code> - файл с сертификатом центра сертификации.</li>
<li><code>-CAkey '_CA.key'</code> - файл с ключом центра сертификации.</li>
<li><code>-days '3650'</code> - количество дней, по прошествии которого клиентский сертификат станет недействительным.</li>
<li><code>-out 'client.crt'</code> - название создаваемого файла с клиентским сертификатом.</li>
</ul>
<h3 id="экспорт-сертификата">
  <a class="link-body-emphasis" href="#%d1%8d%d0%ba%d1%81%d0%bf%d0%be%d1%80%d1%82-%d1%81%d0%b5%d1%80%d1%82%d0%b8%d1%84%d0%b8%d0%ba%d0%b0%d1%82%d0%b0">Экспорт сертификата</a>
</h3><p>Для того, чтобы импортировать сертификат на клиентские устройства, его необходимо экспортировать в формат <code>P12</code>. <code>P12</code> является контейнером, в котором содержится приватный ключ сертификата и сам сертификат.</p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-4
shortcode-codeblock-bash">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-a8ffb6b9a8d3ca9eb0fcf1a40a2883fd" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">openssl pkcs12 -export -inkey <span class="s1">&#39;client.key&#39;</span> -in <span class="s1">&#39;client.crt&#39;</span> -out <span class="s1">&#39;client.p12&#39;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-a8ffb6b9a8d3ca9eb0fcf1a40a2883fd"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<p>Где:</p>
<ul>
<li><code>-inkey 'client.key'</code> - файл с приватным клиентским ключом.</li>
<li><code>-in 'client.crt'</code> - файл с клиентским сертификатом.</li>
<li><code>-out 'client.p12'</code> - название создаваемого файла-контейнера с приватным ключом и сертификатом.</li>
</ul>
<h3 id="верификация-сертификата">
  <a class="link-body-emphasis" href="#%d0%b2%d0%b5%d1%80%d0%b8%d1%84%d0%b8%d0%ba%d0%b0%d1%86%d0%b8%d1%8f-%d1%81%d0%b5%d1%80%d1%82%d0%b8%d1%84%d0%b8%d0%ba%d0%b0%d1%82%d0%b0">Верификация сертификата</a>
</h3>








  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-5
shortcode-codeblock-bash">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-25a113c6efd613054c7d4ab2ddbde805" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">openssl verify -CAfile <span class="s1">&#39;_CA.crt&#39;</span> <span class="s1">&#39;client.crt&#39;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-25a113c6efd613054c7d4ab2ddbde805"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<ul>
<li><code>-CAfile '_CA.crt'</code> - файл с сертификатом центра сертификации.</li>
<li><code>'client.crt'</code> - файл с клиентским сертификатом.</li>
</ul>
<h3 id="просмотр-сертификата">
  <a class="link-body-emphasis" href="#%d0%bf%d1%80%d0%be%d1%81%d0%bc%d0%be%d1%82%d1%80-%d1%81%d0%b5%d1%80%d1%82%d0%b8%d1%84%d0%b8%d0%ba%d0%b0%d1%82%d0%b0">Просмотр сертификата</a>
</h3>








  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-6
shortcode-codeblock-bash">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-fe1aac4d63d27f2e957d7f5e3daf1dfd" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">openssl x509 -in <span class="s1">&#39;client.crt&#39;</span> -text</span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-fe1aac4d63d27f2e957d7f5e3daf1dfd"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<p>Где:</p>
<ul>
<li><code>-in 'client.crt'</code> - файл с клиентским сертификатом.</li>
</ul>
<p>При выполнении команды, терминал покажет информацию со всеми основными сведениями о сертификате (пример ниже).</p>











<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-7 shortcode-codeblock-terminal
shortcode-codeblock-terminal-linux
shortcode-codeblock-terminal-linux-user">
  <div class="card overflow-hidden" data-bs-theme="dark">
    <div class="card-header">
      <div class="d-flex align-items-center">
        <div class="flex-shrink-0 ">
          <i class="fas fa-terminal fa-fw"></i>
        </div>
        <div class="flex-grow-1 mx-2">
          <h5 class="mb-0">Терминал</h5>
        </div>
        <div class="flex-shrink-0">
          <ul class="list-inline mb-0">
            <li class="list-inline-item" title='Копировать'>
              <a class="text-body" href="#"
                 data-fn="clipboard" data-clipboard-target="#cp-8c826fa4df7b4951a29f27c3642b59cf"
                 role="button" aria-label='Копировать'>
                <i class="fas fa-copy fa-fw"></i>
              </a>
            </li>
          </ul>
        </div>
      </div>
    </div>
    <div class="card-body p-0 overflow-auto" id="cp-8c826fa4df7b4951a29f27c3642b59cf"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-plaintext" data-lang="plaintext"><span class="line"><span class="cl">openssl x509 -in &#39;client.crt&#39; -text
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Certificate:
</span></span><span class="line"><span class="cl">    Data:
</span></span><span class="line"><span class="cl">        Version: 1 (0x0)
</span></span><span class="line"><span class="cl">        Serial Number:
</span></span><span class="line"><span class="cl">            49:14:b8:78:17:a1:ca:c4:6a:41:1b:23:f3:8a:8d:36:e0:9e:69:81
</span></span><span class="line"><span class="cl">        Signature Algorithm: ecdsa-with-SHA256
</span></span><span class="line"><span class="cl">        Issuer: C = AU, ST = Some-State, O = Internet Widgits Pty Ltd, CN = CA
</span></span><span class="line"><span class="cl">        Validity
</span></span><span class="line"><span class="cl">            Not Before: Oct 18 21:31:53 2023 GMT
</span></span><span class="line"><span class="cl">            Not After : Oct 15 21:31:53 2033 GMT
</span></span><span class="line"><span class="cl">        Subject: C = AU, ST = Some-State, O = Internet Widgits Pty Ltd, CN = CN-FQDN, emailAddress = mail@example.com
</span></span><span class="line"><span class="cl">        Subject Public Key Info:
</span></span><span class="line"><span class="cl">            Public Key Algorithm: id-ecPublicKey
</span></span><span class="line"><span class="cl">                Public-Key: (256 bit)
</span></span><span class="line"><span class="cl">                pub:
</span></span><span class="line"><span class="cl">                    04:9f:22:91:cc:14:b3:75:ad:44:cc:0d:96:0d:19:
</span></span><span class="line"><span class="cl">                    04:c4:20:79:fd:b7:f5:65:64:dd:65:a1:f0:b8:2d:
</span></span><span class="line"><span class="cl">                    e4:02:75:62:41:03:7c:6e:2f:48:e4:11:38:dc:ed:
</span></span><span class="line"><span class="cl">                    08:1f:4c:fa:5f:2f:a2:f5:5d:51:2e:8e:de:de:70:
</span></span><span class="line"><span class="cl">                    33:aa:e5:3b:95
</span></span><span class="line"><span class="cl">                ASN1 OID: prime256v1
</span></span><span class="line"><span class="cl">                NIST CURVE: P-256
</span></span><span class="line"><span class="cl">    Signature Algorithm: ecdsa-with-SHA256
</span></span><span class="line"><span class="cl">         30:64:02:30:0d:ff:b1:dc:8b:a6:c6:9c:ad:65:8a:7c:01:41:
</span></span><span class="line"><span class="cl">         9f:91:ca:24:4c:0b:28:5a:5c:f6:35:2a:b2:d7:58:ca:39:da:
</span></span><span class="line"><span class="cl">         6c:bf:cf:8b:23:20:ce:11:45:13:61:36:e2:23:4a:e9:02:30:
</span></span><span class="line"><span class="cl">         54:dc:45:ed:ef:21:58:ea:c7:b6:63:db:a2:d9:71:fe:3d:b3:
</span></span><span class="line"><span class="cl">         d6:1e:15:82:7b:c8:e8:08:33:d5:2f:d5:f2:8f:3b:41:ea:53:
</span></span><span class="line"><span class="cl">         1e:2d:a9:1e:9e:25:9c:fb:a7:12:f9:ec</span></span></code></pre></td></tr></table>
</div>
</div></div>
  </div>
</div>
<h3 id="просмотр-запроса-на-подпись-сертификата">
  <a class="link-body-emphasis" href="#%d0%bf%d1%80%d0%be%d1%81%d0%bc%d0%be%d1%82%d1%80-%d0%b7%d0%b0%d0%bf%d1%80%d0%be%d1%81%d0%b0-%d0%bd%d0%b0-%d0%bf%d0%be%d0%b4%d0%bf%d0%b8%d1%81%d1%8c-%d1%81%d0%b5%d1%80%d1%82%d0%b8%d1%84%d0%b8%d0%ba%d0%b0%d1%82%d0%b0">Просмотр запроса на подпись сертификата</a>
</h3>








  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-8
shortcode-codeblock-bash">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-d2f77071bb1302a50b6ceaa0921acebf" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">openssl req -in <span class="s1">&#39;client.csr&#39;</span> -text</span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-d2f77071bb1302a50b6ceaa0921acebf"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<p>Где:</p>
<ul>
<li><code>-in 'client.csr'</code> - файл с запросом на подпись клиентского сертификата.</li>
</ul>
<p>Команда выдаст информацию по запросу на подпись клиентского сертификата (пример ниже).</p>











<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-9 shortcode-codeblock-terminal
shortcode-codeblock-terminal-linux
shortcode-codeblock-terminal-linux-user">
  <div class="card overflow-hidden" data-bs-theme="dark">
    <div class="card-header">
      <div class="d-flex align-items-center">
        <div class="flex-shrink-0 ">
          <i class="fas fa-terminal fa-fw"></i>
        </div>
        <div class="flex-grow-1 mx-2">
          <h5 class="mb-0">Терминал</h5>
        </div>
        <div class="flex-shrink-0">
          <ul class="list-inline mb-0">
            <li class="list-inline-item" title='Копировать'>
              <a class="text-body" href="#"
                 data-fn="clipboard" data-clipboard-target="#cp-9158962212f7e107b78cc83dfa2355c7"
                 role="button" aria-label='Копировать'>
                <i class="fas fa-copy fa-fw"></i>
              </a>
            </li>
          </ul>
        </div>
      </div>
    </div>
    <div class="card-body p-0 overflow-auto" id="cp-9158962212f7e107b78cc83dfa2355c7"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-plaintext" data-lang="plaintext"><span class="line"><span class="cl">openssl req -in &#39;client.csr&#39; -text
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Certificate Request:
</span></span><span class="line"><span class="cl">    Data:
</span></span><span class="line"><span class="cl">        Version: 1 (0x0)
</span></span><span class="line"><span class="cl">        Subject: C = AU, ST = Some-State, O = Internet Widgits Pty Ltd, CN = CN-FQDN, emailAddress = mail@example.com
</span></span><span class="line"><span class="cl">        Subject Public Key Info:
</span></span><span class="line"><span class="cl">            Public Key Algorithm: id-ecPublicKey
</span></span><span class="line"><span class="cl">                Public-Key: (256 bit)
</span></span><span class="line"><span class="cl">                pub:
</span></span><span class="line"><span class="cl">                    04:9f:22:91:cc:14:b3:75:ad:44:cc:0d:96:0d:19:
</span></span><span class="line"><span class="cl">                    04:c4:20:79:fd:b7:f5:65:64:dd:65:a1:f0:b8:2d:
</span></span><span class="line"><span class="cl">                    e4:02:75:62:41:03:7c:6e:2f:48:e4:11:38:dc:ed:
</span></span><span class="line"><span class="cl">                    08:1f:4c:fa:5f:2f:a2:f5:5d:51:2e:8e:de:de:70:
</span></span><span class="line"><span class="cl">                    33:aa:e5:3b:95
</span></span><span class="line"><span class="cl">                ASN1 OID: prime256v1
</span></span><span class="line"><span class="cl">                NIST CURVE: P-256
</span></span><span class="line"><span class="cl">        Attributes:
</span></span><span class="line"><span class="cl">            a0:00
</span></span><span class="line"><span class="cl">        Requested Extensions:
</span></span><span class="line"><span class="cl">    Signature Algorithm: ecdsa-with-SHA256
</span></span><span class="line"><span class="cl">         30:45:02:20:51:9c:a0:b9:b2:61:7f:fa:64:ea:34:1f:65:15:
</span></span><span class="line"><span class="cl">         37:ae:f4:89:30:47:11:89:db:c4:1b:1d:9b:82:b9:64:ea:c7:
</span></span><span class="line"><span class="cl">         02:21:00:f8:00:70:4e:e6:db:99:78:cf:25:22:c0:8d:c6:b1:
</span></span><span class="line"><span class="cl">         f3:f0:d8:68:3b:c2:51:21:a5:b3:fa:97:f9:85:c6:9c:49</span></span></code></pre></td></tr></table>
</div>
</div></div>
  </div>
</div>
<h2 id="автоматизация">
  <a class="link-body-emphasis" href="#%d0%b0%d0%b2%d1%82%d0%be%d0%bc%d0%b0%d1%82%d0%b8%d0%b7%d0%b0%d1%86%d0%b8%d1%8f">Автоматизация</a>
</h2><p>Команд много. Поэтому я как обычно, решил всё автоматизировать и загнать в скрипт.</p>

    

    
        
            
            <div class="shortcode shortcode-file mb-3">
              <div class="card overflow-hidden" data-bs-theme="dark">
                <div class="card-header">
                  <div class="d-flex align-items-center">
                    <div class="flex-shrink-0">
                      <i class="far fa-file-code fa-fw"></i>
                    </div>
                    <div class="flex-grow-1 mx-2 text-truncate">
                      <code>bash.openssl.ca.sh</code>
                    </div>
                    <div class="flex-shrink-0">
                      <ul class="list-inline mb-0">
                        <li class="list-inline-item" title='Копировать'>
                          <a class="text-body" href="#"
                             data-fn="clipboard" data-clipboard-target="#cp-c6bf93e3d8b917467b0d82116999cc7b"
                             role="button" aria-label='Копировать'>
                            <i class="fas fa-copy fa-fw"></i>
                          </a>
                        </li>
                        <li class="list-inline-item" title='Скачать'>
                          <a class="text-body" href="/ru/2023/10/6733cb51-62a0-5ed9-b421-8f08c4e0cb18/bash.openssl.ca.sh" download
                             role="button" aria-label='Скачать'>
                            <i class="fas fa-download fa-fw"></i>
                          </a>
                        </li>
                        <li class="list-inline-item" title='Открыть'>
                          <a class="text-body" href="/ru/2023/10/6733cb51-62a0-5ed9-b421-8f08c4e0cb18/bash.openssl.ca.sh" target="_blank"
                             role="button" aria-label='Открыть'>
                            <i class="fas fa-arrow-up-right-from-square fa-fw"></i>
                          </a>
                        </li>
                      </ul>
                    </div>
                  </div>
                </div>
                <div class="card-body p-0 overflow-auto" id="cp-c6bf93e3d8b917467b0d82116999cc7b">
                    
                        
                    
                    <div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">  1
</span><span class="lnt">  2
</span><span class="lnt">  3
</span><span class="lnt">  4
</span><span class="lnt">  5
</span><span class="lnt">  6
</span><span class="lnt">  7
</span><span class="lnt">  8
</span><span class="lnt">  9
</span><span class="lnt"> 10
</span><span class="lnt"> 11
</span><span class="lnt"> 12
</span><span class="lnt"> 13
</span><span class="lnt"> 14
</span><span class="lnt"> 15
</span><span class="lnt"> 16
</span><span class="lnt"> 17
</span><span class="lnt"> 18
</span><span class="lnt"> 19
</span><span class="lnt"> 20
</span><span class="lnt"> 21
</span><span class="lnt"> 22
</span><span class="lnt"> 23
</span><span class="lnt"> 24
</span><span class="lnt"> 25
</span><span class="lnt"> 26
</span><span class="lnt"> 27
</span><span class="lnt"> 28
</span><span class="lnt"> 29
</span><span class="lnt"> 30
</span><span class="lnt"> 31
</span><span class="lnt"> 32
</span><span class="lnt"> 33
</span><span class="lnt"> 34
</span><span class="lnt"> 35
</span><span class="lnt"> 36
</span><span class="lnt"> 37
</span><span class="lnt"> 38
</span><span class="lnt"> 39
</span><span class="lnt"> 40
</span><span class="lnt"> 41
</span><span class="lnt"> 42
</span><span class="lnt"> 43
</span><span class="lnt"> 44
</span><span class="lnt"> 45
</span><span class="lnt"> 46
</span><span class="lnt"> 47
</span><span class="lnt"> 48
</span><span class="lnt"> 49
</span><span class="lnt"> 50
</span><span class="lnt"> 51
</span><span class="lnt"> 52
</span><span class="lnt"> 53
</span><span class="lnt"> 54
</span><span class="lnt"> 55
</span><span class="lnt"> 56
</span><span class="lnt"> 57
</span><span class="lnt"> 58
</span><span class="lnt"> 59
</span><span class="lnt"> 60
</span><span class="lnt"> 61
</span><span class="lnt"> 62
</span><span class="lnt"> 63
</span><span class="lnt"> 64
</span><span class="lnt"> 65
</span><span class="lnt"> 66
</span><span class="lnt"> 67
</span><span class="lnt"> 68
</span><span class="lnt"> 69
</span><span class="lnt"> 70
</span><span class="lnt"> 71
</span><span class="lnt"> 72
</span><span class="lnt"> 73
</span><span class="lnt"> 74
</span><span class="lnt"> 75
</span><span class="lnt"> 76
</span><span class="lnt"> 77
</span><span class="lnt"> 78
</span><span class="lnt"> 79
</span><span class="lnt"> 80
</span><span class="lnt"> 81
</span><span class="lnt"> 82
</span><span class="lnt"> 83
</span><span class="lnt"> 84
</span><span class="lnt"> 85
</span><span class="lnt"> 86
</span><span class="lnt"> 87
</span><span class="lnt"> 88
</span><span class="lnt"> 89
</span><span class="lnt"> 90
</span><span class="lnt"> 91
</span><span class="lnt"> 92
</span><span class="lnt"> 93
</span><span class="lnt"> 94
</span><span class="lnt"> 95
</span><span class="lnt"> 96
</span><span class="lnt"> 97
</span><span class="lnt"> 98
</span><span class="lnt"> 99
</span><span class="lnt">100
</span><span class="lnt">101
</span><span class="lnt">102
</span><span class="lnt">103
</span><span class="lnt">104
</span><span class="lnt">105
</span><span class="lnt">106
</span><span class="lnt">107
</span><span class="lnt">108
</span><span class="lnt">109
</span><span class="lnt">110
</span><span class="lnt">111
</span><span class="lnt">112
</span><span class="lnt">113
</span><span class="lnt">114
</span><span class="lnt">115
</span><span class="lnt">116
</span><span class="lnt">117
</span><span class="lnt">118
</span><span class="lnt">119
</span><span class="lnt">120
</span><span class="lnt">121
</span><span class="lnt">122
</span><span class="lnt">123
</span><span class="lnt">124
</span><span class="lnt">125
</span><span class="lnt">126
</span><span class="lnt">127
</span><span class="lnt">128
</span><span class="lnt">129
</span><span class="lnt">130
</span><span class="lnt">131
</span><span class="lnt">132
</span><span class="lnt">133
</span><span class="lnt">134
</span><span class="lnt">135
</span><span class="lnt">136
</span><span class="lnt">137
</span><span class="lnt">138
</span><span class="lnt">139
</span><span class="lnt">140
</span><span class="lnt">141
</span><span class="lnt">142
</span><span class="lnt">143
</span><span class="lnt">144
</span><span class="lnt">145
</span><span class="lnt">146
</span><span class="lnt">147
</span><span class="lnt">148
</span><span class="lnt">149
</span><span class="lnt">150
</span><span class="lnt">151
</span><span class="lnt">152
</span><span class="lnt">153
</span><span class="lnt">154
</span><span class="lnt">155
</span><span class="lnt">156
</span><span class="lnt">157
</span><span class="lnt">158
</span><span class="lnt">159
</span><span class="lnt">160
</span><span class="lnt">161
</span><span class="lnt">162
</span><span class="lnt">163
</span><span class="lnt">164
</span><span class="lnt">165
</span><span class="lnt">166
</span><span class="lnt">167
</span><span class="lnt">168
</span><span class="lnt">169
</span><span class="lnt">170
</span><span class="lnt">171
</span><span class="lnt">172
</span><span class="lnt">173
</span><span class="lnt">174
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sh" data-lang="sh"><span class="line"><span class="cl"><span class="cp">#!/usr/bin/env -S bash -e
</span></span></span><span class="line"><span class="cl"><span class="cp"></span><span class="c1">#</span>
</span></span><span class="line"><span class="cl"><span class="c1"># OpenSSL certificate generator with CA.</span>
</span></span><span class="line"><span class="cl"><span class="c1">#</span>
</span></span><span class="line"><span class="cl"><span class="c1"># @package    Bash</span>
</span></span><span class="line"><span class="cl"><span class="c1"># @author     Kai Kimera &lt;mail@kai.kim&gt;</span>
</span></span><span class="line"><span class="cl"><span class="c1"># @copyright  2023 Library Online</span>
</span></span><span class="line"><span class="cl"><span class="c1"># @license    MIT</span>
</span></span><span class="line"><span class="cl"><span class="c1"># @version    0.1.2</span>
</span></span><span class="line"><span class="cl"><span class="c1"># @link       https://lib.onl/ru/2023/10/6733cb51-62a0-5ed9-b421-8f08c4e0cb18/</span>
</span></span><span class="line"><span class="cl"><span class="c1"># -------------------------------------------------------------------------------------------------------------------- #</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="o">((</span> <span class="nv">EUID</span> <span class="o">==</span> <span class="m">0</span> <span class="o">))</span> <span class="o">&amp;&amp;</span> <span class="o">{</span> <span class="nb">echo</span> &gt;<span class="p">&amp;</span><span class="m">2</span> <span class="s1">&#39;This script should not be run as root!&#39;</span><span class="p">;</span> <span class="nb">exit</span> 1<span class="p">;</span> <span class="o">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># -------------------------------------------------------------------------------------------------------------------- #</span>
</span></span><span class="line"><span class="cl"><span class="c1"># CONFIGURATION.</span>
</span></span><span class="line"><span class="cl"><span class="c1"># -------------------------------------------------------------------------------------------------------------------- #</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Get &#39;cat&#39; command.</span>
</span></span><span class="line"><span class="cl"><span class="nv">cat</span><span class="o">=</span><span class="s2">&#34;</span><span class="k">$(</span> <span class="nb">command</span> -v cat <span class="k">)</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Get &#39;date&#39; command.</span>
</span></span><span class="line"><span class="cl"><span class="nv">date</span><span class="o">=</span><span class="s2">&#34;</span><span class="k">$(</span> <span class="nb">command</span> -v date <span class="k">)</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Get &#39;mkdir&#39; command.</span>
</span></span><span class="line"><span class="cl"><span class="nv">mkdir</span><span class="o">=</span><span class="s2">&#34;</span><span class="k">$(</span> <span class="nb">command</span> -v mkdir <span class="k">)</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Get &#39;openssl&#39; command.</span>
</span></span><span class="line"><span class="cl"><span class="nv">openssl</span><span class="o">=</span><span class="s2">&#34;</span><span class="k">$(</span> <span class="nb">command</span> -v openssl <span class="k">)</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Get &#39;shuf&#39; command.</span>
</span></span><span class="line"><span class="cl"><span class="nv">shuf</span><span class="o">=</span><span class="s2">&#34;</span><span class="k">$(</span> <span class="nb">command</span> -v shuf <span class="k">)</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># CA file names.</span>
</span></span><span class="line"><span class="cl"><span class="nv">ca</span><span class="o">=</span><span class="s1">&#39;_CA&#39;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Specifies the number of days to make a certificate valid for.</span>
</span></span><span class="line"><span class="cl"><span class="c1"># Default is 10 years.</span>
</span></span><span class="line"><span class="cl"><span class="nv">days</span><span class="o">=</span><span class="s1">&#39;3650&#39;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># The two-letter country code where your company is legally located.</span>
</span></span><span class="line"><span class="cl"><span class="nv">country</span><span class="o">=</span><span class="s1">&#39;RU&#39;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># The state/province where your company is legally located.</span>
</span></span><span class="line"><span class="cl"><span class="nv">state</span><span class="o">=</span><span class="s1">&#39;Russia&#39;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># The city where your company is legally located.</span>
</span></span><span class="line"><span class="cl"><span class="nv">city</span><span class="o">=</span><span class="s1">&#39;Moscow&#39;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Your company&#39;s legally registered name (e.g., YourCompany, Inc.).</span>
</span></span><span class="line"><span class="cl"><span class="nv">org</span><span class="o">=</span><span class="s1">&#39;YourCompany&#39;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Timestamp.</span>
</span></span><span class="line"><span class="cl"><span class="nv">ts</span><span class="o">=</span><span class="s2">&#34;</span><span class="k">$(</span> <span class="si">${</span><span class="nv">date</span><span class="si">}</span> -u <span class="s1">&#39;+%s&#39;</span> <span class="k">)</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Suffix.</span>
</span></span><span class="line"><span class="cl"><span class="nv">sfx</span><span class="o">=</span><span class="k">$(</span> <span class="si">${</span><span class="nv">shuf</span><span class="si">}</span> -i <span class="s1">&#39;1000-9999&#39;</span> -n <span class="m">1</span> --random-source<span class="o">=</span><span class="s1">&#39;/dev/random&#39;</span> <span class="k">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># -------------------------------------------------------------------------------------------------------------------- #</span>
</span></span><span class="line"><span class="cl"><span class="c1"># -----------------------------------------------------&lt; SCRIPT &gt;----------------------------------------------------- #</span>
</span></span><span class="line"><span class="cl"><span class="c1"># -------------------------------------------------------------------------------------------------------------------- #</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># -------------------------------------------------------------------------------------------------------------------- #</span>
</span></span><span class="line"><span class="cl"><span class="c1"># CERTIFICATE AUTHORITY.</span>
</span></span><span class="line"><span class="cl"><span class="c1"># -------------------------------------------------------------------------------------------------------------------- #</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">ca<span class="o">()</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">  ! <span class="o">[[</span> -x <span class="s2">&#34;</span><span class="si">${</span><span class="nv">openssl</span><span class="si">}</span><span class="s2">&#34;</span> <span class="o">]]</span> <span class="o">&amp;&amp;</span> <span class="o">{</span> <span class="nb">echo</span> &gt;<span class="p">&amp;</span><span class="m">2</span> <span class="s2">&#34;&#39;openssl&#39; is not installed!&#34;</span><span class="p">;</span> <span class="nb">exit</span> 1<span class="p">;</span> <span class="o">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="nb">local</span> <span class="nv">name</span><span class="o">=</span><span class="s2">&#34;</span><span class="si">${</span><span class="nv">1</span><span class="k">:-</span><span class="nv">example</span><span class="p">.com</span><span class="si">}</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl">  <span class="nb">local</span> <span class="nv">email</span><span class="o">=</span><span class="s2">&#34;</span><span class="si">${</span><span class="nv">2</span><span class="k">:-</span><span class="nv">mail</span><span class="p">@example.com</span><span class="si">}</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl">  <span class="nb">local</span> <span class="nv">v3ext_ca</span><span class="o">=</span><span class="s1">&#39;_CA.v3ext&#39;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  cat &gt; <span class="s2">&#34;</span><span class="si">${</span><span class="nv">v3ext_ca</span><span class="si">}</span><span class="s2">&#34;</span> <span class="s">&lt;&lt;EOF
</span></span></span><span class="line"><span class="cl"><span class="s">authorityKeyIdentifier = keyid:always,issuer
</span></span></span><span class="line"><span class="cl"><span class="s">basicConstraints = critical, CA:TRUE
</span></span></span><span class="line"><span class="cl"><span class="s">keyUsage = critical, digitalSignature, cRLSign, keyCertSign
</span></span></span><span class="line"><span class="cl"><span class="s">EOF</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="nb">echo</span> <span class="s1">&#39;&#39;</span> <span class="o">&amp;&amp;</span> <span class="nb">echo</span> <span class="s2">&#34;--- [SSL-CA] CREATING A CA CERTIFICATE&#34;</span> <span class="o">&amp;&amp;</span> <span class="nb">echo</span> <span class="s1">&#39;&#39;</span>
</span></span><span class="line"><span class="cl">  <span class="si">${</span><span class="nv">openssl</span><span class="si">}</span> ecparam -genkey -name <span class="s1">&#39;secp384r1&#39;</span> <span class="p">|</span> <span class="si">${</span><span class="nv">openssl</span><span class="si">}</span> ec -aes256 -out <span class="s2">&#34;</span><span class="si">${</span><span class="nv">ca</span><span class="si">}</span><span class="s2">.key&#34;</span> <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>    <span class="o">&amp;&amp;</span> <span class="si">${</span><span class="nv">openssl</span><span class="si">}</span> req -new -sha384 -key <span class="s2">&#34;</span><span class="si">${</span><span class="nv">ca</span><span class="si">}</span><span class="s2">.key&#34;</span> -out <span class="s2">&#34;</span><span class="si">${</span><span class="nv">ca</span><span class="si">}</span><span class="s2">.csr&#34;</span> <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>    -subj <span class="s2">&#34;/C=</span><span class="si">${</span><span class="nv">country</span><span class="si">}</span><span class="s2">/ST=</span><span class="si">${</span><span class="nv">state</span><span class="si">}</span><span class="s2">/L=</span><span class="si">${</span><span class="nv">city</span><span class="si">}</span><span class="s2">/O=</span><span class="si">${</span><span class="nv">org</span><span class="si">}</span><span class="s2">/emailAddress=</span><span class="si">${</span><span class="nv">email</span><span class="si">}</span><span class="s2">/CN=</span><span class="si">${</span><span class="nv">name</span><span class="si">}</span><span class="s2">&#34;</span> <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>    <span class="o">&amp;&amp;</span> <span class="si">${</span><span class="nv">openssl</span><span class="si">}</span> x509 -req -extfile <span class="s2">&#34;</span><span class="si">${</span><span class="nv">v3ext_ca</span><span class="si">}</span><span class="s2">&#34;</span> -sha384 -days <span class="si">${</span><span class="nv">days</span><span class="si">}</span> -key <span class="s2">&#34;</span><span class="si">${</span><span class="nv">ca</span><span class="si">}</span><span class="s2">.key&#34;</span> -in <span class="s2">&#34;</span><span class="si">${</span><span class="nv">ca</span><span class="si">}</span><span class="s2">.csr&#34;</span> -out <span class="s2">&#34;</span><span class="si">${</span><span class="nv">ca</span><span class="si">}</span><span class="s2">.crt&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    _info <span class="s2">&#34;</span><span class="si">${</span><span class="nv">ca</span><span class="si">}</span><span class="s2">.crt&#34;</span>
</span></span><span class="line"><span class="cl"><span class="o">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># -------------------------------------------------------------------------------------------------------------------- #</span>
</span></span><span class="line"><span class="cl"><span class="c1"># CLIENT CERTIFICATE.</span>
</span></span><span class="line"><span class="cl"><span class="c1"># -------------------------------------------------------------------------------------------------------------------- #</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">cert<span class="o">()</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">  <span class="k">for</span> i in <span class="s2">&#34;</span><span class="si">${</span><span class="nv">mkdir</span><span class="si">}</span><span class="s2">&#34;</span> <span class="s2">&#34;</span><span class="si">${</span><span class="nv">openssl</span><span class="si">}</span><span class="s2">&#34;</span> <span class="s2">&#34;</span><span class="si">${</span><span class="nv">shuf</span><span class="si">}</span><span class="s2">&#34;</span><span class="p">;</span> <span class="k">do</span>
</span></span><span class="line"><span class="cl">    ! <span class="o">[[</span> -x <span class="s2">&#34;</span><span class="si">${</span><span class="nv">i</span><span class="si">}</span><span class="s2">&#34;</span> <span class="o">]]</span> <span class="o">&amp;&amp;</span> <span class="o">{</span> <span class="nb">echo</span> &gt;<span class="p">&amp;</span><span class="m">2</span> <span class="s2">&#34;&#39;</span><span class="si">${</span><span class="nv">i</span><span class="si">}</span><span class="s2">&#39; is not installed!&#34;</span><span class="p">;</span> <span class="nb">exit</span> 1<span class="p">;</span> <span class="o">}</span>
</span></span><span class="line"><span class="cl">  <span class="k">done</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="nb">local</span> name<span class="p">;</span> <span class="nv">name</span><span class="o">=</span><span class="s2">&#34;</span><span class="si">${</span><span class="nv">1</span><span class="k">:-</span><span class="nv">example</span><span class="p">.com</span><span class="si">}</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl">  <span class="nb">local</span> email<span class="p">;</span> <span class="nv">email</span><span class="o">=</span><span class="s2">&#34;</span><span class="si">${</span><span class="nv">2</span><span class="k">:-</span><span class="nv">mail</span><span class="p">@example.com</span><span class="si">}</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl">  <span class="nb">local</span> type<span class="p">;</span> <span class="nv">type</span><span class="o">=</span><span class="s2">&#34;</span><span class="si">${</span><span class="nv">3</span><span class="k">:-</span><span class="nv">server</span><span class="si">}</span><span class="s2">&#34;</span><span class="p">;</span> <span class="o">[[</span> <span class="s2">&#34;</span><span class="si">${</span><span class="nv">name</span><span class="si">}</span><span class="s2">&#34;</span> <span class="o">=</span> *<span class="s1">&#39; &#39;</span>* <span class="o">]]</span> <span class="o">&amp;&amp;</span> <span class="nv">type</span><span class="o">=</span><span class="s1">&#39;client&#39;</span>
</span></span><span class="line"><span class="cl">  <span class="nb">local</span> dir<span class="p">;</span> <span class="nv">dir</span><span class="o">=</span><span class="s2">&#34;</span><span class="si">${</span><span class="nv">type</span><span class="si">}</span><span class="s2">/</span><span class="si">${</span><span class="nv">name</span><span class="p">// /_</span><span class="si">}</span><span class="s2">&#34;</span><span class="p">;</span> <span class="si">${</span><span class="nv">mkdir</span><span class="si">}</span> -p <span class="s2">&#34;</span><span class="si">${</span><span class="nv">dir</span><span class="si">}</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl">  <span class="nb">local</span> file<span class="p">;</span> <span class="nv">file</span><span class="o">=</span><span class="s2">&#34;</span><span class="si">${</span><span class="nv">dir</span><span class="si">}</span><span class="s2">/</span><span class="si">${</span><span class="nv">email</span><span class="si">}</span><span class="s2">.</span><span class="si">${</span><span class="nv">ts</span><span class="si">}</span><span class="s2">.</span><span class="si">${</span><span class="nv">sfx</span><span class="si">}</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="nb">local</span> v3ext
</span></span><span class="line"><span class="cl">  <span class="k">if</span> <span class="o">[[</span> <span class="s2">&#34;</span><span class="si">${</span><span class="nv">type</span><span class="si">}</span><span class="s2">&#34;</span> <span class="o">=</span> <span class="s1">&#39;client&#39;</span> <span class="o">]]</span><span class="p">;</span> <span class="k">then</span>
</span></span><span class="line"><span class="cl">    <span class="nv">v3ext</span><span class="o">=</span><span class="k">$(</span> _v3ext_client <span class="s2">&#34;</span><span class="si">${</span><span class="nv">file</span><span class="si">}</span><span class="s2">.v3ext&#34;</span> <span class="k">)</span>
</span></span><span class="line"><span class="cl">  <span class="k">else</span>
</span></span><span class="line"><span class="cl">    <span class="nv">v3ext</span><span class="o">=</span><span class="k">$(</span> _v3ext_server <span class="s2">&#34;</span><span class="si">${</span><span class="nv">file</span><span class="si">}</span><span class="s2">.v3ext&#34;</span> <span class="s2">&#34;</span><span class="si">${</span><span class="nv">name</span><span class="si">}</span><span class="s2">&#34;</span> <span class="k">)</span>
</span></span><span class="line"><span class="cl">  <span class="k">fi</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="nb">echo</span> <span class="s1">&#39;&#39;</span> <span class="o">&amp;&amp;</span> <span class="nb">echo</span> <span class="s2">&#34;--- [SSL] CREATING A </span><span class="si">${</span><span class="nv">type</span><span class="p">^^</span><span class="si">}</span><span class="s2"> CERTIFICATE&#34;</span> <span class="o">&amp;&amp;</span> <span class="nb">echo</span> <span class="s1">&#39;&#39;</span>
</span></span><span class="line"><span class="cl">  <span class="si">${</span><span class="nv">openssl</span><span class="si">}</span> ecparam -genkey -name <span class="s1">&#39;prime256v1&#39;</span> <span class="p">|</span> <span class="si">${</span><span class="nv">openssl</span><span class="si">}</span> ec -out <span class="s2">&#34;</span><span class="si">${</span><span class="nv">file</span><span class="si">}</span><span class="s2">.key&#34;</span> <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>    <span class="o">&amp;&amp;</span> <span class="si">${</span><span class="nv">openssl</span><span class="si">}</span> req -new -key <span class="s2">&#34;</span><span class="si">${</span><span class="nv">file</span><span class="si">}</span><span class="s2">.key&#34;</span> -out <span class="s2">&#34;</span><span class="si">${</span><span class="nv">file</span><span class="si">}</span><span class="s2">.csr&#34;</span> <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>    -subj <span class="s2">&#34;/C=</span><span class="si">${</span><span class="nv">country</span><span class="si">}</span><span class="s2">/ST=</span><span class="si">${</span><span class="nv">state</span><span class="si">}</span><span class="s2">/L=</span><span class="si">${</span><span class="nv">city</span><span class="si">}</span><span class="s2">/O=</span><span class="si">${</span><span class="nv">org</span><span class="si">}</span><span class="s2">/emailAddress=</span><span class="si">${</span><span class="nv">email</span><span class="si">}</span><span class="s2">/CN=</span><span class="si">${</span><span class="nv">name</span><span class="si">}</span><span class="s2">&#34;</span> <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>    <span class="o">&amp;&amp;</span> <span class="si">${</span><span class="nv">openssl</span><span class="si">}</span> x509 -req -extfile <span class="s2">&#34;</span><span class="si">${</span><span class="nv">v3ext</span><span class="si">}</span><span class="s2">&#34;</span> -days <span class="si">${</span><span class="nv">days</span><span class="si">}</span> -in <span class="s2">&#34;</span><span class="si">${</span><span class="nv">file</span><span class="si">}</span><span class="s2">.csr&#34;</span> <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>    -CA <span class="s2">&#34;</span><span class="si">${</span><span class="nv">ca</span><span class="si">}</span><span class="s2">.crt&#34;</span> -CAkey <span class="s2">&#34;</span><span class="si">${</span><span class="nv">ca</span><span class="si">}</span><span class="s2">.key&#34;</span> -CAcreateserial -CAserial <span class="s2">&#34;</span><span class="si">${</span><span class="nv">file</span><span class="si">}</span><span class="s2">.srl&#34;</span> -out <span class="s2">&#34;</span><span class="si">${</span><span class="nv">file</span><span class="si">}</span><span class="s2">.crt&#34;</span> <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>    <span class="o">&amp;&amp;</span> <span class="si">${</span><span class="nv">cat</span><span class="si">}</span> <span class="s2">&#34;</span><span class="si">${</span><span class="nv">file</span><span class="si">}</span><span class="s2">.key&#34;</span> <span class="s2">&#34;</span><span class="si">${</span><span class="nv">file</span><span class="si">}</span><span class="s2">.crt&#34;</span> <span class="s2">&#34;</span><span class="si">${</span><span class="nv">ca</span><span class="si">}</span><span class="s2">.crt&#34;</span> &gt; <span class="s2">&#34;</span><span class="si">${</span><span class="nv">file</span><span class="si">}</span><span class="s2">.crt.chain&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  _verify <span class="s2">&#34;</span><span class="si">${</span><span class="nv">ca</span><span class="si">}</span><span class="s2">.crt&#34;</span> <span class="s2">&#34;</span><span class="si">${</span><span class="nv">file</span><span class="si">}</span><span class="s2">.crt&#34;</span> <span class="o">&amp;&amp;</span> _info <span class="s2">&#34;</span><span class="si">${</span><span class="nv">file</span><span class="si">}</span><span class="s2">.crt&#34;</span> <span class="o">&amp;&amp;</span> _export <span class="s2">&#34;</span><span class="si">${</span><span class="nv">file</span><span class="si">}</span><span class="s2">.key&#34;</span> <span class="s2">&#34;</span><span class="si">${</span><span class="nv">file</span><span class="si">}</span><span class="s2">.crt&#34;</span> <span class="s2">&#34;</span><span class="si">${</span><span class="nv">file</span><span class="si">}</span><span class="s2">.p12&#34;</span>
</span></span><span class="line"><span class="cl"><span class="o">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">_verify<span class="o">()</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">  <span class="nb">echo</span> <span class="s1">&#39;&#39;</span> <span class="o">&amp;&amp;</span> <span class="nb">echo</span> <span class="s2">&#34;--- [SSL] CERTIFICATE VERIFICATION&#34;</span> <span class="o">&amp;&amp;</span> <span class="nb">echo</span> <span class="s1">&#39;&#39;</span>
</span></span><span class="line"><span class="cl">  <span class="k">for</span> i in <span class="s2">&#34;</span><span class="si">${</span><span class="nv">1</span><span class="si">}</span><span class="s2">&#34;</span> <span class="s2">&#34;</span><span class="si">${</span><span class="nv">2</span><span class="si">}</span><span class="s2">&#34;</span><span class="p">;</span> <span class="k">do</span> <span class="o">[[</span> ! -f <span class="s2">&#34;</span><span class="si">${</span><span class="nv">i</span><span class="si">}</span><span class="s2">&#34;</span> <span class="o">]]</span> <span class="o">&amp;&amp;</span> <span class="o">{</span> <span class="nb">echo</span> &gt;<span class="p">&amp;</span><span class="m">2</span> <span class="s2">&#34;&#39;</span><span class="si">${</span><span class="nv">i</span><span class="si">}</span><span class="s2">&#39; not found!&#34;</span><span class="p">;</span> <span class="nb">exit</span> 1<span class="p">;</span> <span class="o">}</span><span class="p">;</span> <span class="k">done</span>
</span></span><span class="line"><span class="cl">  <span class="si">${</span><span class="nv">openssl</span><span class="si">}</span> verify -CAfile <span class="s2">&#34;</span><span class="si">${</span><span class="nv">1</span><span class="si">}</span><span class="s2">&#34;</span> <span class="s2">&#34;</span><span class="si">${</span><span class="nv">2</span><span class="si">}</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl"><span class="o">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">_info<span class="o">()</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">  <span class="nb">echo</span> <span class="s1">&#39;&#39;</span> <span class="o">&amp;&amp;</span> <span class="nb">echo</span> <span class="s2">&#34;--- [SSL] CERTIFICATE DETAILS&#34;</span> <span class="o">&amp;&amp;</span> <span class="nb">echo</span> <span class="s1">&#39;&#39;</span>
</span></span><span class="line"><span class="cl">  <span class="o">[[</span> ! -f <span class="s2">&#34;</span><span class="si">${</span><span class="nv">1</span><span class="si">}</span><span class="s2">&#34;</span> <span class="o">]]</span> <span class="o">&amp;&amp;</span> <span class="o">{</span> <span class="nb">echo</span> &gt;<span class="p">&amp;</span><span class="m">2</span> <span class="s2">&#34;&#39;</span><span class="si">${</span><span class="nv">i</span><span class="si">}</span><span class="s2">&#39; not found!&#34;</span><span class="p">;</span> <span class="nb">exit</span> 1<span class="p">;</span> <span class="o">}</span>
</span></span><span class="line"><span class="cl">  <span class="si">${</span><span class="nv">openssl</span><span class="si">}</span> x509 -in <span class="s2">&#34;</span><span class="si">${</span><span class="nv">1</span><span class="si">}</span><span class="s2">&#34;</span> -text -noout
</span></span><span class="line"><span class="cl"><span class="o">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">_export<span class="o">()</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">  <span class="nb">echo</span> <span class="s1">&#39;&#39;</span> <span class="o">&amp;&amp;</span> <span class="nb">echo</span> <span class="s2">&#34;--- [SSL] EXPORTING A CERTIFICATE&#34;</span> <span class="o">&amp;&amp;</span> <span class="nb">echo</span> <span class="s1">&#39;&#39;</span>
</span></span><span class="line"><span class="cl">  <span class="k">for</span> i in <span class="s2">&#34;</span><span class="si">${</span><span class="nv">1</span><span class="si">}</span><span class="s2">&#34;</span> <span class="s2">&#34;</span><span class="si">${</span><span class="nv">2</span><span class="si">}</span><span class="s2">&#34;</span><span class="p">;</span> <span class="k">do</span> <span class="o">[[</span> ! -f <span class="s2">&#34;</span><span class="si">${</span><span class="nv">i</span><span class="si">}</span><span class="s2">&#34;</span> <span class="o">]]</span> <span class="o">&amp;&amp;</span> <span class="o">{</span> <span class="nb">echo</span> &gt;<span class="p">&amp;</span><span class="m">2</span> <span class="s2">&#34;&#39;</span><span class="si">${</span><span class="nv">i</span><span class="si">}</span><span class="s2">&#39; not found!&#34;</span><span class="p">;</span> <span class="nb">exit</span> 1<span class="p">;</span> <span class="o">}</span><span class="p">;</span> <span class="k">done</span>
</span></span><span class="line"><span class="cl">  <span class="si">${</span><span class="nv">openssl</span><span class="si">}</span> pkcs12 -export -inkey <span class="s2">&#34;</span><span class="si">${</span><span class="nv">1</span><span class="si">}</span><span class="s2">&#34;</span> -in <span class="s2">&#34;</span><span class="si">${</span><span class="nv">2</span><span class="si">}</span><span class="s2">&#34;</span> -out <span class="s2">&#34;</span><span class="si">${</span><span class="nv">3</span><span class="si">}</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl"><span class="o">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">_v3ext_client<span class="o">()</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">  cat &gt; <span class="s2">&#34;</span><span class="si">${</span><span class="nv">1</span><span class="si">}</span><span class="s2">&#34;</span> <span class="s">&lt;&lt;EOF
</span></span></span><span class="line"><span class="cl"><span class="s">authorityKeyIdentifier = keyid,issuer
</span></span></span><span class="line"><span class="cl"><span class="s">basicConstraints = CA:FALSE
</span></span></span><span class="line"><span class="cl"><span class="s">nsCertType = client, email
</span></span></span><span class="line"><span class="cl"><span class="s">nsComment = &#34;OpenSSL Generated Client Certificate&#34;
</span></span></span><span class="line"><span class="cl"><span class="s">keyUsage = critical, digitalSignature, keyEncipherment, nonRepudiation
</span></span></span><span class="line"><span class="cl"><span class="s">extendedKeyUsage = clientAuth, emailProtection
</span></span></span><span class="line"><span class="cl"><span class="s">EOF</span>
</span></span><span class="line"><span class="cl">  <span class="nb">echo</span> -n <span class="s2">&#34;</span><span class="si">${</span><span class="nv">1</span><span class="si">}</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl"><span class="o">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">_v3ext_server<span class="o">()</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">  cat &gt; <span class="s2">&#34;</span><span class="si">${</span><span class="nv">1</span><span class="si">}</span><span class="s2">&#34;</span> <span class="s">&lt;&lt;EOF
</span></span></span><span class="line"><span class="cl"><span class="s">authorityKeyIdentifier = keyid,issuer:always
</span></span></span><span class="line"><span class="cl"><span class="s">basicConstraints = CA:FALSE
</span></span></span><span class="line"><span class="cl"><span class="s">nsCertType = server
</span></span></span><span class="line"><span class="cl"><span class="s">nsComment = &#34;OpenSSL Generated Server Certificate&#34;
</span></span></span><span class="line"><span class="cl"><span class="s">keyUsage = critical, digitalSignature, keyEncipherment
</span></span></span><span class="line"><span class="cl"><span class="s">extendedKeyUsage = serverAuth, clientAuth
</span></span></span><span class="line"><span class="cl"><span class="s">subjectAltName = @alt_names
</span></span></span><span class="line"><span class="cl"><span class="s">
</span></span></span><span class="line"><span class="cl"><span class="s">[alt_names]
</span></span></span><span class="line"><span class="cl"><span class="s">DNS.1 = ${2}
</span></span></span><span class="line"><span class="cl"><span class="s">DNS.2 = *.${2}
</span></span></span><span class="line"><span class="cl"><span class="s">IP.1 = 127.0.0.1
</span></span></span><span class="line"><span class="cl"><span class="s">EOF</span>
</span></span><span class="line"><span class="cl">  <span class="nb">echo</span> -n <span class="s2">&#34;</span><span class="si">${</span><span class="nv">1</span><span class="si">}</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl"><span class="o">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># -------------------------------------------------------------------------------------------------------------------- #</span>
</span></span><span class="line"><span class="cl"><span class="c1"># -------------------------------------------------&lt; RUNNING SCRIPT &gt;------------------------------------------------- #</span>
</span></span><span class="line"><span class="cl"><span class="c1"># -------------------------------------------------------------------------------------------------------------------- #</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="s2">&#34;</span><span class="nv">$@</span><span class="s2">&#34;</span></span></span></code></pre></td></tr></table>
</div>
</div>
                </div>
              </div>
            </div>
        
    
<p>Скрипт содержит две функции, вызывать которых можно по отдельности. Функция <code>ca()</code> позволяет сгенерировать ключ и сертификат центра сертификации, а функция <code>cert()</code>, соответственно, генерирует клиентские сертификаты.</p>
<h3 id="использование">
  <a class="link-body-emphasis" href="#%d0%b8%d1%81%d0%bf%d0%be%d0%bb%d1%8c%d0%b7%d0%be%d0%b2%d0%b0%d0%bd%d0%b8%d0%b5">Использование</a>
</h3><ol>
<li>Создать ключ и сертификат центра сертификации:</li>
</ol>











<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-10 shortcode-codeblock-terminal
shortcode-codeblock-terminal-linux
shortcode-codeblock-terminal-linux-user">
  <div class="card overflow-hidden" data-bs-theme="dark">
    <div class="card-header">
      <div class="d-flex align-items-center">
        <div class="flex-shrink-0 ">
          <i class="fas fa-terminal fa-fw"></i>
        </div>
        <div class="flex-grow-1 mx-2">
          <h5 class="mb-0">Терминал</h5>
        </div>
        <div class="flex-shrink-0">
          <ul class="list-inline mb-0">
            <li class="list-inline-item" title='Копировать'>
              <a class="text-body" href="#"
                 data-fn="clipboard" data-clipboard-target="#cp-1c603acf8ad9f60fe2d229881291682e"
                 role="button" aria-label='Копировать'>
                <i class="fas fa-copy fa-fw"></i>
              </a>
            </li>
          </ul>
        </div>
      </div>
    </div>
    <div class="card-body p-0 overflow-auto" id="cp-1c603acf8ad9f60fe2d229881291682e"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-plaintext" data-lang="plaintext"><span class="line"><span class="cl">bash bash.openssl.ca.sh ca</span></span></code></pre></td></tr></table>
</div>
</div></div>
  </div>
</div>
<ol start="2">
<li>Создать клиентские ключи и сертификаты:</li>
</ol>











<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-11 shortcode-codeblock-terminal
shortcode-codeblock-terminal-linux
shortcode-codeblock-terminal-linux-user">
  <div class="card overflow-hidden" data-bs-theme="dark">
    <div class="card-header">
      <div class="d-flex align-items-center">
        <div class="flex-shrink-0 ">
          <i class="fas fa-terminal fa-fw"></i>
        </div>
        <div class="flex-grow-1 mx-2">
          <h5 class="mb-0">Терминал</h5>
        </div>
        <div class="flex-shrink-0">
          <ul class="list-inline mb-0">
            <li class="list-inline-item" title='Копировать'>
              <a class="text-body" href="#"
                 data-fn="clipboard" data-clipboard-target="#cp-109d26c55740dcfc2f2b00bdeb106b70"
                 role="button" aria-label='Копировать'>
                <i class="fas fa-copy fa-fw"></i>
              </a>
            </li>
          </ul>
        </div>
      </div>
    </div>
    <div class="card-body p-0 overflow-auto" id="cp-109d26c55740dcfc2f2b00bdeb106b70"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-plaintext" data-lang="plaintext"><span class="line"><span class="cl">bash bash.openssl.ca.sh cert</span></span></code></pre></td></tr></table>
</div>
</div></div>
  </div>
</div>
<p>Немного расскажу про алгоритм генерации сертификатов.</p>
<ol>
<li>У сертификата есть поле <code>Serial Number</code>, которое содержит серийный номер сертификата. Серийный номер сертификата это уникальный номер, выданный центром сертификации. В моём скрипте при генерации клиентского сертификата указаны опции <code>-CAcreateserial</code> и <code>-CAserial &quot;${srl}&quot;</code>, которые позволяют OpenSSL создавать рядом с клиентскими сертификатами файлы формата <code>.slr</code>, содержащие в себе серийные номера сгенерированных сертификатов. Таким образом можно создавать небольшую локальную базу данных выданных сертификатов.</li>
<li>Файл каждого клиентского сертификата генерируется с названием вида <code>[TS].[SFX].[EXE]</code>, где <code>[TS]</code> - это временная метка в микросекундах, <code>[SFX]</code> - числовой суффикс, а <code>[EXE]</code> - расширение файлов.</li>
</ol>
<p>На этом всё. Не исключаю факта присутствия ошибок или неточностей. Если что, жду предложения в электронную почту. <span class="shortcode shortcode-emoji">😄</span></p>
<h2 id="быстрое-создание-само-подписанного-сертификата">
  <a class="link-body-emphasis" href="#%d0%b1%d1%8b%d1%81%d1%82%d1%80%d0%be%d0%b5-%d1%81%d0%be%d0%b7%d0%b4%d0%b0%d0%bd%d0%b8%d0%b5-%d1%81%d0%b0%d0%bc%d0%be-%d0%bf%d0%be%d0%b4%d0%bf%d0%b8%d1%81%d0%b0%d0%bd%d0%bd%d0%be%d0%b3%d0%be-%d1%81%d0%b5%d1%80%d1%82%d0%b8%d1%84%d0%b8%d0%ba%d0%b0%d1%82%d0%b0">Быстрое создание само-подписанного сертификата</a>
</h2><p>Для быстрого создания само-подписанного сертификата, я написал небольшой скрипт. Настройки скрипта необходимо адаптировать под себя.</p>
<h3 id="скрипт">
  <a class="link-body-emphasis" href="#%d1%81%d0%ba%d1%80%d0%b8%d0%bf%d1%82">Скрипт</a>
</h3><p>Генератор корректных SSL-сертификатов. Перед генерацией сертификата, необходимо откорректировать переменные в скрипте под проект.</p>

    

    
        
            
            <div class="shortcode shortcode-file mb-3">
              <div class="card overflow-hidden" data-bs-theme="dark">
                <div class="card-header">
                  <div class="d-flex align-items-center">
                    <div class="flex-shrink-0">
                      <i class="far fa-file-code fa-fw"></i>
                    </div>
                    <div class="flex-grow-1 mx-2 text-truncate">
                      <code>bash.openssl.ssc.sh</code>
                    </div>
                    <div class="flex-shrink-0">
                      <ul class="list-inline mb-0">
                        <li class="list-inline-item" title='Копировать'>
                          <a class="text-body" href="#"
                             data-fn="clipboard" data-clipboard-target="#cp-3a3b7ad4c0f6105ce4a9feecaf1dad77"
                             role="button" aria-label='Копировать'>
                            <i class="fas fa-copy fa-fw"></i>
                          </a>
                        </li>
                        <li class="list-inline-item" title='Скачать'>
                          <a class="text-body" href="/ru/2023/10/6733cb51-62a0-5ed9-b421-8f08c4e0cb18/bash.openssl.ssc.sh" download
                             role="button" aria-label='Скачать'>
                            <i class="fas fa-download fa-fw"></i>
                          </a>
                        </li>
                        <li class="list-inline-item" title='Открыть'>
                          <a class="text-body" href="/ru/2023/10/6733cb51-62a0-5ed9-b421-8f08c4e0cb18/bash.openssl.ssc.sh" target="_blank"
                             role="button" aria-label='Открыть'>
                            <i class="fas fa-arrow-up-right-from-square fa-fw"></i>
                          </a>
                        </li>
                      </ul>
                    </div>
                  </div>
                </div>
                <div class="card-body p-0 overflow-auto" id="cp-3a3b7ad4c0f6105ce4a9feecaf1dad77">
                    
                        
                    
                    <div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span><span class="lnt">56
</span><span class="lnt">57
</span><span class="lnt">58
</span><span class="lnt">59
</span><span class="lnt">60
</span><span class="lnt">61
</span><span class="lnt">62
</span><span class="lnt">63
</span><span class="lnt">64
</span><span class="lnt">65
</span><span class="lnt">66
</span><span class="lnt">67
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sh" data-lang="sh"><span class="line"><span class="cl"><span class="cp">#!/usr/bin/env -S bash -e
</span></span></span><span class="line"><span class="cl"><span class="cp"></span><span class="c1"># -------------------------------------------------------------------------------------------------------------------- #</span>
</span></span><span class="line"><span class="cl"><span class="c1"># OPENSSL SELF SIGNED CERTIFICATE GENERATOR</span>
</span></span><span class="line"><span class="cl"><span class="c1">#</span>
</span></span><span class="line"><span class="cl"><span class="c1"># @package    Bash</span>
</span></span><span class="line"><span class="cl"><span class="c1"># @author     Kai Kimera &lt;mail@kai.kim&gt;</span>
</span></span><span class="line"><span class="cl"><span class="c1"># @copyright  2024 Library Online</span>
</span></span><span class="line"><span class="cl"><span class="c1"># @license    MIT</span>
</span></span><span class="line"><span class="cl"><span class="c1"># @version    0.1.0</span>
</span></span><span class="line"><span class="cl"><span class="c1"># @link       https://lib.onl/ru/2023/10/6733cb51-62a0-5ed9-b421-8f08c4e0cb18/</span>
</span></span><span class="line"><span class="cl"><span class="c1"># -------------------------------------------------------------------------------------------------------------------- #</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="o">((</span> <span class="nv">EUID</span> <span class="o">==</span> <span class="m">0</span> <span class="o">))</span> <span class="o">&amp;&amp;</span> <span class="o">{</span> <span class="nb">echo</span> &gt;<span class="p">&amp;</span><span class="m">2</span> <span class="s1">&#39;This script should not be run as root!&#39;</span><span class="p">;</span> <span class="nb">exit</span> 1<span class="p">;</span> <span class="o">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># -------------------------------------------------------------------------------------------------------------------- #</span>
</span></span><span class="line"><span class="cl"><span class="c1"># CONFIGURATION</span>
</span></span><span class="line"><span class="cl"><span class="c1"># -------------------------------------------------------------------------------------------------------------------- #</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Specifies the number of days to make a certificate valid for.</span>
</span></span><span class="line"><span class="cl"><span class="c1"># Default is 10 years.</span>
</span></span><span class="line"><span class="cl"><span class="nv">days</span><span class="o">=</span><span class="s1">&#39;3650&#39;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># The two-letter country code where your company is legally located.</span>
</span></span><span class="line"><span class="cl"><span class="nv">country</span><span class="o">=</span><span class="s1">&#39;RU&#39;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># The state/province where your company is legally located.</span>
</span></span><span class="line"><span class="cl"><span class="nv">state</span><span class="o">=</span><span class="s1">&#39;Russia&#39;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># The city where your company is legally located.</span>
</span></span><span class="line"><span class="cl"><span class="nv">city</span><span class="o">=</span><span class="s1">&#39;Moscow&#39;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Your company&#39;s legally registered name (e.g., YourCompany, Inc.).</span>
</span></span><span class="line"><span class="cl"><span class="nv">org</span><span class="o">=</span><span class="s1">&#39;LocalHost&#39;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Your company&#39;s organizational unit.</span>
</span></span><span class="line"><span class="cl"><span class="nv">ou</span><span class="o">=</span><span class="s1">&#39;IT Department&#39;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Common name (CN). The fully-qualified domain name (FQDN) (e.g., www.example.com).</span>
</span></span><span class="line"><span class="cl"><span class="nv">cn</span><span class="o">=</span><span class="s2">&#34;</span><span class="si">${</span><span class="nv">1</span><span class="p">:?</span><span class="si">}</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Your email address.</span>
</span></span><span class="line"><span class="cl"><span class="nv">email</span><span class="o">=</span><span class="s1">&#39;mail@localhost&#39;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># -------------------------------------------------------------------------------------------------------------------- #</span>
</span></span><span class="line"><span class="cl"><span class="c1"># -----------------------------------------------------&lt; SCRIPT &gt;----------------------------------------------------- #</span>
</span></span><span class="line"><span class="cl"><span class="c1"># -------------------------------------------------------------------------------------------------------------------- #</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">! <span class="o">[[</span> -x <span class="s2">&#34;</span><span class="k">$(</span> <span class="nb">command</span> -v <span class="s1">&#39;openssl&#39;</span> <span class="k">)</span><span class="s2">&#34;</span> <span class="o">]]</span> <span class="o">&amp;&amp;</span> <span class="o">{</span> <span class="nb">echo</span> &gt;<span class="p">&amp;</span><span class="m">2</span> <span class="s2">&#34;&#39;openssl&#39; is not installed!&#34;</span><span class="p">;</span> <span class="nb">exit</span> 1<span class="p">;</span> <span class="o">}</span>
</span></span><span class="line"><span class="cl"><span class="nb">echo</span> <span class="s1">&#39;&#39;</span> <span class="o">&amp;&amp;</span> <span class="nb">echo</span> <span class="s2">&#34;--- [SSL] SELF SIGNED CERTIFICATE: &#39;</span><span class="si">${</span><span class="nv">cn</span><span class="si">}</span><span class="s2">&#39;&#34;</span> <span class="o">&amp;&amp;</span> <span class="nb">echo</span> <span class="s1">&#39;&#39;</span>
</span></span><span class="line"><span class="cl">openssl ecparam -genkey -name <span class="s1">&#39;prime256v1&#39;</span> <span class="p">|</span> openssl ec -out <span class="s2">&#34;</span><span class="si">${</span><span class="nv">cn</span><span class="si">}</span><span class="s2">.key&#34;</span> <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>  <span class="o">&amp;&amp;</span> openssl req -new -sha256 <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>  -key <span class="s2">&#34;</span><span class="si">${</span><span class="nv">cn</span><span class="si">}</span><span class="s2">.key&#34;</span> <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>  -out <span class="s2">&#34;</span><span class="si">${</span><span class="nv">cn</span><span class="si">}</span><span class="s2">.csr&#34;</span> <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>  -subj <span class="s2">&#34;/C=</span><span class="si">${</span><span class="nv">country</span><span class="si">}</span><span class="s2">/ST=</span><span class="si">${</span><span class="nv">state</span><span class="si">}</span><span class="s2">/L=</span><span class="si">${</span><span class="nv">city</span><span class="si">}</span><span class="s2">/O=</span><span class="si">${</span><span class="nv">org</span><span class="si">}</span><span class="s2">/OU=</span><span class="si">${</span><span class="nv">ou</span><span class="si">}</span><span class="s2">/CN=</span><span class="si">${</span><span class="nv">cn</span><span class="si">}</span><span class="s2">/emailAddress=</span><span class="si">${</span><span class="nv">email</span><span class="si">}</span><span class="s2">&#34;</span> <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>  -addext <span class="s2">&#34;basicConstraints = critical, CA:</span><span class="si">${</span><span class="nv">3</span><span class="k">:-</span><span class="nv">FALSE</span><span class="si">}</span><span class="s2">&#34;</span> <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>  -addext <span class="s1">&#39;nsCertType = server&#39;</span> <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>  -addext <span class="s1">&#39;nsComment = OpenSSL Generated Server Certificate&#39;</span> <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>  -addext <span class="s1">&#39;keyUsage = critical, digitalSignature, keyEncipherment&#39;</span> <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>  -addext <span class="s1">&#39;extendedKeyUsage = serverAuth, clientAuth&#39;</span> <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>  -addext <span class="s2">&#34;subjectAltName = </span><span class="si">${</span><span class="nv">2</span><span class="p">:?</span><span class="si">}</span><span class="s2">&#34;</span> <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>  <span class="o">&amp;&amp;</span> openssl x509 -req -sha256 -days <span class="si">${</span><span class="nv">days</span><span class="si">}</span> -copy_extensions <span class="s1">&#39;copyall&#39;</span> <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>  -key <span class="s2">&#34;</span><span class="si">${</span><span class="nv">cn</span><span class="si">}</span><span class="s2">.key&#34;</span> <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>  -in <span class="s2">&#34;</span><span class="si">${</span><span class="nv">cn</span><span class="si">}</span><span class="s2">.csr&#34;</span> <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>  -out <span class="s2">&#34;</span><span class="si">${</span><span class="nv">cn</span><span class="si">}</span><span class="s2">.crt&#34;</span> <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>  <span class="o">&amp;&amp;</span> openssl x509 -in <span class="s2">&#34;</span><span class="si">${</span><span class="nv">cn</span><span class="si">}</span><span class="s2">.crt&#34;</span> -text -noout
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nb">exit</span> <span class="m">0</span></span></span></code></pre></td></tr></table>
</div>
</div>
                </div>
              </div>
            </div>
        
    
<h4 id="использование-1">
  <a class="link-body-emphasis" href="#%d0%b8%d1%81%d0%bf%d0%be%d0%bb%d1%8c%d0%b7%d0%be%d0%b2%d0%b0%d0%bd%d0%b8%d0%b5-1">Использование</a>
</h4><p>Скрипт можно удалённо запросить из репозитория или запустить локально на хосте. Скрипт принимает следующие параметры согласно очерёдности:</p>
<ol>
<li><code>CN</code> - CN (Common Name).</li>
<li><code>subjectAltName</code> - subjectAltName (Alternative Name).</li>
<li><code>[TRUE|FALSE]</code> - является ли сертификат сертификатом центра сертификации и можно ли при помощи него заверять другие сертификаты. Параметр принимает значение <code>TRUE</code> или <code>FALSE</code>. По умолчанию <code>FALSE</code>.</li>
</ol>
<h4 id="удалённый-запрос-скрипта">
  <a class="link-body-emphasis" href="#%d1%83%d0%b4%d0%b0%d0%bb%d1%91%d0%bd%d0%bd%d1%8b%d0%b9-%d0%b7%d0%b0%d0%bf%d1%80%d0%be%d1%81-%d1%81%d0%ba%d1%80%d0%b8%d0%bf%d1%82%d0%b0">Удалённый запрос скрипта</a>
</h4><p>В терминале выполнить команду, подставив свои значения:</p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-12
shortcode-codeblock-bash">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-065caabaff5d3eeb26132b4ca1bdfd43" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">curl -sL <span class="s1">&#39;https://lib.onl/ru/2023/10/6733cb51-62a0-5ed9-b421-8f08c4e0cb18/bash.openssl.ssc.sh&#39;</span> <span class="p">|</span> bash -s -- <span class="s1">&#39;&lt;CN&gt;&#39;</span> <span class="s1">&#39;&lt;subjectAltName&gt;&#39;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-065caabaff5d3eeb26132b4ca1bdfd43"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>











  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-13
shortcode-codeblock-bash">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-c1f5c5ba851f2c05dbfe286c2460c97d" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">wget -qO - <span class="s1">&#39;https://lib.onl/ru/2023/10/6733cb51-62a0-5ed9-b421-8f08c4e0cb18/bash.openssl.ssc.sh&#39;</span> <span class="p">|</span> bash -s -- <span class="s1">&#39;&lt;CN&gt;&#39;</span> <span class="s1">&#39;&lt;subjectAltName&gt;&#39;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-c1f5c5ba851f2c05dbfe286c2460c97d"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<p>Например:</p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-14
shortcode-codeblock-bash">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-3f0a8311c5a9550b3dcbe3dfa096700d" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">curl -sL <span class="s1">&#39;https://lib.onl/ru/2023/10/6733cb51-62a0-5ed9-b421-8f08c4e0cb18/bash.openssl.ssc.sh&#39;</span> <span class="p">|</span> bash -s -- <span class="s1">&#39;example.com&#39;</span> <span class="s1">&#39;DNS:localhost, DNS:*.localhost, DNS:example.com, DNS:*.example.com, IP:127.0.0.1, IP:192.168.1.2&#39;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-3f0a8311c5a9550b3dcbe3dfa096700d"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>











  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-15
shortcode-codeblock-bash">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-02854304afaeadd6e9bc92588fd8df76" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">wget -qO - <span class="s1">&#39;https://lib.onl/ru/2023/10/6733cb51-62a0-5ed9-b421-8f08c4e0cb18/bash.openssl.ssc.sh&#39;</span> <span class="p">|</span> bash -s -- <span class="s1">&#39;example.com&#39;</span> <span class="s1">&#39;DNS:localhost, DNS:*.localhost, DNS:example.com, DNS:*.example.com, IP:127.0.0.1, IP:192.168.1.2&#39;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-02854304afaeadd6e9bc92588fd8df76"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<p>Таким образом, сертификат будет сгенерирован с заданными параметрами и заверен собственной подписью.</p>
<h4 id="создание-pfx">
  <a class="link-body-emphasis" href="#%d1%81%d0%be%d0%b7%d0%b4%d0%b0%d0%bd%d0%b8%d0%b5-pfx">Создание PFX</a>
</h4><p>Чтобы создать PFX-файл, необходимо выполнить следующую команду:</p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-16
shortcode-codeblock-bash">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-30379fea44965b8715f4293d11ec6c9f" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="nv">f</span><span class="o">=</span><span class="s1">&#39;example.com&#39;</span><span class="p">;</span> openssl pkcs12 -export -certpbe PBE-SHA1-3DES -keypbe PBE-SHA1-3DES -nomac -inkey <span class="s2">&#34;</span><span class="si">${</span><span class="nv">f</span><span class="si">}</span><span class="s2">.key&#34;</span> -in <span class="s2">&#34;</span><span class="si">${</span><span class="nv">f</span><span class="si">}</span><span class="s2">.crt&#34;</span> -out <span class="s2">&#34;</span><span class="si">${</span><span class="nv">f</span><span class="si">}</span><span class="s2">.pfx&#34;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-30379fea44965b8715f4293d11ec6c9f"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<p>Где:</p>
<ul>
<li><code>f</code> - переменная, содержащая общее название файлов.</li>
</ul>]]></turbo:content></item><item turbo="true"><title>Дополнительная страница для vBulletin 4</title><link>https://lib.onl/ru/2023/10/382d49d6-8f44-5367-bf24-88890d7c4723/</link><pubDate>Tue, 17 Oct 2023 18:01:38 +0000</pubDate><dc:creator>Kai Kimera</dc:creator><category>CMF</category><category>В истории</category><yandex:related><link url="https://lib.onl/ru/2023/10/01d19479-028f-5b81-9c58-9c99adb08461/">Дополнительная страница для vBulletin 3</link><link url="https://lib.onl/ru/2023/10/c079a268-5fb5-5d0d-8c00-0202630ce13d/">Условия в шаблонах для vBulletin 4</link><link url="https://lib.onl/ru/2023/10/f82b1436-6752-5084-ba98-264b264edca7/">Условия в шаблонах для vBulletin 3</link><link url="https://lib.onl/ru/2023/10/f0463a78-0393-5891-bbe5-c39ec575ae75/">Дополнительная страница для IP.Board 2.3</link><link url="https://lib.onl/ru/2023/10/560dfed8-9a25-5db3-95a6-a7df8129e960/">Невидимые ссылки для гостей на IP.Board 2.3</link><link url="https://lib.onl/ru/2023/10/347826e1-53d9-5c99-a6f8-66fc359323a2/">Динамическое "(Powered by Invision Power Board)" на IP.Board 2.3</link><link url="https://lib.onl/ru/2023/10/d477b5ce-8095-5607-91c7-5c5ad7b7f146/">Читабельные ссылки на темы форума для IP.Board 2.3</link><link url="https://lib.onl/ru/2023/10/a0756cae-ae3c-59ff-b587-ee8c7f3247c8/">FAQ для IP.Board 2.3</link><link url="https://lib.onl/ru/2023/10/54d4e488-9a8f-55ed-8fea-c77d4dba0720/">SQL запросы IP.Board 2.3</link><link url="https://lib.onl/ru/2023/10/06c9d359-31f0-5862-a342-62a21d4eb032/">SQL запросы IP.Board 3.x</link><link url="https://lib.onl/ru/2023/10/0743e73e-7c4c-5ab8-bba3-ba70bdb5cdfd/">Условия в файлах IP.Board 2.3</link><link url="https://lib.onl/ru/2023/10/d310a44c-4259-5bef-a7c2-d3d09a5c69f4/">Условия в шаблонах IP.Board 2.3</link><link url="https://lib.onl/ru/2023/10/a7405294-9f0c-52c1-a70e-ce4990079dc7/">Условия в шаблонах IP.Board 3.x</link></yandex:related><turbo:extendedHtml>true</turbo:extendedHtml><turbo:source>https://lib.onl/ru/2023/10/382d49d6-8f44-5367-bf24-88890d7c4723/</turbo:source><turbo:topic>Дополнительная страница для vBulletin 4</turbo:topic><turbo:content><![CDATA[<p>Создание дополнительных страниц для уже устаревшего форумного движка <span class="shortcode shortcode-tag"><a href="/ru/tags/vbulletin/" target="_blank">#vBulletin</a></span> 4.</p>
<p>Для <span class="shortcode shortcode-tag"><a href="/ru/tags/vbulletin/" target="_blank">#vBulletin</a></span> версии <strong>4.0</strong> действия практически одни и те же, как в материале <span class="shortcode shortcode-uuid"><a href="/ru/2023/10/01d19479-028f-5b81-9c58-9c99adb08461/">Дополнительная страница для vBulletin 3</a></span>.</p>
<h2 id="что-такое-дополнительная-страница-или-custom-pages">
  <a class="link-body-emphasis" href="#%d1%87%d1%82%d0%be-%d1%82%d0%b0%d0%ba%d0%be%d0%b5-%d0%b4%d0%be%d0%bf%d0%be%d0%bb%d0%bd%d0%b8%d1%82%d0%b5%d0%bb%d1%8c%d0%bd%d0%b0%d1%8f-%d1%81%d1%82%d1%80%d0%b0%d0%bd%d0%b8%d1%86%d0%b0-%d0%b8%d0%bb%d0%b8-custom-pages">Что такое дополнительная страница (или Custom Pages)?</a>
</h2><p>Дополнительная страница (или Custom Pages) - это страница, &ldquo;совмещённая&rdquo; со стилем форума.</p>
<h2 id="как-сделать-дополнительную-страницу">
  <a class="link-body-emphasis" href="#%d0%ba%d0%b0%d0%ba-%d1%81%d0%b4%d0%b5%d0%bb%d0%b0%d1%82%d1%8c-%d0%b4%d0%be%d0%bf%d0%be%d0%bb%d0%bd%d0%b8%d1%82%d0%b5%d0%bb%d1%8c%d0%bd%d1%83%d1%8e-%d1%81%d1%82%d1%80%d0%b0%d0%bd%d0%b8%d1%86%d1%83">Как сделать дополнительную страницу?</a>
</h2><p>Необходимо создать шаблон <code>custom_ШАБЛОН</code>, содержимое которого представляет собой следующий код:</p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-0
shortcode-codeblock-html">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-e759c7fec805f2a35020046ff257efba" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-html" data-lang="html"><span class="line"><span class="cl">{vb:stylevar htmldoctype}
</span></span><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">html</span> <span class="na">xmlns</span><span class="o">=</span><span class="s">&#34;http://www.w3.org/1999/xhtml&#34;</span> <span class="na">dir</span><span class="o">=</span><span class="s">&#34;{vb:stylevar textdirection}&#34;</span> <span class="na">lang</span><span class="o">=</span><span class="s">&#34;{vb:stylevar languagecode}&#34;</span> <span class="na">id</span><span class="o">=</span><span class="s">&#34;vbulletin_html&#34;</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">head</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="p">&lt;</span><span class="nt">title</span><span class="p">&gt;</span>{vb:raw vboptions.bbtitle}<span class="p">&lt;/</span><span class="nt">title</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">  {vb:raw headinclude}
</span></span><span class="line"><span class="cl"><span class="p">&lt;/</span><span class="nt">head</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">body</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">  {vb:raw header}
</span></span><span class="line"><span class="cl">  {vb:raw navbar}
</span></span><span class="line"><span class="cl">  <span class="p">&lt;</span><span class="nt">div</span> <span class="na">id</span><span class="o">=</span><span class="s">&#34;pagetitle&#34;</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="p">&lt;</span><span class="nt">h1</span><span class="p">&gt;</span>{vb:raw pagetitle}<span class="p">&lt;/</span><span class="nt">h1</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="p">&lt;</span><span class="nt">h2</span> <span class="na">class</span><span class="o">=</span><span class="s">&#34;blockhead&#34;</span><span class="p">&gt;</span><span class="c">&lt;!-- Заголовок страницы --&gt;</span><span class="p">&lt;/</span><span class="nt">h2</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="p">&lt;</span><span class="nt">div</span> <span class="na">class</span><span class="o">=</span><span class="s">&#34;blockbody&#34;</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="p">&lt;</span><span class="nt">div</span> <span class="na">class</span><span class="o">=</span><span class="s">&#34;blockrow&#34;</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">      <span class="c">&lt;!-- Текст страницы --&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">  {vb:raw footer}
</span></span><span class="line"><span class="cl"><span class="p">&lt;/</span><span class="nt">body</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl"><span class="p">&lt;/</span><span class="nt">html</span><span class="p">&gt;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-e759c7fec805f2a35020046ff257efba"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<p>Страница будет располагаться по адресу:</p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-1
shortcode-codeblock-plaintext">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-56aa8f56394f26f48ba13d1a060a8d04" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-plaintext" data-lang="plaintext"><span class="line"><span class="cl">https://example.com/misc.php?do=page&amp;template=ШАБЛОН</span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-56aa8f56394f26f48ba13d1a060a8d04"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>]]></turbo:content></item><item turbo="true"><title>Дополнительная страница для vBulletin 3</title><link>https://lib.onl/ru/2023/10/01d19479-028f-5b81-9c58-9c99adb08461/</link><pubDate>Tue, 17 Oct 2023 17:39:09 +0000</pubDate><dc:creator>Kai Kimera</dc:creator><category>CMF</category><category>В истории</category><yandex:related><link url="https://lib.onl/ru/2023/10/c079a268-5fb5-5d0d-8c00-0202630ce13d/">Условия в шаблонах для vBulletin 4</link><link url="https://lib.onl/ru/2023/10/f82b1436-6752-5084-ba98-264b264edca7/">Условия в шаблонах для vBulletin 3</link><link url="https://lib.onl/ru/2023/10/f0463a78-0393-5891-bbe5-c39ec575ae75/">Дополнительная страница для IP.Board 2.3</link><link url="https://lib.onl/ru/2023/10/560dfed8-9a25-5db3-95a6-a7df8129e960/">Невидимые ссылки для гостей на IP.Board 2.3</link><link url="https://lib.onl/ru/2023/10/347826e1-53d9-5c99-a6f8-66fc359323a2/">Динамическое "(Powered by Invision Power Board)" на IP.Board 2.3</link><link url="https://lib.onl/ru/2023/10/d477b5ce-8095-5607-91c7-5c5ad7b7f146/">Читабельные ссылки на темы форума для IP.Board 2.3</link><link url="https://lib.onl/ru/2023/10/a0756cae-ae3c-59ff-b587-ee8c7f3247c8/">FAQ для IP.Board 2.3</link><link url="https://lib.onl/ru/2023/10/54d4e488-9a8f-55ed-8fea-c77d4dba0720/">SQL запросы IP.Board 2.3</link><link url="https://lib.onl/ru/2023/10/06c9d359-31f0-5862-a342-62a21d4eb032/">SQL запросы IP.Board 3.x</link><link url="https://lib.onl/ru/2023/10/0743e73e-7c4c-5ab8-bba3-ba70bdb5cdfd/">Условия в файлах IP.Board 2.3</link><link url="https://lib.onl/ru/2023/10/d310a44c-4259-5bef-a7c2-d3d09a5c69f4/">Условия в шаблонах IP.Board 2.3</link><link url="https://lib.onl/ru/2023/10/a7405294-9f0c-52c1-a70e-ce4990079dc7/">Условия в шаблонах IP.Board 3.x</link></yandex:related><turbo:extendedHtml>true</turbo:extendedHtml><turbo:source>https://lib.onl/ru/2023/10/01d19479-028f-5b81-9c58-9c99adb08461/</turbo:source><turbo:topic>Дополнительная страница для vBulletin 3</turbo:topic><turbo:content><![CDATA[<p>Материал по созданию дополнительных страниц в <span class="shortcode shortcode-tag"><a href="/ru/tags/vbulletin/" target="_blank">#vBulletin</a></span> 3. Возможно, кто-то ещё пользуется этой версией движка&hellip;</p>
<h2 id="что-такое-дополнительная-страница-или-custom-pages">
  <a class="link-body-emphasis" href="#%d1%87%d1%82%d0%be-%d1%82%d0%b0%d0%ba%d0%be%d0%b5-%d0%b4%d0%be%d0%bf%d0%be%d0%bb%d0%bd%d0%b8%d1%82%d0%b5%d0%bb%d1%8c%d0%bd%d0%b0%d1%8f-%d1%81%d1%82%d1%80%d0%b0%d0%bd%d0%b8%d1%86%d0%b0-%d0%b8%d0%bb%d0%b8-custom-pages">Что такое дополнительная страница (или Custom Pages)?</a>
</h2><p>Дополнительная страница (или Custom Pages) - это страница, &ldquo;совмещённая&rdquo; со стилем форума и находится по адресу:</p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-0
shortcode-codeblock-plaintext">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-87cb0fc559df5d7587c2fed82e894337" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-plaintext" data-lang="plaintext"><span class="line"><span class="cl">http://example.com/misc.php?do=page&amp;template=название_страницы</span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-87cb0fc559df5d7587c2fed82e894337"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<h2 id="как-сделать-дополнительную-страницу">
  <a class="link-body-emphasis" href="#%d0%ba%d0%b0%d0%ba-%d1%81%d0%b4%d0%b5%d0%bb%d0%b0%d1%82%d1%8c-%d0%b4%d0%be%d0%bf%d0%be%d0%bb%d0%bd%d0%b8%d1%82%d0%b5%d0%bb%d1%8c%d0%bd%d1%83%d1%8e-%d1%81%d1%82%d1%80%d0%b0%d0%bd%d0%b8%d1%86%d1%83">Как сделать дополнительную страницу?</a>
</h2><p>Итак, для начала нужно создать дополнительный шаблон того стиля, который вами используется. Этот дополнительный шаблон должен иметь префикс <code>custom_</code>, то есть само название дополнительного шаблона должно выглядеть вот так: <code>custom_ШАБЛОН</code>.</p>
<p>После этого в тело шаблона вставляем следующий код:</p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-1
shortcode-codeblock-html">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-913bf9011fd0f47790a355b75a75cce5" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-html" data-lang="html"><span class="line"><span class="cl">$stylevar[htmldoctype]
</span></span><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">html</span> <span class="na">dir</span><span class="o">=</span><span class="s">&#34;$stylevar[textdirection]&#34;</span> <span class="na">lang</span><span class="o">=</span><span class="s">&#34;$stylevar[languagecode]&#34;</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="p">&lt;</span><span class="nt">head</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">    $headinclude
</span></span><span class="line"><span class="cl">    <span class="p">&lt;</span><span class="nt">title</span><span class="p">&gt;</span>$vboptions[bbtitle]<span class="p">&lt;/</span><span class="nt">title</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="p">&lt;/</span><span class="nt">head</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="p">&lt;</span><span class="nt">body</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">    $header
</span></span><span class="line"><span class="cl">    $navbar
</span></span><span class="line"><span class="cl">    <span class="c">&lt;!-- На этом месте будет находится ваш код страницы. --&gt;</span>
</span></span><span class="line"><span class="cl">    $footer
</span></span><span class="line"><span class="cl">  <span class="p">&lt;/</span><span class="nt">body</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl"><span class="p">&lt;/</span><span class="nt">html</span><span class="p">&gt;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-913bf9011fd0f47790a355b75a75cce5"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<p>Вот и всё!</p>]]></turbo:content></item><item turbo="true"><title>Дополнительная страница для IP.Board 2.3</title><link>https://lib.onl/ru/2023/10/f0463a78-0393-5891-bbe5-c39ec575ae75/</link><pubDate>Tue, 17 Oct 2023 17:39:08 +0000</pubDate><dc:creator>Kai Kimera</dc:creator><category>CMF</category><category>В истории</category><yandex:related><link url="https://lib.onl/ru/2023/10/560dfed8-9a25-5db3-95a6-a7df8129e960/">Невидимые ссылки для гостей на IP.Board 2.3</link><link url="https://lib.onl/ru/2023/10/347826e1-53d9-5c99-a6f8-66fc359323a2/">Динамическое "(Powered by Invision Power Board)" на IP.Board 2.3</link><link url="https://lib.onl/ru/2023/10/d477b5ce-8095-5607-91c7-5c5ad7b7f146/">Читабельные ссылки на темы форума для IP.Board 2.3</link><link url="https://lib.onl/ru/2023/10/a0756cae-ae3c-59ff-b587-ee8c7f3247c8/">FAQ для IP.Board 2.3</link><link url="https://lib.onl/ru/2023/10/54d4e488-9a8f-55ed-8fea-c77d4dba0720/">SQL запросы IP.Board 2.3</link><link url="https://lib.onl/ru/2023/10/06c9d359-31f0-5862-a342-62a21d4eb032/">SQL запросы IP.Board 3.x</link><link url="https://lib.onl/ru/2023/10/0743e73e-7c4c-5ab8-bba3-ba70bdb5cdfd/">Условия в файлах IP.Board 2.3</link><link url="https://lib.onl/ru/2023/10/d310a44c-4259-5bef-a7c2-d3d09a5c69f4/">Условия в шаблонах IP.Board 2.3</link><link url="https://lib.onl/ru/2023/10/a7405294-9f0c-52c1-a70e-ce4990079dc7/">Условия в шаблонах IP.Board 3.x</link><link url="https://lib.onl/ru/2023/10/c079a268-5fb5-5d0d-8c00-0202630ce13d/">Условия в шаблонах для vBulletin 4</link><link url="https://lib.onl/ru/2023/10/f82b1436-6752-5084-ba98-264b264edca7/">Условия в шаблонах для vBulletin 3</link></yandex:related><turbo:extendedHtml>true</turbo:extendedHtml><turbo:source>https://lib.onl/ru/2023/10/f0463a78-0393-5891-bbe5-c39ec575ae75/</turbo:source><turbo:topic>Дополнительная страница для IP.Board 2.3</turbo:topic><turbo:content><![CDATA[<p>Ещё один артефакт прошлого. Инструкция по созданию дополнительных страниц в <span class="shortcode shortcode-tag"><a href="/ru/tags/ipb/" target="_blank">#IPB</a></span> 2.3. Старая, но вдруг кому-то пригодится.</p>
<h2 id="что-такое-дополнительная-страница-или-custom-pages">
  <a class="link-body-emphasis" href="#%d1%87%d1%82%d0%be-%d1%82%d0%b0%d0%ba%d0%be%d0%b5-%d0%b4%d0%be%d0%bf%d0%be%d0%bb%d0%bd%d0%b8%d1%82%d0%b5%d0%bb%d1%8c%d0%bd%d0%b0%d1%8f-%d1%81%d1%82%d1%80%d0%b0%d0%bd%d0%b8%d1%86%d0%b0-%d0%b8%d0%bb%d0%b8-custom-pages">Что такое дополнительная страница (или Custom Pages)?</a>
</h2><p>Дополнительная страница (или Custom Pages) - это страница, &ldquo;совмещённая&rdquo; со стилем форума и находится по адресу:</p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-0
shortcode-codeblock-plaintext">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-aa09e10503937c4a62e08f444701180c" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-plaintext" data-lang="plaintext"><span class="line"><span class="cl">http://example.com/index.php?autocom=название_страницы</span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-aa09e10503937c4a62e08f444701180c"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<p>Объект <code>название_страницы</code> представляет собой название файла <code>.php</code> дополнительной страницы.</p>
<h2 id="как-сделать-дополнительную-страницу">
  <a class="link-body-emphasis" href="#%d0%ba%d0%b0%d0%ba-%d1%81%d0%b4%d0%b5%d0%bb%d0%b0%d1%82%d1%8c-%d0%b4%d0%be%d0%bf%d0%be%d0%bb%d0%bd%d0%b8%d1%82%d0%b5%d0%bb%d1%8c%d0%bd%d1%83%d1%8e-%d1%81%d1%82%d1%80%d0%b0%d0%bd%d0%b8%d1%86%d1%83">Как сделать дополнительную страницу?</a>
</h2><p>Создаём файл <code>.php</code> следующего содержания:</p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-1
shortcode-codeblock-php">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-dd1b3488181a270d9affb28180a79184" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="o">&lt;?</span><span class="nx">php</span>
</span></span><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">component_public</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="k">var</span> <span class="nv">$ipsclass</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="k">function</span> <span class="nf">run_component</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">  <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">pagetitle</span> <span class="o">=</span> <span class="s2">&#34;Название страницы&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="cm">/* Здесь идёт название вашей страницы.
</span></span></span><span class="line"><span class="cl"><span class="cm">    Название также будет показано в панели навигации вашего форума. */</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">nav</span><span class="p">[]</span> <span class="o">=</span> <span class="s2">&#34;&lt;a href=&#39;</span><span class="si">{</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">ipsclass</span><span class="o">-&gt;</span><span class="na">base_url</span><span class="si">}</span><span class="s2">autocom=custom&#39;&gt;</span><span class="si">{</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">pagetitle</span><span class="si">}</span><span class="s2">&lt;/a&gt;&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">ipsclass</span><span class="o">-&gt;</span><span class="na">load_template</span><span class="p">(</span><span class="s1">&#39;skin_global&#39;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="nv">$output</span> <span class="o">.=</span> <span class="s2">&#34;Здесь содержимое страницы&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="cm">/* Здесь будет содержимое вашей будущей страницы.
</span></span></span><span class="line"><span class="cl"><span class="cm">    Содержимое помещается между кавычками.
</span></span></span><span class="line"><span class="cl"><span class="cm">    Также, как обычно, вам доступен HTML-код. */</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">ipsclass</span><span class="o">-&gt;</span><span class="na">print</span><span class="o">-&gt;</span><span class="na">add_output</span><span class="p">(</span><span class="nv">$output</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">ipsclass</span><span class="o">-&gt;</span><span class="na">print</span><span class="o">-&gt;</span><span class="na">do_output</span><span class="p">(</span><span class="k">array</span><span class="p">(</span><span class="s1">&#39;TITLE&#39;</span> <span class="o">=&gt;</span> <span class="s2">&#34;</span><span class="si">{</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">ipsclass</span><span class="o">-&gt;</span><span class="na">vars</span><span class="p">[</span><span class="s1">&#39;board_name&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2"> - </span><span class="si">{</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">pagetitle</span><span class="si">}</span><span class="s2">&#34;</span><span class="p">,</span> <span class="s1">&#39;JS&#39;</span> <span class="o">=&gt;</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;NAV&#39;</span> <span class="o">=&gt;</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">nav</span><span class="p">));</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-dd1b3488181a270d9affb28180a79184"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<p>В самом коде установлены комментарии, так что вы без труда разберётесь что к чему.</p>
<p>После создания этого PHP-файла, вы должны поместить его в папку <code>./sources/components_public</code>.</p>
<p>Всё!</p>]]></turbo:content></item><item turbo="true"><title>Условия в шаблонах для vBulletin 4</title><link>https://lib.onl/ru/2023/10/c079a268-5fb5-5d0d-8c00-0202630ce13d/</link><pubDate>Tue, 17 Oct 2023 17:20:56 +0000</pubDate><dc:creator>Kai Kimera</dc:creator><category>CMF</category><category>В истории</category><yandex:related><link url="https://lib.onl/ru/2023/10/f82b1436-6752-5084-ba98-264b264edca7/">Условия в шаблонах для vBulletin 3</link><link url="https://lib.onl/ru/2023/10/560dfed8-9a25-5db3-95a6-a7df8129e960/">Невидимые ссылки для гостей на IP.Board 2.3</link><link url="https://lib.onl/ru/2023/10/347826e1-53d9-5c99-a6f8-66fc359323a2/">Динамическое "(Powered by Invision Power Board)" на IP.Board 2.3</link><link url="https://lib.onl/ru/2023/10/d477b5ce-8095-5607-91c7-5c5ad7b7f146/">Читабельные ссылки на темы форума для IP.Board 2.3</link><link url="https://lib.onl/ru/2023/10/a0756cae-ae3c-59ff-b587-ee8c7f3247c8/">FAQ для IP.Board 2.3</link><link url="https://lib.onl/ru/2023/10/54d4e488-9a8f-55ed-8fea-c77d4dba0720/">SQL запросы IP.Board 2.3</link><link url="https://lib.onl/ru/2023/10/06c9d359-31f0-5862-a342-62a21d4eb032/">SQL запросы IP.Board 3.x</link><link url="https://lib.onl/ru/2023/10/0743e73e-7c4c-5ab8-bba3-ba70bdb5cdfd/">Условия в файлах IP.Board 2.3</link><link url="https://lib.onl/ru/2023/10/d310a44c-4259-5bef-a7c2-d3d09a5c69f4/">Условия в шаблонах IP.Board 2.3</link><link url="https://lib.onl/ru/2023/10/a7405294-9f0c-52c1-a70e-ce4990079dc7/">Условия в шаблонах IP.Board 3.x</link></yandex:related><turbo:extendedHtml>true</turbo:extendedHtml><turbo:source>https://lib.onl/ru/2023/10/c079a268-5fb5-5d0d-8c00-0202630ce13d/</turbo:source><turbo:topic>Условия в шаблонах для vBulletin 4</turbo:topic><turbo:content><![CDATA[<p>Набор условий для применения в шаблонах форумного движка <span class="shortcode shortcode-tag"><a href="/ru/tags/vbulletin/" target="_blank">#vBulletin</a></span> 4. К сожалению, версия 4 оказалась провальной. Зато, из неё родился всем известный <span class="shortcode shortcode-tag"><a href="/ru/tags/xenforo/" target="_blank">#XenForo</a></span>!</p>
<h2 id="обычные-условия">
  <a class="link-body-emphasis" href="#%d0%be%d0%b1%d1%8b%d1%87%d0%bd%d1%8b%d0%b5-%d1%83%d1%81%d0%bb%d0%be%d0%b2%d0%b8%d1%8f">Обычные условия</a>
</h2><ol>
<li>Показать информацию только для пользователей</li>
</ol>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-0
shortcode-codeblock-html">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-85aeb53ac514e43384658026b119f5f1" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-html" data-lang="html"><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">vb:if</span> <span class="na">condition</span><span class="o">=</span><span class="s">&#34;$show[&#39;member&#39;]&#34;</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="c">&lt;!-- информация только для пользователей --&gt;</span>
</span></span><span class="line"><span class="cl"><span class="p">&lt;/</span><span class="nt">vb:if</span><span class="p">&gt;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-85aeb53ac514e43384658026b119f5f1"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<ol start="2">
<li>Показать информацию только для гостей</li>
</ol>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-1
shortcode-codeblock-html">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-0e10f684d460ecd2f5bdfd4b58933bbe" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-html" data-lang="html"><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">vb:if</span> <span class="na">condition</span><span class="o">=</span><span class="s">&#34;$show[&#39;guest&#39;]&#34;</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="c">&lt;!-- информация только для гостей --&gt;</span>
</span></span><span class="line"><span class="cl"><span class="p">&lt;/</span><span class="nt">vb:if</span><span class="p">&gt;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-0e10f684d460ecd2f5bdfd4b58933bbe"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<ol start="3">
<li>Показать информацию только для определённой группы.</li>
</ol>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-2
shortcode-codeblock-html">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-a62df77b0bc10b4c45025b06173d9a06" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-html" data-lang="html"><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">vb:if</span> <span class="na">condition</span><span class="o">=</span><span class="s">&#34;is_member_of($bbuserinfo, 1,2,3)&#34;</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="c">&lt;!-- информация только для группы с ID = 1, 2 и 3 --&gt;</span>
</span></span><span class="line"><span class="cl"><span class="p">&lt;/</span><span class="nt">vb:if</span><span class="p">&gt;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-a62df77b0bc10b4c45025b06173d9a06"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<ol start="4">
<li>Показать информацию только для определённой группы в сообщении.</li>
</ol>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-3
shortcode-codeblock-html">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-f6ab7f13d44e2477e7365280f0450105" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-html" data-lang="html"><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">vb:if</span> <span class="na">condition</span><span class="o">=</span><span class="s">&#34;is_member_of($post, 1,2,3)&#34;</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="c">&lt;!-- информация только для группы с ID = 1, 2 и 3 --&gt;</span>
</span></span><span class="line"><span class="cl"><span class="p">&lt;/</span><span class="nt">vb:if</span><span class="p">&gt;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-f6ab7f13d44e2477e7365280f0450105"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<ol start="5">
<li>Показать информацию только для определённого пользователя.</li>
</ol>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-4
shortcode-codeblock-html">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-c51ea9ffcd99b04f764ded7cdc497b2a" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-html" data-lang="html"><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">vb:if</span> <span class="na">condition</span><span class="o">=</span><span class="s">&#34;$bbuserinfo[&#39;userid&#39;] == 318713&#34;</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="c">&lt;!-- информация только для пользователя с ID = 318713 --&gt;</span>
</span></span><span class="line"><span class="cl"><span class="p">&lt;/</span><span class="nt">vb:if</span><span class="p">&gt;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-c51ea9ffcd99b04f764ded7cdc497b2a"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<ol start="6">
<li>Показать информацию для всех, кроме определённого пользователя.</li>
</ol>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-5
shortcode-codeblock-html">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-1fa8b3cb47e6d3d971f340bfe5ba9395" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-html" data-lang="html"><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">vb:if</span> <span class="na">condition</span><span class="o">=</span><span class="s">&#34;$bbuserinfo[&#39;userid&#39;] != 318713&#34;</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="c">&lt;!-- информация для всех, кроме пользователя с ID = 318713 --&gt;</span>
</span></span><span class="line"><span class="cl"><span class="p">&lt;/</span><span class="nt">vb:if</span><span class="p">&gt;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-1fa8b3cb47e6d3d971f340bfe5ba9395"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<ol start="7">
<li>Показать информацию для всех модераторов во всех форумах.</li>
</ol>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-6
shortcode-codeblock-html">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-9a7fd1e287fdbd856b2c7ef53d799d48" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-html" data-lang="html"><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">vb:if</span> <span class="na">condition</span><span class="o">=</span><span class="s">&#34;can_moderate()&#34;</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="c">&lt;!-- информация для модераторов во всех форумах --&gt;</span>
</span></span><span class="line"><span class="cl"><span class="p">&lt;/</span><span class="nt">vb:if</span><span class="p">&gt;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-9a7fd1e287fdbd856b2c7ef53d799d48"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<ol start="8">
<li>Показать информацию для модератора в определённом форуме.</li>
</ol>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-7
shortcode-codeblock-html">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-78482a4ad4bc3c55a9bef5d16073dfc1" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-html" data-lang="html"><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">vb:if</span> <span class="na">condition</span><span class="o">=</span><span class="s">&#34;can_moderate($forum[&#39;x])&#34;</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="c">&lt;!-- информация для модератора определённого форума с ID = X --&gt;</span>
</span></span><span class="line"><span class="cl"><span class="p">&lt;/</span><span class="nt">vb:if</span><span class="p">&gt;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-78482a4ad4bc3c55a9bef5d16073dfc1"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<ol start="9">
<li>Показать информацию во всех форумах, кроме одного.</li>
</ol>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-8
shortcode-codeblock-html">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-0a657aa7a09f8c579556411512513a7c" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-html" data-lang="html"><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">vb:if</span> <span class="na">condition</span><span class="o">=</span><span class="s">&#34;$forum[forumid] != x&#34;</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="c">&lt;!-- информация во всех форумах, кроме ID = X --&gt;</span>
</span></span><span class="line"><span class="cl"><span class="p">&lt;/</span><span class="nt">vb:if</span><span class="p">&gt;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-0a657aa7a09f8c579556411512513a7c"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<ol start="10">
<li>Показать информацию в определённых форумах.</li>
</ol>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-9
shortcode-codeblock-html">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-a4a69e874a5c0bdf6b5d12c4bb7b883a" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-html" data-lang="html"><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">vb:if</span> <span class="na">condition</span><span class="o">=</span><span class="s">&#34;in_array($forum[&#39;forumid&#39;], array(1,2,3))&#34;</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="c">&lt;!-- информация для форумов с ID = 1, 2 или 3 --&gt;</span>
</span></span><span class="line"><span class="cl"><span class="p">&lt;/</span><span class="nt">vb:if</span><span class="p">&gt;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-a4a69e874a5c0bdf6b5d12c4bb7b883a"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<ol start="11">
<li>Показать информацию только на определённой странице.</li>
</ol>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-10
shortcode-codeblock-html">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-e50fae51c17adc77cbd7566de07d3504" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-html" data-lang="html"><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">vb:if</span> <span class="na">condition</span><span class="o">=</span><span class="s">&#34;THIS_SCRIPT == &#39;calendar&#39;&#34;</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="c">&lt;!-- Показать информацию в calendar.php --&gt;</span>
</span></span><span class="line"><span class="cl"><span class="p">&lt;/</span><span class="nt">vb:if</span><span class="p">&gt;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-e50fae51c17adc77cbd7566de07d3504"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<ol start="12">
<li>Показать информацию везде, кроме определённой страницы.</li>
</ol>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-11
shortcode-codeblock-html">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-a9354a9c8dd5a183c6f4c6578c947fd4" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-html" data-lang="html"><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">vb:if</span> <span class="na">condition</span><span class="o">=</span><span class="s">&#34;THIS_SCRIPT != &#39;calendar&#39;&#34;</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="c">&lt;!-- информация на всех страницах, кроме calendar.php --&gt;</span>
</span></span><span class="line"><span class="cl"><span class="p">&lt;/</span><span class="nt">vb:if</span><span class="p">&gt;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-a9354a9c8dd5a183c6f4c6578c947fd4"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<ol start="13">
<li>Показать информацию, если переменная активна.</li>
</ol>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-12
shortcode-codeblock-html">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-6cfb5563e9b27a2000bf4db642fefae4" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-html" data-lang="html"><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">vb:if</span> <span class="na">condition</span><span class="o">=</span><span class="s">&#34;$customvar&#34;</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="c">&lt;!-- показать, если переменная $customvar активна --&gt;</span>
</span></span><span class="line"><span class="cl"><span class="p">&lt;/</span><span class="nt">vb:if</span><span class="p">&gt;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-6cfb5563e9b27a2000bf4db642fefae4"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<ol start="14">
<li>Показать информацию, если переменная имеет значение.</li>
</ol>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-13
shortcode-codeblock-html">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-608f46c000cacb6f8e049ab715c77637" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-html" data-lang="html"><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">vb:if</span> <span class="na">condition</span><span class="o">=</span><span class="s">&#34;$customvar == значение&#34;</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="c">&lt;!-- показать, если переменная $customvar имеет значение &#34;значение&#34; --&gt;</span>
</span></span><span class="line"><span class="cl"><span class="p">&lt;/</span><span class="nt">vb:if</span><span class="p">&gt;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-608f46c000cacb6f8e049ab715c77637"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<ol start="15">
<li>Показать информацию, если переменная НЕ имеет значение.</li>
</ol>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-14
shortcode-codeblock-html">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-a3efa371b77894ee2f40490f92ed407e" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-html" data-lang="html"><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">vb:if</span> <span class="na">condition</span><span class="o">=</span><span class="s">&#34;$customvar != значение&#34;</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="c">&lt;!-- показать, если переменная $customvar на имеет значение &#34;значение&#34; --&gt;</span>
</span></span><span class="line"><span class="cl"><span class="p">&lt;/</span><span class="nt">vb:if</span><span class="p">&gt;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-a3efa371b77894ee2f40490f92ed407e"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<ol start="16">
<li>Показать информацию только для пользователя не набравшего определённого количества сообщений.</li>
</ol>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-15
shortcode-codeblock-html">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-28d0e69b1f3af048e50ca2334320cf0a" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-html" data-lang="html"><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">vb:if</span> <span class="na">condition</span><span class="o">=</span><span class="s">&#34;$post[posts] &lt; 10&#34;</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="c">&lt;!-- информация для пользователя, не набравшего 10 сообщений --&gt;</span>
</span></span><span class="line"><span class="cl"><span class="p">&lt;/</span><span class="nt">vb:if</span><span class="p">&gt;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-28d0e69b1f3af048e50ca2334320cf0a"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<h2 id="комбинированные-условия">
  <a class="link-body-emphasis" href="#%d0%ba%d0%be%d0%bc%d0%b1%d0%b8%d0%bd%d0%b8%d1%80%d0%be%d0%b2%d0%b0%d0%bd%d0%bd%d1%8b%d0%b5-%d1%83%d1%81%d0%bb%d0%be%d0%b2%d0%b8%d1%8f">Комбинированные условия</a>
</h2>








  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-16
shortcode-codeblock-html">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-82201bcb1ab5d6a14caafff134c235dc" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-html" data-lang="html"><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">vb:if</span> <span class="na">condition</span><span class="o">=</span><span class="s">&#34;$show[&#39;guest&#39;]&#34;</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="c">&lt;!-- показать только для гостей --&gt;</span>
</span></span><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">vb:else</span> <span class="p">/&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="c">&lt;!-- показать только зарегистрированным пользователям --&gt;</span>
</span></span><span class="line"><span class="cl"><span class="p">&lt;/</span><span class="nt">vb:if</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">vb:if</span> <span class="na">condition</span><span class="o">=</span><span class="s">&#34;$show[&#39;guest&#39;]&#34;</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="c">&lt;!-- показать только для гостей --&gt;</span>
</span></span><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">vb:elseif</span> <span class="na">condition</span><span class="o">=</span><span class="s">&#34;is_member_of($bbuserinfo, 5,6)&#34;</span> <span class="p">/&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="c">&lt;!-- показать только для групп пользователей с ID = 5 и 6 --&gt;</span>
</span></span><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">vb:else</span> <span class="p">/&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="c">&lt;!-- показать только зарегистрированным пользователям --&gt;</span>
</span></span><span class="line"><span class="cl"><span class="p">&lt;/</span><span class="nt">vb:if</span><span class="p">&gt;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-82201bcb1ab5d6a14caafff134c235dc"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>]]></turbo:content></item><item turbo="true"><title>Условия в шаблонах для vBulletin 3</title><link>https://lib.onl/ru/2023/10/f82b1436-6752-5084-ba98-264b264edca7/</link><pubDate>Tue, 17 Oct 2023 17:07:58 +0000</pubDate><dc:creator>Kai Kimera</dc:creator><category>CMF</category><category>В истории</category><yandex:related><link url="https://lib.onl/ru/2023/10/560dfed8-9a25-5db3-95a6-a7df8129e960/">Невидимые ссылки для гостей на IP.Board 2.3</link><link url="https://lib.onl/ru/2023/10/347826e1-53d9-5c99-a6f8-66fc359323a2/">Динамическое "(Powered by Invision Power Board)" на IP.Board 2.3</link><link url="https://lib.onl/ru/2023/10/d477b5ce-8095-5607-91c7-5c5ad7b7f146/">Читабельные ссылки на темы форума для IP.Board 2.3</link><link url="https://lib.onl/ru/2023/10/a0756cae-ae3c-59ff-b587-ee8c7f3247c8/">FAQ для IP.Board 2.3</link><link url="https://lib.onl/ru/2023/10/54d4e488-9a8f-55ed-8fea-c77d4dba0720/">SQL запросы IP.Board 2.3</link><link url="https://lib.onl/ru/2023/10/06c9d359-31f0-5862-a342-62a21d4eb032/">SQL запросы IP.Board 3.x</link><link url="https://lib.onl/ru/2023/10/0743e73e-7c4c-5ab8-bba3-ba70bdb5cdfd/">Условия в файлах IP.Board 2.3</link><link url="https://lib.onl/ru/2023/10/d310a44c-4259-5bef-a7c2-d3d09a5c69f4/">Условия в шаблонах IP.Board 2.3</link><link url="https://lib.onl/ru/2023/10/a7405294-9f0c-52c1-a70e-ce4990079dc7/">Условия в шаблонах IP.Board 3.x</link></yandex:related><turbo:extendedHtml>true</turbo:extendedHtml><turbo:source>https://lib.onl/ru/2023/10/f82b1436-6752-5084-ba98-264b264edca7/</turbo:source><turbo:topic>Условия в шаблонах для vBulletin 3</turbo:topic><turbo:content><![CDATA[<p>Набор условий для применения в шаблонах форумного движка <span class="shortcode shortcode-tag"><a href="/ru/tags/vbulletin/" target="_blank">#vBulletin</a></span> 3.</p>
<h2 id="условия-в-шаблонах">
  <a class="link-body-emphasis" href="#%d1%83%d1%81%d0%bb%d0%be%d0%b2%d0%b8%d1%8f-%d0%b2-%d1%88%d0%b0%d0%b1%d0%bb%d0%be%d0%bd%d0%b0%d1%85">Условия в шаблонах</a>
</h2><ol>
<li>Показать информацию для одной или нескольких групп пользователей.</li>
</ol>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-0
shortcode-codeblock-html">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-28b4d96fb6f03f822baa983085345470" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-html" data-lang="html"><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">if</span> <span class="na">condition</span><span class="o">=</span><span class="s">&#34;is_member_of($bbuserinfo, X, Y, Z)&#34;</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="c">&lt;!-- информация --&gt;</span>
</span></span><span class="line"><span class="cl"><span class="p">&lt;/</span><span class="nt">if</span><span class="p">&gt;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-28b4d96fb6f03f822baa983085345470"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<ol start="2">
<li>Показать информацию только для одного пользователя.</li>
</ol>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-1
shortcode-codeblock-html">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-11ed0bdec869d228425e076e7c87dde0" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-html" data-lang="html"><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">if</span> <span class="na">condition</span><span class="o">=</span><span class="s">&#34;$bbuserinfo[userid] == X&#34;</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="c">&lt;!-- информация --&gt;</span>
</span></span><span class="line"><span class="cl"><span class="p">&lt;/</span><span class="nt">if</span><span class="p">&gt;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-11ed0bdec869d228425e076e7c87dde0"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<ol start="3">
<li>Показать информацию только для нескольких пользователей.</li>
</ol>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-2
shortcode-codeblock-html">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-6b1ec2bac0bbb27d65bcc498339f23e7" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-html" data-lang="html"><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">if</span> <span class="na">condition</span><span class="o">=</span><span class="s">&#34;in_array($bbuserinfo[userid], array(X,Y,Z))&#34;</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="c">&lt;!-- информация --&gt;</span>
</span></span><span class="line"><span class="cl"><span class="p">&lt;/</span><span class="nt">if</span><span class="p">&gt;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-6b1ec2bac0bbb27d65bcc498339f23e7"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<ol start="4">
<li>Скрыть информацию для одной группы пользователей.</li>
</ol>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-3
shortcode-codeblock-html">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-9def371704fa85a0337ea230bac7b4ef" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-html" data-lang="html"><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">if</span> <span class="na">condition</span><span class="o">=</span><span class="s">&#34;!is_member_of($bbuserinfo, X)&#34;</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="c">&lt;!-- информация --&gt;</span>
</span></span><span class="line"><span class="cl"><span class="p">&lt;/</span><span class="nt">if</span><span class="p">&gt;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-9def371704fa85a0337ea230bac7b4ef"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<ol start="5">
<li>Скрыть информацию для нескольких групп пользователей.</li>
</ol>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-4
shortcode-codeblock-html">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-14ab2fe8aeee729970da97cb83aa6b98" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-html" data-lang="html"><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">if</span> <span class="na">condition</span><span class="o">=</span><span class="s">&#34;!is_member_of($bbuserinfo, X, Y, Z)&#34;</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="c">&lt;!-- информация --&gt;</span>
</span></span><span class="line"><span class="cl"><span class="p">&lt;/</span><span class="nt">if</span><span class="p">&gt;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-14ab2fe8aeee729970da97cb83aa6b98"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<ol start="6">
<li>Скрыть информацию от нескольких пользователей.</li>
</ol>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-5
shortcode-codeblock-html">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-9132b744056019dcd58dffaf4af9e60d" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-html" data-lang="html"><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">if</span> <span class="na">condition</span><span class="o">=</span><span class="s">&#34;!in_array($bbuserinfo[userid], array(X,Y,Z))&#34;</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="c">&lt;!-- информация --&gt;</span>
</span></span><span class="line"><span class="cl"><span class="p">&lt;/</span><span class="nt">if</span><span class="p">&gt;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-9132b744056019dcd58dffaf4af9e60d"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<ol start="7">
<li>Показать информацию только в определённом форуме.</li>
</ol>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-6
shortcode-codeblock-html">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-b37d8e66b7399ef0676a5b44b353f18f" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-html" data-lang="html"><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">if</span> <span class="na">condition</span><span class="o">=</span><span class="s">&#34;$forumid == X&#34;</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="c">&lt;!-- информация --&gt;</span>
</span></span><span class="line"><span class="cl"><span class="p">&lt;/</span><span class="nt">if</span><span class="p">&gt;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-b37d8e66b7399ef0676a5b44b353f18f"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<ol start="8">
<li>Показать информацию в нескольких форумах.</li>
</ol>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-7
shortcode-codeblock-html">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-eb29b7e449dd61b07a475d991180dd34" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-html" data-lang="html"><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">if</span> <span class="na">condition</span><span class="o">=</span><span class="s">&#34;in_array($forumid, array(X,Y,Z))&#34;</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="c">&lt;!-- информация --&gt;</span>
</span></span><span class="line"><span class="cl"><span class="p">&lt;/</span><span class="nt">if</span><span class="p">&gt;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-eb29b7e449dd61b07a475d991180dd34"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<ol start="9">
<li>Скрыть информацию в определённом форуме.</li>
</ol>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-8
shortcode-codeblock-html">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-699ab053c34429486491b2f7361dcaeb" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-html" data-lang="html"><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">if</span> <span class="na">condition</span><span class="o">=</span><span class="s">&#34;$forumid != X&#34;</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="c">&lt;!-- информация --&gt;</span>
</span></span><span class="line"><span class="cl"><span class="p">&lt;/</span><span class="nt">if</span><span class="p">&gt;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-699ab053c34429486491b2f7361dcaeb"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<ol start="10">
<li>Скрыть информацию в нескольких форумах.</li>
</ol>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-9
shortcode-codeblock-html">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-dd93497b0f7062459aa0f814ea8ffba5" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-html" data-lang="html"><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">if</span> <span class="na">condition</span><span class="o">=</span><span class="s">&#34;!in_array($forumid, array(X,Y,Z))&#34;</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="c">&lt;!-- информация --&gt;</span>
</span></span><span class="line"><span class="cl"><span class="p">&lt;/</span><span class="nt">if</span><span class="p">&gt;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-dd93497b0f7062459aa0f814ea8ffba5"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>]]></turbo:content></item><item turbo="true"><title>Невидимые ссылки для гостей на IP.Board 2.3</title><link>https://lib.onl/ru/2023/10/560dfed8-9a25-5db3-95a6-a7df8129e960/</link><pubDate>Tue, 17 Oct 2023 03:15:11 +0000</pubDate><dc:creator>Kai Kimera</dc:creator><category>CMF</category><category>В истории</category><yandex:related><link url="https://lib.onl/ru/2023/10/347826e1-53d9-5c99-a6f8-66fc359323a2/">Динамическое "(Powered by Invision Power Board)" на IP.Board 2.3</link><link url="https://lib.onl/ru/2023/10/d477b5ce-8095-5607-91c7-5c5ad7b7f146/">Читабельные ссылки на темы форума для IP.Board 2.3</link><link url="https://lib.onl/ru/2023/10/a0756cae-ae3c-59ff-b587-ee8c7f3247c8/">FAQ для IP.Board 2.3</link><link url="https://lib.onl/ru/2023/10/54d4e488-9a8f-55ed-8fea-c77d4dba0720/">SQL запросы IP.Board 2.3</link><link url="https://lib.onl/ru/2023/10/06c9d359-31f0-5862-a342-62a21d4eb032/">SQL запросы IP.Board 3.x</link><link url="https://lib.onl/ru/2023/10/0743e73e-7c4c-5ab8-bba3-ba70bdb5cdfd/">Условия в файлах IP.Board 2.3</link><link url="https://lib.onl/ru/2023/10/d310a44c-4259-5bef-a7c2-d3d09a5c69f4/">Условия в шаблонах IP.Board 2.3</link><link url="https://lib.onl/ru/2023/10/a7405294-9f0c-52c1-a70e-ce4990079dc7/">Условия в шаблонах IP.Board 3.x</link></yandex:related><turbo:extendedHtml>true</turbo:extendedHtml><turbo:source>https://lib.onl/ru/2023/10/560dfed8-9a25-5db3-95a6-a7df8129e960/</turbo:source><turbo:topic>Невидимые ссылки для гостей на IP.Board 2.3</turbo:topic><turbo:content><![CDATA[<p>Когда-то была очень полезная модификация для <span class="shortcode shortcode-tag"><a href="/ru/tags/ipb/" target="_blank">#IPB</a></span>, которая защищала ссылки внутри форума от гостей. Ибо нефиг смотреть просто так, регистрируйтесь!</p>




    






    
    








<div class="shortcode shortcode-alert">
  <div class="alert alert-info d-flex overflow-hidden" role="alert">
    <div class="flex-shrink-0 align-self-center">
      <i class="fas fa-info fa-fw fa-2x"></i>
    </div>
    <div class="flex-grow-1 ms-3 overflow-hidden">
        <ul>
<li>Автор: Sannis.</li>
</ul>

    </div>
  </div>
</div>

<h2 id="внедрение-модификации">
  <a class="link-body-emphasis" href="#%d0%b2%d0%bd%d0%b5%d0%b4%d1%80%d0%b5%d0%bd%d0%b8%d0%b5-%d0%bc%d0%be%d0%b4%d0%b8%d1%84%d0%b8%d0%ba%d0%b0%d1%86%d0%b8%d0%b8">Внедрение модификации</a>
</h2><p>Эта небольшая модификация позволяет сделать так, чтобы ссылки стали скрытыми от гостей. Для этого нужно отредактировать файлы <code>topic.php</code> и <code>class_post.php</code>.</p>
<p>Открыть файл <code>./sources/action_public/topic.php</code>, найти:</p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-0
shortcode-codeblock-php">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-68c9c0e25023f7d4aa7cf7614f2e0d0c" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="c1">//-----------------------------------------
</span></span></span><span class="line"><span class="cl"><span class="c1">// Highlight...
</span></span></span><span class="line"><span class="cl"><span class="c1">//-----------------------------------------
</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-68c9c0e25023f7d4aa7cf7614f2e0d0c"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<p>Заменить на:</p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-1
shortcode-codeblock-php">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-f3c51385c714e5a489ab9d37225954ff" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">ipsclass</span><span class="o">-&gt;</span><span class="na">member</span><span class="p">[</span><span class="s1">&#39;id&#39;</span><span class="p">])</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="c1">//-----------------------------------------
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="c1">// Clear links for guests
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="c1">//-----------------------------------------
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl">  <span class="nv">$row</span><span class="p">[</span><span class="s1">&#39;post&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nx">preg_replace</span><span class="p">(</span><span class="s2">&#34;#&lt;a href=[</span><span class="se">\&#34;</span><span class="s2">&#39;].+?[</span><span class="se">\&#34;</span><span class="s2">&#39;].+?&gt;.+?&lt;/a&gt;#&#34;</span><span class="p">,</span> <span class="s2">&#34;&lt;i&gt;ссылка&lt;/i&gt;&#34;</span><span class="p">,</span> <span class="nv">$row</span><span class="p">[</span><span class="s1">&#39;post&#39;</span><span class="p">]);</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-f3c51385c714e5a489ab9d37225954ff"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<p>Открыть файл <code>./sources/classes/class_post.php</code>, найти:</p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-2
shortcode-codeblock-php">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-bd2243b3c0f75d6c5a9708c975f0646e" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="nv">$extra</span> <span class="o">=</span> <span class="s2">&#34;&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">if</span> <span class="p">(</span> <span class="nv">$tmp_post</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="nv">$raw_post</span> <span class="o">.=</span> <span class="s2">&#34;[quote name=&#39;&#34;</span><span class="o">.</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">parser</span><span class="o">-&gt;</span><span class="na">make_quote_safe</span><span class="p">(</span><span class="nv">$tp</span><span class="p">[</span><span class="s1">&#39;author_name&#39;</span><span class="p">])</span><span class="o">.</span><span class="s2">&#34;&#39; date=&#39;&#34;</span><span class="o">.</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">parser</span><span class="o">-&gt;</span><span class="na">make_quote_safe</span><span class="p">(</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">ipsclass</span><span class="o">-&gt;</span><span class="na">get_date</span><span class="p">(</span> <span class="nv">$tp</span><span class="p">[</span><span class="s1">&#39;post_date&#39;</span><span class="p">],</span> <span class="s1">&#39;LONG&#39;</span><span class="p">,</span> <span class="mi">1</span> <span class="p">))</span><span class="o">.</span><span class="s2">&#34;&#39; post=&#39;&#34;</span><span class="o">.</span><span class="nv">$tp</span><span class="p">[</span><span class="s1">&#39;pid&#39;</span><span class="p">]</span><span class="o">.</span><span class="s2">&#34;&#39;]</span><span class="se">\n</span><span class="si">$tmp_post\n</span><span class="s2">&#34;</span><span class="o">.</span><span class="nv">$extra</span><span class="o">.</span><span class="s1">&#39;[/quote]&#39;</span><span class="o">.</span><span class="s2">&#34;</span><span class="se">\n\n\n</span><span class="s2">&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-bd2243b3c0f75d6c5a9708c975f0646e"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<p>Заменить на:</p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-3
shortcode-codeblock-php">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-e748485192c5fe9ddd706f2793b33bbf" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span><span class="lnt">9
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">ipsclass</span><span class="o">-&gt;</span><span class="na">member</span><span class="p">[</span><span class="s1">&#39;id&#39;</span><span class="p">])</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="c1">//-----------------------------------------
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="c1">// Clear links for guests
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="c1">//-----------------------------------------
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl">  <span class="nv">$tmp_post</span> <span class="o">=</span> <span class="nx">preg_replace</span><span class="p">(</span><span class="s2">&#34;#\[url\](\S+?)\[/url\]#i&#34;</span><span class="p">,</span> <span class="s2">&#34;[i]ссылка[/i]&#34;</span><span class="p">,</span> <span class="nv">$tmp_post</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="nv">$tmp_post</span> <span class="o">=</span> <span class="nx">preg_replace</span><span class="p">(</span><span class="s2">&#34;#\[url\s*=\s*</span><span class="se">\&#34;</span><span class="s2">\;\s*(\S+?)\s*</span><span class="se">\&#34;</span><span class="s2">\;\s*\](.*?)\[\/url\]#i&#34;</span><span class="p">,</span> <span class="s2">&#34;</span><span class="se">\\</span><span class="s2">2&#34;</span><span class="p">,</span> <span class="nv">$tmp_post</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="nv">$tmp_post</span> <span class="o">=</span> <span class="nx">preg_replace</span><span class="p">(</span><span class="s2">&#34;#\[url\s*=\s*(\S+?)\s*\](.*?)\[\/url\]#i&#34;</span><span class="p">,</span> <span class="s2">&#34;</span><span class="se">\\</span><span class="s2">2&#34;</span><span class="p">,</span> <span class="nv">$tmp_post</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-e748485192c5fe9ddd706f2793b33bbf"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>]]></turbo:content></item><item turbo="true"><title>Динамическое "(Powered by Invision Power Board)" на IP.Board 2.3</title><link>https://lib.onl/ru/2023/10/347826e1-53d9-5c99-a6f8-66fc359323a2/</link><pubDate>Tue, 17 Oct 2023 03:10:06 +0000</pubDate><dc:creator>Kai Kimera</dc:creator><category>CMF</category><category>В истории</category><yandex:related><link url="https://lib.onl/ru/2023/10/d477b5ce-8095-5607-91c7-5c5ad7b7f146/">Читабельные ссылки на темы форума для IP.Board 2.3</link><link url="https://lib.onl/ru/2023/10/a0756cae-ae3c-59ff-b587-ee8c7f3247c8/">FAQ для IP.Board 2.3</link><link url="https://lib.onl/ru/2023/10/54d4e488-9a8f-55ed-8fea-c77d4dba0720/">SQL запросы IP.Board 2.3</link><link url="https://lib.onl/ru/2023/10/06c9d359-31f0-5862-a342-62a21d4eb032/">SQL запросы IP.Board 3.x</link><link url="https://lib.onl/ru/2023/10/0743e73e-7c4c-5ab8-bba3-ba70bdb5cdfd/">Условия в файлах IP.Board 2.3</link><link url="https://lib.onl/ru/2023/10/d310a44c-4259-5bef-a7c2-d3d09a5c69f4/">Условия в шаблонах IP.Board 2.3</link><link url="https://lib.onl/ru/2023/10/a7405294-9f0c-52c1-a70e-ce4990079dc7/">Условия в шаблонах IP.Board 3.x</link></yandex:related><turbo:extendedHtml>true</turbo:extendedHtml><turbo:source>https://lib.onl/ru/2023/10/347826e1-53d9-5c99-a6f8-66fc359323a2/</turbo:source><turbo:topic>Динамическое "(Powered by Invision Power Board)" на IP.Board 2.3</turbo:topic><turbo:content><![CDATA[<p>Нашёл ещё одну модификацию а-ля &ldquo;прикол на зависть другим&rdquo; для <span class="shortcode shortcode-tag"><a href="/ru/tags/ipb/" target="_blank">#IPB</a></span>. Модификация позволяет сделать из копирайта форума динамически изменяемую &ldquo;свистульку&rdquo;.</p>
<h2 id="внедрение-модификации">
  <a class="link-body-emphasis" href="#%d0%b2%d0%bd%d0%b5%d0%b4%d1%80%d0%b5%d0%bd%d0%b8%d0%b5-%d0%bc%d0%be%d0%b4%d0%b8%d1%84%d0%b8%d0%ba%d0%b0%d1%86%d0%b8%d0%b8">Внедрение модификации</a>
</h2><p>Открыть файл <code>./sources/action_public/boards.php</code>, найти:</p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-0
shortcode-codeblock-php">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-11167bebea733b6257b32e21d534bbc7" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="nv">$cp</span> <span class="o">=</span> <span class="s2">&#34; (Powered by Invision Power Board)&#34;</span><span class="p">;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-11167bebea733b6257b32e21d534bbc7"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<p>Заменить на:</p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-1
shortcode-codeblock-php">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-1db4f0a306b04e335bf48f839ae50221" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="nv">$cp_phrases</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">  <span class="s1">&#39;0&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39; - CYBER-CITY: Поддержка&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">  <span class="s1">&#39;1&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39; - CYBER-CITY: Разработка&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">  <span class="s1">&#39;2&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39; - CYBER-CITY: Исследование&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl"><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nv">$cp_rand</span> <span class="o">=</span> <span class="nx">rand</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="nv">$cp</span> <span class="o">=</span> <span class="nv">$cp_phrases</span><span class="p">[</span><span class="nv">$cp_rand</span><span class="p">];</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-1db4f0a306b04e335bf48f839ae50221"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<p>Не забудьте, если у вас больше фраз, чем 3, то измените <code>rand(0, 2)</code>, где <code>0</code> - первая фраза, <code>2</code> - последняя.</p>]]></turbo:content></item><item turbo="true"><title>Читабельные ссылки на темы форума для IP.Board 2.3</title><link>https://lib.onl/ru/2023/10/d477b5ce-8095-5607-91c7-5c5ad7b7f146/</link><pubDate>Tue, 17 Oct 2023 02:45:40 +0000</pubDate><dc:creator>Kai Kimera</dc:creator><category>CMF</category><category>В истории</category><yandex:related><link url="https://lib.onl/ru/2023/10/a0756cae-ae3c-59ff-b587-ee8c7f3247c8/">FAQ для IP.Board 2.3</link><link url="https://lib.onl/ru/2023/10/54d4e488-9a8f-55ed-8fea-c77d4dba0720/">SQL запросы IP.Board 2.3</link><link url="https://lib.onl/ru/2023/10/06c9d359-31f0-5862-a342-62a21d4eb032/">SQL запросы IP.Board 3.x</link><link url="https://lib.onl/ru/2023/10/0743e73e-7c4c-5ab8-bba3-ba70bdb5cdfd/">Условия в файлах IP.Board 2.3</link><link url="https://lib.onl/ru/2023/10/d310a44c-4259-5bef-a7c2-d3d09a5c69f4/">Условия в шаблонах IP.Board 2.3</link><link url="https://lib.onl/ru/2023/10/a7405294-9f0c-52c1-a70e-ce4990079dc7/">Условия в шаблонах IP.Board 3.x</link></yandex:related><turbo:extendedHtml>true</turbo:extendedHtml><turbo:source>https://lib.onl/ru/2023/10/d477b5ce-8095-5607-91c7-5c5ad7b7f146/</turbo:source><turbo:topic>Читабельные ссылки на темы форума для IP.Board 2.3</turbo:topic><turbo:content><![CDATA[<p>Очередной артефакт прошлого. Когда то была очень крутая модификация для <span class="shortcode shortcode-tag"><a href="/ru/tags/ipb/" target="_blank">#IPB</a></span> 2.3. Эта модификация позволяла преобразовывать обычные ссылки на темы внутри форума в читабельный формат с текстом. Золотое время было&hellip;</p>




    






    
    








<div class="shortcode shortcode-alert">
  <div class="alert alert-info d-flex overflow-hidden" role="alert">
    <div class="flex-shrink-0 align-self-center">
      <i class="fas fa-info fa-fw fa-2x"></i>
    </div>
    <div class="flex-grow-1 ms-3 overflow-hidden">
        <ul>
<li>Автор: GiV.</li>
<li>Тестирование (маленькое :)): KaiKimera.</li>
<li>Исправление ошибок и неточностей: Sannis.</li>
</ul>

    </div>
  </div>
</div>

<h2 id="внедрение-модификации">
  <a class="link-body-emphasis" href="#%d0%b2%d0%bd%d0%b5%d0%b4%d1%80%d0%b5%d0%bd%d0%b8%d0%b5-%d0%bc%d0%be%d0%b4%d0%b8%d1%84%d0%b8%d0%ba%d0%b0%d1%86%d0%b8%d0%b8">Внедрение модификации</a>
</h2><p>Открыть файл <code>./sources/classes/bbcode/class_bbcode_core.php</code>, найти:</p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-0
shortcode-codeblock-php">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-9327afd31e97106f86110de8c1abae61" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="nv">$show</span> <span class="o">=</span> <span class="nv">$url</span><span class="p">[</span><span class="s1">&#39;show&#39;</span><span class="p">];</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-9327afd31e97106f86110de8c1abae61"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<p>Добавить <strong>после</strong>:</p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-1
shortcode-codeblock-php">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-a1cc250a98d494233145e04c9b588a3c" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="k">if</span> <span class="p">(</span><span class="nx">strpos</span><span class="p">(</span><span class="nv">$show</span><span class="p">,</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">ipsclass</span><span class="o">-&gt;</span><span class="na">base_url</span><span class="p">)</span> <span class="o">!==</span> <span class="k">false</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="nv">$match</span> <span class="o">=</span> <span class="k">array</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="k">if</span> <span class="p">(</span><span class="nx">preg_match</span><span class="p">(</span><span class="s2">&#34;/showtopic=(\d+)/&#34;</span><span class="p">,</span> <span class="nv">$show</span><span class="p">,</span> <span class="nv">$match</span><span class="p">)</span> <span class="k">or</span> <span class="nx">preg_match</span><span class="p">(</span><span class="s2">&#34;/&amp;t=(\d+)/&#34;</span><span class="p">,</span> <span class="nv">$show</span><span class="p">,</span> <span class="nv">$match</span><span class="p">))</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nv">$show</span> <span class="o">=</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">_getUrlLocalName</span><span class="p">(</span><span class="s1">&#39;topics&#39;</span><span class="p">,</span> <span class="nv">$match</span><span class="p">[</span><span class="mi">1</span><span class="p">]);</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="k">if</span> <span class="p">(</span><span class="nx">preg_match</span><span class="p">(</span><span class="s2">&#34;/showforum=(\d+)/&#34;</span><span class="p">,</span> <span class="nv">$show</span><span class="p">,</span> <span class="nv">$match</span><span class="p">))</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nv">$show</span> <span class="o">=</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">_getUrlLocalName</span><span class="p">(</span><span class="s1">&#39;forums&#39;</span><span class="p">,</span> <span class="nv">$match</span><span class="p">[</span><span class="mi">1</span><span class="p">]);</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="k">if</span> <span class="p">(</span><span class="nx">preg_match</span><span class="p">(</span><span class="s2">&#34;/showuser=(\d+)/&#34;</span><span class="p">,</span> <span class="nv">$show</span><span class="p">,</span> <span class="nv">$match</span><span class="p">))</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nv">$show</span> <span class="o">=</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">_getUrlLocalName</span><span class="p">(</span><span class="s1">&#39;members&#39;</span><span class="p">,</span> <span class="nv">$match</span><span class="p">[</span><span class="mi">1</span><span class="p">]);</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nv">$show</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nv">$show</span> <span class="o">=</span> <span class="nv">$url</span><span class="p">[</span><span class="s1">&#39;show&#39;</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span> <span class="k">else</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-a1cc250a98d494233145e04c9b588a3c"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<p>Найти:</p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-2
shortcode-codeblock-php">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-af4ad2581bb09019b0e330b20faa24c4" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="cm">/*-------------------------------------------------------------------------*/</span>
</span></span><span class="line"><span class="cl"><span class="c1">// Remove sessions in a nice way
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="cm">/*-------------------------------------------------------------------------*/</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-af4ad2581bb09019b0e330b20faa24c4"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<p>Добавить <strong>перед</strong>:</p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-3
shortcode-codeblock-php">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-3ed571bbe672d26aa1441af4748e131c" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="k">function</span> <span class="nf">_getUrlLocalName</span><span class="p">(</span><span class="nv">$from</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="nv">$for</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="c1">// Сколько раз разбирали ссылки.
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="k">static</span> <span class="nv">$parsedUrls</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="c1">// Проверка на лимит разбора ссылок, чем больше число, тем больше
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="c1">// вероятность, что злоумышленник может создать нагрузку на БД.
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="k">if</span> <span class="p">(</span><span class="o">++</span><span class="nv">$parsedUrls</span> <span class="o">&gt;=</span> <span class="mi">10</span><span class="p">)</span> <span class="k">return</span> <span class="k">false</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nv">$from</span> <span class="k">or</span> <span class="o">!</span><span class="nv">$for</span><span class="p">)</span> <span class="k">return</span> <span class="k">false</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="c1">// Оптимизация для ссылок на форумы/разделы. Берем имя не через запрос
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="c1">// к базе, а из кэша форумов. Спасибо улетает к SAT.
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="k">if</span> <span class="p">(</span><span class="nv">$from</span> <span class="o">==</span> <span class="s1">&#39;forums&#39;</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">ipsclass</span><span class="o">-&gt;</span><span class="na">cache</span><span class="p">[</span><span class="s1">&#39;forum_cache&#39;</span><span class="p">][</span><span class="nv">$for</span><span class="p">][</span><span class="s1">&#39;name&#39;</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="c1">// &#39;pk&#39; - имя первичного ключа (id&#39;ентификатора) в таблице.
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="c1">// &#39;fieldName&#39; - имя поля в таблице, в котором хранится возвращаемое имя.
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="nv">$pk</span> <span class="o">=</span> <span class="s1">&#39;id&#39;</span><span class="p">;</span>           <span class="c1">// В большинстве случаев имя первичного ключа - &#39;id&#39;.
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="nv">$fieldName</span> <span class="o">=</span> <span class="s1">&#39;name&#39;</span><span class="p">;</span>  <span class="c1">// Имя поля - &#39;name&#39;.
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl">  <span class="c1">// Однако в случае с темами у нас другие &#39;pk&#39; и &#39;fieldName&#39;.
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="k">if</span> <span class="p">(</span><span class="nv">$from</span> <span class="o">==</span> <span class="s1">&#39;topics&#39;</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nv">$pk</span> <span class="o">=</span> <span class="s1">&#39;tid&#39;</span><span class="p">;</span>          <span class="c1">// Имя первичного ключа - &#39;tid&#39;.
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="nv">$fieldName</span> <span class="o">=</span> <span class="s1">&#39;title&#39;</span><span class="p">;</span> <span class="c1">// Имя поля с названием - &#39;title&#39;.
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="c1">// Однако в случае с пользователями у нас другое &#39;fieldName&#39;.
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="k">if</span> <span class="p">(</span><span class="nv">$from</span> <span class="o">==</span> <span class="s1">&#39;members&#39;</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nv">$fieldName</span> <span class="o">=</span> <span class="s1">&#39;members_display_name&#39;</span><span class="p">;</span> <span class="c1">// Имя поля с названием - &#39;members_display_name&#39;.
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">ipsclass</span><span class="o">-&gt;</span><span class="na">DB</span><span class="o">-&gt;</span><span class="na">simple_select</span><span class="p">(</span><span class="nv">$fieldName</span><span class="p">,</span> <span class="nv">$from</span><span class="p">,</span> <span class="nv">$pk</span> <span class="o">.</span> <span class="s2">&#34;= &#39;&#34;</span> <span class="o">.</span> <span class="nv">$for</span> <span class="o">.</span> <span class="s2">&#34;&#39;&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="nv">$ci</span> <span class="o">=</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">ipsclass</span><span class="o">-&gt;</span><span class="na">DB</span><span class="o">-&gt;</span><span class="na">exec_query</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">  <span class="nv">$row</span> <span class="o">=</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">ipsclass</span><span class="o">-&gt;</span><span class="na">DB</span><span class="o">-&gt;</span><span class="na">fetch_row</span><span class="p">(</span><span class="nv">$ci</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="k">if</span> <span class="p">(</span><span class="nv">$fieldValue</span> <span class="o">=</span> <span class="nv">$row</span><span class="p">[</span><span class="nv">$fieldName</span><span class="p">])</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="nv">$fieldValue</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="k">return</span> <span class="k">false</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-3ed571bbe672d26aa1441af4748e131c"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>]]></turbo:content></item><item turbo="true"><title>FAQ для IP.Board 2.3</title><link>https://lib.onl/ru/2023/10/a0756cae-ae3c-59ff-b587-ee8c7f3247c8/</link><pubDate>Tue, 17 Oct 2023 00:57:06 +0000</pubDate><dc:creator>Kai Kimera</dc:creator><category>CMF</category><category>В истории</category><yandex:related><link url="https://lib.onl/ru/2023/10/54d4e488-9a8f-55ed-8fea-c77d4dba0720/">SQL запросы IP.Board 2.3</link><link url="https://lib.onl/ru/2023/10/06c9d359-31f0-5862-a342-62a21d4eb032/">SQL запросы IP.Board 3.x</link><link url="https://lib.onl/ru/2023/10/0743e73e-7c4c-5ab8-bba3-ba70bdb5cdfd/">Условия в файлах IP.Board 2.3</link><link url="https://lib.onl/ru/2023/10/d310a44c-4259-5bef-a7c2-d3d09a5c69f4/">Условия в шаблонах IP.Board 2.3</link><link url="https://lib.onl/ru/2023/10/a7405294-9f0c-52c1-a70e-ce4990079dc7/">Условия в шаблонах IP.Board 3.x</link></yandex:related><turbo:extendedHtml>true</turbo:extendedHtml><turbo:source>https://lib.onl/ru/2023/10/a0756cae-ae3c-59ff-b587-ee8c7f3247c8/</turbo:source><turbo:topic>FAQ для IP.Board 2.3</turbo:topic><turbo:content><![CDATA[<p>Сборник вопросов и ответов по форумному движку <span class="shortcode shortcode-tag"><a href="/ru/tags/ipb/" target="_blank">#IPB</a></span> 2.3.</p>
<h2 id="как-сделать-портал-главной-страницей-форума">
  <a class="link-body-emphasis" href="#%d0%ba%d0%b0%d0%ba-%d1%81%d0%b4%d0%b5%d0%bb%d0%b0%d1%82%d1%8c-%d0%bf%d0%be%d1%80%d1%82%d0%b0%d0%bb-%d0%b3%d0%bb%d0%b0%d0%b2%d0%bd%d0%be%d0%b9-%d1%81%d1%82%d1%80%d0%b0%d0%bd%d0%b8%d1%86%d0%b5%d0%b9-%d1%84%d0%be%d1%80%d1%83%d0%bc%d0%b0">Как сделать портал главной страницей форума?</a>
</h2><p>Открыть файл <code>init.php</code>, найти:</p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-0
shortcode-codeblock-php">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-c4b1f28fe4f8a6e7199126e179a29f43" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="nx">define</span><span class="p">(</span> <span class="s1">&#39;IPB_MAKE_PORTAL_HOMEPAGE&#39;</span><span class="p">,</span> <span class="mi">0</span> <span class="p">);</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-c4b1f28fe4f8a6e7199126e179a29f43"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<p>Заменить на:</p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-1
shortcode-codeblock-php">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-76ee436d04d140fee251886b29dc6c84" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="nx">define</span><span class="p">(</span> <span class="s1">&#39;IPB_MAKE_PORTAL_HOMEPAGE&#39;</span><span class="p">,</span> <span class="mi">1</span> <span class="p">);</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-76ee436d04d140fee251886b29dc6c84"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<h2 id="как-удалить-powered-by-invision-power-board-из-title">
  <a class="link-body-emphasis" href="#%d0%ba%d0%b0%d0%ba-%d1%83%d0%b4%d0%b0%d0%bb%d0%b8%d1%82%d1%8c-powered-by-invision-power-board-%d0%b8%d0%b7-title">Как удалить (Powered by Invision Power Board) из title?</a>
</h2><p>Открыть файл <code>./sources/action_public/boards.php</code>, найти:</p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-2
shortcode-codeblock-php">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-d8ca6286d5f99dfdae6afa1d49e585e2" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="nv">$cp</span> <span class="o">=</span> <span class="s2">&#34; (Powered by Invision Power Board)&#34;</span><span class="p">;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-d8ca6286d5f99dfdae6afa1d49e585e2"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<p>Заменить на:</p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-3
shortcode-codeblock-php">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-7b9038c9c1c501c04fbb7672c4b38990" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="nv">$cp</span> <span class="o">=</span> <span class="s2">&#34;&#34;</span><span class="p">;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-7b9038c9c1c501c04fbb7672c4b38990"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<h2 id="как-убрать-текст-в-просмотре-темы-под-аватаром">
  <a class="link-body-emphasis" href="#%d0%ba%d0%b0%d0%ba-%d1%83%d0%b1%d1%80%d0%b0%d1%82%d1%8c-%d1%82%d0%b5%d0%ba%d1%81%d1%82-%d0%b2-%d0%bf%d1%80%d0%be%d1%81%d0%bc%d0%be%d1%82%d1%80%d0%b5-%d1%82%d0%b5%d0%bc%d1%8b-%d0%bf%d0%be%d0%b4-%d0%b0%d0%b2%d0%b0%d1%82%d0%b0%d1%80%d0%be%d0%bc">Как убрать текст в просмотре темы под аватаром?</a>
</h2><p>Нужно отредактировать шаблон <code>RenderRow</code>:</p>
<ul>
<li>Админцентр / Внешний вид / <em>Ваш скин</em>.
<ul>
<li>редактировать HTML фрагменты / <code>skin_topic</code> (Просмотр темы) / <code>RenderRow</code>.</li>
</ul>
</li>
</ul>
<p>Код, отвечающий за поля пользователя в сообщении:</p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-4
shortcode-codeblock-php">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-a069b5fbbe296c433dc19662ad25b1d7" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="p">{</span><span class="nv">$author</span><span class="p">[</span><span class="s1">&#39;avatar&#39;</span><span class="p">]}</span><span class="o">&lt;</span><span class="nx">br</span> <span class="o">/&gt;&lt;</span><span class="nx">br</span> <span class="o">/&gt;</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span><span class="nv">$author</span><span class="p">[</span><span class="s1">&#39;title&#39;</span><span class="p">]}</span><span class="o">&lt;</span><span class="nx">br</span> <span class="o">/&gt;</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span><span class="nv">$author</span><span class="p">[</span><span class="s1">&#39;member_rank_img&#39;</span><span class="p">]}</span><span class="o">&lt;</span><span class="nx">br</span> <span class="o">/&gt;&lt;</span><span class="nx">br</span> <span class="o">/&gt;</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span><span class="nv">$author</span><span class="p">[</span><span class="s1">&#39;member_group&#39;</span><span class="p">]}</span><span class="o">&lt;</span><span class="nx">br</span> <span class="o">/&gt;</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span><span class="nv">$author</span><span class="p">[</span><span class="s1">&#39;member_posts&#39;</span><span class="p">]}</span><span class="o">&lt;</span><span class="nx">br</span> <span class="o">/&gt;</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span><span class="nv">$author</span><span class="p">[</span><span class="s1">&#39;member_joined&#39;</span><span class="p">]}</span><span class="o">&lt;</span><span class="nx">br</span> <span class="o">/&gt;</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span><span class="nv">$author</span><span class="p">[</span><span class="s1">&#39;member_location&#39;</span><span class="p">]}</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span><span class="nv">$author</span><span class="p">[</span><span class="s1">&#39;member_number&#39;</span><span class="p">]}</span><span class="o">&lt;</span><span class="nx">br</span> <span class="o">/&gt;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-a069b5fbbe296c433dc19662ad25b1d7"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<p>Где:</p>
<ul>
<li><code>{$author['avatar']}</code> - аватар.</li>
<li><code>{$author['title']}</code> - ранг.</li>
<li><code>{$author['member_rank_img']}</code> - изображения ранга.</li>
<li><code>{$author['member_group']}</code> - Группа пользователя.</li>
<li><code>{$author['member_posts']}</code> - Сообщения.</li>
<li><code>{$author['member_joined']}</code> - Регистрация.</li>
<li><code>{$author['member_number']}</code> - ID пользователя.</li>
</ul>
<h2 id="как-добавить-дополнительные-кнопки-bb-кода-в-быстрый-ответ">
  <a class="link-body-emphasis" href="#%d0%ba%d0%b0%d0%ba-%d0%b4%d0%be%d0%b1%d0%b0%d0%b2%d0%b8%d1%82%d1%8c-%d0%b4%d0%be%d0%bf%d0%be%d0%bb%d0%bd%d0%b8%d1%82%d0%b5%d0%bb%d1%8c%d0%bd%d1%8b%d0%b5-%d0%ba%d0%bd%d0%be%d0%bf%d0%ba%d0%b8-bb-%d0%ba%d0%be%d0%b4%d0%b0-%d0%b2-%d0%b1%d1%8b%d1%81%d1%82%d1%80%d1%8b%d0%b9-%d0%be%d1%82%d0%b2%d0%b5%d1%82">Как добавить дополнительные кнопки BB-кода в быстрый ответ?</a>
</h2><p>Сначала нужно в файле <code>./jscripts/ips_text_editor_lite.js</code> добавить свои BB-коды, а потом отредактировать шаблон <code>quick_reply_box_open</code>.</p>
<p>Открываем <code>./jscripts/ips_text_editor_lite.js</code>, находим строчку:</p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-5
shortcode-codeblock-js">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-ec9cfd462228d0aee7df9a259b0ccb7c" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="line"><span class="cl"><span class="k">this</span><span class="p">.</span><span class="nx">ipb_code</span><span class="o">=</span><span class="kd">function</span><span class="p">(){</span><span class="kd">var</span> <span class="nx">_text</span><span class="o">=</span><span class="k">this</span><span class="p">.</span><span class="nx">get_selection</span><span class="p">();</span><span class="k">this</span><span class="p">.</span><span class="nx">wrap_tags</span><span class="p">(</span><span class="s1">&#39;code&#39;</span><span class="p">,</span><span class="kc">false</span><span class="p">,</span><span class="nx">_text</span><span class="p">);};</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-ec9cfd462228d0aee7df9a259b0ccb7c"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<p>Эта строка отвечает за BB-код <code>CODE</code>. Копируем её к себе в редактор и заменяем в ней слово code на свой BB-код (например, у меня будет это <code>[i]spoiler[/i]</code>):</p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-6
shortcode-codeblock-js">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-3ea026743939caa5a9f189db20df90f5" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="line"><span class="cl"><span class="k">this</span><span class="p">.</span><span class="nx">ipb_spoiler</span><span class="o">=</span><span class="kd">function</span><span class="p">(){</span><span class="kd">var</span> <span class="nx">_text</span><span class="o">=</span><span class="k">this</span><span class="p">.</span><span class="nx">get_selection</span><span class="p">();</span><span class="k">this</span><span class="p">.</span><span class="nx">wrap_tags</span><span class="p">(</span><span class="s1">&#39;spoiler&#39;</span><span class="p">,</span><span class="kc">false</span><span class="p">,</span><span class="nx">_text</span><span class="p">);};</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-3ea026743939caa5a9f189db20df90f5"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<p>После этого вставляем её обратно в файл <code>./jscripts/ips_text_editor_lite.js</code>, НО уже после скопированной нами ранее строки с BB-кодом <code>CODE</code>. Получается вот так:</p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-7
shortcode-codeblock-js">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-0c54094be87a7bef93d2a855d046baed" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="line"><span class="cl"><span class="k">this</span><span class="p">.</span><span class="nx">ipb_code</span><span class="o">=</span><span class="kd">function</span><span class="p">(){</span><span class="kd">var</span> <span class="nx">_text</span><span class="o">=</span><span class="k">this</span><span class="p">.</span><span class="nx">get_selection</span><span class="p">();</span><span class="k">this</span><span class="p">.</span><span class="nx">wrap_tags</span><span class="p">(</span><span class="s1">&#39;code&#39;</span><span class="p">,</span><span class="kc">false</span><span class="p">,</span><span class="nx">_text</span><span class="p">);};</span><span class="k">this</span><span class="p">.</span><span class="nx">ipb_spoiler</span><span class="o">=</span><span class="kd">function</span><span class="p">(){</span><span class="kd">var</span> <span class="nx">_text</span><span class="o">=</span><span class="k">this</span><span class="p">.</span><span class="nx">get_selection</span><span class="p">();</span><span class="k">this</span><span class="p">.</span><span class="nx">wrap_tags</span><span class="p">(</span><span class="s1">&#39;spoiler&#39;</span><span class="p">,</span><span class="kc">false</span><span class="p">,</span><span class="nx">_text</span><span class="p">);};</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-0c54094be87a7bef93d2a855d046baed"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<p>Сохраняем!</p>
<p>Теперь нужно отредактировать шаблон <code>quick_reply_box_open</code>:</p>
<ul>
<li>Админцентр / Внешний вид / <em>Ваш скин</em>.
<ul>
<li>редактировать HTML фрагменты / <code>skin_topic</code> (Просмотр темы) / <code>quick_reply_box_open</code>.</li>
</ul>
</li>
</ul>
<p>Открываем шаблон, находим:</p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-8
shortcode-codeblock-html">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-821cfcba4410c10154743d5b2780a972" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-html" data-lang="html"><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">td</span><span class="p">&gt;&lt;</span><span class="nt">div</span> <span class="na">class</span><span class="o">=</span><span class="s">&#34;rte-normal&#34;</span> <span class="na">id</span><span class="o">=</span><span class="s">&#34;fast-reply_cmd_ipb_code&#34;</span><span class="p">&gt;&lt;</span><span class="nt">img</span> <span class="na">src</span><span class="o">=</span><span class="s">&#34;style_images/&lt;#IMG_DIR#&gt;/folder_editor_images/rte-code-button.png&#34;</span>  <span class="na">alt</span><span class="o">=</span><span class="s">&#34;{$this-&gt;ipsclass-&gt;lang[&#39;js_rte_lite_code&#39;]}&#34;</span> <span class="na">title</span><span class="o">=</span><span class="s">&#34;{$this-&gt;ipsclass-&gt;lang[&#39;js_rte_lite_code&#39;]}&#34;</span><span class="p">&gt;&lt;/</span><span class="nt">div</span><span class="p">&gt;&lt;/</span><span class="nt">td</span><span class="p">&gt;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-821cfcba4410c10154743d5b2780a972"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<p>Копируем этот участок и вставляем ниже. Теперь нужно отредактировать вставленный нами участок. Слово <code>code</code> заменяем на свой тег. Напомню, что у меня это - <code>spoiler</code>. Вот пример:</p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-9
shortcode-codeblock-html">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-7b944330c3abbe748bd600969c4f77ac" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-html" data-lang="html"><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">td</span><span class="p">&gt;&lt;</span><span class="nt">div</span> <span class="na">class</span><span class="o">=</span><span class="s">&#34;rte-normal&#34;</span> <span class="na">id</span><span class="o">=</span><span class="s">&#34;fast-reply_cmd_ipb_spoiler&#34;</span><span class="p">&gt;&lt;</span><span class="nt">img</span> <span class="na">src</span><span class="o">=</span><span class="s">&#34;style_images/&lt;#IMG_DIR#&gt;/folder_editor_images/rte-spoiler-button.png&#34;</span>  <span class="na">alt</span><span class="o">=</span><span class="s">&#34;Спойлер&#34;</span> <span class="na">title</span><span class="o">=</span><span class="s">&#34;Спойлер&#34;</span><span class="p">&gt;&lt;/</span><span class="nt">div</span><span class="p">&gt;&lt;/</span><span class="nt">td</span><span class="p">&gt;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-7b944330c3abbe748bd600969c4f77ac"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<p>Не забудьте загрузить кнопку для своего тега в папку <code>./style_images/папка_стиля/folder_editor_images</code>.</p>
<h2 id="как-добавить-дополнительные-кнопки-bb-кода-в-расширенный-ответ">
  <a class="link-body-emphasis" href="#%d0%ba%d0%b0%d0%ba-%d0%b4%d0%be%d0%b1%d0%b0%d0%b2%d0%b8%d1%82%d1%8c-%d0%b4%d0%be%d0%bf%d0%be%d0%bb%d0%bd%d0%b8%d1%82%d0%b5%d0%bb%d1%8c%d0%bd%d1%8b%d0%b5-%d0%ba%d0%bd%d0%be%d0%bf%d0%ba%d0%b8-bb-%d0%ba%d0%be%d0%b4%d0%b0-%d0%b2-%d1%80%d0%b0%d1%81%d1%88%d0%b8%d1%80%d0%b5%d0%bd%d0%bd%d1%8b%d0%b9-%d0%be%d1%82%d0%b2%d0%b5%d1%82">Как добавить дополнительные кнопки BB-кода в расширенный ответ?</a>
</h2><p>Инструкция добавления BB-кода в расширенный ответ похожа на предыдущую, за исключением того, что для расширенного ответа необходимо отредактировать файл <code>./jscripts/ips_text_editor.js</code> и шаблон <code>ips_editor</code>.</p>
<p>Открываем <code>./jscripts/ips_text_editor.js</code>, находим:</p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-10
shortcode-codeblock-js">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-88ee37f081235ba610589083347664b4" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="line"><span class="cl"><span class="k">this</span><span class="p">.</span><span class="nx">ipb_quote</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">  <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">this</span><span class="p">.</span><span class="nx">wrap_tags_lite</span><span class="p">(</span>  <span class="s1">&#39;[quote]&#39;</span><span class="p">,</span> <span class="s1">&#39;[/quote]&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="p">};</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-88ee37f081235ba610589083347664b4"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<p>Добавить ниже:</p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-11
shortcode-codeblock-js">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-24a4415dcb1a535315d93163407e1592" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="line"><span class="cl"><span class="k">this</span><span class="p">.</span><span class="nx">ipb_youtube</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">  <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">this</span><span class="p">.</span><span class="nx">wrap_tags_lite</span><span class="p">(</span>  <span class="s1">&#39;[spoiler]&#39;</span><span class="p">,</span> <span class="s1">&#39;[/spoiler]&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="p">};</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-24a4415dcb1a535315d93163407e1592"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<p>После этого необходимо отредактировать шаблон <code>skin_editors</code> (редактор сообщений) / <code>ips_editor</code>, чтобы добавить кнопку в расширенный ответ. Находим:</p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-12
shortcode-codeblock-html">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-8cbe19688d5610974a9a514950323a82" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-html" data-lang="html"><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">td</span><span class="p">&gt;&lt;</span><span class="nt">div</span> <span class="na">class</span><span class="o">=</span><span class="s">&#34;rte-normal&#34;</span>  <span class="na">id</span><span class="o">=</span><span class="s">&#34;{$editor_id}_cmd_ipb_code&#34;</span><span class="p">&gt;&lt;</span><span class="nt">img</span>  <span class="na">src</span><span class="o">=</span><span class="s">&#34;{$images_path}rte-code-button.png&#34;</span>   <span class="na">alt</span><span class="o">=</span><span class="s">&#34;{$this-&gt;ipsclass-&gt;lang[&#39;js_rte_lite_code&#39;]}&#34;</span>  <span class="na">title</span><span class="o">=</span><span class="s">&#34;{$this-&gt;ipsclass-&gt;lang[&#39;js_rte_lite_code&#39;]}&#34;</span><span class="p">&gt;&lt;/</span><span class="nt">div</span><span class="p">&gt;&lt;/</span><span class="nt">td</span><span class="p">&gt;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-8cbe19688d5610974a9a514950323a82"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<p>Добавляем выше:</p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-13
shortcode-codeblock-html">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-ed14f39248561f230e3348af52c95769" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-html" data-lang="html"><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">td</span><span class="p">&gt;&lt;</span><span class="nt">div</span> <span class="na">class</span><span class="o">=</span><span class="s">&#34;rte-normal&#34;</span> <span class="na">id</span><span class="o">=</span><span class="s">&#34;{$editor_id}_cmd_ipb_youtube&#34;</span><span class="p">&gt;&lt;</span><span class="nt">img</span> <span class="na">src</span><span class="o">=</span><span class="s">&#34;{$images_path}rte-code-tube.png&#34;</span>  <span class="na">alt</span><span class="o">=</span><span class="s">&#34;Youtube&#34;</span> <span class="na">title</span><span class="o">=</span><span class="s">&#34;YouTube&#34;</span><span class="p">&gt;&lt;/</span><span class="nt">div</span><span class="p">&gt;&lt;/</span><span class="nt">td</span><span class="p">&gt;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-ed14f39248561f230e3348af52c95769"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<p>Не забудьте загрузить кнопку для своего тега в папку <code>./style_images/папка_стиля/folder_editor_images</code>.</p>
<h2 id="возникает-ошибка-fatal-error-allowed-memory-size-of-xxx-bytes-exhausted-tried-to-allocate-yyy-bytes-что-это-такое">
  <a class="link-body-emphasis" href="#%d0%b2%d0%be%d0%b7%d0%bd%d0%b8%d0%ba%d0%b0%d0%b5%d1%82-%d0%be%d1%88%d0%b8%d0%b1%d0%ba%d0%b0-fatal-error-allowed-memory-size-of-xxx-bytes-exhausted-tried-to-allocate-yyy-bytes-%d1%87%d1%82%d0%be-%d1%8d%d1%82%d0%be-%d1%82%d0%b0%d0%ba%d0%be%d0%b5">Возникает ошибка Fatal error: Allowed memory size of xxx bytes exhausted (tried to allocate yyy bytes). Что это такое?</a>
</h2><p>При попытке зайти в тему, профиль пользователя, список пользователей либо любую другую страницу ничего не выводится, либо выводится сообщение аналогичное приведенному:</p>






    




<div class="shortcode shortcode-window">
  <div class="card text-bg-danger mb-3 overflow-hidden">
    <div class="card-header">
      <div class="d-flex align-items-center">
        <div class="flex-shrink-0">
          <i class="fas fa-computer fa-fw"></i>
        </div>
        <div class="flex-grow-1 mx-2">
          <h5 class="mb-0">Fatal error</h5>
        </div>
        <div class="flex-shrink-0">
          <ul class="list-inline mb-0">
            <li class="list-inline-item"><i class="fas fa-circle fa-fw"></i></li>
            <li class="list-inline-item"><i class="fas fa-circle fa-fw"></i></li>
            <li class="list-inline-item"><i class="fas fa-circle fa-fw"></i></li>
          </ul>
        </div>
      </div>
    </div>
    <div class="card-body">
        <p>Fatal error: Allowed memory size of 8388608 bytes exhausted (tried to allocate 737280 bytes) in /home/ourmobil/public_html/forum/sources/ipsclass.php(2054) : eval()&rsquo;d code on line 1085</p>

    </div>
  </div>
</div>

<p>или такому:</p>






    




<div class="shortcode shortcode-window">
  <div class="card text-bg-danger mb-3 overflow-hidden">
    <div class="card-header">
      <div class="d-flex align-items-center">
        <div class="flex-shrink-0">
          <i class="fas fa-computer fa-fw"></i>
        </div>
        <div class="flex-grow-1 mx-2">
          <h5 class="mb-0">Fatal error</h5>
        </div>
        <div class="flex-shrink-0">
          <ul class="list-inline mb-0">
            <li class="list-inline-item"><i class="fas fa-circle fa-fw"></i></li>
            <li class="list-inline-item"><i class="fas fa-circle fa-fw"></i></li>
            <li class="list-inline-item"><i class="fas fa-circle fa-fw"></i></li>
          </ul>
        </div>
      </div>
    </div>
    <div class="card-body">
        <p>Fatal error: Allowed memory size of 50331648 bytes exhausted (tried to allocate 16 bytes) in /home/users/d/demon99/docs/subs/cs/forum/ips_kernel/class_xml.php on line 254</p>

    </div>
  </div>
</div>

<p>Это означает, что для выполнения скрипта требуется больше памяти, чем предоставляет PHP. Необходимо увеличить количество выделяемой PHP памяти. Сделать это можно одним из следующих способов:</p>
<ol>
<li>В <code>.htaccess</code> добавить строку (при условии, что <span class="shortcode shortcode-tag"><a href="/ru/tags/php/" target="_blank">#PHP</a></span> работает под Apache):</li>
</ol>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-14
shortcode-codeblock-apache">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-727f7016804318b308bac2ad4c8b6480" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-apache" data-lang="apache"><span class="line"><span class="cl"><span class="nb">php_value</span> memory_limit <span class="m">32</span>M</span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-727f7016804318b308bac2ad4c8b6480"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<ol start="2">
<li>В <code>php.ini</code> (при условии, что Вы можете его редактировать) изменить значение параметра <code>memory_limit</code>:</li>
</ol>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-15
shortcode-codeblock-ini">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-4b1b5f6c7e3c480cf106be715e120f59" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-ini" data-lang="ini"><span class="line"><span class="cl"><span class="na">memory_limit 32M</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-4b1b5f6c7e3c480cf106be715e120f59"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<ol start="3">
<li>Добавив в <code>index.php</code> после:</li>
</ol>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-16
shortcode-codeblock-php">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-baa9a23cd17cf6d2e44fe294e13a5877" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="o">&lt;?</span><span class="nx">php</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-baa9a23cd17cf6d2e44fe294e13a5877"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<p>следующий код:</p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-17
shortcode-codeblock-php">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-79b052f0c9ee880b8891a6500fa55cc6" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="nx">ini_set</span><span class="p">(</span><span class="s1">&#39;memory_limit&#39;</span><span class="p">,</span> <span class="s1">&#39;32M&#39;</span><span class="p">);</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-79b052f0c9ee880b8891a6500fa55cc6"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<p>Если ни один из предложенных вариантов не подошел, обратитесь за помощью к хостеру с указанием описания ошибки.</p>
<h2 id="как-сделать-форум-на-несколько-доменов">
  <a class="link-body-emphasis" href="#%d0%ba%d0%b0%d0%ba-%d1%81%d0%b4%d0%b5%d0%bb%d0%b0%d1%82%d1%8c-%d1%84%d0%be%d1%80%d1%83%d0%bc-%d0%bd%d0%b0-%d0%bd%d0%b5%d1%81%d0%ba%d0%be%d0%bb%d1%8c%d0%ba%d0%be-%d0%b4%d0%be%d0%bc%d0%b5%d0%bd%d0%be%d0%b2">Как сделать форум на несколько доменов?</a>
</h2><p>Если у вас несколько доменов, но ОДНА база данных, то в <code>conf_global.php</code> нужно изменить строчку:</p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-18
shortcode-codeblock-php">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-573b715e62649e9dfae8cf86d0b38697" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="nv">$INFO</span><span class="p">[</span><span class="s1">&#39;board_url&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;http://domain.com&#39;</span><span class="p">;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-573b715e62649e9dfae8cf86d0b38697"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<p>На такую:</p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-19
shortcode-codeblock-php">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-787afcc6e3f07447b42ce6d80fe56829" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="nv">$INFO</span><span class="p">[</span><span class="s1">&#39;board_url&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&#34;http://&#34;</span><span class="o">.</span><span class="nv">$_SERVER</span><span class="p">[</span><span class="s2">&#34;HTTP_HOST&#34;</span><span class="p">];</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-787afcc6e3f07447b42ce6d80fe56829"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<p>Однако, если форум установлен в под-директорию, например, <code>http://domain.com/forum</code>, то необходимо изменить строчку на следующую:</p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-20
shortcode-codeblock-php">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-35e53a46a87af565f8ff1332d1b2830b" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="nv">$INFO</span><span class="p">[</span><span class="s1">&#39;board_url&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&#34;http://&#34;</span><span class="o">.</span><span class="nv">$_SERVER</span><span class="p">[</span><span class="s2">&#34;HTTP_HOST&#34;</span><span class="p">]</span><span class="o">.</span><span class="s2">&#34;/forum&#34;</span><span class="p">;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-35e53a46a87af565f8ff1332d1b2830b"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<p>Где:</p>
<ul>
<li><code>forum</code> - папка форума.</li>
</ul>
<h2 id="как-сделать-чтобы-прикреплённые-имена-файлов-имели-русские-символы-в-названии">
  <a class="link-body-emphasis" href="#%d0%ba%d0%b0%d0%ba-%d1%81%d0%b4%d0%b5%d0%bb%d0%b0%d1%82%d1%8c-%d1%87%d1%82%d0%be%d0%b1%d1%8b-%d0%bf%d1%80%d0%b8%d0%ba%d1%80%d0%b5%d0%bf%d0%bb%d1%91%d0%bd%d0%bd%d1%8b%d0%b5-%d0%b8%d0%bc%d0%b5%d0%bd%d0%b0-%d1%84%d0%b0%d0%b9%d0%bb%d0%be%d0%b2-%d0%b8%d0%bc%d0%b5%d0%bb%d0%b8-%d1%80%d1%83%d1%81%d1%81%d0%ba%d0%b8%d0%b5-%d1%81%d0%b8%d0%bc%d0%b2%d0%be%d0%bb%d1%8b-%d0%b2-%d0%bd%d0%b0%d0%b7%d0%b2%d0%b0%d0%bd%d0%b8%d0%b8">Как сделать, чтобы прикреплённые имена файлов имели русские символы в названии?</a>
</h2><p>Для этого необходимо открыть файл <code>./ips_kernel/class_upload.php</code>, найти:</p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-21
shortcode-codeblock-php">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-e88e2ce65ff674944a3f809e955cb595" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="c1">//-------------------------------------------------
</span></span></span><span class="line"><span class="cl"><span class="c1">// Make the uploaded file safe
</span></span></span><span class="line"><span class="cl"><span class="c1">//-------------------------------------------------
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl"><span class="nv">$FILE_NAME</span> <span class="o">=</span> <span class="nx">preg_replace</span><span class="p">(</span> <span class="s2">&#34;/[^\w\.]/&#34;</span><span class="p">,</span> <span class="s2">&#34;_&#34;</span><span class="p">,</span> <span class="nv">$FILE_NAME</span> <span class="p">);</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-e88e2ce65ff674944a3f809e955cb595"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<p>Заменить на:</p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-22
shortcode-codeblock-php">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-09ebfa9861b3a2ddd48b312e6f854e73" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="c1">//-------------------------------------------------
</span></span></span><span class="line"><span class="cl"><span class="c1">// Make the uploaded file safe
</span></span></span><span class="line"><span class="cl"><span class="c1">//-------------------------------------------------
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl"><span class="nv">$FILE_NAME</span> <span class="o">=</span> <span class="nx">preg_replace</span><span class="p">(</span> <span class="s2">&#34;/[^a-zA-Z0-9а-яА-Я\-\.\_]/&#34;</span><span class="p">,</span> <span class="s2">&#34;_&#34;</span><span class="p">,</span> <span class="nv">$FILE_NAME</span> <span class="p">);</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-09ebfa9861b3a2ddd48b312e6f854e73"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>]]></turbo:content></item><item turbo="true"><title>SQL запросы IP.Board 2.3</title><link>https://lib.onl/ru/2023/10/54d4e488-9a8f-55ed-8fea-c77d4dba0720/</link><pubDate>Mon, 16 Oct 2023 23:59:21 +0000</pubDate><dc:creator>Kai Kimera</dc:creator><category>CMF</category><category>В истории</category><yandex:related><link url="https://lib.onl/ru/2023/10/06c9d359-31f0-5862-a342-62a21d4eb032/">SQL запросы IP.Board 3.x</link><link url="https://lib.onl/ru/2023/10/0743e73e-7c4c-5ab8-bba3-ba70bdb5cdfd/">Условия в файлах IP.Board 2.3</link><link url="https://lib.onl/ru/2023/10/d310a44c-4259-5bef-a7c2-d3d09a5c69f4/">Условия в шаблонах IP.Board 2.3</link><link url="https://lib.onl/ru/2023/10/a7405294-9f0c-52c1-a70e-ce4990079dc7/">Условия в шаблонах IP.Board 3.x</link></yandex:related><turbo:extendedHtml>true</turbo:extendedHtml><turbo:source>https://lib.onl/ru/2023/10/54d4e488-9a8f-55ed-8fea-c77d4dba0720/</turbo:source><turbo:topic>SQL запросы IP.Board 2.3</turbo:topic><turbo:content><![CDATA[<p>Запросы для базы дынных (<span class="shortcode shortcode-tag"><a href="/ru/tags/sql/" target="_blank">#SQL</a></span>) <span class="shortcode shortcode-tag"><a href="/ru/tags/ipb/" target="_blank">#IPB</a></span> 2.3. Информация со старых проектов. Пригодится.</p>
<h2 id="sql-запросы">
  <a class="link-body-emphasis" href="#sql-%d0%b7%d0%b0%d0%bf%d1%80%d0%be%d1%81%d1%8b">SQL запросы</a>
</h2><ol>
<li>Заменить определённый текст во всех сообщениях на форуме.</li>
</ol>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-0
shortcode-codeblock-sql">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-ba65073faaf6517182f8e611ea9fc309" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="k">UPDATE</span><span class="w"> </span><span class="n">ibf_posts</span><span class="w"> </span><span class="k">SET</span><span class="w"> </span><span class="n">post</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">REPLACE</span><span class="p">(</span><span class="n">post</span><span class="p">,</span><span class="s1">&#39;старый текст&#39;</span><span class="p">,</span><span class="s1">&#39;новый текст&#39;</span><span class="p">);</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-ba65073faaf6517182f8e611ea9fc309"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<ol start="2">
<li>Заменить текст во всех описаниях форумов.</li>
</ol>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-1
shortcode-codeblock-sql">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-a5017f5f7e4957f5dacf77521cab6969" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="k">UPDATE</span><span class="w"> </span><span class="n">ibf_forums</span><span class="w"> </span><span class="k">SET</span><span class="w"> </span><span class="n">description</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">REPLACE</span><span class="p">(</span><span class="n">description</span><span class="p">,</span><span class="s1">&#39;старый текст&#39;</span><span class="p">,</span><span class="s1">&#39;новый текст&#39;</span><span class="p">);</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-a5017f5f7e4957f5dacf77521cab6969"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<ol start="3">
<li>Очистка журнала предупреждений конкретного пользователя, где X - вставить id пользователя, чей журнал вы хотите очистить.</li>
</ol>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-2
shortcode-codeblock-sql">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-6d8ba78c6bfa20feb4e63d623af5a47e" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="k">DELETE</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">ibf_warn_logs</span><span class="w"> </span><span class="k">WHERE</span><span class="w"> </span><span class="n">wlog_mid</span><span class="o">=</span><span class="n">X</span><span class="p">;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-6d8ba78c6bfa20feb4e63d623af5a47e"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<ol start="4">
<li>Удалить подписи у всех пользователей.</li>
</ol>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-3
shortcode-codeblock-sql">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-bb732e416aadae2ed11d402da3d2cae9" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="k">UPDATE</span><span class="w"> </span><span class="n">ibf_member_extra</span><span class="w"> </span><span class="k">SET</span><span class="w"> </span><span class="n">signature</span><span class="o">=</span><span class="s1">&#39;Ваша подпись удалена&#39;</span><span class="p">;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-bb732e416aadae2ed11d402da3d2cae9"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<ol start="5">
<li>Удаление модераторов.</li>
</ol>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-4
shortcode-codeblock-sql">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-ba43c746fbbfed16bb973f33b7ad4ef8" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="k">DELETE</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">ibf_moderators</span><span class="p">;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-ba43c746fbbfed16bb973f33b7ad4ef8"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<ol start="6">
<li>Удаление модератора из всех форумов.</li>
</ol>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-5
shortcode-codeblock-sql">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-3f91d1a0b4695b9906fcdcdd4894424d" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="k">DELETE</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">ibf_moderators</span><span class="w"> </span><span class="k">WHERE</span><span class="w"> </span><span class="n">member_id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">XX</span><span class="p">;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-3f91d1a0b4695b9906fcdcdd4894424d"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<ol start="7">
<li>Удаление модератора из определённых форумов.</li>
</ol>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-6
shortcode-codeblock-sql">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-bddc51de8c8c7cb4193633fbaff17ab2" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="k">DELETE</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">ibf_moderators</span><span class="w"> </span><span class="k">WHERE</span><span class="w"> </span><span class="n">member_id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">XX</span><span class="w"> </span><span class="k">AND</span><span class="w"> </span><span class="n">forum_id</span><span class="w"> </span><span class="k">IN</span><span class="w"> </span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="w"> </span><span class="mi">11</span><span class="p">,</span><span class="w"> </span><span class="mi">22</span><span class="p">,</span><span class="w"> </span><span class="mi">25</span><span class="p">);</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-bddc51de8c8c7cb4193633fbaff17ab2"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<ol start="8">
<li>Удаление аватаров у всех пользователей.</li>
</ol>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-7
shortcode-codeblock-sql">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-2a7f604509bac6bf5166a349ce53efc7" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="k">DELETE</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">ibf_member_extra</span><span class="w"> </span><span class="k">WHERE</span><span class="w"> </span><span class="n">avatar_location</span><span class="w"> </span><span class="k">AND</span><span class="w"> </span><span class="n">avatar_size</span><span class="p">;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-2a7f604509bac6bf5166a349ce53efc7"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<ol start="9">
<li>Если не работает, то выполните следующие два запроса:</li>
</ol>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-8
shortcode-codeblock-sql">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-16150aacce1f2497b5bbd734177e01b3" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="k">UPDATE</span><span class="w"> </span><span class="n">ibf_member_extra</span><span class="w"> </span><span class="k">SET</span><span class="w"> </span><span class="n">avatar_location</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;&#39;</span><span class="p">;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-16150aacce1f2497b5bbd734177e01b3"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>











  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-9
shortcode-codeblock-sql">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-f40f069ee67c22b1229354d7130bc056" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="k">UPDATE</span><span class="w"> </span><span class="n">ibf_member_extra</span><span class="w"> </span><span class="k">SET</span><span class="w"> </span><span class="n">avatar_size</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;&#39;</span><span class="p">;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-f40f069ee67c22b1229354d7130bc056"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<ol start="10">
<li>Массовый перенос пользователей c определённым количеством сообщений из одной группы в другую.</li>
</ol>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-10
shortcode-codeblock-sql">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-d4c30d157c4e7039c9ce316476d7d754" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="k">UPDATE</span><span class="w"> </span><span class="n">ibf_members</span><span class="w"> </span><span class="k">SET</span><span class="w"> </span><span class="n">mgroup</span><span class="o">=</span><span class="err">Б</span><span class="w"> </span><span class="k">WHERE</span><span class="w"> </span><span class="n">mgroup</span><span class="o">=</span><span class="err">А</span><span class="w"> </span><span class="k">AND</span><span class="w"> </span><span class="n">posts</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-d4c30d157c4e7039c9ce316476d7d754"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<ol start="11">
<li>Удалить пользователей определенной группы, где b меняете на номер группы.</li>
</ol>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-11
shortcode-codeblock-sql">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-f30d825c3accb83beb684226ec2ce6ff" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="k">DELETE</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">ibf_members</span><span class="w"> </span><span class="k">WHERE</span><span class="w"> </span><span class="n">mgroup</span><span class="o">=</span><span class="s1">&#39;b&#39;</span><span class="p">;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-f30d825c3accb83beb684226ec2ce6ff"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<ol start="12">
<li>Удалить все ICQ номера пользователей.</li>
</ol>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-12
shortcode-codeblock-sql">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-046b4354a4394dafe12b342da0a8853c" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="k">UPDATE</span><span class="w"> </span><span class="n">ibf_member_extra</span><span class="w"> </span><span class="k">SET</span><span class="w"> </span><span class="n">icq_number</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-046b4354a4394dafe12b342da0a8853c"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<ol start="13">
<li>Удалить ссылки на сайт у всех пользователей.</li>
</ol>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-13
shortcode-codeblock-sql">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-12ca5019bfc29d57f93531500d67b670" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="k">UPDATE</span><span class="w"> </span><span class="n">ibf_member_extra</span><span class="w"> </span><span class="k">SET</span><span class="w"> </span><span class="n">website</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-12ca5019bfc29d57f93531500d67b670"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<ol start="14">
<li>Снятие обязательного подтверждения модератором.</li>
</ol>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-14
shortcode-codeblock-sql">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-b74256770f30c8d03affee89d3bb0c06" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="k">UPDATE</span><span class="w"> </span><span class="n">ibf_members</span><span class="w"> </span><span class="k">SET</span><span class="w"> </span><span class="n">mod_posts</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-b74256770f30c8d03affee89d3bb0c06"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<ol start="15">
<li>Снятие только чтение/read_only.</li>
</ol>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-15
shortcode-codeblock-sql">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-6f4fe909fe2b20935336fe14b716c06c" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="k">UPDATE</span><span class="w"> </span><span class="n">ibf_members</span><span class="w"> </span><span class="k">SET</span><span class="w"> </span><span class="n">restrict_post</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-6f4fe909fe2b20935336fe14b716c06c"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<ol start="16">
<li>Очистка журнала.</li>
</ol>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-16
shortcode-codeblock-sql">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-80c6cbddee72209c13a6eba37d4376e5" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="k">DELETE</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">ibf_warn_logs</span><span class="w"> </span><span class="k">WHERE</span><span class="w"> </span><span class="n">wlog_mid</span><span class="o">=</span><span class="n">id_пользователя</span><span class="p">;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-80c6cbddee72209c13a6eba37d4376e5"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<ol start="17">
<li>Удаление всех установленных смайликов, то есть они переходят в список неустановленных смайликов.</li>
</ol>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-17
shortcode-codeblock-sql">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-0c282d00d53cd471649f616ce4c1e6e9" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="k">DELETE</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">ibf_emoticons</span><span class="p">;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-0c282d00d53cd471649f616ce4c1e6e9"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<ol start="18">
<li>Установка кодировки и сравнения БД по умолчанию.</li>
</ol>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-18
shortcode-codeblock-sql">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-66b6edde72a662135a795f24c9c3691d" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="k">ALTER</span><span class="w"> </span><span class="k">DATABASE</span><span class="w"> </span><span class="o">`</span><span class="err">название</span><span class="n">_бд</span><span class="o">`</span><span class="w"> </span><span class="k">DEFAULT</span><span class="w"> </span><span class="nb">CHARACTER</span><span class="w"> </span><span class="k">SET</span><span class="w"> </span><span class="n">cp1251</span><span class="w"> </span><span class="k">COLLATE</span><span class="w"> </span><span class="n">cp1251_general_ci</span><span class="p">;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-66b6edde72a662135a795f24c9c3691d"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<ol start="19">
<li>Аннулируем счётчик сообщений у всех пользователей.</li>
</ol>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-19
shortcode-codeblock-sql">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-dc4bbd4c6935bc99fa8f60f3ea7bf777" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="k">UPDATE</span><span class="w"> </span><span class="n">ibf_members</span><span class="w"> </span><span class="k">SET</span><span class="w"> </span><span class="n">posts</span><span class="o">=</span><span class="s1">&#39;0&#39;</span><span class="p">;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-dc4bbd4c6935bc99fa8f60f3ea7bf777"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<ol start="20">
<li>Аннулируем счётчик сообщений у определённых групп.</li>
</ol>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-20
shortcode-codeblock-sql">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-ce25c1461045eb6864df01aafd5b8947" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="k">UPDATE</span><span class="w"> </span><span class="n">ibf_members</span><span class="w"> </span><span class="k">SET</span><span class="w"> </span><span class="n">posts</span><span class="o">=</span><span class="s1">&#39;0&#39;</span><span class="w"> </span><span class="k">WHERE</span><span class="w"> </span><span class="n">mgroup</span><span class="o">=</span><span class="s1">&#39;номер_группы&#39;</span><span class="p">;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-ce25c1461045eb6864df01aafd5b8947"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<ol start="21">
<li>Удаление всех сообщений оставленных гостями.</li>
</ol>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-21
shortcode-codeblock-sql">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-996d3daaa70440750494e48d30c1371a" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="k">DELETE</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">ibf_posts</span><span class="w"> </span><span class="k">WHERE</span><span class="w"> </span><span class="n">author_id</span><span class="o">=</span><span class="s1">&#39;0&#39;</span><span class="p">;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-996d3daaa70440750494e48d30c1371a"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<ol start="22">
<li>Заменить текст во всех описаниях тем.</li>
</ol>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-22
shortcode-codeblock-sql">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-c66decfb844c4a466964a7f6d295ae66" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="k">UPDATE</span><span class="w"> </span><span class="n">ibf_topics</span><span class="w"> </span><span class="k">SET</span><span class="w"> </span><span class="n">description</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">REPLACE</span><span class="p">(</span><span class="n">description</span><span class="p">,</span><span class="s1">&#39;старый текст&#39;</span><span class="p">,</span><span class="s1">&#39;новый текст&#39;</span><span class="p">);</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-c66decfb844c4a466964a7f6d295ae66"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<h2 id="благодарности">
  <a class="link-body-emphasis" href="#%d0%b1%d0%bb%d0%b0%d0%b3%d0%be%d0%b4%d0%b0%d1%80%d0%bd%d0%be%d1%81%d1%82%d0%b8">Благодарности</a>
</h2><p>В составлении запросов благодарим следующих участников конференции:</p>
<ul>
<li>Mazafuka</li>
<li>КиКиМоРа</li>
<li>a_aqua</li>
<li>Ritsuka</li>
<li>Security</li>
<li>truth</li>
</ul>]]></turbo:content></item><item turbo="true"><title>SQL запросы IP.Board 3.x</title><link>https://lib.onl/ru/2023/10/06c9d359-31f0-5862-a342-62a21d4eb032/</link><pubDate>Mon, 16 Oct 2023 23:55:00 +0000</pubDate><dc:creator>Kai Kimera</dc:creator><category>CMF</category><category>В истории</category><yandex:related><link url="https://lib.onl/ru/2023/10/0743e73e-7c4c-5ab8-bba3-ba70bdb5cdfd/">Условия в файлах IP.Board 2.3</link><link url="https://lib.onl/ru/2023/10/d310a44c-4259-5bef-a7c2-d3d09a5c69f4/">Условия в шаблонах IP.Board 2.3</link><link url="https://lib.onl/ru/2023/10/a7405294-9f0c-52c1-a70e-ce4990079dc7/">Условия в шаблонах IP.Board 3.x</link></yandex:related><turbo:extendedHtml>true</turbo:extendedHtml><turbo:source>https://lib.onl/ru/2023/10/06c9d359-31f0-5862-a342-62a21d4eb032/</turbo:source><turbo:topic>SQL запросы IP.Board 3.x</turbo:topic><turbo:content><![CDATA[<p>Запросы для базы дынных (<span class="shortcode shortcode-tag"><a href="/ru/tags/sql/" target="_blank">#SQL</a></span>) <span class="shortcode shortcode-tag"><a href="/ru/tags/ipb/" target="_blank">#IPB</a></span> 3. Информация со старых проектов. Пригодится.</p>
<h2 id="sql-запросы">
  <a class="link-body-emphasis" href="#sql-%d0%b7%d0%b0%d0%bf%d1%80%d0%be%d1%81%d1%8b">SQL запросы</a>
</h2><ol>
<li>Удалить всех модераторов.</li>
</ol>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-0
shortcode-codeblock-sql">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-a307f70ac875f3289226ae8031cde4c1" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="k">DELETE</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">moderators</span><span class="p">;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-a307f70ac875f3289226ae8031cde4c1"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<ol start="2">
<li>Удалить все подписи.</li>
</ol>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-1
shortcode-codeblock-sql">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-9c93f8a0d3c2c952d8db362459355be9" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="k">DELETE</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">content_cache_sigs</span><span class="p">;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-9c93f8a0d3c2c952d8db362459355be9"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>











  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-2
shortcode-codeblock-sql">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-4e1f5b3b705e03275ec0d8d821c78a96" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="k">UPDATE</span><span class="w"> </span><span class="n">profile_portal</span><span class="w"> </span><span class="k">SET</span><span class="w"> </span><span class="n">signature</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-4e1f5b3b705e03275ec0d8d821c78a96"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<ol start="3">
<li>Массовый перенос пользователей c определённым количеством сообщений из одной группы в другую.</li>
</ol>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-3
shortcode-codeblock-sql">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-8ae0ab26c8c85ee44c5eca22224a9f2e" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="k">UPDATE</span><span class="w"> </span><span class="n">members</span><span class="w"> </span><span class="k">SET</span><span class="w"> </span><span class="n">member_group_id</span><span class="o">=</span><span class="err">Б</span><span class="w"> </span><span class="k">WHERE</span><span class="w"> </span><span class="n">member_group_id</span><span class="o">=</span><span class="err">А</span><span class="w"> </span><span class="k">AND</span><span class="w"> </span><span class="n">posts</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-8ae0ab26c8c85ee44c5eca22224a9f2e"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<ol start="4">
<li>Полный пересчет репутации сообщений и пользователей после ручной правки <code>ibf_reputation_index</code>.</li>
</ol>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-4
shortcode-codeblock-sql">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-94e0b78433b7dad1842bfd61adc37fa5" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="k">TRUNCATE</span><span class="w"> </span><span class="n">ibf_reputation_cache</span><span class="p">;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-94e0b78433b7dad1842bfd61adc37fa5"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>











  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-5
shortcode-codeblock-sql">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-640a3c6beea90debc62e081685b8ebca" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="k">INSERT</span><span class="w"> </span><span class="k">INTO</span><span class="w"> </span><span class="n">ibf_reputation_cache</span><span class="w"> </span><span class="p">(</span><span class="n">app</span><span class="p">,</span><span class="w"> </span><span class="k">type</span><span class="p">,</span><span class="w"> </span><span class="n">type_id</span><span class="p">,</span><span class="w"> </span><span class="n">rep_points</span><span class="p">)</span><span class="w"> </span><span class="k">SELECT</span><span class="w"> </span><span class="n">app</span><span class="p">,</span><span class="w"> </span><span class="k">type</span><span class="p">,</span><span class="w"> </span><span class="n">type_id</span><span class="p">,</span><span class="w"> </span><span class="k">SUM</span><span class="p">(</span><span class="n">rep_rating</span><span class="p">)</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">ibf_reputation_index</span><span class="w"> </span><span class="k">GROUP</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="n">type_id</span><span class="p">;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-640a3c6beea90debc62e081685b8ebca"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>











  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-6
shortcode-codeblock-sql">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-61b0e4b4b8e4d7cdc2e445863a97cd93" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="k">UPDATE</span><span class="w"> </span><span class="n">ibf_profile_portal</span><span class="w"> </span><span class="n">pp</span><span class="w"> </span><span class="k">SET</span><span class="w"> </span><span class="n">pp</span><span class="p">.</span><span class="n">pp_reputation_points</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="k">SELECT</span><span class="w"> </span><span class="k">SUM</span><span class="p">(</span><span class="n">r</span><span class="p">.</span><span class="n">rep_points</span><span class="p">)</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">ibf_posts</span><span class="w"> </span><span class="n">p</span><span class="w"> </span><span class="k">LEFT</span><span class="w"> </span><span class="k">JOIN</span><span class="w"> </span><span class="n">ibf_reputation_cache</span><span class="w"> </span><span class="n">r</span><span class="w"> </span><span class="k">ON</span><span class="w"> </span><span class="n">r</span><span class="p">.</span><span class="n">type_id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">p</span><span class="p">.</span><span class="n">pid</span><span class="w"> </span><span class="k">WHERE</span><span class="w"> </span><span class="n">p</span><span class="p">.</span><span class="n">author_id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">pp</span><span class="p">.</span><span class="n">pp_member_id</span><span class="p">);</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-61b0e4b4b8e4d7cdc2e445863a97cd93"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<ol start="5">
<li>Удаление или замена ненужного мусора из сообщений, например, куски от старых BBCODE.</li>
</ol>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-7
shortcode-codeblock-sql">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-b32ddf7eba6f4010e909295179c7ef3c" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="k">UPDATE</span><span class="w"> </span><span class="n">ibf_posts</span><span class="w"> </span><span class="k">SET</span><span class="w"> </span><span class="n">post</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">REPLACE</span><span class="p">(</span><span class="n">post</span><span class="p">,</span><span class="s2">&#34;original&#34;</span><span class="p">,</span><span class="s2">&#34;replace&#34;</span><span class="p">);</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-b32ddf7eba6f4010e909295179c7ef3c"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<ol start="6">
<li>Удаление или замена информации из подписей пользователей.</li>
</ol>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-8
shortcode-codeblock-sql">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-dea0f0d939c596bb35c951239956c081" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="k">UPDATE</span><span class="w"> </span><span class="n">ibf_profile_portal</span><span class="w"> </span><span class="k">SET</span><span class="w"> </span><span class="n">signature</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">REPLACE</span><span class="p">(</span><span class="n">signature</span><span class="p">,</span><span class="s2">&#34;original&#34;</span><span class="p">,</span><span class="s2">&#34;replace&#34;</span><span class="p">);</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-dea0f0d939c596bb35c951239956c081"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<h2 id="благодарности">
  <a class="link-body-emphasis" href="#%d0%b1%d0%bb%d0%b0%d0%b3%d0%be%d0%b4%d0%b0%d1%80%d0%bd%d0%be%d1%81%d1%82%d0%b8">Благодарности</a>
</h2><p>В составлении запросов благодарим следующих участников конференции:</p>
<ul>
<li>Mazafuka</li>
<li>КиКиМоРа</li>
<li>a_aqua</li>
<li>Ritsuka</li>
<li>Security</li>
<li>truth</li>
</ul>]]></turbo:content></item><item turbo="true"><title>Условия в файлах IP.Board 2.3</title><link>https://lib.onl/ru/2023/10/0743e73e-7c4c-5ab8-bba3-ba70bdb5cdfd/</link><pubDate>Mon, 16 Oct 2023 23:49:40 +0000</pubDate><dc:creator>Kai Kimera</dc:creator><category>CMF</category><category>В истории</category><yandex:related><link url="https://lib.onl/ru/2023/10/d310a44c-4259-5bef-a7c2-d3d09a5c69f4/">Условия в шаблонах IP.Board 2.3</link><link url="https://lib.onl/ru/2023/10/a7405294-9f0c-52c1-a70e-ce4990079dc7/">Условия в шаблонах IP.Board 3.x</link></yandex:related><turbo:extendedHtml>true</turbo:extendedHtml><turbo:source>https://lib.onl/ru/2023/10/0743e73e-7c4c-5ab8-bba3-ba70bdb5cdfd/</turbo:source><turbo:topic>Условия в файлах IP.Board 2.3</turbo:topic><turbo:content><![CDATA[<p>Условия в файлах для <span class="shortcode shortcode-tag"><a href="/ru/tags/ipb/" target="_blank">#IPB</a></span> 2.3. Версия <strong>2.3</strong> ужа давно не актуальна, но информация пусть будет.</p>
<h2 id="условия-в-файлах">
  <a class="link-body-emphasis" href="#%d1%83%d1%81%d0%bb%d0%be%d0%b2%d0%b8%d1%8f-%d0%b2-%d1%84%d0%b0%d0%b9%d0%bb%d0%b0%d1%85">Условия в файлах</a>
</h2><ol>
<li>Показать информацию только для пользователей.</li>
</ol>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-0
shortcode-codeblock-php">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-c5165ec7c1485a743aeb8e50baa4bb9b" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="k">if</span> <span class="p">(</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">ipsclass</span><span class="o">-&gt;</span><span class="na">member</span><span class="p">[</span><span class="s1">&#39;id&#39;</span><span class="p">]</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="cm">/* информация только для пользователей */</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-c5165ec7c1485a743aeb8e50baa4bb9b"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<ol start="2">
<li>Показать информацию только супер-модераторам.</li>
</ol>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-1
shortcode-codeblock-php">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-da98808dcee21ca9fda8a2e9c242e499" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="k">if</span> <span class="p">(</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">ipsclass</span><span class="o">-&gt;</span><span class="na">member</span><span class="p">[</span><span class="s1">&#39;g_is_supmod&#39;</span><span class="p">]</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="cm">/* информация только для супермодераторов */</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-da98808dcee21ca9fda8a2e9c242e499"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<ol start="3">
<li>Показать информацию только администраторам.</li>
</ol>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-2
shortcode-codeblock-php">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-5528288f633a36428cf50aed9145b8f3" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="k">if</span> <span class="p">(</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">ipsclass</span><span class="o">-&gt;</span><span class="na">member</span><span class="p">[</span><span class="s1">&#39;mgroup&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">ipsclass</span><span class="o">-&gt;</span><span class="na">vars</span><span class="p">[</span><span class="s1">&#39;admin_group&#39;</span><span class="p">]</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="cm">/* информация только для администраторов */</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-5528288f633a36428cf50aed9145b8f3"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<ol start="4">
<li>Показать информацию только модераторам.</li>
</ol>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-3
shortcode-codeblock-php">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-c869c07288ba7e7a140228c283725c68" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="k">if</span> <span class="p">(</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">ipsclass</span><span class="o">-&gt;</span><span class="na">member</span><span class="p">[</span><span class="s1">&#39;_moderator&#39;</span><span class="p">]</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="cm">/* информация только для модераторов */</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-c869c07288ba7e7a140228c283725c68"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<ol start="5">
<li>Показать информацию в определённом форуме.</li>
</ol>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-4
shortcode-codeblock-php">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-66f682a9e97db9a3395f4177457ea0ee" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="k">if</span> <span class="p">(</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">ipsclass</span><span class="o">-&gt;</span><span class="na">input</span><span class="p">[</span><span class="s1">&#39;f&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">35</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="cm">/* информация только в опеределённом форуме с ID = 35 */</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-66f682a9e97db9a3395f4177457ea0ee"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<ol start="6">
<li>Показать информацию на определённой странице.</li>
</ol>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-5
shortcode-codeblock-php">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-554cf9605fb9d90311ee4a1ea43c5e90" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="k">if</span> <span class="p">(</span> <span class="nv">$ipsclass</span><span class="o">-&gt;</span><span class="na">input</span><span class="p">[</span><span class="s1">&#39;_low_act&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;home&#39;</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="cm">/* информация только на определённой странице (в данном случае - home) */</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-554cf9605fb9d90311ee4a1ea43c5e90"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<ol start="7">
<li>Пример сложной конструкции с применением <code>&lt;или&gt;</code>.</li>
</ol>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-6
shortcode-codeblock-php">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-831731c0179082f0f3956b6bf26e5398" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="k">if</span> <span class="p">(</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">ipsclass</span><span class="o">-&gt;</span><span class="na">member</span><span class="p">[</span><span class="s1">&#39;id&#39;</span><span class="p">]</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="cm">/* информация только для пользователей */</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="k">else</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="cm">/* информация только для гостей */</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-831731c0179082f0f3956b6bf26e5398"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>]]></turbo:content></item><item turbo="true"><title>Условия в шаблонах IP.Board 2.3</title><link>https://lib.onl/ru/2023/10/d310a44c-4259-5bef-a7c2-d3d09a5c69f4/</link><pubDate>Mon, 16 Oct 2023 23:11:29 +0000</pubDate><dc:creator>Kai Kimera</dc:creator><category>CMF</category><category>В истории</category><yandex:related><link url="https://lib.onl/ru/2023/10/a7405294-9f0c-52c1-a70e-ce4990079dc7/">Условия в шаблонах IP.Board 3.x</link></yandex:related><turbo:extendedHtml>true</turbo:extendedHtml><turbo:source>https://lib.onl/ru/2023/10/d310a44c-4259-5bef-a7c2-d3d09a5c69f4/</turbo:source><turbo:topic>Условия в шаблонах IP.Board 2.3</turbo:topic><turbo:content><![CDATA[<p>Список условий, которые можно использовать в шаблонах <span class="shortcode shortcode-tag"><a href="/ru/tags/ipb/" target="_blank">#IPB</a></span> 2.3. Версия <strong>2.3</strong> уже давно не актуальна, но я всё же решил сохранить информацию в своей библиотеке.</p>
<h2 id="условия-в-шаблонах">
  <a class="link-body-emphasis" href="#%d1%83%d1%81%d0%bb%d0%be%d0%b2%d0%b8%d1%8f-%d0%b2-%d1%88%d0%b0%d0%b1%d0%bb%d0%be%d0%bd%d0%b0%d1%85">Условия в шаблонах</a>
</h2><ol>
<li>Показать информацию только для пользователей.</li>
</ol>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-0
shortcode-codeblock-html">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-395d09ae0589fc96b048ebb9acfc240e" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-html" data-lang="html"><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">if</span><span class="err">=&#34;</span><span class="na">ipb</span><span class="err">.</span><span class="na">member</span><span class="err">[&#39;</span><span class="na">id</span><span class="err">&#39;]</span> <span class="p">&gt;</span> 0&#34;&gt;
</span></span><span class="line"><span class="cl">  <span class="c">&lt;!-- информация только для пользователей --&gt;</span>
</span></span><span class="line"><span class="cl"><span class="p">&lt;/</span><span class="nt">if</span><span class="p">&gt;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-395d09ae0589fc96b048ebb9acfc240e"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<ol start="2">
<li>Показать информацию только для гостей.</li>
</ol>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-1
shortcode-codeblock-html">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-c353b5783869751ef7de9903f8367c36" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-html" data-lang="html"><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">if</span><span class="err">=&#34;</span><span class="na">ipb</span><span class="err">.</span><span class="na">member</span><span class="err">[&#39;</span><span class="na">id</span><span class="err">&#39;]</span> <span class="err">&lt;=</span> <span class="na">0</span><span class="err">&#34;</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="c">&lt;!-- информация только для гостей --&gt;</span>
</span></span><span class="line"><span class="cl"><span class="p">&lt;/</span><span class="nt">if</span><span class="p">&gt;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-c353b5783869751ef7de9903f8367c36"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<ol start="3">
<li>Показать информацию только для группы администраторов.</li>
</ol>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-2
shortcode-codeblock-html">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-7e9d727179584feeab60a37728f413fd" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-html" data-lang="html"><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">if</span><span class="err">=&#34;</span><span class="na">ipb</span><span class="err">.</span><span class="na">member</span><span class="err">[&#39;</span><span class="na">mgroup</span><span class="err">&#39;]</span> <span class="err">==</span> <span class="na">ipb</span><span class="err">.</span><span class="na">vars</span><span class="err">[&#39;</span><span class="na">admin_group</span><span class="err">&#39;]&#34;</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="c">&lt;!-- информация только для группы администраторов --&gt;</span>
</span></span><span class="line"><span class="cl"><span class="p">&lt;/</span><span class="nt">if</span><span class="p">&gt;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-7e9d727179584feeab60a37728f413fd"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<ol start="4">
<li>Показать информацию только для администрации форума.</li>
</ol>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-3
shortcode-codeblock-html">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-5ff49f3b0f36376fe0aa782645381222" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-html" data-lang="html"><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">if</span><span class="err">=&#34;</span><span class="na">ipb</span><span class="err">.</span><span class="na">member</span><span class="err">[&#39;</span><span class="na">mgroup</span><span class="err">&#39;]</span> <span class="err">==</span> <span class="na">ipb</span><span class="err">.</span><span class="na">vars</span><span class="err">[&#39;</span><span class="na">admin_group</span><span class="err">&#39;]</span> <span class="err">||</span> <span class="na">ipb</span><span class="err">.</span><span class="na">member</span><span class="err">[&#39;</span><span class="na">is_mod</span><span class="err">&#39;]</span> <span class="err">||</span> <span class="na">ipb</span><span class="err">.</span><span class="na">member</span><span class="err">[&#39;</span><span class="na">g_is_supmod</span><span class="err">&#39;]</span> <span class="err">==</span> <span class="na">1</span><span class="err">&#34;</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="c">&lt;!-- информация только для администрации (различные группы) --&gt;</span>
</span></span><span class="line"><span class="cl"><span class="p">&lt;/</span><span class="nt">if</span><span class="p">&gt;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-5ff49f3b0f36376fe0aa782645381222"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<ol start="5">
<li>Показать информацию только для определённого пользователя (<code>{id}</code> = ID пользователя).</li>
</ol>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-4
shortcode-codeblock-html">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-cd9f9eab1c2b83c1122cd558818d45a5" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-html" data-lang="html"><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">if</span><span class="err">=&#34;</span><span class="na">ipb</span><span class="err">.</span><span class="na">member</span><span class="err">[&#39;</span><span class="na">id</span><span class="err">&#39;]</span> <span class="err">==</span> <span class="err">{</span><span class="na">id</span><span class="err">}&#34;</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="c">&lt;!-- информация только для пользователя с определённым {id} --&gt;</span>
</span></span><span class="line"><span class="cl"><span class="p">&lt;/</span><span class="nt">if</span><span class="p">&gt;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-cd9f9eab1c2b83c1122cd558818d45a5"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<ol start="6">
<li>Показать информацию только для определённых пользователей (<code>{id}</code> = ID пользователя).</li>
</ol>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-5
shortcode-codeblock-html">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-0572ce360dd042d42513b355ab42e927" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-html" data-lang="html"><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">if</span><span class="err">=&#34;</span><span class="na">ipb</span><span class="err">.</span><span class="na">member</span><span class="err">[&#39;</span><span class="na">id</span><span class="err">&#39;]</span> <span class="err">==</span> <span class="err">{</span><span class="na">id1</span><span class="err">}</span> <span class="err">||</span> <span class="na">ipb</span><span class="err">.</span><span class="na">member</span><span class="err">[&#39;</span><span class="na">id</span><span class="err">&#39;]</span> <span class="err">==</span> <span class="err">{</span><span class="na">id2</span><span class="err">}&#34;</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="c">&lt;!-- информация только для пользователя с {id1} и {id2} --&gt;</span>
</span></span><span class="line"><span class="cl"><span class="p">&lt;/</span><span class="nt">if</span><span class="p">&gt;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-0572ce360dd042d42513b355ab42e927"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<ol start="7">
<li>Показать информацию только для определённой группы (<code>{gid}</code> = ID группы).</li>
</ol>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-6
shortcode-codeblock-html">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-0eef78f24d5e46e298dd302bf340d63f" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-html" data-lang="html"><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">if</span><span class="err">=&#34;</span><span class="na">ipb</span><span class="err">.</span><span class="na">member</span><span class="err">[&#39;</span><span class="na">mgroup</span><span class="err">&#39;]</span> <span class="err">==</span> <span class="err">{</span><span class="na">gid</span><span class="err">}&#34;</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="c">&lt;!-- информация только для определённой группы с {gid} --&gt;</span>
</span></span><span class="line"><span class="cl"><span class="p">&lt;/</span><span class="nt">if</span><span class="p">&gt;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-0eef78f24d5e46e298dd302bf340d63f"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<ol start="8">
<li>Показать информацию тольк для двух определённых групп (<code>{gid}</code> = ID группы).</li>
</ol>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-7
shortcode-codeblock-html">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-70bb5316a90394a01da5c952f20e2163" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-html" data-lang="html"><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">if</span><span class="err">=&#34;</span><span class="na">ipb</span><span class="err">.</span><span class="na">member</span><span class="err">[&#39;</span><span class="na">mgroup</span><span class="err">&#39;]</span> <span class="err">==</span> <span class="err">{</span><span class="na">gid1</span><span class="err">}</span> <span class="err">||</span> <span class="na">ipb</span><span class="err">.</span><span class="na">member</span><span class="err">[&#39;</span><span class="na">mgroup</span><span class="err">&#39;]</span> <span class="err">==</span> <span class="err">{</span><span class="na">gid2</span><span class="err">}&#34;</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="c">&lt;!-- информация только для группы с {gid1} и {gid2} --&gt;</span>
</span></span><span class="line"><span class="cl"><span class="p">&lt;/</span><span class="nt">if</span><span class="p">&gt;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-70bb5316a90394a01da5c952f20e2163"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<ol start="9">
<li>Показать информацию только на определённой странице форума (<code>idx</code> = страница).</li>
</ol>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-8
shortcode-codeblock-html">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-949915758cb5f69d45773c118b1c4459" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-html" data-lang="html"><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">if</span><span class="err">=&#34;</span><span class="na">ipb</span><span class="err">.</span><span class="na">input</span><span class="err">[&#39;</span><span class="na">_low_act</span><span class="err">&#39;]</span> <span class="err">==</span> <span class="err">&#39;</span><span class="na">idx</span><span class="err">&#39;&#34;</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="c">&lt;!-- информация только для определённой страницы форума (index.php?act=idx) --&gt;</span>
</span></span><span class="line"><span class="cl"><span class="p">&lt;/</span><span class="nt">if</span><span class="p">&gt;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-949915758cb5f69d45773c118b1c4459"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<ol start="10">
<li>Показать информацию только в определённом форуме (<code>{fid}</code> = ID форума).</li>
</ol>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-9
shortcode-codeblock-html">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-5a6b10a5f8a5176d9433b26d9b95c61e" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-html" data-lang="html"><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">if</span><span class="err">=&#34;</span><span class="na">ipb</span><span class="err">.</span><span class="na">input</span><span class="err">[&#39;</span><span class="na">showforum</span><span class="err">&#39;]</span> <span class="err">==</span> <span class="err">{</span><span class="na">fid</span><span class="err">}&#34;</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="c">&lt;!-- информация только для определённого форума с {fid} --&gt;</span>
</span></span><span class="line"><span class="cl"><span class="p">&lt;/</span><span class="nt">if</span><span class="p">&gt;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-5a6b10a5f8a5176d9433b26d9b95c61e"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<ol start="11">
<li>Показать информацию только в определённой теме (<code>{tid}</code> = ID темы).</li>
</ol>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-10
shortcode-codeblock-html">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-95a1d25bdea2fb07d8b3b75824e7a114" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-html" data-lang="html"><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">if</span><span class="err">=&#34;</span><span class="na">ipb</span><span class="err">.</span><span class="na">input</span><span class="err">[&#39;</span><span class="na">showtopic</span><span class="err">&#39;]</span> <span class="err">==</span> <span class="err">{</span><span class="na">tid</span><span class="err">}&#34;</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="c">&lt;!-- информация только для определённой темы с {tid} --&gt;</span>
</span></span><span class="line"><span class="cl"><span class="p">&lt;/</span><span class="nt">if</span><span class="p">&gt;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-95a1d25bdea2fb07d8b3b75824e7a114"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<ol start="12">
<li>Показать информацию только в определённом сообщении (<code>{pnid}</code> = номер сообщения).</li>
</ol>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-11
shortcode-codeblock-html">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-c2c676343a6784618d7017c4b3f1f2b1" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-html" data-lang="html"><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">if</span><span class="err">=&#34;$</span><span class="na">post</span><span class="err">[&#39;</span><span class="na">post_count</span><span class="err">&#39;]</span> <span class="err">==</span> <span class="err">{</span><span class="na">pnid</span><span class="err">}&#34;</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="c">&lt;!-- информация только в сообщении с номером {pnid} --&gt;</span>
</span></span><span class="line"><span class="cl"><span class="p">&lt;/</span><span class="nt">if</span><span class="p">&gt;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-c2c676343a6784618d7017c4b3f1f2b1"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<ol start="13">
<li>Показать информацию во всех, кроме определённого сообщения (<code>{pnid}</code> = номер сообщения).</li>
</ol>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-12
shortcode-codeblock-html">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-49874c2fc031a610857bf4e33a648bf8" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-html" data-lang="html"><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">if</span><span class="err">=&#34;$</span><span class="na">post</span><span class="err">[&#39;</span><span class="na">post_count</span><span class="err">&#39;]</span> <span class="err">!=</span> <span class="err">{</span><span class="na">pnid</span><span class="err">}&#34;</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="c">&lt;!-- информация во всех сообщениях, кроме сообщения с номером {pnid} --&gt;</span>
</span></span><span class="line"><span class="cl"><span class="p">&lt;/</span><span class="nt">if</span><span class="p">&gt;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-49874c2fc031a610857bf4e33a648bf8"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<ol start="14">
<li>Показать информацию в определённых сообщениях (<code>1,5,10</code> = номера сообщений).</li>
</ol>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-13
shortcode-codeblock-html">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-19460fe0779f69bc7beb960339b32308" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-html" data-lang="html"><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">if</span><span class="err">=&#34;</span><span class="na">in_array</span><span class="err">($</span><span class="na">post</span><span class="err">[&#39;</span><span class="na">post_count</span><span class="err">&#39;],</span> <span class="na">array</span><span class="err">(</span><span class="na">1</span><span class="err">,</span><span class="na">5</span><span class="err">,</span><span class="na">10</span><span class="err">))&#34;</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="c">&lt;!-- отображение информации в сообщениях 1, 5 и 10 --&gt;</span>
</span></span><span class="line"><span class="cl"><span class="p">&lt;/</span><span class="nt">if</span><span class="p">&gt;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-19460fe0779f69bc7beb960339b32308"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<ol start="15">
<li>Показать информацию только в определённом сообщении пользователя (<code>{id}</code> = ID пользователя).</li>
</ol>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-14
shortcode-codeblock-html">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-a4314e8304dfd20b10c442974de22d55" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-html" data-lang="html"><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">if</span><span class="err">=&#34;$</span><span class="na">author</span><span class="err">[&#39;</span><span class="na">id</span><span class="err">&#39;]</span> <span class="err">==</span> <span class="err">{</span><span class="na">id</span><span class="err">}&#34;</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="c">&lt;!-- информация только в определённом сообщении пользователя с ID = {id} --&gt;</span>
</span></span><span class="line"><span class="cl"><span class="p">&lt;/</span><span class="nt">if</span><span class="p">&gt;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-a4314e8304dfd20b10c442974de22d55"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<ol start="16">
<li>Пример сложной конструкции с применением <code>&lt;или&gt;</code>.</li>
</ol>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-15
shortcode-codeblock-html">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-483dcd28f9721b4ed90cad27d515687b" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-html" data-lang="html"><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">if</span><span class="err">=&#34;</span><span class="na">ipb</span><span class="err">.</span><span class="na">member</span><span class="err">[&#39;</span><span class="na">id</span><span class="err">&#39;]</span> <span class="p">&gt;</span> 0&#34;&gt;
</span></span><span class="line"><span class="cl">  <span class="c">&lt;!-- информация только для пользователей --&gt;</span>
</span></span><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">else</span> <span class="p">/&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="c">&lt;!-- информация только для гостей --&gt;</span>
</span></span><span class="line"><span class="cl"><span class="p">&lt;/</span><span class="nt">if</span><span class="p">&gt;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-483dcd28f9721b4ed90cad27d515687b"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>]]></turbo:content></item><item turbo="true"><title>Условия в шаблонах IP.Board 3.x</title><link>https://lib.onl/ru/2023/10/a7405294-9f0c-52c1-a70e-ce4990079dc7/</link><pubDate>Mon, 16 Oct 2023 23:07:22 +0000</pubDate><dc:creator>Kai Kimera</dc:creator><category>CMF</category><category>В истории</category><turbo:extendedHtml>true</turbo:extendedHtml><turbo:source>https://lib.onl/ru/2023/10/a7405294-9f0c-52c1-a70e-ce4990079dc7/</turbo:source><turbo:topic>Условия в шаблонах IP.Board 3.x</turbo:topic><turbo:content><![CDATA[<p>Список условий, которые можно использовать в шаблонах <span class="shortcode shortcode-tag"><a href="/ru/tags/ipb/" target="_blank">#IPB</a></span> 3.x. Продолжаю находить и публиковать старые заметки со своих давно закрытых ресурсов.</p>
<h2 id="условия-в-шаблонах">
  <a class="link-body-emphasis" href="#%d1%83%d1%81%d0%bb%d0%be%d0%b2%d0%b8%d1%8f-%d0%b2-%d1%88%d0%b0%d0%b1%d0%bb%d0%be%d0%bd%d0%b0%d1%85">Условия в шаблонах</a>
</h2><ol>
<li>Отображение информации в определённом сообщении.</li>
</ol>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-0
shortcode-codeblock-html">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-43d0f3ed46cf33bc56b395963578ab3c" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-html" data-lang="html"><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">if</span> <span class="na">test</span><span class="o">=</span><span class="s">&#34;$post[&#39;post&#39;][&#39;post_count&#39;] == X&#34;</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="c">&lt;!-- информация только в сообщении X --&gt;</span>
</span></span><span class="line"><span class="cl"><span class="p">&lt;/</span><span class="nt">if</span><span class="p">&gt;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-43d0f3ed46cf33bc56b395963578ab3c"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<p>Где:</p>
<ul>
<li><code>X</code> - номер сообщения в теме.</li>
</ul>
<ol start="2">
<li>Отображение информации для определённых групп.</li>
</ol>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-1
shortcode-codeblock-html">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-83a1c1b6ef79f9b063826923568f23c0" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-html" data-lang="html"><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">if</span> <span class="na">test</span><span class="o">=</span><span class="s">&#34;in_array($this-&gt;memberData[&#39;member_group_id&#39;], array( 4,5,6 ) )&#34;</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="c">&lt;!-- информация только для групп ID = 4, 5 и 6 --&gt;</span>
</span></span><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">else</span> <span class="p">/&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="c">&lt;!-- информация для всех остальных --&gt;</span>
</span></span><span class="line"><span class="cl"><span class="p">&lt;/</span><span class="nt">if</span><span class="p">&gt;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-83a1c1b6ef79f9b063826923568f23c0"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<ol start="3">
<li>Пример сложной конструкции с применением <code>&lt;или&gt;</code>.</li>
</ol>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-2
shortcode-codeblock-html">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-e8306e71d8a7f72cafa98d5b14edceda" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-html" data-lang="html"><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">if</span> <span class="na">test</span><span class="o">=</span><span class="s">&#34;memberbox:|:$this-&gt;memberData[&#39;member_id&#39;]&#34;</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="c">&lt;!-- информация только для пользователей --&gt;</span>
</span></span><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">else</span> <span class="p">/&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="c">&lt;!-- информация только для гостей --&gt;</span>
</span></span><span class="line"><span class="cl"><span class="p">&lt;/</span><span class="nt">if</span><span class="p">&gt;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-e8306e71d8a7f72cafa98d5b14edceda"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>]]></turbo:content></item><item turbo="true"><title>Установка сертификата НУЦ Минцифры</title><link>https://lib.onl/ru/2023/10/75075788-9308-56b7-b531-2008cb35f7d0/</link><pubDate>Fri, 06 Oct 2023 11:42:15 +0000</pubDate><dc:creator>Kai Kimera</dc:creator><category>Linux</category><category>MS Windows</category><category>Безопасность</category><yandex:related><link url="https://lib.onl/ru/2022/05/36058650-3f35-5ed5-9565-0aa7d8800c28/">Windows Server 2022 для рабочей станции</link><link url="https://lib.onl/ru/2021/08/ca744dce-e607-52e6-9952-8ae04e052a5b/">Скрипт автоматического удаления устаревших файлов</link></yandex:related><turbo:extendedHtml>true</turbo:extendedHtml><turbo:source>https://lib.onl/ru/2023/10/75075788-9308-56b7-b531-2008cb35f7d0/</turbo:source><turbo:topic>Установка сертификата НУЦ Минцифры</turbo:topic><turbo:content><![CDATA[<p>Рассказываю о нескольких способах установки сертификатов от НУЦ Минцифры. Установка производится в ОС MS <span class="shortcode shortcode-tag"><a href="/ru/tags/windows/" target="_blank">#Windows</a></span> и <span class="shortcode shortcode-tag"><a href="/ru/tags/linux/" target="_blank">#Linux</a></span>.</p>
<h2 id="ms-windows">
  <a class="link-body-emphasis" href="#ms-windows">MS Windows</a>
</h2><h3 id="установка-корневого-сертификата">
  <a class="link-body-emphasis" href="#%d1%83%d1%81%d1%82%d0%b0%d0%bd%d0%be%d0%b2%d0%ba%d0%b0-%d0%ba%d0%be%d1%80%d0%bd%d0%b5%d0%b2%d0%be%d0%b3%d0%be-%d1%81%d0%b5%d1%80%d1%82%d0%b8%d1%84%d0%b8%d0%ba%d0%b0%d1%82%d0%b0">Установка корневого сертификата</a>
</h3><ul>
<li><a title="" href="https://gu-st.ru/content/Other/doc/russian_trusted_root_ca.cer" target="_blank"
   rel="noopener noreferrer">Скачать</a> корневой сертификат.</li>
<li>Открыть скаченный файл <code>russian_trusted_root_ca.cer</code> и нажать кнопку <span class="shortcode shortcode-key d-inline-block"><kbd>Установить сертификат...</kbd></span>.</li>
<li>В <strong>Мастере импорта сертификатов</strong> выбрать <em>Текущий пользователь</em>.
<ul>
<li>Выбрать <em>Поместить все сертификаты в следующее хранилище</em>.</li>
<li>Нажать <span class="shortcode shortcode-key d-inline-block"><kbd>Обзор</kbd></span> и выбрать <em>Доверенные корневые центры сертификации</em>.</li>
<li>В окне <strong>Завершение мастера импорта сертификатов</strong> нажать <span class="shortcode shortcode-key d-inline-block"><kbd>Готово</kbd></span>.</li>
</ul>
</li>
</ul>
<h3 id="установка-выпускающего-сертификата">
  <a class="link-body-emphasis" href="#%d1%83%d1%81%d1%82%d0%b0%d0%bd%d0%be%d0%b2%d0%ba%d0%b0-%d0%b2%d1%8b%d0%bf%d1%83%d1%81%d0%ba%d0%b0%d1%8e%d1%89%d0%b5%d0%b3%d0%be-%d1%81%d0%b5%d1%80%d1%82%d0%b8%d1%84%d0%b8%d0%ba%d0%b0%d1%82%d0%b0">Установка выпускающего сертификата</a>
</h3><ul>
<li><a title="" href="https://gu-st.ru/content/Other/doc/russian_trusted_sub_ca.cer" target="_blank"
   rel="noopener noreferrer">Скачать</a> выпускающий сертификат.</li>
<li>Открыть скаченный файл <code>russian_trusted_sub_ca.cer</code> и нажать кнопку <span class="shortcode shortcode-key d-inline-block"><kbd>Установить сертификат...</kbd></span>.</li>
<li>В <strong>Мастере импорта сертификатов</strong> выбрать <em>Текущий пользователь</em>.
<ul>
<li>Выбрать <em>Автоматически выбрать хранилище на основе типа сертификата</em>.</li>
<li>В окне <strong>Завершение мастера импорта сертификатов</strong> нажать <span class="shortcode shortcode-key d-inline-block"><kbd>Готово</kbd></span>.</li>
</ul>
</li>
</ul>
<h3 id="powershell">
  <a class="link-body-emphasis" href="#powershell">PowerShell</a>
</h3><p>При помощи <span class="shortcode shortcode-tag"><a href="/ru/tags/powershell/" target="_blank">#PowerShell</a></span> можно установить сертификат одной строчкой, состоящей из нескольких команд:</p>
<ul>
<li><code>Invoke-WebRequest</code> - скачивает файл с внешнего веб-ресурса.</li>
<li><code>Import-Certificate</code> - импортирует сертификат в указанное хранилище.</li>
<li><code>${DIR}</code> - переменная, определяющая директорию <code>Downloads</code> (<code>Загрузки</code>) для текущего пользователя.</li>
</ul>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-0
shortcode-codeblock-powershell">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-cf95d41d47198ddd08e70617919caf04" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-powershell" data-lang="powershell"><span class="line"><span class="cl"><span class="p">${</span><span class="n">CERT_ROOT</span><span class="p">}</span> <span class="p">=</span> <span class="s1">&#39;russian_trusted_root_ca.cer&#39;</span><span class="p">;</span> <span class="p">${</span><span class="n">CERT_SUB</span><span class="p">}</span> <span class="p">=</span> <span class="s1">&#39;russian_trusted_sub_ca.cer&#39;</span><span class="p">;</span> <span class="p">${</span><span class="n">DIR</span><span class="p">}</span> <span class="p">=</span> <span class="p">(</span><span class="nb">New-Object</span> <span class="n">-ComObject</span> <span class="n">Shell</span><span class="p">.</span><span class="n">Application</span><span class="p">).</span><span class="py">NameSpace</span><span class="p">(</span><span class="s1">&#39;shell:Downloads&#39;</span><span class="p">).</span><span class="py">Self</span><span class="p">.</span><span class="n">Path</span><span class="p">;</span> <span class="nb">Invoke-WebRequest</span> <span class="s2">&#34;https://gu-st.ru/content/Other/doc/</span><span class="nv">${CERT_ROOT}</span><span class="s2">&#34;</span> <span class="n">-OutFile</span> <span class="s2">&#34;</span><span class="nv">${DIR}</span><span class="s2">\</span><span class="nv">${CERT_ROOT}</span><span class="s2">&#34;</span><span class="p">;</span> <span class="nb">Import-Certificate</span> <span class="n">-FilePath</span> <span class="s2">&#34;</span><span class="nv">${DIR}</span><span class="s2">\</span><span class="nv">${CERT_ROOT}</span><span class="s2">&#34;</span> <span class="n">-CertStoreLocation</span> <span class="s1">&#39;Cert:\CurrentUser\Root&#39;</span><span class="p">;</span> <span class="nb">Invoke-WebRequest</span> <span class="s2">&#34;https://gu-st.ru/content/Other/doc/</span><span class="nv">${CERT_SUB}</span><span class="s2">&#34;</span> <span class="n">-OutFile</span> <span class="s2">&#34;</span><span class="nv">${DIR}</span><span class="s2">\</span><span class="nv">${CERT_SUB}</span><span class="s2">&#34;</span><span class="p">;</span> <span class="nb">Import-Certificate</span> <span class="n">-FilePath</span> <span class="s2">&#34;</span><span class="nv">${DIR}</span><span class="s2">\</span><span class="nv">${CERT_SUB}</span><span class="s2">&#34;</span> <span class="n">-CertStoreLocation</span> <span class="s1">&#39;Cert:\CurrentUser\CA&#39;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-cf95d41d47198ddd08e70617919caf04"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<h2 id="linux">
  <a class="link-body-emphasis" href="#linux">Linux</a>
</h2><p>Для <span class="shortcode shortcode-tag"><a href="/ru/tags/linux/" target="_blank">#Linux</a></span> можно воспользоваться пакетом сертификатов в формате <code>.PEM</code> от <span class="shortcode shortcode-tag">MacOS</span>. Положительным моментом подобного пакета является то, что <span class="shortcode shortcode-tag">PEM</span> содержит в себе сразу два сертификата: корневой и выпускающий.</p>
<h3 id="установка-корневого-и-выпускающего-сертификатов">
  <a class="link-body-emphasis" href="#%d1%83%d1%81%d1%82%d0%b0%d0%bd%d0%be%d0%b2%d0%ba%d0%b0-%d0%ba%d0%be%d1%80%d0%bd%d0%b5%d0%b2%d0%be%d0%b3%d0%be-%d0%b8-%d0%b2%d1%8b%d0%bf%d1%83%d1%81%d0%ba%d0%b0%d1%8e%d1%89%d0%b5%d0%b3%d0%be-%d1%81%d0%b5%d1%80%d1%82%d0%b8%d1%84%d0%b8%d0%ba%d0%b0%d1%82%d0%be%d0%b2">Установка корневого и выпускающего сертификатов</a>
</h3><ul>
<li><a title="" href="https://gu-st.ru/content/Other/doc/russiantrustedca.pem" target="_blank"
   rel="noopener noreferrer">Скачать</a> файл с корневым и выпускающим сертификатами.</li>
<li>Добавить скаченный файл <code>russiantrustedca.pem</code> в хранилище доверенных сертификатов в зависимости от дистрибутива <span class="shortcode shortcode-tag"><a href="/ru/tags/linux/" target="_blank">#Linux</a></span>.
<ul>
<li>DEB-based: <code>/usr/local/share/ca-certificates/</code>.</li>
<li>RHEL-based: <code>/etc/pki/ca-trust/source/anchors/</code>.</li>
<li>Arch Linux: <code>/etc/ca-certificates/trust-source/anchors/</code>.</li>
</ul>
</li>
<li>Обновить хранилище сертификатов следующими командами.
<ul>
<li>DEB-based: <code>update-ca-certificates --fresh</code>.</li>
<li>RHEL-based: <code>update-ca-trust force-enable</code> и <code>update-ca-trust extract</code>.</li>
</ul>
</li>
</ul>
<h3 id="bash">
  <a class="link-body-emphasis" href="#bash">Bash</a>
</h3><p>Установить сертификат можно одной командой. Команды вводится от пользователя <code>root</code>. Как выше приводилось, для <span class="shortcode shortcode-tag"><a href="/ru/tags/deb/" target="_blank">#DEB</a></span>-based и <span class="shortcode shortcode-tag"><a href="/ru/tags/rhel/" target="_blank">#RHEL</a></span>-based дистрибутивов, пути хранилища сертификатов различаются. Поэтому, я привожу две команды под каждые версии дистрибутивов.</p>
<h4 id="deb-based-дистрибутивы">
  <a class="link-body-emphasis" href="#deb-based-%d0%b4%d0%b8%d1%81%d1%82%d1%80%d0%b8%d0%b1%d1%83%d1%82%d0%b8%d0%b2%d1%8b">DEB-based дистрибутивы</a>
</h4>








  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-1
shortcode-codeblock-bash">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-86eead3443703c6a44e17946bb0ee49b" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="nv">CERT</span><span class="o">=</span><span class="s1">&#39;russiantrustedca.pem&#39;</span><span class="p">;</span> curl -o <span class="s2">&#34;/usr/local/share/ca-certificates/</span><span class="si">${</span><span class="nv">CERT</span><span class="si">}</span><span class="s2">&#34;</span> <span class="s2">&#34;https://gu-st.ru/content/Other/doc/</span><span class="si">${</span><span class="nv">CERT</span><span class="si">}</span><span class="s2">&#34;</span> <span class="o">&amp;&amp;</span> update-ca-certificates --fresh</span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-86eead3443703c6a44e17946bb0ee49b"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<h4 id="rhel-based-дистрибутивы">
  <a class="link-body-emphasis" href="#rhel-based-%d0%b4%d0%b8%d1%81%d1%82%d1%80%d0%b8%d0%b1%d1%83%d1%82%d0%b8%d0%b2%d1%8b">RHEL-based дистрибутивы</a>
</h4>








  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-2
shortcode-codeblock-bash">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-48bb3218915983baf318c456f191cf25" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="nv">CERT</span><span class="o">=</span><span class="s1">&#39;russiantrustedca.pem&#39;</span><span class="p">;</span> curl -o <span class="s2">&#34;/etc/pki/ca-trust/source/anchors/</span><span class="si">${</span><span class="nv">CERT</span><span class="si">}</span><span class="s2">&#34;</span> <span class="s2">&#34;https://gu-st.ru/content/Other/doc/</span><span class="si">${</span><span class="nv">CERT</span><span class="si">}</span><span class="s2">&#34;</span> <span class="o">&amp;&amp;</span> update-ca-trust force-enable <span class="o">&amp;&amp;</span> update-ca-trust extract</span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-48bb3218915983baf318c456f191cf25"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>]]></turbo:content></item><item turbo="true"><title>Получение и установка MS Office 2021 LTSC</title><link>https://lib.onl/ru/2023/09/dd5a3e1a-596b-50d5-b070-b2a065f99f32/</link><pubDate>Tue, 26 Sep 2023 17:17:18 +0000</pubDate><dc:creator>Kai Kimera</dc:creator><category>MS Windows</category><category>Скрипты</category><yandex:related><link url="https://lib.onl/ru/2022/05/862226e6-cbb1-58f8-bc8e-0cfef747f475/">Интеграция обновлений в дистрибутив ОС MS Windows</link></yandex:related><turbo:extendedHtml>true</turbo:extendedHtml><turbo:source>https://lib.onl/ru/2023/09/dd5a3e1a-596b-50d5-b070-b2a065f99f32/</turbo:source><turbo:topic>Получение и установка MS Office 2021 LTSC</turbo:topic><turbo:content><![CDATA[<p>MS Office является самым популярным набором приложений для офисной работы. На момент написания этой статьи, актуальной версией MS <span class="shortcode shortcode-tag"><a href="/ru/tags/office/" target="_blank">#Office</a></span> является 2021. Её можно купить в магазине. Но здесь я расскажу как получить актуальную версию MS <span class="shortcode shortcode-tag"><a href="/ru/tags/office/" target="_blank">#Office</a></span> 2021 LTSC с серверов Microsoft.</p>
<p>MS <span class="shortcode shortcode-tag"><a href="/ru/tags/office/" target="_blank">#Office</a></span> 2021 LTSC просто так не купить, это программное обеспечение распространяется для организаций по соглашению о корпоративном лицензировании. MS Office 2021 LTSC поддерживает устройства только с операционными системами MS <span class="shortcode shortcode-tag"><a href="/ru/tags/windows/" target="_blank">#Windows</a></span> 10 или MS <span class="shortcode shortcode-tag"><a href="/ru/tags/windows/" target="_blank">#Windows</a></span> 11.</p>
<h2 id="получение-ms-office-2021-ltsc">
  <a class="link-body-emphasis" href="#%d0%bf%d0%be%d0%bb%d1%83%d1%87%d0%b5%d0%bd%d0%b8%d0%b5-ms-office-2021-ltsc">Получение MS Office 2021 LTSC</a>
</h2><p>Для получения установочного дистрибутива необходимо выполнить подготовительные шаги:</p>
<ol>
<li>Скачать и запустить <a title="" href="https://www.microsoft.com/download/details.aspx?id=49117" target="_blank"
   rel="noopener noreferrer">Office Deployment Tool</a>.</li>
<li>Во время установки, выбрать директорию для распаковки <strong>Office Deployment Tool</strong>. В эту директорию будет в дальнейшем загружен установочный дистрибутив MS Office 2021 LTSC.</li>
<li>После завершения процесса установки, открыть консоль и перейти в директорию (<code>cd &lt;path&gt;</code>), куда был установлен Office Deployment Tool.</li>
<li>В корне директории Office Deployment Tool создать файл <code>office.2021.xml</code> следующего содержания:</li>
</ol>

    

    
        
            
            <div class="shortcode shortcode-file mb-3">
              <div class="card overflow-hidden" data-bs-theme="dark">
                <div class="card-header">
                  <div class="d-flex align-items-center">
                    <div class="flex-shrink-0">
                      <i class="far fa-file-code fa-fw"></i>
                    </div>
                    <div class="flex-grow-1 mx-2 text-truncate">
                      <code>office.2021.xml</code>
                    </div>
                    <div class="flex-shrink-0">
                      <ul class="list-inline mb-0">
                        <li class="list-inline-item" title='Копировать'>
                          <a class="text-body" href="#"
                             data-fn="clipboard" data-clipboard-target="#cp-09f2628ba7e9dfaff8ccb09bf941d819"
                             role="button" aria-label='Копировать'>
                            <i class="fas fa-copy fa-fw"></i>
                          </a>
                        </li>
                        <li class="list-inline-item" title='Скачать'>
                          <a class="text-body" href="/ru/2023/09/dd5a3e1a-596b-50d5-b070-b2a065f99f32/office.2021.xml" download
                             role="button" aria-label='Скачать'>
                            <i class="fas fa-download fa-fw"></i>
                          </a>
                        </li>
                        <li class="list-inline-item" title='Открыть'>
                          <a class="text-body" href="/ru/2023/09/dd5a3e1a-596b-50d5-b070-b2a065f99f32/office.2021.xml" target="_blank"
                             role="button" aria-label='Открыть'>
                            <i class="fas fa-arrow-up-right-from-square fa-fw"></i>
                          </a>
                        </li>
                      </ul>
                    </div>
                  </div>
                </div>
                <div class="card-body p-0 overflow-auto" id="cp-09f2628ba7e9dfaff8ccb09bf941d819">
                    
                        
                    
                    <div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-xml" data-lang="xml"><span class="line"><span class="cl"><span class="nt">&lt;Configuration</span> <span class="na">ID=</span><span class="s">&#34;42865718-c416-4c72-990b-20b6972cb9af&#34;</span><span class="nt">&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="nt">&lt;Add</span> <span class="na">OfficeClientEdition=</span><span class="s">&#34;64&#34;</span> <span class="na">Channel=</span><span class="s">&#34;PerpetualVL2021&#34;</span><span class="nt">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;Product</span> <span class="na">ID=</span><span class="s">&#34;ProPlus2021Volume&#34;</span> <span class="na">PIDKEY=</span><span class="s">&#34;FXYTK-NJJ8C-GB6DW-3DYQT-6F7TH&#34;</span><span class="nt">&gt;</span>
</span></span><span class="line"><span class="cl">      <span class="nt">&lt;Language</span> <span class="na">ID=</span><span class="s">&#34;en-us&#34;</span> <span class="nt">/&gt;</span>
</span></span><span class="line"><span class="cl">      <span class="nt">&lt;Language</span> <span class="na">ID=</span><span class="s">&#34;ru-ru&#34;</span> <span class="nt">/&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;/Product&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;Product</span> <span class="na">ID=</span><span class="s">&#34;VisioPro2021Volume&#34;</span> <span class="na">PIDKEY=</span><span class="s">&#34;KNH8D-FGHT4-T8RK3-CTDYJ-K2HT4&#34;</span><span class="nt">&gt;</span>
</span></span><span class="line"><span class="cl">      <span class="nt">&lt;Language</span> <span class="na">ID=</span><span class="s">&#34;en-us&#34;</span> <span class="nt">/&gt;</span>
</span></span><span class="line"><span class="cl">      <span class="nt">&lt;Language</span> <span class="na">ID=</span><span class="s">&#34;ru-ru&#34;</span> <span class="nt">/&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;/Product&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;Product</span> <span class="na">ID=</span><span class="s">&#34;ProjectPro2021Volume&#34;</span> <span class="na">PIDKEY=</span><span class="s">&#34;FTNWT-C6WBT-8HMGF-K9PRX-QV9H8&#34;</span><span class="nt">&gt;</span>
</span></span><span class="line"><span class="cl">      <span class="nt">&lt;Language</span> <span class="na">ID=</span><span class="s">&#34;en-us&#34;</span> <span class="nt">/&gt;</span>
</span></span><span class="line"><span class="cl">      <span class="nt">&lt;Language</span> <span class="na">ID=</span><span class="s">&#34;ru-ru&#34;</span> <span class="nt">/&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;/Product&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;Product</span> <span class="na">ID=</span><span class="s">&#34;LanguagePack&#34;</span><span class="nt">&gt;</span>
</span></span><span class="line"><span class="cl">      <span class="nt">&lt;Language</span> <span class="na">ID=</span><span class="s">&#34;en-us&#34;</span> <span class="nt">/&gt;</span>
</span></span><span class="line"><span class="cl">      <span class="nt">&lt;Language</span> <span class="na">ID=</span><span class="s">&#34;ru-ru&#34;</span> <span class="nt">/&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;/Product&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;Product</span> <span class="na">ID=</span><span class="s">&#34;ProofingTools&#34;</span><span class="nt">&gt;</span>
</span></span><span class="line"><span class="cl">      <span class="nt">&lt;Language</span> <span class="na">ID=</span><span class="s">&#34;en-us&#34;</span> <span class="nt">/&gt;</span>
</span></span><span class="line"><span class="cl">      <span class="nt">&lt;Language</span> <span class="na">ID=</span><span class="s">&#34;ru-ru&#34;</span> <span class="nt">/&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;/Product&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="nt">&lt;/Add&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="nt">&lt;Property</span> <span class="na">Name=</span><span class="s">&#34;SharedComputerLicensing&#34;</span> <span class="na">Value=</span><span class="s">&#34;0&#34;</span> <span class="nt">/&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="nt">&lt;Property</span> <span class="na">Name=</span><span class="s">&#34;FORCEAPPSHUTDOWN&#34;</span> <span class="na">Value=</span><span class="s">&#34;FALSE&#34;</span> <span class="nt">/&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="nt">&lt;Property</span> <span class="na">Name=</span><span class="s">&#34;DeviceBasedLicensing&#34;</span> <span class="na">Value=</span><span class="s">&#34;0&#34;</span> <span class="nt">/&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="nt">&lt;Property</span> <span class="na">Name=</span><span class="s">&#34;SCLCacheOverride&#34;</span> <span class="na">Value=</span><span class="s">&#34;0&#34;</span> <span class="nt">/&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="nt">&lt;Property</span> <span class="na">Name=</span><span class="s">&#34;AUTOACTIVATE&#34;</span> <span class="na">Value=</span><span class="s">&#34;1&#34;</span> <span class="nt">/&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="nt">&lt;Updates</span> <span class="na">Enabled=</span><span class="s">&#34;TRUE&#34;</span> <span class="nt">/&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="nt">&lt;RemoveMSI</span> <span class="nt">/&gt;</span>
</span></span><span class="line"><span class="cl"><span class="nt">&lt;/Configuration&gt;</span></span></span></code></pre></td></tr></table>
</div>
</div>
                </div>
              </div>
            </div>
        
    
<p>Далее, в консоли выполните команду <code>setup.exe /download office.2021.xml</code>. Команда запускает формирование и скачивание установочного дистрибутива MS Office 2021 LTCS с серверов Microsoft. Команда может не отображать процесс своей работы. После завершения команды, консоль вернёт управление пользователю, тем самым можно контролировать завершение получения установочного дистрибутива.</p>
<h2 id="установка-полной-версии-ms-office-2021-ltsc">
  <a class="link-body-emphasis" href="#%d1%83%d1%81%d1%82%d0%b0%d0%bd%d0%be%d0%b2%d0%ba%d0%b0-%d0%bf%d0%be%d0%bb%d0%bd%d0%be%d0%b9-%d0%b2%d0%b5%d1%80%d1%81%d0%b8%d0%b8-ms-office-2021-ltsc">Установка полной версии MS Office 2021 LTSC</a>
</h2><p>После получения установочного дистрибутива MS Office 2021 LTCS, в той же консоли необходимо выполнить команду <code>setup.exe /configure office.2021.xml</code>. Эта команда запускает процесс установки <strong>полной версии</strong> MS Office 2021 LTCS на компьютер пользователя со всеми дополнительными модулями.</p>
<h2 id="установка-минимальной-версии-ms-office-2021-ltsc">
  <a class="link-body-emphasis" href="#%d1%83%d1%81%d1%82%d0%b0%d0%bd%d0%be%d0%b2%d0%ba%d0%b0-%d0%bc%d0%b8%d0%bd%d0%b8%d0%bc%d0%b0%d0%bb%d1%8c%d0%bd%d0%be%d0%b9-%d0%b2%d0%b5%d1%80%d1%81%d0%b8%d0%b8-ms-office-2021-ltsc">Установка минимальной версии MS Office 2021 LTSC</a>
</h2><p>Для администраторов, которые хотят установить на компьютер пользователя только самые необходимые компоненты (<span class="shortcode shortcode-tag">Access</span>, <span class="shortcode shortcode-tag">Excel</span>, <span class="shortcode shortcode-tag">Outlook</span>, <span class="shortcode shortcode-tag">PowerPoint</span> и <span class="shortcode shortcode-tag">World</span>), предлагаю следующий конфигурационный файл:</p>

    

    
        
            
            <div class="shortcode shortcode-file mb-3">
              <div class="card overflow-hidden" data-bs-theme="dark">
                <div class="card-header">
                  <div class="d-flex align-items-center">
                    <div class="flex-shrink-0">
                      <i class="far fa-file-code fa-fw"></i>
                    </div>
                    <div class="flex-grow-1 mx-2 text-truncate">
                      <code>office.2021.minimal.xml</code>
                    </div>
                    <div class="flex-shrink-0">
                      <ul class="list-inline mb-0">
                        <li class="list-inline-item" title='Копировать'>
                          <a class="text-body" href="#"
                             data-fn="clipboard" data-clipboard-target="#cp-193166297e2ec8942016c0b541cc54d0"
                             role="button" aria-label='Копировать'>
                            <i class="fas fa-copy fa-fw"></i>
                          </a>
                        </li>
                        <li class="list-inline-item" title='Скачать'>
                          <a class="text-body" href="/ru/2023/09/dd5a3e1a-596b-50d5-b070-b2a065f99f32/office.2021.minimal.xml" download
                             role="button" aria-label='Скачать'>
                            <i class="fas fa-download fa-fw"></i>
                          </a>
                        </li>
                        <li class="list-inline-item" title='Открыть'>
                          <a class="text-body" href="/ru/2023/09/dd5a3e1a-596b-50d5-b070-b2a065f99f32/office.2021.minimal.xml" target="_blank"
                             role="button" aria-label='Открыть'>
                            <i class="fas fa-arrow-up-right-from-square fa-fw"></i>
                          </a>
                        </li>
                      </ul>
                    </div>
                  </div>
                </div>
                <div class="card-body p-0 overflow-auto" id="cp-193166297e2ec8942016c0b541cc54d0">
                    
                        
                    
                    <div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-xml" data-lang="xml"><span class="line"><span class="cl"><span class="nt">&lt;Configuration</span> <span class="na">ID=</span><span class="s">&#34;42865718-c416-4c72-990b-20b6972cb9af&#34;</span><span class="nt">&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="nt">&lt;Add</span> <span class="na">OfficeClientEdition=</span><span class="s">&#34;64&#34;</span> <span class="na">Channel=</span><span class="s">&#34;PerpetualVL2021&#34;</span><span class="nt">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;Product</span> <span class="na">ID=</span><span class="s">&#34;ProPlus2021Volume&#34;</span> <span class="na">PIDKEY=</span><span class="s">&#34;FXYTK-NJJ8C-GB6DW-3DYQT-6F7TH&#34;</span><span class="nt">&gt;</span>
</span></span><span class="line"><span class="cl">      <span class="nt">&lt;Language</span> <span class="na">ID=</span><span class="s">&#34;en-us&#34;</span> <span class="nt">/&gt;</span>
</span></span><span class="line"><span class="cl">      <span class="nt">&lt;Language</span> <span class="na">ID=</span><span class="s">&#34;ru-ru&#34;</span> <span class="nt">/&gt;</span>
</span></span><span class="line"><span class="cl">      <span class="nt">&lt;ExcludeApp</span> <span class="na">ID=</span><span class="s">&#34;Lync&#34;</span> <span class="nt">/&gt;</span>
</span></span><span class="line"><span class="cl">      <span class="nt">&lt;ExcludeApp</span> <span class="na">ID=</span><span class="s">&#34;OneDrive&#34;</span> <span class="nt">/&gt;</span>
</span></span><span class="line"><span class="cl">      <span class="nt">&lt;ExcludeApp</span> <span class="na">ID=</span><span class="s">&#34;OneNote&#34;</span> <span class="nt">/&gt;</span>
</span></span><span class="line"><span class="cl">      <span class="nt">&lt;ExcludeApp</span> <span class="na">ID=</span><span class="s">&#34;Publisher&#34;</span> <span class="nt">/&gt;</span>
</span></span><span class="line"><span class="cl">      <span class="nt">&lt;ExcludeApp</span> <span class="na">ID=</span><span class="s">&#34;Teams&#34;</span> <span class="nt">/&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;/Product&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;Product</span> <span class="na">ID=</span><span class="s">&#34;LanguagePack&#34;</span><span class="nt">&gt;</span>
</span></span><span class="line"><span class="cl">      <span class="nt">&lt;Language</span> <span class="na">ID=</span><span class="s">&#34;en-us&#34;</span> <span class="nt">/&gt;</span>
</span></span><span class="line"><span class="cl">      <span class="nt">&lt;Language</span> <span class="na">ID=</span><span class="s">&#34;ru-ru&#34;</span> <span class="nt">/&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;/Product&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;Product</span> <span class="na">ID=</span><span class="s">&#34;ProofingTools&#34;</span><span class="nt">&gt;</span>
</span></span><span class="line"><span class="cl">      <span class="nt">&lt;Language</span> <span class="na">ID=</span><span class="s">&#34;en-us&#34;</span> <span class="nt">/&gt;</span>
</span></span><span class="line"><span class="cl">      <span class="nt">&lt;Language</span> <span class="na">ID=</span><span class="s">&#34;ru-ru&#34;</span> <span class="nt">/&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;/Product&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="nt">&lt;/Add&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="nt">&lt;Property</span> <span class="na">Name=</span><span class="s">&#34;SharedComputerLicensing&#34;</span> <span class="na">Value=</span><span class="s">&#34;0&#34;</span> <span class="nt">/&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="nt">&lt;Property</span> <span class="na">Name=</span><span class="s">&#34;FORCEAPPSHUTDOWN&#34;</span> <span class="na">Value=</span><span class="s">&#34;FALSE&#34;</span> <span class="nt">/&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="nt">&lt;Property</span> <span class="na">Name=</span><span class="s">&#34;DeviceBasedLicensing&#34;</span> <span class="na">Value=</span><span class="s">&#34;0&#34;</span> <span class="nt">/&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="nt">&lt;Property</span> <span class="na">Name=</span><span class="s">&#34;SCLCacheOverride&#34;</span> <span class="na">Value=</span><span class="s">&#34;0&#34;</span> <span class="nt">/&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="nt">&lt;Property</span> <span class="na">Name=</span><span class="s">&#34;AUTOACTIVATE&#34;</span> <span class="na">Value=</span><span class="s">&#34;1&#34;</span> <span class="nt">/&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="nt">&lt;Updates</span> <span class="na">Enabled=</span><span class="s">&#34;TRUE&#34;</span> <span class="nt">/&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="nt">&lt;RemoveMSI</span> <span class="nt">/&gt;</span>
</span></span><span class="line"><span class="cl"><span class="nt">&lt;/Configuration&gt;</span></span></span></code></pre></td></tr></table>
</div>
</div>
                </div>
              </div>
            </div>
        
    
<p>Сохраните его под названием <code>office.2021.minimal.xml</code> и запустите процесс установки при помощи команды <code>setup.exe /configure office.2021.minimal.xml</code>.</p>
<h2 id="создание-собственных-конфигураций">
  <a class="link-body-emphasis" href="#%d1%81%d0%be%d0%b7%d0%b4%d0%b0%d0%bd%d0%b8%d0%b5-%d1%81%d0%be%d0%b1%d1%81%d1%82%d0%b2%d0%b5%d0%bd%d0%bd%d1%8b%d1%85-%d0%ba%d0%be%d0%bd%d1%84%d0%b8%d0%b3%d1%83%d1%80%d0%b0%d1%86%d0%b8%d0%b9">Создание собственных конфигураций</a>
</h2><p>Приведённые выше XML-файлы это файлы конфигураций. Их можно создавать самому при помощи веб-инструмента <a title="" href="https://config.office.com/deploymentsettings" target="_blank"
   rel="noopener noreferrer">Office Deployment Center</a>. На странице создания конфигураций укажите необходимые параметры и настройки, и нажмите кнопку <span class="shortcode shortcode-key d-inline-block"><kbd>Импорт</kbd></span>.</p>
<p>Полученный XML-файл можно указывать в командах <code>setup.exe /download &lt;XML_FILE&gt;</code> и <code>setup.exe /configure &lt;XML_FILE&gt;</code> для конфигурирования установочного дистрибутива.</p>
<h2 id="активация-при-помощи-kms-сервера">
  <a class="link-body-emphasis" href="#%d0%b0%d0%ba%d1%82%d0%b8%d0%b2%d0%b0%d1%86%d0%b8%d1%8f-%d0%bf%d1%80%d0%b8-%d0%bf%d0%be%d0%bc%d0%be%d1%89%d0%b8-kms-%d1%81%d0%b5%d1%80%d0%b2%d0%b5%d1%80%d0%b0">Активация при помощи KMS-сервера</a>
</h2><p>Если в сети вашей организации присутствует KMS-сервер, установленный MS Office 2021 можно активировать при помощи этого сервера.</p>




    










    
    




<div class="shortcode shortcode-alert">
  <div class="alert alert-success d-flex overflow-hidden" role="alert">
    <div class="flex-shrink-0 align-self-center">
      <i class="fas fa-lightbulb fa-fw fa-2x"></i>
    </div>
    <div class="flex-grow-1 ms-3 overflow-hidden">
        <p>Подобным способом активируются следующие версии MS Office:</p>
<ul>
<li>Microsoft Office 2016 Volume License Pack.</li>
<li>Microsoft Office 2019 Volume License Pack.</li>
<li>Microsoft Office LTSC 2021 Volume License Pack.</li>
</ul>

    </div>
  </div>
</div>

<p>Для активации MS Office при помощи KMS-сервера, необходимо открыть консоль и перейти в директорию с файлом <code>ospp.vbs</code>. Обычно, этот файл находится в директории <code>\Program Files\Microsoft Office\Office16</code>. После того, как консоль будет находится в необходимой директории с файлом <code>ospp.vbs</code>, можно выполнять следующие команды в зависимости от задачи.</p>
<ol>
<li>Указать адрес KMS-сервера для клиента MS Office:</li>
</ol>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-0
shortcode-codeblock-powershell">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-d6e15d84dd84af2ea7b9ef892b05367b" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-powershell" data-lang="powershell"><span class="line"><span class="cl"><span class="n">cscript</span> <span class="n">ospp</span><span class="p">.</span><span class="py">vbs</span> <span class="p">/</span><span class="n">sethst</span><span class="err">:</span><span class="n">kms</span><span class="p">.</span><span class="py">example</span><span class="p">.</span><span class="n">com</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-d6e15d84dd84af2ea7b9ef892b05367b"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<ol start="2">
<li>Указать нестандартный порт (<code>1689</code>) KMS-сервера:</li>
</ol>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-1
shortcode-codeblock-powershell">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-f45cb27aebe132975287fae065e12646" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-powershell" data-lang="powershell"><span class="line"><span class="cl"><span class="n">cscript</span> <span class="n">ospp</span><span class="p">.</span><span class="py">vbs</span> <span class="p">/</span><span class="n">setprt</span><span class="err">:</span><span class="mf">1689</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-f45cb27aebe132975287fae065e12646"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<ol start="3">
<li>Выполнить активацию MS Office на KMS-сервере:</li>
</ol>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-2
shortcode-codeblock-powershell">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-175df826df780020a6e46cc815677823" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-powershell" data-lang="powershell"><span class="line"><span class="cl"><span class="n">cscript</span> <span class="n">ospp</span><span class="p">.</span><span class="py">vbs</span> <span class="p">/</span><span class="n">act</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-175df826df780020a6e46cc815677823"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<ol start="4">
<li>Узнать текущий статус активации MS Office:</li>
</ol>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-3
shortcode-codeblock-powershell">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-4845106c99d4d0dcd33641ce674f9f99" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-powershell" data-lang="powershell"><span class="line"><span class="cl"><span class="n">cscript</span> <span class="n">ospp</span><span class="p">.</span><span class="py">vbs</span> <span class="p">/</span><span class="n">dstatusall</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-4845106c99d4d0dcd33641ce674f9f99"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<p>В интернете можно найти открытые KMS-серверы для нелегальной активации MS Office. Но подобные действия имеют противоправный характер. <span class="shortcode shortcode-emoji">😜</span></p>]]></turbo:content></item><item turbo="true"><title>Включение DNS over TLS (DoT) в OPNsense</title><link>https://lib.onl/ru/2022/08/badb30a9-0471-5dab-a422-85422c0ac611/</link><pubDate>Sun, 14 Aug 2022 18:16:34 +0000</pubDate><dc:creator>Kai Kimera</dc:creator><category>Сеть</category><yandex:related><link url="https://lib.onl/ru/2021/05/ee559a6c-5cde-5166-9d2d-3ceb55878eb8/">Debian: Статический IP-адрес</link></yandex:related><turbo:extendedHtml>true</turbo:extendedHtml><turbo:source>https://lib.onl/ru/2022/08/badb30a9-0471-5dab-a422-85422c0ac611/</turbo:source><turbo:topic>Включение DNS over TLS (DoT) в OPNsense</turbo:topic><turbo:content><![CDATA[<p>Почитав несколько статей на тему <span class="shortcode shortcode-tag"><a href="/ru/tags/dot/" target="_blank">#DoT</a></span>, я решил написать небольшую заметку по настройки <span class="shortcode shortcode-tag"><a href="/ru/tags/opnsense/" target="_blank">#OPNsense</a></span> на использование этого протокола.</p>
<p><strong>DNS поверх TLS</strong> или <span class="shortcode shortcode-tag"><a href="/ru/tags/dot/" target="_blank">#DoT</a></span> это протокол, при помощи которого происходит шифрование запросов и ответов к <span class="shortcode shortcode-tag"><a href="/ru/tags/dns/" target="_blank">#DNS</a></span> через <span class="shortcode shortcode-tag"><a href="/ru/tags/tls/" target="_blank">#TLS</a></span>. Таким образом, повышается конфиденциальность и безопасность пользователей в интернете.</p>
<p>Не все публичные сервера поддерживают <span class="shortcode shortcode-tag"><a href="/ru/tags/dot/" target="_blank">#DoT</a></span>. Список наиболее предпочтительных, по моему мнению, я приведу в таблице в конце статьи. А теперь, по пунктам, я расскажу как правильно настроить <span class="shortcode shortcode-tag"><a href="/ru/tags/opnsense/" target="_blank">#OPNsense</a></span>, чтобы она задействовала протокол <span class="shortcode shortcode-tag"><a href="/ru/tags/dot/" target="_blank">#DoT</a></span> в своей работе. Для этого нужно выполнить всего несколько шагов&hellip;</p>
<h2 id="настройка-opnsense">
  <a class="link-body-emphasis" href="#%d0%bd%d0%b0%d1%81%d1%82%d1%80%d0%be%d0%b9%d0%ba%d0%b0-opnsense">Настройка OPNsense</a>
</h2><ul>
<li>System / Settings / General
<ul>
<li>Удалить все записи о DNS, если они имеются.</li>
<li>Отключить параметр <strong>Allow DNS server list to be overridden by DHCP/PPP on WAN</strong>.</li>
<li>Отключить параметр <strong>Do not use the local DNS service as a nameserver for this system</strong>.</li>
</ul>
</li>
<li>Services / Unbound DNS / General
<ul>
<li>Включить сервис, поставив галочку напротив <strong>Enable</strong>.</li>
<li>Выбрать в параметре <strong>Network Interfaces</strong> пункт локальной сети, в данном случае, <em>LAN</em>.</li>
<li>Включить <strong>DNSSEC</strong>, поставив галочку напротив парамера <strong>Enable DNSSEC Support</strong>.</li>
<li>Остальные параметры можно не трогать.</li>
</ul>
</li>
<li>Services / Unbound DNS / DNS over TLS
<ul>
<li>Добавить публичные сервера DNS из списка ниже.</li>
</ul>
</li>
</ul>
<h2 id="публичные-сервера-dns">
  <a class="link-body-emphasis" href="#%d0%bf%d1%83%d0%b1%d0%bb%d0%b8%d1%87%d0%bd%d1%8b%d0%b5-%d1%81%d0%b5%d1%80%d0%b2%d0%b5%d1%80%d0%b0-dns">Публичные сервера DNS</a>
</h2><p>Ниже я привожу список публичных серверов <span class="shortcode shortcode-tag"><a href="/ru/tags/dns/" target="_blank">#DNS</a></span>, которые поддерживают функцию DNS over TLS (<span class="shortcode shortcode-tag"><a href="/ru/tags/dot/" target="_blank">#DoT</a></span>).</p>
<h3 id="cloudflare">
  <a class="link-body-emphasis" href="#cloudflare">Cloudflare</a>
</h3>




<table class='table table-striped table-bordered table-responsive w-50'>
  <thead>
      <tr>
          <th>Server IP</th>
          <th>Server Port</th>
          <th>Verify CN</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>1.1.1.1</td>
          <td>853</td>
          <td>cloudflare-dns.com</td>
      </tr>
      <tr>
          <td>1.0.0.1</td>
          <td>853</td>
          <td>cloudflare-dns.com</td>
      </tr>
      <tr>
          <td>2606:4700:4700::1111</td>
          <td>853</td>
          <td>cloudflare-dns.com</td>
      </tr>
      <tr>
          <td>2606:4700:4700::1001</td>
          <td>853</td>
          <td>cloudflare-dns.com</td>
      </tr>
  </tbody>
</table>


<h3 id="google">
  <a class="link-body-emphasis" href="#google">Google</a>
</h3>




<table class='table table-striped table-bordered table-responsive w-50'>
  <thead>
      <tr>
          <th>Server IP</th>
          <th>Server Port</th>
          <th>Verify CN</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>8.8.8.8</td>
          <td>853</td>
          <td>dns.google</td>
      </tr>
      <tr>
          <td>8.8.4.4</td>
          <td>853</td>
          <td>dns.google</td>
      </tr>
      <tr>
          <td>2001:4860:4860::8888</td>
          <td>853</td>
          <td>dns.google</td>
      </tr>
      <tr>
          <td>2001:4860:4860::8844</td>
          <td>853</td>
          <td>dns.google</td>
      </tr>
  </tbody>
</table>


<h3 id="quad9">
  <a class="link-body-emphasis" href="#quad9">Quad9</a>
</h3>




<table class='table table-striped table-bordered table-responsive w-50'>
  <thead>
      <tr>
          <th>Server IP</th>
          <th>Server Port</th>
          <th>Verify CN</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>9.9.9.9</td>
          <td>853</td>
          <td>dns.quad9.net</td>
      </tr>
      <tr>
          <td>149.112.112.112</td>
          <td>853</td>
          <td>dns.quad9.net</td>
      </tr>
      <tr>
          <td>2620:fe::fe</td>
          <td>853</td>
          <td>dns.quad9.net</td>
      </tr>
      <tr>
          <td>2620:fe::9</td>
          <td>853</td>
          <td>dns.quad9.net</td>
      </tr>
  </tbody>
</table>


<h3 id="cisco-umbrella">
  <a class="link-body-emphasis" href="#cisco-umbrella">Cisco Umbrella</a>
</h3>




<table class='table table-striped table-bordered table-responsive w-50'>
  <thead>
      <tr>
          <th>Server IP</th>
          <th>Server Port</th>
          <th>Verify CN</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>208.67.222.222</td>
          <td>853</td>
          <td>dns.opendns.com</td>
      </tr>
      <tr>
          <td>208.67.220.220</td>
          <td>853</td>
          <td>dns.opendns.com</td>
      </tr>
      <tr>
          <td>2620:119:35::35</td>
          <td>853</td>
          <td>dns.opendns.com</td>
      </tr>
      <tr>
          <td>2620:119:53::53</td>
          <td>853</td>
          <td>dns.opendns.com</td>
      </tr>
  </tbody>
</table>


<h3 id="cleanbrowsing">
  <a class="link-body-emphasis" href="#cleanbrowsing">CleanBrowsing</a>
</h3>




<table class='table table-striped table-bordered table-responsive w-50'>
  <thead>
      <tr>
          <th>Server IP</th>
          <th>Server Port</th>
          <th>Verify CN</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>185.228.168.9</td>
          <td>853</td>
          <td>security-filter-dns.cleanbrowsing.org</td>
      </tr>
      <tr>
          <td>185.228.169.9</td>
          <td>853</td>
          <td>security-filter-dns.cleanbrowsing.org</td>
      </tr>
      <tr>
          <td>2a0d:2a00:1::2</td>
          <td>853</td>
          <td>security-filter-dns.cleanbrowsing.org</td>
      </tr>
      <tr>
          <td>2a0d:2a00:2::2</td>
          <td>853</td>
          <td>security-filter-dns.cleanbrowsing.org</td>
      </tr>
  </tbody>
</table>


<h3 id="adguard-dns">
  <a class="link-body-emphasis" href="#adguard-dns">AdGuard DNS</a>
</h3>




<table class='table table-striped table-bordered table-responsive w-50'>
  <thead>
      <tr>
          <th>Server IP</th>
          <th>Server Port</th>
          <th>Verify CN</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>94.140.14.14</td>
          <td>853</td>
          <td>dns.adguard-dns.com</td>
      </tr>
      <tr>
          <td>94.140.15.15</td>
          <td>853</td>
          <td>dns.adguard-dns.com</td>
      </tr>
      <tr>
          <td>2a10:50c0::ad1:ff</td>
          <td>853</td>
          <td>dns.adguard-dns.com</td>
      </tr>
      <tr>
          <td>2a10:50c0::ad2:ff</td>
          <td>853</td>
          <td>dns.adguard-dns.com</td>
      </tr>
  </tbody>
</table>]]></turbo:content></item><item turbo="true"><title>Интеграция обновлений в дистрибутив ОС MS Windows</title><link>https://lib.onl/ru/2022/05/862226e6-cbb1-58f8-bc8e-0cfef747f475/</link><pubDate>Mon, 09 May 2022 12:39:47 +0000</pubDate><dc:creator>Kai Kimera</dc:creator><category>MS Windows</category><category>Терминал</category><category>Скрипты</category><turbo:extendedHtml>true</turbo:extendedHtml><turbo:source>https://lib.onl/ru/2022/05/862226e6-cbb1-58f8-bc8e-0cfef747f475/</turbo:source><turbo:topic>Интеграция обновлений в дистрибутив ОС MS Windows</turbo:topic><turbo:content><![CDATA[<p>Microsoft каждый месяц выпускает новые версии дистрибутивов с уже интегрированными обновлениями. Но есть редакции ОС, например <span class="shortcode shortcode-tag">LTSC</span>, для которых Microsoft не выполняет подобные действия. Приходится делать самому&hellip;</p>
<h2 id="подготовка">
  <a class="link-body-emphasis" href="#%d0%bf%d0%be%d0%b4%d0%b3%d0%be%d1%82%d0%be%d0%b2%d0%ba%d0%b0">Подготовка</a>
</h2><p>Для интеграции обновлений в дистрибутив ОС, потребуется:</p>
<ul>
<li>Дистрибутив операционной системы в файле <code>.iso</code>.</li>
<li>Доступ в интернет для скачивания необходимых инструментов и обновлений.</li>
<li>Рекомендуется <span class="shortcode shortcode-tag"><a href="/ru/tags/ssd/" target="_blank">#SSD</a></span>. Все ниже приведённые этапы требуют активной работы с файлами. Поэтому, существенное ускорение можно получить выполняя все задачи на <span class="shortcode shortcode-tag"><a href="/ru/tags/ssd/" target="_blank">#SSD</a></span>.</li>
</ul>
<h3 id="структура-директорий">
  <a class="link-body-emphasis" href="#%d1%81%d1%82%d1%80%d1%83%d0%ba%d1%82%d1%83%d1%80%d0%b0-%d0%b4%d0%b8%d1%80%d0%b5%d0%ba%d1%82%d0%be%d1%80%d0%b8%d0%b9">Структура директорий</a>
</h3><p>Для начала необходимо создать структуру директорий, которая послужит базисом для процесса интеграции обновлений:</p>
<ul>
<li><code>C:\BuildFarm</code> - корневая директория для работы.
<ul>
<li><code>\MNT</code> - директория, в которую будет монтироваться образ WIM.</li>
<li><code>\UPD</code> - директория для хранения скаченных обновлений.</li>
<li><code>\WIM</code> - директория для хранения образа WIM.</li>
</ul>
</li>
</ul>
<h3 id="ms-dism">
  <a class="link-body-emphasis" href="#ms-dism">MS DISM</a>
</h3><p>Для интеграции обновлений потребуется инструмент <strong>Deployment Image Servicing and Management (DISM)</strong> (<code>DISM.exe</code>), который входит в комплект <a title="" href="https://learn.microsoft.com/en-us/windows-hardware/get-started/adk-install" target="_blank"
   rel="noopener noreferrer">Windows Assessment and Deployment Kit (Windows ADK)</a>. Обычно, DISM уже поставляется с операционной системой, но я рекомендую <a title="" href="https://learn.microsoft.com/en-us/windows-hardware/get-started/adk-install#other-adk-downloads" target="_blank"
   rel="noopener noreferrer">скачивать</a> последнюю версию с сайта Microsoft и устанавливать вручную.</p>
<p>Когда Windows ADK установлен, <span class="shortcode shortcode-tag"><a href="/ru/tags/dism/" target="_blank">#DISM</a></span> можно найти в меню <strong>&ldquo;Пуск&rdquo;</strong> вместе с остальными программам. Запускать <span class="shortcode shortcode-tag"><a href="/ru/tags/dism/" target="_blank">#DISM</a></span> необходимо под администратором. Все команды, приведённые ниже, должны будут выполняться только через установленный вручную <span class="shortcode shortcode-tag"><a href="/ru/tags/dism/" target="_blank">#DISM</a></span>. Использовать <span class="shortcode shortcode-tag"><a href="/ru/tags/dism/" target="_blank">#DISM</a></span>, поставляемый с операционной системой нет необходимости.</p>




    










    
    




<div class="shortcode shortcode-alert">
  <div class="alert alert-success d-flex overflow-hidden" role="alert">
    <div class="flex-shrink-0 align-self-center">
      <i class="fas fa-lightbulb fa-fw fa-2x"></i>
    </div>
    <div class="flex-grow-1 ms-3 overflow-hidden">
        <p>Установленный вручную <!-- raw HTML omitted --><!-- raw HTML omitted -->#DISM<!-- raw HTML omitted --><!-- raw HTML omitted --> можно найти в меню &ldquo;Пуск&rdquo; / Windows Kits / <strong>Среда средств развертывания и работы с образами</strong>.</p>

    </div>
  </div>
</div>

<h2 id="интеграция-обновлений">
  <a class="link-body-emphasis" href="#%d0%b8%d0%bd%d1%82%d0%b5%d0%b3%d1%80%d0%b0%d1%86%d0%b8%d1%8f-%d0%be%d0%b1%d0%bd%d0%be%d0%b2%d0%bb%d0%b5%d0%bd%d0%b8%d0%b9">Интеграция обновлений</a>
</h2><p>Обновления можно скачивать с сайта-каталога <a title="" href="https://www.catalog.update.microsoft.com/" target="_blank"
   rel="noopener noreferrer">Microsoft Update Catalog</a>. Я беру так называемые &ldquo;кумулятивные (накопительные) обновления&rdquo; (cumulative updates), содержащие в себе сразу множество пакетов с исправлениями и обновлениями функций. <a title="" href="https://www.catalog.update.microsoft.com/Search.aspx?q=cumulative%20update" target="_blank"
   rel="noopener noreferrer">Найти</a> такие крупные обновления можно в каталоге при помощи поискового запроса <code>cumulative update</code>.</p>
<p>Скачиваемые обновления помещаются в директорию <code>C:\BuildFarm\UPD</code> для дальнейшей интеграции в дистрибутив ОС.</p>
<h3 id="извлечение-файла-wim-из-дистрибутива-ms-windows">
  <a class="link-body-emphasis" href="#%d0%b8%d0%b7%d0%b2%d0%bb%d0%b5%d1%87%d0%b5%d0%bd%d0%b8%d0%b5-%d1%84%d0%b0%d0%b9%d0%bb%d0%b0-wim-%d0%b8%d0%b7-%d0%b4%d0%b8%d1%81%d1%82%d1%80%d0%b8%d0%b1%d1%83%d1%82%d0%b8%d0%b2%d0%b0-ms-windows">Извлечение файла WIM из дистрибутива MS Windows</a>
</h3><p>Образ ОС находится в специальном файле <code>sources\install.wim</code>. Его необходимо извлечь при помощи программ для работы с файлами <code>.iso</code> (подойдёт <a title="" href="https://www.ultraiso.com" target="_blank"
   rel="noopener noreferrer">UltraISO</a> или <a title="" href="https://www.poweriso.com" target="_blank"
   rel="noopener noreferrer">PowerISO</a>) в директорию <code>C:\BuildFarm\WIM</code>.</p>
<h3 id="получение-информации-из-wim-образа">
  <a class="link-body-emphasis" href="#%d0%bf%d0%be%d0%bb%d1%83%d1%87%d0%b5%d0%bd%d0%b8%d0%b5-%d0%b8%d0%bd%d1%84%d0%be%d1%80%d0%bc%d0%b0%d1%86%d0%b8%d0%b8-%d0%b8%d0%b7-wim-%d0%be%d0%b1%d1%80%d0%b0%d0%b7%d0%b0">Получение информации из WIM-образа</a>
</h3><p>Файл <code>install.wim</code> может содержать несколько редакций ОС. Каждая редакция ОС имеет свой индекс. Для того, чтобы увидеть эти индексы, нужно ввести команду:</p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-0
shortcode-codeblock-powershell">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-7561b55b3ea078b0f8784bf88e6b33aa" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-powershell" data-lang="powershell"><span class="line"><span class="cl"><span class="n">Dism</span> <span class="p">/</span><span class="nb">Get-ImageInfo</span> <span class="p">/</span><span class="n">ImageFile</span><span class="err">:</span><span class="s2">&#34;C:\BuildFarm\WIM\install.wim&#34;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-7561b55b3ea078b0f8784bf88e6b33aa"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<p>Где:</p>
<ul>
<li><code>/Get-ImageInfo</code> - получить информацию о версиях операционной системы, находящихся в WIM-образ.</li>
<li><code>/ImageFile</code> - путь к WIM-образу.</li>
</ul>
<p>Введённая команда предоставит примерно такой выхлоп:</p>











<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-1 shortcode-codeblock-terminal
shortcode-codeblock-terminal-windows
shortcode-codeblock-terminal-windows-root">
  <div class="card overflow-hidden" data-bs-theme="dark">
    <div class="card-header">
      <div class="d-flex align-items-center">
        <div class="flex-shrink-0 text-danger">
          <i class="fas fa-terminal fa-fw"></i>
        </div>
        <div class="flex-grow-1 mx-2">
          <h5 class="mb-0">Терминал</h5>
        </div>
        <div class="flex-shrink-0">
          <ul class="list-inline mb-0">
            <li class="list-inline-item" title='Копировать'>
              <a class="text-body" href="#"
                 data-fn="clipboard" data-clipboard-target="#cp-f1fd5942509a10409f4969ece48c16fc"
                 role="button" aria-label='Копировать'>
                <i class="fas fa-copy fa-fw"></i>
              </a>
            </li>
          </ul>
        </div>
      </div>
    </div>
    <div class="card-body p-0 overflow-auto" id="cp-f1fd5942509a10409f4969ece48c16fc"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-plaintext" data-lang="plaintext"><span class="line"><span class="cl">Dism /Get-ImageInfo /ImageFile:&#34;C:\BuildFarm\WIM\install.wim&#34;
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Details for image : C:\BuildFarm\WIM\install.wim
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Index : 1
</span></span><span class="line"><span class="cl">Name : Windows 10 Education
</span></span><span class="line"><span class="cl">Description : Windows 10 Education
</span></span><span class="line"><span class="cl">Size : 15,643,499,526 bytes
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Index : 2
</span></span><span class="line"><span class="cl">Name : Windows 10 Education N
</span></span><span class="line"><span class="cl">Description : Windows 10 Education N
</span></span><span class="line"><span class="cl">Size : 14,878,972,660 bytes
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Index : 3
</span></span><span class="line"><span class="cl">Name : Windows 10 Enterprise
</span></span><span class="line"><span class="cl">Description : Windows 10 Enterprise
</span></span><span class="line"><span class="cl">Size : 15,643,653,521 bytes
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Index : 4
</span></span><span class="line"><span class="cl">Name : Windows 10 Enterprise N
</span></span><span class="line"><span class="cl">Description : Windows 10 Enterprise N
</span></span><span class="line"><span class="cl">Size : 14,878,878,937 bytes
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Index : 5
</span></span><span class="line"><span class="cl">Name : Windows 10 Pro
</span></span><span class="line"><span class="cl">Description : Windows 10 Pro
</span></span><span class="line"><span class="cl">Size : 15,658,943,281 bytes
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">&lt;...&gt;
</span></span><span class="line"><span class="cl">Extract Specific Windows Index from Windows 10 Multiple Edition ISO</span></span></code></pre></td></tr></table>
</div>
</div></div>
  </div>
</div>
<h3 id="монтирование-wim-образа">
  <a class="link-body-emphasis" href="#%d0%bc%d0%be%d0%bd%d1%82%d0%b8%d1%80%d0%be%d0%b2%d0%b0%d0%bd%d0%b8%d0%b5-wim-%d0%be%d0%b1%d1%80%d0%b0%d0%b7%d0%b0">Монтирование WIM-образа</a>
</h3><p>Индексы получены. Теперь необходимо примонтировать редакцию ОС из конкретного индекса. Выбор индекса зависит от вас: выбираете индекс той редакции ОС, которая вам необходима. Я выбрал редакцию <strong>Windows 10 Pro</strong> с индексом <code>5</code>:</p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-2
shortcode-codeblock-powershell">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-cc29b4b1e6f6afd8253ccbd514611502" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-powershell" data-lang="powershell"><span class="line"><span class="cl"><span class="n">Dism</span> <span class="p">/</span><span class="nb">Mount-Image</span> <span class="p">/</span><span class="n">ImageFile</span><span class="err">:</span><span class="s2">&#34;C:\BuildFarm\WIM\install.wim&#34;</span> <span class="p">/</span><span class="n">MountDir</span><span class="err">:</span><span class="s2">&#34;C:\BuildFarm\MNT&#34;</span> <span class="p">/</span><span class="n">index</span><span class="err">:</span><span class="mf">5</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-cc29b4b1e6f6afd8253ccbd514611502"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<p>Где:</p>
<ul>
<li><code>/Mount-Image</code> - команда на монтирование <span class="shortcode shortcode-tag">WIM</span>-образа.</li>
<li><code>/MountDir</code> - путь к директории, в которую необходимо поместить содержимое монтируемого <span class="shortcode shortcode-tag">WIM</span>-образа.</li>
<li><code>/index:5</code> - номер версии дистрибутива ОС. Номер можно узнать командой <code>/Get-ImageInfo</code>.</li>
</ul>




    










    
    




<div class="shortcode shortcode-alert">
  <div class="alert alert-success d-flex overflow-hidden" role="alert">
    <div class="flex-shrink-0 align-self-center">
      <i class="fas fa-lightbulb fa-fw fa-2x"></i>
    </div>
    <div class="flex-grow-1 ms-3 overflow-hidden">
        <p>Если что-то пошло не так, размонтировать образ без сохранения можно следующей командой:</p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-0
shortcode-codeblock-bat">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-8a434dec6f94d2fa4a03c07de62cd2ca" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bat" data-lang="bat"><span class="line"><span class="cl">Dism /Unmount-Image /MountDir:<span class="s2">&#34;C:\BuildFarm\MNT&#34;</span> /Discard</span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-8a434dec6f94d2fa4a03c07de62cd2ca"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<p>Проверить список примонтированных образов можно следующей командой:</p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-1
shortcode-codeblock-bat">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-3ada68ca34f8a3de16e36688628603c2" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bat" data-lang="bat"><span class="line"><span class="cl">Dism /Get-MountedImageInfo</span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-3ada68ca34f8a3de16e36688628603c2"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<p>Если после размонтирования образ всё ещё остаётся подключённым к системе и является повреждённым, следующая команда можешь помочь:</p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-2
shortcode-codeblock-bat">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-35c37cb2f2746ca192733c6a44b903d6" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bat" data-lang="bat"><span class="line"><span class="cl">Dism /Cleanup-Mountpoints</span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-35c37cb2f2746ca192733c6a44b903d6"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<p>Она удалит все ресурсы, связанные с повреждённым образом и очистит систему от &ldquo;зависших&rdquo; точек монтирования.</p>

    </div>
  </div>
</div>

<h3 id="интеграция-обновлений-в-wim-образ">
  <a class="link-body-emphasis" href="#%d0%b8%d0%bd%d1%82%d0%b5%d0%b3%d1%80%d0%b0%d1%86%d0%b8%d1%8f-%d0%be%d0%b1%d0%bd%d0%be%d0%b2%d0%bb%d0%b5%d0%bd%d0%b8%d0%b9-%d0%b2-wim-%d0%be%d0%b1%d1%80%d0%b0%d0%b7">Интеграция обновлений в WIM-образ</a>
</h3><p>После монтирования редакции ОС с конкретным индексом, можно начинать процесс интеграции обновлений:</p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-3
shortcode-codeblock-powershell">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-1956ed49f63f711799dbd2528822b571" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-powershell" data-lang="powershell"><span class="line"><span class="cl"><span class="n">Dism</span> <span class="p">/</span><span class="n">Image</span><span class="err">:</span><span class="s2">&#34;C:\BuildFarm\MNT&#34;</span> <span class="p">/</span><span class="nb">Add-Package</span> <span class="p">/</span><span class="n">PackagePath</span><span class="err">:</span><span class="s2">&#34;C:\BuildFarm\UPD&#34;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-1956ed49f63f711799dbd2528822b571"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<p>Где:</p>
<ul>
<li><code>/Image</code> - путь к директории, в которой находится содержимое примонтированного WIM-образа.</li>
<li><code>/Add-Package</code> - команда на добавление пакетов (обновлений) в WIM-образ.
<ul>
<li><code>/PackagePath</code> - путь к директории, в которой находятся пакеты (обновления) для интеграции в WIM-образ.</li>
</ul>
</li>
</ul>
<h3 id="проверка-корректности-интеграции-обновлений-опционально">
  <a class="link-body-emphasis" href="#%d0%bf%d1%80%d0%be%d0%b2%d0%b5%d1%80%d0%ba%d0%b0-%d0%ba%d0%be%d1%80%d1%80%d0%b5%d0%ba%d1%82%d0%bd%d0%be%d1%81%d1%82%d0%b8-%d0%b8%d0%bd%d1%82%d0%b5%d0%b3%d1%80%d0%b0%d1%86%d0%b8%d0%b8-%d0%be%d0%b1%d0%bd%d0%be%d0%b2%d0%bb%d0%b5%d0%bd%d0%b8%d0%b9-%d0%be%d0%bf%d1%86%d0%b8%d0%be%d0%bd%d0%b0%d0%bb%d1%8c%d0%bd%d0%be">Проверка корректности интеграции обновлений (опционально)</a>
</h3><p>По окончании процесса интеграции, можно проверить корректность выполненной задачи. Команда ниже покажет список пакетов, установленных в примонтированной редакции ОС. В этом списке пакетов будут интегрированные обновления.</p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-4
shortcode-codeblock-powershell">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-a55b3bbe77af32ee3c93c33437e3189b" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-powershell" data-lang="powershell"><span class="line"><span class="cl"><span class="n">Dism</span> <span class="p">/</span><span class="n">Image</span><span class="err">:</span><span class="s2">&#34;C:\BuildFarm\MNT&#34;</span> <span class="p">/</span><span class="nb">Get-Packages</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-a55b3bbe77af32ee3c93c33437e3189b"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<p>Где:</p>
<ul>
<li><code>/Image</code> - путь к директории, в которой находится содержимое примонтированного <span class="shortcode shortcode-tag">WIM</span>-образа.</li>
<li><code>/Get-Packages</code> - команда для получения информации о интегрированных пакетах примонтированного <span class="shortcode shortcode-tag">WIM</span>-образа.</li>
</ul>
<h3 id="очистка-хранилища-компонентов-wim-образ-опционально">
  <a class="link-body-emphasis" href="#%d0%be%d1%87%d0%b8%d1%81%d1%82%d0%ba%d0%b0-%d1%85%d1%80%d0%b0%d0%bd%d0%b8%d0%bb%d0%b8%d1%89%d0%b0-%d0%ba%d0%be%d0%bc%d0%bf%d0%be%d0%bd%d0%b5%d0%bd%d1%82%d0%be%d0%b2-wim-%d0%be%d0%b1%d1%80%d0%b0%d0%b7-%d0%be%d0%bf%d1%86%d0%b8%d0%be%d0%bd%d0%b0%d0%bb%d1%8c%d0%bd%d0%be">Очистка хранилища компонентов WIM-образ (опционально)</a>
</h3><p>Для уменьшения размера дистрибутива можно запустить процедуру удаления предыдущих версий компонентов, которые были изменены (заменены) установленными обновлениями:</p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-5
shortcode-codeblock-powershell">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-119b0e8540a4acc75c6fccf80bc53bdc" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-powershell" data-lang="powershell"><span class="line"><span class="cl"><span class="n">Dism</span> <span class="p">/</span><span class="n">Image</span><span class="err">:</span><span class="s2">&#34;C:\BuildFarm\MNT&#34;</span> <span class="p">/</span><span class="nb">Cleanup-Image</span> <span class="p">/</span><span class="n">StartComponentCleanup</span> <span class="p">/</span><span class="n">ResetBase</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-119b0e8540a4acc75c6fccf80bc53bdc"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<p>Где:</p>
<ul>
<li><code>/Image</code> - путь к директории, в которой находится содержимое примонтированного <span class="shortcode shortcode-tag">WIM</span>-образа.</li>
<li><code>/Cleanup-Image</code> - очистка и восстановление образа.
<ul>
<li><code>/StartComponentCleanup</code> - удаляет заменённые компоненты и уменьшает размер хранилища компонентов.
<ul>
<li><code>/ResetBase</code> - сброс базы заменяемых компонентов.</li>
</ul>
</li>
</ul>
</li>
</ul>
<h3 id="проверка-хранилища-компонентов-wim-образа-опционально">
  <a class="link-body-emphasis" href="#%d0%bf%d1%80%d0%be%d0%b2%d0%b5%d1%80%d0%ba%d0%b0-%d1%85%d1%80%d0%b0%d0%bd%d0%b8%d0%bb%d0%b8%d1%89%d0%b0-%d0%ba%d0%be%d0%bc%d0%bf%d0%be%d0%bd%d0%b5%d0%bd%d1%82%d0%be%d0%b2-wim-%d0%be%d0%b1%d1%80%d0%b0%d0%b7%d0%b0-%d0%be%d0%bf%d1%86%d0%b8%d0%be%d0%bd%d0%b0%d0%bb%d1%8c%d0%bd%d0%be">Проверка хранилища компонентов WIM-образа (опционально)</a>
</h3><p>Опциональный шаг перед заключительным этапом - проверить системные компоненты и файлы на повреждения:</p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-6
shortcode-codeblock-powershell">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-45c2649ab61da132ca0fcc8b62893a44" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-powershell" data-lang="powershell"><span class="line"><span class="cl"><span class="n">Dism</span> <span class="p">/</span><span class="n">Image</span><span class="err">:</span><span class="s2">&#34;C:\BuildFarm\MNT&#34;</span> <span class="p">/</span><span class="nb">Cleanup-Image</span> <span class="p">/</span><span class="n">ScanHealth</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-45c2649ab61da132ca0fcc8b62893a44"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<p>Где:</p>
<ul>
<li><code>/Image</code> - путь к директории, в которой находится содержимое примонтированного <span class="shortcode shortcode-tag">WIM</span>-образа.</li>
<li><code>/Cleanup-Image</code> - очистка и восстановление образа.
<ul>
<li><code>/ScanHealth</code> - сканирование образа на наличие повреждений хранилища компонентов.</li>
</ul>
</li>
</ul>
<h3 id="сохранение-изменений-в-wim-образе">
  <a class="link-body-emphasis" href="#%d1%81%d0%be%d1%85%d1%80%d0%b0%d0%bd%d0%b5%d0%bd%d0%b8%d0%b5-%d0%b8%d0%b7%d0%bc%d0%b5%d0%bd%d0%b5%d0%bd%d0%b8%d0%b9-%d0%b2-wim-%d0%be%d0%b1%d1%80%d0%b0%d0%b7%d0%b5">Сохранение изменений в WIM-образе</a>
</h3><p>После выполнения всех действий, необходимо отмонтировать редакцию ОС с сохранением изменений. Делается это командой:</p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-7
shortcode-codeblock-powershell">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-9f07942c9826e01ad3a87212c4089c59" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-powershell" data-lang="powershell"><span class="line"><span class="cl"><span class="n">Dism</span> <span class="p">/</span><span class="nb">Unmount-Image</span> <span class="p">/</span><span class="n">MountDir</span><span class="err">:</span><span class="s2">&#34;C:\BuildFarm\MNT&#34;</span> <span class="p">/</span><span class="n">Commit</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-9f07942c9826e01ad3a87212c4089c59"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<p>Где:</p>
<ul>
<li><code>/Unmount-Image</code> - команда для отмонтирования <span class="shortcode shortcode-tag">WIM</span>-образа.</li>
<li><code>/MountDir</code> - путь к директории, в которой находится содержимое примонтированного <span class="shortcode shortcode-tag">WIM</span>-образа.</li>
<li><code>/Commit</code> - сохранение совершённых изменений в <span class="shortcode shortcode-tag">WIM</span>-образе.</li>
</ul>
<p>Всё. Мы получили файл <code>install.wim</code> с интегрированными обновлениями. Теперь этот файл <code>install.wim</code> необходимо обратно упаковать в образ <span class="shortcode shortcode-tag">ISO</span> с заменой старого.</p>
<h2 id="автоматизация">
  <a class="link-body-emphasis" href="#%d0%b0%d0%b2%d1%82%d0%be%d0%bc%d0%b0%d1%82%d0%b8%d0%b7%d0%b0%d1%86%d0%b8%d1%8f">Автоматизация</a>
</h2><p>Я люблю автоматизировать всё по максимуму. И здесь я не упустил шанс написать небольшой скрипт с деревянной логикой, который сделает все шаги по интеграции обновлений за человека. Только вот, извлечь файл <code>install.wim</code> из <span class="shortcode shortcode-tag">ISO</span>-образа придётся самому.</p>

    

    
        
            
            <div class="shortcode shortcode-file mb-3">
              <div class="card overflow-hidden" data-bs-theme="dark">
                <div class="card-header">
                  <div class="d-flex align-items-center">
                    <div class="flex-shrink-0">
                      <i class="far fa-file-code fa-fw"></i>
                    </div>
                    <div class="flex-grow-1 mx-2 text-truncate">
                      <code>dism.packages.bat</code>
                    </div>
                    <div class="flex-shrink-0">
                      <ul class="list-inline mb-0">
                        <li class="list-inline-item" title='Копировать'>
                          <a class="text-body" href="#"
                             data-fn="clipboard" data-clipboard-target="#cp-fceef7bfb6ef314c336b3b69eb2fa723"
                             role="button" aria-label='Копировать'>
                            <i class="fas fa-copy fa-fw"></i>
                          </a>
                        </li>
                        <li class="list-inline-item" title='Скачать'>
                          <a class="text-body" href="/ru/2022/05/862226e6-cbb1-58f8-bc8e-0cfef747f475/dism.packages.bat" download
                             role="button" aria-label='Скачать'>
                            <i class="fas fa-download fa-fw"></i>
                          </a>
                        </li>
                        <li class="list-inline-item" title='Открыть'>
                          <a class="text-body" href="/ru/2022/05/862226e6-cbb1-58f8-bc8e-0cfef747f475/dism.packages.bat" target="_blank"
                             role="button" aria-label='Открыть'>
                            <i class="fas fa-arrow-up-right-from-square fa-fw"></i>
                          </a>
                        </li>
                      </ul>
                    </div>
                  </div>
                </div>
                <div class="card-body p-0 overflow-auto" id="cp-fceef7bfb6ef314c336b3b69eb2fa723">
                    
                        
                    
                    <div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span><span class="lnt">56
</span><span class="lnt">57
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bat" data-lang="bat"><span class="line"><span class="cl"><span class="c1">rem # Automatic integration of updates into DISM.</span>
</span></span><span class="line"><span class="cl"><span class="c1">rem #</span>
</span></span><span class="line"><span class="cl"><span class="c1">rem # @package   CMD</span>
</span></span><span class="line"><span class="cl"><span class="c1">rem # @author    Kai Kimera &lt;mail@kai.kim&gt;</span>
</span></span><span class="line"><span class="cl"><span class="c1">rem # @copyright 2023 Library Online</span>
</span></span><span class="line"><span class="cl"><span class="c1">rem # @license   MIT</span>
</span></span><span class="line"><span class="cl"><span class="c1">rem # @version   0.1.0</span>
</span></span><span class="line"><span class="cl"><span class="c1">rem # @link      https://lib.onl/ru/2022/05/862226e6-cbb1-58f8-bc8e-0cfef747f475/</span>
</span></span><span class="line"><span class="cl"><span class="c1">rem # ---------------------------------------------------------------------------------------------------------------- #</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="p">@</span><span class="k">echo</span> off
</span></span><span class="line"><span class="cl"><span class="k">set</span> <span class="nv">d_mnt</span><span class="p">=</span><span class="s2">&#34;</span><span class="nv">%~dp0</span><span class="s2">MNT&#34;</span>
</span></span><span class="line"><span class="cl"><span class="k">set</span> <span class="nv">d_upd</span><span class="p">=</span><span class="s2">&#34;</span><span class="nv">%~dp0</span><span class="s2">UPD&#34;</span>
</span></span><span class="line"><span class="cl"><span class="k">set</span> <span class="nv">d_wim</span><span class="p">=</span><span class="s2">&#34;</span><span class="nv">%~dp0</span><span class="s2">WIM&#34;</span>
</span></span><span class="line"><span class="cl"><span class="k">set</span> <span class="nv">f_wim</span><span class="p">=</span><span class="s2">&#34;</span><span class="nv">%d_wim%</span><span class="s2">\install.wim&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">rem Creating directories.</span>
</span></span><span class="line"><span class="cl"><span class="k">if</span> <span class="k">not</span> <span class="k">exist</span> <span class="s2">&#34;</span><span class="nv">%d_mnt%</span><span class="s2">&#34;</span> <span class="k">mkdir</span> <span class="s2">&#34;</span><span class="nv">%d_mnt%</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl"><span class="k">if</span> <span class="k">not</span> <span class="k">exist</span> <span class="s2">&#34;</span><span class="nv">%d_upd%</span><span class="s2">&#34;</span> <span class="k">mkdir</span> <span class="s2">&#34;</span><span class="nv">%d_upd%</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl"><span class="k">if</span> <span class="k">not</span> <span class="k">exist</span> <span class="s2">&#34;</span><span class="nv">%d_wim%</span><span class="s2">&#34;</span> <span class="k">mkdir</span> <span class="s2">&#34;</span><span class="nv">%d_wim%</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">rem Checking files.</span>
</span></span><span class="line"><span class="cl"><span class="k">if</span> <span class="k">not</span> <span class="k">exist</span> <span class="s2">&#34;</span><span class="nv">%f_wim%</span><span class="s2">&#34;</span> <span class="k">echo</span> Please put <span class="s2">&#34;install.wim&#34;</span> file in <span class="s2">&#34;WIM&#34;</span> directory... <span class="p">&amp;&amp;</span> <span class="k">pause</span>
</span></span><span class="line"><span class="cl"><span class="k">if</span> <span class="k">not</span> <span class="k">exist</span> <span class="s2">&#34;</span><span class="nv">%d_upd%</span><span class="s2">/*.msu&#34;</span> <span class="k">echo</span> Please put <span class="s2">&#34;*.msu&#34;</span> files in <span class="s2">&#34;UPD&#34;</span> directory... <span class="p">&amp;&amp;</span> <span class="k">pause</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">if</span> <span class="k">exist</span> <span class="s2">&#34;</span><span class="nv">%f_wim%</span><span class="s2">&#34;</span> <span class="p">(</span>
</span></span><span class="line"><span class="cl">  <span class="k">echo</span> Getting Windows Image Info...
</span></span><span class="line"><span class="cl">  Dism /Get-ImageInfo /ImageFile:<span class="s2">&#34;</span><span class="nv">%f_wim%</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl"><span class="p">)</span> <span class="k">else</span> <span class="p">(</span>
</span></span><span class="line"><span class="cl">  <span class="k">echo</span> <span class="s2">&#34;install.wim&#34;</span> not found! <span class="p">&amp;</span> <span class="k">echo</span>.Failed with error #<span class="nv">%errorlevel%</span>.
</span></span><span class="line"><span class="cl">  <span class="k">goto</span> <span class="p">:</span><span class="nl">error</span>
</span></span><span class="line"><span class="cl"><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">set</span> <span class="k">/p</span> <span class="nv">index</span><span class="p">=</span><span class="s2">&#34;Enter INDEX: &#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">echo</span> Mounting Windows image...
</span></span><span class="line"><span class="cl">Dism /Mount-Image /ImageFile:<span class="s2">&#34;</span><span class="nv">%f_wim%</span><span class="s2">&#34;</span> /MountDir:<span class="s2">&#34;</span><span class="nv">%d_mnt%</span><span class="s2">&#34;</span> /index:<span class="nv">%index%</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">echo</span> Adding Windows packages...
</span></span><span class="line"><span class="cl">Dism /Image:<span class="s2">&#34;</span><span class="nv">%d_mnt%</span><span class="s2">&#34;</span> /Add-Package /PackagePath:<span class="s2">&#34;</span><span class="nv">%d_upd%</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">echo</span> Getting Windows packages...
</span></span><span class="line"><span class="cl">Dism /Image:<span class="s2">&#34;</span><span class="nv">%d_mnt%</span><span class="s2">&#34;</span> /Get-Packages
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">echo</span> Reseting Windows image...
</span></span><span class="line"><span class="cl">Dism /Image:<span class="s2">&#34;</span><span class="nv">%d_mnt%</span><span class="s2">&#34;</span> /Cleanup-Image /StartComponentCleanup /ResetBase
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">echo</span> Scaning health Windows image...
</span></span><span class="line"><span class="cl">Dism /Image:<span class="s2">&#34;</span><span class="nv">%d_mnt%</span><span class="s2">&#34;</span> /Cleanup-Image /ScanHealth
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">echo</span> Saving Windows image...
</span></span><span class="line"><span class="cl">Dism /Unmount-Image /MountDir:<span class="s2">&#34;</span><span class="nv">%d_mnt%</span><span class="s2">&#34;</span> /Commit
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">exit</span> /b 0
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="p">:</span><span class="nl">error</span>
</span></span><span class="line"><span class="cl"><span class="k">exit</span> /b <span class="nv">%errorlevel%</span></span></span></code></pre></td></tr></table>
</div>
</div>
                </div>
              </div>
            </div>
        
    
<p>Поместить скрипт нужно в корень директории <code>BuildFarm</code> и запустить из терминала <span class="shortcode shortcode-tag"><a href="/ru/tags/dism/" target="_blank">#DISM</a></span>. Если же возникнут какие-либо проблемы, ниже есть небольшой скрипт, который размонтирует образ и очистит систему от точек монтирования.</p>

    

    
        
            
            <div class="shortcode shortcode-file mb-3">
              <div class="card overflow-hidden" data-bs-theme="dark">
                <div class="card-header">
                  <div class="d-flex align-items-center">
                    <div class="flex-shrink-0">
                      <i class="far fa-file-code fa-fw"></i>
                    </div>
                    <div class="flex-grow-1 mx-2 text-truncate">
                      <code>dism.unmount.bat</code>
                    </div>
                    <div class="flex-shrink-0">
                      <ul class="list-inline mb-0">
                        <li class="list-inline-item" title='Копировать'>
                          <a class="text-body" href="#"
                             data-fn="clipboard" data-clipboard-target="#cp-1649f41270eac946eb37db303176176b"
                             role="button" aria-label='Копировать'>
                            <i class="fas fa-copy fa-fw"></i>
                          </a>
                        </li>
                        <li class="list-inline-item" title='Скачать'>
                          <a class="text-body" href="/ru/2022/05/862226e6-cbb1-58f8-bc8e-0cfef747f475/dism.unmount.bat" download
                             role="button" aria-label='Скачать'>
                            <i class="fas fa-download fa-fw"></i>
                          </a>
                        </li>
                        <li class="list-inline-item" title='Открыть'>
                          <a class="text-body" href="/ru/2022/05/862226e6-cbb1-58f8-bc8e-0cfef747f475/dism.unmount.bat" target="_blank"
                             role="button" aria-label='Открыть'>
                            <i class="fas fa-arrow-up-right-from-square fa-fw"></i>
                          </a>
                        </li>
                      </ul>
                    </div>
                  </div>
                </div>
                <div class="card-body p-0 overflow-auto" id="cp-1649f41270eac946eb37db303176176b">
                    
                        
                    
                    <div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bat" data-lang="bat"><span class="line"><span class="cl"><span class="c1">rem # Automatic unmounting WIM images into DISM.</span>
</span></span><span class="line"><span class="cl"><span class="c1">rem #</span>
</span></span><span class="line"><span class="cl"><span class="c1">rem # @package   CMD</span>
</span></span><span class="line"><span class="cl"><span class="c1">rem # @author    Kai Kimera &lt;mail@kai.kim&gt;</span>
</span></span><span class="line"><span class="cl"><span class="c1">rem # @copyright 2023 Library Online</span>
</span></span><span class="line"><span class="cl"><span class="c1">rem # @license   MIT</span>
</span></span><span class="line"><span class="cl"><span class="c1">rem # @version   0.1.0</span>
</span></span><span class="line"><span class="cl"><span class="c1">rem # @link      https://lib.onl/ru/2022/05/862226e6-cbb1-58f8-bc8e-0cfef747f475/</span>
</span></span><span class="line"><span class="cl"><span class="c1">rem # ---------------------------------------------------------------------------------------------------------------- #</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="p">@</span><span class="k">echo</span> off
</span></span><span class="line"><span class="cl"><span class="k">set</span> <span class="nv">d_mnt</span><span class="p">=</span><span class="s2">&#34;</span><span class="nv">%~dp0</span><span class="s2">MNT&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">echo</span> Unmounting <span class="s2">&#34;install.wim&#34;</span> and discards changes that were made when image was mounted...
</span></span><span class="line"><span class="cl">Dism /Unmount-Image /MountDir:<span class="s2">&#34;</span><span class="nv">%d_mnt%</span><span class="s2">&#34;</span> /Discard
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">echo</span> Deleting all of resources associated with a mounted image that has been corrupted...
</span></span><span class="line"><span class="cl">Dism /Cleanup-Mountpoints
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">echo</span> Getting information about mounted image...
</span></span><span class="line"><span class="cl">Dism /Get-MountedImageInfo
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">exit</span> /b 0</span></span></code></pre></td></tr></table>
</div>
</div>
                </div>
              </div>
            </div>]]></turbo:content></item><item turbo="true"><title>Windows Server 2022 для рабочей станции</title><link>https://lib.onl/ru/2022/05/36058650-3f35-5ed5-9565-0aa7d8800c28/</link><pubDate>Mon, 09 May 2022 11:53:26 +0000</pubDate><dc:creator>Kai Kimera</dc:creator><category>MS Windows</category><turbo:extendedHtml>true</turbo:extendedHtml><turbo:source>https://lib.onl/ru/2022/05/36058650-3f35-5ed5-9565-0aa7d8800c28/</turbo:source><turbo:topic>Windows Server 2022 для рабочей станции</turbo:topic><turbo:content><![CDATA[<p>В этой небольшой заметке я расскажу, как перенастроить серверную версию ОС <span class="shortcode shortcode-tag"><a href="/ru/tags/windows/" target="_blank">#Windows</a></span> для работы на обычном стационарном ПК.</p>
<h2 id="настройка-служб">
  <a class="link-body-emphasis" href="#%d0%bd%d0%b0%d1%81%d1%82%d1%80%d0%be%d0%b9%d0%ba%d0%b0-%d1%81%d0%bb%d1%83%d0%b6%d0%b1">Настройка служб</a>
</h2><p>На сервере нет необходимости использовать поисковые механизмы и вывод звука, поэтому они отключены. Но на рабочей станции эти параметры необходимы. Для включения звука и поискового механизма, необходимо настроить запуск соответствующих служб.</p>
<ul>
<li>Services
<ul>
<li>Windows Audio
<ul>
<li>Startup type
<ul>
<li>Automatic</li>
</ul>
</li>
</ul>
</li>
<li>Windows Audio Endpoint
<ul>
<li>Startup type
<ul>
<li>Automatic</li>
</ul>
</li>
</ul>
</li>
<li>Windows Search
<ul>
<li>Startup type
<ul>
<li>Automatic (Delayed Start)</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<h2 id="отключение-shutdown-event-tracker">
  <a class="link-body-emphasis" href="#%d0%be%d1%82%d0%ba%d0%bb%d1%8e%d1%87%d0%b5%d0%bd%d0%b8%d0%b5-shutdown-event-tracker">Отключение Shutdown Event Tracker</a>
</h2><p>Сервер должен работать бесперебойно. Любое отключение сервера, по хорошему, должно записываться в специальный журнал. Но так как у нас рабочая станция, записывать каждые перезагрузку или выключение нет необходимости. Включаем службы.</p>
<ul>
<li>Local Group Policy
<ul>
<li>Computer Configuration / Administrative Templates / System
<ul>
<li>Display Shutdown Event Tracker
<ul>
<li>Disabled</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<h2 id="отключение-строгой-системы-безопасности-ie">
  <a class="link-body-emphasis" href="#%d0%be%d1%82%d0%ba%d0%bb%d1%8e%d1%87%d0%b5%d0%bd%d0%b8%d0%b5-%d1%81%d1%82%d1%80%d0%be%d0%b3%d0%be%d0%b9-%d1%81%d0%b8%d1%81%d1%82%d0%b5%d0%bc%d1%8b-%d0%b1%d0%b5%d0%b7%d0%be%d0%bf%d0%b0%d1%81%d0%bd%d0%be%d1%81%d1%82%d0%b8-ie">Отключение строгой системы безопасности IE</a>
</h2><p>Сервер использует строгие параметры системы безопасности <span class="shortcode shortcode-tag">IE</span>. Но на рабочей станции в этих параметрах нет необходимости и они будут только мешать. Отключаем их.</p>
<ul>
<li>Server Manager / Local Server
<ul>
<li>IE Enhanced Security Configuration
<ul>
<li>Off</li>
</ul>
</li>
</ul>
</li>
</ul>
<h2 id="оптимизация-производительности-для-приложений">
  <a class="link-body-emphasis" href="#%d0%be%d0%bf%d1%82%d0%b8%d0%bc%d0%b8%d0%b7%d0%b0%d1%86%d0%b8%d1%8f-%d0%bf%d1%80%d0%be%d0%b8%d0%b7%d0%b2%d0%be%d0%b4%d0%b8%d1%82%d0%b5%d0%bb%d1%8c%d0%bd%d0%be%d1%81%d1%82%d0%b8-%d0%b4%d0%bb%d1%8f-%d0%bf%d1%80%d0%b8%d0%bb%d0%be%d0%b6%d0%b5%d0%bd%d0%b8%d0%b9">Оптимизация производительности для приложений</a>
</h2><p>По умолчанию, на сервере оптимизация включена для фоновых служб. На рабочей станции необходима оптимизация для программ. Включаем оптимизацию для программ.</p>
<ul>
<li>System / Advanced System Settings / Advanced / Performance / Advanced
<ul>
<li>Adjust for best performance of
<ul>
<li>Programs</li>
</ul>
</li>
</ul>
</li>
</ul>
<h2 id="отключение-dep">
  <a class="link-body-emphasis" href="#%d0%be%d1%82%d0%ba%d0%bb%d1%8e%d1%87%d0%b5%d0%bd%d0%b8%d0%b5-dep">Отключение DEP</a>
</h2><p>По умолчанию, <a title="" href="https://docs.microsoft.com/en-us/windows/win32/memory/data-execution-prevention" target="_blank"
   rel="noopener noreferrer">Data Execution Prevention (DEP)</a> включена абсолютно для всех программ и сервисов. Такая излишняя защита на рабочей станции не нужна. Поэтому, переключаем выполнение <span class="shortcode shortcode-tag">DEP</span> только для программ и сервисов самой ОС Windows.</p>
<ul>
<li>System / Advanced System Settings / Advanced / Performance / Data Execution Prevention
<ul>
<li>Turn on DEP for essential Windows programs and services only</li>
</ul>
</li>
</ul>
<h2 id="включение-memory-compression-operation-api-и-pagecombining">
  <a class="link-body-emphasis" href="#%d0%b2%d0%ba%d0%bb%d1%8e%d1%87%d0%b5%d0%bd%d0%b8%d0%b5-memory-compression-operation-api-%d0%b8-pagecombining">Включение Memory Compression, Operation API и PageCombining</a>
</h2><p>В ОС <span class="shortcode shortcode-tag"><a href="/ru/tags/windows/" target="_blank">#Windows</a></span> для обычных компьютеров включены Memory Compression, Operation API и PageCombining. Поэтому, перенастраиваем серверную версию ОС на такую же конфигурацию. Для этого запускаем <span class="shortcode shortcode-tag"><a href="/ru/tags/powershell/" target="_blank">#PowerShell</a></span> от имени Администратора и выполняем команду:</p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-0
shortcode-codeblock-powershell">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-3b1a234bd9cdce231a440f8905fef34d" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-powershell" data-lang="powershell"><span class="line"><span class="cl"><span class="nb">Enable-MMAgent</span> <span class="n">-MemoryCompression</span> <span class="n">-OperationAPI</span> <span class="n">-PageCombining</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-3b1a234bd9cdce231a440f8905fef34d"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>]]></turbo:content></item><item turbo="true"><title>Установка ядра XanMod в Debian</title><link>https://lib.onl/ru/2022/01/06ef2fab-2ae2-5356-9154-7ca1e486d27d/</link><pubDate>Thu, 13 Jan 2022 22:44:15 +0000</pubDate><dc:creator>Kai Kimera</dc:creator><category>Linux</category><yandex:related><link url="https://lib.onl/ru/2022/01/ddddd243-d182-5e26-a161-d2ea7812214a/">Установка Vivaldi в Debian</link><link url="https://lib.onl/ru/2021/09/581804b8-0613-52a8-a5c4-fdae90e7bc8a/">Чёрный экран с курсором при старте GDM</link><link url="https://lib.onl/ru/2021/09/1cf305cd-85d0-5e02-aabb-e01346bfee0f/">Proxmox VE: Установка на Debian 11 (Bullseye)</link><link url="https://lib.onl/ru/2021/09/ff829d15-4a19-52e3-a3aa-ad70aa38854a/">Debian: Wired Networks are Unmanaged</link><link url="https://lib.onl/ru/2021/09/b2caccc7-92bf-57ed-970f-136c546f18e2/">Распаковка пакетов DEB / RPM</link><link url="https://lib.onl/ru/2021/09/43b40b92-c29a-504b-87fa-5eac368dcf95/">Отключение установки дополнительных пакетов в Debian APT</link><link url="https://lib.onl/ru/2021/09/aeed7c90-003a-532a-b2c4-3807aaee88fa/">dhclient отправляет 36-значный идентификатор вместо MAC</link><link url="https://lib.onl/ru/2021/05/ee559a6c-5cde-5166-9d2d-3ceb55878eb8/">Debian: Статический IP-адрес</link></yandex:related><turbo:extendedHtml>true</turbo:extendedHtml><turbo:source>https://lib.onl/ru/2022/01/06ef2fab-2ae2-5356-9154-7ca1e486d27d/</turbo:source><turbo:topic>Установка ядра XanMod в Debian</turbo:topic><turbo:content><![CDATA[<p>Приветствую! В этой небольшой заметке приведу команду, при помощи которой можно добавить репозиторий ядра <span class="shortcode shortcode-tag"><a href="/ru/tags/xanmod/" target="_blank">#XanMod</a></span> в <span class="shortcode shortcode-tag"><a href="/ru/tags/debian/" target="_blank">#Debian</a></span>.</p>
<h2 id="что-такое-ядро-xanmod">
  <a class="link-body-emphasis" href="#%d1%87%d1%82%d0%be-%d1%82%d0%b0%d0%ba%d0%be%d0%b5-%d1%8f%d0%b4%d1%80%d0%be-xanmod">Что такое ядро XanMod?</a>
</h2><p>Ядро <span class="shortcode shortcode-tag"><a href="/ru/tags/xanmod/" target="_blank">#XanMod</a></span> имеет ряд патчей и оптимизаций. Список изменений по сравнению с ванильным ядром, я взял с <a title="" href="https://xanmod.org" target="_blank"
   rel="noopener noreferrer">официального сайта</a>:</p>
<ul>
<li>Caching, Virtual Memory Manager and CPUFreq Governor improvements.</li>
<li>Full multi-core block layer runqueue requests for high I/O throughput.</li>
<li>BBRv2 TCP congestion control + FQ-PIE packet scheduling and AQM algorithm.</li>
<li>ORC Unwinder for kernel stack traces (debuginfo) implementation.</li>
<li>High responsiveness multitasking Task Type scheduler (SCHED_NORMAL) build available [5.15-tt].</li>
<li>Real-time Linux kernel (PREEMPT_RT) build available [5.15-rt] [5.10-rt].</li>
<li>Third-party patchset available: patches
<ul>
<li>le9&rsquo;s file mappings under memory pressure protection.</li>
<li>Linux Random Number Generator (LRNG) framework.</li>
<li>TCP performance optimizations backport from linux/net-next [5.16] [5.15].</li>
<li>AMD&rsquo;s P-state driver for Zen2 and Zen3 processors [5.16] [5.15].</li>
<li>Futex waitv and legacy WAIT_MULTIPLE implementation for Wine / Proton Fsync support.</li>
<li>WineSync driver for fast kernel-backed Wine [5.16] [5.15] [as module: winesync].</li>
<li>Google&rsquo;s Multigenerational LRU framework [5.16] [5.15].</li>
<li>Google&rsquo;s BBRv2 TCP congestion control.</li>
<li>Paragon&rsquo;s Software NTFS3 driver [as module: ntfs3].</li>
<li>PCIe ACS Override for bypassing IOMMU groups support.</li>
<li>Graysky&rsquo;s additional CPU optimizations for GCC and Clang.</li>
<li>Clear Linux patchset [partial].</li>
<li>Android Ashmem and Binder IPC driver as module for Anbox.</li>
<li>Updated ZSTD library for bug fixes and r/w performance compression improvements on Btrfs, F2FS, SquashFS, pstore, initramfs and vmlinuz.</li>
</ul>
</li>
<li>Generic packages for compatibility with most Debian &amp; Ubuntu based distributions. Builts on the latest LLVM 12.0.1, GCC 11.2 and Binutils 2.37.</li>
<li>GPLv2 license. Can be built for any distribution or purpose.</li>
</ul>
<p>Стоит заметить, что ядро <span class="shortcode shortcode-tag"><a href="/ru/tags/xanmod/" target="_blank">#XanMod</a></span> не единственное, которое интегрирует в себя оптимизации. Есть ещё ядро <a title="" href="https://liquorix.net" target="_blank"
   rel="noopener noreferrer"><strong>Liquorix</strong></a>, которое занимается практически тем же самым. Но, посмотрев <a title="" href="https://www.phoronix.com/scan.php?page=article&amp;item=ryzen5-xanmod-liquorix" target="_blank"
   rel="noopener noreferrer">обзор и тесты</a> на Phoronix&rsquo;е, я сделал выбор в пользу <span class="shortcode shortcode-tag"><a href="/ru/tags/xanmod/" target="_blank">#XanMod</a></span>.</p>
<h2 id="установка-xanmod">
  <a class="link-body-emphasis" href="#%d1%83%d1%81%d1%82%d0%b0%d0%bd%d0%be%d0%b2%d0%ba%d0%b0-xanmod">Установка XanMod</a>
</h2><p>Однострочная команда по добавлению ядра <span class="shortcode shortcode-tag"><a href="/ru/tags/xanmod/" target="_blank">#XanMod</a></span> в репозиторий <span class="shortcode shortcode-tag"><a href="/ru/tags/debian/" target="_blank">#Debian</a></span>&rsquo;а приведена ниже. Она дробится на следующие под-команды:</p>
<ol>
<li>Добавление файла <code>xanmod-kernel.list</code> в директорию <code>/etc/apt/sources.list.d</code>.</li>
<li>Скачивание файла подписи <code>archive.key</code> и размещение его в директорию <code>/etc/apt/trusted.gpg.d</code> с названием <code>xanmod-kernel.gpg</code>.</li>
<li>Обновление информации из репозитория при помощи команды <code>apt update</code>.</li>
</ol>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-0
shortcode-codeblock-bash">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-f66d318375a1d6d522ce3a5de290b2fe" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="nb">echo</span> <span class="s1">&#39;deb [signed-by=/etc/apt/trusted.gpg.d/xanmod-kernel.gpg] http://deb.xanmod.org releases main&#39;</span> <span class="p">|</span> tee /etc/apt/sources.list.d/xanmod-kernel.list <span class="o">&amp;&amp;</span> curl -fsSL <span class="s1">&#39;https://dl.xanmod.org/archive.key&#39;</span> <span class="p">|</span> gpg --dearmor <span class="p">|</span> tee /etc/apt/trusted.gpg.d/xanmod-kernel.gpg &gt; /dev/null <span class="o">&amp;&amp;</span> apt update</span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-f66d318375a1d6d522ce3a5de290b2fe"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<p>После выполнения вышеприведённой команды, установка ядра <span class="shortcode shortcode-tag"><a href="/ru/tags/xanmod/" target="_blank">#XanMod</a></span> происходит таким образом:</p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-1
shortcode-codeblock-bash">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-c25f0cfaa36d813b3ad2bca90fa9f954" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">apt install linux-xanmod-<span class="o">[</span>ABI<span class="o">]</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-c25f0cfaa36d813b3ad2bca90fa9f954"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<p>Где:</p>
<ul>
<li><code>[ABI]</code> - версия архитектуры. Список версий архитектур можно посмотреть ниже.</li>
</ul>
<h3 id="примеры">
  <a class="link-body-emphasis" href="#%d0%bf%d1%80%d0%b8%d0%bc%d0%b5%d1%80%d1%8b">Примеры</a>
</h3><p>Установить ядро <span class="shortcode shortcode-tag"><a href="/ru/tags/xanmod/" target="_blank">#XanMod</a></span> с версией архитектуры <code>x64v1</code>:</p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-2
shortcode-codeblock-bash">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-d8b26867c960db385f50c16ac7d99abc" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">apt install linux-xanmod-x64v1</span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-d8b26867c960db385f50c16ac7d99abc"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<p>Установить ядро <span class="shortcode shortcode-tag"><a href="/ru/tags/xanmod/" target="_blank">#XanMod</a></span> с версией архитектуры <code>x64v2</code>:</p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-3
shortcode-codeblock-bash">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-f7f9a6b5237c5743581a1f92cc527b7f" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">apt install linux-xanmod-x64v2</span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-f7f9a6b5237c5743581a1f92cc527b7f"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<p>Установить ядро <span class="shortcode shortcode-tag"><a href="/ru/tags/xanmod/" target="_blank">#XanMod</a></span> с версией архитектуры <code>x64v3</code>:</p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-4
shortcode-codeblock-bash">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-c459f17db207e8a5983a91b0cf40c53c" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">apt install linux-xanmod-x64v3</span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-c459f17db207e8a5983a91b0cf40c53c"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<p>Установить ядро <span class="shortcode shortcode-tag"><a href="/ru/tags/xanmod/" target="_blank">#XanMod</a></span> с версией архитектуры <code>x64v4</code>:</p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-5
shortcode-codeblock-bash">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-5699dad74d7c1c2192f2841b931454aa" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">apt install linux-xanmod-x64v4</span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-5699dad74d7c1c2192f2841b931454aa"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<p>Для установки Mainline-версии ядра команда будет такой:</p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-6
shortcode-codeblock-bash">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-f0715ba2e166ecdb5049e97d7a769937" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">apt install linux-xanmod-edge-x64v3</span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-f0715ba2e166ecdb5049e97d7a769937"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<h2 id="версии-архитектур-xanmod">
  <a class="link-body-emphasis" href="#%d0%b2%d0%b5%d1%80%d1%81%d0%b8%d0%b8-%d0%b0%d1%80%d1%85%d0%b8%d1%82%d0%b5%d0%ba%d1%82%d1%83%d1%80-xanmod">Версии архитектур XanMod</a>
</h2><p>Версия архитектуры зависит от ядра процессора и поддерживаемых им инструкций. Версию архитектуры можно узнать из списка ниже.</p>
<h3 id="x86-64-legacy">
  <a class="link-body-emphasis" href="#x86-64-legacy">x86-64 (LEGACY)</a>
</h3><p>Суффикс для установки ядра: <code>x64v1</code>.</p>
<p><strong>Поддерживаемые архитектуры:</strong></p>
<ul>
<li>AMD K8-family</li>
<li>AMD K10-family</li>
<li>AMD Family 10h (Barcelona)</li>
<li>Intel Pentium 4 / Xeon (Nocona)</li>
<li>Intel Core 2 (all variants)</li>
<li>All x86-64 CPUs</li>
</ul>
<h3 id="x86-64-v2">
  <a class="link-body-emphasis" href="#x86-64-v2">x86-64-v2</a>
</h3><p>Суффикс для установки ядра: <code>x64v2</code>.</p>
<p><strong>Поддерживаемые архитектуры:</strong></p>
<ul>
<li>AMD Family 14h (Bobcat)</li>
<li>AMD Family 16h (Jaguar)</li>
<li>AMD Family 15h (Bulldozer)</li>
<li>AMD Family 15h (Piledriver)</li>
<li>AMD Family 15h (Steamroller)</li>
<li>Intel 1st Gen Core (Nehalem)</li>
<li>Intel 1.5 Gen Core (Westmere)</li>
<li>Intel 2nd Gen Core (Sandybridge)</li>
<li>Intel 3rd Gen Core (Ivybridge)</li>
<li>Intel low-power Silvermont</li>
<li>Intel Goldmont (Apollo Lake)</li>
<li>Intel Goldmont (Denverton)</li>
<li>Intel Goldmont Plus (Gemini Lake)</li>
</ul>
<h3 id="x86-64-v3">
  <a class="link-body-emphasis" href="#x86-64-v3">x86-64-v3</a>
</h3><p>Суффикс для установки ядра: <code>x64v3</code>.</p>
<p><strong>Поддерживаемые архитектуры:</strong></p>
<ul>
<li>AMD Family 15h (Excavator)</li>
<li>AMD Family 17h (Zen)</li>
<li>AMD Family 17h (Zen+)</li>
<li>AMD Family 17h (Zen2)</li>
<li>AMD Family 19h (Zen3)</li>
<li>Intel 4th Gen Core (Haswell)</li>
<li>Intel 5th Gen Core (Broadwell)</li>
<li>Intel 6th Gen Core (Skylake)</li>
<li>Intel 7th Gen Core (Kaby Lake)</li>
<li>Intel 8/9th Gen Core (Coffee Lake)</li>
<li>Intel 10th Gen Core (Comet Lake)</li>
<li>Intel 12th Gen (Alder Lake)</li>
<li>Intel 13th Gen (Raptor Lake)</li>
<li>Intel 14th Gen (Meteor Lake)</li>
</ul>
<h3 id="x86-64-v4-avx-512">
  <a class="link-body-emphasis" href="#x86-64-v4-avx-512">x86-64-v4 (AVX-512)</a>
</h3><p>Суффикс для установки ядра: <code>x64v4</code>.</p>
<p><strong>Поддерживаемые архитектуры:</strong></p>
<ul>
<li>AMD Family 19h (Zen4)</li>
<li>Intel 6th Gen Core (Skylake X)</li>
<li>Intel 8th Gen Core i3 (Cannon Lake)</li>
<li>Intel Xeon / 10th Gen Core (Ice Lake)</li>
<li>Intel Xeon (Cascade Lake)</li>
<li>Intel Xeon (Cooper Lake)</li>
<li>Intel 3rd Gen 10nm++ (Tiger Lake)</li>
<li>Intel 4th Gen 10nm++ (Sapphire Rapids)</li>
<li>Intel 5th Gen 10nm++ (Emerald Rapids)</li>
<li>Intel 11th Gen (Rocket Lake)</li>
</ul>]]></turbo:content></item><item turbo="true"><title>Установка Vivaldi в Debian</title><link>https://lib.onl/ru/2022/01/ddddd243-d182-5e26-a161-d2ea7812214a/</link><pubDate>Thu, 13 Jan 2022 22:44:01 +0000</pubDate><dc:creator>Kai Kimera</dc:creator><category>Linux</category><yandex:related><link url="https://lib.onl/ru/2021/09/581804b8-0613-52a8-a5c4-fdae90e7bc8a/">Чёрный экран с курсором при старте GDM</link><link url="https://lib.onl/ru/2021/09/1cf305cd-85d0-5e02-aabb-e01346bfee0f/">Proxmox VE: Установка на Debian 11 (Bullseye)</link><link url="https://lib.onl/ru/2021/09/ff829d15-4a19-52e3-a3aa-ad70aa38854a/">Debian: Wired Networks are Unmanaged</link><link url="https://lib.onl/ru/2021/09/b2caccc7-92bf-57ed-970f-136c546f18e2/">Распаковка пакетов DEB / RPM</link><link url="https://lib.onl/ru/2021/09/43b40b92-c29a-504b-87fa-5eac368dcf95/">Отключение установки дополнительных пакетов в Debian APT</link><link url="https://lib.onl/ru/2021/09/aeed7c90-003a-532a-b2c4-3807aaee88fa/">dhclient отправляет 36-значный идентификатор вместо MAC</link><link url="https://lib.onl/ru/2021/05/ee559a6c-5cde-5166-9d2d-3ceb55878eb8/">Debian: Статический IP-адрес</link></yandex:related><turbo:extendedHtml>true</turbo:extendedHtml><turbo:source>https://lib.onl/ru/2022/01/ddddd243-d182-5e26-a161-d2ea7812214a/</turbo:source><turbo:topic>Установка Vivaldi в Debian</turbo:topic><turbo:content><![CDATA[<p>Привет всем! В этой небольшой заметке я приведу команду, при помощи которой можно добавить репозиторий браузера <span class="shortcode shortcode-tag"><a href="/ru/tags/vivaldi/" target="_blank">#Vivaldi</a></span> в <span class="shortcode shortcode-tag"><a href="/ru/tags/debian/" target="_blank">#Debian</a></span>.</p>
<p>Установочный пакет <span class="shortcode shortcode-tag"><a href="/ru/tags/vivaldi/" target="_blank">#Vivaldi</a></span> уже выполняет указанные действия, но для этого он задействует утилиту <code>apt-key</code>, которая в <span class="shortcode shortcode-tag"><a href="/ru/tags/debian/" target="_blank">#Debian</a></span> 11 имеет статус <code>deprecated</code>.</p>
<p>Однострочная команда по добавлению <span class="shortcode shortcode-tag"><a href="/ru/tags/vivaldi/" target="_blank">#Vivaldi</a></span> в репозиторий <span class="shortcode shortcode-tag"><a href="/ru/tags/debian/" target="_blank">#Debian</a></span>&rsquo;а приведена ниже. Она дробится на следующие под-команды:</p>
<ol>
<li>Добавление файла <code>vivaldi-archive.list</code> в директорию <code>/etc/apt/sources.list.d</code>.</li>
<li>Скачивание файла подписи <code>linux_signing_key.pub</code> и размещение его в директорию <code>/etc/apt/trusted.gpg.d</code> с названием <code>vivaldi-browser.gpg</code>.</li>
<li>Обновление информации из репозитория при помощи команды <code>apt update</code>.</li>
</ol>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-0
shortcode-codeblock-bash">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-d784b2e0d64b93c4551763b4c1a24487" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="nb">echo</span> <span class="s2">&#34;deb [signed-by=/etc/apt/trusted.gpg.d/vivaldi-browser.gpg arch=</span><span class="k">$(</span>dpkg --print-architecture<span class="k">)</span><span class="s2">] https://repo.vivaldi.com/archive/deb/ stable main&#34;</span> <span class="p">|</span> tee /etc/apt/sources.list.d/vivaldi-archive.list <span class="o">&amp;&amp;</span> curl -fsSL <span class="s1">&#39;https://repo.vivaldi.com/archive/linux_signing_key.pub&#39;</span> <span class="p">|</span> gpg --dearmor <span class="p">|</span> tee /etc/apt/trusted.gpg.d/vivaldi-browser.gpg &gt; /dev/null <span class="o">&amp;&amp;</span> apt update</span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-d784b2e0d64b93c4551763b4c1a24487"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<p>После выполнения команды, установка <span class="shortcode shortcode-tag"><a href="/ru/tags/vivaldi/" target="_blank">#Vivaldi</a></span> происходит таким образом:</p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-1
shortcode-codeblock-bash">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-baaedc2e5e60b36b0362a1d4d22cffdd" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">apt install vivaldi-stable</span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-baaedc2e5e60b36b0362a1d4d22cffdd"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>]]></turbo:content></item><item turbo="true"><title>Чёрный экран с курсором при старте GDM</title><link>https://lib.onl/ru/2021/09/581804b8-0613-52a8-a5c4-fdae90e7bc8a/</link><pubDate>Thu, 30 Sep 2021 08:10:19 +0000</pubDate><dc:creator>Kai Kimera</dc:creator><category>Linux</category><yandex:related><link url="https://lib.onl/ru/2021/09/ff829d15-4a19-52e3-a3aa-ad70aa38854a/">Debian: Wired Networks are Unmanaged</link><link url="https://lib.onl/ru/2021/09/0d11ecc0-2714-5c5c-9b48-804f50419590/">Отключение режима Wayland в GDM</link><link url="https://lib.onl/ru/2021/09/1cf305cd-85d0-5e02-aabb-e01346bfee0f/">Proxmox VE: Установка на Debian 11 (Bullseye)</link><link url="https://lib.onl/ru/2021/09/b2caccc7-92bf-57ed-970f-136c546f18e2/">Распаковка пакетов DEB / RPM</link><link url="https://lib.onl/ru/2021/09/43b40b92-c29a-504b-87fa-5eac368dcf95/">Отключение установки дополнительных пакетов в Debian APT</link><link url="https://lib.onl/ru/2021/09/aeed7c90-003a-532a-b2c4-3807aaee88fa/">dhclient отправляет 36-значный идентификатор вместо MAC</link><link url="https://lib.onl/ru/2021/05/ee559a6c-5cde-5166-9d2d-3ceb55878eb8/">Debian: Статический IP-адрес</link><link url="https://lib.onl/ru/2021/03/0a815547-4f18-52a0-9a99-c463421872ca/">Monero Unit</link></yandex:related><turbo:extendedHtml>true</turbo:extendedHtml><turbo:source>https://lib.onl/ru/2021/09/581804b8-0613-52a8-a5c4-fdae90e7bc8a/</turbo:source><turbo:topic>Чёрный экран с курсором при старте GDM</turbo:topic><turbo:content><![CDATA[<p>На днях установил <span class="shortcode shortcode-tag"><a href="/ru/tags/debian/" target="_blank">#Debian</a></span> 11 на несколько ПК. Всё было отлично, кроме как на одном из ПК почему то <span class="shortcode shortcode-tag"><a href="/ru/tags/gdm/" target="_blank">#GDM</a></span> не стал загружаться. Чёрный экран с мигающем текстовым курсором&hellip;</p>
<p>На других ПК всё было нормально. Отличие проблемного ПК от остальных заключалось в том, что на проблемном ПК система была установлена на <span class="shortcode shortcode-tag"><a href="/ru/tags/ssd/" target="_blank">#SSD</a></span>. Может быть дело в этом. В интернете я нашёл похожую проблему. По сути, проблема заключается в том, что сам <span class="shortcode shortcode-tag"><a href="/ru/tags/gdm/" target="_blank">#GDM</a></span> запускается чуть раньше, чем начинается инициализация графической подсистемы. И на кой чёрт его несёт вперёд&hellip;</p>
<p>В общем, предлагают несколько решений.</p>
<h2 id="настройка-сервиса-gdm">
  <a class="link-body-emphasis" href="#%d0%bd%d0%b0%d1%81%d1%82%d1%80%d0%be%d0%b9%d0%ba%d0%b0-%d1%81%d0%b5%d1%80%d0%b2%d0%b8%d1%81%d0%b0-gdm">Настройка сервиса GDM</a>
</h2><p>Данный вариант решения проблемы предлагает отредактировать стартовые параметры сервиса <span class="shortcode shortcode-tag"><a href="/ru/tags/gdm/" target="_blank">#GDM</a></span>, чтобы тот запускался с небольшой задержкой и не лез вперёд остальной графической подсистемы.</p>
<p>В терминале нужно ввести от root&rsquo;а команду <code>systemctl edit gdm.service</code>, откроется редактор сервиса <span class="shortcode shortcode-tag"><a href="/ru/tags/gdm/" target="_blank">#GDM</a></span>. В нем необходимо добавить строку <code>ExecStartPre=/bin/sleep 2</code>, которая создаёт задержку перед запуском самого <span class="shortcode shortcode-tag"><a href="/ru/tags/gdm/" target="_blank">#GDM</a></span>. Примерно вот так:</p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-0
shortcode-codeblock-ini">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-5a9a345a4e1ca3d0da0cb3f3c224cb8c" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-ini" data-lang="ini"><span class="line"><span class="cl"><span class="c1">### Anything between here and the comment below will become the new contents of the file</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">[Service]</span>
</span></span><span class="line"><span class="cl"><span class="na">ExecStartPre</span><span class="o">=</span><span class="s">/bin/sleep 2</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">### Lines below this comment will be discarded</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-5a9a345a4e1ca3d0da0cb3f3c224cb8c"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<p>Таким образом GDM начинает запускаться после того, как инициализируется графическая подсистема.</p>
<p>Ещё одно исправление <a title="" href="https://gitlab.gnome.org/GNOME/gdm/-/issues/662#note_993169" target="_blank"
   rel="noopener noreferrer">предложили</a> в баг-трекере <span class="shortcode shortcode-tag"><a href="/ru/tags/gnome/" target="_blank">#GNOME</a></span> / <span class="shortcode shortcode-tag"><a href="/ru/tags/gdm/" target="_blank">#GDM</a></span>. Вместо торможения загрузки GDM, необходимо добавить следующие строки:</p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-1
shortcode-codeblock-ini">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-e0169621b0f728187686565ebf485097" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-ini" data-lang="ini"><span class="line"><span class="cl"><span class="k">[Unit]</span>
</span></span><span class="line"><span class="cl"><span class="na">Wants</span><span class="o">=</span><span class="s">systemd-udev-trigger.service systemd-udev-settle.service</span>
</span></span><span class="line"><span class="cl"><span class="na">After</span><span class="o">=</span><span class="s">systemd-udev-trigger.service systemd-udev-settle.service</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-e0169621b0f728187686565ebf485097"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<p>Но это не совсем корректное исправление (хотя исправление, изложенное выше, тоже трудно назвать правильным), так как после применения этих строк, появляется ошибка:</p>











<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-2 shortcode-codeblock-terminal
shortcode-codeblock-terminal-linux
shortcode-codeblock-terminal-linux-user">
  <div class="card overflow-hidden" data-bs-theme="dark">
    <div class="card-header">
      <div class="d-flex align-items-center">
        <div class="flex-shrink-0 ">
          <i class="fas fa-terminal fa-fw"></i>
        </div>
        <div class="flex-grow-1 mx-2">
          <h5 class="mb-0">Терминал</h5>
        </div>
        <div class="flex-shrink-0">
          <ul class="list-inline mb-0">
            <li class="list-inline-item" title='Копировать'>
              <a class="text-body" href="#"
                 data-fn="clipboard" data-clipboard-target="#cp-63c11eeeb4e1d28d539961437457f606"
                 role="button" aria-label='Копировать'>
                <i class="fas fa-copy fa-fw"></i>
              </a>
            </li>
          </ul>
        </div>
      </div>
    </div>
    <div class="card-body p-0 overflow-auto" id="cp-63c11eeeb4e1d28d539961437457f606"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-plaintext" data-lang="plaintext"><span class="line"><span class="cl">Dec 27 22:23:48 oleksandr-xps15 udevadm[260]: systemd-udev-settle.service is deprecated. Please fix gdm.service not to pull it in.</span></span></code></pre></td></tr></table>
</div>
</div></div>
  </div>
</div>
<h2 id="указание-порядка-инициализации-графической-подсистемы">
  <a class="link-body-emphasis" href="#%d1%83%d0%ba%d0%b0%d0%b7%d0%b0%d0%bd%d0%b8%d0%b5-%d0%bf%d0%be%d1%80%d1%8f%d0%b4%d0%ba%d0%b0-%d0%b8%d0%bd%d0%b8%d1%86%d0%b8%d0%b0%d0%bb%d0%b8%d0%b7%d0%b0%d1%86%d0%b8%d0%b8-%d0%b3%d1%80%d0%b0%d1%84%d0%b8%d1%87%d0%b5%d1%81%d0%ba%d0%be%d0%b9-%d0%bf%d0%be%d0%b4%d1%81%d0%b8%d1%81%d1%82%d0%b5%d0%bc%d1%8b">Указание порядка инициализации графической подсистемы</a>
</h2><p>Этот вариант решения проблемы подходит для <strong>Arch Linux</strong>. Необходимо в файле <code>/etc/mkinitcpio.conf</code> добавить в массив <code>MODULES</code> свою графическую подсистему, чтобы та запускалась раньше, чем <span class="shortcode shortcode-tag"><a href="/ru/tags/gdm/" target="_blank">#GDM</a></span>. Например:</p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-3
shortcode-codeblock-text">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-d3fa3f160381a128752393bbdbcb2382" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-text" data-lang="text"><span class="line"><span class="cl">MODULES=(amdgpu)</span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-d3fa3f160381a128752393bbdbcb2382"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<p>Можно указать другие графические подсистемы, всё зависит от видеокарты, установленной в ПК:</p>
<ul>
<li><code>amdgpu</code> - для современных видеокарт AMD.</li>
<li><code>radeon</code> - для устаревших видеокарт AMD.</li>
<li><code>nouveau</code> - для Nvidia Nouveau.</li>
<li><code>i915</code> - для Intel.</li>
<li><code>mgag200</code> - для видеокарт Matrox.</li>
</ul>
<p>Если в системе используется <span class="shortcode shortcode-tag"><a href="/ru/tags/intel/" target="_blank">#Intel</a></span> в качестве графики и в модулях прописан <code>i915</code>, то могут появится ошибки <span class="shortcode shortcode-tag">ACPI</span>. Для исправления этих ошибок необходимо добавить <code>intel_agp</code> перед <code>i915</code>. Чтобы проверить корректность загрузки модуля, можно ввести команду <code>lsmod | grep intel_agp</code>.</p>]]></turbo:content></item><item turbo="true"><title>Отключение режима Wayland в GDM</title><link>https://lib.onl/ru/2021/09/0d11ecc0-2714-5c5c-9b48-804f50419590/</link><pubDate>Thu, 30 Sep 2021 07:51:30 +0000</pubDate><dc:creator>Kai Kimera</dc:creator><category>Linux</category><turbo:extendedHtml>true</turbo:extendedHtml><turbo:source>https://lib.onl/ru/2021/09/0d11ecc0-2714-5c5c-9b48-804f50419590/</turbo:source><turbo:topic>Отключение режима Wayland в GDM</turbo:topic><turbo:content><![CDATA[<p>Использовать <span class="shortcode shortcode-tag"><a href="/ru/tags/wayland/" target="_blank">#Wayland</a></span> мне, пока что, нет необходимости. Поэтому, я решил его отключить в <span class="shortcode shortcode-tag"><a href="/ru/tags/gdm/" target="_blank">#GDM</a></span>.</p>
<p>Для того, чтобы отключить выбор режима <span class="shortcode shortcode-tag"><a href="/ru/tags/wayland/" target="_blank">#Wayland</a></span> в <span class="shortcode shortcode-tag"><a href="/ru/tags/gdm/" target="_blank">#GDM</a></span>, необходимо в файле <code>/etc/gdm3/daemon.conf</code> раскомментировать строку:</p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-0
shortcode-codeblock-ini">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-993d56608b1924cb0156d306f3398ef2" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-ini" data-lang="ini"><span class="line"><span class="cl"><span class="c1"># WaylandEnable=false</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-993d56608b1924cb0156d306f3398ef2"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<p>Должно получится так:</p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-1
shortcode-codeblock-ini">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-a8c4fbdaa157d32d8a99bae9a17d300e" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-ini" data-lang="ini"><span class="line"><span class="cl"><span class="na">WaylandEnable</span><span class="o">=</span><span class="s">false</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-a8c4fbdaa157d32d8a99bae9a17d300e"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<p>Таким образом даём понять <span class="shortcode shortcode-tag"><a href="/ru/tags/gdm/" target="_blank">#GDM</a></span>, что мы не желаем использовать <span class="shortcode shortcode-tag"><a href="/ru/tags/wayland/" target="_blank">#Wayland</a></span>.</p>]]></turbo:content></item><item turbo="true"><title>Proxmox VE: Установка на Debian 11 (Bullseye)</title><link>https://lib.onl/ru/2021/09/1cf305cd-85d0-5e02-aabb-e01346bfee0f/</link><pubDate>Sun, 12 Sep 2021 21:36:02 +0000</pubDate><dc:creator>Kai Kimera</dc:creator><category>Linux</category><category>В доработке</category><yandex:related><link url="https://lib.onl/ru/2021/09/ff829d15-4a19-52e3-a3aa-ad70aa38854a/">Debian: Wired Networks are Unmanaged</link><link url="https://lib.onl/ru/2021/09/b2caccc7-92bf-57ed-970f-136c546f18e2/">Распаковка пакетов DEB / RPM</link><link url="https://lib.onl/ru/2021/09/43b40b92-c29a-504b-87fa-5eac368dcf95/">Отключение установки дополнительных пакетов в Debian APT</link><link url="https://lib.onl/ru/2021/09/aeed7c90-003a-532a-b2c4-3807aaee88fa/">dhclient отправляет 36-значный идентификатор вместо MAC</link><link url="https://lib.onl/ru/2021/05/ee559a6c-5cde-5166-9d2d-3ceb55878eb8/">Debian: Статический IP-адрес</link></yandex:related><turbo:extendedHtml>true</turbo:extendedHtml><turbo:source>https://lib.onl/ru/2021/09/1cf305cd-85d0-5e02-aabb-e01346bfee0f/</turbo:source><turbo:topic>Proxmox VE: Установка на Debian 11 (Bullseye)</turbo:topic><turbo:content><![CDATA[<p>В этой небольшой заметке, я расскажу как установить <span class="shortcode shortcode-tag"><a href="/ru/tags/proxmox/" target="_blank">#Proxmox</a></span> VE на чистый <span class="shortcode shortcode-tag"><a href="/ru/tags/debian/" target="_blank">#Debian</a></span> 11 (<span class="shortcode shortcode-tag">Bullseye</span>).</p>
<h2 id="подготовка">
  <a class="link-body-emphasis" href="#%d0%bf%d0%be%d0%b4%d0%b3%d0%be%d1%82%d0%be%d0%b2%d0%ba%d0%b0">Подготовка</a>
</h2><p>Для начала необходимо отредактировать файл <code>/etc/hosts</code>, прописав туда IP сервера, на который будет устанавливаться наш <span class="shortcode shortcode-tag"><a href="/ru/tags/proxmox/" target="_blank">#Proxmox</a></span> VE:</p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-0
shortcode-codeblock-text">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-0c32a433bff617fe739461ae4effde08" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-text" data-lang="text"><span class="line"><span class="cl">127.0.0.1   localhost
</span></span><span class="line"><span class="cl">127.0.1.1   localhost.localdomain     localhost
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"># Proxmox
</span></span><span class="line"><span class="cl">10.0.1.1    srv-vm.home.local         srv-vm</span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-0c32a433bff617fe739461ae4effde08"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<p>Для проверки, можно выполнить команду <code>hostname --ip-address</code>, которая вернёт IP сервера, указанного в <code>/etc/hosts</code> выше.</p>
<h2 id="добавление-репозиториев">
  <a class="link-body-emphasis" href="#%d0%b4%d0%be%d0%b1%d0%b0%d0%b2%d0%bb%d0%b5%d0%bd%d0%b8%d0%b5-%d1%80%d0%b5%d0%bf%d0%be%d0%b7%d0%b8%d1%82%d0%be%d1%80%d0%b8%d0%b5%d0%b2">Добавление репозиториев</a>
</h2><p>Добавим репозиторий <span class="shortcode shortcode-tag"><a href="/ru/tags/proxmox/" target="_blank">#Proxmox</a></span> VE:</p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-1
shortcode-codeblock-bash">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-5d16391a94e620e3845f726dc5f59b64" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="nb">echo</span> <span class="s2">&#34;deb [arch=amd64] http://download.proxmox.com/debian/pve bullseye pve-no-subscription&#34;</span> &gt; /etc/apt/sources.list.d/pve.list</span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-5d16391a94e620e3845f726dc5f59b64"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<p>Скачаем и установим ключ репозитория:</p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-2
shortcode-codeblock-bash">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-cc83504b46fa8106e00d6c75f633e5f0" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">curl <span class="s1">&#39;https://enterprise.proxmox.com/debian/proxmox-release-bullseye.gpg&#39;</span> -o /etc/apt/trusted.gpg.d/pve.gpg</span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-cc83504b46fa8106e00d6c75f633e5f0"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<p>Обновим базу пакетов <span class="shortcode shortcode-tag"><a href="/ru/tags/apt/" target="_blank">#APT</a></span> и саму систему:</p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-3
shortcode-codeblock-bash">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-0194e7fc31d2f4ff36225ce1dceaf6b3" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">apt update <span class="o">&amp;&amp;</span> apt full-upgrade</span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-0194e7fc31d2f4ff36225ce1dceaf6b3"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<h2 id="установка-пакетов">
  <a class="link-body-emphasis" href="#%d1%83%d1%81%d1%82%d0%b0%d0%bd%d0%be%d0%b2%d0%ba%d0%b0-%d0%bf%d0%b0%d0%ba%d0%b5%d1%82%d0%be%d0%b2">Установка пакетов</a>
</h2><p>Начнём установку пакетов командой:</p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-4
shortcode-codeblock-bash">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-d56be6db8977e86243fe59b8f589ad84" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">apt install proxmox-ve postfix open-iscsi</span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-d56be6db8977e86243fe59b8f589ad84"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<p>Стоит заметить, что устанавливается <span class="shortcode shortcode-tag"><a href="/ru/tags/postfix/" target="_blank">#Postfix</a></span>, он необходим для отправки писем от <span class="shortcode shortcode-tag"><a href="/ru/tags/proxmox/" target="_blank">#Proxmox</a></span> VE. Но мне в локальной сети такая функция не нужна. При установке, <span class="shortcode shortcode-tag"><a href="/ru/tags/postfix/" target="_blank">#Postfix</a></span> спросит в каком режиме ему необходимо будет работать. Я выбираю <strong>local only</strong>.</p>
<h2 id="исправление-ошибок">
  <a class="link-body-emphasis" href="#%d0%b8%d1%81%d0%bf%d1%80%d0%b0%d0%b2%d0%bb%d0%b5%d0%bd%d0%b8%d0%b5-%d0%be%d1%88%d0%b8%d0%b1%d0%be%d0%ba">Исправление ошибок</a>
</h2><p>После установки <span class="shortcode shortcode-tag"><a href="/ru/tags/proxmox/" target="_blank">#Proxmox</a></span> VE через пакетны менеджер <span class="shortcode shortcode-tag"><a href="/ru/tags/apt/" target="_blank">#APT</a></span>, я столкнулся с некоторыми проблемами. Не знаю, может быть они будут отсутствовать, если устанавливать <span class="shortcode shortcode-tag"><a href="/ru/tags/proxmox/" target="_blank">#Proxmox</a></span> VE при помощи его отдельного файла <span class="shortcode shortcode-tag">ISO</span>&hellip;</p>
<h3 id="lvm2-activation-generator-lvmconfig-failed">
  <a class="link-body-emphasis" href="#lvm2-activation-generator-lvmconfig-failed">lvm2-activation-generator: lvmconfig failed</a>
</h3><p>Для исправления ошибки <code>lvm2-activation-generator: lvmconfig failed</code>, необходимо в файле <code>/etc/lvm/lvm.conf</code> изменить параметр <code>event_activation</code>, а именно рас-комментировать и установить в <code>0</code>:</p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-5
shortcode-codeblock-text">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-86a3eab2f8a12c0849dbeac84880873b" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-text" data-lang="text"><span class="line"><span class="cl">global {
</span></span><span class="line"><span class="cl">  &lt;...&gt;
</span></span><span class="line"><span class="cl">  # Configuration option global/event_activation.
</span></span><span class="line"><span class="cl">  # Activate LVs based on system-generated device events.
</span></span><span class="line"><span class="cl">  # When a device appears on the system, a system-generated event runs
</span></span><span class="line"><span class="cl">  # the pvscan command to activate LVs if the new PV completes the VG.
</span></span><span class="line"><span class="cl">  # Use auto_activation_volume_list to select which LVs should be
</span></span><span class="line"><span class="cl">  # activated from these events (the default is all.)
</span></span><span class="line"><span class="cl">  # When event_activation is disabled, the system will generally run
</span></span><span class="line"><span class="cl">  # a direct activation command to activate LVs in complete VGs.
</span></span><span class="line"><span class="cl">  # This configuration option has an automatic default value.
</span></span><span class="line"><span class="cl">  # event_activation = 1
</span></span><span class="line"><span class="cl">  &lt;...&gt;
</span></span><span class="line"><span class="cl">}</span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-86a3eab2f8a12c0849dbeac84880873b"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>











  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-6
shortcode-codeblock-text">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-58fedbbe8f03f8a6e1440cadfd2106d9" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-text" data-lang="text"><span class="line"><span class="cl">global {
</span></span><span class="line"><span class="cl">  &lt;...&gt;
</span></span><span class="line"><span class="cl">  # Configuration option global/event_activation.
</span></span><span class="line"><span class="cl">  # Activate LVs based on system-generated device events.
</span></span><span class="line"><span class="cl">  # When a device appears on the system, a system-generated event runs
</span></span><span class="line"><span class="cl">  # the pvscan command to activate LVs if the new PV completes the VG.
</span></span><span class="line"><span class="cl">  # Use auto_activation_volume_list to select which LVs should be
</span></span><span class="line"><span class="cl">  # activated from these events (the default is all.)
</span></span><span class="line"><span class="cl">  # When event_activation is disabled, the system will generally run
</span></span><span class="line"><span class="cl">  # a direct activation command to activate LVs in complete VGs.
</span></span><span class="line"><span class="cl">  # This configuration option has an automatic default value.
</span></span><span class="line"><span class="cl">  event_activation = 0
</span></span><span class="line"><span class="cl">  &lt;...&gt;
</span></span><span class="line"><span class="cl">}</span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-58fedbbe8f03f8a6e1440cadfd2106d9"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<h3 id="не-поднимается--интерфейс">
  <a class="link-body-emphasis" href="#%d0%bd%d0%b5-%d0%bf%d0%be%d0%b4%d0%bd%d0%b8%d0%bc%d0%b0%d0%b5%d1%82%d1%81%d1%8f--%d0%b8%d0%bd%d1%82%d0%b5%d1%80%d1%84%d0%b5%d0%b9%d1%81">Не поднимается  интерфейс</a>
</h3><p>После установки, у меня перестал автоматически подниматься сетевой интерфейс. Может быть, в отдельном образе <span class="shortcode shortcode-tag">ISO</span> <span class="shortcode shortcode-tag"><a href="/ru/tags/proxmox/" target="_blank">#Proxmox</a></span> VE такой проблемы нет, потому что при установке с отдельного образа <span class="shortcode shortcode-tag">ISO</span>, он запрашивает у администратора параметры сети. Но если устанавливать <span class="shortcode shortcode-tag"><a href="/ru/tags/proxmox/" target="_blank">#Proxmox</a></span> VE через пакетную систему Debian, то никаких запросов не появляется. В общем, я сделал так (<code>/etc/network/interfaces</code>):</p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-7
shortcode-codeblock-text">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-a90e59c51cfdf39c14e66d0c1d38e774" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-text" data-lang="text"><span class="line"><span class="cl">auto lo
</span></span><span class="line"><span class="cl">iface lo inet loopback
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">iface enp3s0 inet manual
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">auto vmbr0
</span></span><span class="line"><span class="cl">iface vmbr0 inet static
</span></span><span class="line"><span class="cl">  address 10.0.1.1/16
</span></span><span class="line"><span class="cl">  gateway 10.0.0.1
</span></span><span class="line"><span class="cl">  bridge-ports enp3s0
</span></span><span class="line"><span class="cl">  bridge-stp off
</span></span><span class="line"><span class="cl">  bridge-fd 0</span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-a90e59c51cfdf39c14e66d0c1d38e774"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<p>Конкретно, тут я добавил блок виртуального соединения:</p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-8
shortcode-codeblock-text">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-c07c91cbafb2d6ec070c30bea8dda36a" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-text" data-lang="text"><span class="line"><span class="cl">auto vmbr0
</span></span><span class="line"><span class="cl">iface vmbr0 inet static
</span></span><span class="line"><span class="cl">  address 10.0.1.1/16
</span></span><span class="line"><span class="cl">  gateway 10.0.0.1
</span></span><span class="line"><span class="cl">  bridge-ports enp3s0
</span></span><span class="line"><span class="cl">  bridge-stp off
</span></span><span class="line"><span class="cl">  bridge-fd 0</span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-c07c91cbafb2d6ec070c30bea8dda36a"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<p>Где указал мост с физической картой <code>enp3s0</code>. Саму же карту <code>enp3s0</code> я перевёл в режим <code>manual</code>. После этого, сетевой интерфейс на сервере заработал в штатном режиме.</p>
<p>На этом консольная настройка сервера виртуализации закончена. Настройка самого <span class="shortcode shortcode-tag"><a href="/ru/tags/proxmox/" target="_blank">#Proxmox</a></span>&rsquo;а можно выполнять уже в удобном web-интерфейсе.</p>]]></turbo:content></item><item turbo="true"><title>Debian: Wired Networks are Unmanaged</title><link>https://lib.onl/ru/2021/09/ff829d15-4a19-52e3-a3aa-ad70aa38854a/</link><pubDate>Thu, 09 Sep 2021 19:14:12 +0000</pubDate><dc:creator>Kai Kimera</dc:creator><category>Linux</category><yandex:related><link url="https://lib.onl/ru/2021/09/b2caccc7-92bf-57ed-970f-136c546f18e2/">Распаковка пакетов DEB / RPM</link><link url="https://lib.onl/ru/2021/09/43b40b92-c29a-504b-87fa-5eac368dcf95/">Отключение установки дополнительных пакетов в Debian APT</link><link url="https://lib.onl/ru/2021/09/aeed7c90-003a-532a-b2c4-3807aaee88fa/">dhclient отправляет 36-значный идентификатор вместо MAC</link><link url="https://lib.onl/ru/2021/05/ee559a6c-5cde-5166-9d2d-3ceb55878eb8/">Debian: Статический IP-адрес</link><link url="https://lib.onl/ru/2021/03/0a815547-4f18-52a0-9a99-c463421872ca/">Monero Unit</link></yandex:related><turbo:extendedHtml>true</turbo:extendedHtml><turbo:source>https://lib.onl/ru/2021/09/ff829d15-4a19-52e3-a3aa-ad70aa38854a/</turbo:source><turbo:topic>Debian: Wired Networks are Unmanaged</turbo:topic><turbo:content><![CDATA[<p>При базовой установке <span class="shortcode shortcode-tag"><a href="/ru/tags/debian/" target="_blank">#Debian</a></span>, Network Manager не устанавливается и, соответственно, он не управляет сетевой конфигурацией. Исправим данную ситуацию&hellip;</p>
<p>Лично я люблю ставить систему в минимальной комплектации. У меня есть <a title="" href="https://uaik.github.io/" target="_blank"
   rel="noopener noreferrer">отдельный ресурс</a> со сценариями автоматической установки. Это шаблоны, которые позволяют поставить систему в автоматическом режиме и с минимальным набором компонентов. В основном, такие шаблоны полезны для серверов. Однако, для домашнего компьютера тоже вполне подойдут. Но после установки домашней системы через такой шаблон, потребуется небольшая корректировка.</p>
<p>Итак, установим Network Manager при помощи пакетного менеджера <span class="shortcode shortcode-tag"><a href="/ru/tags/apt/" target="_blank">#APT</a></span>:</p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-0
shortcode-codeblock-bash">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-27e6363ee1e185a541c42987d67aedc5" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">apt install network-manager</span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-27e6363ee1e185a541c42987d67aedc5"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<p>Но этого недостаточно. Система будет говорить, что &ldquo;Wired Networks are Unmanaged&rdquo;, потому что всё ещё сетевой конфигурацией управляет не Network Manager. Для исправления этой ситуации, необходимо в <code>/etc/NetworkManager/NetworkManager.conf</code> изменить <code>managed=false</code> на <code>managed=true</code>.</p>
<p>Далее, перезапустить службу:</p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-1
shortcode-codeblock-bash">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-4bb3336dc3426e82fa565e140a84f2ae" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">service NetworkManager restart</span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-4bb3336dc3426e82fa565e140a84f2ae"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<p>На этом всё. Теперь сетевой конфигурацией управляет Network Manager.</p>]]></turbo:content></item><item turbo="true"><title>Распаковка пакетов DEB / RPM</title><link>https://lib.onl/ru/2021/09/b2caccc7-92bf-57ed-970f-136c546f18e2/</link><pubDate>Wed, 08 Sep 2021 09:39:36 +0000</pubDate><dc:creator>Kai Kimera</dc:creator><category>Linux</category><yandex:related><link url="https://lib.onl/ru/2021/09/43b40b92-c29a-504b-87fa-5eac368dcf95/">Отключение установки дополнительных пакетов в Debian APT</link><link url="https://lib.onl/ru/2021/09/aeed7c90-003a-532a-b2c4-3807aaee88fa/">dhclient отправляет 36-значный идентификатор вместо MAC</link><link url="https://lib.onl/ru/2021/05/0acd3f9d-07b7-52b8-9fac-b5cb1cc579e0/">Обновление Fedora Linux до актуальной версии</link><link url="https://lib.onl/ru/2021/05/ee559a6c-5cde-5166-9d2d-3ceb55878eb8/">Debian: Статический IP-адрес</link><link url="https://lib.onl/ru/2020/06/59781965-afe7-5dd5-9798-d1c5ba6cdafd/">Первичная настройка UAIK</link></yandex:related><turbo:extendedHtml>true</turbo:extendedHtml><turbo:source>https://lib.onl/ru/2021/09/b2caccc7-92bf-57ed-970f-136c546f18e2/</turbo:source><turbo:topic>Распаковка пакетов DEB / RPM</turbo:topic><turbo:content><![CDATA[<p>Я собираю пакеты для <span class="shortcode shortcode-tag"><a href="/ru/tags/debian/" target="_blank">#Debian</a></span> и <span class="shortcode shortcode-tag"><a href="/ru/tags/rhel/" target="_blank">#RHEL</a></span>. И зачастую, мне необходимо посмотреть содержимое собранного пакета, чтобы удостоверится в правильности сборки и корректности расположения файлов внутри пакета. В этой статье кратно расскажу, как и при помощи чего можно посмотреть собранные пакеты.</p>
<h2 id="deb">
  <a class="link-body-emphasis" href="#deb">DEB</a>
</h2><p>Пакет <code>.deb</code> архивируется при помощи <a title="" href="https://en.wikipedia.org/wiki/Ar_%28Unix%29" target="_blank"
   rel="noopener noreferrer">ar</a>. Соответственно, распаковать пакет тоже следует через данный архиватор:</p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-0
shortcode-codeblock-bash">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-4699c465436d17e6957eb6a70836edf4" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">ar x example.deb</span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-4699c465436d17e6957eb6a70836edf4"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<ul>
<li><code>debian-binary</code> – файл, содержащий версию формата <code>.deb</code>.</li>
<li><code>control.tar.xz</code> – файл, содержащий md5sums и директорию для сборки пакета.</li>
<li><code>data.tar.xz</code> – архив, содержащий все файлы, которые должны быть установлены в системе при установке пакета.</li>
</ul>
<h2 id="rpm">
  <a class="link-body-emphasis" href="#rpm">RPM</a>
</h2><p>Пакет <code>.rpm</code> содержит архив <code>cpio</code>. Имеется удобная утилита <code>rpm2cpio</code>, которая преобразует <code>.rpm</code> в архив <code>cpio</code>.</p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-1
shortcode-codeblock-bash">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-9bb39fc583a8ab70af6026f0974b7b55" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">rpm2cpio myrpmfile.rpm
</span></span><span class="line"><span class="cl">rpm2cpio - &lt; myrpmfile.rpm
</span></span><span class="line"><span class="cl">rpm2cpio myrpmfile.rpm <span class="p">|</span> cpio -idmv</span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-9bb39fc583a8ab70af6026f0974b7b55"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<p>Опции <code>rpm2cpio</code>:</p>
<ul>
<li><code>-i</code> - восстановить архив.</li>
<li><code>-d</code> - создать необходимые каталоги.</li>
<li><code>-m</code> - сохранить время модификации файлов.</li>
<li><code>-v</code> - подробный вывод процесса преобразования.</li>
</ul>
<p>Также, просматривать <code>.rpm</code> можно при помощи файлового менеджера Midnight Commander (<span class="shortcode shortcode-tag">MC</span>) (<code>mc</code>).</p>]]></turbo:content></item><item turbo="true"><title>Отключение установки дополнительных пакетов в Debian APT</title><link>https://lib.onl/ru/2021/09/43b40b92-c29a-504b-87fa-5eac368dcf95/</link><pubDate>Tue, 07 Sep 2021 13:07:46 +0000</pubDate><dc:creator>Kai Kimera</dc:creator><category>Linux</category><yandex:related><link url="https://lib.onl/ru/2021/09/aeed7c90-003a-532a-b2c4-3807aaee88fa/">dhclient отправляет 36-значный идентификатор вместо MAC</link><link url="https://lib.onl/ru/2021/05/ee559a6c-5cde-5166-9d2d-3ceb55878eb8/">Debian: Статический IP-адрес</link></yandex:related><turbo:extendedHtml>true</turbo:extendedHtml><turbo:source>https://lib.onl/ru/2021/09/43b40b92-c29a-504b-87fa-5eac368dcf95/</turbo:source><turbo:topic>Отключение установки дополнительных пакетов в Debian APT</turbo:topic><turbo:content><![CDATA[<p>Стандартное действие <span class="shortcode shortcode-tag"><a href="/ru/tags/apt/" target="_blank">#APT</a></span> при установке пакета, это установить дополнительные рекомендуемые пакеты. Но, к примеру, мне рекомендуемые пакеты не нужны. Они занимают место и, если я захочу поставить что-то дополнительно, я поставлю это сам.</p>
<p>Ниже приведены две команды, которые позволяют отключить установку рекомендуемых (Recommends) и дополнительных (Suggests) пакетов.</p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-0
shortcode-codeblock-bash">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-d01bb6ee9aa29b6d099c997fe05bd367" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="nb">echo</span> <span class="s1">&#39;APT::Install-Recommends &#34;false&#34;;&#39;</span> &gt; /etc/apt/apt.conf.d/00InstallRecommends</span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-d01bb6ee9aa29b6d099c997fe05bd367"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>











  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-1
shortcode-codeblock-bash">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-1571efd5c2e6b25806ec6580c9d29744" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="nb">echo</span> <span class="s1">&#39;APT::Install-Suggests &#34;false&#34;;&#39;</span> &gt; /etc/apt/apt.conf.d/00InstallSuggests</span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-1571efd5c2e6b25806ec6580c9d29744"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<p>Стоит заметить, что при установке <span class="shortcode shortcode-tag"><a href="/ru/tags/debian/" target="_blank">#Debian</a></span> на завершающем этапе можно отключить рекомендуемые пакеты (в <span class="shortcode shortcode-tag">preseed</span> этот параметр именуется как <code>d-i base-installer/install-recommends boolean false</code>). При этом, после установки, <span class="shortcode shortcode-tag"><a href="/ru/tags/debian/" target="_blank">#Debian</a></span> сам создаст файл <code>00InstallRecommends</code> в <code>/etc/apt/apt.conf.d</code> с соответствующим содержанием.</p>]]></turbo:content></item><item turbo="true"><title>dhclient отправляет 36-значный идентификатор вместо MAC</title><link>https://lib.onl/ru/2021/09/aeed7c90-003a-532a-b2c4-3807aaee88fa/</link><pubDate>Tue, 07 Sep 2021 08:38:24 +0000</pubDate><dc:creator>Kai Kimera</dc:creator><category>Linux</category><yandex:related><link url="https://lib.onl/ru/2021/05/ee559a6c-5cde-5166-9d2d-3ceb55878eb8/">Debian: Статический IP-адрес</link></yandex:related><turbo:extendedHtml>true</turbo:extendedHtml><turbo:source>https://lib.onl/ru/2021/09/aeed7c90-003a-532a-b2c4-3807aaee88fa/</turbo:source><turbo:topic>dhclient отправляет 36-значный идентификатор вместо MAC</turbo:topic><turbo:content><![CDATA[<p>Начиная с <span class="shortcode shortcode-tag"><a href="/ru/tags/debian/" target="_blank">#Debian</a></span> 10 в составе дистрибутива поставляется новая версия <span class="shortcode shortcode-tag"><a href="/ru/tags/dhclient/" target="_blank">#dhclient</a></span>, которая стала более совместимой с RFC. Поэтому, <span class="shortcode shortcode-tag"><a href="/ru/tags/dhclient/" target="_blank">#dhclient</a></span> теперь отправляет не прямой <span class="shortcode shortcode-tag">MAC</span>, а 36-значный идентификатор.</p>
<p>Чтобы указать <span class="shortcode shortcode-tag"><a href="/ru/tags/dhclient/" target="_blank">#dhclient</a></span>&rsquo;у отправлять обычный <span class="shortcode shortcode-tag">MAC</span>, необходимо в <code>/etc/dhcp/dhclient.conf</code> прописать строку:</p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-0
shortcode-codeblock-ini">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-dfca8f3a283973fb67bf0e65b071469b" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-ini" data-lang="ini"><span class="line"><span class="cl"><span class="na">send dhcp-client-identifier</span> <span class="o">=</span> <span class="s">hardware;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-dfca8f3a283973fb67bf0e65b071469b"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<p>Тоже самое при помощи команды:</p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-1
shortcode-codeblock-bash">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-d178e53fb48f9018fd3f8515e5ab69eb" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="nb">echo</span> <span class="s1">&#39;send dhcp-client-identifier = hardware;&#39;</span> &gt;&gt; /etc/dhcp/dhclient.conf</span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-d178e53fb48f9018fd3f8515e5ab69eb"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>]]></turbo:content></item><item turbo="true"><title>Скрипт автоматического удаления устаревших файлов</title><link>https://lib.onl/ru/2021/08/ca744dce-e607-52e6-9952-8ae04e052a5b/</link><pubDate>Thu, 19 Aug 2021 15:03:46 +0000</pubDate><dc:creator>Kai Kimera</dc:creator><category>Разработка</category><category>Скрипты</category><yandex:related><link url="https://lib.onl/ru/2021/05/4a3b0a31-0d3d-5a9b-8c07-7e3b4f80669e/">Рекурсивное изменение прав доступа на файлы и директории</link></yandex:related><turbo:extendedHtml>true</turbo:extendedHtml><turbo:source>https://lib.onl/ru/2021/08/ca744dce-e607-52e6-9952-8ae04e052a5b/</turbo:source><turbo:topic>Скрипт автоматического удаления устаревших файлов</turbo:topic><turbo:content><![CDATA[<p>В одной компании стояла задача сделать файловый архив-помойку для хранения и пересылки документации в сторонние организации. Я накидал на <span class="shortcode shortcode-tag"><a href="/ru/tags/php/" target="_blank">#PHP</a></span> самописный интерфейс для загрузки файлов, а на <span class="shortcode shortcode-tag"><a href="/ru/tags/bash/" target="_blank">#bash</a></span>&rsquo;е сделал скрипт автоматического удаления устаревших файлов. Небольшая заметка об этом скрипте.</p>
<p>Скрипт для удаления устаревших файлов очень прост, написан на <span class="shortcode shortcode-tag"><a href="/ru/tags/bash/" target="_blank">#bash</a></span>&rsquo;е и основывается на утилите <code>find</code>. Утилита <code>find</code> имеет опцию <code>-mtime</code>, при помощи которого можно сделать выборку файлов по времени изменения:</p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-0
shortcode-codeblock-bash">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-945a1a003f7b866dd34c3abe28ddf34d" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">find <span class="s2">&#34;/home/user&#34;</span> -type f -mtime +3</span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-945a1a003f7b866dd34c3abe28ddf34d"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<p>Здесь мы говорим утилите <code>find</code>, что необходимо найти и показать файлы, у которых с даты последнего изменения прошло более 3 дней. Если необходимо вывести файлы, дата изменения которых будет менее <code>3</code> дней, то ставим отрицательное значение <code>-3</code>.</p>
<p>Далее, конструируем конвейер, и при помощи <code>xargs</code> указываем команду удаления <code>rm -f</code>:</p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-1
shortcode-codeblock-bash">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-dac5ed1216932b30dcb2acf23d7b0ddf" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">find <span class="s2">&#34;/home/user&#34;</span> -type f -mtime +3 -print0 <span class="p">|</span> xargs -0 rm -f</span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-dac5ed1216932b30dcb2acf23d7b0ddf"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<p>Сам скрипт провожу ниже.</p>
<h2 id="скрипт">
  <a class="link-body-emphasis" href="#%d1%81%d0%ba%d1%80%d0%b8%d0%bf%d1%82">Скрипт</a>
</h2>
    

    
        
            
            <div class="shortcode shortcode-file mb-3">
              <div class="card overflow-hidden" data-bs-theme="dark">
                <div class="card-header">
                  <div class="d-flex align-items-center">
                    <div class="flex-shrink-0">
                      <i class="far fa-file-code fa-fw"></i>
                    </div>
                    <div class="flex-grow-1 mx-2 text-truncate">
                      <code>delete-files.sh</code>
                    </div>
                    <div class="flex-shrink-0">
                      <ul class="list-inline mb-0">
                        <li class="list-inline-item" title='Копировать'>
                          <a class="text-body" href="#"
                             data-fn="clipboard" data-clipboard-target="#cp-83b96e586a85586d98c1cc10ae78c42b"
                             role="button" aria-label='Копировать'>
                            <i class="fas fa-copy fa-fw"></i>
                          </a>
                        </li>
                        <li class="list-inline-item" title='Скачать'>
                          <a class="text-body" href="/ru/2021/08/ca744dce-e607-52e6-9952-8ae04e052a5b/delete-files.sh" download
                             role="button" aria-label='Скачать'>
                            <i class="fas fa-download fa-fw"></i>
                          </a>
                        </li>
                        <li class="list-inline-item" title='Открыть'>
                          <a class="text-body" href="/ru/2021/08/ca744dce-e607-52e6-9952-8ae04e052a5b/delete-files.sh" target="_blank"
                             role="button" aria-label='Открыть'>
                            <i class="fas fa-arrow-up-right-from-square fa-fw"></i>
                          </a>
                        </li>
                      </ul>
                    </div>
                  </div>
                </div>
                <div class="card-body p-0 overflow-auto" id="cp-83b96e586a85586d98c1cc10ae78c42b">
                    
                        
                    
                    <div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sh" data-lang="sh"><span class="line"><span class="cl"><span class="cp">#!/usr/bin/env -S bash -eu
</span></span></span><span class="line"><span class="cl"><span class="cp"></span><span class="c1"># -------------------------------------------------------------------------------------------------------------------- #</span>
</span></span><span class="line"><span class="cl"><span class="c1"># DELETING OUTDATED FILES</span>
</span></span><span class="line"><span class="cl"><span class="c1"># Script for automatically deleting outdated files.</span>
</span></span><span class="line"><span class="cl"><span class="c1"># -------------------------------------------------------------------------------------------------------------------- #</span>
</span></span><span class="line"><span class="cl"><span class="c1"># @package    Bash</span>
</span></span><span class="line"><span class="cl"><span class="c1"># @author     Kai Kimera &lt;mail@kai.kim&gt;</span>
</span></span><span class="line"><span class="cl"><span class="c1"># @copyright  2023 Library Online</span>
</span></span><span class="line"><span class="cl"><span class="c1"># @license    MIT</span>
</span></span><span class="line"><span class="cl"><span class="c1"># @version    0.1.0</span>
</span></span><span class="line"><span class="cl"><span class="c1"># @link       https://lib.onl/ru/2021/08/ca744dce-e607-52e6-9952-8ae04e052a5b/</span>
</span></span><span class="line"><span class="cl"><span class="c1"># -------------------------------------------------------------------------------------------------------------------- #</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nv">days</span><span class="o">=</span><span class="s2">&#34;</span><span class="si">${</span><span class="nv">1</span><span class="si">}</span><span class="s2">&#34;</span><span class="p">;</span> <span class="nv">dir</span><span class="o">=</span><span class="s2">&#34;</span><span class="si">${</span><span class="nv">2</span><span class="si">}</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="o">{</span> find <span class="s2">&#34;</span><span class="si">${</span><span class="nv">dir</span><span class="si">}</span><span class="s2">&#34;</span> -type f -mtime <span class="s2">&#34;+</span><span class="si">${</span><span class="nv">days</span><span class="si">}</span><span class="s2">&#34;</span> -print0 <span class="p">|</span> xargs -0 rm -f<span class="p">;</span> <span class="o">}</span> <span class="o">&amp;&amp;</span> <span class="nb">exit</span> <span class="m">0</span></span></span></code></pre></td></tr></table>
</div>
</div>
                </div>
              </div>
            </div>
        
    
<p>В скрипте я вынес некоторые значения в переменные для удобной перенастройки. Вызывается скрипт следующем образом:</p>











<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-2 shortcode-codeblock-terminal
shortcode-codeblock-terminal-linux
shortcode-codeblock-terminal-linux-user">
  <div class="card overflow-hidden" data-bs-theme="dark">
    <div class="card-header">
      <div class="d-flex align-items-center">
        <div class="flex-shrink-0 ">
          <i class="fas fa-terminal fa-fw"></i>
        </div>
        <div class="flex-grow-1 mx-2">
          <h5 class="mb-0">Терминал</h5>
        </div>
        <div class="flex-shrink-0">
          <ul class="list-inline mb-0">
            <li class="list-inline-item" title='Копировать'>
              <a class="text-body" href="#"
                 data-fn="clipboard" data-clipboard-target="#cp-d87ea66cd780022e87e827537860f4da"
                 role="button" aria-label='Копировать'>
                <i class="fas fa-copy fa-fw"></i>
              </a>
            </li>
          </ul>
        </div>
      </div>
    </div>
    <div class="card-body p-0 overflow-auto" id="cp-d87ea66cd780022e87e827537860f4da"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-plaintext" data-lang="plaintext"><span class="line"><span class="cl">delete-files.sh &#34;3&#34; &#34;/path/to/storage&#34;</span></span></code></pre></td></tr></table>
</div>
</div></div>
  </div>
</div>
<p>Где:</p>
<ul>
<li><code>3</code> - количество дней, прошедших с момента последнего изменения файла.</li>
<li><code>/path/to/storage</code> - путь к файловому хранилищу, в котором необходимо удалять устаревшие файлы.</li>
</ul>
<h2 id="автоматический-запуск-по-расписанию">
  <a class="link-body-emphasis" href="#%d0%b0%d0%b2%d1%82%d0%be%d0%bc%d0%b0%d1%82%d0%b8%d1%87%d0%b5%d1%81%d0%ba%d0%b8%d0%b9-%d0%b7%d0%b0%d0%bf%d1%83%d1%81%d0%ba-%d0%bf%d0%be-%d1%80%d0%b0%d1%81%d0%bf%d0%b8%d1%81%d0%b0%d0%bd%d0%b8%d1%8e">Автоматический запуск по расписанию</a>
</h2><p>Осталось добавить выполнение скрипта по <span class="shortcode shortcode-tag">cron</span>&rsquo;у. Я указал время <code>23:59</code>, когда нагрузка на файловое хранилище минимальна:</p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-3
shortcode-codeblock-bash">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-ee080004ddddb0a214f60874d2a737a4" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="c1"># Check &amp; remove old files in 23:59 every day.</span>
</span></span><span class="line"><span class="cl"><span class="m">59</span> <span class="m">23</span> * * * <span class="o">[</span>username<span class="o">]</span> /usr/bin/bash /path/to/delete-files.sh <span class="s2">&#34;3&#34;</span> <span class="s2">&#34;/path/to/storage&#34;</span> &gt; /dev/null 2&gt;<span class="p">&amp;</span><span class="m">1</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-ee080004ddddb0a214f60874d2a737a4"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>]]></turbo:content></item><item turbo="true"><title>Интересные модули Drupal</title><link>https://lib.onl/ru/2021/08/28fa2886-aea6-5abc-9da8-43be56283cdb/</link><pubDate>Wed, 18 Aug 2021 06:58:21 +0000</pubDate><dc:creator>Kai Kimera</dc:creator><category>CMF</category><category>В доработке</category><yandex:related><link url="https://lib.onl/ru/2021/08/8ddf3622-5dd8-5101-9c40-2f3e08f4a579/">XenForo: Первичные настройки движка и параметры системы</link><link url="https://lib.onl/ru/2020/08/5d35edd8-f0e3-5b39-afd3-2ac3b15b8c4f/">Генератор идентификаторов расширений</link><link url="https://lib.onl/ru/2021/08/f9a39e37-8816-5f80-8133-893f3dc8f352/">Условия в шаблонах XenForo 2</link></yandex:related><turbo:extendedHtml>true</turbo:extendedHtml><turbo:source>https://lib.onl/ru/2021/08/28fa2886-aea6-5abc-9da8-43be56283cdb/</turbo:source><turbo:topic>Интересные модули Drupal</turbo:topic><turbo:content><![CDATA[<p>Здесь собраны ссылки на интересные и необходимые для меня в работе модули <span class="shortcode shortcode-tag"><a href="/ru/tags/drupal/" target="_blank">#Drupal</a></span>.</p>
<h2 id="permissions-by-term">
  <a class="link-body-emphasis" href="#permissions-by-term">Permissions by Term</a>
</h2><p><a title="" href="https://www.drupal.org/project/permissions_by_term" target="_blank"
   rel="noopener noreferrer">Модуль</a> позволяет применять права доступа к материалу путём добавления термина таксономии.</p>
<h2 id="node-view-permissions">
  <a class="link-body-emphasis" href="#node-view-permissions">Node View Permissions</a>
</h2><p><a title="" href="https://www.drupal.org/project/node_view_permissions" target="_blank"
   rel="noopener noreferrer">Модуль</a> разрешает или запрещает просматривать материал определённым ролям пользователей. Подобная функция была в Drupal 6, но в последующих версиях её убрали.</p>
<h2 id="poll">
  <a class="link-body-emphasis" href="#poll">Poll</a>
</h2><p><a title="" href="https://www.drupal.org/project/poll" target="_blank"
   rel="noopener noreferrer">Модуль</a> опросов. Позволяет создавать опросы в различной конфигурации.</p>
<h2 id="scheduler">
  <a class="link-body-emphasis" href="#scheduler">Scheduler</a>
</h2><p>Очень полезный <a title="" href="https://www.drupal.org/project/scheduler" target="_blank"
   rel="noopener noreferrer">модуль</a>, особенно редакторам. Модуль позволяет создавать отложенные материалы, которые необходимо опубликовать через определённое время.</p>]]></turbo:content></item><item turbo="true"><title>XenForo: Первичные настройки движка и параметры системы</title><link>https://lib.onl/ru/2021/08/8ddf3622-5dd8-5101-9c40-2f3e08f4a579/</link><pubDate>Wed, 18 Aug 2021 06:55:19 +0000</pubDate><dc:creator>Kai Kimera</dc:creator><category>CMF</category><category>Разработка</category><category>Скрипты</category><yandex:related><link url="https://lib.onl/ru/2021/08/f9a39e37-8816-5f80-8133-893f3dc8f352/">Условия в шаблонах XenForo 2</link><link url="https://lib.onl/ru/2020/08/5d35edd8-f0e3-5b39-afd3-2ac3b15b8c4f/">Генератор идентификаторов расширений</link></yandex:related><turbo:extendedHtml>true</turbo:extendedHtml><turbo:source>https://lib.onl/ru/2021/08/8ddf3622-5dd8-5101-9c40-2f3e08f4a579/</turbo:source><turbo:topic>XenForo: Первичные настройки движка и параметры системы</turbo:topic><turbo:content><![CDATA[<p>У меня в проекте находятся несколько форумов на движке <span class="shortcode shortcode-tag"><a href="/ru/tags/xenforo/" target="_blank">#XenForo</a></span>. Здесь я собрал для себя первичные параметры и настройки движка <span class="shortcode shortcode-tag"><a href="/ru/tags/xenforo/" target="_blank">#XenForo</a></span>.</p>
<h2 id="файл-конфигурации">
  <a class="link-body-emphasis" href="#%d1%84%d0%b0%d0%b9%d0%bb-%d0%ba%d0%be%d0%bd%d1%84%d0%b8%d0%b3%d1%83%d1%80%d0%b0%d1%86%d0%b8%d0%b8">Файл конфигурации</a>
</h2><p>Примеры параметров в файле <code>config.php</code> для первоначальной установки и запуска системы.</p>

    

    
        
            
            <div class="shortcode shortcode-file mb-3">
              <div class="card overflow-hidden" data-bs-theme="dark">
                <div class="card-header">
                  <div class="d-flex align-items-center">
                    <div class="flex-shrink-0">
                      <i class="far fa-file-code fa-fw"></i>
                    </div>
                    <div class="flex-grow-1 mx-2 text-truncate">
                      <code>config.php</code>
                    </div>
                    <div class="flex-shrink-0">
                      <ul class="list-inline mb-0">
                        <li class="list-inline-item" title='Копировать'>
                          <a class="text-body" href="#"
                             data-fn="clipboard" data-clipboard-target="#cp-431e339b1926a33babaf60b0e115297b"
                             role="button" aria-label='Копировать'>
                            <i class="fas fa-copy fa-fw"></i>
                          </a>
                        </li>
                        <li class="list-inline-item" title='Скачать'>
                          <a class="text-body" href="/ru/2021/08/8ddf3622-5dd8-5101-9c40-2f3e08f4a579/config.php" download
                             role="button" aria-label='Скачать'>
                            <i class="fas fa-download fa-fw"></i>
                          </a>
                        </li>
                        <li class="list-inline-item" title='Открыть'>
                          <a class="text-body" href="/ru/2021/08/8ddf3622-5dd8-5101-9c40-2f3e08f4a579/config.php" target="_blank"
                             role="button" aria-label='Открыть'>
                            <i class="fas fa-arrow-up-right-from-square fa-fw"></i>
                          </a>
                        </li>
                      </ul>
                    </div>
                  </div>
                </div>
                <div class="card-body p-0 overflow-auto" id="cp-431e339b1926a33babaf60b0e115297b">
                    
                        
                    
                    <div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="o">&lt;?</span><span class="nx">php</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Database.
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nv">$config</span><span class="p">[</span><span class="s1">&#39;db&#39;</span><span class="p">][</span><span class="s1">&#39;host&#39;</span><span class="p">]</span>                             <span class="o">=</span> <span class="s1">&#39;127.0.0.1&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="nv">$config</span><span class="p">[</span><span class="s1">&#39;db&#39;</span><span class="p">][</span><span class="s1">&#39;port&#39;</span><span class="p">]</span>                             <span class="o">=</span> <span class="mi">3306</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="nv">$config</span><span class="p">[</span><span class="s1">&#39;db&#39;</span><span class="p">][</span><span class="s1">&#39;username&#39;</span><span class="p">]</span>                         <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="nv">$config</span><span class="p">[</span><span class="s1">&#39;db&#39;</span><span class="p">][</span><span class="s1">&#39;password&#39;</span><span class="p">]</span>                         <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="nv">$config</span><span class="p">[</span><span class="s1">&#39;db&#39;</span><span class="p">][</span><span class="s1">&#39;dbname&#39;</span><span class="p">]</span>                           <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="nv">$config</span><span class="p">[</span><span class="s1">&#39;db&#39;</span><span class="p">][</span><span class="s1">&#39;socket&#39;</span><span class="p">]</span>                           <span class="o">=</span> <span class="k">null</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Unicode support.
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nv">$config</span><span class="p">[</span><span class="s1">&#39;fullUnicode&#39;</span><span class="p">]</span>                            <span class="o">=</span> <span class="k">true</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Site-wide feature.
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nv">$config</span><span class="p">[</span><span class="s1">&#39;enableTfa&#39;</span><span class="p">]</span>                              <span class="o">=</span> <span class="k">false</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="nv">$config</span><span class="p">[</span><span class="s1">&#39;enableApi&#39;</span><span class="p">]</span>                              <span class="o">=</span> <span class="k">false</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="nv">$config</span><span class="p">[</span><span class="s1">&#39;enableOneClickUpgrade&#39;</span><span class="p">]</span>                  <span class="o">=</span> <span class="k">false</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Cookie.
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nv">$config</span><span class="p">[</span><span class="s1">&#39;cookie&#39;</span><span class="p">][</span><span class="s1">&#39;prefix&#39;</span><span class="p">]</span>                       <span class="o">=</span> <span class="s1">&#39;xf_&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Data and script locations.
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nv">$config</span><span class="p">[</span><span class="s1">&#39;externalDataPath&#39;</span><span class="p">]</span>                       <span class="o">=</span> <span class="s1">&#39;storage/data&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="nv">$config</span><span class="p">[</span><span class="s1">&#39;externalDataUrl&#39;</span><span class="p">]</span>                        <span class="o">=</span> <span class="s1">&#39;storage/data&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="nv">$config</span><span class="p">[</span><span class="s1">&#39;internalDataPath&#39;</span><span class="p">]</span>                       <span class="o">=</span> <span class="s1">&#39;storage/data.int&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="nv">$config</span><span class="p">[</span><span class="s1">&#39;codeCachePath&#39;</span><span class="p">]</span>                          <span class="o">=</span> <span class="s1">&#39;%s/cache/code&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="nv">$config</span><span class="p">[</span><span class="s1">&#39;tempDataPath&#39;</span><span class="p">]</span>                           <span class="o">=</span> <span class="s1">&#39;%s/temp&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="nv">$config</span><span class="p">[</span><span class="s1">&#39;javaScriptUrl&#39;</span><span class="p">]</span>                          <span class="o">=</span> <span class="s1">&#39;js&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Auth.
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nv">$config</span><span class="p">[</span><span class="s1">&#39;auth&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">  <span class="s1">&#39;algo&#39;</span> <span class="o">=&gt;</span> <span class="nx">PASSWORD_ARGON2ID</span>
</span></span><span class="line"><span class="cl"><span class="p">];</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Cache.
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="cm">/*
</span></span></span><span class="line"><span class="cl"><span class="cm">$config[&#39;cache&#39;][&#39;enabled&#39;]                       = true;
</span></span></span><span class="line"><span class="cl"><span class="cm">$config[&#39;cache&#39;][&#39;provider&#39;]                      = &#39;Redis&#39;;
</span></span></span><span class="line"><span class="cl"><span class="cm">$config[&#39;cache&#39;][&#39;config&#39;]                        = [
</span></span></span><span class="line"><span class="cl"><span class="cm">  &#39;host&#39; =&gt; &#39;127.0.0.1&#39;,
</span></span></span><span class="line"><span class="cl"><span class="cm">  &#39;password&#39; =&gt; &#39;&#39;,
</span></span></span><span class="line"><span class="cl"><span class="cm">  &#39;database&#39; =&gt; 1
</span></span></span><span class="line"><span class="cl"><span class="cm">];
</span></span></span><span class="line"><span class="cl"><span class="cm">*/</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Guest page caching.
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="cm">/*
</span></span></span><span class="line"><span class="cl"><span class="cm">$config[&#39;pageCache&#39;][&#39;enabled&#39;]                   = true;
</span></span></span><span class="line"><span class="cl"><span class="cm">$config[&#39;cache&#39;][&#39;context&#39;][&#39;page&#39;][&#39;provider&#39;]   = &#39;Filesystem&#39;;
</span></span></span><span class="line"><span class="cl"><span class="cm">$config[&#39;cache&#39;][&#39;context&#39;][&#39;page&#39;][&#39;config&#39;]     = [
</span></span></span><span class="line"><span class="cl"><span class="cm">  &#39;directory&#39; =&gt; &#39;&#39;
</span></span></span><span class="line"><span class="cl"><span class="cm">];
</span></span></span><span class="line"><span class="cl"><span class="cm">*/</span></span></span></code></pre></td></tr></table>
</div>
</div>
                </div>
              </div>
            </div>
        
    
<h2 id="регистрация-пользователей">
  <a class="link-body-emphasis" href="#%d1%80%d0%b5%d0%b3%d0%b8%d1%81%d1%82%d1%80%d0%b0%d1%86%d0%b8%d1%8f-%d0%bf%d0%be%d0%bb%d1%8c%d0%b7%d0%be%d0%b2%d0%b0%d1%82%d0%b5%d0%bb%d0%b5%d0%b9">Регистрация пользователей</a>
</h2><p>Параметры для регистрации пользователей.</p>
<p><strong>Регулярное выражение:</strong></p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-0
shortcode-codeblock-text">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-cb8fe3bdda1050d0e783de3b801f68d7" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-text" data-lang="text"><span class="line"><span class="cl">#(?!^[\d\-\_\s]+$)^(([a-zA-Z0-9\-\_\s]+)|(((\xD0[\x80-\xBF])|(\xD1[\x80-\xBF])|([0-9\-\_\s]))+))$#</span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-cb8fe3bdda1050d0e783de3b801f68d7"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<h2 id="теги">
  <a class="link-body-emphasis" href="#%d1%82%d0%b5%d0%b3%d0%b8">Теги</a>
</h2><p>Параметры для ввода тегов.</p>
<p><strong>Регулярное выражение:</strong></p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-1
shortcode-codeblock-text">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-5144a3202d08cb9e58df1f20b8e445df" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-text" data-lang="text"><span class="line"><span class="cl">#(?!^[\d\-\_\s]+$)^(([a-zA-Z0-9\-\_\s]+)|(((\xD0[\x80-\xBF])|(\xD1[\x80-\xBF])|([0-9\-\_\s]))+))$#</span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-5144a3202d08cb9e58df1f20b8e445df"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<h2 id="группы-пользователей">
  <a class="link-body-emphasis" href="#%d0%b3%d1%80%d1%83%d0%bf%d0%bf%d1%8b-%d0%bf%d0%be%d0%bb%d1%8c%d0%b7%d0%be%d0%b2%d0%b0%d1%82%d0%b5%d0%bb%d0%b5%d0%b9">Группы пользователей</a>
</h2><p>Настройки групп пользователей.</p>
<p><strong>Стандартные группы:</strong></p>
<ul>
<li>Unregistered / Unconfirmed <code>ID(1)</code></li>
<li>Registered <code>ID(2)</code></li>
<li>Administrative <code>ID(3)</code></li>
<li>Moderating <code>ID(4)</code></li>
</ul>]]></turbo:content></item><item turbo="true"><title>Условия в шаблонах XenForo 2</title><link>https://lib.onl/ru/2021/08/f9a39e37-8816-5f80-8133-893f3dc8f352/</link><pubDate>Tue, 17 Aug 2021 12:21:10 +0000</pubDate><dc:creator>Kai Kimera</dc:creator><category>CMF</category><yandex:related><link url="https://lib.onl/ru/2020/08/5d35edd8-f0e3-5b39-afd3-2ac3b15b8c4f/">Генератор идентификаторов расширений</link></yandex:related><turbo:extendedHtml>true</turbo:extendedHtml><turbo:source>https://lib.onl/ru/2021/08/f9a39e37-8816-5f80-8133-893f3dc8f352/</turbo:source><turbo:topic>Условия в шаблонах XenForo 2</turbo:topic><turbo:content><![CDATA[<p>Представляю список условий, которые можно использовать в шаблонах <span class="shortcode shortcode-tag"><a href="/ru/tags/xenforo/" target="_blank">#XenForo</a></span>. Все возможные условия перечислить затруднительно, потому что существует множество различных вариантов фильтрации и выборки информации. Здесь представлены наиболее популярные варианты.</p>
<p>С этой статьи я начинаю попытку восстановления накопленных данных за период моей деятельности в качестве исследователя и разработчика веб-приложений.</p>
<h2 id="условия-в-шаблонах">
  <a class="link-body-emphasis" href="#%d1%83%d1%81%d0%bb%d0%be%d0%b2%d0%b8%d1%8f-%d0%b2-%d1%88%d0%b0%d0%b1%d0%bb%d0%be%d0%bd%d0%b0%d1%85">Условия в шаблонах</a>
</h2><ol>
<li>Отображение информации только администраторам.</li>
</ol>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-0
shortcode-codeblock-html">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-5c5fa01fe2e5ff7f8242c1c5245196a1" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-html" data-lang="html"><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">xf:if</span> <span class="na">is</span><span class="o">=</span><span class="s">&#34;$xf.visitor.is_admin&#34;</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="c">&lt;!-- content --&gt;</span>
</span></span><span class="line"><span class="cl"><span class="p">&lt;/</span><span class="nt">xf:if</span><span class="p">&gt;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-5c5fa01fe2e5ff7f8242c1c5245196a1"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<ol start="2">
<li>Отображение информации только модераторам.</li>
</ol>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-1
shortcode-codeblock-html">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-1269e19a0c99a9247466024021d0b442" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-html" data-lang="html"><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">xf:if</span> <span class="na">is</span><span class="o">=</span><span class="s">&#34;$xf.visitor.is_moderator&#34;</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="c">&lt;!-- content --&gt;</span>
</span></span><span class="line"><span class="cl"><span class="p">&lt;/</span><span class="nt">xf:if</span><span class="p">&gt;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-1269e19a0c99a9247466024021d0b442"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<ol start="3">
<li>Отображение информации только администраторам и модераторам.</li>
</ol>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-2
shortcode-codeblock-html">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-63af4496ff4898d1bd8b8c4b21d0b601" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-html" data-lang="html"><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">xf:if</span> <span class="na">is</span><span class="o">=</span><span class="s">&#34;$xf.visitor.is_admin OR $xf.visitor.is_moderator&#34;</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="c">&lt;!-- content --&gt;</span>
</span></span><span class="line"><span class="cl"><span class="p">&lt;/</span><span class="nt">xf:if</span><span class="p">&gt;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-63af4496ff4898d1bd8b8c4b21d0b601"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<ol start="4">
<li>Отображение информации только зарегистрированному пользователю</li>
</ol>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-3
shortcode-codeblock-html">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-8809233f8b93f355675989811cc34109" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-html" data-lang="html"><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">xf:if</span> <span class="na">is</span><span class="o">=</span><span class="s">&#34;$xf.visitor.user_id&#34;</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="c">&lt;!-- content --&gt;</span>
</span></span><span class="line"><span class="cl"><span class="p">&lt;/</span><span class="nt">xf:if</span><span class="p">&gt;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-8809233f8b93f355675989811cc34109"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<ol start="5">
<li>Отображение информации гостю.</li>
</ol>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-4
shortcode-codeblock-html">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-c0e8f66aee357ab3df9da80c0cfdddcd" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-html" data-lang="html"><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">xf:if</span> <span class="na">is</span><span class="o">=</span><span class="s">&#34;!$xf.visitor.user_id&#34;</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="c">&lt;!-- content --&gt;</span>
</span></span><span class="line"><span class="cl"><span class="p">&lt;/</span><span class="nt">xf:if</span><span class="p">&gt;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-c0e8f66aee357ab3df9da80c0cfdddcd"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<ol start="6">
<li>Отображение разной информации зарегистрированному пользователю и гостю.</li>
</ol>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-5
shortcode-codeblock-html">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-990b8131eb297a2b3e36f0955b10ca64" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-html" data-lang="html"><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">xf:if</span> <span class="na">is</span><span class="o">=</span><span class="s">&#34;!$xf.visitor.user_id&#34;</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="c">&lt;!-- content for members --&gt;</span>
</span></span><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">xf:else</span> <span class="p">/&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="c">&lt;!-- content for guests --&gt;</span>
</span></span><span class="line"><span class="cl"><span class="p">&lt;/</span><span class="nt">xf:if</span><span class="p">&gt;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-990b8131eb297a2b3e36f0955b10ca64"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<ol start="7">
<li>Отображение информации только заблокированным пользователям.</li>
</ol>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-6
shortcode-codeblock-html">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-ac7fa0492bc72097ebebb4c96fa5cca7" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-html" data-lang="html"><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">xf:if</span> <span class="na">is</span><span class="o">=</span><span class="s">&#34;$user.is_banned&#34;</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="c">&lt;!-- content --&gt;</span>
</span></span><span class="line"><span class="cl"><span class="p">&lt;/</span><span class="nt">xf:if</span><span class="p">&gt;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-ac7fa0492bc72097ebebb4c96fa5cca7"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<ol start="8">
<li>Отображение информации только если у пользователя симпатий больше определённого количества.</li>
</ol>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-7
shortcode-codeblock-html">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-1921cafca76a6f6538d598eb7f6d83fe" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-html" data-lang="html"><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">xf:if</span> <span class="na">is</span><span class="o">=</span><span class="s">&#34;$user.like_count|number &gt; X&#34;</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="c">&lt;!-- content --&gt;</span>
</span></span><span class="line"><span class="cl"><span class="p">&lt;/</span><span class="nt">xf:if</span><span class="p">&gt;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-1921cafca76a6f6538d598eb7f6d83fe"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<ol start="9">
<li>Отображение информации только если у пользователя сообщений больше определённого количества.</li>
</ol>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-8
shortcode-codeblock-html">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-1ff438037bfee2489710750b0f225dea" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-html" data-lang="html"><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">xf:if</span> <span class="na">is</span><span class="o">=</span><span class="s">&#34;{$xf.visitor.message_count|number} &gt; X&#34;</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="c">&lt;!-- content --&gt;</span>
</span></span><span class="line"><span class="cl"><span class="p">&lt;/</span><span class="nt">xf:if</span><span class="p">&gt;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-1ff438037bfee2489710750b0f225dea"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<ol start="10">
<li>Отображение информации только если у пользователя очков больше определённого количества.</li>
</ol>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-9
shortcode-codeblock-html">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-f8e3360dc304cd3970466df8c59c58b2" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-html" data-lang="html"><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">xf:if</span> <span class="na">is</span><span class="o">=</span><span class="s">&#34;$user.trophy_points|number &gt; X&#34;</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="c">&lt;!-- content --&gt;</span>
</span></span><span class="line"><span class="cl"><span class="p">&lt;/</span><span class="nt">xf:if</span><span class="p">&gt;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-f8e3360dc304cd3970466df8c59c58b2"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<ol start="11">
<li>Отображение информации определённому пользователю.</li>
</ol>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-10
shortcode-codeblock-html">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-dedaa4658fbbb26e16fc633a4522e4f4" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-html" data-lang="html"><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">xf:if</span> <span class="na">is</span><span class="o">=</span><span class="s">&#34;$xf.visitor.user_id == X&#34;</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="c">&lt;!-- content --&gt;</span>
</span></span><span class="line"><span class="cl"><span class="p">&lt;/</span><span class="nt">xf:if</span><span class="p">&gt;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-dedaa4658fbbb26e16fc633a4522e4f4"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<ol start="12">
<li>Отображение информации определённым пользователям.</li>
</ol>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-11
shortcode-codeblock-html">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-591d8ed60721583ddda67153a6407f95" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-html" data-lang="html"><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">xf:if</span> <span class="na">is</span><span class="o">=</span><span class="s">&#34;in_array($xf.visitor.user_id, [X, Y, Z])&#34;</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="c">&lt;!-- content --&gt;</span>
</span></span><span class="line"><span class="cl"><span class="p">&lt;/</span><span class="nt">xf:if</span><span class="p">&gt;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-591d8ed60721583ddda67153a6407f95"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<ol start="13">
<li>(1) Отображение информации определённым группам пользователей.</li>
</ol>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-12
shortcode-codeblock-html">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-562805b2040f9f2b4a9f95c126134051" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-html" data-lang="html"><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">xf:if</span> <span class="na">is</span><span class="o">=</span><span class="s">&#34;{{$xf.visitor.isMemberOf([X, Y])}}&#34;</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="c">&lt;!-- content --&gt;</span>
</span></span><span class="line"><span class="cl"><span class="p">&lt;/</span><span class="nt">xf:if</span><span class="p">&gt;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-562805b2040f9f2b4a9f95c126134051"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<ol start="13">
<li>(2) Отображение информации определённой группе пользователей.</li>
</ol>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-13
shortcode-codeblock-html">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-37a056ceff25e74af02feea8546153a9" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-html" data-lang="html"><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">xf:if</span> <span class="na">is</span><span class="o">=</span><span class="s">&#34;{{$xf.visitor.isMemberOf(X)}}&#34;</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="c">&lt;!-- content --&gt;</span>
</span></span><span class="line"><span class="cl"><span class="p">&lt;/</span><span class="nt">xf:if</span><span class="p">&gt;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-37a056ceff25e74af02feea8546153a9"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<ol start="14">
<li>(1) Скрытие информации от определённых групп пользователей.</li>
</ol>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-14
shortcode-codeblock-html">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-fe95eaa2ebfc0715d12fa41b9f289a98" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-html" data-lang="html"><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">xf:if</span> <span class="na">is</span><span class="o">=</span><span class="s">&#34;{{!$xf.visitor.isMemberOf([X, Y])}}&#34;</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="c">&lt;!-- content --&gt;</span>
</span></span><span class="line"><span class="cl"><span class="p">&lt;/</span><span class="nt">xf:if</span><span class="p">&gt;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-fe95eaa2ebfc0715d12fa41b9f289a98"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<ol start="14">
<li>(2) Скрытие информации от определённой группы пользователей.</li>
</ol>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-15
shortcode-codeblock-html">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-3453d5fc4d605cc7fa487d03de158f57" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-html" data-lang="html"><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">xf:if</span> <span class="na">is</span><span class="o">=</span><span class="s">&#34;{{!$xf.visitor.isMemberOf(X)}}&#34;</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="c">&lt;!-- content --&gt;</span>
</span></span><span class="line"><span class="cl"><span class="p">&lt;/</span><span class="nt">xf:if</span><span class="p">&gt;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-3453d5fc4d605cc7fa487d03de158f57"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<ol start="15">
<li>(1) Отображение информации после первого сообщения в теме.</li>
</ol>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-16
shortcode-codeblock-html">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-7ce75a2fd355fc2ce65493b0eae016d8" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-html" data-lang="html"><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">xf:if</span> <span class="na">is</span><span class="o">=</span><span class="s">&#34;$post.position % $xf.options.messagesPerPage == 0&#34;</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="c">&lt;!-- content --&gt;</span>
</span></span><span class="line"><span class="cl"><span class="p">&lt;/</span><span class="nt">xf:if</span><span class="p">&gt;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-7ce75a2fd355fc2ce65493b0eae016d8"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<ol start="15">
<li>(2) Отображение информации через определённое количества сообщений.</li>
</ol>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-17
shortcode-codeblock-html">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-a319c92d4f70c8b94b35acb4f229aa4d" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-html" data-lang="html"><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">xf:if</span> <span class="na">is</span><span class="o">=</span><span class="s">&#34;$post.position % $xf.options.messagesPerPage == X&#34;</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="c">&lt;!-- content --&gt;</span>
</span></span><span class="line"><span class="cl"><span class="p">&lt;/</span><span class="nt">xf:if</span><span class="p">&gt;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-a319c92d4f70c8b94b35acb4f229aa4d"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<ol start="16">
<li>Отображение информации на странице, на которой присутствует боковая панель.</li>
</ol>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-18
shortcode-codeblock-html">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-f8b64e89091d03b765bf22a633103e1b" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-html" data-lang="html"><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">xf:if</span> <span class="na">is</span><span class="o">=</span><span class="s">&#34;$sidebar&#34;</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="c">&lt;!-- content --&gt;</span>
</span></span><span class="line"><span class="cl"><span class="p">&lt;/</span><span class="nt">xf:if</span><span class="p">&gt;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-f8b64e89091d03b765bf22a633103e1b"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<ol start="17">
<li>Отображение информации на главной (домашней) странице форума.</li>
</ol>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-19
shortcode-codeblock-html">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-6523408cf54bd87ea6dfd49ee65b550a" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-html" data-lang="html"><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">xf:if</span> <span class="na">is</span><span class="o">=</span><span class="s">&#34;$template == &#39;forum_list&#39;&#34;</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="c">&lt;!-- content --&gt;</span>
</span></span><span class="line"><span class="cl"><span class="p">&lt;/</span><span class="nt">xf:if</span><span class="p">&gt;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-6523408cf54bd87ea6dfd49ee65b550a"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<ol start="18">
<li>Скрытие информации только с главной (домашней) странице форума.</li>
</ol>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-20
shortcode-codeblock-html">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-469c7d6f98f4e233e4b4c74a9918aed2" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-html" data-lang="html"><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">xf:if</span> <span class="na">is</span><span class="o">=</span><span class="s">&#34;$template !== &#39;forum_list&#39;&#34;</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="c">&lt;!-- content --&gt;</span>
</span></span><span class="line"><span class="cl"><span class="p">&lt;/</span><span class="nt">xf:if</span><span class="p">&gt;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-469c7d6f98f4e233e4b4c74a9918aed2"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<ol start="19">
<li>Отображение информации на странице создания новой темы.</li>
</ol>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-21
shortcode-codeblock-html">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-6a27403ccb5139ba854c4d7f9f6df50b" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-html" data-lang="html"><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">xf:if</span> <span class="na">is</span><span class="o">=</span><span class="s">&#34;$template == &#39;forum_post_thread&#39;&#34;</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="c">&lt;!-- content --&gt;</span>
</span></span><span class="line"><span class="cl"><span class="p">&lt;/</span><span class="nt">xf:if</span><span class="p">&gt;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-6a27403ccb5139ba854c4d7f9f6df50b"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<ol start="20">
<li>Скрытие информации на странице создания новой темы.</li>
</ol>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-22
shortcode-codeblock-html">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-4585e45a88f8061ad67211be847eca16" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-html" data-lang="html"><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">xf:if</span> <span class="na">is</span><span class="o">=</span><span class="s">&#34;$template != &#39;forum_post_thread&#39;&#34;</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="c">&lt;!-- content --&gt;</span>
</span></span><span class="line"><span class="cl"><span class="p">&lt;/</span><span class="nt">xf:if</span><span class="p">&gt;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-4585e45a88f8061ad67211be847eca16"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<ol start="21">
<li>Отображение информации на странице создания нового ресурса.</li>
</ol>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-23
shortcode-codeblock-html">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-f51627f1e278977b37a3e605d68829a6" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-html" data-lang="html"><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">xf:if</span> <span class="na">is</span><span class="o">=</span><span class="s">&#34;$template == &#39;xfrm_category_add_resource&#39;&#34;</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="c">&lt;!-- content --&gt;</span>
</span></span><span class="line"><span class="cl"><span class="p">&lt;/</span><span class="nt">xf:if</span><span class="p">&gt;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-f51627f1e278977b37a3e605d68829a6"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<ol start="22">
<li>Скрытие информации на странице создания нового ресурса.</li>
</ol>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-24
shortcode-codeblock-html">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-b87547ff8aba4aa48df2901ad20e1055" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-html" data-lang="html"><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">xf:if</span> <span class="na">is</span><span class="o">=</span><span class="s">&#34;$template != &#39;xfrm_category_add_resource&#39;&#34;</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="c">&lt;!-- content --&gt;</span>
</span></span><span class="line"><span class="cl"><span class="p">&lt;/</span><span class="nt">xf:if</span><span class="p">&gt;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-b87547ff8aba4aa48df2901ad20e1055"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<ol start="23">
<li>Отображение информации на странице поисковой формы.</li>
</ol>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-25
shortcode-codeblock-html">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-f64912ea79e229fde0feb0b82dcc00f0" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-html" data-lang="html"><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">xf:if</span> <span class="na">is</span><span class="o">=</span><span class="s">&#34;$template == &#39;search_form&#39;&#34;</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="c">&lt;!-- content --&gt;</span>
</span></span><span class="line"><span class="cl"><span class="p">&lt;/</span><span class="nt">xf:if</span><span class="p">&gt;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-f64912ea79e229fde0feb0b82dcc00f0"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<ol start="24">
<li>Скрытие информации на странице поисковой формы.</li>
</ol>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-26
shortcode-codeblock-html">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-e2769f6d5cd2a4a2663e5dec326d07d6" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-html" data-lang="html"><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">xf:if</span> <span class="na">is</span><span class="o">=</span><span class="s">&#34;$template != &#39;search_form&#39;&#34;</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="c">&lt;!-- content --&gt;</span>
</span></span><span class="line"><span class="cl"><span class="p">&lt;/</span><span class="nt">xf:if</span><span class="p">&gt;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-e2769f6d5cd2a4a2663e5dec326d07d6"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<ol start="25">
<li>Отображение информации на странице &ldquo;Что нового?&rdquo;.</li>
</ol>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-27
shortcode-codeblock-html">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-300518bc51085beb488c9b6e29b3f745" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-html" data-lang="html"><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">xf:if</span> <span class="na">is</span><span class="o">=</span><span class="s">&#34;$template == &#39;whats_new&#39;&#34;</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="c">&lt;!-- content --&gt;</span>
</span></span><span class="line"><span class="cl"><span class="p">&lt;/</span><span class="nt">xf:if</span><span class="p">&gt;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-300518bc51085beb488c9b6e29b3f745"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<ol start="26">
<li>Скрытие информации на странице &ldquo;Что нового?&rdquo;.</li>
</ol>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-28
shortcode-codeblock-html">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-6c5c266a46bf81eeaca36eab2c61dd42" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-html" data-lang="html"><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">xf:if</span> <span class="na">is</span><span class="o">=</span><span class="s">&#34;$template != &#39;whats_new&#39;&#34;</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="c">&lt;!-- content --&gt;</span>
</span></span><span class="line"><span class="cl"><span class="p">&lt;/</span><span class="nt">xf:if</span><span class="p">&gt;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-6c5c266a46bf81eeaca36eab2c61dd42"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<ol start="27">
<li>Отображение информации на странице просмотра личной переписки.</li>
</ol>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-29
shortcode-codeblock-html">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-b27ce20de26a366d22055bf0f47073d6" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-html" data-lang="html"><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">xf:if</span> <span class="na">is</span><span class="o">=</span><span class="s">&#34;$template == &#39;conversation_view&#39;&#34;</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="c">&lt;!-- content --&gt;</span>
</span></span><span class="line"><span class="cl"><span class="p">&lt;/</span><span class="nt">xf:if</span><span class="p">&gt;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-b27ce20de26a366d22055bf0f47073d6"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<ol start="28">
<li>Скрытие информации на странице просмотра личной переписки.</li>
</ol>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-30
shortcode-codeblock-html">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-f1c79a5cc6fedb472d9bc4bd50d25fda" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-html" data-lang="html"><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">xf:if</span> <span class="na">is</span><span class="o">=</span><span class="s">&#34;$template != &#39;conversation_view&#39;&#34;</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="c">&lt;!-- content --&gt;</span>
</span></span><span class="line"><span class="cl"><span class="p">&lt;/</span><span class="nt">xf:if</span><span class="p">&gt;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-f1c79a5cc6fedb472d9bc4bd50d25fda"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<ol start="29">
<li>Отображение информации на странице просмотра списка личных переписок.</li>
</ol>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-31
shortcode-codeblock-html">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-412a23d17ec879b87779e0b84b4787de" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-html" data-lang="html"><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">xf:if</span> <span class="na">is</span><span class="o">=</span><span class="s">&#34;$template == &#39;conversation_list&#39;&#34;</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="c">&lt;!-- content --&gt;</span>
</span></span><span class="line"><span class="cl"><span class="p">&lt;/</span><span class="nt">xf:if</span><span class="p">&gt;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-412a23d17ec879b87779e0b84b4787de"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<ol start="30">
<li>Скрытие информации на странице просмотра списка личных переписок.</li>
</ol>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-32
shortcode-codeblock-html">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-89284d858b01542ccd752a4dede17ab0" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-html" data-lang="html"><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">xf:if</span> <span class="na">is</span><span class="o">=</span><span class="s">&#34;$template != &#39;conversation_list&#39;&#34;</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="c">&lt;!-- content --&gt;</span>
</span></span><span class="line"><span class="cl"><span class="p">&lt;/</span><span class="nt">xf:if</span><span class="p">&gt;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-89284d858b01542ccd752a4dede17ab0"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<ol start="31">
<li>Отображение информации на главной странице ресурсов.</li>
</ol>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-33
shortcode-codeblock-html">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-02b148bc02f05f204d33d0494871013b" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-html" data-lang="html"><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">xf:if</span> <span class="na">is</span><span class="o">=</span><span class="s">&#34;$template == &#39;xfrm_overview&#39;&#34;</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="c">&lt;!-- content --&gt;</span>
</span></span><span class="line"><span class="cl"><span class="p">&lt;/</span><span class="nt">xf:if</span><span class="p">&gt;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-02b148bc02f05f204d33d0494871013b"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<ol start="32">
<li>Скрытие информации на главной странице ресурсов.</li>
</ol>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-34
shortcode-codeblock-html">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-a608a9fed12c0a5c06f420b11e09c0fe" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-html" data-lang="html"><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">xf:if</span> <span class="na">is</span><span class="o">=</span><span class="s">&#34;$template != &#39;xfrm_overview&#39;&#34;</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="c">&lt;!-- content --&gt;</span>
</span></span><span class="line"><span class="cl"><span class="p">&lt;/</span><span class="nt">xf:if</span><span class="p">&gt;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-a608a9fed12c0a5c06f420b11e09c0fe"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<ol start="33">
<li>Отображение информации на странице просмотра ресурса.</li>
</ol>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-35
shortcode-codeblock-html">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-ae0cb1814bc72e29b0a02d0fa1b7a2c8" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-html" data-lang="html"><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">xf:if</span> <span class="na">is</span><span class="o">=</span><span class="s">&#34;$template == &#39;xfrm_resource_view&#39;&#34;</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="c">&lt;!-- content --&gt;</span>
</span></span><span class="line"><span class="cl"><span class="p">&lt;/</span><span class="nt">xf:if</span><span class="p">&gt;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-ae0cb1814bc72e29b0a02d0fa1b7a2c8"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<ol start="34">
<li>Скрытие информации на странице просмотра ресурса.</li>
</ol>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-36
shortcode-codeblock-html">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-303eee1f86087f4d1fcb41402479c062" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-html" data-lang="html"><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">xf:if</span> <span class="na">is</span><span class="o">=</span><span class="s">&#34;$template != &#39;xfrm_resource_view&#39;&#34;</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="c">&lt;!-- content --&gt;</span>
</span></span><span class="line"><span class="cl"><span class="p">&lt;/</span><span class="nt">xf:if</span><span class="p">&gt;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-303eee1f86087f4d1fcb41402479c062"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<ol start="35">
<li>Отображение информации на странице просмотра темы.</li>
</ol>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-37
shortcode-codeblock-html">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-9a681a5a175f5c5d508d1a0530630ce7" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-html" data-lang="html"><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">xf:if</span> <span class="na">is</span><span class="o">=</span><span class="s">&#34;$template == &#39;thread_view&#39;&#34;</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="c">&lt;!-- content --&gt;</span>
</span></span><span class="line"><span class="cl"><span class="p">&lt;/</span><span class="nt">xf:if</span><span class="p">&gt;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-9a681a5a175f5c5d508d1a0530630ce7"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<ol start="36">
<li>Скрытие информации на странице просмотра темы.</li>
</ol>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-38
shortcode-codeblock-html">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-482007a6443a043e6d1efd6012e63cb2" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-html" data-lang="html"><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">xf:if</span> <span class="na">is</span><span class="o">=</span><span class="s">&#34;$template !=&#39;thread_view&#39;&#34;</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="c">&lt;!-- content --&gt;</span>
</span></span><span class="line"><span class="cl"><span class="p">&lt;/</span><span class="nt">xf:if</span><span class="p">&gt;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-482007a6443a043e6d1efd6012e63cb2"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<ol start="37">
<li>Отображение информации на странице просмотра форума (раздела).</li>
</ol>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-39
shortcode-codeblock-html">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-917ec4fb083e072d45e4c49812549447" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-html" data-lang="html"><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">xf:if</span> <span class="na">is</span><span class="o">=</span><span class="s">&#34;$template ==&#39;forum_view&#39;&#34;</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="c">&lt;!-- content --&gt;</span>
</span></span><span class="line"><span class="cl"><span class="p">&lt;/</span><span class="nt">xf:if</span><span class="p">&gt;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-917ec4fb083e072d45e4c49812549447"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<ol start="38">
<li>Скрытие информации на странице просмотра форума (раздела).</li>
</ol>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-40
shortcode-codeblock-html">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-fe649dbb6ed805798c4a2b5f6a0fde67" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-html" data-lang="html"><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">xf:if</span> <span class="na">is</span><span class="o">=</span><span class="s">&#34;$template != &#39;forum_view&#39;&#34;</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="c">&lt;!-- content --&gt;</span>
</span></span><span class="line"><span class="cl"><span class="p">&lt;/</span><span class="nt">xf:if</span><span class="p">&gt;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-fe649dbb6ed805798c4a2b5f6a0fde67"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<ol start="39">
<li>Отображение информации &ldquo;наказанным&rdquo; пользователям.</li>
</ol>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-41
shortcode-codeblock-html">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-3ac90145a9b27152d6102348fdd0b74e" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-html" data-lang="html"><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">xf:if</span> <span class="na">is</span><span class="o">=</span><span class="s">&#34;{$xf.visitor.Option.is_discouraged}&#34;</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="c">&lt;!-- content --&gt;</span>
</span></span><span class="line"><span class="cl"><span class="p">&lt;/</span><span class="nt">xf:if</span><span class="p">&gt;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-3ac90145a9b27152d6102348fdd0b74e"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<ol start="40">
<li>Отображение информации пользователям, которые имеют Gravatar.</li>
</ol>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-42
shortcode-codeblock-html">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-77439d2876ab021c048fbcbb30709e37" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-html" data-lang="html"><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">xf:if</span> <span class="na">is</span><span class="o">=</span><span class="s">&#34;{$xf.visitor.gravatar}&#34;</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="c">&lt;!-- content --&gt;</span>
</span></span><span class="line"><span class="cl"><span class="p">&lt;/</span><span class="nt">xf:if</span><span class="p">&gt;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-77439d2876ab021c048fbcbb30709e37"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<ol start="41">
<li>Отображение информации пользователям поддержки форума.</li>
</ol>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-43
shortcode-codeblock-html">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-614f8b87bc293a1645157adbcfb65448" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-html" data-lang="html"><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">xf:if</span> <span class="na">is</span><span class="o">=</span><span class="s">&#34;{$xf.visitor.is_staff}&#34;</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="c">&lt;!-- content --&gt;</span>
</span></span><span class="line"><span class="cl"><span class="p">&lt;/</span><span class="nt">xf:if</span><span class="p">&gt;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-614f8b87bc293a1645157adbcfb65448"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<ol start="42">
<li>Отображение информации пользователям без подтверждённого адреса e-mail.</li>
</ol>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-44
shortcode-codeblock-html">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-471b0beaf60ca09939cc7cecc00f7f48" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-html" data-lang="html"><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">xf:if</span> <span class="na">is</span><span class="o">=</span><span class="s">&#34;{$xf.visitor.isAwaitingEmailConfirmation()}&#34;</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="c">&lt;!-- content --&gt;</span>
</span></span><span class="line"><span class="cl"><span class="p">&lt;/</span><span class="nt">xf:if</span><span class="p">&gt;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-471b0beaf60ca09939cc7cecc00f7f48"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<ol start="43">
<li>Отображение информации в нескольких форумах (разделах).</li>
</ol>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-45
shortcode-codeblock-html">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-62d7dcc8ea3adf2972582b2d9b4d7c55" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-html" data-lang="html"><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">xf:if</span> <span class="na">is</span><span class="o">=</span><span class="s">&#34;in_array({$forum.node_id}, [X, Y, Z])&#34;</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="c">&lt;!-- content --&gt;</span>
</span></span><span class="line"><span class="cl"><span class="p">&lt;/</span><span class="nt">xf:if</span><span class="p">&gt;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-62d7dcc8ea3adf2972582b2d9b4d7c55"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<ol start="44">
<li>Скрытие информации в нескольких форумах (разделах).</li>
</ol>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-46
shortcode-codeblock-html">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-06ae4b191e3ac97d965199f45c067b7d" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-html" data-lang="html"><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">xf:if</span> <span class="na">is</span><span class="o">=</span><span class="s">&#34;in_array($forum.node_id, [X, Y, Z])&#34;</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="c">&lt;!-- content --&gt;</span>
</span></span><span class="line"><span class="cl"><span class="p">&lt;/</span><span class="nt">xf:if</span><span class="p">&gt;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-06ae4b191e3ac97d965199f45c067b7d"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<ol start="45">
<li>Отображение информации в определённом форуме (разделе).</li>
</ol>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-47
shortcode-codeblock-html">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-98413961bd54ec99e0466df85fc47b0c" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-html" data-lang="html"><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">xf:if</span> <span class="na">is</span><span class="o">=</span><span class="s">&#34;$forum.node_id == X&#34;</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="c">&lt;!-- content --&gt;</span>
</span></span><span class="line"><span class="cl"><span class="p">&lt;/</span><span class="nt">xf:if</span><span class="p">&gt;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-98413961bd54ec99e0466df85fc47b0c"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<ol start="46">
<li>Скрытие информации в определённом форуме (разделе).</li>
</ol>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-48
shortcode-codeblock-html">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-eb82bd818a0ccc5cfd66d53b8a36f880" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-html" data-lang="html"><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">xf:if</span> <span class="na">is</span><span class="o">=</span><span class="s">&#34;$forum.node_id != 3&#34;</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="c">&lt;!-- content --&gt;</span>
</span></span><span class="line"><span class="cl"><span class="p">&lt;/</span><span class="nt">xf:if</span><span class="p">&gt;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-eb82bd818a0ccc5cfd66d53b8a36f880"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<ol start="47">
<li>Отображение информации только после первого сообщения в каждой теме.</li>
</ol>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-49
shortcode-codeblock-html">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-39ec95b01056f877e64bb3d22216387b" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-html" data-lang="html"><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">xf:if</span> <span class="na">is</span><span class="o">=</span><span class="s">&#34;{$post.position} % {$xf.options.messagesPerPage} == 1&#34;</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="c">&lt;!-- content --&gt;</span>
</span></span><span class="line"><span class="cl"><span class="p">&lt;/</span><span class="nt">xf:if</span><span class="p">&gt;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-39ec95b01056f877e64bb3d22216387b"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<ol start="48">
<li>Отображение информации только внутри первого сообщения в каждой теме.</li>
</ol>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-50
shortcode-codeblock-html">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-c09d525c43b43f0bf55a8c752818b292" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-html" data-lang="html"><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">xf:if</span> <span class="na">is</span><span class="o">=</span><span class="s">&#34;{$post.position} % {$xf.options.messagesPerPage} == 0&#34;</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="c">&lt;!-- content --&gt;</span>
</span></span><span class="line"><span class="cl"><span class="p">&lt;/</span><span class="nt">xf:if</span><span class="p">&gt;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-c09d525c43b43f0bf55a8c752818b292"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<ol start="49">
<li>Отображение информации только при заполненном поле местоположения.</li>
</ol>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-51
shortcode-codeblock-html">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-18dcae8b6daf41400e61e531659b3deb" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-html" data-lang="html"><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">xf:if</span> <span class="na">is</span><span class="o">=</span><span class="s">&#34;{$xf.visitor.location}&#34;</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="c">&lt;!-- content --&gt;</span>
</span></span><span class="line"><span class="cl"><span class="p">&lt;/</span><span class="nt">xf:if</span><span class="p">&gt;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-18dcae8b6daf41400e61e531659b3deb"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<ol start="50">
<li>Отображение информации только при заполненном поле веб-сайта.</li>
</ol>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-52
shortcode-codeblock-html">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-d69ab81f6f6a56c2897b33e2fe933ca3" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-html" data-lang="html"><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">xf:if</span> <span class="na">is</span><span class="o">=</span><span class="s">&#34;{$xf.visitor.website}&#34;</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="c">&lt;!-- content --&gt;</span>
</span></span><span class="line"><span class="cl"><span class="p">&lt;/</span><span class="nt">xf:if</span><span class="p">&gt;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-d69ab81f6f6a56c2897b33e2fe933ca3"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<ol start="51">
<li>Отображение информации при указанной подписи.</li>
</ol>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-53
shortcode-codeblock-html">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-bb6cd853265154128267f5139db18e21" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-html" data-lang="html"><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">xf:if</span> <span class="na">is</span><span class="o">=</span><span class="s">&#34;{$xf.visitor.signature}&#34;</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="c">&lt;!-- content --&gt;</span>
</span></span><span class="line"><span class="cl"><span class="p">&lt;/</span><span class="nt">xf:if</span><span class="p">&gt;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-bb6cd853265154128267f5139db18e21"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<ol start="52">
<li>Отображение информации только активированным пользователям.</li>
</ol>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-54
shortcode-codeblock-html">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-783d15b6976e4039b9fd5c978ac7613b" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-html" data-lang="html"><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">xf:if</span> <span class="na">is</span><span class="o">=</span><span class="s">&#34;{$xf.visitor.user_state} == &#39;valid&#39;&#34;</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="c">&lt;!-- content --&gt;</span>
</span></span><span class="line"><span class="cl"><span class="p">&lt;/</span><span class="nt">xf:if</span><span class="p">&gt;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-783d15b6976e4039b9fd5c978ac7613b"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<ol start="53">
<li>Отображение информации только пользователям, ожидающим подтверждения адреса e-mail.</li>
</ol>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-55
shortcode-codeblock-html">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-1158072b21bf1977516b66d442203cb2" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-html" data-lang="html"><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">xf:if</span> <span class="na">is</span><span class="o">=</span><span class="s">&#34;{$xf.visitor.user_state} == &#39;email_confirm_edit&#39;&#34;</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="c">&lt;!-- content --&gt;</span>
</span></span><span class="line"><span class="cl"><span class="p">&lt;/</span><span class="nt">xf:if</span><span class="p">&gt;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-1158072b21bf1977516b66d442203cb2"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<ol start="54">
<li>Отображение информации только пользователям с проблемным адресом e-mail.</li>
</ol>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-56
shortcode-codeblock-html">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-a4c02035ddc710aeea9e0eda287f1b52" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-html" data-lang="html"><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">xf:if</span> <span class="na">is</span><span class="o">=</span><span class="s">&#34;{$xf.visitor.user_state} == &#39;email_bounce&#39;&#34;</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="c">&lt;!-- content --&gt;</span>
</span></span><span class="line"><span class="cl"><span class="p">&lt;/</span><span class="nt">xf:if</span><span class="p">&gt;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-a4c02035ddc710aeea9e0eda287f1b52"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<ol start="55">
<li>Отображение информации, если ID пользователя = ID автора темы.</li>
</ol>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-57
shortcode-codeblock-html">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-fad99ffda239a9e40b2feffbf8ba4175" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-html" data-lang="html"><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">xf:if</span> <span class="na">is</span><span class="o">=</span><span class="s">&#34;{$__globals.thread} AND {$__globals.thread.user_id} == {$user.user_id}&#34;</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="c">&lt;!-- content --&gt;</span>
</span></span><span class="line"><span class="cl"><span class="p">&lt;/</span><span class="nt">xf:if</span><span class="p">&gt;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-fad99ffda239a9e40b2feffbf8ba4175"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<ol start="56">
<li>Отображение информации пользователю, который является автором темы.</li>
</ol>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-58
shortcode-codeblock-html">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-58f6f57bdcb6d4abdf341da3beeae588" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-html" data-lang="html"><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">xf:if</span> <span class="na">is</span><span class="o">=</span><span class="s">&#34;{$thread.user_id} == {$xf.visitor.user_id}&#34;</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="c">&lt;!-- content --&gt;</span>
</span></span><span class="line"><span class="cl"><span class="p">&lt;/</span><span class="nt">xf:if</span><span class="p">&gt;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-58f6f57bdcb6d4abdf341da3beeae588"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>]]></turbo:content></item><item turbo="true"><title>Настройка и использование Git</title><link>https://lib.onl/ru/2021/08/c35f395f-5921-55eb-afcf-1ad812a1a9d9/</link><pubDate>Sat, 14 Aug 2021 15:52:38 +0000</pubDate><dc:creator>Kai Kimera</dc:creator><category>Linux</category><category>Git</category><category>Терминал</category><category>В доработке</category><yandex:related><link url="https://lib.onl/ru/2021/07/3834fbed-71c8-5979-b6c2-236269f5ecea/">Зеркалирование репозитория между хостингами</link><link url="https://lib.onl/ru/2021/05/8544b8ce-4586-578f-9633-e8ae43441a25/">Синхронизация репозитория от GitHub к GitLab</link></yandex:related><turbo:extendedHtml>true</turbo:extendedHtml><turbo:source>https://lib.onl/ru/2021/08/c35f395f-5921-55eb-afcf-1ad812a1a9d9/</turbo:source><turbo:topic>Настройка и использование Git</turbo:topic><turbo:content><![CDATA[<p>В этой заметке я приведу параметры <span class="shortcode shortcode-tag"><a href="/ru/tags/git/" target="_blank">#Git</a></span>, которые сам использую при работе с репозиториями.</p>
<h2 id="первичная-настройка">
  <a class="link-body-emphasis" href="#%d0%bf%d0%b5%d1%80%d0%b2%d0%b8%d1%87%d0%bd%d0%b0%d1%8f-%d0%bd%d0%b0%d1%81%d1%82%d1%80%d0%be%d0%b9%d0%ba%d0%b0">Первичная настройка</a>
</h2><p>Для начала работы с <span class="shortcode shortcode-tag"><a href="/ru/tags/git/" target="_blank">#Git</a></span>&rsquo;ом, его необходимо хотя бы минимально настроить.</p>
<ol>
<li>Указать своё имя:</li>
</ol>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-0
shortcode-codeblock-bash">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-05a3a040854ab1d5c6fda80e508a1ad6" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">git config --global user.name <span class="s2">&#34;John Doe&#34;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-05a3a040854ab1d5c6fda80e508a1ad6"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<ol start="2">
<li>Указать свой адрес e-mail:</li>
</ol>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-1
shortcode-codeblock-bash">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-845bcb7c3f9522f773abb1c7c580691d" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">git config --global user.email <span class="s2">&#34;johndoe@example.com&#34;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-845bcb7c3f9522f773abb1c7c580691d"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<h2 id="настройка-подписи">
  <a class="link-body-emphasis" href="#%d0%bd%d0%b0%d1%81%d1%82%d1%80%d0%be%d0%b9%d0%ba%d0%b0-%d0%bf%d0%be%d0%b4%d0%bf%d0%b8%d1%81%d0%b8">Настройка подписи</a>
</h2><p>Хорошим тоном будет считаться подпись каждого своего commit&rsquo;а.</p>
<ol>
<li>Выяснить какие ключи установлены в системе (о создании ключей я публиковал заметку <span class="shortcode shortcode-uuid"><a href="/ru/2020/07/7a204545-daa8-58ce-ba35-75e732e1bcc0/">GnuPG: Создание и работа с ключами шифрования</a></span>):</li>
</ol>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-2
shortcode-codeblock-bash">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-2d2f5d20618a38be13f52d1ab5d60d65" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">gpg --list-secret-keys --keyid-format<span class="o">=</span>long</span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-2d2f5d20618a38be13f52d1ab5d60d65"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<ol start="2">
<li>Указать <span class="shortcode shortcode-tag"><a href="/ru/tags/git/" target="_blank">#Git</a></span>&rsquo;у всегда подписывать каждый commit:</li>
</ol>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-3
shortcode-codeblock-bash">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-e26ecc8a3461fc3f67e6e44da5571dae" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">git config --global commit.gpgsign true</span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-e26ecc8a3461fc3f67e6e44da5571dae"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<ol start="3">
<li>Указать <span class="shortcode shortcode-tag"><a href="/ru/tags/git/" target="_blank">#Git</a></span>&rsquo;у идентификатор ключа для подписи commit&rsquo;а:</li>
</ol>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-4
shortcode-codeblock-bash">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-91900ef87c3c8496949e3b0c7618e18c" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">git config --global user.signingkey 3AA5C34371567BD2</span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-91900ef87c3c8496949e3b0c7618e18c"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<h2 id="хранилище-паролей">
  <a class="link-body-emphasis" href="#%d1%85%d1%80%d0%b0%d0%bd%d0%b8%d0%bb%d0%b8%d1%89%d0%b5-%d0%bf%d0%b0%d1%80%d0%be%d0%bb%d0%b5%d0%b9">Хранилище паролей</a>
</h2><p><span class="shortcode shortcode-tag"><a href="/ru/tags/git/" target="_blank">#Git</a></span> по умолчанию не сохраняет регистрационные данные для репозиториев. Эта настройка позволяет указать <span class="shortcode shortcode-tag"><a href="/ru/tags/git/" target="_blank">#Git</a></span>&rsquo;у использовать для хранения регистрационных данных текстовый файл <code>~/.git-credentials</code>:</p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-5
shortcode-codeblock-bash">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-78c10ce7e1c61678f8222618f9530c52" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">git config --global credential.helper store</span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-78c10ce7e1c61678f8222618f9530c52"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<h2 id="отмена-изменений">
  <a class="link-body-emphasis" href="#%d0%be%d1%82%d0%bc%d0%b5%d0%bd%d0%b0-%d0%b8%d0%b7%d0%bc%d0%b5%d0%bd%d0%b5%d0%bd%d0%b8%d0%b9">Отмена изменений</a>
</h2><p>Отмена конкретного commit&rsquo;а:</p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-6
shortcode-codeblock-bash">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-ebf6e8b3d73117f52057986c46680ac4" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">git revert <span class="o">[</span>commit<span class="o">]</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-ebf6e8b3d73117f52057986c46680ac4"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<p>Отмена 2-х commit&rsquo;ов подряд:</p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-7
shortcode-codeblock-bash">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-ebf108e5bf015d4107d343ba2c80f970" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">git revert HEAD~2</span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-ebf108e5bf015d4107d343ba2c80f970"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<h2 id="модули">
  <a class="link-body-emphasis" href="#%d0%bc%d0%be%d0%b4%d1%83%d0%bb%d0%b8">Модули</a>
</h2><p>Добавление модуля:</p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-8
shortcode-codeblock-bash">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-22ff98efb9cd9e2065e0e7531ec12498" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">git submodule add https://github.com/<span class="o">[</span>MODULE<span class="o">]</span> <span class="o">[</span>MODULE<span class="o">]</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-22ff98efb9cd9e2065e0e7531ec12498"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<p>Рекурсивное обновление всех модулей:</p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-9
shortcode-codeblock-bash">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-e40a2df9098748a6f08db5be47407c1c" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">git submodule update --recursive --remote --merge</span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-e40a2df9098748a6f08db5be47407c1c"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<p>Удаление модуля:</p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-10
shortcode-codeblock-bash">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-9872189f705310d7da24b4f2632d42ed" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">git submodule deinit -f <span class="o">[</span>MODULE<span class="o">]</span>  <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>  <span class="o">&amp;&amp;</span> git rm -r --cached <span class="o">[</span>MODULE<span class="o">]</span>  <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>  <span class="o">&amp;&amp;</span> rm -rf .git/modules/<span class="o">[</span>MODULE<span class="o">]</span> <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>  <span class="o">&amp;&amp;</span> rm -rf <span class="o">[</span>MODULE<span class="o">]</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-9872189f705310d7da24b4f2632d42ed"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<h2 id="изменение-адреса-репозитория">
  <a class="link-body-emphasis" href="#%d0%b8%d0%b7%d0%bc%d0%b5%d0%bd%d0%b5%d0%bd%d0%b8%d0%b5-%d0%b0%d0%b4%d1%80%d0%b5%d1%81%d0%b0-%d1%80%d0%b5%d0%bf%d0%be%d0%b7%d0%b8%d1%82%d0%be%d1%80%d0%b8%d1%8f">Изменение адреса репозитория</a>
</h2><p>Показать текущий адрес:</p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-11
shortcode-codeblock-bash">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-d3543d31aea710dadbaafeded77addc4" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">git remote -v</span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-d3543d31aea710dadbaafeded77addc4"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<p>Установить новый адрес:</p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-12
shortcode-codeblock-bash">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-4450cfe415669d2a6c53410b36ed8b25" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">git remote set-url origin <span class="s1">&#39;[URL]&#39;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-4450cfe415669d2a6c53410b36ed8b25"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<h2 id="изменение-описания-последнего-commitа">
  <a class="link-body-emphasis" href="#%d0%b8%d0%b7%d0%bc%d0%b5%d0%bd%d0%b5%d0%bd%d0%b8%d0%b5-%d0%be%d0%bf%d0%b8%d1%81%d0%b0%d0%bd%d0%b8%d1%8f-%d0%bf%d0%be%d1%81%d0%bb%d0%b5%d0%b4%d0%bd%d0%b5%d0%b3%d0%be-commit%d0%b0">Изменение описания последнего commit&rsquo;а</a>
</h2><p>Если закралась ошибка в описании изменений кода при последнем commit&rsquo;е, это описание можно изменить при помощи команды:</p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-13
shortcode-codeblock-bash">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-c86d22a2a4cbc52061fafabf71ab0787" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">git commit --amend -m <span class="s1">&#39;New commit message.&#39;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-c86d22a2a4cbc52061fafabf71ab0787"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<p>Далее, изменённый коммит принудительно отправить на сервер:</p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-14
shortcode-codeblock-bash">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-2965ccbf1c7e3517a9ea1aff9db59e2d" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">git push --force <span class="s1">&#39;[remoteName]&#39;</span> <span class="s1">&#39;[branchName]&#39;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-2965ccbf1c7e3517a9ea1aff9db59e2d"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>











  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-15
shortcode-codeblock-bash">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-694d79df2ab639b08d1980e1a71526a9" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">git push --force <span class="s1">&#39;origin&#39;</span> <span class="s1">&#39;main&#39;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-694d79df2ab639b08d1980e1a71526a9"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>]]></turbo:content></item><item turbo="true"><title>Зеркалирование репозитория между хостингами</title><link>https://lib.onl/ru/2021/07/3834fbed-71c8-5979-b6c2-236269f5ecea/</link><pubDate>Tue, 06 Jul 2021 17:40:43 +0000</pubDate><dc:creator>Kai Kimera</dc:creator><category>Разработка</category><category>Скрипты</category><yandex:related><link url="https://lib.onl/ru/2021/05/8544b8ce-4586-578f-9633-e8ae43441a25/">Синхронизация репозитория от GitHub к GitLab</link></yandex:related><turbo:extendedHtml>true</turbo:extendedHtml><turbo:source>https://lib.onl/ru/2021/07/3834fbed-71c8-5979-b6c2-236269f5ecea/</turbo:source><turbo:topic>Зеркалирование репозитория между хостингами</turbo:topic><turbo:content><![CDATA[<p>В предыдущей статье <span class="shortcode shortcode-uuid"><a href="/ru/2021/05/8544b8ce-4586-578f-9633-e8ae43441a25/">Синхронизация репозитория от GitHub к GitLab</a></span> я рассказал о том, как организовать синхронизацию между репозиториями <span class="shortcode shortcode-tag"><a href="/ru/tags/git/" target="_blank">#Git</a></span> на разных хостингах, в частности, между <span class="shortcode shortcode-tag"><a href="/ru/tags/github/" target="_blank">#GitHub</a></span> и <span class="shortcode shortcode-tag"><a href="/ru/tags/gitlab/" target="_blank">#GitLab</a></span>. В итоге, я решил сделать <a title="" href="https://github.com/ghastore/github-mirror" target="_blank"
   rel="noopener noreferrer">собственный GitHub Action</a>, который позволяет полностью зеркалировать репозитории.</p>
<h2 id="использование">
  <a class="link-body-emphasis" href="#%d0%b8%d1%81%d0%bf%d0%be%d0%bb%d1%8c%d0%b7%d0%be%d0%b2%d0%b0%d0%bd%d0%b8%d0%b5">Использование</a>
</h2><p>Для подключения зеркалирования, к примеру, с <span class="shortcode shortcode-tag"><a href="/ru/tags/github/" target="_blank">#GitHub</a></span> на <span class="shortcode shortcode-tag"><a href="/ru/tags/gitlab/" target="_blank">#GitLab</a></span>, необходимо в исходном репозитории создать файл <code>.github/workflows/mirror.yml</code>, в котором указать следующее содержимое:</p>

    

    
        
            
            <div class="shortcode shortcode-file mb-3">
              <div class="card overflow-hidden" data-bs-theme="dark">
                <div class="card-header">
                  <div class="d-flex align-items-center">
                    <div class="flex-shrink-0">
                      <i class="far fa-file-code fa-fw"></i>
                    </div>
                    <div class="flex-grow-1 mx-2 text-truncate">
                      <code>mirror.yml</code>
                    </div>
                    <div class="flex-shrink-0">
                      <ul class="list-inline mb-0">
                        <li class="list-inline-item" title='Копировать'>
                          <a class="text-body" href="#"
                             data-fn="clipboard" data-clipboard-target="#cp-7b3c3a00010b1edff8b7d3bc0db4ee50"
                             role="button" aria-label='Копировать'>
                            <i class="fas fa-copy fa-fw"></i>
                          </a>
                        </li>
                        <li class="list-inline-item" title='Скачать'>
                          <a class="text-body" href="/ru/2021/07/3834fbed-71c8-5979-b6c2-236269f5ecea/mirror.yml" download
                             role="button" aria-label='Скачать'>
                            <i class="fas fa-download fa-fw"></i>
                          </a>
                        </li>
                        <li class="list-inline-item" title='Открыть'>
                          <a class="text-body" href="/ru/2021/07/3834fbed-71c8-5979-b6c2-236269f5ecea/mirror.yml" target="_blank"
                             role="button" aria-label='Открыть'>
                            <i class="fas fa-arrow-up-right-from-square fa-fw"></i>
                          </a>
                        </li>
                      </ul>
                    </div>
                  </div>
                </div>
                <div class="card-body p-0 overflow-auto" id="cp-7b3c3a00010b1edff8b7d3bc0db4ee50">
                    
                        
                    
                    <div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-yml" data-lang="yml"><span class="line"><span class="cl"><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;Repository Mirror&#34;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">on</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span>- <span class="l">push</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">jobs</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">mirror</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">runs-on</span><span class="p">:</span><span class="w"> </span><span class="l">ubuntu-latest</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;Mirror&#34;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">steps</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span>- <span class="nt">uses</span><span class="p">:</span><span class="w"> </span><span class="l">pkgstore/github-action-mirror@main</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="nt">with</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">          </span><span class="nt">src_repo</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;https://github.com/${{ github.repository }}.git&#34;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">          </span><span class="nt">src_user</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;${{ secrets.MIRROR_SOURCE_USER_GITHUB }}&#34;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">          </span><span class="nt">src_token</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;${{ secrets.MIRROR_SOURCE_TOKEN_GITHUB }}&#34;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">          </span><span class="nt">dsc_repo</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;https://gitlab.com/${{ github.repository }}.git&#34;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">          </span><span class="nt">dsc_user</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;${{ secrets.MIRROR_TARGET_USER_GITLAB }}&#34;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">          </span><span class="nt">dsc_token</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;${{ secrets.MIRROR_TARGET_TOKEN_GITLAB }}&#34;</span></span></span></code></pre></td></tr></table>
</div>
</div>
                </div>
              </div>
            </div>
        
    
<ul>
<li><code>src_repo</code> - <strong>URL</strong> исходного репозитория.</li>
<li><code>src_user</code> - <strong>пользователь</strong> исходного репозитория.</li>
<li><code>src_token</code> - <strong>токен пользователя</strong> исходного репозитория.</li>
<li><code>dsc_repo</code> - <strong>URL</strong> зеркального репозитория.</li>
<li><code>dsc_user</code> - <strong>пользователь</strong> зеркального репозитория.</li>
<li><code>dsc_token</code> - <strong>токен пользователя</strong> зеркального репозитория.</li>
</ul>
<p>В этом коде стоит обратить внимание на параметр <code>target_repo</code>. <span class="shortcode shortcode-tag"><a href="/ru/tags/gitlab/" target="_blank">#GitLab</a></span> позволяет автоматически создавать репозиторий при зеркалировании, а так как у меня адреса репозиториев совпадают между <span class="shortcode shortcode-tag"><a href="/ru/tags/github/" target="_blank">#GitHub</a></span> и <span class="shortcode shortcode-tag"><a href="/ru/tags/gitlab/" target="_blank">#GitLab</a></span>, мне гораздо проще выстроить конструкцию <code>https://gitlab.com/${{ github.repository }}.git</code>. Переменная <code>${{ github.repository }}</code> содержит имя пользователя / организации и название репозитория, и, при настройке зеркалирования репозитория на <span class="shortcode shortcode-tag"><a href="/ru/tags/github/" target="_blank">#GitHub</a></span>&rsquo;е, зеркало репозитория автоматически создаётся на <span class="shortcode shortcode-tag"><a href="/ru/tags/gitlab/" target="_blank">#GitLab</a></span>&rsquo;е.</p>]]></turbo:content></item><item turbo="true"><title>Генератор иконок для сайта</title><link>https://lib.onl/ru/2021/05/841ba281-a22b-55ee-b97d-251a5dc111d8/</link><pubDate>Tue, 18 May 2021 07:41:46 +0000</pubDate><dc:creator>Kai Kimera</dc:creator><category>Разработка</category><category>Скрипты</category><turbo:extendedHtml>true</turbo:extendedHtml><turbo:source>https://lib.onl/ru/2021/05/841ba281-a22b-55ee-b97d-251a5dc111d8/</turbo:source><turbo:topic>Генератор иконок для сайта</turbo:topic><turbo:content><![CDATA[<p>Сделал для сайта автоматизированное создание иконок типа <code>favicon</code>, которыми пользуются браузеры и устройства для своих нужд.</p>
<p>Я накидал небольшой скрипт, состоящий из двух функций <code>png()</code> и <code>ico()</code>. Функция <code>png()</code> берёт файл <code>favicon.svg</code> и преобразует его в <span class="shortcode shortcode-tag">PNG</span>, указанных в массиве <code>size</code>, размеров. Функция <code>ico()</code> также берёт файл <code>favicon.svg</code> и преобразует его в формат <span class="shortcode shortcode-tag">ICO</span>, который содержит в себе несколько размеров изображения.</p>

    

    
        
            
            <div class="shortcode shortcode-file mb-3">
              <div class="card overflow-hidden" data-bs-theme="dark">
                <div class="card-header">
                  <div class="d-flex align-items-center">
                    <div class="flex-shrink-0">
                      <i class="far fa-file-code fa-fw"></i>
                    </div>
                    <div class="flex-grow-1 mx-2 text-truncate">
                      <code>favicon.sh</code>
                    </div>
                    <div class="flex-shrink-0">
                      <ul class="list-inline mb-0">
                        <li class="list-inline-item" title='Копировать'>
                          <a class="text-body" href="#"
                             data-fn="clipboard" data-clipboard-target="#cp-ef1467ef714fbb297e6f5a3f5a4175d3"
                             role="button" aria-label='Копировать'>
                            <i class="fas fa-copy fa-fw"></i>
                          </a>
                        </li>
                        <li class="list-inline-item" title='Скачать'>
                          <a class="text-body" href="/ru/2021/05/841ba281-a22b-55ee-b97d-251a5dc111d8/favicon.sh" download
                             role="button" aria-label='Скачать'>
                            <i class="fas fa-download fa-fw"></i>
                          </a>
                        </li>
                        <li class="list-inline-item" title='Открыть'>
                          <a class="text-body" href="/ru/2021/05/841ba281-a22b-55ee-b97d-251a5dc111d8/favicon.sh" target="_blank"
                             role="button" aria-label='Открыть'>
                            <i class="fas fa-arrow-up-right-from-square fa-fw"></i>
                          </a>
                        </li>
                      </ul>
                    </div>
                  </div>
                </div>
                <div class="card-body p-0 overflow-auto" id="cp-ef1467ef714fbb297e6f5a3f5a4175d3">
                    
                        
                    
                    <div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sh" data-lang="sh"><span class="line"><span class="cl"><span class="cp">#!/usr/bin/env -S bash -eu
</span></span></span><span class="line"><span class="cl"><span class="cp"></span><span class="c1"># -------------------------------------------------------------------------------------------------------------------- #</span>
</span></span><span class="line"><span class="cl"><span class="c1"># FAVICON.ICO</span>
</span></span><span class="line"><span class="cl"><span class="c1"># Generating &#39;favicon.ico&#39; file.</span>
</span></span><span class="line"><span class="cl"><span class="c1"># -------------------------------------------------------------------------------------------------------------------- #</span>
</span></span><span class="line"><span class="cl"><span class="c1"># @package    Bash</span>
</span></span><span class="line"><span class="cl"><span class="c1"># @author     Kai Kimera &lt;mail@kai.kim&gt;</span>
</span></span><span class="line"><span class="cl"><span class="c1"># @copyright  2023 Library Online</span>
</span></span><span class="line"><span class="cl"><span class="c1"># @license    MIT</span>
</span></span><span class="line"><span class="cl"><span class="c1"># @version    0.1.0</span>
</span></span><span class="line"><span class="cl"><span class="c1"># @link       https://lib.onl/ru/2021/05/841ba281-a22b-55ee-b97d-251a5dc111d8/</span>
</span></span><span class="line"><span class="cl"><span class="c1"># -------------------------------------------------------------------------------------------------------------------- #</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nv">size</span><span class="o">=(</span> <span class="m">16</span> <span class="m">24</span> <span class="m">32</span> <span class="m">48</span> <span class="m">64</span> <span class="m">72</span> <span class="m">80</span> <span class="m">96</span> <span class="m">128</span> <span class="m">144</span> <span class="m">152</span> <span class="m">167</span> <span class="m">180</span> <span class="m">192</span> <span class="m">196</span> <span class="m">256</span> <span class="m">300</span> <span class="m">512</span> <span class="o">)</span>
</span></span><span class="line"><span class="cl"><span class="nv">svg</span><span class="o">=</span><span class="s1">&#39;favicon.svg&#39;</span>
</span></span><span class="line"><span class="cl"><span class="nv">ico</span><span class="o">=</span><span class="s1">&#39;favicon.ico&#39;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">png<span class="o">()</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">  _check_file
</span></span><span class="line"><span class="cl">  <span class="k">for</span> i in <span class="s2">&#34;</span><span class="si">${</span><span class="nv">size</span><span class="p">[@]</span><span class="si">}</span><span class="s2">&#34;</span><span class="p">;</span> <span class="k">do</span>
</span></span><span class="line"><span class="cl">    rsvg-convert -w <span class="s2">&#34;</span><span class="si">${</span><span class="nv">i</span><span class="si">}</span><span class="s2">&#34;</span> -h <span class="s2">&#34;</span><span class="si">${</span><span class="nv">i</span><span class="si">}</span><span class="s2">&#34;</span> <span class="s2">&#34;</span><span class="si">${</span><span class="nv">svg</span><span class="si">}</span><span class="s2">&#34;</span> -o <span class="s2">&#34;favicon-</span><span class="si">${</span><span class="nv">i</span><span class="si">}</span><span class="s2">.png&#34;</span>
</span></span><span class="line"><span class="cl">  <span class="k">done</span>
</span></span><span class="line"><span class="cl"><span class="o">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">ico<span class="o">()</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">  _check_file
</span></span><span class="line"><span class="cl">  convert -density <span class="s1">&#39;256x256&#39;</span> -background <span class="s1">&#39;transparent&#39;</span> <span class="s2">&#34;</span><span class="si">${</span><span class="nv">svg</span><span class="si">}</span><span class="s2">&#34;</span> -define <span class="s1">&#39;icon:auto-resize&#39;</span> -colors <span class="s1">&#39;256&#39;</span> <span class="s2">&#34;</span><span class="si">${</span><span class="nv">ico</span><span class="si">}</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl">  identify <span class="s2">&#34;</span><span class="si">${</span><span class="nv">ico</span><span class="si">}</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl"><span class="o">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">_check_file<span class="o">()</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">  <span class="o">[[</span> -f <span class="s2">&#34;</span><span class="si">${</span><span class="nv">svg</span><span class="si">}</span><span class="s2">&#34;</span> <span class="o">]]</span> <span class="o">||</span> <span class="o">{</span> <span class="nb">printf</span> <span class="s1">&#39;%s does not exist!\n&#39;</span> <span class="s2">&#34;</span><span class="si">${</span><span class="nv">svg</span><span class="si">}</span><span class="s2">&#34;</span><span class="p">;</span> <span class="nb">exit</span> 1<span class="p">;</span> <span class="o">}</span>
</span></span><span class="line"><span class="cl"><span class="o">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="s2">&#34;</span><span class="nv">$@</span><span class="s2">&#34;</span></span></span></code></pre></td></tr></table>
</div>
</div>
                </div>
              </div>
            </div>
        
    
<h2 id="использование">
  <a class="link-body-emphasis" href="#%d0%b8%d1%81%d0%bf%d0%be%d0%bb%d1%8c%d0%b7%d0%be%d0%b2%d0%b0%d0%bd%d0%b8%d0%b5">Использование</a>
</h2><p>Для работы скрипта необходимо, чтобы в системе были установлены <span class="shortcode shortcode-tag">RSVG</span> и <span class="shortcode shortcode-tag"><a href="/ru/tags/imagemagick/" target="_blank">#ImageMagick</a></span>. Скрипт можно сохранить с произвольным именем, например, <code>favicon.sh</code> в директорию, где находится изображение <code>favicon.svg</code>. Далее, вызывать функции следующим образом:</p>











<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-0 shortcode-codeblock-terminal
shortcode-codeblock-terminal-linux
shortcode-codeblock-terminal-linux-user">
  <div class="card overflow-hidden" data-bs-theme="dark">
    <div class="card-header">
      <div class="d-flex align-items-center">
        <div class="flex-shrink-0 ">
          <i class="fas fa-terminal fa-fw"></i>
        </div>
        <div class="flex-grow-1 mx-2">
          <h5 class="mb-0">Терминал</h5>
        </div>
        <div class="flex-shrink-0">
          <ul class="list-inline mb-0">
            <li class="list-inline-item" title='Копировать'>
              <a class="text-body" href="#"
                 data-fn="clipboard" data-clipboard-target="#cp-8d8b5ff3e7430b5cda4318e03a44dfe0"
                 role="button" aria-label='Копировать'>
                <i class="fas fa-copy fa-fw"></i>
              </a>
            </li>
          </ul>
        </div>
      </div>
    </div>
    <div class="card-body p-0 overflow-auto" id="cp-8d8b5ff3e7430b5cda4318e03a44dfe0"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-plaintext" data-lang="plaintext"><span class="line"><span class="cl">bash favicon.sh png</span></span></code></pre></td></tr></table>
</div>
</div></div>
  </div>
</div>











<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-1 shortcode-codeblock-terminal
shortcode-codeblock-terminal-linux
shortcode-codeblock-terminal-linux-user">
  <div class="card overflow-hidden" data-bs-theme="dark">
    <div class="card-header">
      <div class="d-flex align-items-center">
        <div class="flex-shrink-0 ">
          <i class="fas fa-terminal fa-fw"></i>
        </div>
        <div class="flex-grow-1 mx-2">
          <h5 class="mb-0">Терминал</h5>
        </div>
        <div class="flex-shrink-0">
          <ul class="list-inline mb-0">
            <li class="list-inline-item" title='Копировать'>
              <a class="text-body" href="#"
                 data-fn="clipboard" data-clipboard-target="#cp-4561d1ccfe6252aa82c102cca8b8a01a"
                 role="button" aria-label='Копировать'>
                <i class="fas fa-copy fa-fw"></i>
              </a>
            </li>
          </ul>
        </div>
      </div>
    </div>
    <div class="card-body p-0 overflow-auto" id="cp-4561d1ccfe6252aa82c102cca8b8a01a"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-plaintext" data-lang="plaintext"><span class="line"><span class="cl">bash favicon.sh ico</span></span></code></pre></td></tr></table>
</div>
</div></div>
  </div>
</div>
<p>Скрипт ищет файл <code>favicon.svg</code> и преобразует его в необходимые изображения.</p>]]></turbo:content></item><item turbo="true"><title>Обновление Fedora Linux до актуальной версии</title><link>https://lib.onl/ru/2021/05/0acd3f9d-07b7-52b8-9fac-b5cb1cc579e0/</link><pubDate>Sat, 15 May 2021 20:29:16 +0000</pubDate><dc:creator>Kai Kimera</dc:creator><category>Терминал</category><category>Linux</category><yandex:related><link url="https://lib.onl/ru/2020/06/59781965-afe7-5dd5-9798-d1c5ba6cdafd/">Первичная настройка UAIK</link></yandex:related><turbo:extendedHtml>true</turbo:extendedHtml><turbo:source>https://lib.onl/ru/2021/05/0acd3f9d-07b7-52b8-9fac-b5cb1cc579e0/</turbo:source><turbo:topic>Обновление Fedora Linux до актуальной версии</turbo:topic><turbo:content><![CDATA[<p>Новые версии <span class="shortcode shortcode-tag"><a href="/ru/tags/fedora/" target="_blank">#Fedora</a></span> публикуются каждые 6-8 месяцев. В этой статье я опишу шаги по обновлению дистрибутива между версиями.</p>
<ol>
<li>Устанавливаем плагин обновления системы:</li>
</ol>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-0
shortcode-codeblock-bash">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-08bfa708d073d59ba4c1f77fc69f328a" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">dnf install dnf-plugin-system-upgrade</span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-08bfa708d073d59ba4c1f77fc69f328a"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<ol start="2">
<li>Скачивание актуальной версии системы:</li>
</ol>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-1
shortcode-codeblock-bash">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-2bc7a984f641435ded97c227970a1dc6" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">dnf system-upgrade download --releasever<span class="o">=</span><span class="m">34</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-2bc7a984f641435ded97c227970a1dc6"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<ul>
<li><code>releasever</code> - номер актуальной версии системы.</li>
</ul>
<ol start="3">
<li>Запуск обновления системы на актуальную версию:</li>
</ol>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-2
shortcode-codeblock-bash">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-5dffc581fe71e03e1af8cf65cb21b1da" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">dnf system-upgrade reboot</span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-5dffc581fe71e03e1af8cf65cb21b1da"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<p>Вот и всё. Система обновит пакетную базу и перезагрузится.</p>]]></turbo:content></item><item turbo="true"><title>Debian: Статический IP-адрес</title><link>https://lib.onl/ru/2021/05/ee559a6c-5cde-5166-9d2d-3ceb55878eb8/</link><pubDate>Sat, 15 May 2021 17:08:30 +0000</pubDate><dc:creator>Kai Kimera</dc:creator><category>Терминал</category><category>Linux</category><category>Сеть</category><category>В доработке</category><turbo:extendedHtml>true</turbo:extendedHtml><turbo:source>https://lib.onl/ru/2021/05/ee559a6c-5cde-5166-9d2d-3ceb55878eb8/</turbo:source><turbo:topic>Debian: Статический IP-адрес</turbo:topic><turbo:content><![CDATA[<p>Настройка статического IP-адреса в DEB-based дистрибутивах.</p>
<h2 id="вводные-данные">
  <a class="link-body-emphasis" href="#%d0%b2%d0%b2%d0%be%d0%b4%d0%bd%d1%8b%d0%b5-%d0%b4%d0%b0%d0%bd%d0%bd%d1%8b%d0%b5">Вводные данные</a>
</h2><ul>
<li>Интерфейс: <code>eth0</code>.</li>
<li>IP-адрес: <code>192.168.10.55/24</code>.</li>
<li>Маска подсети: <code>192.168.10.0/24</code>.</li>
<li>Шлюз: <code>192.168.10.1</code>.</li>
<li>DNS-серверы:
<ul>
<li><code>192.168.10.2</code>.</li>
<li><code>192.168.10.3</code>.</li>
</ul>
</li>
</ul>
<h2 id="настройка-статического-ip-адреса">
  <a class="link-body-emphasis" href="#%d0%bd%d0%b0%d1%81%d1%82%d1%80%d0%be%d0%b9%d0%ba%d0%b0-%d1%81%d1%82%d0%b0%d1%82%d0%b8%d1%87%d0%b5%d1%81%d0%ba%d0%be%d0%b3%d0%be-ip-%d0%b0%d0%b4%d1%80%d0%b5%d1%81%d0%b0">Настройка статического IP-адреса</a>
</h2><h3 id="dhcp">
  <a class="link-body-emphasis" href="#dhcp">DHCP</a>
</h3><p>Открыть файл <code>/etc/network/interfaces</code>, прописать:</p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-0
shortcode-codeblock-plaintext">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-cd4dda09e42e9f025517494cd0c93fa9" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-plaintext" data-lang="plaintext"><span class="line"><span class="cl">auto eth0
</span></span><span class="line"><span class="cl">allow-hotplug eth0
</span></span><span class="line"><span class="cl">iface eth0 inet dhcp</span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-cd4dda09e42e9f025517494cd0c93fa9"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<p>Где:</p>
<ul>
<li><code>eth0</code> - название интерфейса.</li>
</ul>
<h3 id="статический-ip">
  <a class="link-body-emphasis" href="#%d1%81%d1%82%d0%b0%d1%82%d0%b8%d1%87%d0%b5%d1%81%d0%ba%d0%b8%d0%b9-ip">Статический IP</a>
</h3><p>Открыть файл <code>/etc/network/interfaces</code>, прописать:</p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-1
shortcode-codeblock-plaintext">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-22fafa079b78626bd3710fc090ea72f4" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-plaintext" data-lang="plaintext"><span class="line"><span class="cl">auto eth0
</span></span><span class="line"><span class="cl">iface eth0 inet static
</span></span><span class="line"><span class="cl">  address 192.168.10.55/24
</span></span><span class="line"><span class="cl">  gateway 192.168.10.1
</span></span><span class="line"><span class="cl">  dns-nameservers 192.168.10.2 192.168.10.3</span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-22fafa079b78626bd3710fc090ea72f4"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<p>Где:</p>
<ul>
<li><code>eth0</code> - название интерфейса.</li>
<li><code>address</code> - IP-адрес интерфейса.</li>
<li><code>gateway</code> - шлюз.</li>
</ul>
<h3 id="dns">
  <a class="link-body-emphasis" href="#dns">DNS</a>
</h3><p>Открыть <code>/etc/resolv.conf</code>, прописать:</p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-2
shortcode-codeblock-plaintext">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-c05abcf6beb1d1511dfbcb44551b6613" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-plaintext" data-lang="plaintext"><span class="line"><span class="cl">nameserver 192.168.10.2
</span></span><span class="line"><span class="cl">nameserver 192.168.10.3</span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-c05abcf6beb1d1511dfbcb44551b6613"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<p>Где:
<code>nameserver</code> - IP-адрес или домен DNS-сервера.</p>]]></turbo:content></item><item turbo="true"><title>Перезагрузка и выключение Linux</title><link>https://lib.onl/ru/2021/05/86db7f3a-17ce-502b-b21d-337c3bba5d58/</link><pubDate>Wed, 12 May 2021 14:20:47 +0000</pubDate><dc:creator>Kai Kimera</dc:creator><category>Терминал</category><category>Linux</category><turbo:extendedHtml>true</turbo:extendedHtml><turbo:source>https://lib.onl/ru/2021/05/86db7f3a-17ce-502b-b21d-337c3bba5d58/</turbo:source><turbo:topic>Перезагрузка и выключение Linux</turbo:topic><turbo:content><![CDATA[<p>Нередко приходится завершать работу системы через терминал, например, когда компьютер является удалённой рабочей станцией или сервером и вся работа происходит через терминал. В этой статье я постараюсь привести информацию о командах, позволяющих удалённо завершить работу системы.</p>
<h2 id="halt--poweroff--reboot">
  <a class="link-body-emphasis" href="#halt--poweroff--reboot">halt / poweroff / reboot</a>
</h2><p>Старые команды по управлению питанием системы. Опции у этих команд одинаковые. Отдаются команды из под пользователя <strong>root</strong>. Команда <code>halt</code> приостанавливает все функции <span class="shortcode shortcode-tag">CPU</span>, но сам ПК остаётся включённым. Команда <code>poweroff</code> отключает питание ПК, посылая сигнал по <span class="shortcode shortcode-tag">ACPI</span>. Команда <code>reboot</code> даёт команду системе на перезагрузку.</p>




    










    
    




<div class="shortcode shortcode-alert">
  <div class="alert alert-success d-flex overflow-hidden" role="alert">
    <div class="flex-shrink-0 align-self-center">
      <i class="fas fa-lightbulb fa-fw fa-2x"></i>
    </div>
    <div class="flex-grow-1 ms-3 overflow-hidden">
        <p>Команда <code>halt</code> в современных ОС полностью прекращает работу системы. На системах с <strong>systemd</strong> команда <code>halt</code> является устаревшей и представляет собой символьную ссылку на утилиту <code>systemctl</code>.</p>

    </div>
  </div>
</div>

<p>Предпочтительнее использовать команду <code>shutdown</code>, о которой я расскажу ниже.</p>
<h3 id="синтаксис">
  <a class="link-body-emphasis" href="#%d1%81%d0%b8%d0%bd%d1%82%d0%b0%d0%ba%d1%81%d0%b8%d1%81">Синтаксис</a>
</h3>








  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-0
shortcode-codeblock-text">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-b5533245d9d97c95af773348e7f1588d" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-text" data-lang="text"><span class="line"><span class="cl">halt [OPTION]
</span></span><span class="line"><span class="cl">poweroff [OPTION]
</span></span><span class="line"><span class="cl">reboot [OPTION]</span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-b5533245d9d97c95af773348e7f1588d"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<h4 id="некоторые-опции">
  <a class="link-body-emphasis" href="#%d0%bd%d0%b5%d0%ba%d0%be%d1%82%d0%be%d1%80%d1%8b%d0%b5-%d0%be%d0%bf%d1%86%d0%b8%d0%b8">Некоторые опции</a>
</h4><ul>
<li><code>-f</code> - принудительное выполнение команды.</li>
<li><code>-p</code> - сообщает команде <code>halt</code> действовать как <code>poweroff</code>.</li>
<li><code>-w</code> - не выполнять никакие действия, только записать в журнал <code>/var/log/wtmp</code> сообщение о завершении работы.</li>
</ul>
<h2 id="shutdown">
  <a class="link-body-emphasis" href="#shutdown">shutdown</a>
</h2><p>За остановку работы ПК отвечает команда <code>shutdown</code>. Она поддерживает несколько опций, через которые задаётся определённое действие. К примеру:</p>
<ul>
<li><code>-r</code> - перезагрузка.</li>
<li><code>-h</code> - выключение.</li>
<li><code>-c</code> - отмена запланированных действий на перезагрузку или выключение.</li>
</ul>
<p>Для запланированной перезагрузки ПК через 1 минуту используется опция <code>-r</code>:</p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-1
shortcode-codeblock-bash">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-9a3955a389f8f65708c018a626de862b" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">shutdown -r</span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-9a3955a389f8f65708c018a626de862b"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<p>Команда <code>shutdown</code> поддерживает указание времени, когда ПК должен быть перезагружен или выключен. К примеру, перезагрузить через 5 минут:</p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-2
shortcode-codeblock-bash">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-7d27c471d68313d46b82d45261c7f138" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">shutdown -r +5</span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-7d27c471d68313d46b82d45261c7f138"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<p>Также можно указать конкретное время для перезагрузки. Например, перезагрузить ПК в 18:30:</p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-3
shortcode-codeblock-bash">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-c066083e65d1e95c10e666ba6f7e6953" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">shutdown -r 18:30</span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-c066083e65d1e95c10e666ba6f7e6953"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<p>Если перезагрузка или выключение уже запланированы, их можно отменить опцией <code>-c</code>:</p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-4
shortcode-codeblock-bash">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-66ed7b425921112da51d38e10efccce8" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">shutdown -c</span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-66ed7b425921112da51d38e10efccce8"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<p>Для немедленной перезагрузки ПК, вместо времени можно ввести <code>now</code>:</p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-5
shortcode-codeblock-bash">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-1addfbb4d98deb894ca4f465f908b0c2" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">shutdown -r now</span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-1addfbb4d98deb894ca4f465f908b0c2"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<p>Чтобы выключить ПК через 1 минуту, используется опция <code>-h</code>:</p>









  <div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-6
shortcode-codeblock-bash">
    <div class="d-flex overflow-hidden">
      <div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body"
           id="cp-7497784343aeacfbfcd9bfb0fecc73f1" data-bs-theme="dark"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">shutdown -h</span></span></code></pre></td></tr></table>
</div>
</div></div>
      <div class="flex-shrink-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item" title='Копировать'>
            <a class="text-body" href="#"
               data-fn="clipboard" data-clipboard-target="#cp-7497784343aeacfbfcd9bfb0fecc73f1"
               role="button" aria-label='Копировать'>
              <i class="fas fa-copy fa-fw"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>


<p>На этом всё, ничего сложного нет. <span class="shortcode shortcode-emoji">😄</span></p>]]></turbo:content></item></channel></rss>