<?xml version='1.0' encoding='UTF-8'?><rss version="2.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:yandex="http://news.yandex.ru" xmlns:turbo="http://turbo.yandex.ru"><channel><title>Library Online</title><link>https://lib.onl/ru/</link><description>Заметки на тему администрирования и разработки различных систем, приложений и серверов.</description><language>ru-RU</language><item turbo="true"><title>MikroTik: Туннель GRE/IPsec (Site-to-Site)</title><link>https://lib.onl/ru/articles/2024/04/326618af-d950-5001-8114-57c66bb8a5af/</link><pubDate>Mon, 08 Apr 2024 10:04:21 +0000</pubDate><dc:creator>Kai Kimera</dc:creator><category>Сеть</category><yandex:related><link url="https://lib.onl/ru/articles/2024/03/54a2b39f-38b4-5f0c-9b54-310f853da38f/">MikroTik: Туннель IPsec (Site-to-Site)</link><link url="https://lib.onl/ru/articles/2024/04/146e83d5-f571-5273-9a29-172bf5dc10fe/">MikroTik: Туннель WireGuard (Site-to-Site) + OSPF</link><link url="https://lib.onl/ru/articles/2023/10/cc13623b-970c-5950-867e-168f9ba9025a/">MikroTik: Добавление корневых сертификатов в RouterOS</link><link url="https://lib.onl/ru/articles/2020/07/ff2ae66e-8e14-5c4a-baa6-0cd2e59f6517/">MikroTik и CloudFlare: Динамический IP для домена</link><link url="https://lib.onl/ru/articles/2023/12/b6c7c5cd-1b0d-5fcd-8dd2-f28f87a5064c/">MikroTik: Настройка DoH</link></yandex:related><turbo:extendedHtml>true</turbo:extendedHtml><turbo:source>https://lib.onl/ru/articles/2024/04/326618af-d950-5001-8114-57c66bb8a5af/</turbo:source><turbo:topic>MikroTik: Туннель GRE/IPsec (Site-to-Site)</turbo:topic><turbo:content><![CDATA[<p>Продолжаем серию статей по настройке туннеля между двумя маршрутизаторами. На этот раз создадим <span class="shortcode shortcode-tag"><a href="/ru/tags/gre/" target="_blank">#GRE</a></span> туннель.</p>
<p>На обоих маршрутизаторах у меня используются динамические WAN IP. <span class="shortcode shortcode-tag"><a href="/ru/tags/gre/" target="_blank">#GRE</a></span> предпочитает только статические IP-адреса. Чтобы обойти данное ограничение, я использую скрипт из статьи <span class="shortcode shortcode-uuid"><a href="/ru/articles/2020/07/ff2ae66e-8e14-5c4a-baa6-0cd2e59f6517/">MikroTik и CloudFlare: Динамический IP для домена</a></span>, который обновляет IP-адреса маршрутизаторов в суб-доменах, далее скриптом в конце статьи я забираю актуальные IP-адреса суб-доменов и обновляю их в настройках интерфейса <span class="shortcode shortcode-tag"><a href="/ru/tags/gre/" target="_blank">#GRE</a></span>.</p>
<h2 id="вводные-данные">
  <a class="link-body-emphasis" href="#%d0%b2%d0%b2%d0%be%d0%b4%d0%bd%d1%8b%d0%b5-%d0%b4%d0%b0%d0%bd%d0%bd%d1%8b%d0%b5">Вводные данные</a>
</h2><ul>
<li>Маршрутизатор <code>R1</code>:
<ul>
<li>WAN IP: <code>gw1.example.com</code>.</li>
<li>LAN IP: <code>10.1.0.1</code>.</li>
<li>Network: <code>10.1.0.0/16</code>.</li>
</ul>
</li>
<li>Маршрутизатор <code>R2</code>:
<ul>
<li>WAN IP: <code>gw2.example.com</code>.</li>
<li>LAN IP: <code>10.2.0.1</code>.</li>
<li>Network: <code>10.2.0.0/16</code>.</li>
</ul>
</li>
</ul>
<h2 id="настройка-маршрутизаторов">
  <a class="link-body-emphasis" href="#%d0%bd%d0%b0%d1%81%d1%82%d1%80%d0%be%d0%b9%d0%ba%d0%b0-%d0%bc%d0%b0%d1%80%d1%88%d1%80%d1%83%d1%82%d0%b8%d0%b7%d0%b0%d1%82%d0%be%d1%80%d0%be%d0%b2">Настройка маршрутизаторов</a>
</h2><h3 id="router-1">
  <a class="link-body-emphasis" href="#router-1">Router #1</a>
</h3>















<div class="shortcode shortcode-alert">
  <div class="alert alert-primary d-flex overflow-hidden" role="alert">
    <div class="flex-shrink-0 align-self-center">
      <i class="fas fa-sticky-note fa-fw fa-2x"></i>
    </div>
    <div class="flex-grow-1 ms-3 overflow-hidden">
        <p>В моём случае, первоначальные адреса WAN IP маршрутизаторов не имею значения. Они всё равно будут обновлены скриптом на актуальные, взятые у суб-доменов.</p>

    </div>
  </div>
</div>

<ul>
<li>Создаём интерфейс <span class="shortcode shortcode-tag"><a href="/ru/tags/gre/" target="_blank">#GRE</a></span>:
<ul>
<li>Имя интерфейса: <code>gre-gw1-gw2</code>.</li>
<li>Секретная фраза для IPsec: <code>PassWord</code>.</li>
<li>WAN IP-адрес локального маршрутизатора <code>R1</code>: <code>1.1.1.1</code>.</li>
<li>WAN IP-адрес удалённого маршрутизатора <code>R2</code>: <code>2.2.2.2</code>.</li>
<li>Комментарий: <code>HOST: gw2.example.com</code>.</li>
</ul>
</li>
</ul>



<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-6 ">
  <div class="d-flex overflow-hidden">
    <div class="flex-grow-1 rounded overflow-hidden" id="cp-58cc71dc7cea6f5d3f41bbacd42c3828">
      
      <pre><code >/interface gre
add allow-fast-path=no ipsec-secret=&#34;PassWord&#34; name=gre-gw1-gw2 local-address=1.1.1.1 remote-address=2.2.2.2 comment=&#34;HOST: gw2.example.com&#34;</code></pre>
    </div>
    <div class="flex-shrink-0">
      <ul class="list-inline mb-0">
        <li class="list-inline-item" data-bs-tooltip data-bs-title='Копировать'>
          <a class="text-body" href="#"
             data-fn="clipboard preventDefault" data-clipboard-target="#cp-58cc71dc7cea6f5d3f41bbacd42c3828"
             role="button" aria-label='Копировать'>
            <i class="fas fa-copy fa-fw"></i>
          </a>
        </li>
      </ul>
    </div>
  </div>
</div>

<ul>
<li>Прописываем интерфейсу IP-адрес <code>10.255.255.1/24</code>:
<ul>
<li>Адрес интерфейса: <code>10.255.255.1/24</code>.</li>
<li>Интерфейс: <code>gre-gw1-gw2</code>.</li>
<li>Комментарий: <code>[GRE] GRE-GW1-GW2</code>.</li>
</ul>
</li>
</ul>



<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-7 ">
  <div class="d-flex overflow-hidden">
    <div class="flex-grow-1 rounded overflow-hidden" id="cp-d37f05e8f454f7eba823551f9e66474d">
      
      <pre><code >/ip address
add address=10.255.255.1/24 interface=gre-gw1-gw2 comment=&#34;[GRE] GRE-GW1-GW2&#34;</code></pre>
    </div>
    <div class="flex-shrink-0">
      <ul class="list-inline mb-0">
        <li class="list-inline-item" data-bs-tooltip data-bs-title='Копировать'>
          <a class="text-body" href="#"
             data-fn="clipboard preventDefault" data-clipboard-target="#cp-d37f05e8f454f7eba823551f9e66474d"
             role="button" aria-label='Копировать'>
            <i class="fas fa-copy fa-fw"></i>
          </a>
        </li>
      </ul>
    </div>
  </div>
</div>

<ul>
<li>Указываем маршрут до удалённой сети <code>R2</code>:
<ul>
<li>Адрес удалённой сети <code>R2</code>: <code>10.2.0.0/16</code>.</li>
<li>Шлюз <code>R2</code>: <code>10.255.255.2</code>.</li>
<li>Комментарий: <code>[GRE] GW2</code>.</li>
</ul>
</li>
</ul>



<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-8 ">
  <div class="d-flex overflow-hidden">
    <div class="flex-grow-1 rounded overflow-hidden" id="cp-8bc9b2873f8564d7afd729007c770b65">
      
      <pre><code >/ip route
add distance=1 dst-address=10.2.0.0/16 gateway=10.255.255.2 comment=&#34;[GRE] GW2&#34;</code></pre>
    </div>
    <div class="flex-shrink-0">
      <ul class="list-inline mb-0">
        <li class="list-inline-item" data-bs-tooltip data-bs-title='Копировать'>
          <a class="text-body" href="#"
             data-fn="clipboard preventDefault" data-clipboard-target="#cp-8bc9b2873f8564d7afd729007c770b65"
             role="button" aria-label='Копировать'>
            <i class="fas fa-copy fa-fw"></i>
          </a>
        </li>
      </ul>
    </div>
  </div>
</div>

<h3 id="router-2">
  <a class="link-body-emphasis" href="#router-2">Router #2</a>
</h3>















<div class="shortcode shortcode-alert">
  <div class="alert alert-primary d-flex overflow-hidden" role="alert">
    <div class="flex-shrink-0 align-self-center">
      <i class="fas fa-sticky-note fa-fw fa-2x"></i>
    </div>
    <div class="flex-grow-1 ms-3 overflow-hidden">
        <p>В моём случае, первоначальные адреса WAN IP маршрутизаторов не имею значения. Они всё равно будут обновлены скриптом на актуальные, взятые у суб-доменов.</p>

    </div>
  </div>
</div>

<ul>
<li>Создаём интерфейс <span class="shortcode shortcode-tag"><a href="/ru/tags/gre/" target="_blank">#GRE</a></span>:
<ul>
<li>Имя интерфейса: <code>gre-gw2-gw1</code>.</li>
<li>Секретная фраза для IPsec: <code>PassWord</code>.</li>
<li>WAN IP-адрес локального маршрутизатора <code>R2</code>: <code>2.2.2.2</code>.</li>
<li>WAN IP-адрес удалённого маршрутизатора <code>R1</code>: <code>1.1.1.1</code>.</li>
<li>Комментарий: <code>HOST: gw1.example.com</code>.</li>
</ul>
</li>
</ul>



<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-11 ">
  <div class="d-flex overflow-hidden">
    <div class="flex-grow-1 rounded overflow-hidden" id="cp-45d541de5cea088b403a2ecc9457fb08">
      
      <pre><code >/interface gre
add allow-fast-path=no ipsec-secret=&#34;PassWord&#34; name=gre-gw2-gw1 local-address=2.2.2.2 remote-address=1.1.1.1 comment=&#34;HOST: gw1.example.com&#34;</code></pre>
    </div>
    <div class="flex-shrink-0">
      <ul class="list-inline mb-0">
        <li class="list-inline-item" data-bs-tooltip data-bs-title='Копировать'>
          <a class="text-body" href="#"
             data-fn="clipboard preventDefault" data-clipboard-target="#cp-45d541de5cea088b403a2ecc9457fb08"
             role="button" aria-label='Копировать'>
            <i class="fas fa-copy fa-fw"></i>
          </a>
        </li>
      </ul>
    </div>
  </div>
</div>

<ul>
<li>Прописываем интерфейсу IP-адрес <code>10.255.255.2/24</code>:
<ul>
<li>Адрес интерфейса: <code>10.255.255.2/24</code>.</li>
<li>Интерфейс: <code>gre-gw2-gw1</code>.</li>
<li>Комментарий: <code>[GRE] GRE-GW2-GW1</code>.</li>
</ul>
</li>
</ul>



<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-12 ">
  <div class="d-flex overflow-hidden">
    <div class="flex-grow-1 rounded overflow-hidden" id="cp-a441e0c86fd0c3e7d65f38e035f6111f">
      
      <pre><code >/ip address
add address=10.255.255.2/24 interface=gre-gw2-gw1 comment=&#34;[GRE] GW2-GW1&#34;</code></pre>
    </div>
    <div class="flex-shrink-0">
      <ul class="list-inline mb-0">
        <li class="list-inline-item" data-bs-tooltip data-bs-title='Копировать'>
          <a class="text-body" href="#"
             data-fn="clipboard preventDefault" data-clipboard-target="#cp-a441e0c86fd0c3e7d65f38e035f6111f"
             role="button" aria-label='Копировать'>
            <i class="fas fa-copy fa-fw"></i>
          </a>
        </li>
      </ul>
    </div>
  </div>
</div>

<ul>
<li>Указываем маршрут до удалённой сети <code>R1</code>:
<ul>
<li>Адрес удалённой сети <code>R1</code>: <code>10.1.0.0/16</code>.</li>
<li>Шлюз <code>R1</code>: <code>10.255.255.1</code>.</li>
<li>Комментарий: <code>[GRE] GW1</code>.</li>
</ul>
</li>
</ul>



<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-13 ">
  <div class="d-flex overflow-hidden">
    <div class="flex-grow-1 rounded overflow-hidden" id="cp-27782359220096a25ee6446caf2128ed">
      
      <pre><code >/ip route
add distance=1 dst-address=10.1.0.0/16 gateway=10.255.255.1 comment=&#34;[GRE] GW1&#34;</code></pre>
    </div>
    <div class="flex-shrink-0">
      <ul class="list-inline mb-0">
        <li class="list-inline-item" data-bs-tooltip data-bs-title='Копировать'>
          <a class="text-body" href="#"
             data-fn="clipboard preventDefault" data-clipboard-target="#cp-27782359220096a25ee6446caf2128ed"
             role="button" aria-label='Копировать'>
            <i class="fas fa-copy fa-fw"></i>
          </a>
        </li>
      </ul>
    </div>
  </div>
</div>

<h3 id="динамический-ip">
  <a class="link-body-emphasis" href="#%d0%b4%d0%b8%d0%bd%d0%b0%d0%bc%d0%b8%d1%87%d0%b5%d1%81%d0%ba%d0%b8%d0%b9-ip">Динамический IP</a>
</h3><p>К сожалению, <span class="shortcode shortcode-tag"><a href="/ru/tags/mikrotik/" target="_blank">#MikroTik</a></span> для интерфейса <span class="shortcode shortcode-tag"><a href="/ru/tags/gre/" target="_blank">#GRE</a></span> использует только IP-адреса, нельзя указать имя суб-домена. Но на форуме <span class="shortcode shortcode-tag"><a href="/ru/tags/mikrotik/" target="_blank">#MikroTik</a></span> я нашёл скрипт, который парсит доменное имя удалённого маршрутизатора в специально составленном комментарии (<code>HOST: sub.example.com</code>) к интерфейсу и запрашивает IP-адрес этого домена. Данный IP-адрес автоматически вставляется в поле <code>remote-address</code> интерфейса <span class="shortcode shortcode-tag"><a href="/ru/tags/gre/" target="_blank">#GRE</a></span>. Но как быть, если у нас самих внешний динамический IP-адрес на локальном маршрутизаторе? Я переделал скрипт, чтобы он запрашивал внешний IP-адрес локального маршрутизатора и вставлял его поле <code>local-address</code> интерфейса <span class="shortcode shortcode-tag"><a href="/ru/tags/gre/" target="_blank">#GRE</a></span>.</p>
<p>Суть скрипта в решении проблем с внешними динамическими IP-адресами маршрутизатора.</p>

    

    
        
            
            <div class="shortcode shortcode-file mb-3">
              <div class="card overflow-hidden">
                <div class="card-header">
                  <div class="d-flex align-items-center">
                    <div class="flex-shrink-0">
                      <i class="far fa-file-code fa-fw"></i>
                    </div>
                    <div class="flex-grow-1 mx-2 text-truncate">
                      <code>ros.gre.dip.rsc</code>
                    </div>
                    <div class="flex-shrink-0">
                      <ul class="list-inline mb-0">
                        <li class="list-inline-item" data-bs-tooltip data-bs-title='Копировать'>
                          <a class="text-body" href="#"
                             data-fn="clipboard preventDefault" data-clipboard-target="#cp-008814506b05e3dbb00ecf43aa916158"
                             role="button" aria-label='Копировать'>
                            <i class="fas fa-copy fa-fw"></i>
                          </a>
                        </li>
                        <li class="list-inline-item" data-bs-tooltip data-bs-title='Скачать'>
                          <a class="text-body" href="/ru/articles/2024/04/326618af-d950-5001-8114-57c66bb8a5af/ros.gre.dip.rsc" download
                             role="button" aria-label='Скачать'>
                            <i class="fas fa-download fa-fw"></i>
                          </a>
                        </li>
                        <li class="list-inline-item" data-bs-tooltip data-bs-title='Открыть'>
                          <a class="text-body" href="/ru/articles/2024/04/326618af-d950-5001-8114-57c66bb8a5af/ros.gre.dip.rsc" target="_blank"
                             role="button" aria-label='Открыть'>
                            <i class="fas fa-arrow-up-right-from-square fa-fw"></i>
                          </a>
                        </li>
                      </ul>
                    </div>
                  </div>
                </div>
                <div class="card-body" id="cp-008814506b05e3dbb00ecf43aa916158">
                    
                        
                    
                  <pre><code class="language-rsc"># @package    MikroTik / RouterOS / GRE / Dynamic IP
# @author     Kai Kimera &lt;mail@kai.kim&gt;
# @copyright  2024 Library Online
# @license    MIT
# @version    0.1.0
# @link       https://lib.onl/ru/articles/2024/04/326618af-d950-5001-8114-57c66bb8a5af/
# -------------------------------------------------------------------------------------------------------------------- #

:local wanInterface &#34;ether1&#34;

# -------------------------------------------------------------------------------------------------------------------- #

:local wanAddress
:local greComment
:local greCommentLen
:local greHost
:local greLocalAddress
:local greRemoteAddressNew
:local greRemoteAddressOld

:set wanAddress [/ip address get [/ip address find interface=$wanInterface] address]
:set wanAddress [:pick $wanAddress 0 [:find $wanAddress &#34;/&#34;]]

:foreach i in=[/interface gre find where comment~&#34;^DOMAIN: &#34;] do={
  :set greComment [/interface gre get $i comment]
  :set greCommentLen [:len $greComment]
  :set greHost [:pick $greComment 8 $greCommentLen]
  :set greLocalAddress [/interface gre get $i local-address]
  :set greRemoteAddressOld [/interface gre get $i remote-address]
  :set greRemoteAddressNew [:resolve $greHost]

  :if ($greRemoteAddressNew != $greRemoteAddressOld) do={
    /interface gre set $i remote-address=$greRemoteAddressNew
    :log info (&#34;Updating GRE remote address (&#34; . $greComment . &#34;) from &#34; . $greRemoteAddressOld . &#34; to &#34; . $greRemoteAddressNew . &#34;.&#34;)
  }

  :if ($wanAddress != $greLocalAddress) do={
    /interface gre set $i local-address=$wanAddress
    :log info (&#34;Updating GRE local address from &#34; . $greLocalAddress . &#34; to &#34; . $wanAddress . &#34;.&#34;)
  }
}</code></pre>
                </div>
              </div>
            </div>]]></turbo:content></item><item turbo="true"><title>MikroTik: Туннель WireGuard (Site-to-Site) + OSPF</title><link>https://lib.onl/ru/articles/2024/04/146e83d5-f571-5273-9a29-172bf5dc10fe/</link><pubDate>Sat, 06 Apr 2024 09:27:28 +0000</pubDate><dc:creator>Kai Kimera</dc:creator><category>Сеть</category><yandex:related><link url="https://lib.onl/ru/articles/2024/03/54a2b39f-38b4-5f0c-9b54-310f853da38f/">MikroTik: Туннель IPsec (Site-to-Site)</link><link url="https://lib.onl/ru/articles/2023/10/cc13623b-970c-5950-867e-168f9ba9025a/">MikroTik: Добавление корневых сертификатов в RouterOS</link><link url="https://lib.onl/ru/articles/2020/07/ff2ae66e-8e14-5c4a-baa6-0cd2e59f6517/">MikroTik и CloudFlare: Динамический IP для домена</link><link url="https://lib.onl/ru/articles/2023/12/b6c7c5cd-1b0d-5fcd-8dd2-f28f87a5064c/">MikroTik: Настройка DoH</link></yandex:related><turbo:extendedHtml>true</turbo:extendedHtml><turbo:source>https://lib.onl/ru/articles/2024/04/146e83d5-f571-5273-9a29-172bf5dc10fe/</turbo:source><turbo:topic>MikroTik: Туннель WireGuard (Site-to-Site) + OSPF</turbo:topic><turbo:content><![CDATA[<p>Объединение двух маршрутизаторов между собой при помощи туннеля <span class="shortcode shortcode-tag"><a href="/ru/tags/wireguard/" target="_blank">#WireGuard</a></span>. При этом, обмениваться маршрутами эти маршрутизаторы будут через протокол <span class="shortcode shortcode-tag"><a href="/ru/tags/ospf/" target="_blank">#OSPF</a></span>.</p>
<p>В качестве WAN IP я использую суб-домены. <span class="shortcode shortcode-tag"><a href="/ru/tags/wireguard/" target="_blank">#WireGuard</a></span> позволяет использовать суб-домены как EndPoint&rsquo;ы, а уже к суб-доменам приписываются IP-адреса маршрутизаторов. Подобная схема наиболее универсальная, так как не в каждом случае имеется внешний статический IP-адрес, но при использовании скрипта из статьи <span class="shortcode shortcode-uuid"><a href="/ru/articles/2020/07/ff2ae66e-8e14-5c4a-baa6-0cd2e59f6517/">MikroTik и CloudFlare: Динамический IP для домена</a></span> любой адрес маршрутизатора можно превратить в статический через суб-домен.</p>
<h2 id="вводные-данные">
  <a class="link-body-emphasis" href="#%d0%b2%d0%b2%d0%be%d0%b4%d0%bd%d1%8b%d0%b5-%d0%b4%d0%b0%d0%bd%d0%bd%d1%8b%d0%b5">Вводные данные</a>
</h2><ul>
<li>Маршрутизатор <code>R1</code>:
<ul>
<li>WAN IP: <code>gw1.example.com</code>.</li>
<li>LAN IP: <code>10.1.0.1</code>.</li>
<li>Network: <code>10.1.0.0/16</code>.</li>
</ul>
</li>
<li>Маршрутизатор <code>R2</code>:
<ul>
<li>WAN IP: <code>gw2.example.com</code>.</li>
<li>LAN IP: <code>10.2.0.1</code>.</li>
<li>Network: <code>10.2.0.0/16</code>.</li>
</ul>
</li>
</ul>
<h2 id="настройка-маршрутизаторов">
  <a class="link-body-emphasis" href="#%d0%bd%d0%b0%d1%81%d1%82%d1%80%d0%be%d0%b9%d0%ba%d0%b0-%d0%bc%d0%b0%d1%80%d1%88%d1%80%d1%83%d1%82%d0%b8%d0%b7%d0%b0%d1%82%d0%be%d1%80%d0%be%d0%b2">Настройка маршрутизаторов</a>
</h2><h3 id="router-1">
  <a class="link-body-emphasis" href="#router-1">Router #1</a>
</h3><ul>
<li>Создаём интерфейс <span class="shortcode shortcode-tag"><a href="/ru/tags/wireguard/" target="_blank">#WireGuard</a></span>:
<ul>
<li>Номер порта: <code>51820</code>.</li>
<li>Название интерфейса: <code>wireguard-sts</code>.</li>
<li>Комментарий: <code>WireGuard (Site-to-Site)</code>.</li>
</ul>
</li>
</ul>



<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-5 ">
  <div class="d-flex overflow-hidden">
    <div class="flex-grow-1 rounded overflow-hidden" id="cp-7d07ee77718c43cc59e8c0d27707d7ad">
      
      <pre><code >/interface wireguard
add listen-port=51820 name=wireguard-sts comment=&#34;WireGuard (Site-to-Site)&#34;</code></pre>
    </div>
    <div class="flex-shrink-0">
      <ul class="list-inline mb-0">
        <li class="list-inline-item" data-bs-tooltip data-bs-title='Копировать'>
          <a class="text-body" href="#"
             data-fn="clipboard preventDefault" data-clipboard-target="#cp-7d07ee77718c43cc59e8c0d27707d7ad"
             role="button" aria-label='Копировать'>
            <i class="fas fa-copy fa-fw"></i>
          </a>
        </li>
      </ul>
    </div>
  </div>
</div>

<ul>
<li>Прописываем интерфейсу IP-адрес <code>10.255.255.1/24</code>:
<ul>
<li>Адрес интерфейса: <code>10.255.255.1/24</code>.</li>
<li>Интерфейс: <code>wireguard-sts</code>.</li>
<li>Комментарий: <code>[WG] WireGuard (Site-to-Site)</code>.</li>
</ul>
</li>
</ul>



<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-6 ">
  <div class="d-flex overflow-hidden">
    <div class="flex-grow-1 rounded overflow-hidden" id="cp-c315771b54bd8ddbb86d9949d919ab4b">
      
      <pre><code >/ip address
add address=10.255.255.1/24 interface=wireguard-sts comment=&#34;[WG] WireGuard (Site-to-Site)&#34;</code></pre>
    </div>
    <div class="flex-shrink-0">
      <ul class="list-inline mb-0">
        <li class="list-inline-item" data-bs-tooltip data-bs-title='Копировать'>
          <a class="text-body" href="#"
             data-fn="clipboard preventDefault" data-clipboard-target="#cp-c315771b54bd8ddbb86d9949d919ab4b"
             role="button" aria-label='Копировать'>
            <i class="fas fa-copy fa-fw"></i>
          </a>
        </li>
      </ul>
    </div>
  </div>
</div>

<ul>
<li>Указываем маршрут до удалённой сети <code>R2</code>:
<ul>
<li>Адрес удалённой сети <code>R2</code>: <code>10.2.0.0/16</code>.</li>
<li>Шлюз <code>R2</code>: <code>10.255.255.2</code>.</li>
<li>Комментарий: <code>[WG] GW1-GW2</code>.</li>
</ul>
</li>
</ul>



<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-7 ">
  <div class="d-flex overflow-hidden">
    <div class="flex-grow-1 rounded overflow-hidden" id="cp-3bae3dc064fcf2bcab7c75ffbaaa9254">
      
      <pre><code >/ip route
add dst-address=10.2.0.0/16 gateway=10.255.255.2 comment=&#34;[WG] GW1-GW2&#34;</code></pre>
    </div>
    <div class="flex-shrink-0">
      <ul class="list-inline mb-0">
        <li class="list-inline-item" data-bs-tooltip data-bs-title='Копировать'>
          <a class="text-body" href="#"
             data-fn="clipboard preventDefault" data-clipboard-target="#cp-3bae3dc064fcf2bcab7c75ffbaaa9254"
             role="button" aria-label='Копировать'>
            <i class="fas fa-copy fa-fw"></i>
          </a>
        </li>
      </ul>
    </div>
  </div>
</div>

<ul>
<li>Настраиваем фильтры брандмауэра:
<ul>
<li>Открыть порт <code>51820</code>.</li>
<li>Разрешить трафик из удалённой сети <code>R2</code> <code>10.2.0.0/16</code> в локальную сеть <code>R1</code> <code>10.1.0.0/16</code>.</li>
<li>Разрешить трафик из локальной сети <code>R1</code> <code>10.1.0.0/16</code> в удалённую сеть <code>R2</code> <code>10.2.0.0/16</code>.</li>
</ul>
</li>
</ul>



<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-8 ">
  <div class="d-flex overflow-hidden">
    <div class="flex-grow-1 rounded overflow-hidden" id="cp-07933857c5d90b65aa570a661f6fda7b">
      
      <pre><code >/ip firewall filter
add action=accept chain=input dst-port=51820 in-interface-list=WAN protocol=udp comment=&#34;[WG] WireGuard (Site-to-Site)&#34;
add action=accept chain=forward src-address=10.2.0.0/16 dst-address=10.1.0.0/16 comment=&#34;[WG] GW1-GW2&#34;
add action=accept chain=forward src-address=10.1.0.0/16 dst-address=10.2.0.0/16 comment=&#34;[WG] GW1-GW2&#34;</code></pre>
    </div>
    <div class="flex-shrink-0">
      <ul class="list-inline mb-0">
        <li class="list-inline-item" data-bs-tooltip data-bs-title='Копировать'>
          <a class="text-body" href="#"
             data-fn="clipboard preventDefault" data-clipboard-target="#cp-07933857c5d90b65aa570a661f6fda7b"
             role="button" aria-label='Копировать'>
            <i class="fas fa-copy fa-fw"></i>
          </a>
        </li>
      </ul>
    </div>
  </div>
</div>

<h3 id="router-2">
  <a class="link-body-emphasis" href="#router-2">Router #2</a>
</h3><ul>
<li>Создаём интерфейс <span class="shortcode shortcode-tag"><a href="/ru/tags/wireguard/" target="_blank">#WireGuard</a></span>:
<ul>
<li>Номер порта: <code>51820</code>.</li>
<li>Название интерфейса: <code>wireguard-sts</code>.</li>
<li>Комментарий: <code>WireGuard (Site-to-Site)</code>.</li>
</ul>
</li>
</ul>



<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-10 ">
  <div class="d-flex overflow-hidden">
    <div class="flex-grow-1 rounded overflow-hidden" id="cp-ec9d365a516bcdd49f68cb287408e216">
      
      <pre><code >/interface wireguard
add listen-port=51820 name=wireguard-sts comment=&#34;WireGuard (Site-to-Site)&#34;</code></pre>
    </div>
    <div class="flex-shrink-0">
      <ul class="list-inline mb-0">
        <li class="list-inline-item" data-bs-tooltip data-bs-title='Копировать'>
          <a class="text-body" href="#"
             data-fn="clipboard preventDefault" data-clipboard-target="#cp-ec9d365a516bcdd49f68cb287408e216"
             role="button" aria-label='Копировать'>
            <i class="fas fa-copy fa-fw"></i>
          </a>
        </li>
      </ul>
    </div>
  </div>
</div>

<ul>
<li>Прописываем интерфейсу IP-адрес <code>10.255.255.2/24</code>:
<ul>
<li>Адрес интерфейса: <code>10.255.255.2/24</code>.</li>
<li>Интерфейс: <code>wireguard-sts</code>.</li>
<li>Комментарий: <code>[WG] WireGuard (Site-to-Site)</code>.</li>
</ul>
</li>
</ul>



<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-11 ">
  <div class="d-flex overflow-hidden">
    <div class="flex-grow-1 rounded overflow-hidden" id="cp-79cfd219629317eac5aca3b7cdda60cc">
      
      <pre><code >/ip address
add address=10.255.255.2/24 interface=wireguard-sts comment=&#34;WireGuard (Site-to-Site)&#34;</code></pre>
    </div>
    <div class="flex-shrink-0">
      <ul class="list-inline mb-0">
        <li class="list-inline-item" data-bs-tooltip data-bs-title='Копировать'>
          <a class="text-body" href="#"
             data-fn="clipboard preventDefault" data-clipboard-target="#cp-79cfd219629317eac5aca3b7cdda60cc"
             role="button" aria-label='Копировать'>
            <i class="fas fa-copy fa-fw"></i>
          </a>
        </li>
      </ul>
    </div>
  </div>
</div>

<ul>
<li>Указываем маршрут до удалённой сети <code>R1</code>:
<ul>
<li>Адрес удалённой сети <code>R1</code>: <code>10.1.0.0/16</code>.</li>
<li>Шлюз <code>R1</code>: <code>10.255.255.1</code>.</li>
<li>Комментарий: <code>[WG] GW2-GW1</code>.</li>
</ul>
</li>
</ul>



<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-12 ">
  <div class="d-flex overflow-hidden">
    <div class="flex-grow-1 rounded overflow-hidden" id="cp-ac59e26417b087e8945fa015744151ca">
      
      <pre><code >/ip route
add dst-address=10.1.0.0/16 gateway=10.255.255.1 comment=&#34;[WG] GW2-GW1&#34;</code></pre>
    </div>
    <div class="flex-shrink-0">
      <ul class="list-inline mb-0">
        <li class="list-inline-item" data-bs-tooltip data-bs-title='Копировать'>
          <a class="text-body" href="#"
             data-fn="clipboard preventDefault" data-clipboard-target="#cp-ac59e26417b087e8945fa015744151ca"
             role="button" aria-label='Копировать'>
            <i class="fas fa-copy fa-fw"></i>
          </a>
        </li>
      </ul>
    </div>
  </div>
</div>

<ul>
<li>Настраиваем фильтры брандмауэра:
<ul>
<li>Открыть порт <code>51820</code>.</li>
<li>Разрешить трафик из удалённой сети <code>R1</code> <code>10.1.0.0/16</code> в локальную сеть <code>R2</code> <code>10.2.0.0/16</code>.</li>
<li>Разрешить трафик из локальной сети <code>R2</code> <code>10.2.0.0/16</code> в удалённую сеть <code>R1</code> <code>10.1.0.0/16</code>.</li>
</ul>
</li>
</ul>



<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-13 ">
  <div class="d-flex overflow-hidden">
    <div class="flex-grow-1 rounded overflow-hidden" id="cp-1536f3ecf49455eeeae7cc372a03d992">
      
      <pre><code >/ip firewall filter
add action=accept chain=input dst-port=51820 in-interface-list=WAN protocol=udp comment=&#34;[WG] WireGuard (Site-to-Site)&#34;
add action=accept chain=forward src-address=10.1.0.0/16 dst-address=10.2.0.0/16 comment=&#34;[WG] GW2-GW1&#34;
add action=accept chain=forward src-address=10.2.0.0/16 dst-address=10.1.0.0/16 comment=&#34;[WG] GW2-GW1&#34;</code></pre>
    </div>
    <div class="flex-shrink-0">
      <ul class="list-inline mb-0">
        <li class="list-inline-item" data-bs-tooltip data-bs-title='Копировать'>
          <a class="text-body" href="#"
             data-fn="clipboard preventDefault" data-clipboard-target="#cp-1536f3ecf49455eeeae7cc372a03d992"
             role="button" aria-label='Копировать'>
            <i class="fas fa-copy fa-fw"></i>
          </a>
        </li>
      </ul>
    </div>
  </div>
</div>

<h3 id="автоматизация">
  <a class="link-body-emphasis" href="#%d0%b0%d0%b2%d1%82%d0%be%d0%bc%d0%b0%d1%82%d0%b8%d0%b7%d0%b0%d1%86%d0%b8%d1%8f">Автоматизация</a>
</h3><p>Написал небольшой сценарий для разворачивания интерфейса WireGuard на маршрутизаторах. Настройки сценария, естественно, разные под каждый из маршрутизаторов. А вот добавлять peer&rsquo;ы придётся вручную.</p>

    

    
        
            
            <div class="shortcode shortcode-file mb-3">
              <div class="card overflow-hidden">
                <div class="card-header">
                  <div class="d-flex align-items-center">
                    <div class="flex-shrink-0">
                      <i class="far fa-file-code fa-fw"></i>
                    </div>
                    <div class="flex-grow-1 mx-2 text-truncate">
                      <code>ros.wg.rsc</code>
                    </div>
                    <div class="flex-shrink-0">
                      <ul class="list-inline mb-0">
                        <li class="list-inline-item" data-bs-tooltip data-bs-title='Копировать'>
                          <a class="text-body" href="#"
                             data-fn="clipboard preventDefault" data-clipboard-target="#cp-775589ab54f132be182109cd80957887"
                             role="button" aria-label='Копировать'>
                            <i class="fas fa-copy fa-fw"></i>
                          </a>
                        </li>
                        <li class="list-inline-item" data-bs-tooltip data-bs-title='Скачать'>
                          <a class="text-body" href="/ru/articles/2024/04/146e83d5-f571-5273-9a29-172bf5dc10fe/ros.wg.rsc" download
                             role="button" aria-label='Скачать'>
                            <i class="fas fa-download fa-fw"></i>
                          </a>
                        </li>
                        <li class="list-inline-item" data-bs-tooltip data-bs-title='Открыть'>
                          <a class="text-body" href="/ru/articles/2024/04/146e83d5-f571-5273-9a29-172bf5dc10fe/ros.wg.rsc" target="_blank"
                             role="button" aria-label='Открыть'>
                            <i class="fas fa-arrow-up-right-from-square fa-fw"></i>
                          </a>
                        </li>
                      </ul>
                    </div>
                  </div>
                </div>
                <div class="card-body" id="cp-775589ab54f132be182109cd80957887">
                    
                        
                    
                  <pre><code class="language-rsc"># @package    MikroTik / RouterOS / WireGuard
# @author     Kai Kimera &lt;mail@kai.kim&gt;
# @copyright  2024 Library Online
# @license    MIT
# @version    0.1.0
# @link       https://lib.onl/ru/articles/2024/04/146e83d5-f571-5273-9a29-172bf5dc10fe/
# -------------------------------------------------------------------------------------------------------------------- #

# WireGuard interface name.
:local wgName &#34;wireguard-sts&#34;

# WireGuard interface IP address.
:local wgIp &#34;10.255.255.1/24&#34;

# WireGuard port number.
:local wgPort &#34;51820&#34;

# -------------------------------------------------------------------------------------------------------------------- #
# Local router.
# -------------------------------------------------------------------------------------------------------------------- #

# Local router name.
:local wgLocalName &#34;GW1&#34;

# Local network address.
:local wgLocalNetwork &#34;10.1.0.0/16&#34;

# -------------------------------------------------------------------------------------------------------------------- #
# Remote router.
# -------------------------------------------------------------------------------------------------------------------- #

# Remote router name.
:local wgRemoteName &#34;GW2&#34;

# Remote network address.
:local wgRemoteNetwork &#34;10.2.0.0/16&#34;

# -------------------------------------------------------------------------------------------------------------------- #
# -----------------------------------------------------&lt; SCRIPT &gt;----------------------------------------------------- #
# -------------------------------------------------------------------------------------------------------------------- #

/interface wireguard
add listen-port=$wgPort name=$wgName \
  comment=&#34;[WG] $wgName:$wgPort&#34;

/ip address
add address=$wgIp interface=$wgName \
  comment=&#34;[WG] $wgName:$wgPort&#34;

/ip route
add dst-address=$wgRemoteNetwork gateway=$wgName \
  comment=&#34;[WG] $wgLocalName-$wgRemoteName&#34;

/ip firewall filter
add action=accept chain=input dst-port=$wgPort in-interface-list=WAN protocol=udp \
  comment=&#34;[WG] $wgName:$wgPort&#34;
add action=accept chain=forward src-address=$wgRemoteNetwork dst-address=$wgLocalNetwork \
  comment=&#34;[WG] $wgRemoteName-$wgLocalName&#34;
add action=accept chain=forward src-address=$wgLocalNetwork dst-address=$wgRemoteNetwork \
  comment=&#34;[WG] $wgLocalName-$wgRemoteName&#34;</code></pre>
                </div>
              </div>
            </div>
        
    
<h2 id="добавление-peerов">
  <a class="link-body-emphasis" href="#%d0%b4%d0%be%d0%b1%d0%b0%d0%b2%d0%bb%d0%b5%d0%bd%d0%b8%d0%b5-peer%d0%be%d0%b2">Добавление peer&rsquo;ов</a>
</h2><h3 id="router-1-1">
  <a class="link-body-emphasis" href="#router-1-1">Router #1</a>
</h3><ul>
<li>Добавить маршрутизатор <code>R2</code> в <strong>Peers</strong>:
<ul>
<li>Интерфейс: <code>wireguard-sts</code>.</li>
<li>Публичный ключ маршрутизатора <code>R2</code>: <code>&lt;public-key&gt;</code>.<br>
<em>Публичный ключ берём от маршрутизатора <code>R2</code>.</em></li>
<li>Адрес EndPoint маршрутизатора <code>R2</code>: <code>gw2.example.com</code>.</li>
<li>Порт EndPoint маршрутизатора <code>R2</code>: <code>51820</code>.</li>
<li>Разрешённые адреса:
<ul>
<li><code>10.2.0.0/16</code> - адрес удалённой сети маршрутизатора <code>R2</code>.</li>
<li><code>10.255.255.0/24</code> - общий адрес интерфейсов <code>wireguard-sts</code> обоих маршрутизаторов.</li>
<li><code>224.0.0.5/32</code> - мультикастовый адрес протокола <span class="shortcode shortcode-tag"><a href="/ru/tags/ospf/" target="_blank">#OSPF</a></span>.<br>
<em>Без этого параметра не будет работать протокол <span class="shortcode shortcode-tag"><a href="/ru/tags/ospf/" target="_blank">#OSPF</a></span>.</em></li>
</ul>
</li>
<li>Комментарий: <code>[WG] GW2</code>.</li>
</ul>
</li>
</ul>



<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-17 ">
  <div class="d-flex overflow-hidden">
    <div class="flex-grow-1 rounded overflow-hidden" id="cp-6fb276065d0313f59373176940292326">
      
      <pre><code >/interface wireguard peers
add allowed-address=10.2.0.0/16,10.255.255.0/24,224.0.0.5/32 endpoint-address=gw2.example.com endpoint-port=51820 interface=wireguard-sts public-key=&#34;&lt;public-key&gt;&#34; comment=&#34;[WG] GW2&#34;</code></pre>
    </div>
    <div class="flex-shrink-0">
      <ul class="list-inline mb-0">
        <li class="list-inline-item" data-bs-tooltip data-bs-title='Копировать'>
          <a class="text-body" href="#"
             data-fn="clipboard preventDefault" data-clipboard-target="#cp-6fb276065d0313f59373176940292326"
             role="button" aria-label='Копировать'>
            <i class="fas fa-copy fa-fw"></i>
          </a>
        </li>
      </ul>
    </div>
  </div>
</div>

<h3 id="router-2-1">
  <a class="link-body-emphasis" href="#router-2-1">Router #2</a>
</h3><ul>
<li>Добавить маршрутизатор <code>R1</code> в <strong>Peers</strong>:
<ul>
<li>Интерфейс: <code>wireguard-sts</code>.</li>
<li>Публичный ключ маршрутизатора <code>R1</code>: <code>&lt;public-key&gt;</code>.<br>
<em>Публичный ключ берём от маршрутизатора <code>R1</code>.</em></li>
<li>Адрес EndPoint маршрутизатора <code>R1</code>: <code>gw1.example.com</code>.</li>
<li>Порт EndPoint маршрутизатора <code>R1</code>: <code>51820</code>.</li>
<li>Разрешённые адреса:
<ul>
<li><code>10.1.0.0/16</code> - адрес удалённой сети маршрутизатора <code>R1</code>.</li>
<li><code>10.255.255.0/24</code> - общий адрес интерфейсов <code>wireguard-sts</code> обоих маршрутизаторов.</li>
<li><code>224.0.0.5/32</code> - мультикастовый адрес протокола <span class="shortcode shortcode-tag"><a href="/ru/tags/ospf/" target="_blank">#OSPF</a></span>.<br>
<em>Без этого параметра не будет работать протокол <span class="shortcode shortcode-tag"><a href="/ru/tags/ospf/" target="_blank">#OSPF</a></span>.</em></li>
</ul>
</li>
<li>Комментарий: <code>[WG] GW1</code>.</li>
</ul>
</li>
</ul>



<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-20 ">
  <div class="d-flex overflow-hidden">
    <div class="flex-grow-1 rounded overflow-hidden" id="cp-298d14ae17c7705fba30d8a29e3e4e75">
      
      <pre><code >/interface wireguard peers
add allowed-address=10.1.0.0/16,10.255.255.0/24,224.0.0.5/32 endpoint-address=gw1.example.com endpoint-port=51820 interface=wireguard-sts public-key=&#34;&lt;public-key&gt;&#34; comment=&#34;[WG] GW1&#34;</code></pre>
    </div>
    <div class="flex-shrink-0">
      <ul class="list-inline mb-0">
        <li class="list-inline-item" data-bs-tooltip data-bs-title='Копировать'>
          <a class="text-body" href="#"
             data-fn="clipboard preventDefault" data-clipboard-target="#cp-298d14ae17c7705fba30d8a29e3e4e75"
             role="button" aria-label='Копировать'>
            <i class="fas fa-copy fa-fw"></i>
          </a>
        </li>
      </ul>
    </div>
  </div>
</div>

<h2 id="настройка-ospf">
  <a class="link-body-emphasis" href="#%d0%bd%d0%b0%d1%81%d1%82%d1%80%d0%be%d0%b9%d0%ba%d0%b0-ospf">Настройка OSPF</a>
</h2>



    






    
    








<div class="shortcode shortcode-alert">
  <div class="alert alert-info d-flex overflow-hidden" role="alert">
    <div class="flex-shrink-0 align-self-center">
      <i class="fas fa-info fa-fw fa-2x"></i>
    </div>
    <div class="flex-grow-1 ms-3 overflow-hidden">
        <p>На каждом маршрутизаторе настройки полностью идентичные.</p>

    </div>
  </div>
</div>

<ul>
<li>Создаём инстанс:
<ul>
<li>Название: <code>ospf-instance-1</code>.</li>
</ul>
</li>
</ul>



<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-22 ">
  <div class="d-flex overflow-hidden">
    <div class="flex-grow-1 rounded overflow-hidden" id="cp-9e8b1e5c0ed94bd5d4349c0d423b0dfb">
      
      <pre><code >/routing ospf instance
add name=ospf-instance-1</code></pre>
    </div>
    <div class="flex-shrink-0">
      <ul class="list-inline mb-0">
        <li class="list-inline-item" data-bs-tooltip data-bs-title='Копировать'>
          <a class="text-body" href="#"
             data-fn="clipboard preventDefault" data-clipboard-target="#cp-9e8b1e5c0ed94bd5d4349c0d423b0dfb"
             role="button" aria-label='Копировать'>
            <i class="fas fa-copy fa-fw"></i>
          </a>
        </li>
      </ul>
    </div>
  </div>
</div>

<ul>
<li>Добавляем Area:
<ul>
<li>Название Area: <code>backbone</code>.</li>
<li>Название инстанса: <code>ospf-instance-1</code>.</li>
</ul>
</li>
</ul>



<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-23 ">
  <div class="d-flex overflow-hidden">
    <div class="flex-grow-1 rounded overflow-hidden" id="cp-152e1f6ba96b98ffdd81c3d13bc32668">
      
      <pre><code >/routing ospf area
add instance=ospf-instance-1 name=backbone</code></pre>
    </div>
    <div class="flex-shrink-0">
      <ul class="list-inline mb-0">
        <li class="list-inline-item" data-bs-tooltip data-bs-title='Копировать'>
          <a class="text-body" href="#"
             data-fn="clipboard preventDefault" data-clipboard-target="#cp-152e1f6ba96b98ffdd81c3d13bc32668"
             role="button" aria-label='Копировать'>
            <i class="fas fa-copy fa-fw"></i>
          </a>
        </li>
      </ul>
    </div>
  </div>
</div>

<ul>
<li>Настраиваем шаблоны:
<ul>
<li>Интерфейс <code>bridge1</code>.
<ul>
<li>Area: <code>backbone</code>.</li>
</ul>
</li>
<li>Интерфейс <code>wireguard-sts</code>.
<ul>
<li>Area: <code>backbone</code>.</li>
<li>Type: <code>PTP</code> (Point-to-Point).</li>
</ul>
</li>
</ul>
</li>
</ul>



<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-24 ">
  <div class="d-flex overflow-hidden">
    <div class="flex-grow-1 rounded overflow-hidden" id="cp-5d497e785d3eefff5325a7be41f4e0ef">
      
      <pre><code >/routing ospf interface-template
add area=backbone interfaces=bridge1
add area=backbone interfaces=wireguard-sts type=ptp</code></pre>
    </div>
    <div class="flex-shrink-0">
      <ul class="list-inline mb-0">
        <li class="list-inline-item" data-bs-tooltip data-bs-title='Копировать'>
          <a class="text-body" href="#"
             data-fn="clipboard preventDefault" data-clipboard-target="#cp-5d497e785d3eefff5325a7be41f4e0ef"
             role="button" aria-label='Копировать'>
            <i class="fas fa-copy fa-fw"></i>
          </a>
        </li>
      </ul>
    </div>
  </div>
</div>

<ul>
<li>Настраиваем фильтры брандмауэра:
<ul>
<li>Разрешить протокол <span class="shortcode shortcode-tag"><a href="/ru/tags/ospf/" target="_blank">#OSPF</a></span> на интерфейсе <code>wireguard-sts</code>.</li>
</ul>
</li>
</ul>



<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-26 ">
  <div class="d-flex overflow-hidden">
    <div class="flex-grow-1 rounded overflow-hidden" id="cp-1cb1e9f1b3444320b7fad9096bb75011">
      
      <pre><code >/ip firewall filter
add action=accept chain=input in-interface=wireguard-sts protocol=ospf comment=&#34;[WG] OSPF&#34;</code></pre>
    </div>
    <div class="flex-shrink-0">
      <ul class="list-inline mb-0">
        <li class="list-inline-item" data-bs-tooltip data-bs-title='Копировать'>
          <a class="text-body" href="#"
             data-fn="clipboard preventDefault" data-clipboard-target="#cp-1cb1e9f1b3444320b7fad9096bb75011"
             role="button" aria-label='Копировать'>
            <i class="fas fa-copy fa-fw"></i>
          </a>
        </li>
      </ul>
    </div>
  </div>
</div>]]></turbo:content></item><item turbo="true"><title>MikroTik: Туннель IPsec (Site-to-Site)</title><link>https://lib.onl/ru/articles/2024/03/54a2b39f-38b4-5f0c-9b54-310f853da38f/</link><pubDate>Sun, 31 Mar 2024 20:46:24 +0000</pubDate><dc:creator>Kai Kimera</dc:creator><category>Сеть</category><category>Скрипты</category><yandex:related><link url="https://lib.onl/ru/articles/2023/10/cc13623b-970c-5950-867e-168f9ba9025a/">MikroTik: Добавление корневых сертификатов в RouterOS</link><link url="https://lib.onl/ru/articles/2020/07/ff2ae66e-8e14-5c4a-baa6-0cd2e59f6517/">MikroTik и CloudFlare: Динамический IP для домена</link><link url="https://lib.onl/ru/articles/2023/12/b6c7c5cd-1b0d-5fcd-8dd2-f28f87a5064c/">MikroTik: Настройка DoH</link></yandex:related><turbo:extendedHtml>true</turbo:extendedHtml><turbo:source>https://lib.onl/ru/articles/2024/03/54a2b39f-38b4-5f0c-9b54-310f853da38f/</turbo:source><turbo:topic>MikroTik: Туннель IPsec (Site-to-Site)</turbo:topic><turbo:content><![CDATA[<p>Объединение двух маршрутизаторов между собой при помощи туннеля <span class="shortcode shortcode-tag"><a href="/ru/tags/ipsec/" target="_blank">#IPsec</a></span>.</p>
<p>В WAN IP у меня используются суб-домены. К суб-доменам через A-запись в <span class="shortcode shortcode-tag"><a href="/ru/tags/dns/" target="_blank">#DNS</a></span> прописаны внешние IP-адреса маршрутизаторов. При помощи скрипта из статьи <span class="shortcode shortcode-uuid"><a href="/ru/articles/2020/07/ff2ae66e-8e14-5c4a-baa6-0cd2e59f6517/">MikroTik и CloudFlare: Динамический IP для домена</a></span> у меня каждый маршрутизатор имеет актуальный IP-адрес в суб-домене.</p>
<h2 id="вводные-данные">
  <a class="link-body-emphasis" href="#%d0%b2%d0%b2%d0%be%d0%b4%d0%bd%d1%8b%d0%b5-%d0%b4%d0%b0%d0%bd%d0%bd%d1%8b%d0%b5">Вводные данные</a>
</h2><ul>
<li>Маршрутизатор <code>R1</code>:
<ul>
<li>WAN IP: <code>gw1.example.com</code>.</li>
<li>LAN IP: <code>10.1.0.1</code>.</li>
<li>Network: <code>10.1.0.0/16</code>.</li>
</ul>
</li>
<li>Маршрутизатор <code>R2</code>:
<ul>
<li>WAN IP: <code>gw2.example.com</code>.</li>
<li>LAN IP: <code>10.2.0.1</code>.</li>
<li>Network: <code>10.2.0.0/16</code>.</li>
</ul>
</li>
</ul>
<h2 id="настройка-маршрутизаторов">
  <a class="link-body-emphasis" href="#%d0%bd%d0%b0%d1%81%d1%82%d1%80%d0%be%d0%b9%d0%ba%d0%b0-%d0%bc%d0%b0%d1%80%d1%88%d1%80%d1%83%d1%82%d0%b8%d0%b7%d0%b0%d1%82%d0%be%d1%80%d0%be%d0%b2">Настройка маршрутизаторов</a>
</h2><h3 id="router-1">
  <a class="link-body-emphasis" href="#router-1">Router #1</a>
</h3><ul>
<li>Добавляем профиль <span class="shortcode shortcode-tag"><a href="/ru/tags/ipsec/" target="_blank">#IPsec</a></span>:
<ul>
<li>Имя профиля: <code>ipsec-sts</code>.</li>
<li>Группа Diffie-Hellman (стойкость шифрования): <code>ecp384</code>.</li>
<li>Алгоритм шифрования: <code>aes-256</code>.</li>
</ul>
</li>
</ul>



<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-4 ">
  <div class="d-flex overflow-hidden">
    <div class="flex-grow-1 rounded overflow-hidden" id="cp-1dff5c745654cff93373ee708ebb0610">
      
      <pre><code >/ip ipsec profile
add dh-group=ecp384 enc-algorithm=aes-256 name=ipsec-sts</code></pre>
    </div>
    <div class="flex-shrink-0">
      <ul class="list-inline mb-0">
        <li class="list-inline-item" data-bs-tooltip data-bs-title='Копировать'>
          <a class="text-body" href="#"
             data-fn="clipboard preventDefault" data-clipboard-target="#cp-1dff5c745654cff93373ee708ebb0610"
             role="button" aria-label='Копировать'>
            <i class="fas fa-copy fa-fw"></i>
          </a>
        </li>
      </ul>
    </div>
  </div>
</div>

<ul>
<li>Добавляем представление <span class="shortcode shortcode-tag"><a href="/ru/tags/ipsec/" target="_blank">#IPsec</a></span>:
<ul>
<li>Имя представления: <code>ipsec-sts</code>.</li>
<li>Алгоритм аутентификации: <code>sha256</code>.</li>
<li>Алгоритм шифрования: <code>aes-256-cbc</code>.</li>
<li>Группа Diffie-Hellman (стойкость шифрования): <code>ecp384</code>.</li>
</ul>
</li>
</ul>



<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-6 ">
  <div class="d-flex overflow-hidden">
    <div class="flex-grow-1 rounded overflow-hidden" id="cp-c5c95271a98cac5ce7293f5ade3c99f8">
      
      <pre><code >/ip ipsec proposal
add auth-algorithms=sha256 enc-algorithms=aes-256-cbc name=ipsec-sts pfs-group=ecp384</code></pre>
    </div>
    <div class="flex-shrink-0">
      <ul class="list-inline mb-0">
        <li class="list-inline-item" data-bs-tooltip data-bs-title='Копировать'>
          <a class="text-body" href="#"
             data-fn="clipboard preventDefault" data-clipboard-target="#cp-c5c95271a98cac5ce7293f5ade3c99f8"
             role="button" aria-label='Копировать'>
            <i class="fas fa-copy fa-fw"></i>
          </a>
        </li>
      </ul>
    </div>
  </div>
</div>

<ul>
<li>Добавляем <span class="shortcode shortcode-tag"><a href="/ru/tags/ipsec/" target="_blank">#IPsec</a></span> peer:
<ul>
<li>Имя peer&rsquo;а: <code>GW2</code>.</li>
<li>Внешний адрес <code>R2</code>: <code>gw2.example.com</code>.</li>
<li>Профиль: <code>ipsec-sts</code>.</li>
<li>Режим обмена: <code>ike2</code>.</li>
<li>Комментарий: <code>GW2</code>.</li>
</ul>
</li>
</ul>



<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-8 ">
  <div class="d-flex overflow-hidden">
    <div class="flex-grow-1 rounded overflow-hidden" id="cp-4daa83633bfde36d4c617b44ef429611">
      
      <pre><code >/ip ipsec peer
add address=&#34;gw2.example.com&#34; exchange-mode=ike2 name=GW2 profile=ipsec-sts comment=&#34;GW2&#34;</code></pre>
    </div>
    <div class="flex-shrink-0">
      <ul class="list-inline mb-0">
        <li class="list-inline-item" data-bs-tooltip data-bs-title='Копировать'>
          <a class="text-body" href="#"
             data-fn="clipboard preventDefault" data-clipboard-target="#cp-4daa83633bfde36d4c617b44ef429611"
             role="button" aria-label='Копировать'>
            <i class="fas fa-copy fa-fw"></i>
          </a>
        </li>
      </ul>
    </div>
  </div>
</div>

<ul>
<li>Добавляем идентификацию:
<ul>
<li>Peer: <code>GW2</code>.</li>
<li>Секретная фраза: <code>PassWord</code>.<br>
<em>Секретная фраза должна быть одинаковой на обоих маршрутизаторах.</em></li>
<li>Комментарий: <code>GW2</code>.</li>
</ul>
</li>
</ul>



<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-9 ">
  <div class="d-flex overflow-hidden">
    <div class="flex-grow-1 rounded overflow-hidden" id="cp-372791b521a5047c4ba018577792d5f0">
      
      <pre><code >/ip ipsec identity
add peer=GW2 secret=&#34;PassWord&#34; comment=&#34;GW2&#34;</code></pre>
    </div>
    <div class="flex-shrink-0">
      <ul class="list-inline mb-0">
        <li class="list-inline-item" data-bs-tooltip data-bs-title='Копировать'>
          <a class="text-body" href="#"
             data-fn="clipboard preventDefault" data-clipboard-target="#cp-372791b521a5047c4ba018577792d5f0"
             role="button" aria-label='Копировать'>
            <i class="fas fa-copy fa-fw"></i>
          </a>
        </li>
      </ul>
    </div>
  </div>
</div>

<ul>
<li>Добавляем политику <span class="shortcode shortcode-tag"><a href="/ru/tags/ipsec/" target="_blank">#IPsec</a></span>:
<ul>
<li>Peer: <code>GW2</code>.</li>
<li>Туннель: <code>yes</code>.</li>
<li>Адрес локальной сети <code>R1</code>: <code>10.1.0.0/16</code>.</li>
<li>Адрес удалённой сети <code>R2</code>: <code>10.2.0.0/16</code>.</li>
<li>Действие: <code>encrypt</code>.</li>
<li>Представление: <code>ipsec-sts</code>.</li>
<li>Комментарий: <code>GW1-GW2</code>.</li>
</ul>
</li>
</ul>



<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-11 ">
  <div class="d-flex overflow-hidden">
    <div class="flex-grow-1 rounded overflow-hidden" id="cp-88846470994c30073f576eed345564a7">
      
      <pre><code >/ip ipsec policy
add src-address=10.1.0.0/16 dst-address=10.2.0.0/16 tunnel=yes action=encrypt proposal=ipsec-sts peer=GW2 comment=&#34;GW1-GW2&#34;</code></pre>
    </div>
    <div class="flex-shrink-0">
      <ul class="list-inline mb-0">
        <li class="list-inline-item" data-bs-tooltip data-bs-title='Копировать'>
          <a class="text-body" href="#"
             data-fn="clipboard preventDefault" data-clipboard-target="#cp-88846470994c30073f576eed345564a7"
             role="button" aria-label='Копировать'>
            <i class="fas fa-copy fa-fw"></i>
          </a>
        </li>
      </ul>
    </div>
  </div>
</div>

<ul>
<li>Исключаем обработку трафика <span class="shortcode shortcode-tag"><a href="/ru/tags/ipsec/" target="_blank">#IPsec</a></span>:
<ul>
<li>Адрес локальной сети <code>R1</code>: <code>10.1.0.0/16</code>.</li>
<li>Адрес удалённой сети <code>R2</code>: <code>10.2.0.0/16</code>.</li>
<li>Комментарий: <code>[IPsec] GW1-GW2</code>.</li>
</ul>
</li>
</ul>



<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-13 ">
  <div class="d-flex overflow-hidden">
    <div class="flex-grow-1 rounded overflow-hidden" id="cp-a523093bf7109845c40d2bb2a0236fe9">
      
      <pre><code >/ip firewall nat
add chain=srcnat action=accept src-address=10.1.0.0/16 dst-address=10.2.0.0/16 place-before=0 comment=&#34;[IPsec] GW1-GW2&#34;</code></pre>
    </div>
    <div class="flex-shrink-0">
      <ul class="list-inline mb-0">
        <li class="list-inline-item" data-bs-tooltip data-bs-title='Копировать'>
          <a class="text-body" href="#"
             data-fn="clipboard preventDefault" data-clipboard-target="#cp-a523093bf7109845c40d2bb2a0236fe9"
             role="button" aria-label='Копировать'>
            <i class="fas fa-copy fa-fw"></i>
          </a>
        </li>
      </ul>
    </div>
  </div>
</div>

<ul>
<li>Настраивает фильтры брандмауэра:
<ul>
<li>Открыть порты <code>500</code> и <code>4500</code> по протоколу <code>UDP</code>.</li>
<li>Разрешить трафик по протоколу <code>ipsec-esp</code>.</li>
</ul>
</li>
</ul>



<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-14 ">
  <div class="d-flex overflow-hidden">
    <div class="flex-grow-1 rounded overflow-hidden" id="cp-5b74e661119e4b51381636b0d2a12c8d">
      
      <pre><code >/ip firewall filter
add action=accept chain=input dst-port=500,4500 in-interface-list=WAN protocol=udp comment=&#34;[ROS] IPsec&#34;
add action=accept chain=input in-interface-list=WAN protocol=ipsec-esp comment=&#34;[ROS] IPsec&#34;</code></pre>
    </div>
    <div class="flex-shrink-0">
      <ul class="list-inline mb-0">
        <li class="list-inline-item" data-bs-tooltip data-bs-title='Копировать'>
          <a class="text-body" href="#"
             data-fn="clipboard preventDefault" data-clipboard-target="#cp-5b74e661119e4b51381636b0d2a12c8d"
             role="button" aria-label='Копировать'>
            <i class="fas fa-copy fa-fw"></i>
          </a>
        </li>
      </ul>
    </div>
  </div>
</div>

<ul>
<li>Настраиваем обход отслеживания соединений <span class="shortcode shortcode-tag"><a href="/ru/tags/ipsec/" target="_blank">#IPsec</a></span> для снижения нагрузки на CPU маршрутизатора:
<ul>
<li>Пакеты из удалённой сети <code>R2</code> <code>10.2.0.0/16</code> в локальную сеть <code>R1</code> <code>10.1.0.0/16</code>.</li>
<li>Пакеты из локальной сети <code>R1</code> <code>10.1.0.0/16</code> в удалённую сеть <code>R2</code> <code>10.2.0.0/16</code>.</li>
</ul>
</li>
</ul>



<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-16 ">
  <div class="d-flex overflow-hidden">
    <div class="flex-grow-1 rounded overflow-hidden" id="cp-c4a30d7896835571a9ab58623cf4e8a3">
      
      <pre><code >/ip firewall raw
add action=notrack chain=prerouting src-address=10.2.0.0/16 dst-address=10.1.0.0/16 comment=&#34;[IPsec] GW2-GW1&#34;
add action=notrack chain=prerouting src-address=10.1.0.0/16 dst-address=10.2.0.0/16 comment=&#34;[IPsec] GW1-GW2&#34;</code></pre>
    </div>
    <div class="flex-shrink-0">
      <ul class="list-inline mb-0">
        <li class="list-inline-item" data-bs-tooltip data-bs-title='Копировать'>
          <a class="text-body" href="#"
             data-fn="clipboard preventDefault" data-clipboard-target="#cp-c4a30d7896835571a9ab58623cf4e8a3"
             role="button" aria-label='Копировать'>
            <i class="fas fa-copy fa-fw"></i>
          </a>
        </li>
      </ul>
    </div>
  </div>
</div>

<h3 id="router-2">
  <a class="link-body-emphasis" href="#router-2">Router #2</a>
</h3><ul>
<li>Добавляем профиль <span class="shortcode shortcode-tag"><a href="/ru/tags/ipsec/" target="_blank">#IPsec</a></span>:
<ul>
<li>Имя профиля: <code>ipsec-sts</code>.</li>
<li>Группа Diffie-Hellman (стойкость шифрования): <code>ecp384</code>.</li>
<li>Алгоритм шифрования: <code>aes-256</code>.</li>
</ul>
</li>
</ul>



<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-18 ">
  <div class="d-flex overflow-hidden">
    <div class="flex-grow-1 rounded overflow-hidden" id="cp-a2044b57fbe3a9041113b3a20360c83a">
      
      <pre><code >/ip ipsec profile
add dh-group=ecp384 enc-algorithm=aes-256 name=ipsec-sts</code></pre>
    </div>
    <div class="flex-shrink-0">
      <ul class="list-inline mb-0">
        <li class="list-inline-item" data-bs-tooltip data-bs-title='Копировать'>
          <a class="text-body" href="#"
             data-fn="clipboard preventDefault" data-clipboard-target="#cp-a2044b57fbe3a9041113b3a20360c83a"
             role="button" aria-label='Копировать'>
            <i class="fas fa-copy fa-fw"></i>
          </a>
        </li>
      </ul>
    </div>
  </div>
</div>

<ul>
<li>Добавляем представление <span class="shortcode shortcode-tag"><a href="/ru/tags/ipsec/" target="_blank">#IPsec</a></span>:
<ul>
<li>Имя представления: <code>ipsec-sts</code>.</li>
<li>Алгоритм аутентификации: <code>sha256</code>.</li>
<li>Алгоритм шифрования: <code>aes-256-cbc</code>.</li>
<li>Группа Diffie-Hellman (стойкость шифрования): <code>ecp384</code>.</li>
</ul>
</li>
</ul>



<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-20 ">
  <div class="d-flex overflow-hidden">
    <div class="flex-grow-1 rounded overflow-hidden" id="cp-811b64ec0320fad2d4c3c92e049b4b75">
      
      <pre><code >/ip ipsec proposal
add auth-algorithms=sha256 enc-algorithms=aes-256-cbc name=ipsec-sts pfs-group=ecp384</code></pre>
    </div>
    <div class="flex-shrink-0">
      <ul class="list-inline mb-0">
        <li class="list-inline-item" data-bs-tooltip data-bs-title='Копировать'>
          <a class="text-body" href="#"
             data-fn="clipboard preventDefault" data-clipboard-target="#cp-811b64ec0320fad2d4c3c92e049b4b75"
             role="button" aria-label='Копировать'>
            <i class="fas fa-copy fa-fw"></i>
          </a>
        </li>
      </ul>
    </div>
  </div>
</div>

<ul>
<li>Добавляем <span class="shortcode shortcode-tag"><a href="/ru/tags/ipsec/" target="_blank">#IPsec</a></span> peer:
<ul>
<li>Имя peer&rsquo;а: <code>GW1</code>.</li>
<li>Внешний адрес <code>R1</code>: <code>gw1.example.com</code>.</li>
<li>Профиль: <code>ipsec-sts</code>.</li>
<li>Режим обмена: <code>ike2</code>.</li>
<li>Комментарий: <code>GW1</code>.</li>
</ul>
</li>
</ul>



<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-22 ">
  <div class="d-flex overflow-hidden">
    <div class="flex-grow-1 rounded overflow-hidden" id="cp-b0c1f093da377fee657f63d62234204b">
      
      <pre><code >/ip ipsec peer
add address=&#34;gw1.example.com&#34; exchange-mode=ike2 name=GW1 profile=ipsec-sts comment=&#34;GW1&#34;</code></pre>
    </div>
    <div class="flex-shrink-0">
      <ul class="list-inline mb-0">
        <li class="list-inline-item" data-bs-tooltip data-bs-title='Копировать'>
          <a class="text-body" href="#"
             data-fn="clipboard preventDefault" data-clipboard-target="#cp-b0c1f093da377fee657f63d62234204b"
             role="button" aria-label='Копировать'>
            <i class="fas fa-copy fa-fw"></i>
          </a>
        </li>
      </ul>
    </div>
  </div>
</div>

<ul>
<li>Добавляем идентификацию:
<ul>
<li>Peer: <code>GW1</code>.</li>
<li>Секретная фраза: <code>PassWord</code>.<br>
<em>Секретная фраза должна быть одинаковой на обоих маршрутизаторах.</em></li>
<li>Комментарий: <code>GW1</code>.</li>
</ul>
</li>
</ul>



<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-23 ">
  <div class="d-flex overflow-hidden">
    <div class="flex-grow-1 rounded overflow-hidden" id="cp-daff6fcff1e4ca01bbb8a2764e9708ad">
      
      <pre><code >/ip ipsec identity
add peer=GW1 secret=&#34;PassWord&#34; comment=&#34;GW1&#34;</code></pre>
    </div>
    <div class="flex-shrink-0">
      <ul class="list-inline mb-0">
        <li class="list-inline-item" data-bs-tooltip data-bs-title='Копировать'>
          <a class="text-body" href="#"
             data-fn="clipboard preventDefault" data-clipboard-target="#cp-daff6fcff1e4ca01bbb8a2764e9708ad"
             role="button" aria-label='Копировать'>
            <i class="fas fa-copy fa-fw"></i>
          </a>
        </li>
      </ul>
    </div>
  </div>
</div>

<ul>
<li>Добавляем политику <span class="shortcode shortcode-tag"><a href="/ru/tags/ipsec/" target="_blank">#IPsec</a></span>:
<ul>
<li>Peer: <code>GW1</code>.</li>
<li>Туннель: <code>yes</code>.</li>
<li>Адрес локальной сети <code>R2</code>: <code>10.2.0.0/16</code>.</li>
<li>Адрес удалённой сети <code>R1</code>: <code>10.1.0.0/16</code>.</li>
<li>Действие: <code>encrypt</code>.</li>
<li>Представление: <code>ipsec-sts</code>.</li>
<li>Комментарий: <code>GW2-GW1</code>.</li>
</ul>
</li>
</ul>



<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-25 ">
  <div class="d-flex overflow-hidden">
    <div class="flex-grow-1 rounded overflow-hidden" id="cp-f42bbda4a68f3c82ce17358928c932a1">
      
      <pre><code >/ip ipsec policy
add src-address=10.2.0.0/16 dst-address=10.1.0.0/16 tunnel=yes action=encrypt proposal=ipsec-sts peer=GW1 comment=&#34;GW2-GW1&#34;</code></pre>
    </div>
    <div class="flex-shrink-0">
      <ul class="list-inline mb-0">
        <li class="list-inline-item" data-bs-tooltip data-bs-title='Копировать'>
          <a class="text-body" href="#"
             data-fn="clipboard preventDefault" data-clipboard-target="#cp-f42bbda4a68f3c82ce17358928c932a1"
             role="button" aria-label='Копировать'>
            <i class="fas fa-copy fa-fw"></i>
          </a>
        </li>
      </ul>
    </div>
  </div>
</div>

<ul>
<li>Исключаем обработку трафика <span class="shortcode shortcode-tag"><a href="/ru/tags/ipsec/" target="_blank">#IPsec</a></span>:
<ul>
<li>Адрес локальной сети <code>R2</code>: <code>10.2.0.0/16</code>.</li>
<li>Адрес удалённой сети <code>R1</code>: <code>10.1.0.0/16</code>.</li>
<li>Комментарий: <code>[IPsec] GW2-GW1</code>.</li>
</ul>
</li>
</ul>



<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-27 ">
  <div class="d-flex overflow-hidden">
    <div class="flex-grow-1 rounded overflow-hidden" id="cp-f0b23682e9229db7229309209ec235f4">
      
      <pre><code >/ip firewall nat
add chain=srcnat action=accept src-address=10.2.0.0/16 dst-address=10.1.0.0/16 place-before=0 comment=&#34;[IPsec] GW2-GW1&#34;</code></pre>
    </div>
    <div class="flex-shrink-0">
      <ul class="list-inline mb-0">
        <li class="list-inline-item" data-bs-tooltip data-bs-title='Копировать'>
          <a class="text-body" href="#"
             data-fn="clipboard preventDefault" data-clipboard-target="#cp-f0b23682e9229db7229309209ec235f4"
             role="button" aria-label='Копировать'>
            <i class="fas fa-copy fa-fw"></i>
          </a>
        </li>
      </ul>
    </div>
  </div>
</div>

<ul>
<li>Настраивает фильтры брандмауэра:
<ul>
<li>Открыть порты <code>500</code> и <code>4500</code> по протоколу <code>UDP</code>.</li>
<li>Разрешить трафик по протоколу <code>ipsec-esp</code>.</li>
</ul>
</li>
</ul>



<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-28 ">
  <div class="d-flex overflow-hidden">
    <div class="flex-grow-1 rounded overflow-hidden" id="cp-d6ff299ade838959d2ab17f48dc7337c">
      
      <pre><code >/ip firewall filter
add action=accept chain=input dst-port=500,4500 in-interface-list=WAN protocol=udp comment=&#34;[ROS] IPsec&#34;
add action=accept chain=input in-interface-list=WAN protocol=ipsec-esp comment=&#34;[ROS] IPsec&#34;</code></pre>
    </div>
    <div class="flex-shrink-0">
      <ul class="list-inline mb-0">
        <li class="list-inline-item" data-bs-tooltip data-bs-title='Копировать'>
          <a class="text-body" href="#"
             data-fn="clipboard preventDefault" data-clipboard-target="#cp-d6ff299ade838959d2ab17f48dc7337c"
             role="button" aria-label='Копировать'>
            <i class="fas fa-copy fa-fw"></i>
          </a>
        </li>
      </ul>
    </div>
  </div>
</div>

<ul>
<li>Настраиваем обход отслеживания соединений <span class="shortcode shortcode-tag"><a href="/ru/tags/ipsec/" target="_blank">#IPsec</a></span> для снижения нагрузки на CPU маршрутизатора:
<ul>
<li>Пакеты из удалённой сети <code>R1</code> <code>10.1.0.0/16</code> в локальную сеть <code>R2</code> <code>10.2.0.0/16</code>.</li>
<li>Пакеты из локальной сети <code>R2</code> <code>10.2.0.0/16</code> в удалённую сеть <code>R1</code> <code>10.1.0.0/16</code>.</li>
</ul>
</li>
</ul>



<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-30 ">
  <div class="d-flex overflow-hidden">
    <div class="flex-grow-1 rounded overflow-hidden" id="cp-c3f9d9f7351c6cf037e438943ee9bf2a">
      
      <pre><code >/ip firewall raw
add action=notrack chain=prerouting src-address=10.1.0.0/16 dst-address=10.2.0.0/16 comment=&#34;[IPsec] GW1-GW2&#34;
add action=notrack chain=prerouting src-address=10.2.0.0/16 dst-address=10.1.0.0/16 comment=&#34;[IPsec] GW2-GW1&#34;</code></pre>
    </div>
    <div class="flex-shrink-0">
      <ul class="list-inline mb-0">
        <li class="list-inline-item" data-bs-tooltip data-bs-title='Копировать'>
          <a class="text-body" href="#"
             data-fn="clipboard preventDefault" data-clipboard-target="#cp-c3f9d9f7351c6cf037e438943ee9bf2a"
             role="button" aria-label='Копировать'>
            <i class="fas fa-copy fa-fw"></i>
          </a>
        </li>
      </ul>
    </div>
  </div>
</div>

<h2 id="автоматизация">
  <a class="link-body-emphasis" href="#%d0%b0%d0%b2%d1%82%d0%be%d0%bc%d0%b0%d1%82%d0%b8%d0%b7%d0%b0%d1%86%d0%b8%d1%8f">Автоматизация</a>
</h2><p>Сделал небольшой скрипт, который позволяет быстро развернуть туннель между двумя маршрутизаторами. Скрипт запускается отдельно на каждом из маршрутизаторов со своими настройками.</p>

    

    
        
            
            <div class="shortcode shortcode-file mb-3">
              <div class="card overflow-hidden">
                <div class="card-header">
                  <div class="d-flex align-items-center">
                    <div class="flex-shrink-0">
                      <i class="far fa-file-code fa-fw"></i>
                    </div>
                    <div class="flex-grow-1 mx-2 text-truncate">
                      <code>ros.ipsec.rsc</code>
                    </div>
                    <div class="flex-shrink-0">
                      <ul class="list-inline mb-0">
                        <li class="list-inline-item" data-bs-tooltip data-bs-title='Копировать'>
                          <a class="text-body" href="#"
                             data-fn="clipboard preventDefault" data-clipboard-target="#cp-1fb3f95b189178a7605304ce2d09c65c"
                             role="button" aria-label='Копировать'>
                            <i class="fas fa-copy fa-fw"></i>
                          </a>
                        </li>
                        <li class="list-inline-item" data-bs-tooltip data-bs-title='Скачать'>
                          <a class="text-body" href="/ru/articles/2024/03/54a2b39f-38b4-5f0c-9b54-310f853da38f/ros.ipsec.rsc" download
                             role="button" aria-label='Скачать'>
                            <i class="fas fa-download fa-fw"></i>
                          </a>
                        </li>
                        <li class="list-inline-item" data-bs-tooltip data-bs-title='Открыть'>
                          <a class="text-body" href="/ru/articles/2024/03/54a2b39f-38b4-5f0c-9b54-310f853da38f/ros.ipsec.rsc" target="_blank"
                             role="button" aria-label='Открыть'>
                            <i class="fas fa-arrow-up-right-from-square fa-fw"></i>
                          </a>
                        </li>
                      </ul>
                    </div>
                  </div>
                </div>
                <div class="card-body" id="cp-1fb3f95b189178a7605304ce2d09c65c">
                    
                        
                    
                  <pre><code class="language-rsc"># @package    MikroTik / RouterOS / IPsec
# @author     Kai Kimera &lt;mail@kai.kim&gt;
# @copyright  2024 Library Online
# @license    MIT
# @version    0.1.0
# @link       https://lib.onl/ru/articles/2024/03/54a2b39f-38b4-5f0c-9b54-310f853da38f/
# -------------------------------------------------------------------------------------------------------------------- #

# IPsec secret phrase.
:local ipsSecret &#34;PassWord&#34;

# IPsec external interface.
:local ipsInterface &#34;WAN&#34;

# IPsec profile name.
:local ipsProfileName &#34;ipsec-sts&#34;

# -------------------------------------------------------------------------------------------------------------------- #
# Local router.
# -------------------------------------------------------------------------------------------------------------------- #

# Local router name.
:local ipsLocalName &#34;GW1&#34;

# Local network address.
:local ipsLocalNetwork &#34;10.1.0.0/16&#34;

# -------------------------------------------------------------------------------------------------------------------- #
# Remote router.
# -------------------------------------------------------------------------------------------------------------------- #

# Remote router name.
:local ipsRemoteName &#34;GW2&#34;

# Remote network address.
:local ipsRemoteNetwork &#34;10.2.0.0/16&#34;

# Remote external IP address.
:local ipsRemoteWanIp &#34;gw2.example.com&#34;

# -------------------------------------------------------------------------------------------------------------------- #
# -----------------------------------------------------&lt; SCRIPT &gt;----------------------------------------------------- #
# -------------------------------------------------------------------------------------------------------------------- #

/ip ipsec profile
add dh-group=ecp384 enc-algorithm=aes-256 name=$ipsProfileName

/ip ipsec proposal
add auth-algorithms=sha256 enc-algorithms=aes-256-cbc pfs-group=ecp384 name=$ipsProfileName

/ip ipsec peer
add address=$ipsRemoteWanIp exchange-mode=ike2 name=$ipsRemoteName profile=$ipsProfileName \
  comment=&#34;$ipsRemoteName&#34;

/ip ipsec identity
add peer=$ipsRemoteName secret=&#34;$ipsSecret&#34; \
  comment=&#34;$ipsRemoteName&#34;

/ip ipsec policy
add src-address=$ipsLocalNetwork dst-address=$ipsRemoteNetwork tunnel=yes action=encrypt \
  proposal=$ipsProfileName peer=$ipsRemoteName \
  comment=&#34;$ipsLocalName-$ipsRemoteName&#34;

/ip firewall nat
add chain=srcnat action=accept src-address=$ipsLocalNetwork dst-address=$ipsRemoteNetwork place-before=0 \
  comment=&#34;[IPsec] $ipsLocalName-$ipsRemoteName&#34;

/ip firewall filter
add action=accept chain=input dst-port=500,4500 in-interface-list=$ipsWan protocol=udp \
  comment=&#34;[ROS] IPsec&#34;
add action=accept chain=input in-interface-list=$ipsWan protocol=ipsec-esp \
  comment=&#34;[ROS] IPsec&#34;

# Use IP/Firewall/Raw to bypass connection tracking, that way eliminating need of filter rules and reducing load on CPU
# by approximately 30%.
/ip firewall raw
add action=notrack chain=prerouting src-address=$ipsRemoteNetwork dst-address=$ipsLocalNetwork \
  comment=&#34;[IPsec] $ipsRemoteName-$ipsLocalName&#34;
add action=notrack chain=prerouting src-address=$ipsLocalNetwork dst-address=$ipsRemoteNetwork \
  comment=&#34;[IPsec] $ipsLocalName-$ipsRemoteName&#34;</code></pre>
                </div>
              </div>
            </div>]]></turbo:content></item><item turbo="true"><title>Обновление Cisco IOS</title><link>https://lib.onl/ru/articles/2024/03/b81f9cca-d723-5b72-929a-b88be9d329f9/</link><pubDate>Wed, 27 Mar 2024 18:41:49 +0000</pubDate><dc:creator>Kai Kimera</dc:creator><category>Сеть</category><category>Терминал</category><yandex:related><link url="https://lib.onl/ru/articles/2024/03/4a7addb9-eff3-5482-902c-791fbe49899f/">Загрузка и выгрузка конфигурации Cisco</link><link url="https://lib.onl/ru/articles/2024/03/fc67eb74-8f7c-5de3-bd1e-2d823208eae2/">Сброс пароля Cisco</link><link url="https://lib.onl/ru/articles/2021/05/0acd3f9d-07b7-52b8-9fac-b5cb1cc579e0/">Обновление Fedora Linux до актуальной версии</link></yandex:related><turbo:extendedHtml>true</turbo:extendedHtml><turbo:source>https://lib.onl/ru/articles/2024/03/b81f9cca-d723-5b72-929a-b88be9d329f9/</turbo:source><turbo:topic>Обновление Cisco IOS</turbo:topic><turbo:content><![CDATA[<p>Инструкция по резервному копированию и обновлению <span class="shortcode shortcode-tag"><a href="/ru/tags/cisco/" target="_blank">#Cisco</a></span> <span class="shortcode shortcode-tag"><a href="/ru/tags/ios/" target="_blank">#IOS</a></span>.</p>
<h2 id="общая-настройка">
  <a class="link-body-emphasis" href="#%d0%be%d0%b1%d1%89%d0%b0%d1%8f-%d0%bd%d0%b0%d1%81%d1%82%d1%80%d0%be%d0%b9%d0%ba%d0%b0">Общая настройка</a>
</h2><ul>
<li>Настроить сетевой интерфейс компьютера со следующими параметрами:
<ul>
<li>IP-адрес: <code>192.168.1.2</code>.</li>
<li>Маска подсети: <code>255.255.255.0</code>.</li>
<li>Шлюз: <code>192.168.1.1</code>.</li>
<li>DNS: <code>8.8.8.8</code>.</li>
</ul>
</li>
<li>Настроить сетевой интерфейс <span class="shortcode shortcode-tag"><a href="/ru/tags/cisco/" target="_blank">#Cisco</a></span> со следующими параметрами:</li>
</ul>



<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-3 shortcode-codeblock-text">
  <div class="d-flex overflow-hidden">
    <div class="flex-grow-1 rounded overflow-hidden" id="cp-247292a6e0fc5839165347010b402d55">
      
      <pre><code class='language-text'>&gt; en
Router# conf t
Router(config)# int fa0/1
Router(config-if)# ip address 192.168.1.1 255.255.255.0
Router(config-if)# no shutdown
Router(config-if)# exit
Router(config)# exit
Router#</code></pre>
    </div>
    <div class="flex-shrink-0">
      <ul class="list-inline mb-0">
        <li class="list-inline-item" data-bs-tooltip data-bs-title='Копировать'>
          <a class="text-body" href="#"
             data-fn="clipboard preventDefault" data-clipboard-target="#cp-247292a6e0fc5839165347010b402d55"
             role="button" aria-label='Копировать'>
            <i class="fas fa-copy fa-fw"></i>
          </a>
        </li>
      </ul>
    </div>
  </div>
</div>

<ul>
<li>Подключить сетевой интерфейс компьютера к сетевому интерфейсу <span class="shortcode shortcode-tag"><a href="/ru/tags/cisco/" target="_blank">#Cisco</a></span> <code>FE0/1</code>.</li>
<li>Запустить TFTP-сервер на компьютере c IP <code>192.168.1.2</code>.</li>
</ul>
<h2 id="резервное-копирование-текущего-образа-ios">
  <a class="link-body-emphasis" href="#%d1%80%d0%b5%d0%b7%d0%b5%d1%80%d0%b2%d0%bd%d0%be%d0%b5-%d0%ba%d0%be%d0%bf%d0%b8%d1%80%d0%be%d0%b2%d0%b0%d0%bd%d0%b8%d0%b5-%d1%82%d0%b5%d0%ba%d1%83%d1%89%d0%b5%d0%b3%d0%be-%d0%be%d0%b1%d1%80%d0%b0%d0%b7%d0%b0-ios">Резервное копирование текущего образа IOS</a>
</h2><ul>
<li>Посмотреть текущую версию <span class="shortcode shortcode-tag"><a href="/ru/tags/ios/" target="_blank">#IOS</a></span>:</li>
</ul>



<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-6 shortcode-codeblock-text">
  <div class="d-flex overflow-hidden">
    <div class="flex-grow-1 rounded overflow-hidden" id="cp-26a1dd9c4bd6804746a372296eca6ce8">
      
      <pre><code class='language-text'>Router# show version</code></pre>
    </div>
    <div class="flex-shrink-0">
      <ul class="list-inline mb-0">
        <li class="list-inline-item" data-bs-tooltip data-bs-title='Копировать'>
          <a class="text-body" href="#"
             data-fn="clipboard preventDefault" data-clipboard-target="#cp-26a1dd9c4bd6804746a372296eca6ce8"
             role="button" aria-label='Копировать'>
            <i class="fas fa-copy fa-fw"></i>
          </a>
        </li>
      </ul>
    </div>
  </div>
</div>

<ul>
<li>Сделать резервную копию текущего образа <span class="shortcode shortcode-tag"><a href="/ru/tags/ios/" target="_blank">#IOS</a></span> на TFTP-сервер:</li>
</ul>



<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-8 shortcode-codeblock-text">
  <div class="d-flex overflow-hidden">
    <div class="flex-grow-1 rounded overflow-hidden" id="cp-be69a83897f7b0eb8c5315bcbd634760">
      
      <pre><code class='language-text'>Router# show flash: | include .bin
Router# copy flash:IOS_FW.bin tftp://192.168.1.2</code></pre>
    </div>
    <div class="flex-shrink-0">
      <ul class="list-inline mb-0">
        <li class="list-inline-item" data-bs-tooltip data-bs-title='Копировать'>
          <a class="text-body" href="#"
             data-fn="clipboard preventDefault" data-clipboard-target="#cp-be69a83897f7b0eb8c5315bcbd634760"
             role="button" aria-label='Копировать'>
            <i class="fas fa-copy fa-fw"></i>
          </a>
        </li>
      </ul>
    </div>
  </div>
</div>

<p>Где:</p>
<ul>
<li><code>flash:IOS_FW.bin</code> - источник, файл текущего образа <span class="shortcode shortcode-tag"><a href="/ru/tags/ios/" target="_blank">#IOS</a></span> на flash-карте (<code>IOS_FW.bin</code>).</li>
<li><code>tftp://192.168.1.2</code> - назначение, IP-адрес TFTP-сервера.</li>
</ul>
<h2 id="загрузка-нового-образа-ios">
  <a class="link-body-emphasis" href="#%d0%b7%d0%b0%d0%b3%d1%80%d1%83%d0%b7%d0%ba%d0%b0-%d0%bd%d0%be%d0%b2%d0%be%d0%b3%d0%be-%d0%be%d0%b1%d1%80%d0%b0%d0%b7%d0%b0-ios">Загрузка нового образа IOS</a>
</h2><ul>
<li>Записать на Flash-карту новый образ <span class="shortcode shortcode-tag"><a href="/ru/tags/ios/" target="_blank">#IOS</a></span>:</li>
</ul>



<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-11 shortcode-codeblock-text">
  <div class="d-flex overflow-hidden">
    <div class="flex-grow-1 rounded overflow-hidden" id="cp-b31777c15032a9f8886b2c9274ceba41">
      
      <pre><code class='language-text'>Router# copy tftp://192.168.1.2/IOS_FW.bin flash:</code></pre>
    </div>
    <div class="flex-shrink-0">
      <ul class="list-inline mb-0">
        <li class="list-inline-item" data-bs-tooltip data-bs-title='Копировать'>
          <a class="text-body" href="#"
             data-fn="clipboard preventDefault" data-clipboard-target="#cp-b31777c15032a9f8886b2c9274ceba41"
             role="button" aria-label='Копировать'>
            <i class="fas fa-copy fa-fw"></i>
          </a>
        </li>
      </ul>
    </div>
  </div>
</div>

<p>Где:</p>
<ul>
<li><code>tftp://192.168.1.2/IOS_FW.bin</code> - источник, адрес TFTP-сервера и путь к файлу с образом <span class="shortcode shortcode-tag"><a href="/ru/tags/ios/" target="_blank">#IOS</a></span> (<code>IOS_FW.bin</code>).</li>
<li><code>flash:</code> - назначение, flash-карта.</li>
</ul>
<h2 id="верификация-нового-образа-ios">
  <a class="link-body-emphasis" href="#%d0%b2%d0%b5%d1%80%d0%b8%d1%84%d0%b8%d0%ba%d0%b0%d1%86%d0%b8%d1%8f-%d0%bd%d0%be%d0%b2%d0%be%d0%b3%d0%be-%d0%be%d0%b1%d1%80%d0%b0%d0%b7%d0%b0-ios">Верификация нового образа IOS</a>
</h2>


<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-13 shortcode-codeblock-text">
  <div class="d-flex overflow-hidden">
    <div class="flex-grow-1 rounded overflow-hidden" id="cp-10068d1f2b77cc7518797e904ab93938">
      
      <pre><code class='language-text'>Router# show flash: | include .bin
Router# verify /md5 flash:IOS_FW.bin</code></pre>
    </div>
    <div class="flex-shrink-0">
      <ul class="list-inline mb-0">
        <li class="list-inline-item" data-bs-tooltip data-bs-title='Копировать'>
          <a class="text-body" href="#"
             data-fn="clipboard preventDefault" data-clipboard-target="#cp-10068d1f2b77cc7518797e904ab93938"
             role="button" aria-label='Копировать'>
            <i class="fas fa-copy fa-fw"></i>
          </a>
        </li>
      </ul>
    </div>
  </div>
</div>

<p>Где:</p>
<ul>
<li><code>flash:IOS_FW.bin</code> - образ <span class="shortcode shortcode-tag"><a href="/ru/tags/ios/" target="_blank">#IOS</a></span> (<code>IOS_FW.bin</code>) на flash-карте.</li>
</ul>
<h2 id="обновление-ios">
  <a class="link-body-emphasis" href="#%d0%be%d0%b1%d0%bd%d0%be%d0%b2%d0%bb%d0%b5%d0%bd%d0%b8%d0%b5-ios">Обновление IOS</a>
</h2><ul>
<li>Прописать в конфигурации <span class="shortcode shortcode-tag"><a href="/ru/tags/cisco/" target="_blank">#Cisco</a></span> загрузку нового образа <span class="shortcode shortcode-tag"><a href="/ru/tags/ios/" target="_blank">#IOS</a></span>:</li>
</ul>



<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-17 shortcode-codeblock-text">
  <div class="d-flex overflow-hidden">
    <div class="flex-grow-1 rounded overflow-hidden" id="cp-e2ce1a9673cced7b411b6aa09225414f">
      
      <pre><code class='language-text'>Router# conf t
Router(config)# boot system flash:IOS_FW.bin
Router(config)# exit
Router# reload</code></pre>
    </div>
    <div class="flex-shrink-0">
      <ul class="list-inline mb-0">
        <li class="list-inline-item" data-bs-tooltip data-bs-title='Копировать'>
          <a class="text-body" href="#"
             data-fn="clipboard preventDefault" data-clipboard-target="#cp-e2ce1a9673cced7b411b6aa09225414f"
             role="button" aria-label='Копировать'>
            <i class="fas fa-copy fa-fw"></i>
          </a>
        </li>
      </ul>
    </div>
  </div>
</div>

<p>Где:</p>
<ul>
<li><code>flash:IOS_FW.bin</code> - образ <span class="shortcode shortcode-tag"><a href="/ru/tags/ios/" target="_blank">#IOS</a></span> (<code>IOS_FW.bin</code>) на flash-карте.</li>
</ul>
<h2 id="проверка-новой-версии-ios">
  <a class="link-body-emphasis" href="#%d0%bf%d1%80%d0%be%d0%b2%d0%b5%d1%80%d0%ba%d0%b0-%d0%bd%d0%be%d0%b2%d0%be%d0%b9-%d0%b2%d0%b5%d1%80%d1%81%d0%b8%d0%b8-ios">Проверка новой версии IOS</a>
</h2><ul>
<li>Посмотреть версию <span class="shortcode shortcode-tag"><a href="/ru/tags/ios/" target="_blank">#IOS</a></span> после перезагрузки:</li>
</ul>



<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-20 shortcode-codeblock-text">
  <div class="d-flex overflow-hidden">
    <div class="flex-grow-1 rounded overflow-hidden" id="cp-e6e8b42245170cc077bddfabdf69201d">
      
      <pre><code class='language-text'>Router# show version</code></pre>
    </div>
    <div class="flex-shrink-0">
      <ul class="list-inline mb-0">
        <li class="list-inline-item" data-bs-tooltip data-bs-title='Копировать'>
          <a class="text-body" href="#"
             data-fn="clipboard preventDefault" data-clipboard-target="#cp-e6e8b42245170cc077bddfabdf69201d"
             role="button" aria-label='Копировать'>
            <i class="fas fa-copy fa-fw"></i>
          </a>
        </li>
      </ul>
    </div>
  </div>
</div>

<ul>
<li>Готово!</li>
</ul>]]></turbo:content></item><item turbo="true"><title>Как проверить PTR-запись?</title><link>https://lib.onl/ru/faq/2024/03/4db553f9-8a24-5807-bce0-bbbcc59fb4e1/</link><pubDate>Wed, 27 Mar 2024 13:49:08 +0000</pubDate><dc:creator>Kai Kimera</dc:creator><category>Dns</category><category>Ptr</category><category>Nslookup</category><turbo:extendedHtml>true</turbo:extendedHtml><turbo:source>https://lib.onl/ru/faq/2024/03/4db553f9-8a24-5807-bce0-bbbcc59fb4e1/</turbo:source><turbo:topic>Как проверить PTR-запись?</turbo:topic><turbo:content>&lt;p>Как проверить запись PTR у домена?&lt;/p></turbo:content></item><item turbo="true"><title>Загрузка и выгрузка конфигурации Cisco</title><link>https://lib.onl/ru/articles/2024/03/4a7addb9-eff3-5482-902c-791fbe49899f/</link><pubDate>Tue, 26 Mar 2024 13:00:25 +0000</pubDate><dc:creator>Kai Kimera</dc:creator><category>Сеть</category><category>Терминал</category><yandex:related><link url="https://lib.onl/ru/articles/2024/03/fc67eb74-8f7c-5de3-bd1e-2d823208eae2/">Сброс пароля Cisco</link></yandex:related><turbo:extendedHtml>true</turbo:extendedHtml><turbo:source>https://lib.onl/ru/articles/2024/03/4a7addb9-eff3-5482-902c-791fbe49899f/</turbo:source><turbo:topic>Загрузка и выгрузка конфигурации Cisco</turbo:topic><turbo:content><![CDATA[<p>Рассмотрим способ загрузки и выгрузки (backup) конфигурации на устройствах <span class="shortcode shortcode-tag"><a href="/ru/tags/cisco/" target="_blank">#Cisco</a></span>.</p>
<h2 id="общая-настройка">
  <a class="link-body-emphasis" href="#%d0%be%d0%b1%d1%89%d0%b0%d1%8f-%d0%bd%d0%b0%d1%81%d1%82%d1%80%d0%be%d0%b9%d0%ba%d0%b0">Общая настройка</a>
</h2><ul>
<li>Настроить сетевой интерфейс компьютера со следующими параметрами:
<ul>
<li>IP-адрес: <code>192.168.1.2</code>.</li>
<li>Маска подсети: <code>255.255.255.0</code>.</li>
<li>Шлюз: <code>192.168.1.1</code>.</li>
<li>DNS: <code>8.8.8.8</code>.</li>
</ul>
</li>
<li>Настроить сетевой интерфейс <span class="shortcode shortcode-tag"><a href="/ru/tags/cisco/" target="_blank">#Cisco</a></span> со следующими параметрами:</li>
</ul>



<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-2 shortcode-codeblock-text">
  <div class="d-flex overflow-hidden">
    <div class="flex-grow-1 rounded overflow-hidden" id="cp-0c44350885f0ee196fbcd18c5015ffc6">
      
      <pre><code class='language-text'>Router&gt; en
Router# conf t
Router(config)# int fa0/1
Router(config-if)# ip address 192.168.1.1 255.255.255.0
Router(config-if)# no shutdown
Router(config-if)# exit
Router(config)# exit
Router#</code></pre>
    </div>
    <div class="flex-shrink-0">
      <ul class="list-inline mb-0">
        <li class="list-inline-item" data-bs-tooltip data-bs-title='Копировать'>
          <a class="text-body" href="#"
             data-fn="clipboard preventDefault" data-clipboard-target="#cp-0c44350885f0ee196fbcd18c5015ffc6"
             role="button" aria-label='Копировать'>
            <i class="fas fa-copy fa-fw"></i>
          </a>
        </li>
      </ul>
    </div>
  </div>
</div>

<ul>
<li>Подключить сетевой интерфейс компьютера к сетевому интерфейсу <span class="shortcode shortcode-tag"><a href="/ru/tags/cisco/" target="_blank">#Cisco</a></span> <code>FE0/1</code>.</li>
<li>Запустить TFTP-сервер на компьютере c IP <code>192.168.1.2</code>.</li>
</ul>
<h2 id="загрузка-конфигурации">
  <a class="link-body-emphasis" href="#%d0%b7%d0%b0%d0%b3%d1%80%d1%83%d0%b7%d0%ba%d0%b0-%d0%ba%d0%be%d0%bd%d1%84%d0%b8%d0%b3%d1%83%d1%80%d0%b0%d1%86%d0%b8%d0%b8">Загрузка конфигурации</a>
</h2><p>Для того, чтобы загрузить конфигурацию с TFTP-сервера, необходимо выполнить следующую команду:</p>



<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-4 shortcode-codeblock-text">
  <div class="d-flex overflow-hidden">
    <div class="flex-grow-1 rounded overflow-hidden" id="cp-dd56b67d8a4615ee48225a51d2812160">
      
      <pre><code class='language-text'>Router# copy tftp://192.168.1.2/BACKUP_CONF_FILE startup-config</code></pre>
    </div>
    <div class="flex-shrink-0">
      <ul class="list-inline mb-0">
        <li class="list-inline-item" data-bs-tooltip data-bs-title='Копировать'>
          <a class="text-body" href="#"
             data-fn="clipboard preventDefault" data-clipboard-target="#cp-dd56b67d8a4615ee48225a51d2812160"
             role="button" aria-label='Копировать'>
            <i class="fas fa-copy fa-fw"></i>
          </a>
        </li>
      </ul>
    </div>
  </div>
</div>

<p>Где:</p>
<ul>
<li><code>tftp://192.168.1.2/BACKUP_CONF_FILE</code> - источник, адрес TFTP-сервера и путь к файлу конфигурации.</li>
<li><code>startup-config</code> - назначение, хранилище стартовой конфигурации.</li>
</ul>
<h2 id="выгрузка-конфигурации">
  <a class="link-body-emphasis" href="#%d0%b2%d1%8b%d0%b3%d1%80%d1%83%d0%b7%d0%ba%d0%b0-%d0%ba%d0%be%d0%bd%d1%84%d0%b8%d0%b3%d1%83%d1%80%d0%b0%d1%86%d0%b8%d0%b8">Выгрузка конфигурации</a>
</h2><p>Для выгрузки конфигурации <span class="shortcode shortcode-tag"><a href="/ru/tags/cisco/" target="_blank">#Cisco</a></span> на внешний TFTP-сервер, можно воспользоваться следующей командой:</p>



<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-6 shortcode-codeblock-text">
  <div class="d-flex overflow-hidden">
    <div class="flex-grow-1 rounded overflow-hidden" id="cp-1904929a663ba2042281c941e0ad32ab">
      
      <pre><code class='language-text'>Router# copy startup-config tftp://192.168.1.2/BACKUP_CONF_FILE</code></pre>
    </div>
    <div class="flex-shrink-0">
      <ul class="list-inline mb-0">
        <li class="list-inline-item" data-bs-tooltip data-bs-title='Копировать'>
          <a class="text-body" href="#"
             data-fn="clipboard preventDefault" data-clipboard-target="#cp-1904929a663ba2042281c941e0ad32ab"
             role="button" aria-label='Копировать'>
            <i class="fas fa-copy fa-fw"></i>
          </a>
        </li>
      </ul>
    </div>
  </div>
</div>

<p>Где:</p>
<ul>
<li><code>startup-config</code> - источник, хранилище стартовой конфигурации.</li>
<li><code>tftp://192.168.1.2/BACKUP_CONF_FILE</code> - назначение, адрес TFTP-сервера и название файла конфигурации.</li>
</ul>]]></turbo:content></item><item turbo="true"><title>Сброс пароля Cisco</title><link>https://lib.onl/ru/articles/2024/03/fc67eb74-8f7c-5de3-bd1e-2d823208eae2/</link><pubDate>Tue, 26 Mar 2024 12:07:17 +0000</pubDate><dc:creator>Kai Kimera</dc:creator><category>Сеть</category><category>Терминал</category><turbo:extendedHtml>true</turbo:extendedHtml><turbo:source>https://lib.onl/ru/articles/2024/03/fc67eb74-8f7c-5de3-bd1e-2d823208eae2/</turbo:source><turbo:topic>Сброс пароля Cisco</turbo:topic><turbo:content><![CDATA[<p>Инструкция по сбросу пароля администратора в готовой конфигурации на устройствах <span class="shortcode shortcode-tag"><a href="/ru/tags/cisco/" target="_blank">#Cisco</a></span>.</p>
<ul>
<li>Подключиться к COM-порту <span class="shortcode shortcode-tag"><a href="/ru/tags/cisco/" target="_blank">#Cisco</a></span>.</li>
<li>Загрузиться в <strong>ROMMON</strong> (при старте <span class="shortcode shortcode-tag"><a href="/ru/tags/cisco/" target="_blank">#Cisco</a></span> нажать клавишу <span class="shortcode shortcode-key d-inline-block"><kbd>Break</kbd></span>).</li>
<li>Переключить регистр с <code>0x2102</code> на <code>0x2142</code> и перезагрузить:</li>
</ul>



<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-4 shortcode-codeblock-text">
  <div class="d-flex overflow-hidden">
    <div class="flex-grow-1 rounded overflow-hidden" id="cp-9f72747990a76cd2886e7fed2db67c7a">
      
      <pre><code class='language-text'>rommon&gt; confreg 0x2142
rommon&gt; reset</code></pre>
    </div>
    <div class="flex-shrink-0">
      <ul class="list-inline mb-0">
        <li class="list-inline-item" data-bs-tooltip data-bs-title='Копировать'>
          <a class="text-body" href="#"
             data-fn="clipboard preventDefault" data-clipboard-target="#cp-9f72747990a76cd2886e7fed2db67c7a"
             role="button" aria-label='Копировать'>
            <i class="fas fa-copy fa-fw"></i>
          </a>
        </li>
      </ul>
    </div>
  </div>
</div>

<ul>
<li>Сбросить пароль:</li>
</ul>



<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-5 shortcode-codeblock-text">
  <div class="d-flex overflow-hidden">
    <div class="flex-grow-1 rounded overflow-hidden" id="cp-c9db9e6b2e7831075c36f4c18ea689a3">
      
      <pre><code class='language-text'>Router&gt; en
Router# copy startup-config running-config
Router# config t
Router(config)# en secret PassWord
Router(config)# username USER privilege 15 secret PassWord</code></pre>
    </div>
    <div class="flex-shrink-0">
      <ul class="list-inline mb-0">
        <li class="list-inline-item" data-bs-tooltip data-bs-title='Копировать'>
          <a class="text-body" href="#"
             data-fn="clipboard preventDefault" data-clipboard-target="#cp-c9db9e6b2e7831075c36f4c18ea689a3"
             role="button" aria-label='Копировать'>
            <i class="fas fa-copy fa-fw"></i>
          </a>
        </li>
      </ul>
    </div>
  </div>
</div>

<ul>
<li>Переключить регистр с <code>0x2142</code> на <code>0x2102</code>:</li>
</ul>



<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-6 shortcode-codeblock-text">
  <div class="d-flex overflow-hidden">
    <div class="flex-grow-1 rounded overflow-hidden" id="cp-91abf8c652f7c220c2fb3824a710e814">
      
      <pre><code class='language-text'>Router(config)# config-register 0x2102
Router(config)# exit
Router# copy running-config startup-config
Router# reload</code></pre>
    </div>
    <div class="flex-shrink-0">
      <ul class="list-inline mb-0">
        <li class="list-inline-item" data-bs-tooltip data-bs-title='Копировать'>
          <a class="text-body" href="#"
             data-fn="clipboard preventDefault" data-clipboard-target="#cp-91abf8c652f7c220c2fb3824a710e814"
             role="button" aria-label='Копировать'>
            <i class="fas fa-copy fa-fw"></i>
          </a>
        </li>
      </ul>
    </div>
  </div>
</div>

<ul>
<li>Готово!</li>
</ul>]]></turbo:content></item><item turbo="true"><title>Как скрыть листинг директории, при этом разрешить просмотр содержимого файлов?</title><link>https://lib.onl/ru/faq/2024/02/0a853441-d526-52ab-b5b2-48a57be6c33f/</link><pubDate>Fri, 16 Feb 2024 13:28:52 +0000</pubDate><dc:creator>Kai Kimera</dc:creator><category>Linux</category><category>Freebsd</category><category>Listing</category><category>Chmod</category><category>Permissions</category><yandex:related><link url="https://lib.onl/ru/faq/2024/02/2589b2dc-ae2a-53a0-91d8-b3475c10401e/">Как создать директорию с общим доступом в Linux?</link><link url="https://lib.onl/ru/faq/2024/02/936da675-3366-5344-a14a-5963d84c136d/">Как исправить ошибки сетевой карты Realtek в FreeBSD?</link></yandex:related><turbo:extendedHtml>true</turbo:extendedHtml><turbo:source>https://lib.onl/ru/faq/2024/02/0a853441-d526-52ab-b5b2-48a57be6c33f/</turbo:source><turbo:topic>Как скрыть листинг директории, при этом разрешить просмотр содержимого файлов?</turbo:topic><turbo:content>&lt;p>Как скрыть содержимое директории от просмотра, но разрешить читать содержимое её файлов?&lt;/p></turbo:content></item><item turbo="true"><title>Как создать директорию с общим доступом в Linux?</title><link>https://lib.onl/ru/faq/2024/02/2589b2dc-ae2a-53a0-91d8-b3475c10401e/</link><pubDate>Tue, 13 Feb 2024 12:47:40 +0000</pubDate><dc:creator>Kai Kimera</dc:creator><category>Linux</category><category>Freebsd</category><category>Chmod</category><category>Groupadd</category><category>Usermod</category><category>Chgrp</category><category>Permissions</category><yandex:related><link url="https://lib.onl/ru/faq/2024/02/936da675-3366-5344-a14a-5963d84c136d/">Как исправить ошибки сетевой карты Realtek в FreeBSD?</link></yandex:related><turbo:extendedHtml>true</turbo:extendedHtml><turbo:source>https://lib.onl/ru/faq/2024/02/2589b2dc-ae2a-53a0-91d8-b3475c10401e/</turbo:source><turbo:topic>Как создать директорию с общим доступом в Linux?</turbo:topic><turbo:content><![CDATA[<p>Нужна директория, в которой пользователи могут создавать общие файлы и папки в <span class="shortcode shortcode-tag"><a href="/ru/tags/linux/" target="_blank">#Linux</a></span> (<span class="shortcode shortcode-tag"><a href="/ru/tags/freebsd/" target="_blank">#FreeBSD</a></span>). Как такое можно сделать?</p>]]></turbo:content></item><item turbo="true"><title>Как проверить сервер Postfix?</title><link>https://lib.onl/ru/faq/2024/02/404156e2-2ffb-535a-9b83-e40e1890f36a/</link><pubDate>Tue, 13 Feb 2024 02:49:47 +0000</pubDate><dc:creator>Kai Kimera</dc:creator><category>Postfix</category><category>Telnet</category><turbo:extendedHtml>true</turbo:extendedHtml><turbo:source>https://lib.onl/ru/faq/2024/02/404156e2-2ffb-535a-9b83-e40e1890f36a/</turbo:source><turbo:topic>Как проверить сервер Postfix?</turbo:topic><turbo:content><![CDATA[<p>У меня есть почтовый сервер на базе <span class="shortcode shortcode-tag"><a href="/ru/tags/postfix/" target="_blank">#Postfix</a></span>. Как мне проверить его работоспособность?</p>]]></turbo:content></item><item turbo="true"><title>Как исправить ошибки сетевой карты Realtek в FreeBSD?</title><link>https://lib.onl/ru/faq/2024/02/936da675-3366-5344-a14a-5963d84c136d/</link><pubDate>Sun, 11 Feb 2024 12:27:09 +0000</pubDate><dc:creator>Kai Kimera</dc:creator><category>Freebsd</category><category>Realtek</category><yandex:related><link url="https://lib.onl/ru/faq/2024/02/a87c514f-4a5e-52e3-ad76-4dd11218c6d1/">Как исправить ошибки сетевой карты Realtek в OPNsense?</link></yandex:related><turbo:extendedHtml>true</turbo:extendedHtml><turbo:source>https://lib.onl/ru/faq/2024/02/936da675-3366-5344-a14a-5963d84c136d/</turbo:source><turbo:topic>Как исправить ошибки сетевой карты Realtek в FreeBSD?</turbo:topic><turbo:content><![CDATA[<p>Сетевая карта <span class="shortcode shortcode-tag"><a href="/ru/tags/realtek/" target="_blank">#Realtek</a></span> в <span class="shortcode shortcode-tag"><a href="/ru/tags/freebsd/" target="_blank">#FreeBSD</a></span> работает не совсем корректно. Почему?</p>]]></turbo:content></item><item turbo="true"><title>Как исправить ошибки сетевой карты Realtek в OPNsense?</title><link>https://lib.onl/ru/faq/2024/02/a87c514f-4a5e-52e3-ad76-4dd11218c6d1/</link><pubDate>Sun, 11 Feb 2024 12:12:57 +0000</pubDate><dc:creator>Kai Kimera</dc:creator><category>Opnsense</category><category>Realtek</category><category>Nat</category><turbo:extendedHtml>true</turbo:extendedHtml><turbo:source>https://lib.onl/ru/faq/2024/02/a87c514f-4a5e-52e3-ad76-4dd11218c6d1/</turbo:source><turbo:topic>Как исправить ошибки сетевой карты Realtek в OPNsense?</turbo:topic><turbo:content><![CDATA[<p>Сетевая карта <span class="shortcode shortcode-tag"><a href="/ru/tags/realtek/" target="_blank">#Realtek</a></span> в <span class="shortcode shortcode-tag"><a href="/ru/tags/opnsense/" target="_blank">#OPNsense</a></span> ведёт себя странно: разрывает соединение или понижает скорость передачи данных. В чём проблема?</p>]]></turbo:content></item><item turbo="true"><title>Как правильно настроить PuTTY?</title><link>https://lib.onl/ru/faq/2024/02/fa01d796-4d5e-51f8-968a-9937c299b86c/</link><pubDate>Sun, 11 Feb 2024 12:08:56 +0000</pubDate><dc:creator>Kai Kimera</dc:creator><category>Putty</category><category>Kitty</category><turbo:extendedHtml>true</turbo:extendedHtml><turbo:source>https://lib.onl/ru/faq/2024/02/fa01d796-4d5e-51f8-968a-9937c299b86c/</turbo:source><turbo:topic>Как правильно настроить PuTTY?</turbo:topic><turbo:content><![CDATA[<p>У меня <span class="shortcode shortcode-tag"><a href="/ru/tags/putty/" target="_blank">#PuTTY</a></span> / <span class="shortcode shortcode-tag"><a href="/ru/tags/kitty/" target="_blank">#KiTTY</a></span> неправильно отображает шрифт и некорректно рисует интерфейсы. Как это исправить?</p>]]></turbo:content></item><item turbo="true"><title>Первичная настройка FreeBSD</title><link>https://lib.onl/ru/articles/2024/02/f97dc310-9a6a-52f7-8441-bf7eb02087c2/</link><pubDate>Thu, 08 Feb 2024 08:59:09 +0000</pubDate><dc:creator>Kai Kimera</dc:creator><category>BSD</category><turbo:extendedHtml>true</turbo:extendedHtml><turbo:source>https://lib.onl/ru/articles/2024/02/f97dc310-9a6a-52f7-8441-bf7eb02087c2/</turbo:source><turbo:topic>Первичная настройка FreeBSD</turbo:topic><turbo:content><![CDATA[<p>Надумал я как-то на днях изучить ОС <span class="shortcode shortcode-tag"><a href="/ru/tags/freebsd/" target="_blank">#FreeBSD</a></span>. Система обладает своими особенностями, но кто работает в <span class="shortcode shortcode-tag"><a href="/ru/tags/linux/" target="_blank">#Linux</a></span>, тот легко разберётся в FreeBSD.</p>
<h2 id="обновление-системы">
  <a class="link-body-emphasis" href="#%d0%be%d0%b1%d0%bd%d0%be%d0%b2%d0%bb%d0%b5%d0%bd%d0%b8%d0%b5-%d1%81%d0%b8%d1%81%d1%82%d0%b5%d0%bc%d1%8b">Обновление системы</a>
</h2><p>После установки базовой системы, рекомендуется запустить обновление.</p>
<ol>
<li>Запросить и применить обновления:</li>
</ol>



<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-2 ">
  <div class="d-flex overflow-hidden">
    <div class="flex-grow-1 rounded overflow-hidden" id="cp-3921412336271671b9968856cd44688d">
      
      <pre><code >freebsd-update fetch &amp;&amp; freebsd-update install</code></pre>
    </div>
    <div class="flex-shrink-0">
      <ul class="list-inline mb-0">
        <li class="list-inline-item" data-bs-tooltip data-bs-title='Копировать'>
          <a class="text-body" href="#"
             data-fn="clipboard preventDefault" data-clipboard-target="#cp-3921412336271671b9968856cd44688d"
             role="button" aria-label='Копировать'>
            <i class="fas fa-copy fa-fw"></i>
          </a>
        </li>
      </ul>
    </div>
  </div>
</div>

<h2 id="обновление-пакетов">
  <a class="link-body-emphasis" href="#%d0%be%d0%b1%d0%bd%d0%be%d0%b2%d0%bb%d0%b5%d0%bd%d0%b8%d0%b5-%d0%bf%d0%b0%d0%ba%d0%b5%d1%82%d0%be%d0%b2">Обновление пакетов</a>
</h2><ol>
<li>Запросить и применить обновления пакетов:</li>
</ol>



<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-3 ">
  <div class="d-flex overflow-hidden">
    <div class="flex-grow-1 rounded overflow-hidden" id="cp-b9ab3c0a7e3420dc67a1177af48b64c8">
      
      <pre><code >pkg update -f &amp;&amp; pkg upgrade</code></pre>
    </div>
    <div class="flex-shrink-0">
      <ul class="list-inline mb-0">
        <li class="list-inline-item" data-bs-tooltip data-bs-title='Копировать'>
          <a class="text-body" href="#"
             data-fn="clipboard preventDefault" data-clipboard-target="#cp-b9ab3c0a7e3420dc67a1177af48b64c8"
             role="button" aria-label='Копировать'>
            <i class="fas fa-copy fa-fw"></i>
          </a>
        </li>
      </ul>
    </div>
  </div>
</div>

<h2 id="переключение-ветки-пакетов">
  <a class="link-body-emphasis" href="#%d0%bf%d0%b5%d1%80%d0%b5%d0%ba%d0%bb%d1%8e%d1%87%d0%b5%d0%bd%d0%b8%d0%b5-%d0%b2%d0%b5%d1%82%d0%ba%d0%b8-%d0%bf%d0%b0%d0%ba%d0%b5%d1%82%d0%be%d0%b2">Переключение ветки пакетов</a>
</h2><p>По умолчанию, <span class="shortcode shortcode-tag"><a href="/ru/tags/freebsd/" target="_blank">#FreeBSD</a></span> берёт обновления пакетов из квартальной (<code>quarterly</code>) ветки. Если хочется получить свежие пакеты здесь и сейчас, то нужно переключить ветку на <code>latest</code>.</p>
<ol>
<li>Создать файл <code>/usr/local/etc/pkg/repos/FreeBSD.conf</code>:</li>
</ol>



<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-5 ">
  <div class="d-flex overflow-hidden">
    <div class="flex-grow-1 rounded overflow-hidden" id="cp-7cc7959ac0d388e6aecd2331334ce4ac">
      
      <pre><code >mkdir -p /usr/local/etc/pkg/repos &amp;&amp; echo &#39;FreeBSD: { url: &#34;pkg&#43;http://pkg.FreeBSD.org/${ABI}/latest&#34; }&#39; &gt; /usr/local/etc/pkg/repos/FreeBSD.conf</code></pre>
    </div>
    <div class="flex-shrink-0">
      <ul class="list-inline mb-0">
        <li class="list-inline-item" data-bs-tooltip data-bs-title='Копировать'>
          <a class="text-body" href="#"
             data-fn="clipboard preventDefault" data-clipboard-target="#cp-7cc7959ac0d388e6aecd2331334ce4ac"
             role="button" aria-label='Копировать'>
            <i class="fas fa-copy fa-fw"></i>
          </a>
        </li>
      </ul>
    </div>
  </div>
</div>

<ol start="2">
<li>Обновить базу данных пакетов и обновить пакеты:</li>
</ol>



<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-6 ">
  <div class="d-flex overflow-hidden">
    <div class="flex-grow-1 rounded overflow-hidden" id="cp-e73c5b2f81921fd15c9b34b723e6f055">
      
      <pre><code >pkg update -f &amp;&amp; pkg upgrade</code></pre>
    </div>
    <div class="flex-shrink-0">
      <ul class="list-inline mb-0">
        <li class="list-inline-item" data-bs-tooltip data-bs-title='Копировать'>
          <a class="text-body" href="#"
             data-fn="clipboard preventDefault" data-clipboard-target="#cp-e73c5b2f81921fd15c9b34b723e6f055"
             role="button" aria-label='Копировать'>
            <i class="fas fa-copy fa-fw"></i>
          </a>
        </li>
      </ul>
    </div>
  </div>
</div>

<h2 id="установка-пакетов">
  <a class="link-body-emphasis" href="#%d1%83%d1%81%d1%82%d0%b0%d0%bd%d0%be%d0%b2%d0%ba%d0%b0-%d0%bf%d0%b0%d0%ba%d0%b5%d1%82%d0%be%d0%b2">Установка пакетов</a>
</h2><p>Для установки пакетов используется пакетный менеджер <code>pkg</code>. В интернете есть информация о том, что не рекомендуется смешивать пакеты и порты. То есть, если вы уже начали использовать пакеты, то надо продолжать только ими пользоваться.</p>
<h3 id="установка-сервиса-обновления-микрокода-cpu">
  <a class="link-body-emphasis" href="#%d1%83%d1%81%d1%82%d0%b0%d0%bd%d0%be%d0%b2%d0%ba%d0%b0-%d1%81%d0%b5%d1%80%d0%b2%d0%b8%d1%81%d0%b0-%d0%be%d0%b1%d0%bd%d0%be%d0%b2%d0%bb%d0%b5%d0%bd%d0%b8%d1%8f-%d0%bc%d0%b8%d0%ba%d1%80%d0%be%d0%ba%d0%be%d0%b4%d0%b0-cpu">Установка сервиса обновления микрокода CPU</a>
</h3><ol>
<li>Установить пакет.</li>
<li>Добавить в <code>rc.conf</code> автозапуск сервиса.</li>
<li>Запустить сервис.</li>
</ol>



<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-7 ">
  <div class="d-flex overflow-hidden">
    <div class="flex-grow-1 rounded overflow-hidden" id="cp-596c7335df0943253093d3757db80d2d">
      
      <pre><code >pkg install cpu-microcode &amp;&amp; sysrc microcode_update_enable=YES &amp;&amp; service microcode_update start</code></pre>
    </div>
    <div class="flex-shrink-0">
      <ul class="list-inline mb-0">
        <li class="list-inline-item" data-bs-tooltip data-bs-title='Копировать'>
          <a class="text-body" href="#"
             data-fn="clipboard preventDefault" data-clipboard-target="#cp-596c7335df0943253093d3757db80d2d"
             role="button" aria-label='Копировать'>
            <i class="fas fa-copy fa-fw"></i>
          </a>
        </li>
      </ul>
    </div>
  </div>
</div>

<h3 id="установка-дополнительных-пакетов">
  <a class="link-body-emphasis" href="#%d1%83%d1%81%d1%82%d0%b0%d0%bd%d0%be%d0%b2%d0%ba%d0%b0-%d0%b4%d0%be%d0%bf%d0%be%d0%bb%d0%bd%d0%b8%d1%82%d0%b5%d0%bb%d1%8c%d0%bd%d1%8b%d1%85-%d0%bf%d0%b0%d0%ba%d0%b5%d1%82%d0%be%d0%b2">Установка дополнительных пакетов</a>
</h3><p>Для работы на сервере, я устанавливаю следующие пакеты:</p>



<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-8 ">
  <div class="d-flex overflow-hidden">
    <div class="flex-grow-1 rounded overflow-hidden" id="cp-0bfc29049cc65cfd543405b74de9acee">
      
      <pre><code >pkg install bash ca_root_nss curl git gnupg htop mc nano smartmontools wget zsh</code></pre>
    </div>
    <div class="flex-shrink-0">
      <ul class="list-inline mb-0">
        <li class="list-inline-item" data-bs-tooltip data-bs-title='Копировать'>
          <a class="text-body" href="#"
             data-fn="clipboard preventDefault" data-clipboard-target="#cp-0bfc29049cc65cfd543405b74de9acee"
             role="button" aria-label='Копировать'>
            <i class="fas fa-copy fa-fw"></i>
          </a>
        </li>
      </ul>
    </div>
  </div>
</div>

<h2 id="настройка-ядра">
  <a class="link-body-emphasis" href="#%d0%bd%d0%b0%d1%81%d1%82%d1%80%d0%be%d0%b9%d0%ba%d0%b0-%d1%8f%d0%b4%d1%80%d0%b0">Настройка ядра</a>
</h2><h3 id="увеличение-числа-дескрипторов-файлов">
  <a class="link-body-emphasis" href="#%d1%83%d0%b2%d0%b5%d0%bb%d0%b8%d1%87%d0%b5%d0%bd%d0%b8%d0%b5-%d1%87%d0%b8%d1%81%d0%bb%d0%b0-%d0%b4%d0%b5%d1%81%d0%ba%d1%80%d0%b8%d0%bf%d1%82%d0%be%d1%80%d0%be%d0%b2-%d1%84%d0%b0%d0%b9%d0%bb%d0%be%d0%b2">Увеличение числа дескрипторов файлов</a>
</h3><p>У меня используется синхронизация данных при помощи <span class="shortcode shortcode-tag"><a href="/ru/tags/syncthing/" target="_blank">#Syncthing</a></span>, данных много. Иногда случается ступор из-за лимита на дескрипторы файлов. Открываем <code>/etc/sysctl.conf</code>, добавляем:</p>



<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-10 shortcode-codeblock-ini">
  <div class="d-flex overflow-hidden">
    <div class="flex-grow-1 rounded overflow-hidden" id="cp-93b61eae70afa1138a7a2676ac376abc">
      
      <pre><code class='language-ini'>kern.maxfiles=500000
kern.maxfilesperproc=500000</code></pre>
    </div>
    <div class="flex-shrink-0">
      <ul class="list-inline mb-0">
        <li class="list-inline-item" data-bs-tooltip data-bs-title='Копировать'>
          <a class="text-body" href="#"
             data-fn="clipboard preventDefault" data-clipboard-target="#cp-93b61eae70afa1138a7a2676ac376abc"
             role="button" aria-label='Копировать'>
            <i class="fas fa-copy fa-fw"></i>
          </a>
        </li>
      </ul>
    </div>
  </div>
</div>

<p>Перезагружаем систему:</p>



<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-11 ">
  <div class="d-flex overflow-hidden">
    <div class="flex-grow-1 rounded overflow-hidden" id="cp-2cf133b1c759c9f65f379956393dd9c0">
      
      <pre><code >shutdown -r now</code></pre>
    </div>
    <div class="flex-shrink-0">
      <ul class="list-inline mb-0">
        <li class="list-inline-item" data-bs-tooltip data-bs-title='Копировать'>
          <a class="text-body" href="#"
             data-fn="clipboard preventDefault" data-clipboard-target="#cp-2cf133b1c759c9f65f379956393dd9c0"
             role="button" aria-label='Копировать'>
            <i class="fas fa-copy fa-fw"></i>
          </a>
        </li>
      </ul>
    </div>
  </div>
</div>

<h2 id="настройка-терминала">
  <a class="link-body-emphasis" href="#%d0%bd%d0%b0%d1%81%d1%82%d1%80%d0%be%d0%b9%d0%ba%d0%b0-%d1%82%d0%b5%d1%80%d0%bc%d0%b8%d0%bd%d0%b0%d0%bb%d0%b0">Настройка терминала</a>
</h2><p>В своей работе я предпочитаю <span class="shortcode shortcode-tag"><a href="/ru/tags/zsh/" target="_blank">#Zsh</a></span>.</p>
<h3 id="установка-zsh-для-пользователей">
  <a class="link-body-emphasis" href="#%d1%83%d1%81%d1%82%d0%b0%d0%bd%d0%be%d0%b2%d0%ba%d0%b0-zsh-%d0%b4%d0%bb%d1%8f-%d0%bf%d0%be%d0%bb%d1%8c%d0%b7%d0%be%d0%b2%d0%b0%d1%82%d0%b5%d0%bb%d0%b5%d0%b9">Установка Zsh для пользователей</a>
</h3><ol>
<li>Изменить стандартную оболочку на <span class="shortcode shortcode-tag"><a href="/ru/tags/zsh/" target="_blank">#Zsh</a></span> для <strong>root</strong>:</li>
</ol>



<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-14 ">
  <div class="d-flex overflow-hidden">
    <div class="flex-grow-1 rounded overflow-hidden" id="cp-e2eee6258cb2bdf806a536c64e03aea8">
      
      <pre><code >chsh -s zsh root</code></pre>
    </div>
    <div class="flex-shrink-0">
      <ul class="list-inline mb-0">
        <li class="list-inline-item" data-bs-tooltip data-bs-title='Копировать'>
          <a class="text-body" href="#"
             data-fn="clipboard preventDefault" data-clipboard-target="#cp-e2eee6258cb2bdf806a536c64e03aea8"
             role="button" aria-label='Копировать'>
            <i class="fas fa-copy fa-fw"></i>
          </a>
        </li>
      </ul>
    </div>
  </div>
</div>

<ol start="2">
<li>Изменить стандартную оболочку на <span class="shortcode shortcode-tag"><a href="/ru/tags/zsh/" target="_blank">#Zsh</a></span> для <strong>обычного пользователя</strong>:</li>
</ol>



<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-16 ">
  <div class="d-flex overflow-hidden">
    <div class="flex-grow-1 rounded overflow-hidden" id="cp-e525d8fe2cbbf000790328212808fa8e">
      
      <pre><code >chsh -s zsh user</code></pre>
    </div>
    <div class="flex-shrink-0">
      <ul class="list-inline mb-0">
        <li class="list-inline-item" data-bs-tooltip data-bs-title='Копировать'>
          <a class="text-body" href="#"
             data-fn="clipboard preventDefault" data-clipboard-target="#cp-e525d8fe2cbbf000790328212808fa8e"
             role="button" aria-label='Копировать'>
            <i class="fas fa-copy fa-fw"></i>
          </a>
        </li>
      </ul>
    </div>
  </div>
</div>

<p>Где:</p>
<ul>
<li><code>user</code> - логин пользователя.</li>
</ul>
<h3 id="конфигурация-zsh">
  <a class="link-body-emphasis" href="#%d0%ba%d0%be%d0%bd%d1%84%d0%b8%d0%b3%d1%83%d1%80%d0%b0%d1%86%d0%b8%d1%8f-zsh">Конфигурация Zsh</a>
</h3><p>Использую конфигурацию от <span class="shortcode shortcode-tag">GRML</span>.</p>
<ol>
<li>Скачиваем конфигурацию:</li>
</ol>



<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-18 ">
  <div class="d-flex overflow-hidden">
    <div class="flex-grow-1 rounded overflow-hidden" id="cp-b635d4e8f38653193852dbf96a370b7e">
      
      <pre><code >wget -O ~/.zshrc.grml https://git.grml.org/f/grml-etc-core/etc/zsh/zshrc</code></pre>
    </div>
    <div class="flex-shrink-0">
      <ul class="list-inline mb-0">
        <li class="list-inline-item" data-bs-tooltip data-bs-title='Копировать'>
          <a class="text-body" href="#"
             data-fn="clipboard preventDefault" data-clipboard-target="#cp-b635d4e8f38653193852dbf96a370b7e"
             role="button" aria-label='Копировать'>
            <i class="fas fa-copy fa-fw"></i>
          </a>
        </li>
      </ul>
    </div>
  </div>
</div>

<ol start="2">
<li>Открываем файл <code>~/.zshrc</code> и добавляем следующие строки:</li>
</ol>



<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-19 shortcode-codeblock-bash">
  <div class="d-flex overflow-hidden">
    <div class="flex-grow-1 rounded overflow-hidden" id="cp-e2775addfa331d0ae55485085eb27a7e">
      
      <pre><code class='language-bash'>. &#34;${HOME}/.zshrc.grml&#34;
export GPG_TTY=$(tty)</code></pre>
    </div>
    <div class="flex-shrink-0">
      <ul class="list-inline mb-0">
        <li class="list-inline-item" data-bs-tooltip data-bs-title='Копировать'>
          <a class="text-body" href="#"
             data-fn="clipboard preventDefault" data-clipboard-target="#cp-e2775addfa331d0ae55485085eb27a7e"
             role="button" aria-label='Копировать'>
            <i class="fas fa-copy fa-fw"></i>
          </a>
        </li>
      </ul>
    </div>
  </div>
</div>

<p>Я работаю на ОС Windows и к серверам подключаюсь через <span class="shortcode shortcode-tag"><a href="/ru/tags/kitty/" target="_blank">#KiTTY</a></span>. При работе с <span class="shortcode shortcode-tag"><a href="/ru/tags/gpg/" target="_blank">#GPG</a></span>, она иногда не понимает куда ей выбрасывать запрос на парольную фразу. Поэтому, у меня здесь добавлен фикс <code>export GPG_TTY=$(tty)</code>.</p>
<h2 id="настройка-файловой-системы">
  <a class="link-body-emphasis" href="#%d0%bd%d0%b0%d1%81%d1%82%d1%80%d0%be%d0%b9%d0%ba%d0%b0-%d1%84%d0%b0%d0%b9%d0%bb%d0%be%d0%b2%d0%be%d0%b9-%d1%81%d0%b8%d1%81%d1%82%d0%b5%d0%bc%d1%8b">Настройка файловой системы</a>
</h2><h3 id="отключение-atime">
  <a class="link-body-emphasis" href="#%d0%be%d1%82%d0%ba%d0%bb%d1%8e%d1%87%d0%b5%d0%bd%d0%b8%d0%b5-atime">Отключение <code>atime</code></a>
</h3><p><code>atime</code> это время доступа к файлу. В обычной работе такая метрика бесполезна. На диск могут быть тысячи файлов и для каждого файла ядро ОС будет фиксировать и обновлять время доступа. Подобная операция весьма дорогая.</p>



<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-22 ">
  <div class="d-flex overflow-hidden">
    <div class="flex-grow-1 rounded overflow-hidden" id="cp-e790775a08354f36ff02a0a7626544ae">
      
      <pre><code >zfs set atime=off zroot</code></pre>
    </div>
    <div class="flex-shrink-0">
      <ul class="list-inline mb-0">
        <li class="list-inline-item" data-bs-tooltip data-bs-title='Копировать'>
          <a class="text-body" href="#"
             data-fn="clipboard preventDefault" data-clipboard-target="#cp-e790775a08354f36ff02a0a7626544ae"
             role="button" aria-label='Копировать'>
            <i class="fas fa-copy fa-fw"></i>
          </a>
        </li>
      </ul>
    </div>
  </div>
</div>

<p>Где:</p>
<ul>
<li><code>zroot</code> - пул файловой системы <span class="shortcode shortcode-tag"><a href="/ru/tags/zfs/" target="_blank">#ZFS</a></span>.</li>
</ul>]]></turbo:content></item><item turbo="true"><title>MikroTik: Настройка DoH</title><link>https://lib.onl/ru/articles/2023/12/b6c7c5cd-1b0d-5fcd-8dd2-f28f87a5064c/</link><pubDate>Wed, 27 Dec 2023 08:07:16 +0000</pubDate><dc:creator>Kai Kimera</dc:creator><category>Сеть</category><category>Безопасность</category><yandex:related><link url="https://lib.onl/ru/articles/2023/10/cc13623b-970c-5950-867e-168f9ba9025a/">MikroTik: Добавление корневых сертификатов в RouterOS</link><link url="https://lib.onl/ru/articles/2020/07/ff2ae66e-8e14-5c4a-baa6-0cd2e59f6517/">MikroTik и CloudFlare: Динамический IP для домена</link></yandex:related><turbo:extendedHtml>true</turbo:extendedHtml><turbo:source>https://lib.onl/ru/articles/2023/12/b6c7c5cd-1b0d-5fcd-8dd2-f28f87a5064c/</turbo:source><turbo:topic>MikroTik: Настройка DoH</turbo:topic><turbo:content><![CDATA[<p>Небольшая заметка по настройке DNS over HTTPS (<span class="shortcode shortcode-tag"><a href="/ru/tags/doh/" target="_blank">#DoH</a></span>) на <span class="shortcode shortcode-tag"><a href="/ru/tags/mikrotik/" target="_blank">#MikroTik</a></span>.</p>
<h2 id="установка-набора-сертификатов">
  <a class="link-body-emphasis" href="#%d1%83%d1%81%d1%82%d0%b0%d0%bd%d0%be%d0%b2%d0%ba%d0%b0-%d0%bd%d0%b0%d0%b1%d0%be%d1%80%d0%b0-%d1%81%d0%b5%d1%80%d1%82%d0%b8%d1%84%d0%b8%d0%ba%d0%b0%d1%82%d0%be%d0%b2">Установка набора сертификатов</a>
</h2><p>Для работы DoH необходимо наличие сертификатов в базе MikroTik. Пакет сертификатов я беру с сайта <code>curl.se</code>:</p>



<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-2 ">
  <div class="d-flex overflow-hidden">
    <div class="flex-grow-1 rounded overflow-hidden" id="cp-5518556aa925f8f43cc7f303f18d667a">
      
      <pre><code >/tool fetch url=&#34;https://curl.se/ca/cacert.pem&#34; dst-path=&#34;ros.cacert.pem&#34;; /certificate import file-name=&#34;ros.cacert.pem&#34; passphrase=&#34;&#34; name=&#34;ROS&#34;</code></pre>
    </div>
    <div class="flex-shrink-0">
      <ul class="list-inline mb-0">
        <li class="list-inline-item" data-bs-tooltip data-bs-title='Копировать'>
          <a class="text-body" href="#"
             data-fn="clipboard preventDefault" data-clipboard-target="#cp-5518556aa925f8f43cc7f303f18d667a"
             role="button" aria-label='Копировать'>
            <i class="fas fa-copy fa-fw"></i>
          </a>
        </li>
      </ul>
    </div>
  </div>
</div>

<h2 id="настройка-doh">
  <a class="link-body-emphasis" href="#%d0%bd%d0%b0%d1%81%d1%82%d1%80%d0%be%d0%b9%d0%ba%d0%b0-doh">Настройка DoH</a>
</h2><p>После установки сертификатов, приступаем к настройке DoH.</p>
<h3 id="стандартные-dns">
  <a class="link-body-emphasis" href="#%d1%81%d1%82%d0%b0%d0%bd%d0%b4%d0%b0%d1%80%d1%82%d0%bd%d1%8b%d0%b5-dns">Стандартные DNS</a>
</h3>


<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-3 ">
  <div class="d-flex overflow-hidden">
    <div class="flex-grow-1 rounded overflow-hidden" id="cp-7e15aa736b512ff74c5192c4c76ee6ac">
      
      <pre><code >/ip dns set allow-remote-requests=yes servers=1.1.1.1,1.0.0.1 use-doh-server=&#34;https://cloudflare-dns.com/dns-query&#34; verify-doh-cert=yes</code></pre>
    </div>
    <div class="flex-shrink-0">
      <ul class="list-inline mb-0">
        <li class="list-inline-item" data-bs-tooltip data-bs-title='Копировать'>
          <a class="text-body" href="#"
             data-fn="clipboard preventDefault" data-clipboard-target="#cp-7e15aa736b512ff74c5192c4c76ee6ac"
             role="button" aria-label='Копировать'>
            <i class="fas fa-copy fa-fw"></i>
          </a>
        </li>
      </ul>
    </div>
  </div>
</div>

<p>В этой команде присутствуют следующие параметры:</p>
<ul>
<li>DNS 01: <code>1.1.1.1</code>.</li>
<li>DNS 02: <code>1.0.0.1</code>.</li>
<li>Сервер DoH: <code>https://cloudflare-dns.com/dns-query</code>.</li>
</ul>
<h3 id="dns-с-блокировкой-вредоносного-по">
  <a class="link-body-emphasis" href="#dns-%d1%81-%d0%b1%d0%bb%d0%be%d0%ba%d0%b8%d1%80%d0%be%d0%b2%d0%ba%d0%be%d0%b9-%d0%b2%d1%80%d0%b5%d0%b4%d0%be%d0%bd%d0%be%d1%81%d0%bd%d0%be%d0%b3%d0%be-%d0%bf%d0%be">DNS с блокировкой вредоносного ПО</a>
</h3>


<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-4 ">
  <div class="d-flex overflow-hidden">
    <div class="flex-grow-1 rounded overflow-hidden" id="cp-e7697e66fb63bbee87030620d95897c6">
      
      <pre><code >/ip dns set allow-remote-requests=yes servers=1.1.1.2,1.0.0.2 use-doh-server=&#34;https://security.cloudflare-dns.com/dns-query&#34; verify-doh-cert=yes</code></pre>
    </div>
    <div class="flex-shrink-0">
      <ul class="list-inline mb-0">
        <li class="list-inline-item" data-bs-tooltip data-bs-title='Копировать'>
          <a class="text-body" href="#"
             data-fn="clipboard preventDefault" data-clipboard-target="#cp-e7697e66fb63bbee87030620d95897c6"
             role="button" aria-label='Копировать'>
            <i class="fas fa-copy fa-fw"></i>
          </a>
        </li>
      </ul>
    </div>
  </div>
</div>

<p>В этой команде присутствуют следующие параметры:</p>
<ul>
<li>DNS 01: <code>1.1.1.2</code>.</li>
<li>DNS 02: <code>1.0.0.2</code>.</li>
<li>Сервер DoH: <code>https://security.cloudflare-dns.com/dns-query</code>.</li>
</ul>
<h3 id="dns-с-блокировкой-вредоносного-по-и-контента-для-взрослых">
  <a class="link-body-emphasis" href="#dns-%d1%81-%d0%b1%d0%bb%d0%be%d0%ba%d0%b8%d1%80%d0%be%d0%b2%d0%ba%d0%be%d0%b9-%d0%b2%d1%80%d0%b5%d0%b4%d0%be%d0%bd%d0%be%d1%81%d0%bd%d0%be%d0%b3%d0%be-%d0%bf%d0%be-%d0%b8-%d0%ba%d0%be%d0%bd%d1%82%d0%b5%d0%bd%d1%82%d0%b0-%d0%b4%d0%bb%d1%8f-%d0%b2%d0%b7%d1%80%d0%be%d1%81%d0%bb%d1%8b%d1%85">DNS с блокировкой вредоносного ПО и контента для взрослых</a>
</h3>


<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-5 ">
  <div class="d-flex overflow-hidden">
    <div class="flex-grow-1 rounded overflow-hidden" id="cp-8a495c38db8f996a8865ed55dd54dcdf">
      
      <pre><code >/ip dns set allow-remote-requests=yes servers=1.1.1.3,1.0.0.3 use-doh-server=&#34;https://family.cloudflare-dns.com/dns-query&#34; verify-doh-cert=yes</code></pre>
    </div>
    <div class="flex-shrink-0">
      <ul class="list-inline mb-0">
        <li class="list-inline-item" data-bs-tooltip data-bs-title='Копировать'>
          <a class="text-body" href="#"
             data-fn="clipboard preventDefault" data-clipboard-target="#cp-8a495c38db8f996a8865ed55dd54dcdf"
             role="button" aria-label='Копировать'>
            <i class="fas fa-copy fa-fw"></i>
          </a>
        </li>
      </ul>
    </div>
  </div>
</div>

<p>В этой команде присутствуют следующие параметры:</p>
<ul>
<li>DNS 01: <code>1.1.1.3</code>.</li>
<li>DNS 02: <code>1.0.0.3</code>.</li>
<li>Сервер DoH: <code>https://family.cloudflare-dns.com/dns-query</code>.</li>
</ul>]]></turbo:content></item><item turbo="true"><title>Переход Debian между релизами</title><link>https://lib.onl/ru/articles/2023/11/4dfa15a8-44f0-5590-a04d-f940dac12aad/</link><pubDate>Sat, 25 Nov 2023 18:31:16 +0000</pubDate><dc:creator>Kai Kimera</dc:creator><category>Linux</category><category>Терминал</category><yandex:related><link url="https://lib.onl/ru/articles/2023/10/6733cb51-62a0-5ed9-b421-8f08c4e0cb18/">Создание сертификатов при помощи OpenSSL</link><link url="https://lib.onl/ru/articles/2023/10/75075788-9308-56b7-b531-2008cb35f7d0/">Установка сертификата НУЦ Минцифры</link><link url="https://lib.onl/ru/articles/2022/01/06ef2fab-2ae2-5356-9154-7ca1e486d27d/">Установка ядра XanMod в Debian</link><link url="https://lib.onl/ru/articles/2022/01/ddddd243-d182-5e26-a161-d2ea7812214a/">Установка Vivaldi в Debian</link><link url="https://lib.onl/ru/articles/2021/09/581804b8-0613-52a8-a5c4-fdae90e7bc8a/">Чёрный экран с курсором при старте GDM</link><link url="https://lib.onl/ru/articles/2021/09/1cf305cd-85d0-5e02-aabb-e01346bfee0f/">Установка Proxmox VE на Debian 11 (Bullseye)</link><link url="https://lib.onl/ru/articles/2021/09/ff829d15-4a19-52e3-a3aa-ad70aa38854a/">Debian: Wired Networks are Unmanaged</link><link url="https://lib.onl/ru/articles/2021/09/b2caccc7-92bf-57ed-970f-136c546f18e2/">Распаковка пакетов DEB / RPM</link><link url="https://lib.onl/ru/articles/2021/09/43b40b92-c29a-504b-87fa-5eac368dcf95/">Отключение установки дополнительных пакетов в Debian APT</link><link url="https://lib.onl/ru/articles/2021/09/aeed7c90-003a-532a-b2c4-3807aaee88fa/">dhclient отправляет 36-значный идентификатор вместо MAC</link><link url="https://lib.onl/ru/articles/2021/08/ca744dce-e607-52e6-9952-8ae04e052a5b/">Скрипт автоматического удаления устаревших файлов</link></yandex:related><turbo:extendedHtml>true</turbo:extendedHtml><turbo:source>https://lib.onl/ru/articles/2023/11/4dfa15a8-44f0-5590-a04d-f940dac12aad/</turbo:source><turbo:topic>Переход Debian между релизами</turbo:topic><turbo:content><![CDATA[<p><span class="shortcode shortcode-tag"><a href="/ru/tags/debian/" target="_blank">#Debian</a></span> позволяет выполнять обновление системы между релизами, и для успешного выполнения этого процесса, необходимо выполнять команды строго в определённом порядке.</p>
<h2 id="обновление-пакетов-в-текущей-системе">
  <a class="link-body-emphasis" href="#%d0%be%d0%b1%d0%bd%d0%be%d0%b2%d0%bb%d0%b5%d0%bd%d0%b8%d0%b5-%d0%bf%d0%b0%d0%ba%d0%b5%d1%82%d0%be%d0%b2-%d0%b2-%d1%82%d0%b5%d0%ba%d1%83%d1%89%d0%b5%d0%b9-%d1%81%d0%b8%d1%81%d1%82%d0%b5%d0%bc%d0%b5">Обновление пакетов в текущей системе</a>
</h2><p>Перед переходом на новый релиз, необходимо обновить все пакеты на текущей системе. Для этого выполняем последовательно ниже приведённые команды.</p>
<ol>
<li>Обновление базы пакетов, пакетов и системы в целом:</li>
</ol>



<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-1 shortcode-codeblock-bash">
  <div class="d-flex overflow-hidden">
    <div class="flex-grow-1 rounded overflow-hidden" id="cp-862a4b309046a7f031202a3d74de54c2">
      
      <pre><code class='language-bash'>apt update &amp;&amp; apt upgrade &amp;&amp; apt full-upgrade</code></pre>
    </div>
    <div class="flex-shrink-0">
      <ul class="list-inline mb-0">
        <li class="list-inline-item" data-bs-tooltip data-bs-title='Копировать'>
          <a class="text-body" href="#"
             data-fn="clipboard preventDefault" data-clipboard-target="#cp-862a4b309046a7f031202a3d74de54c2"
             role="button" aria-label='Копировать'>
            <i class="fas fa-copy fa-fw"></i>
          </a>
        </li>
      </ul>
    </div>
  </div>
</div>

<ol start="2">
<li>Удаление не используемых пакетов:</li>
</ol>



<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-2 shortcode-codeblock-bash">
  <div class="d-flex overflow-hidden">
    <div class="flex-grow-1 rounded overflow-hidden" id="cp-e97edff2e995ad5f8a8ad2304c45b373">
      
      <pre><code class='language-bash'>apt --purge autoremove</code></pre>
    </div>
    <div class="flex-shrink-0">
      <ul class="list-inline mb-0">
        <li class="list-inline-item" data-bs-tooltip data-bs-title='Копировать'>
          <a class="text-body" href="#"
             data-fn="clipboard preventDefault" data-clipboard-target="#cp-e97edff2e995ad5f8a8ad2304c45b373"
             role="button" aria-label='Копировать'>
            <i class="fas fa-copy fa-fw"></i>
          </a>
        </li>
      </ul>
    </div>
  </div>
</div>

<h2 id="обновление-файла-sourceslist">
  <a class="link-body-emphasis" href="#%d0%be%d0%b1%d0%bd%d0%be%d0%b2%d0%bb%d0%b5%d0%bd%d0%b8%d0%b5-%d1%84%d0%b0%d0%b9%d0%bb%d0%b0-sourceslist">Обновление файла <code>sources.list</code></a>
</h2><p>После завершения полного обновления пакетов, нужно перезаписать пути к репозиториям, указав имя нового релиза:</p>



<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-3 shortcode-codeblock-bash">
  <div class="d-flex overflow-hidden">
    <div class="flex-grow-1 rounded overflow-hidden" id="cp-1bdc87f5a41d4ff6ea50adc3a3c8cf81">
      
      <pre><code class='language-bash'>sed -i &#39;s|RELEASE_OLD|RELEASE_NEW|g&#39; &#39;/etc/apt/sources.list&#39;</code></pre>
    </div>
    <div class="flex-shrink-0">
      <ul class="list-inline mb-0">
        <li class="list-inline-item" data-bs-tooltip data-bs-title='Копировать'>
          <a class="text-body" href="#"
             data-fn="clipboard preventDefault" data-clipboard-target="#cp-1bdc87f5a41d4ff6ea50adc3a3c8cf81"
             role="button" aria-label='Копировать'>
            <i class="fas fa-copy fa-fw"></i>
          </a>
        </li>
      </ul>
    </div>
  </div>
</div>

<p>Где:</p>
<ul>
<li><code>RELEASE_OLD</code> - старое имя релиза.</li>
<li><code>RELEASE_NEW</code> - новое имя релиза.</li>
</ul>
<h2 id="обновление-системны-на-новую-версию">
  <a class="link-body-emphasis" href="#%d0%be%d0%b1%d0%bd%d0%be%d0%b2%d0%bb%d0%b5%d0%bd%d0%b8%d0%b5-%d1%81%d0%b8%d1%81%d1%82%d0%b5%d0%bc%d0%bd%d1%8b-%d0%bd%d0%b0-%d0%bd%d0%be%d0%b2%d1%83%d1%8e-%d0%b2%d0%b5%d1%80%d1%81%d0%b8%d1%8e">Обновление системны на новую версию</a>
</h2><p>Теперь пришло время перейти на новый релиз. Выполняем шаги последовательно.</p>
<ol>
<li>Обновление базы пакетов и обновление пакетов в минимальном варианте:</li>
</ol>



<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-4 shortcode-codeblock-bash">
  <div class="d-flex overflow-hidden">
    <div class="flex-grow-1 rounded overflow-hidden" id="cp-4cc1a409ccde3255c1ec71d03eb701f9">
      
      <pre><code class='language-bash'>apt update &amp;&amp; apt upgrade --without-new-pkgs</code></pre>
    </div>
    <div class="flex-shrink-0">
      <ul class="list-inline mb-0">
        <li class="list-inline-item" data-bs-tooltip data-bs-title='Копировать'>
          <a class="text-body" href="#"
             data-fn="clipboard preventDefault" data-clipboard-target="#cp-4cc1a409ccde3255c1ec71d03eb701f9"
             role="button" aria-label='Копировать'>
            <i class="fas fa-copy fa-fw"></i>
          </a>
        </li>
      </ul>
    </div>
  </div>
</div>

<p>На запрос &ldquo;Restart services during package upgrades without asking?&rdquo; отвечаем <span class="shortcode shortcode-btn d-inline-block"><kbd class="bg-primary">Yes</kbd></span>.</p>
<ol start="2">
<li>Обновление всей системы:</li>
</ol>



<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-6 shortcode-codeblock-bash">
  <div class="d-flex overflow-hidden">
    <div class="flex-grow-1 rounded overflow-hidden" id="cp-da06640fe4c0ddf9d463d3962834a74b">
      
      <pre><code class='language-bash'>apt full-upgrade</code></pre>
    </div>
    <div class="flex-shrink-0">
      <ul class="list-inline mb-0">
        <li class="list-inline-item" data-bs-tooltip data-bs-title='Копировать'>
          <a class="text-body" href="#"
             data-fn="clipboard preventDefault" data-clipboard-target="#cp-da06640fe4c0ddf9d463d3962834a74b"
             role="button" aria-label='Копировать'>
            <i class="fas fa-copy fa-fw"></i>
          </a>
        </li>
      </ul>
    </div>
  </div>
</div>

<ol start="3">
<li>Проверка обновлённого релиза:</li>
</ol>



<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-7 shortcode-codeblock-bash">
  <div class="d-flex overflow-hidden">
    <div class="flex-grow-1 rounded overflow-hidden" id="cp-37ea5c521117ae5ea09aae2e67e100cb">
      
      <pre><code class='language-bash'>cat /etc/debian_version</code></pre>
    </div>
    <div class="flex-shrink-0">
      <ul class="list-inline mb-0">
        <li class="list-inline-item" data-bs-tooltip data-bs-title='Копировать'>
          <a class="text-body" href="#"
             data-fn="clipboard preventDefault" data-clipboard-target="#cp-37ea5c521117ae5ea09aae2e67e100cb"
             role="button" aria-label='Копировать'>
            <i class="fas fa-copy fa-fw"></i>
          </a>
        </li>
      </ul>
    </div>
  </div>
</div>]]></turbo:content></item><item turbo="true"><title>Как при помощи AWK разбить строку на поля?</title><link>https://lib.onl/ru/faq/2023/11/632ccab2-18e6-550d-bd8e-0374dc9025f4/</link><pubDate>Sat, 04 Nov 2023 21:54:09 +0000</pubDate><dc:creator>Kai Kimera</dc:creator><category>Bash</category><category>Awk</category><turbo:extendedHtml>true</turbo:extendedHtml><turbo:source>https://lib.onl/ru/faq/2023/11/632ccab2-18e6-550d-bd8e-0374dc9025f4/</turbo:source><turbo:topic>Как при помощи AWK разбить строку на поля?</turbo:topic><turbo:content>&lt;p>Нужно разделить строку в терминале на отдельные поля. Как для этого использовать AWK?&lt;/p></turbo:content></item><item turbo="true"><title>Как переименовать компьютер в PowerShell?</title><link>https://lib.onl/ru/faq/2023/11/e153bb1d-7cea-5bd8-acce-2dbe63b26c91/</link><pubDate>Sat, 04 Nov 2023 06:06:25 +0000</pubDate><dc:creator>Kai Kimera</dc:creator><category>Powershell</category><yandex:related><link url="https://lib.onl/ru/faq/2023/11/8c2e7adc-9431-5bb7-a9b6-e9397b1116b3/">Как переключить PowerShell в кодировку UTF-8?</link><link url="https://lib.onl/ru/faq/2023/10/edf74517-3e6e-5e1c-aa6b-8ee0335670b4/">Многоточие в выводе PowerShell в табличном формате. Как исправить?</link></yandex:related><turbo:extendedHtml>true</turbo:extendedHtml><turbo:source>https://lib.onl/ru/faq/2023/11/e153bb1d-7cea-5bd8-acce-2dbe63b26c91/</turbo:source><turbo:topic>Как переименовать компьютер в PowerShell?</turbo:topic><turbo:content>&lt;p>Хочу переименовать компьютер через терминал PowerShell. Как это сделать?&lt;/p></turbo:content></item><item turbo="true"><title>Как распаковать Intel SetupChipset.exe?</title><link>https://lib.onl/ru/faq/2023/11/4531cb6d-5c3a-5b2d-8a53-6eccd8534dfa/</link><pubDate>Fri, 03 Nov 2023 14:48:08 +0000</pubDate><dc:creator>Kai Kimera</dc:creator><category>Intel</category><category>Chipset</category><category>Driver</category><category>Inf</category><turbo:extendedHtml>true</turbo:extendedHtml><turbo:source>https://lib.onl/ru/faq/2023/11/4531cb6d-5c3a-5b2d-8a53-6eccd8534dfa/</turbo:source><turbo:topic>Как распаковать Intel SetupChipset.exe?</turbo:topic><turbo:content><![CDATA[<p>Нужно интегрировать драйверы чипсета Intel в дистрибутив ОС. Драйверы находятся в файле <code>SetupChipset.exe</code>. Как распаковать файл <code>SetupChipset.exe</code> для того, чтобы забрать драйверы чипсетов?</p>]]></turbo:content></item><item turbo="true"><title>Как переключить PowerShell в кодировку UTF-8?</title><link>https://lib.onl/ru/faq/2023/11/8c2e7adc-9431-5bb7-a9b6-e9397b1116b3/</link><pubDate>Thu, 02 Nov 2023 20:50:36 +0000</pubDate><dc:creator>Kai Kimera</dc:creator><category>Powershell</category><yandex:related><link url="https://lib.onl/ru/faq/2023/10/edf74517-3e6e-5e1c-aa6b-8ee0335670b4/">Многоточие в выводе PowerShell в табличном формате. Как исправить?</link></yandex:related><turbo:extendedHtml>true</turbo:extendedHtml><turbo:source>https://lib.onl/ru/faq/2023/11/8c2e7adc-9431-5bb7-a9b6-e9397b1116b3/</turbo:source><turbo:topic>Как переключить PowerShell в кодировку UTF-8?</turbo:topic><turbo:content>&lt;p>Когда запускаю скрипт на PowerShell, кодировка ломается и вместо текста появляются нечитаемые символы. Это проблем кодировки, как включить поддержку символов UTF-8?&lt;/p></turbo:content></item><item turbo="true"><title>Многоточие в выводе PowerShell в табличном формате. Как исправить?</title><link>https://lib.onl/ru/faq/2023/10/edf74517-3e6e-5e1c-aa6b-8ee0335670b4/</link><pubDate>Tue, 31 Oct 2023 19:52:35 +0000</pubDate><dc:creator>Kai Kimera</dc:creator><category>Powershell</category><turbo:extendedHtml>true</turbo:extendedHtml><turbo:source>https://lib.onl/ru/faq/2023/10/edf74517-3e6e-5e1c-aa6b-8ee0335670b4/</turbo:source><turbo:topic>Многоточие в выводе PowerShell в табличном формате. Как исправить?</turbo:topic><turbo:content><![CDATA[<p>Когда PowerShell выводит информацию в табличном формате, некоторые строки не влезают в ширину столбца и происходит обрезание контента. Как сделать так, чтобы PowerShell подстраивал ширину столбца под размер контента?</p>
<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-0 shortcode-codeblock-terminal
shortcode-codeblock-terminal-windows shortcode-codeblock-terminal-windows-user">
  <div class="card overflow-hidden" data-bs-theme="dark">
    <div class="card-header">
      <div class="d-flex align-items-center">
        <div class="flex-shrink-0 ">
          <i class="fas fa-terminal fa-fw"></i>
        </div>
        <div class="flex-grow-1 mx-2">
          <h5 class="mb-0">Терминал</h5>
        </div>
        <div class="flex-shrink-0">
          <ul class="list-inline mb-0">
            <li class="list-inline-item" data-bs-tooltip data-bs-title='Копировать'>
              <a class="text-body" href="#"
                 data-fn="clipboard preventDefault" data-clipboard-target="#cp-18cedb0484fc71b32b251eb385a6b0c0"
                 role="button" aria-label='Копировать'>
                <i class="fas fa-copy fa-fw"></i>
              </a>
            </li>
          </ul>
        </div>
      </div>
    </div>
    <div class="card-body p-0" id="cp-18cedb0484fc71b32b251eb385a6b0c0">
      <pre><code class="language-plaintext">Get-Service -DisplayName &#39;win*&#39;

Status   Name               DisplayName
------   ----               -----------
Running  AudioEndpointBuil… Windows Audio Endpoint Builder
Running  Audiosrv           Windows Audio
Running  EventLog           Windows Event Log
Running  FontCache          Windows Font Cache Service
Stopped  FrameServer        Windows Camera Frame Server
Stopped  FrameServerMonitor Windows Camera Frame Server Monitor
Stopped  icssvc             Windows Mobile Hotspot Service
Running  LicenseManager     Windows License Manager Service
Stopped  MixedRealityOpenX… Windows Mixed Reality OpenXR Service
Running  mpssvc             Windows Defender Firewall
Stopped  msiserver          Windows Installer
Stopped  perceptionsimulat… Windows Perception Simulation Service
Stopped  PushToInstall      Windows PushToInstall Service
Stopped  SDRSVC             Windows Backup
Running  SecurityHealthSer… Windows Security Service</code></pre>
    </div>
  </div>
</div>]]></turbo:content></item><item turbo="true"><title>Работа с сетевыми интерфейсами в PowerShell</title><link>https://lib.onl/ru/articles/2023/10/430b916d-fd5c-5d44-8c24-8b98f41e0355/</link><pubDate>Tue, 31 Oct 2023 17:16:31 +0000</pubDate><dc:creator>Kai Kimera</dc:creator><category>MS Windows</category><category>Терминал</category><category>Сеть</category><category>Скрипты</category><yandex:related><link url="https://lib.onl/ru/articles/2023/10/1f062637-3227-56d7-93e3-126d1c80f5a8/">Работа с переменной среды окружения PATH</link><link url="https://lib.onl/ru/articles/2023/10/fb64d665-3e56-5fa5-a9eb-2e2e251949d8/">Автоматическая настройка Windows Server 2022 под рабочую станцию</link><link url="https://lib.onl/ru/articles/2023/10/38fc94dd-8d37-5f9e-b556-676304976a9f/">Восстановление доверительных отношений между PC и Active Directory</link><link url="https://lib.onl/ru/articles/2023/10/616da78a-eb16-575a-9119-65f0c0c7baee/">Изменение порта RDP</link><link url="https://lib.onl/ru/articles/2023/10/c6e32349-8fc2-53f9-9a42-790878a64076/">PowerShell: Полезные функции</link><link url="https://lib.onl/ru/articles/2023/10/52d75b90-0637-5ba6-91d6-b1bff40e1d67/">PowerShell: Стирание диска</link><link url="https://lib.onl/ru/articles/2023/10/2a73410a-6611-570c-9ab4-dc8cc8998146/">PowerShell: Сжатие видео при помощи FFmpeg</link><link url="https://lib.onl/ru/articles/2023/10/0028821e-c96c-5014-a1dd-8963c161b170/">PowerShell: Определение разрядности ОС Windows</link><link url="https://lib.onl/ru/articles/2023/10/4c7aba7c-f5a6-589a-9975-fdb16f2e2862/">PowerShell Vault</link><link url="https://lib.onl/ru/articles/2023/10/eb39e3f7-b194-53d4-8bad-01edf9fdac47/">Дефрагментация в ОС Windows</link><link url="https://lib.onl/ru/articles/2023/10/75075788-9308-56b7-b531-2008cb35f7d0/">Установка сертификата НУЦ Минцифры</link><link url="https://lib.onl/ru/articles/2022/05/36058650-3f35-5ed5-9565-0aa7d8800c28/">Windows Server 2022 для рабочей станции</link></yandex:related><turbo:extendedHtml>true</turbo:extendedHtml><turbo:source>https://lib.onl/ru/articles/2023/10/430b916d-fd5c-5d44-8c24-8b98f41e0355/</turbo:source><turbo:topic>Работа с сетевыми интерфейсами в PowerShell</turbo:topic><turbo:content><![CDATA[<p>Разберём основные команды, которые пригодятся нам при настройке сети в ОС <span class="shortcode shortcode-tag"><a href="/ru/categories/windows/" target="_blank">#Windows</a></span> через <span class="shortcode shortcode-tag"><a href="/ru/tags/powershell/" target="_blank">#PowerShell</a></span>.</p>
<h2 id="сетевые-адаптеры">
  <a class="link-body-emphasis" href="#%d1%81%d0%b5%d1%82%d0%b5%d0%b2%d1%8b%d0%b5-%d0%b0%d0%b4%d0%b0%d0%bf%d1%82%d0%b5%d1%80%d1%8b">Сетевые адаптеры</a>
</h2><p>Получить список сетевых адаптеров и их интерфейсов:</p>



<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-2 shortcode-codeblock-powershell">
  <div class="d-flex overflow-hidden">
    <div class="flex-grow-1 rounded overflow-hidden" id="cp-af1f698384d5aff38035af976d5bc1fd">
      
      <pre><code class='language-powershell'>Get-NetAdapter</code></pre>
    </div>
    <div class="flex-shrink-0">
      <ul class="list-inline mb-0">
        <li class="list-inline-item" data-bs-tooltip data-bs-title='Копировать'>
          <a class="text-body" href="#"
             data-fn="clipboard preventDefault" data-clipboard-target="#cp-af1f698384d5aff38035af976d5bc1fd"
             role="button" aria-label='Копировать'>
            <i class="fas fa-copy fa-fw"></i>
          </a>
        </li>
      </ul>
    </div>
  </div>
</div>

<p>Получить список обычных и скрытых сетевых адаптеров:</p>



<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-3 shortcode-codeblock-powershell">
  <div class="d-flex overflow-hidden">
    <div class="flex-grow-1 rounded overflow-hidden" id="cp-d31bd665636d46bc0b723dba828bdcde">
      
      <pre><code class='language-powershell'>Get-NetAdapter –IncludeHidden</code></pre>
    </div>
    <div class="flex-shrink-0">
      <ul class="list-inline mb-0">
        <li class="list-inline-item" data-bs-tooltip data-bs-title='Копировать'>
          <a class="text-body" href="#"
             data-fn="clipboard preventDefault" data-clipboard-target="#cp-d31bd665636d46bc0b723dba828bdcde"
             role="button" aria-label='Копировать'>
            <i class="fas fa-copy fa-fw"></i>
          </a>
        </li>
      </ul>
    </div>
  </div>
</div>

<p>Получить конфигурацию по интерфейсу <code>5</code>:</p>



<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-4 shortcode-codeblock-powershell">
  <div class="d-flex overflow-hidden">
    <div class="flex-grow-1 rounded overflow-hidden" id="cp-650de47e381ec21fd26112cd2538f1e4">
      
      <pre><code class='language-powershell'>Get-NetAdapter -InterfaceIndex 5 | Get-NetIPConfiguration</code></pre>
    </div>
    <div class="flex-shrink-0">
      <ul class="list-inline mb-0">
        <li class="list-inline-item" data-bs-tooltip data-bs-title='Копировать'>
          <a class="text-body" href="#"
             data-fn="clipboard preventDefault" data-clipboard-target="#cp-650de47e381ec21fd26112cd2538f1e4"
             role="button" aria-label='Копировать'>
            <i class="fas fa-copy fa-fw"></i>
          </a>
        </li>
      </ul>
    </div>
  </div>
</div>

<p>Получить детальную конфигурацию по интерфейсу <code>5</code>:</p>



<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-5 shortcode-codeblock-powershell">
  <div class="d-flex overflow-hidden">
    <div class="flex-grow-1 rounded overflow-hidden" id="cp-f385ae865bf8d31ad8cc516a876707d1">
      
      <pre><code class='language-powershell'>Get-NetAdapter -InterfaceIndex 5 | Get-NetIPConfiguration -Detailed</code></pre>
    </div>
    <div class="flex-shrink-0">
      <ul class="list-inline mb-0">
        <li class="list-inline-item" data-bs-tooltip data-bs-title='Копировать'>
          <a class="text-body" href="#"
             data-fn="clipboard preventDefault" data-clipboard-target="#cp-f385ae865bf8d31ad8cc516a876707d1"
             role="button" aria-label='Копировать'>
            <i class="fas fa-copy fa-fw"></i>
          </a>
        </li>
      </ul>
    </div>
  </div>
</div>

<p>Отключить адаптер с интерфейсом <code>5</code>:</p>



<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-6 shortcode-codeblock-powershell">
  <div class="d-flex overflow-hidden">
    <div class="flex-grow-1 rounded overflow-hidden" id="cp-62e20471b71b3fc73d0e77dfdcaf3d24">
      
      <pre><code class='language-powershell'>Get-NetAdapter -InterfaceIndex 5 | Disable-NetAdapter</code></pre>
    </div>
    <div class="flex-shrink-0">
      <ul class="list-inline mb-0">
        <li class="list-inline-item" data-bs-tooltip data-bs-title='Копировать'>
          <a class="text-body" href="#"
             data-fn="clipboard preventDefault" data-clipboard-target="#cp-62e20471b71b3fc73d0e77dfdcaf3d24"
             role="button" aria-label='Копировать'>
            <i class="fas fa-copy fa-fw"></i>
          </a>
        </li>
      </ul>
    </div>
  </div>
</div>

<h2 id="сетевые-профили">
  <a class="link-body-emphasis" href="#%d1%81%d0%b5%d1%82%d0%b5%d0%b2%d1%8b%d0%b5-%d0%bf%d1%80%d0%be%d1%84%d0%b8%d0%bb%d0%b8">Сетевые профили</a>
</h2><p>Вывести информацию по текущим сетевым профилям:</p>



<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-7 shortcode-codeblock-powershell">
  <div class="d-flex overflow-hidden">
    <div class="flex-grow-1 rounded overflow-hidden" id="cp-e2d77e082b29b27a07fef3aded1624e9">
      
      <pre><code class='language-powershell'>Get-NetConnectionProfile</code></pre>
    </div>
    <div class="flex-shrink-0">
      <ul class="list-inline mb-0">
        <li class="list-inline-item" data-bs-tooltip data-bs-title='Копировать'>
          <a class="text-body" href="#"
             data-fn="clipboard preventDefault" data-clipboard-target="#cp-e2d77e082b29b27a07fef3aded1624e9"
             role="button" aria-label='Копировать'>
            <i class="fas fa-copy fa-fw"></i>
          </a>
        </li>
      </ul>
    </div>
  </div>
</div>

<p>Получить информацию только по профилю сети интерфейса <code>5</code>:</p>



<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-8 shortcode-codeblock-powershell">
  <div class="d-flex overflow-hidden">
    <div class="flex-grow-1 rounded overflow-hidden" id="cp-b05404ec6abeb9fc34932b075f182e3e">
      
      <pre><code class='language-powershell'>Get-NetAdapter -InterfaceIndex 5 | Get-NetConnectionProfile</code></pre>
    </div>
    <div class="flex-shrink-0">
      <ul class="list-inline mb-0">
        <li class="list-inline-item" data-bs-tooltip data-bs-title='Копировать'>
          <a class="text-body" href="#"
             data-fn="clipboard preventDefault" data-clipboard-target="#cp-b05404ec6abeb9fc34932b075f182e3e"
             role="button" aria-label='Копировать'>
            <i class="fas fa-copy fa-fw"></i>
          </a>
        </li>
      </ul>
    </div>
  </div>
</div>

<p>Изменить профиль сети интерфейса <code>5</code> на публичный (<code>Public</code>).</p>



<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-9 shortcode-codeblock-powershell">
  <div class="d-flex overflow-hidden">
    <div class="flex-grow-1 rounded overflow-hidden" id="cp-22f85a587e127f4243b9189ba736998b">
      
      <pre><code class='language-powershell'>Get-NetAdapter -InterfaceIndex 5 | Set-NetConnectionProfile -NetworkCategory &#39;Public&#39;</code></pre>
    </div>
    <div class="flex-shrink-0">
      <ul class="list-inline mb-0">
        <li class="list-inline-item" data-bs-tooltip data-bs-title='Копировать'>
          <a class="text-body" href="#"
             data-fn="clipboard preventDefault" data-clipboard-target="#cp-22f85a587e127f4243b9189ba736998b"
             role="button" aria-label='Копировать'>
            <i class="fas fa-copy fa-fw"></i>
          </a>
        </li>
      </ul>
    </div>
  </div>
</div>

<p>Изменить профиль сети интерфейса <code>5</code> на приватный (<code>Private</code>).</p>



<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-10 shortcode-codeblock-powershell">
  <div class="d-flex overflow-hidden">
    <div class="flex-grow-1 rounded overflow-hidden" id="cp-7dc830da53a586b6fd0d6f9e64ccc1c5">
      
      <pre><code class='language-powershell'>Get-NetAdapter -InterfaceIndex 5 | Set-NetConnectionProfile -NetworkCategory &#39;Private&#39;</code></pre>
    </div>
    <div class="flex-shrink-0">
      <ul class="list-inline mb-0">
        <li class="list-inline-item" data-bs-tooltip data-bs-title='Копировать'>
          <a class="text-body" href="#"
             data-fn="clipboard preventDefault" data-clipboard-target="#cp-7dc830da53a586b6fd0d6f9e64ccc1c5"
             role="button" aria-label='Копировать'>
            <i class="fas fa-copy fa-fw"></i>
          </a>
        </li>
      </ul>
    </div>
  </div>
</div>

<p>Изменить профиль сети интерфейса <code>5</code> на доменный (<code>DomainAuthenticated</code>).</p>



<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-11 shortcode-codeblock-powershell">
  <div class="d-flex overflow-hidden">
    <div class="flex-grow-1 rounded overflow-hidden" id="cp-371bc55248a6d7f12ee8b8a598657180">
      
      <pre><code class='language-powershell'>Get-NetAdapter -InterfaceIndex 5 | Set-NetConnectionProfile -NetworkCategory &#39;DomainAuthenticated&#39;</code></pre>
    </div>
    <div class="flex-shrink-0">
      <ul class="list-inline mb-0">
        <li class="list-inline-item" data-bs-tooltip data-bs-title='Копировать'>
          <a class="text-body" href="#"
             data-fn="clipboard preventDefault" data-clipboard-target="#cp-371bc55248a6d7f12ee8b8a598657180"
             role="button" aria-label='Копировать'>
            <i class="fas fa-copy fa-fw"></i>
          </a>
        </li>
      </ul>
    </div>
  </div>
</div>

<h2 id="настройка-ip-адреса">
  <a class="link-body-emphasis" href="#%d0%bd%d0%b0%d1%81%d1%82%d1%80%d0%be%d0%b9%d0%ba%d0%b0-ip-%d0%b0%d0%b4%d1%80%d0%b5%d1%81%d0%b0">Настройка IP-адреса</a>
</h2><p>Отключить DHCP на интерфейсе <code>5</code>:</p>



<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-12 shortcode-codeblock-powershell">
  <div class="d-flex overflow-hidden">
    <div class="flex-grow-1 rounded overflow-hidden" id="cp-98b240b1c0e31c9cfc0cbd42b476405d">
      
      <pre><code class='language-powershell'>Get-NetAdapter -InterfaceIndex 5 | Set-NetIPInterface -Dhcp &#39;Disabled&#39;</code></pre>
    </div>
    <div class="flex-shrink-0">
      <ul class="list-inline mb-0">
        <li class="list-inline-item" data-bs-tooltip data-bs-title='Копировать'>
          <a class="text-body" href="#"
             data-fn="clipboard preventDefault" data-clipboard-target="#cp-98b240b1c0e31c9cfc0cbd42b476405d"
             role="button" aria-label='Копировать'>
            <i class="fas fa-copy fa-fw"></i>
          </a>
        </li>
      </ul>
    </div>
  </div>
</div>

<p>Установить новый IP-адрес и шлюз на интерфейсе <code>5</code>:</p>



<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-13 shortcode-codeblock-powershell">
  <div class="d-flex overflow-hidden">
    <div class="flex-grow-1 rounded overflow-hidden" id="cp-22e1d19661b0a0143c9bc01aa5b3ae93">
      
      <pre><code class='language-powershell'>Get-NetAdapter -InterfaceIndex 5 | New-NetIPAddress –IPAddress &#39;192.168.0.10&#39; -PrefixLength &#39;24&#39; -DefaultGateway &#39;192.168.0.1&#39;</code></pre>
    </div>
    <div class="flex-shrink-0">
      <ul class="list-inline mb-0">
        <li class="list-inline-item" data-bs-tooltip data-bs-title='Копировать'>
          <a class="text-body" href="#"
             data-fn="clipboard preventDefault" data-clipboard-target="#cp-22e1d19661b0a0143c9bc01aa5b3ae93"
             role="button" aria-label='Копировать'>
            <i class="fas fa-copy fa-fw"></i>
          </a>
        </li>
      </ul>
    </div>
  </div>
</div>

<p>Изменить IP-адрес на интерфейсе <code>5</code>:</p>



<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-14 shortcode-codeblock-powershell">
  <div class="d-flex overflow-hidden">
    <div class="flex-grow-1 rounded overflow-hidden" id="cp-8acb36eeab3b9638e1bf127375238262">
      
      <pre><code class='language-powershell'>Get-NetAdapter -InterfaceIndex 5 | Set-NetIPAddress -IPAddress &#39;192.168.0.12&#39;</code></pre>
    </div>
    <div class="flex-shrink-0">
      <ul class="list-inline mb-0">
        <li class="list-inline-item" data-bs-tooltip data-bs-title='Копировать'>
          <a class="text-body" href="#"
             data-fn="clipboard preventDefault" data-clipboard-target="#cp-8acb36eeab3b9638e1bf127375238262"
             role="button" aria-label='Копировать'>
            <i class="fas fa-copy fa-fw"></i>
          </a>
        </li>
      </ul>
    </div>
  </div>
</div>

<p>Удалить IP-адрес на интерфейсе <code>5</code>:</p>



<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-15 shortcode-codeblock-powershell">
  <div class="d-flex overflow-hidden">
    <div class="flex-grow-1 rounded overflow-hidden" id="cp-bc7e5c763c9c7cf188e2e32f53be9620">
      
      <pre><code class='language-powershell'>Get-NetAdapter -InterfaceIndex 5 | Remove-NetIPAddress -Confirm:$false</code></pre>
    </div>
    <div class="flex-shrink-0">
      <ul class="list-inline mb-0">
        <li class="list-inline-item" data-bs-tooltip data-bs-title='Копировать'>
          <a class="text-body" href="#"
             data-fn="clipboard preventDefault" data-clipboard-target="#cp-bc7e5c763c9c7cf188e2e32f53be9620"
             role="button" aria-label='Копировать'>
            <i class="fas fa-copy fa-fw"></i>
          </a>
        </li>
      </ul>
    </div>
  </div>
</div>

<p>Удаление шлюза на интерфейсе <code>5</code>:</p>



<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-16 shortcode-codeblock-powershell">
  <div class="d-flex overflow-hidden">
    <div class="flex-grow-1 rounded overflow-hidden" id="cp-86ef5fa0038f2b148b8fee18ce30af1c">
      
      <pre><code class='language-powershell'>Get-NetAdapter -InterfaceIndex 5 | Remove-NetRoute -Confirm:$false</code></pre>
    </div>
    <div class="flex-shrink-0">
      <ul class="list-inline mb-0">
        <li class="list-inline-item" data-bs-tooltip data-bs-title='Копировать'>
          <a class="text-body" href="#"
             data-fn="clipboard preventDefault" data-clipboard-target="#cp-86ef5fa0038f2b148b8fee18ce30af1c"
             role="button" aria-label='Копировать'>
            <i class="fas fa-copy fa-fw"></i>
          </a>
        </li>
      </ul>
    </div>
  </div>
</div>

<h2 id="настройка-dns">
  <a class="link-body-emphasis" href="#%d0%bd%d0%b0%d1%81%d1%82%d1%80%d0%be%d0%b9%d0%ba%d0%b0-dns">Настройка DNS</a>
</h2><p>Установить IP-адреса серверов <span class="shortcode shortcode-tag"><a href="/ru/tags/dns/" target="_blank">#DNS</a></span> на интерфейсе <code>5</code>:</p>



<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-18 shortcode-codeblock-powershell">
  <div class="d-flex overflow-hidden">
    <div class="flex-grow-1 rounded overflow-hidden" id="cp-7248948449d08b8f9a63a1aaa3787524">
      
      <pre><code class='language-powershell'>Get-NetAdapter -InterfaceIndex 5 | Set-DNSClientServerAddress –ServerAddresses (&#39;192.168.0.2&#39;,&#39;192.168.1.2&#39;)</code></pre>
    </div>
    <div class="flex-shrink-0">
      <ul class="list-inline mb-0">
        <li class="list-inline-item" data-bs-tooltip data-bs-title='Копировать'>
          <a class="text-body" href="#"
             data-fn="clipboard preventDefault" data-clipboard-target="#cp-7248948449d08b8f9a63a1aaa3787524"
             role="button" aria-label='Копировать'>
            <i class="fas fa-copy fa-fw"></i>
          </a>
        </li>
      </ul>
    </div>
  </div>
</div>

<p>Сбросить IP-адреса серверов DNS на параметры по умолчанию на интерфейсе <code>5</code>:</p>



<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-19 shortcode-codeblock-powershell">
  <div class="d-flex overflow-hidden">
    <div class="flex-grow-1 rounded overflow-hidden" id="cp-4dda47db7d2f1409c30cc0bfff7be31c">
      
      <pre><code class='language-powershell'>Get-NetAdapter -InterfaceIndex 5 | Set-DnsClientServerAddress -ResetServerAddresses</code></pre>
    </div>
    <div class="flex-shrink-0">
      <ul class="list-inline mb-0">
        <li class="list-inline-item" data-bs-tooltip data-bs-title='Копировать'>
          <a class="text-body" href="#"
             data-fn="clipboard preventDefault" data-clipboard-target="#cp-4dda47db7d2f1409c30cc0bfff7be31c"
             role="button" aria-label='Копировать'>
            <i class="fas fa-copy fa-fw"></i>
          </a>
        </li>
      </ul>
    </div>
  </div>
</div>

<p>Очистить кэш <span class="shortcode shortcode-tag"><a href="/ru/tags/dns/" target="_blank">#DNS</a></span>:</p>



<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-21 shortcode-codeblock-powershell">
  <div class="d-flex overflow-hidden">
    <div class="flex-grow-1 rounded overflow-hidden" id="cp-35a47f5b6bce9de026e40247cc5f3f53">
      
      <pre><code class='language-powershell'>Clear-DnsClientCache</code></pre>
    </div>
    <div class="flex-shrink-0">
      <ul class="list-inline mb-0">
        <li class="list-inline-item" data-bs-tooltip data-bs-title='Копировать'>
          <a class="text-body" href="#"
             data-fn="clipboard preventDefault" data-clipboard-target="#cp-35a47f5b6bce9de026e40247cc5f3f53"
             role="button" aria-label='Копировать'>
            <i class="fas fa-copy fa-fw"></i>
          </a>
        </li>
      </ul>
    </div>
  </div>
</div>

<h2 id="настройка-dhcp">
  <a class="link-body-emphasis" href="#%d0%bd%d0%b0%d1%81%d1%82%d1%80%d0%be%d0%b9%d0%ba%d0%b0-dhcp">Настройка DHCP</a>
</h2><p>Включить <span class="shortcode shortcode-tag"><a href="/ru/tags/dhcp/" target="_blank">#DHCP</a></span> на интерфейсе <code>5</code>:</p>



<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-23 shortcode-codeblock-powershell">
  <div class="d-flex overflow-hidden">
    <div class="flex-grow-1 rounded overflow-hidden" id="cp-8e6c98aff1509260c3cb804870550d97">
      
      <pre><code class='language-powershell'>Get-NetAdapter -InterfaceIndex 5 | Set-NetIPInterface -Dhcp &#39;Enabled&#39;</code></pre>
    </div>
    <div class="flex-shrink-0">
      <ul class="list-inline mb-0">
        <li class="list-inline-item" data-bs-tooltip data-bs-title='Копировать'>
          <a class="text-body" href="#"
             data-fn="clipboard preventDefault" data-clipboard-target="#cp-8e6c98aff1509260c3cb804870550d97"
             role="button" aria-label='Копировать'>
            <i class="fas fa-copy fa-fw"></i>
          </a>
        </li>
      </ul>
    </div>
  </div>
</div>

<p>Перезапустить интерфейс с именем <code>Ethernet</code> для получения параметров от <span class="shortcode shortcode-tag"><a href="/ru/tags/dhcp/" target="_blank">#DHCP</a></span>:</p>



<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-25 shortcode-codeblock-powershell">
  <div class="d-flex overflow-hidden">
    <div class="flex-grow-1 rounded overflow-hidden" id="cp-be0dd980166e2fa92626b1fe6813d5cb">
      
      <pre><code class='language-powershell'>Get-NetAdapter -InterfaceIndex 5 | Restart-NetAdapter</code></pre>
    </div>
    <div class="flex-shrink-0">
      <ul class="list-inline mb-0">
        <li class="list-inline-item" data-bs-tooltip data-bs-title='Копировать'>
          <a class="text-body" href="#"
             data-fn="clipboard preventDefault" data-clipboard-target="#cp-be0dd980166e2fa92626b1fe6813d5cb"
             role="button" aria-label='Копировать'>
            <i class="fas fa-copy fa-fw"></i>
          </a>
        </li>
      </ul>
    </div>
  </div>
</div>

<h2 id="автоматизация">
  <a class="link-body-emphasis" href="#%d0%b0%d0%b2%d1%82%d0%be%d0%bc%d0%b0%d1%82%d0%b8%d0%b7%d0%b0%d1%86%d0%b8%d1%8f">Автоматизация</a>
</h2><p>Скрипт не имеет вводных параметров. Все параметры настраиваются вручную через редактирование скрипта. Далее, скрипт запускается и применяет указанные параметры.</p>

    

    
        
            
            <div class="shortcode shortcode-file mb-3">
              <div class="card overflow-hidden">
                <div class="card-header">
                  <div class="d-flex align-items-center">
                    <div class="flex-shrink-0">
                      <i class="far fa-file-code fa-fw"></i>
                    </div>
                    <div class="flex-grow-1 mx-2 text-truncate">
                      <code>pwsh.set.ip.ps1</code>
                    </div>
                    <div class="flex-shrink-0">
                      <ul class="list-inline mb-0">
                        <li class="list-inline-item" data-bs-tooltip data-bs-title='Копировать'>
                          <a class="text-body" href="#"
                             data-fn="clipboard preventDefault" data-clipboard-target="#cp-da8fd0a3f07d4cc2782b46276d38b640"
                             role="button" aria-label='Копировать'>
                            <i class="fas fa-copy fa-fw"></i>
                          </a>
                        </li>
                        <li class="list-inline-item" data-bs-tooltip data-bs-title='Скачать'>
                          <a class="text-body" href="/ru/articles/2023/10/430b916d-fd5c-5d44-8c24-8b98f41e0355/pwsh.set.ip.ps1" download
                             role="button" aria-label='Скачать'>
                            <i class="fas fa-download fa-fw"></i>
                          </a>
                        </li>
                        <li class="list-inline-item" data-bs-tooltip data-bs-title='Открыть'>
                          <a class="text-body" href="/ru/articles/2023/10/430b916d-fd5c-5d44-8c24-8b98f41e0355/pwsh.set.ip.ps1" target="_blank"
                             role="button" aria-label='Открыть'>
                            <i class="fas fa-arrow-up-right-from-square fa-fw"></i>
                          </a>
                        </li>
                      </ul>
                    </div>
                  </div>
                </div>
                <div class="card-body" id="cp-da8fd0a3f07d4cc2782b46276d38b640">
                    
                        
                    
                  <pre><code class="language-ps1">&lt;#PSScriptInfo
  .VERSION      0.1.0
  .GUID         b42524a4-c0d0-4402-951c-e97aa140698e
  .AUTHOR       Kai Kimera
  .AUTHOREMAIL  mail@kai.kim
  .COMPANYNAME  Library Online
  .COPYRIGHT    2023 Library Online. All rights reserved.
  .LICENSEURI   https://choosealicense.com/licenses/mit/
  .PROJECTURI   https://lib.onl/ru/articles/2023/10/430b916d-fd5c-5d44-8c24-8b98f41e0355/
#&gt;

#Requires -Version 7.2
#Requires -RunAsAdministrator

# -------------------------------------------------------------------------------------------------------------------- #
# CONFIGURATION.
# -------------------------------------------------------------------------------------------------------------------- #

$Adapter = @{
  # Interface index.
  InterfaceIndex = 0
}

$IP = @{
  # IP address.
  IPAddress = &#39;192.168.0.10&#39;
  # Subnet mask.
  PrefixLength = &#39;24&#39;
  # Gateway.
  DefaultGateway = &#39;192.168.0.1&#39;
}

$DNS = @{
  # DNS servers.
  ServerAddresses = (
    &#39;192.168.0.2&#39;,
    &#39;192.168.1.2&#39;
  )
}

# -------------------------------------------------------------------------------------------------------------------- #
# -------------------------------------------------&lt; RUNNING SCRIPT &gt;------------------------------------------------- #
# -------------------------------------------------------------------------------------------------------------------- #

Get-NetAdapter @Adapter | Remove-NetIPAddress -Confirm:$false   # Removing current IP address.
Get-NetAdapter @Adapter | Remove-NetRoute -Confirm:$false       # Removing current gateway.
Get-NetAdapter @Adapter | New-NetIPAddress @IP                  # Setting new IP address.
Get-NetAdapter @Adapter | Set-DNSClientServerAddress @DNS       # Setting new DNS servers.</code></pre>
                </div>
              </div>
            </div>]]></turbo:content></item><item turbo="true"><title>Как при помощи CloudFlare заменить в URL одну директорию на другую?</title><link>https://lib.onl/ru/faq/2023/10/3c4c6709-69a6-54be-9404-e4b7ede6ab90/</link><pubDate>Tue, 31 Oct 2023 06:16:50 +0000</pubDate><dc:creator>Kai Kimera</dc:creator><category>Cloudflare</category><turbo:extendedHtml>true</turbo:extendedHtml><turbo:source>https://lib.onl/ru/faq/2023/10/3c4c6709-69a6-54be-9404-e4b7ede6ab90/</turbo:source><turbo:topic>Как при помощи CloudFlare заменить в URL одну директорию на другую?</turbo:topic><turbo:content><![CDATA[<p>Здравствуйте! Страницы сайта переехали в другой раздел. Было <code>domain.com/[pages]/post_1</code>, стало <code>domain.com/[posts]/post_1</code>. Надо сделать перенаправление. Но как?</p>]]></turbo:content></item><item turbo="true"><title>Работа с правилами CloudFlare</title><link>https://lib.onl/ru/articles/2023/10/e191797e-d558-5017-8ac4-c28c6e0871ff/</link><pubDate>Sun, 29 Oct 2023 06:55:05 +0000</pubDate><dc:creator>Kai Kimera</dc:creator><category>В доработке</category><category>Сеть</category><yandex:related><link url="https://lib.onl/ru/articles/2020/07/ff2ae66e-8e14-5c4a-baa6-0cd2e59f6517/">MikroTik и CloudFlare: Динамический IP для домена</link></yandex:related><turbo:extendedHtml>true</turbo:extendedHtml><turbo:source>https://lib.onl/ru/articles/2023/10/e191797e-d558-5017-8ac4-c28c6e0871ff/</turbo:source><turbo:topic>Работа с правилами CloudFlare</turbo:topic><turbo:content><![CDATA[<p><span class="shortcode shortcode-tag"><a href="/ru/tags/cloudflare/" target="_blank">#CloudFlare</a></span> предоставляет мощный инструмент по работе с различными правилами, зависящими от запросов клиентов. Разберём составление этих правил и приведём несколько примеров.</p>
<h2 id="настройки-правила">
  <a class="link-body-emphasis" href="#%d0%bd%d0%b0%d1%81%d1%82%d1%80%d0%be%d0%b9%d0%ba%d0%b8-%d0%bf%d1%80%d0%b0%d0%b2%d0%b8%d0%bb%d0%b0">Настройки правила</a>
</h2><p>Правила работаю на, так называемом, <a title="" href="https://developers.cloudflare.com/ruleset-engine/" target="_blank" rel="noopener noreferrer">Cloudflare Ruleset Engine</a> и позволяют максимально гибко себя конфигурировать при помощи специальных полей, условий и переменных.</p>
<p>Каждое правило состоит из двух этапов:</p>
<ol>
<li>If&hellip; - если.</li>
<li>Then&hellip; - тогда.</li>
</ol>
<p>Рассмотрим всё это дело подробнее&hellip;</p>
<h3 id="if">
  <a class="link-body-emphasis" href="#if">If&hellip;</a>
</h3><p>Этап &ldquo;Если&rdquo; означает условие, по которому будут фильтроваться клиенты. Этап состоит из поля, оператора сравнения и значения, которое будет участвовать в составленном условии.</p>
<h4 id="поля">
  <a class="link-body-emphasis" href="#%d0%bf%d0%be%d0%bb%d1%8f">Поля</a>
</h4><p>Поля это переменные, значения которых вычисляются из запроса, инициируемого клиентом. Ниже приведён частичный список полей, которые доступны из графического интерфейса. Полный список полей находится в <a title="" href="https://developers.cloudflare.com/ruleset-engine/rules-language/fields/" target="_blank" rel="noopener noreferrer">документации CloudFlare</a>.</p>
<ul>
<li>AS Num <code>ip.src.asnum</code>.<br>
16- или 32-разрядное целое число, представляющее номер автономной системы (AS), связанной с IP-адресом клиента. Это поле эквивалентно устаревшему <code>ip.geoip.asnum</code>.</li>
<li>Cookie <code>http.cookie</code>.<br>
Файл cookie в строке. Пример: <code>session=8521F670545D7865F79C3D7BEDC29CCE;-background=light</code>.</li>
<li>Country <code>ip.src.country</code>.<br>
Двухбуквенный код страны в формате ISO 3166-1 Alpha 2. Пример: GB. Это поле эквивалентно устаревшему <code>ip.geoip.country</code>.</li>
<li>Continent <code>ip.src.continent</code>.<br>
Код континента, связанный с IP-адресом клиента. Это поле эквивалентно устаревшему <code>ip.geoip.continent</code>.
<ul>
<li><code>AF</code> - Africa.</li>
<li><code>AN</code> - Antarctica.</li>
<li><code>AS</code> - Asia.</li>
<li><code>EU</code> - Europe.</li>
<li><code>NA</code> - North America.</li>
<li><code>OC</code> - Oceania.</li>
<li><code>SA</code> - South America.</li>
<li><code>T1</code> - Tor network.</li>
</ul>
</li>
<li>Hostname <code>http.host</code>.<br>
Имя хоста. Пример: <code>www.example.org</code>.</li>
<li>IP Source Address <code>ip.src</code>.<br>
IP-адрес клиента. Пример: <code>93.184.216.34</code>.</li>
<li>Referer <code>http.referer</code>.<br>
Заголовок запроса HTTP Referer, который содержит адрес веб-страницы, с которой пришёл запрос. Пример: <code>Referer: htt­ps://developer.example.org/en-US/docs/Web/JavaScript</code>.</li>
<li>Request Method <code>http.request.method</code>.<br>
Метод HTTP-запроса. Пример: <code>GET</code>.</li>
<li>SSL/HTTPS <code>ssl</code>.<br>
Возвращает <code>true</code>, когда используется зашифрованное соединение с клиентом.</li>
<li>URI Full <code>http.request.full_uri</code>.<br>
Весь URI, полученный сервером. Пример: <code>htt­ps://www.example.org/articles/index?section=539061&amp;expand=comments</code>.</li>
<li>URI <code>http.request.uri</code>.<br>
Путь URI и строка запроса. Пример: <code>/articles/index?section=539061&amp;expand=comments</code>.</li>
<li>URI Path <code>http.request.uri.path</code>.<br>
Путь URI. Пример: <code>/articles/index</code>.</li>
<li>URI Query String <code>http.request.uri.query</code>.<br>
Строка запроса без разделителя <code>?</code>. Пример: <code>section=539061&amp;expand=comments</code>.</li>
<li>HTTP Version <code>http.request.version</code>.<br>
Версия используемого протокола HTTP. Пример: <code>HTTP/1.1</code> или <code>HTTP/3</code>.</li>
<li>User Agent <code>http.user_agent</code>.<br>
User Agent клиента, строка, позволяющая идентифицировать клиентскую операционную систему и веб-браузер. Пример: <code>Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/65.0.3325.181 Safari/537.36</code>.</li>
<li>X-Forward-For <code>http.x_forwarded_for</code>.<br>
Заголовок X-Forwarded-For. Пример: <code>203.0.113.195, 70.41.3.18</code>.</li>
<li>Client Certificate Verified <code>cf.tls_client_auth.cert_verified</code>.<br>
Возвращает <code>true</code>, когда запрос предоставляет действительный сертификат клиента.</li>
</ul>
<h4 id="операторы">
  <a class="link-body-emphasis" href="#%d0%be%d0%bf%d0%b5%d1%80%d0%b0%d1%82%d0%be%d1%80%d1%8b">Операторы</a>
</h4><p>Операторы сравнения возвращают true, когда значение запроса клиента совпадает со значением в выражении. Подробнее в <a title="" href="https://developers.cloudflare.com/ruleset-engine/rules-language/operators/" target="_blank" rel="noopener noreferrer">документации</a>.</p>
<ul>
<li>equals <code>eq</code> - равно.</li>
<li>does not equal <code>ne</code> -  не равно.</li>
<li>greater than <code>gt</code> - больше чем.</li>
<li>less than <code>lt</code> - меньше чем.</li>
<li>greater than or equal to <code>ge</code> - больше или равно.</li>
<li>less than or equal to <code>le</code> - меньше или равно.</li>
<li>is in <code>in {}</code> - значение находится в массиве.</li>
<li>is not in <code>not &lt;field&gt; in {}</code> - значение не находится в массиве.</li>
</ul>
<h3 id="then">
  <a class="link-body-emphasis" href="#then">Then&hellip;</a>
</h3><p>Этап &ldquo;Тогда&rdquo; подразумевает под собой действие, которое будет применено к отфильтрованному клиенту.</p>
<h4 id="тип-поля-url">
  <a class="link-body-emphasis" href="#%d1%82%d0%b8%d0%bf-%d0%bf%d0%be%d0%bb%d1%8f-url">Тип поля URL</a>
</h4><ul>
<li>Dynamic - в поле URL содержит динамические параметры (переменные полей) и их необходимо вычислять и обрабатывать.</li>
<li>Static - в поле URL содержится обычные статические параметры.</li>
</ul>
<h4 id="коды-статуса">
  <a class="link-body-emphasis" href="#%d0%ba%d0%be%d0%b4%d1%8b-%d1%81%d1%82%d0%b0%d1%82%d1%83%d1%81%d0%b0">Коды статуса</a>
</h4><ul>
<li>301 (Moved Permanently).<br>
Запрошенный ресурс был окончательно перемещён в URL, указанный в заголовке <code>Location</code>. Браузер в случае такого ответа перенаправляется на эту страницу, а поисковые системы обновляют свои ссылки на ресурс (говоря языком SEO, вес страницы переносится на новый URL-адрес).</li>
<li>302 (Moved Temporarily).<br>
Запрошенный ресурс был временно перемещён по адресу, указанному в заголовке <code>Location</code>. Получив такой ответ браузер перенаправляется на новую страницу, но поисковые системы не обновляют свои ссылки на ресурс (в жаргоне SEO говорят, что вес ссылки (link-juice) не меняется и не отправляется на новый URL-адрес).</li>
<li>303 (See Other).<br>
Перенаправление производится не на новый (только что загруженный) ресурс, а на другую страницу, например, страницу подтверждения или страницу с результатами загрузки.</li>
<li>307 (Temporary Redirect).<br>
Запрошенный ресурс был временно перемещён в URL-адрес, указанный в заголовке <code>Location</code>. Единственное различие между 307 и 302 состоит в том, что 307 гарантирует, что метод и тело не будут изменены при выполнении перенаправленного запроса. В случае с кодом 302 некоторые старые клиенты неправильно меняли метод на <code>GET</code>, из-за чего поведение запросов с методом отличным от <code>GET</code> и ответа с кодом 302 непредсказуемо, тогда как поведение в случае ответа с кодом 307 предсказуемо. Для запросов <code>GET</code> поведение идентично.</li>
<li>308 (Permanent Redirect).<br>
Запрошенный ресурс был окончательно перемещён в URL-адрес, указанный в <code>Location</code>. Браузер перенаправляется на эту страницу, а поисковые системы обновляют свои ссылки на ресурс (в SEO-speak говорится, что link-juice отправляется на новый URL-адрес). Метод запроса и тело не будут изменены, тогда как 301 иногда может быть неправильно заменён на <code>GET</code> метод.</li>
</ul>
<p>В примерах я буду приводить шаблон, который вписывается в редактор выражения. Поэтому, можно не щёлкать по удобным кнопочкам, а сразу нажимать <span class="shortcode shortcode-btn d-inline-block"><kbd class="bg-primary">Edit expression</kbd></span> и вписывать нужный шаблон.</p>
<h2 id="переадресация">
  <a class="link-body-emphasis" href="#%d0%bf%d0%b5%d1%80%d0%b5%d0%b0%d0%b4%d1%80%d0%b5%d1%81%d0%b0%d1%86%d0%b8%d1%8f">Переадресация</a>
</h2><p>Самый часто используемый тип правил, это правила по работе с переадресацией. Привожу несколько примеров. Их можно брать готовыми и вставлять в редактор выражения, не забыв отредактировать под себя некоторые входные параметры, например, название домена или адрес куда переадресовывать клиентов.</p>
<h3 id="примеры">
  <a class="link-body-emphasis" href="#%d0%bf%d1%80%d0%b8%d0%bc%d0%b5%d1%80%d1%8b">Примеры</a>
</h3><p>Ниже я привёл примеры, которые позволяют реализовать наиболее популярные правила переадресации запросов.</p>
<h4 id="пути">
  <a class="link-body-emphasis" href="#%d0%bf%d1%83%d1%82%d0%b8">Пути</a>
</h4><p>Переадресация запроса с одного ресурса (или страницы) на другой ресурс (или страницу).</p>


<div class="accordion mb-3 shortcode shortcode-accordion" id="sc-a8ec36334fe29993bc73f5d4b48c1c5e">
    




    
    <div class="accordion-item">
      <div class="accordion-header">
        <a class="accordion-button collapsed" href="#" role="button" tabindex="0"
           data-bs-toggle="collapse" data-bs-target="#sc-95822f4a7533b2df1f6723a45f7f16f7"
           aria-expanded="false" aria-controls="sc-95822f4a7533b2df1f6723a45f7f16f7" aria-label="example.com | www.example.com">
            example.com | www.example.com
        </a>
      </div>
      <div class="accordion-collapse collapse" id="sc-95822f4a7533b2df1f6723a45f7f16f7" data-bs-parent="#sc-a8ec36334fe29993bc73f5d4b48c1c5e">
        <div class="accordion-body">
            <p><code>https://example.com</code> <code>-&gt;</code> <code>https://www.example.com</code></p>
<p><strong>When incoming requests match:</strong></p>
<!-- raw HTML omitted -->
<pre><code>  &lt;pre&gt;&lt;code class='language-lua'&gt;(http.host eq &amp;#34;example.com&amp;#34;)&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;div class=&quot;flex-shrink-0&quot;&gt;
  &lt;ul class=&quot;list-inline mb-0&quot;&gt;
    &lt;li class=&quot;list-inline-item&quot; data-bs-tooltip data-bs-title='Копировать'&gt;
      &lt;a class=&quot;text-body&quot; href=&quot;#&quot;
         data-fn=&quot;clipboard preventDefault&quot; data-clipboard-target=&quot;#cp-c7b0c140186ab6b12706e2fe7a633cbd&quot;
         role=&quot;button&quot; aria-label='Копировать'&gt;
        &lt;i class=&quot;fas fa-copy fa-fw&quot;&gt;&lt;/i&gt;
      &lt;/a&gt;
    &lt;/li&gt;
  &lt;/ul&gt;
&lt;/div&gt;
</code></pre>
<!-- raw HTML omitted -->
<p><strong>Then&hellip;</strong></p>
<ul>
<li>Type: <code>Dynamic</code></li>
<li>Status code: <code>301</code></li>
</ul>
<p><strong>URL:</strong></p>
<!-- raw HTML omitted -->
<pre><code>  &lt;pre&gt;&lt;code class='language-lua'&gt;concat(&amp;#34;https://www.&amp;#34;, http.host, http.request.uri.path)&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;div class=&quot;flex-shrink-0&quot;&gt;
  &lt;ul class=&quot;list-inline mb-0&quot;&gt;
    &lt;li class=&quot;list-inline-item&quot; data-bs-tooltip data-bs-title='Копировать'&gt;
      &lt;a class=&quot;text-body&quot; href=&quot;#&quot;
         data-fn=&quot;clipboard preventDefault&quot; data-clipboard-target=&quot;#cp-30edffbec17b3eb21d129a3de000c2cf&quot;
         role=&quot;button&quot; aria-label='Копировать'&gt;
        &lt;i class=&quot;fas fa-copy fa-fw&quot;&gt;&lt;/i&gt;
      &lt;/a&gt;
    &lt;/li&gt;
  &lt;/ul&gt;
&lt;/div&gt;
</code></pre>
<!-- raw HTML omitted -->

        </div>
      </div>
    </div>






    
    <div class="accordion-item">
      <div class="accordion-header">
        <a class="accordion-button collapsed" href="#" role="button" tabindex="0"
           data-bs-toggle="collapse" data-bs-target="#sc-09a49d2619efec96646ef0b54056eab5"
           aria-expanded="false" aria-controls="sc-09a49d2619efec96646ef0b54056eab5" aria-label="www.example.com | example.com">
            www.example.com | example.com
        </a>
      </div>
      <div class="accordion-collapse collapse" id="sc-09a49d2619efec96646ef0b54056eab5" data-bs-parent="#sc-a8ec36334fe29993bc73f5d4b48c1c5e">
        <div class="accordion-body">
            <p><code>https://www.example.com</code> <code>-&gt;</code> <code>https://example.com</code></p>
<p><strong>When incoming requests match:</strong></p>
<!-- raw HTML omitted -->
<pre><code>  &lt;pre&gt;&lt;code class='language-lua'&gt;(http.host eq &amp;#34;www.example.com&amp;#34;)&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;div class=&quot;flex-shrink-0&quot;&gt;
  &lt;ul class=&quot;list-inline mb-0&quot;&gt;
    &lt;li class=&quot;list-inline-item&quot; data-bs-tooltip data-bs-title='Копировать'&gt;
      &lt;a class=&quot;text-body&quot; href=&quot;#&quot;
         data-fn=&quot;clipboard preventDefault&quot; data-clipboard-target=&quot;#cp-13aff7019ddb9f7963207b52d66a93ba&quot;
         role=&quot;button&quot; aria-label='Копировать'&gt;
        &lt;i class=&quot;fas fa-copy fa-fw&quot;&gt;&lt;/i&gt;
      &lt;/a&gt;
    &lt;/li&gt;
  &lt;/ul&gt;
&lt;/div&gt;
</code></pre>
<!-- raw HTML omitted -->
<p><strong>Then&hellip;</strong></p>
<ul>
<li>Type: <code>Dynamic</code></li>
<li>Status code: <code>301</code></li>
</ul>
<p><strong>URL:</strong></p>
<!-- raw HTML omitted -->
<pre><code>  &lt;pre&gt;&lt;code class='language-lua'&gt;concat(&amp;#34;https://&amp;#34;, http.host, http.request.uri.path)&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;div class=&quot;flex-shrink-0&quot;&gt;
  &lt;ul class=&quot;list-inline mb-0&quot;&gt;
    &lt;li class=&quot;list-inline-item&quot; data-bs-tooltip data-bs-title='Копировать'&gt;
      &lt;a class=&quot;text-body&quot; href=&quot;#&quot;
         data-fn=&quot;clipboard preventDefault&quot; data-clipboard-target=&quot;#cp-a356284c13399a8d24ca25cc599cff9c&quot;
         role=&quot;button&quot; aria-label='Копировать'&gt;
        &lt;i class=&quot;fas fa-copy fa-fw&quot;&gt;&lt;/i&gt;
      &lt;/a&gt;
    &lt;/li&gt;
  &lt;/ul&gt;
&lt;/div&gt;
</code></pre>
<!-- raw HTML omitted -->

        </div>
      </div>
    </div>






    
    <div class="accordion-item">
      <div class="accordion-header">
        <a class="accordion-button collapsed" href="#" role="button" tabindex="0"
           data-bs-toggle="collapse" data-bs-target="#sc-29bddb27679c9d69cc07364970b218d2"
           aria-expanded="false" aria-controls="sc-29bddb27679c9d69cc07364970b218d2" aria-label="example.com/path | example.org/path">
            example.com/path | example.org/path
        </a>
      </div>
      <div class="accordion-collapse collapse" id="sc-29bddb27679c9d69cc07364970b218d2" data-bs-parent="#sc-a8ec36334fe29993bc73f5d4b48c1c5e">
        <div class="accordion-body">
            <p><code>https://example.com/path</code> <code>-&gt;</code> <code>https://example.org/path</code></p>
<p><strong>When incoming requests match:</strong></p>
<!-- raw HTML omitted -->
<pre><code>  &lt;pre&gt;&lt;code class='language-lua'&gt;(http.host eq &amp;#34;example.com&amp;#34;)&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;div class=&quot;flex-shrink-0&quot;&gt;
  &lt;ul class=&quot;list-inline mb-0&quot;&gt;
    &lt;li class=&quot;list-inline-item&quot; data-bs-tooltip data-bs-title='Копировать'&gt;
      &lt;a class=&quot;text-body&quot; href=&quot;#&quot;
         data-fn=&quot;clipboard preventDefault&quot; data-clipboard-target=&quot;#cp-7f3d0f12b7312c8b96e790581283b4ef&quot;
         role=&quot;button&quot; aria-label='Копировать'&gt;
        &lt;i class=&quot;fas fa-copy fa-fw&quot;&gt;&lt;/i&gt;
      &lt;/a&gt;
    &lt;/li&gt;
  &lt;/ul&gt;
&lt;/div&gt;
</code></pre>
<!-- raw HTML omitted -->
<p><strong>Then&hellip;</strong></p>
<ul>
<li>Type: <code>Dynamic</code></li>
<li>Status code: <code>301</code></li>
</ul>
<p><strong>URL:</strong></p>
<!-- raw HTML omitted -->
<pre><code>  &lt;pre&gt;&lt;code class='language-lua'&gt;concat(&amp;#34;https://example.org&amp;#34;, http.request.uri.path)&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;div class=&quot;flex-shrink-0&quot;&gt;
  &lt;ul class=&quot;list-inline mb-0&quot;&gt;
    &lt;li class=&quot;list-inline-item&quot; data-bs-tooltip data-bs-title='Копировать'&gt;
      &lt;a class=&quot;text-body&quot; href=&quot;#&quot;
         data-fn=&quot;clipboard preventDefault&quot; data-clipboard-target=&quot;#cp-e8bdaf6276a9af2e857ef054a7669677&quot;
         role=&quot;button&quot; aria-label='Копировать'&gt;
        &lt;i class=&quot;fas fa-copy fa-fw&quot;&gt;&lt;/i&gt;
      &lt;/a&gt;
    &lt;/li&gt;
  &lt;/ul&gt;
&lt;/div&gt;
</code></pre>
<!-- raw HTML omitted -->

        </div>
      </div>
    </div>






    
    <div class="accordion-item">
      <div class="accordion-header">
        <a class="accordion-button collapsed" href="#" role="button" tabindex="0"
           data-bs-toggle="collapse" data-bs-target="#sc-3df476effc12d1582cbed3257618767e"
           aria-expanded="false" aria-controls="sc-3df476effc12d1582cbed3257618767e" aria-label="example.com | example.org">
            example.com | example.org
        </a>
      </div>
      <div class="accordion-collapse collapse" id="sc-3df476effc12d1582cbed3257618767e" data-bs-parent="#sc-a8ec36334fe29993bc73f5d4b48c1c5e">
        <div class="accordion-body">
            <p><code>https://example.com</code> <code>-&gt;</code> <code>https://example.org</code></p>
<p><strong>When incoming requests match:</strong></p>
<!-- raw HTML omitted -->
<pre><code>  &lt;pre&gt;&lt;code class='language-lua'&gt;(http.host contains &amp;#34;example.com&amp;#34;)&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;div class=&quot;flex-shrink-0&quot;&gt;
  &lt;ul class=&quot;list-inline mb-0&quot;&gt;
    &lt;li class=&quot;list-inline-item&quot; data-bs-tooltip data-bs-title='Копировать'&gt;
      &lt;a class=&quot;text-body&quot; href=&quot;#&quot;
         data-fn=&quot;clipboard preventDefault&quot; data-clipboard-target=&quot;#cp-d01b446152d28ea5109f986c44046b7f&quot;
         role=&quot;button&quot; aria-label='Копировать'&gt;
        &lt;i class=&quot;fas fa-copy fa-fw&quot;&gt;&lt;/i&gt;
      &lt;/a&gt;
    &lt;/li&gt;
  &lt;/ul&gt;
&lt;/div&gt;
</code></pre>
<!-- raw HTML omitted -->
<p><strong>Then&hellip;</strong></p>
<ul>
<li>Type: <code>Static</code></li>
<li>Status code: <code>301</code></li>
</ul>
<p><strong>URL:</strong></p>
<!-- raw HTML omitted -->
<pre><code>  &lt;pre&gt;&lt;code class='language-lua'&gt;https://example.org/&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;div class=&quot;flex-shrink-0&quot;&gt;
  &lt;ul class=&quot;list-inline mb-0&quot;&gt;
    &lt;li class=&quot;list-inline-item&quot; data-bs-tooltip data-bs-title='Копировать'&gt;
      &lt;a class=&quot;text-body&quot; href=&quot;#&quot;
         data-fn=&quot;clipboard preventDefault&quot; data-clipboard-target=&quot;#cp-f3fc626afde212a50655f68dcb378079&quot;
         role=&quot;button&quot; aria-label='Копировать'&gt;
        &lt;i class=&quot;fas fa-copy fa-fw&quot;&gt;&lt;/i&gt;
      &lt;/a&gt;
    &lt;/li&gt;
  &lt;/ul&gt;
&lt;/div&gt;
</code></pre>
<!-- raw HTML omitted -->

        </div>
      </div>
    </div>






    
    <div class="accordion-item">
      <div class="accordion-header">
        <a class="accordion-button collapsed" href="#" role="button" tabindex="0"
           data-bs-toggle="collapse" data-bs-target="#sc-7ec232f078d7f1ba9d3fad63f380c3da"
           aria-expanded="false" aria-controls="sc-7ec232f078d7f1ba9d3fad63f380c3da" aria-label="sub.example.com | example.com/sub">
            sub.example.com | example.com/sub
        </a>
      </div>
      <div class="accordion-collapse collapse" id="sc-7ec232f078d7f1ba9d3fad63f380c3da" data-bs-parent="#sc-a8ec36334fe29993bc73f5d4b48c1c5e">
        <div class="accordion-body">
            <p><code>https://sub.example.com</code> <code>-&gt;</code> <code>https://example.com/sub</code></p>
<p><strong>When incoming requests match:</strong></p>
<!-- raw HTML omitted -->
<pre><code>  &lt;pre&gt;&lt;code class='language-lua'&gt;(http.host eq &amp;#34;sub.example.com&amp;#34;)&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;div class=&quot;flex-shrink-0&quot;&gt;
  &lt;ul class=&quot;list-inline mb-0&quot;&gt;
    &lt;li class=&quot;list-inline-item&quot; data-bs-tooltip data-bs-title='Копировать'&gt;
      &lt;a class=&quot;text-body&quot; href=&quot;#&quot;
         data-fn=&quot;clipboard preventDefault&quot; data-clipboard-target=&quot;#cp-9c5a2a91c93496d5989b5089a626e58d&quot;
         role=&quot;button&quot; aria-label='Копировать'&gt;
        &lt;i class=&quot;fas fa-copy fa-fw&quot;&gt;&lt;/i&gt;
      &lt;/a&gt;
    &lt;/li&gt;
  &lt;/ul&gt;
&lt;/div&gt;
</code></pre>
<!-- raw HTML omitted -->
<p><strong>Then&hellip;</strong></p>
<ul>
<li>Type: <code>Dynamic</code></li>
<li>Status code: <code>301</code></li>
</ul>
<p><strong>URL:</strong></p>
<!-- raw HTML omitted -->
<pre><code>  &lt;pre&gt;&lt;code class='language-lua'&gt;concat(&amp;#34;https://&amp;#34;, http.host, &amp;#34;/sub&amp;#34;, http.request.uri.path)&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;div class=&quot;flex-shrink-0&quot;&gt;
  &lt;ul class=&quot;list-inline mb-0&quot;&gt;
    &lt;li class=&quot;list-inline-item&quot; data-bs-tooltip data-bs-title='Копировать'&gt;
      &lt;a class=&quot;text-body&quot; href=&quot;#&quot;
         data-fn=&quot;clipboard preventDefault&quot; data-clipboard-target=&quot;#cp-0d42cd684f24749e46b046b1fa659779&quot;
         role=&quot;button&quot; aria-label='Копировать'&gt;
        &lt;i class=&quot;fas fa-copy fa-fw&quot;&gt;&lt;/i&gt;
      &lt;/a&gt;
    &lt;/li&gt;
  &lt;/ul&gt;
&lt;/div&gt;
</code></pre>
<!-- raw HTML omitted -->

        </div>
      </div>
    </div>






    
    <div class="accordion-item">
      <div class="accordion-header">
        <a class="accordion-button collapsed" href="#" role="button" tabindex="0"
           data-bs-toggle="collapse" data-bs-target="#sc-ad8b2798a19fc5ba54e48c7ecb30cbf8"
           aria-expanded="false" aria-controls="sc-ad8b2798a19fc5ba54e48c7ecb30cbf8" aria-label="example.com/sub | sub.example.com">
            example.com/sub | sub.example.com
        </a>
      </div>
      <div class="accordion-collapse collapse" id="sc-ad8b2798a19fc5ba54e48c7ecb30cbf8" data-bs-parent="#sc-a8ec36334fe29993bc73f5d4b48c1c5e">
        <div class="accordion-body">
            <p><code>https://example.com/sub</code> <code>-&gt;</code> <code>https://sub.example.com</code></p>
<p><strong>When incoming requests match:</strong></p>
<!-- raw HTML omitted -->
<pre><code>  &lt;pre&gt;&lt;code class='language-lua'&gt;(starts_with(http.request.uri.path, &amp;#34;/sub/&amp;#34;))&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;div class=&quot;flex-shrink-0&quot;&gt;
  &lt;ul class=&quot;list-inline mb-0&quot;&gt;
    &lt;li class=&quot;list-inline-item&quot; data-bs-tooltip data-bs-title='Копировать'&gt;
      &lt;a class=&quot;text-body&quot; href=&quot;#&quot;
         data-fn=&quot;clipboard preventDefault&quot; data-clipboard-target=&quot;#cp-1111a4269900f4eadb7d89272412f4ce&quot;
         role=&quot;button&quot; aria-label='Копировать'&gt;
        &lt;i class=&quot;fas fa-copy fa-fw&quot;&gt;&lt;/i&gt;
      &lt;/a&gt;
    &lt;/li&gt;
  &lt;/ul&gt;
&lt;/div&gt;
</code></pre>
<!-- raw HTML omitted -->
<p><strong>Then&hellip;</strong></p>
<ul>
<li>Type: <code>Dynamic</code></li>
<li>Status code: <code>301</code></li>
</ul>
<p><strong>URL:</strong></p>
<!-- raw HTML omitted -->
<pre><code>  &lt;pre&gt;&lt;code class='language-lua'&gt;concat(&amp;#34;https://sub.&amp;#34;, http.host, substring(http.request.uri.path, 6))&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;div class=&quot;flex-shrink-0&quot;&gt;
  &lt;ul class=&quot;list-inline mb-0&quot;&gt;
    &lt;li class=&quot;list-inline-item&quot; data-bs-tooltip data-bs-title='Копировать'&gt;
      &lt;a class=&quot;text-body&quot; href=&quot;#&quot;
         data-fn=&quot;clipboard preventDefault&quot; data-clipboard-target=&quot;#cp-d700a86b360de9c55a34d6d8edf7e671&quot;
         role=&quot;button&quot; aria-label='Копировать'&gt;
        &lt;i class=&quot;fas fa-copy fa-fw&quot;&gt;&lt;/i&gt;
      &lt;/a&gt;
    &lt;/li&gt;
  &lt;/ul&gt;
&lt;/div&gt;
</code></pre>
<!-- raw HTML omitted -->
<p>Число в функции <code>substring()</code> - это количество символов в названии директории <code>sub</code> + 1 символ.</p>

        </div>
      </div>
    </div>






    
    <div class="accordion-item">
      <div class="accordion-header">
        <a class="accordion-button collapsed" href="#" role="button" tabindex="0"
           data-bs-toggle="collapse" data-bs-target="#sc-ab0a2252afa3d8b3d3aa8580e84df804"
           aria-expanded="false" aria-controls="sc-ab0a2252afa3d8b3d3aa8580e84df804" aria-label="example.com/contact-us/ | example.com/contact/">
            example.com/contact-us/ | example.com/contact/
        </a>
      </div>
      <div class="accordion-collapse collapse" id="sc-ab0a2252afa3d8b3d3aa8580e84df804" data-bs-parent="#sc-a8ec36334fe29993bc73f5d4b48c1c5e">
        <div class="accordion-body">
            <p><code>https://example.com/contact-us/</code> <code>-&gt;</code> <code>https://example.com/contact/</code></p>
<p><strong>When incoming requests match:</strong></p>
<!-- raw HTML omitted -->
<pre><code>  &lt;pre&gt;&lt;code class='language-lua'&gt;(http.request.uri.path eq &amp;#34;/contact-us/&amp;#34;)&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;div class=&quot;flex-shrink-0&quot;&gt;
  &lt;ul class=&quot;list-inline mb-0&quot;&gt;
    &lt;li class=&quot;list-inline-item&quot; data-bs-tooltip data-bs-title='Копировать'&gt;
      &lt;a class=&quot;text-body&quot; href=&quot;#&quot;
         data-fn=&quot;clipboard preventDefault&quot; data-clipboard-target=&quot;#cp-dc13bfc200c4945608afbaef2d5d666c&quot;
         role=&quot;button&quot; aria-label='Копировать'&gt;
        &lt;i class=&quot;fas fa-copy fa-fw&quot;&gt;&lt;/i&gt;
      &lt;/a&gt;
    &lt;/li&gt;
  &lt;/ul&gt;
&lt;/div&gt;
</code></pre>
<!-- raw HTML omitted -->
<p><strong>Then&hellip;</strong></p>
<ul>
<li>Type: <code>Static</code></li>
<li>Status code: <code>301</code></li>
</ul>
<p><strong>URL:</strong></p>
<!-- raw HTML omitted -->
<pre><code>  &lt;pre&gt;&lt;code class='language-lua'&gt;/contacts/&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;div class=&quot;flex-shrink-0&quot;&gt;
  &lt;ul class=&quot;list-inline mb-0&quot;&gt;
    &lt;li class=&quot;list-inline-item&quot; data-bs-tooltip data-bs-title='Копировать'&gt;
      &lt;a class=&quot;text-body&quot; href=&quot;#&quot;
         data-fn=&quot;clipboard preventDefault&quot; data-clipboard-target=&quot;#cp-36735afbae5afac29511a163b0d87e23&quot;
         role=&quot;button&quot; aria-label='Копировать'&gt;
        &lt;i class=&quot;fas fa-copy fa-fw&quot;&gt;&lt;/i&gt;
      &lt;/a&gt;
    &lt;/li&gt;
  &lt;/ul&gt;
&lt;/div&gt;
</code></pre>
<!-- raw HTML omitted -->

        </div>
      </div>
    </div>



</div>

<h4 id="порты">
  <a class="link-body-emphasis" href="#%d0%bf%d0%be%d1%80%d1%82%d1%8b">Порты</a>
</h4><p>Переадресация в зависимости от запроса, пришедшего на определённый порт.</p>


<div class="accordion mb-3 shortcode shortcode-accordion" id="sc-f219ae2813b1772c6cb60161e095a344">
    




    
    <div class="accordion-item">
      <div class="accordion-header">
        <a class="accordion-button collapsed" href="#" role="button" tabindex="0"
           data-bs-toggle="collapse" data-bs-target="#sc-3324a4bd0110aa1b11c3c0bc69ca7094"
           aria-expanded="false" aria-controls="sc-3324a4bd0110aa1b11c3c0bc69ca7094" aria-label="Переадресовать запрос к любым портам (кроме &#39;80&#39; и &#39;443&#39;) на порт &#39;443&#39; (HTTPS)">
            Переадресовать запрос к любым портам (кроме &#39;80&#39; и &#39;443&#39;) на порт &#39;443&#39; (HTTPS)
        </a>
      </div>
      <div class="accordion-collapse collapse" id="sc-3324a4bd0110aa1b11c3c0bc69ca7094" data-bs-parent="#sc-f219ae2813b1772c6cb60161e095a344">
        <div class="accordion-body">
            <p><code>https://example.com:1212</code> <code>-&gt;</code> <code>https://example.com</code></p>
<p><strong>When incoming requests match:</strong></p>
<!-- raw HTML omitted -->
<pre><code>  &lt;pre&gt;&lt;code class='language-lua'&gt;(not (cf.edge.server_port in {80 443}))&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;div class=&quot;flex-shrink-0&quot;&gt;
  &lt;ul class=&quot;list-inline mb-0&quot;&gt;
    &lt;li class=&quot;list-inline-item&quot; data-bs-tooltip data-bs-title='Копировать'&gt;
      &lt;a class=&quot;text-body&quot; href=&quot;#&quot;
         data-fn=&quot;clipboard preventDefault&quot; data-clipboard-target=&quot;#cp-5245dbe1080f1559cb79d62123ba6736&quot;
         role=&quot;button&quot; aria-label='Копировать'&gt;
        &lt;i class=&quot;fas fa-copy fa-fw&quot;&gt;&lt;/i&gt;
      &lt;/a&gt;
    &lt;/li&gt;
  &lt;/ul&gt;
&lt;/div&gt;
</code></pre>
<!-- raw HTML omitted -->
<p><strong>Then&hellip;</strong></p>
<ul>
<li>Type: <code>Dynamic</code></li>
<li>Status code: <code>301</code></li>
</ul>
<p><strong>URL:</strong></p>
<!-- raw HTML omitted -->
<pre><code>  &lt;pre&gt;&lt;code class='language-lua'&gt;concat(&amp;#34;https://&amp;#34;, http.host, http.request.uri.path)&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;div class=&quot;flex-shrink-0&quot;&gt;
  &lt;ul class=&quot;list-inline mb-0&quot;&gt;
    &lt;li class=&quot;list-inline-item&quot; data-bs-tooltip data-bs-title='Копировать'&gt;
      &lt;a class=&quot;text-body&quot; href=&quot;#&quot;
         data-fn=&quot;clipboard preventDefault&quot; data-clipboard-target=&quot;#cp-74fc29a69f8909f67dc167ef3a4434e5&quot;
         role=&quot;button&quot; aria-label='Копировать'&gt;
        &lt;i class=&quot;fas fa-copy fa-fw&quot;&gt;&lt;/i&gt;
      &lt;/a&gt;
    &lt;/li&gt;
  &lt;/ul&gt;
&lt;/div&gt;
</code></pre>
<!-- raw HTML omitted -->

        </div>
      </div>
    </div>



</div>

<h4 id="страны">
  <a class="link-body-emphasis" href="#%d1%81%d1%82%d1%80%d0%b0%d0%bd%d1%8b">Страны</a>
</h4><p>Переадресация в зависимости от страны клиента.</p>


<div class="accordion mb-3 shortcode shortcode-accordion" id="sc-0987ff57b5bf0e6cf679bde17b1f2724">
    




    
    <div class="accordion-item">
      <div class="accordion-header">
        <a class="accordion-button collapsed" href="#" role="button" tabindex="0"
           data-bs-toggle="collapse" data-bs-target="#sc-0f76150710baec770b6fcb5cd5cfd755"
           aria-expanded="false" aria-controls="sc-0f76150710baec770b6fcb5cd5cfd755" aria-label="Переадресовать пользователей из стран RU/BY/UA в директорию &#39;/ru&#39;">
            Переадресовать пользователей из стран RU/BY/UA в директорию &#39;/ru&#39;
        </a>
      </div>
      <div class="accordion-collapse collapse" id="sc-0f76150710baec770b6fcb5cd5cfd755" data-bs-parent="#sc-0987ff57b5bf0e6cf679bde17b1f2724">
        <div class="accordion-body">
            <p><code>https://example.com</code> <code>-&gt;</code> <code>https://example.com/ru/</code></p>
<p><strong>When incoming requests match:</strong></p>
<!-- raw HTML omitted -->
<pre><code>  &lt;pre&gt;&lt;code class='language-lua'&gt;(((ip.src.country eq &amp;#34;RU&amp;#34;) or (ip.src.country eq &amp;#34;BY&amp;#34;) or (ip.src.country eq &amp;#34;UA&amp;#34;)) and (http.request.uri.path eq &amp;#34;/&amp;#34;))&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;div class=&quot;flex-shrink-0&quot;&gt;
  &lt;ul class=&quot;list-inline mb-0&quot;&gt;
    &lt;li class=&quot;list-inline-item&quot; data-bs-tooltip data-bs-title='Копировать'&gt;
      &lt;a class=&quot;text-body&quot; href=&quot;#&quot;
         data-fn=&quot;clipboard preventDefault&quot; data-clipboard-target=&quot;#cp-287a5087a505015d6440ad945138ab21&quot;
         role=&quot;button&quot; aria-label='Копировать'&gt;
        &lt;i class=&quot;fas fa-copy fa-fw&quot;&gt;&lt;/i&gt;
      &lt;/a&gt;
    &lt;/li&gt;
  &lt;/ul&gt;
&lt;/div&gt;
</code></pre>
<!-- raw HTML omitted -->
<p><strong>Then&hellip;</strong></p>
<ul>
<li>Type: <code>Dynamic</code></li>
<li>Status code: <code>301</code></li>
</ul>
<p><strong>URL:</strong></p>
<!-- raw HTML omitted -->
<pre><code>  &lt;pre&gt;&lt;code class='language-lua'&gt;lower(concat(&amp;#34;https://&amp;#34;, http.host, &amp;#34;/ru/&amp;#34;))&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;div class=&quot;flex-shrink-0&quot;&gt;
  &lt;ul class=&quot;list-inline mb-0&quot;&gt;
    &lt;li class=&quot;list-inline-item&quot; data-bs-tooltip data-bs-title='Копировать'&gt;
      &lt;a class=&quot;text-body&quot; href=&quot;#&quot;
         data-fn=&quot;clipboard preventDefault&quot; data-clipboard-target=&quot;#cp-c6d9b30aabd3ecac88e727a39526e4e0&quot;
         role=&quot;button&quot; aria-label='Копировать'&gt;
        &lt;i class=&quot;fas fa-copy fa-fw&quot;&gt;&lt;/i&gt;
      &lt;/a&gt;
    &lt;/li&gt;
  &lt;/ul&gt;
&lt;/div&gt;
</code></pre>
<!-- raw HTML omitted -->

        </div>
      </div>
    </div>






    
    <div class="accordion-item">
      <div class="accordion-header">
        <a class="accordion-button collapsed" href="#" role="button" tabindex="0"
           data-bs-toggle="collapse" data-bs-target="#sc-2058e801a2d9d139a01cdd3e4ced775a"
           aria-expanded="false" aria-controls="sc-2058e801a2d9d139a01cdd3e4ced775a" aria-label="Переадресовать пользователей НЕ из стран RU/BY/UA в директорию &#39;/en&#39;">
            Переадресовать пользователей НЕ из стран RU/BY/UA в директорию &#39;/en&#39;
        </a>
      </div>
      <div class="accordion-collapse collapse" id="sc-2058e801a2d9d139a01cdd3e4ced775a" data-bs-parent="#sc-0987ff57b5bf0e6cf679bde17b1f2724">
        <div class="accordion-body">
            <p><code>https://example.com</code> <code>-&gt;</code> <code>https://example.com/en/</code></p>
<p><strong>When incoming requests match:</strong></p>
<!-- raw HTML omitted -->
<pre><code>  &lt;pre&gt;&lt;code class='language-lua'&gt;(((ip.src.country ne &amp;#34;RU&amp;#34;) or (ip.src.country ne &amp;#34;BY&amp;#34;) or (ip.src.country ne &amp;#34;UA&amp;#34;)) and (http.request.uri.path eq &amp;#34;/&amp;#34;))&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;div class=&quot;flex-shrink-0&quot;&gt;
  &lt;ul class=&quot;list-inline mb-0&quot;&gt;
    &lt;li class=&quot;list-inline-item&quot; data-bs-tooltip data-bs-title='Копировать'&gt;
      &lt;a class=&quot;text-body&quot; href=&quot;#&quot;
         data-fn=&quot;clipboard preventDefault&quot; data-clipboard-target=&quot;#cp-7912314e4218470ecc202b973fd4332e&quot;
         role=&quot;button&quot; aria-label='Копировать'&gt;
        &lt;i class=&quot;fas fa-copy fa-fw&quot;&gt;&lt;/i&gt;
      &lt;/a&gt;
    &lt;/li&gt;
  &lt;/ul&gt;
&lt;/div&gt;
</code></pre>
<!-- raw HTML omitted -->
<p><strong>Then&hellip;</strong></p>
<ul>
<li>Type: <code>Dynamic</code></li>
<li>Status code: <code>301</code></li>
</ul>
<p><strong>URL:</strong></p>
<!-- raw HTML omitted -->
<pre><code>  &lt;pre&gt;&lt;code class='language-lua'&gt;lower(concat(&amp;#34;https://&amp;#34;, http.host, &amp;#34;/en/&amp;#34;))&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;div class=&quot;flex-shrink-0&quot;&gt;
  &lt;ul class=&quot;list-inline mb-0&quot;&gt;
    &lt;li class=&quot;list-inline-item&quot; data-bs-tooltip data-bs-title='Копировать'&gt;
      &lt;a class=&quot;text-body&quot; href=&quot;#&quot;
         data-fn=&quot;clipboard preventDefault&quot; data-clipboard-target=&quot;#cp-6961430b1478cc36a8e253fb5d4351fe&quot;
         role=&quot;button&quot; aria-label='Копировать'&gt;
        &lt;i class=&quot;fas fa-copy fa-fw&quot;&gt;&lt;/i&gt;
      &lt;/a&gt;
    &lt;/li&gt;
  &lt;/ul&gt;
&lt;/div&gt;
</code></pre>
<!-- raw HTML omitted -->

        </div>
      </div>
    </div>



</div>]]></turbo:content></item><item turbo="true"><title>Работа с переменной среды окружения PATH</title><link>https://lib.onl/ru/articles/2023/10/1f062637-3227-56d7-93e3-126d1c80f5a8/</link><pubDate>Sat, 28 Oct 2023 12:27:07 +0000</pubDate><dc:creator>Kai Kimera</dc:creator><category>MS Windows</category><category>Терминал</category><category>Скрипты</category><yandex:related><link url="https://lib.onl/ru/articles/2023/10/eb39e3f7-b194-53d4-8bad-01edf9fdac47/">Дефрагментация в ОС Windows</link><link url="https://lib.onl/ru/articles/2023/10/fb64d665-3e56-5fa5-a9eb-2e2e251949d8/">Автоматическая настройка Windows Server 2022 под рабочую станцию</link><link url="https://lib.onl/ru/articles/2023/10/38fc94dd-8d37-5f9e-b556-676304976a9f/">Восстановление доверительных отношений между PC и Active Directory</link><link url="https://lib.onl/ru/articles/2023/10/616da78a-eb16-575a-9119-65f0c0c7baee/">Изменение порта RDP</link><link url="https://lib.onl/ru/articles/2023/10/c6e32349-8fc2-53f9-9a42-790878a64076/">PowerShell: Полезные функции</link><link url="https://lib.onl/ru/articles/2023/10/52d75b90-0637-5ba6-91d6-b1bff40e1d67/">PowerShell: Стирание диска</link><link url="https://lib.onl/ru/articles/2023/10/2a73410a-6611-570c-9ab4-dc8cc8998146/">PowerShell: Сжатие видео при помощи FFmpeg</link><link url="https://lib.onl/ru/articles/2023/10/0028821e-c96c-5014-a1dd-8963c161b170/">PowerShell: Определение разрядности ОС Windows</link><link url="https://lib.onl/ru/articles/2023/10/4c7aba7c-f5a6-589a-9975-fdb16f2e2862/">PowerShell Vault</link><link url="https://lib.onl/ru/articles/2023/10/75075788-9308-56b7-b531-2008cb35f7d0/">Установка сертификата НУЦ Минцифры</link><link url="https://lib.onl/ru/articles/2023/09/dd5a3e1a-596b-50d5-b070-b2a065f99f32/">Получение и установка MS Office 2021 LTSC</link><link url="https://lib.onl/ru/articles/2022/05/862226e6-cbb1-58f8-bc8e-0cfef747f475/">Интеграция обновлений в дистрибутив ОС MS Windows</link><link url="https://lib.onl/ru/articles/2022/05/36058650-3f35-5ed5-9565-0aa7d8800c28/">Windows Server 2022 для рабочей станции</link></yandex:related><turbo:extendedHtml>true</turbo:extendedHtml><turbo:source>https://lib.onl/ru/articles/2023/10/1f062637-3227-56d7-93e3-126d1c80f5a8/</turbo:source><turbo:topic>Работа с переменной среды окружения PATH</turbo:topic><turbo:content><![CDATA[<p>Переменная <code>Path</code> является переменной среды окружения, при помощи которой ОС <span class="shortcode shortcode-tag"><a href="/ru/categories/windows/" target="_blank">#Windows</a></span> находит нужные приложения в терминале. Рассмотрим способы редактирования значений этой переменной.</p>
<p>Проще говоря, в переменную <code>Path</code> можно добавлять пути к директориям приложений, для того чтобы при работе в терминале не прописывать полные пути к исполняемым файлам этих приложений. Например, в терминале, чтобы вызвать <span class="shortcode shortcode-tag"><a href="/ru/tags/git/" target="_blank">#Git</a></span> и зафиксировать изменения нужно ввести <code>C:\Apps\Git\git.exe commit -m 'bla-bla'</code>. Но если добавить значение <code>C:\Apps\Git</code> в переменную <code>Path</code>, то в терминале можно просто писать <code>git.exe commit -m 'bla-bla'</code>, больше не нужно указывать полный путь к Git&rsquo;у.</p>
<h2 id="уровни-переменной-path">
  <a class="link-body-emphasis" href="#%d1%83%d1%80%d0%be%d0%b2%d0%bd%d0%b8-%d0%bf%d0%b5%d1%80%d0%b5%d0%bc%d0%b5%d0%bd%d0%bd%d0%be%d0%b9-path">Уровни переменной <code>Path</code></a>
</h2><p>Существует два уровня переменной <code>Path</code>:</p>
<ul>
<li>Системный - является глобальным и его значения доступны для каждого аккаунта пользователя.</li>
<li>Пользовательский - работает в контексте конкретного аккаунта и содержит значения только этого пользователя. Под другим аккаунтом, переменная на пользовательском уровне может содержать другие значения.</li>
</ul>
<p>В пределах аккаунта пользователя эти два уровня переменной <code>Path</code> объединяют свои значения.</p>
<h2 id="добавление-значений-в-переменную-path">
  <a class="link-body-emphasis" href="#%d0%b4%d0%be%d0%b1%d0%b0%d0%b2%d0%bb%d0%b5%d0%bd%d0%b8%d0%b5-%d0%b7%d0%bd%d0%b0%d1%87%d0%b5%d0%bd%d0%b8%d0%b9-%d0%b2-%d0%bf%d0%b5%d1%80%d0%b5%d0%bc%d0%b5%d0%bd%d0%bd%d1%83%d1%8e-path">Добавление значений в переменную <code>Path</code></a>
</h2><p>Добавить свои значения в переменную <code>Path</code> можно несколькими способами:</p>
<ul>
<li>Графический интерфейс ОС.</li>
<li>Команда в CMD при помощи утилиты <code>setx</code>.</li>
<li>Команда в PowerShell.</li>
</ul>
<p>Значения в переменной <code>Path</code> разделяются символом <code>;</code>.</p>
<p>Так как я приверженец работы в терминале и считаю, что каждый администратор должен уметь работать с командной строкой, то привожу только два последних способа.</p>
<h3 id="командная-строка-cmd">
  <a class="link-body-emphasis" href="#%d0%ba%d0%be%d0%bc%d0%b0%d0%bd%d0%b4%d0%bd%d0%b0%d1%8f-%d1%81%d1%82%d1%80%d0%be%d0%ba%d0%b0-cmd">Командная строка CMD</a>
</h3><p>Управление переменными среды окружения в <span class="shortcode shortcode-tag"><a href="/ru/tags/cmd/" target="_blank">#CMD</a></span> происходит при помощи утилиты <code>setx</code>.</p>
<h4 id="системный-уровень">
  <a class="link-body-emphasis" href="#%d1%81%d0%b8%d1%81%d1%82%d0%b5%d0%bc%d0%bd%d1%8b%d0%b9-%d1%83%d1%80%d0%be%d0%b2%d0%b5%d0%bd%d1%8c">Системный уровень</a>
</h4><p>Чтобы добавить свои значения в переменную <code>Path</code> на системном уровне, необходимо указать ключ <code>/m</code>:</p>



<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-3 shortcode-codeblock-bat">
  <div class="d-flex overflow-hidden">
    <div class="flex-grow-1 rounded overflow-hidden" id="cp-4f207ad951c84ffd5ddb63616e54bc9b">
      
      <pre><code class='language-bat'>setx /m Path &#34;%Path%C:\Apps\App_01;C:\Apps\App_02&#34;</code></pre>
    </div>
    <div class="flex-shrink-0">
      <ul class="list-inline mb-0">
        <li class="list-inline-item" data-bs-tooltip data-bs-title='Копировать'>
          <a class="text-body" href="#"
             data-fn="clipboard preventDefault" data-clipboard-target="#cp-4f207ad951c84ffd5ddb63616e54bc9b"
             role="button" aria-label='Копировать'>
            <i class="fas fa-copy fa-fw"></i>
          </a>
        </li>
      </ul>
    </div>
  </div>
</div>





    












    
    


<div class="shortcode shortcode-alert">
  <div class="alert alert-danger d-flex overflow-hidden" role="alert">
    <div class="flex-shrink-0 align-self-center">
      <i class="fas fa-circle-radiation fa-fw fa-2x"></i>
    </div>
    <div class="flex-grow-1 ms-3 overflow-hidden">
        <p>Ни в коем случае нельзя прописывать в <code>setx</code> свои значения БЕЗ вызова переменной <code>Path</code>: при такой команде утилита <code>setx</code> обнулит все существующие значения в <code>Path</code> и запишет указанные вами. А значения, добавленные программами, пропадут.</p>
<p>Правильная команда должны быть такой:</p>
<!-- raw HTML omitted -->
<pre><code>  &lt;pre&gt;&lt;code class='language-bat'&gt;setx /m Path &amp;#34;%Path%C:\MyCustomDir&amp;#34;&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;div class=&quot;flex-shrink-0&quot;&gt;
  &lt;ul class=&quot;list-inline mb-0&quot;&gt;
    &lt;li class=&quot;list-inline-item&quot; data-bs-tooltip data-bs-title='Копировать'&gt;
      &lt;a class=&quot;text-body&quot; href=&quot;#&quot;
         data-fn=&quot;clipboard preventDefault&quot; data-clipboard-target=&quot;#cp-dcaa65744f4d16452dbd50c30c7625c8&quot;
         role=&quot;button&quot; aria-label='Копировать'&gt;
        &lt;i class=&quot;fas fa-copy fa-fw&quot;&gt;&lt;/i&gt;
      &lt;/a&gt;
    &lt;/li&gt;
  &lt;/ul&gt;
&lt;/div&gt;
</code></pre>
<!-- raw HTML omitted -->
<p>Здесь мы заранее вызываем переменную <code>Path</code> конструкцией <code>%Path%</code>, которая добавит существующие значения к вашим и всё это дело пропишется утилитой <code>setx</code> обратно в <code>Path</code>.</p>

    </div>
  </div>
</div>

<p>Необходимости в скрипте, который добавляет значения в переменную <code>Path</code> на системном уровне, нет. Но я всё же его написал, пусть будет.</p>

    

    
        
            
            <div class="shortcode shortcode-file mb-3">
              <div class="card overflow-hidden">
                <div class="card-header">
                  <div class="d-flex align-items-center">
                    <div class="flex-shrink-0">
                      <i class="far fa-file-code fa-fw"></i>
                    </div>
                    <div class="flex-grow-1 mx-2 text-truncate">
                      <code>cmd.set.env.path.system.bat</code>
                    </div>
                    <div class="flex-shrink-0">
                      <ul class="list-inline mb-0">
                        <li class="list-inline-item" data-bs-tooltip data-bs-title='Копировать'>
                          <a class="text-body" href="#"
                             data-fn="clipboard preventDefault" data-clipboard-target="#cp-d35a2105397160567a99c610978f2aaa"
                             role="button" aria-label='Копировать'>
                            <i class="fas fa-copy fa-fw"></i>
                          </a>
                        </li>
                        <li class="list-inline-item" data-bs-tooltip data-bs-title='Скачать'>
                          <a class="text-body" href="/ru/articles/2023/10/1f062637-3227-56d7-93e3-126d1c80f5a8/cmd.set.env.path.system.bat" download
                             role="button" aria-label='Скачать'>
                            <i class="fas fa-download fa-fw"></i>
                          </a>
                        </li>
                        <li class="list-inline-item" data-bs-tooltip data-bs-title='Открыть'>
                          <a class="text-body" href="/ru/articles/2023/10/1f062637-3227-56d7-93e3-126d1c80f5a8/cmd.set.env.path.system.bat" target="_blank"
                             role="button" aria-label='Открыть'>
                            <i class="fas fa-arrow-up-right-from-square fa-fw"></i>
                          </a>
                        </li>
                      </ul>
                    </div>
                  </div>
                </div>
                <div class="card-body" id="cp-d35a2105397160567a99c610978f2aaa">
                    
                        
                    
                  <pre><code class="language-bat">rem Setting PATH variable for system.
rem
rem @package   CMD
rem @author    Kai Kimera &lt;mail@kai.kim&gt;
rem @copyright 2023 Library Online
rem @license   MIT
rem @version   0.1.0
rem @link      https://lib.onl/ru/articles/2023/10/1f062637-3227-56d7-93e3-126d1c80f5a8/
rem ------------------------------------------------------------------------------------------------------------------ ::

@echo off
setLocal EnableDelayedExpansion

rem Custom PATH.
set &#34;pathArray=C:\Apps\App_01 C:\Apps\App_02 C:\Apps\App_03&#34;

rem Building a system PATH variable.
for %%p in ( %pathArray% ) do ( set &#34;pathCustom=%%p;!pathCustom!&#34; )

rem Setting a new PATH variable.
setx /m Path &#34;%Path%!pathCustom!&#34;</code></pre>
                </div>
              </div>
            </div>
        
    
<p>В переменной <code>pathArray</code> указывается массив из путей, которые необходимо добавить в <code>Path</code> на системном уровне.</p>
<h4 id="пользовательский-уровень">
  <a class="link-body-emphasis" href="#%d0%bf%d0%be%d0%bb%d1%8c%d0%b7%d0%be%d0%b2%d0%b0%d1%82%d0%b5%d0%bb%d1%8c%d1%81%d0%ba%d0%b8%d0%b9-%d1%83%d1%80%d0%be%d0%b2%d0%b5%d0%bd%d1%8c">Пользовательский уровень</a>
</h4><p>Добавить свои значения в переменную <code>Path</code> на пользовательском уровне:</p>



<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-6 shortcode-codeblock-bat">
  <div class="d-flex overflow-hidden">
    <div class="flex-grow-1 rounded overflow-hidden" id="cp-5081a7616ca42d3b4f8613e95f0d30c2">
      
      <pre><code class='language-bat'>setx Path &#34;%Path%C:\Apps\App_01;C:\Apps\App_02&#34;</code></pre>
    </div>
    <div class="flex-shrink-0">
      <ul class="list-inline mb-0">
        <li class="list-inline-item" data-bs-tooltip data-bs-title='Копировать'>
          <a class="text-body" href="#"
             data-fn="clipboard preventDefault" data-clipboard-target="#cp-5081a7616ca42d3b4f8613e95f0d30c2"
             role="button" aria-label='Копировать'>
            <i class="fas fa-copy fa-fw"></i>
          </a>
        </li>
      </ul>
    </div>
  </div>
</div>

<p>Но есть одна особенность: так как переменная <code>Path</code> объединяет значения системного и пользовательского уровней, то при такой команде, утилита <code>setx</code> пропишет в <code>Path</code> пользовательского уровня все значения из системного. Таким образом, получится дублирование содержимого <code>Path</code> системного уровня в пользовательском. Это не критично, но можно сделать более элегантно&hellip;</p>
<p>Для того, чтобы обойти вышеуказанную особенность, необходимо написать скрипт, который будет при вызове переменной <code>Path</code> вырезать из неё значения системного уровня. Собственно, скрипт я написал.</p>

    

    
        
            
            <div class="shortcode shortcode-file mb-3">
              <div class="card overflow-hidden">
                <div class="card-header">
                  <div class="d-flex align-items-center">
                    <div class="flex-shrink-0">
                      <i class="far fa-file-code fa-fw"></i>
                    </div>
                    <div class="flex-grow-1 mx-2 text-truncate">
                      <code>cmd.set.env.path.user.bat</code>
                    </div>
                    <div class="flex-shrink-0">
                      <ul class="list-inline mb-0">
                        <li class="list-inline-item" data-bs-tooltip data-bs-title='Копировать'>
                          <a class="text-body" href="#"
                             data-fn="clipboard preventDefault" data-clipboard-target="#cp-e804bf2dac5510b743bd5e59f0898ab6"
                             role="button" aria-label='Копировать'>
                            <i class="fas fa-copy fa-fw"></i>
                          </a>
                        </li>
                        <li class="list-inline-item" data-bs-tooltip data-bs-title='Скачать'>
                          <a class="text-body" href="/ru/articles/2023/10/1f062637-3227-56d7-93e3-126d1c80f5a8/cmd.set.env.path.user.bat" download
                             role="button" aria-label='Скачать'>
                            <i class="fas fa-download fa-fw"></i>
                          </a>
                        </li>
                        <li class="list-inline-item" data-bs-tooltip data-bs-title='Открыть'>
                          <a class="text-body" href="/ru/articles/2023/10/1f062637-3227-56d7-93e3-126d1c80f5a8/cmd.set.env.path.user.bat" target="_blank"
                             role="button" aria-label='Открыть'>
                            <i class="fas fa-arrow-up-right-from-square fa-fw"></i>
                          </a>
                        </li>
                      </ul>
                    </div>
                  </div>
                </div>
                <div class="card-body" id="cp-e804bf2dac5510b743bd5e59f0898ab6">
                    
                        
                    
                  <pre><code class="language-bat">rem Setting PATH variable for user.
rem
rem @package   CMD
rem @author    Kai Kimera &lt;mail@kai.kim&gt;
rem @copyright 2023 Library Online
rem @license   MIT
rem @version   0.1.0
rem @link      https://lib.onl/ru/articles/2023/10/1f062637-3227-56d7-93e3-126d1c80f5a8/
rem ------------------------------------------------------------------------------------------------------------------ ::

@echo off
setLocal EnableDelayedExpansion

rem Custom PATH.
set &#34;pathArray=C:\Apps\App_01 C:\Apps\App_02 C:\Apps\App_03&#34;

rem Getting the current PATH variable.
for /f &#34;tokens=2,*&#34; %%a in ( &#39;reg query HKCU\Environment /v Path&#39; ) do ( set &#34;pathUser=%%b&#34; )

rem Building a user PATH variable.
for %%p in ( %pathArray% ) do ( set &#34;pathCustom=%%p;!pathCustom!&#34; )

rem Setting a new PATH variable.
setx Path &#34;!pathUser!!pathCustom!&#34;</code></pre>
                </div>
              </div>
            </div>
        
    
<p>В переменной <code>pathArray</code> указывается массив из путей, которые необходимо добавить в <code>Path</code> на пользовательском уровне. При этом, добавление значений из системного уровня не произойдёт. Наша переменная <code>Path</code> пользовательского уровня останется чистенькой и красивой.</p>
<h3 id="терминал-powershell">
  <a class="link-body-emphasis" href="#%d1%82%d0%b5%d1%80%d0%bc%d0%b8%d0%bd%d0%b0%d0%bb-powershell">Терминал PowerShell</a>
</h3><p>В <span class="shortcode shortcode-tag"><a href="/ru/tags/powershell/" target="_blank">#PowerShell</a></span> для управления переменными окружения существуют методы:</p>
<ul>
<li><code>[Environment]::GetEnvironmentVariables()</code> - получение значения переменной среды окружения.</li>
<li><code>[Environment]::SetEnvironmentVariable()</code> - установка значения переменной среды окружения.</li>
</ul>
<h4 id="системный-уровень-1">
  <a class="link-body-emphasis" href="#%d1%81%d0%b8%d1%81%d1%82%d0%b5%d0%bc%d0%bd%d1%8b%d0%b9-%d1%83%d1%80%d0%be%d0%b2%d0%b5%d0%bd%d1%8c-1">Системный уровень</a>
</h4><p>Для добавления значений в переменную <code>Path</code> на системном уровне, я написал небольшой скрипт.</p>

    

    
        
            
            <div class="shortcode shortcode-file mb-3">
              <div class="card overflow-hidden">
                <div class="card-header">
                  <div class="d-flex align-items-center">
                    <div class="flex-shrink-0">
                      <i class="far fa-file-code fa-fw"></i>
                    </div>
                    <div class="flex-grow-1 mx-2 text-truncate">
                      <code>pwsh.set.env.path.system.ps1</code>
                    </div>
                    <div class="flex-shrink-0">
                      <ul class="list-inline mb-0">
                        <li class="list-inline-item" data-bs-tooltip data-bs-title='Копировать'>
                          <a class="text-body" href="#"
                             data-fn="clipboard preventDefault" data-clipboard-target="#cp-094f5a30bb9cdd4ef9243b8d57532a33"
                             role="button" aria-label='Копировать'>
                            <i class="fas fa-copy fa-fw"></i>
                          </a>
                        </li>
                        <li class="list-inline-item" data-bs-tooltip data-bs-title='Скачать'>
                          <a class="text-body" href="/ru/articles/2023/10/1f062637-3227-56d7-93e3-126d1c80f5a8/pwsh.set.env.path.system.ps1" download
                             role="button" aria-label='Скачать'>
                            <i class="fas fa-download fa-fw"></i>
                          </a>
                        </li>
                        <li class="list-inline-item" data-bs-tooltip data-bs-title='Открыть'>
                          <a class="text-body" href="/ru/articles/2023/10/1f062637-3227-56d7-93e3-126d1c80f5a8/pwsh.set.env.path.system.ps1" target="_blank"
                             role="button" aria-label='Открыть'>
                            <i class="fas fa-arrow-up-right-from-square fa-fw"></i>
                          </a>
                        </li>
                      </ul>
                    </div>
                  </div>
                </div>
                <div class="card-body" id="cp-094f5a30bb9cdd4ef9243b8d57532a33">
                    
                        
                    
                  <pre><code class="language-ps1">&lt;#PSScriptInfo
  .VERSION      0.1.0
  .GUID         41643d28-3808-4a6f-a322-d87ed4384d5f
  .AUTHOR       Kai Kimera
  .AUTHOREMAIL  mail@kai.kim
  .COMPANYNAME  Library Online
  .COPYRIGHT    2023 Library Online. All rights reserved.
  .LICENSEURI   https://choosealicense.com/licenses/mit/
  .PROJECTURI   https://lib.onl/ru/articles/2023/10/1f062637-3227-56d7-93e3-126d1c80f5a8/
#&gt;

#Requires -Version 7.2
#Requires -RunAsAdministrator

&lt;#
  .SYNOPSIS
  Setting PATH variable for system.

  .DESCRIPTION
  The script configures the PATH variable values for the system.

  .EXAMPLE
  .\pwsh.set.env.path.system.ps1 -P &#39;C:\Apps\App_01&#39;, &#39;C:\Apps\App_02&#39;, &#39;C:\Apps\App_03&#39;

  .LINK
  https://lib.onl/ru/articles/2023/10/1f062637-3227-56d7-93e3-126d1c80f5a8/
#&gt;

Param(
  [Alias(&#39;P&#39;)][string[]]$Path
)

function Set-EnvPathSystem() {
  $Path | ForEach-Object {
    [Environment]::SetEnvironmentVariable(
      &#39;Path&#39;, ([Environment]::GetEnvironmentVariables(&#39;Machine&#39;)).Path &#43; &#34;${_}&#34; &#43; [IO.Path]::PathSeparator, &#39;Machine&#39;
    )
  }
}

Set-EnvPathSystem</code></pre>
                </div>
              </div>
            </div>
        
    
<p>Вызов скрипта осуществляется следующим образом:</p>






<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-10 shortcode-codeblock-terminal
shortcode-codeblock-terminal-windows shortcode-codeblock-terminal-windows-root">
  <div class="card overflow-hidden" data-bs-theme="dark">
    <div class="card-header">
      <div class="d-flex align-items-center">
        <div class="flex-shrink-0 text-danger">
          <i class="fas fa-terminal fa-fw"></i>
        </div>
        <div class="flex-grow-1 mx-2">
          <h5 class="mb-0">Терминал</h5>
        </div>
        <div class="flex-shrink-0">
          <ul class="list-inline mb-0">
            <li class="list-inline-item" data-bs-tooltip data-bs-title='Копировать'>
              <a class="text-body" href="#"
                 data-fn="clipboard preventDefault" data-clipboard-target="#cp-e503586e1dfefa3d018dff80984b0ae3"
                 role="button" aria-label='Копировать'>
                <i class="fas fa-copy fa-fw"></i>
              </a>
            </li>
          </ul>
        </div>
      </div>
    </div>
    <div class="card-body p-0" id="cp-e503586e1dfefa3d018dff80984b0ae3">
      <pre><code class="language-plaintext">.\pwsh.set.env.path.system.ps1 -P &#39;C:\Apps\App_01&#39;, &#39;C:\Apps\App_02&#39;, &#39;C:\Apps\App_03&#39;</code></pre>
    </div>
  </div>
</div>

<p>В параметре <code>-P</code> указываются значения, которые необходимо добавить в переменную <code>Path</code> системного уровня.</p>
<h4 id="пользовательский-уровень-1">
  <a class="link-body-emphasis" href="#%d0%bf%d0%be%d0%bb%d1%8c%d0%b7%d0%be%d0%b2%d0%b0%d1%82%d0%b5%d0%bb%d1%8c%d1%81%d0%ba%d0%b8%d0%b9-%d1%83%d1%80%d0%be%d0%b2%d0%b5%d0%bd%d1%8c-1">Пользовательский уровень</a>
</h4><p>А здесь скрипт, который отвечает за добавление в переменную <code>Path</code> значений на пользовательском уровне.</p>

    

    
        
            
            <div class="shortcode shortcode-file mb-3">
              <div class="card overflow-hidden">
                <div class="card-header">
                  <div class="d-flex align-items-center">
                    <div class="flex-shrink-0">
                      <i class="far fa-file-code fa-fw"></i>
                    </div>
                    <div class="flex-grow-1 mx-2 text-truncate">
                      <code>pwsh.set.env.path.user.ps1</code>
                    </div>
                    <div class="flex-shrink-0">
                      <ul class="list-inline mb-0">
                        <li class="list-inline-item" data-bs-tooltip data-bs-title='Копировать'>
                          <a class="text-body" href="#"
                             data-fn="clipboard preventDefault" data-clipboard-target="#cp-2636fac9f9000d247ef739dc6210e913"
                             role="button" aria-label='Копировать'>
                            <i class="fas fa-copy fa-fw"></i>
                          </a>
                        </li>
                        <li class="list-inline-item" data-bs-tooltip data-bs-title='Скачать'>
                          <a class="text-body" href="/ru/articles/2023/10/1f062637-3227-56d7-93e3-126d1c80f5a8/pwsh.set.env.path.user.ps1" download
                             role="button" aria-label='Скачать'>
                            <i class="fas fa-download fa-fw"></i>
                          </a>
                        </li>
                        <li class="list-inline-item" data-bs-tooltip data-bs-title='Открыть'>
                          <a class="text-body" href="/ru/articles/2023/10/1f062637-3227-56d7-93e3-126d1c80f5a8/pwsh.set.env.path.user.ps1" target="_blank"
                             role="button" aria-label='Открыть'>
                            <i class="fas fa-arrow-up-right-from-square fa-fw"></i>
                          </a>
                        </li>
                      </ul>
                    </div>
                  </div>
                </div>
                <div class="card-body" id="cp-2636fac9f9000d247ef739dc6210e913">
                    
                        
                    
                  <pre><code class="language-ps1">&lt;#PSScriptInfo
  .VERSION      0.1.0
  .GUID         79f23918-308a-412c-8835-b1bb9c9193e3
  .AUTHOR       Kai Kimera
  .AUTHOREMAIL  mail@kai.kim
  .COMPANYNAME  Library Online
  .COPYRIGHT    2023 Library Online. All rights reserved.
  .LICENSEURI   https://choosealicense.com/licenses/mit/
  .PROJECTURI   https://lib.onl/ru/articles/2023/10/1f062637-3227-56d7-93e3-126d1c80f5a8/
#&gt;

#Requires -Version 7.2

&lt;#
  .SYNOPSIS
  Setting PATH variable for user.

  .DESCRIPTION
  The script configures the PATH variable values for the user.

  .EXAMPLE
  .\pwsh.set.env.path.user.ps1 -P &#39;C:\Apps\App_01&#39;, &#39;C:\Apps\App_02&#39;, &#39;C:\Apps\App_03&#39;

  .LINK
  https://lib.onl/ru/articles/2023/10/1f062637-3227-56d7-93e3-126d1c80f5a8/
#&gt;

Param(
  [Alias(&#39;P&#39;)][string[]]$Path
)

function Set-EnvPathUser() {
  $Path | ForEach-Object {
    [Environment]::SetEnvironmentVariable(
      &#39;Path&#39;, ([Environment]::GetEnvironmentVariables(&#39;User&#39;)).Path &#43; &#34;${_}&#34; &#43; [IO.Path]::PathSeparator, &#39;User&#39;
    )
  }
}

Set-EnvPathUser</code></pre>
                </div>
              </div>
            </div>
        
    
<p>Вызов скрипта осуществляется следующим образом:</p>






<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-12 shortcode-codeblock-terminal
shortcode-codeblock-terminal-windows shortcode-codeblock-terminal-windows-user">
  <div class="card overflow-hidden" data-bs-theme="dark">
    <div class="card-header">
      <div class="d-flex align-items-center">
        <div class="flex-shrink-0 ">
          <i class="fas fa-terminal fa-fw"></i>
        </div>
        <div class="flex-grow-1 mx-2">
          <h5 class="mb-0">Терминал</h5>
        </div>
        <div class="flex-shrink-0">
          <ul class="list-inline mb-0">
            <li class="list-inline-item" data-bs-tooltip data-bs-title='Копировать'>
              <a class="text-body" href="#"
                 data-fn="clipboard preventDefault" data-clipboard-target="#cp-15f23096f8f9f8291ca132f1d33ff5c2"
                 role="button" aria-label='Копировать'>
                <i class="fas fa-copy fa-fw"></i>
              </a>
            </li>
          </ul>
        </div>
      </div>
    </div>
    <div class="card-body p-0" id="cp-15f23096f8f9f8291ca132f1d33ff5c2">
      <pre><code class="language-plaintext">.\pwsh.set.env.path.user.ps1 -P &#39;C:\Apps\App_01&#39;, &#39;C:\Apps\App_02&#39;, &#39;C:\Apps\App_03&#39;</code></pre>
    </div>
  </div>
</div>

<p>В параметре <code>-P</code> указываются значения, которые необходимо добавить в переменную <code>Path</code> пользовательского уровня.</p>
<h4 id="общий-скрипт">
  <a class="link-body-emphasis" href="#%d0%be%d0%b1%d1%89%d0%b8%d0%b9-%d1%81%d0%ba%d1%80%d0%b8%d0%bf%d1%82">Общий скрипт</a>
</h4><p>Не знаю, почему я сразу не написал общий скрипт для всех уровней&hellip; Решил под завершение статьи реализовать подобную штуку.</p>

    

    
        
            
            <div class="shortcode shortcode-file mb-3">
              <div class="card overflow-hidden">
                <div class="card-header">
                  <div class="d-flex align-items-center">
                    <div class="flex-shrink-0">
                      <i class="far fa-file-code fa-fw"></i>
                    </div>
                    <div class="flex-grow-1 mx-2 text-truncate">
                      <code>pwsh.set.env.path.ps1</code>
                    </div>
                    <div class="flex-shrink-0">
                      <ul class="list-inline mb-0">
                        <li class="list-inline-item" data-bs-tooltip data-bs-title='Копировать'>
                          <a class="text-body" href="#"
                             data-fn="clipboard preventDefault" data-clipboard-target="#cp-aad497fa0924e67a52c53d3cd6a7aab9"
                             role="button" aria-label='Копировать'>
                            <i class="fas fa-copy fa-fw"></i>
                          </a>
                        </li>
                        <li class="list-inline-item" data-bs-tooltip data-bs-title='Скачать'>
                          <a class="text-body" href="/ru/articles/2023/10/1f062637-3227-56d7-93e3-126d1c80f5a8/pwsh.set.env.path.ps1" download
                             role="button" aria-label='Скачать'>
                            <i class="fas fa-download fa-fw"></i>
                          </a>
                        </li>
                        <li class="list-inline-item" data-bs-tooltip data-bs-title='Открыть'>
                          <a class="text-body" href="/ru/articles/2023/10/1f062637-3227-56d7-93e3-126d1c80f5a8/pwsh.set.env.path.ps1" target="_blank"
                             role="button" aria-label='Открыть'>
                            <i class="fas fa-arrow-up-right-from-square fa-fw"></i>
                          </a>
                        </li>
                      </ul>
                    </div>
                  </div>
                </div>
                <div class="card-body" id="cp-aad497fa0924e67a52c53d3cd6a7aab9">
                    
                        
                    
                  <pre><code class="language-ps1">&lt;#PSScriptInfo
  .VERSION      0.1.0
  .GUID         14efdc7d-1edd-4b40-b6d2-623288ce1659
  .AUTHOR       Kai Kimera
  .AUTHOREMAIL  mail@kai.kim
  .COMPANYNAME  Library Online
  .COPYRIGHT    2023 Library Online. All rights reserved.
  .LICENSEURI   https://choosealicense.com/licenses/mit/
  .PROJECTURI   https://lib.onl/ru/articles/2023/10/1f062637-3227-56d7-93e3-126d1c80f5a8/
#&gt;

#Requires -Version 7.2

&lt;#
  .SYNOPSIS
  Setting the PATH variable.

  .DESCRIPTION
  The script configures the PATH variable values.

  .EXAMPLE
  .\pwsh.set.env.path.ps1 -P &#39;C:\Apps\App_01&#39;, &#39;C:\Apps\App_02&#39;, &#39;C:\Apps\App_03&#39; -T &#39;Machine&#39;

  .EXAMPLE
  .\pwsh.set.env.path.ps1 -P &#39;C:\Apps\App_01&#39;, &#39;C:\Apps\App_02&#39;, &#39;C:\Apps\App_03&#39; -T &#39;User&#39;

  .LINK
  https://lib.onl/ru/articles/2023/10/1f062637-3227-56d7-93e3-126d1c80f5a8/
#&gt;


Param(
  [Alias(&#39;P&#39;)][string[]]$Path,
  [Parameter(Mandatory)][ValidateSet(&#39;Machine&#39;, &#39;User&#39;)][Alias(&#39;T&#39;)][string[]]$Target
)

function Set-EnvPath() {
  $Path | ForEach-Object {
    [Environment]::SetEnvironmentVariable(
      &#39;Path&#39;, ([Environment]::GetEnvironmentVariables(&#34;${Target}&#34;)).Path &#43; &#34;${_}&#34; &#43; [IO.Path]::PathSeparator, &#34;${Target}&#34;
    )
  }
}

Set-EnvPath</code></pre>
                </div>
              </div>
            </div>
        
    
<p>Вызывается скрипт обычным способом:</p>






<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-14 shortcode-codeblock-terminal
shortcode-codeblock-terminal-windows shortcode-codeblock-terminal-windows-user">
  <div class="card overflow-hidden" data-bs-theme="dark">
    <div class="card-header">
      <div class="d-flex align-items-center">
        <div class="flex-shrink-0 ">
          <i class="fas fa-terminal fa-fw"></i>
        </div>
        <div class="flex-grow-1 mx-2">
          <h5 class="mb-0">Терминал</h5>
        </div>
        <div class="flex-shrink-0">
          <ul class="list-inline mb-0">
            <li class="list-inline-item" data-bs-tooltip data-bs-title='Копировать'>
              <a class="text-body" href="#"
                 data-fn="clipboard preventDefault" data-clipboard-target="#cp-5d073f92df7c03c38ca8fc9ddb2bca44"
                 role="button" aria-label='Копировать'>
                <i class="fas fa-copy fa-fw"></i>
              </a>
            </li>
          </ul>
        </div>
      </div>
    </div>
    <div class="card-body p-0" id="cp-5d073f92df7c03c38ca8fc9ddb2bca44">
      <pre><code class="language-plaintext">.\pwsh.set.env.path.ps1 -P &#39;C:\Apps\App_01&#39;, &#39;C:\Apps\App_02&#39;, &#39;C:\Apps\App_03&#39; -T &#39;User&#39;</code></pre>
    </div>
  </div>
</div>

<p>Но отличается от выше приведённых скриптов дополнительным параметром <code>-T</code>, который указывает уровень переменной <code>Path</code> и может принимать следующие значения:</p>
<ul>
<li><code>Machine</code> - для системного уровня.</li>
<li><code>User</code> - для пользовательского уровня.</li>
</ul>]]></turbo:content></item><item turbo="true"><title>Автоматическая настройка Windows Server 2022 под рабочую станцию</title><link>https://lib.onl/ru/articles/2023/10/fb64d665-3e56-5fa5-a9eb-2e2e251949d8/</link><pubDate>Fri, 27 Oct 2023 19:46:08 +0000</pubDate><dc:creator>Kai Kimera</dc:creator><category>MS Windows</category><category>Терминал</category><category>Скрипты</category><yandex:related><link url="https://lib.onl/ru/articles/2022/05/36058650-3f35-5ed5-9565-0aa7d8800c28/">Windows Server 2022 для рабочей станции</link><link url="https://lib.onl/ru/articles/2023/10/38fc94dd-8d37-5f9e-b556-676304976a9f/">Восстановление доверительных отношений между PC и Active Directory</link><link url="https://lib.onl/ru/articles/2023/10/616da78a-eb16-575a-9119-65f0c0c7baee/">Изменение порта RDP</link><link url="https://lib.onl/ru/articles/2023/10/c6e32349-8fc2-53f9-9a42-790878a64076/">PowerShell: Полезные функции</link><link url="https://lib.onl/ru/articles/2023/10/52d75b90-0637-5ba6-91d6-b1bff40e1d67/">PowerShell: Стирание диска</link><link url="https://lib.onl/ru/articles/2023/10/2a73410a-6611-570c-9ab4-dc8cc8998146/">PowerShell: Сжатие видео при помощи FFmpeg</link><link url="https://lib.onl/ru/articles/2023/10/0028821e-c96c-5014-a1dd-8963c161b170/">PowerShell: Определение разрядности ОС Windows</link><link url="https://lib.onl/ru/articles/2023/10/4c7aba7c-f5a6-589a-9975-fdb16f2e2862/">PowerShell Vault</link><link url="https://lib.onl/ru/articles/2023/10/eb39e3f7-b194-53d4-8bad-01edf9fdac47/">Дефрагментация в ОС Windows</link><link url="https://lib.onl/ru/articles/2023/10/75075788-9308-56b7-b531-2008cb35f7d0/">Установка сертификата НУЦ Минцифры</link></yandex:related><turbo:extendedHtml>true</turbo:extendedHtml><turbo:source>https://lib.onl/ru/articles/2023/10/fb64d665-3e56-5fa5-a9eb-2e2e251949d8/</turbo:source><turbo:topic>Автоматическая настройка Windows Server 2022 под рабочую станцию</turbo:topic><turbo:content><![CDATA[<p>Ранее я уже публиковал инструкцию по превращению серверной ОС в ОС для рабочей станции. Но этот процесс можно автоматизировать при помощи <span class="shortcode shortcode-tag"><a href="/ru/tags/powershell/" target="_blank">#PowerShell</a></span>.</p>
<p>В статье <span class="shortcode shortcode-uuid"><a href="/ru/articles/2022/05/36058650-3f35-5ed5-9565-0aa7d8800c28/">Windows Server 2022 для рабочей станции</a></span> рассматривалось ручная адаптация Windows Server 2022 под рабочую станцию. Я решил написать специальный скрипт, который берёт на себя часть действий. Но окончательная настройка, например, такая как редактирование <span class="shortcode shortcode-tag"><a href="/ru/tags/gpo/" target="_blank">#GPO</a></span> остаётся за пользователем.</p>
<h2 id="автоматизация">
  <a class="link-body-emphasis" href="#%d0%b0%d0%b2%d1%82%d0%be%d0%bc%d0%b0%d1%82%d0%b8%d0%b7%d0%b0%d1%86%d0%b8%d1%8f">Автоматизация</a>
</h2><p>Рассмотрим скрипт по адаптации серверной ОС под рабочую станцию.</p>
<h3 id="примеры">
  <a class="link-body-emphasis" href="#%d0%bf%d1%80%d0%b8%d0%bc%d0%b5%d1%80%d1%8b">Примеры</a>
</h3><p>Скрипт требует административных прав доступа, поэтому его необходимо запускать под аккаунтом администратора.</p>






<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-3 shortcode-codeblock-terminal
shortcode-codeblock-terminal-windows shortcode-codeblock-terminal-windows-root">
  <div class="card overflow-hidden" data-bs-theme="dark">
    <div class="card-header">
      <div class="d-flex align-items-center">
        <div class="flex-shrink-0 text-danger">
          <i class="fas fa-terminal fa-fw"></i>
        </div>
        <div class="flex-grow-1 mx-2">
          <h5 class="mb-0">Терминал</h5>
        </div>
        <div class="flex-shrink-0">
          <ul class="list-inline mb-0">
            <li class="list-inline-item" data-bs-tooltip data-bs-title='Копировать'>
              <a class="text-body" href="#"
                 data-fn="clipboard preventDefault" data-clipboard-target="#cp-9becebc03d3192b97f3e94f3e1ba6384"
                 role="button" aria-label='Копировать'>
                <i class="fas fa-copy fa-fw"></i>
              </a>
            </li>
          </ul>
        </div>
      </div>
    </div>
    <div class="card-body p-0" id="cp-9becebc03d3192b97f3e94f3e1ba6384">
      <pre><code class="language-plaintext">.\pwsh.win.srv.ws.ps1</code></pre>
    </div>
  </div>
</div>

<h3 id="алгоритм-работы">
  <a class="link-body-emphasis" href="#%d0%b0%d0%bb%d0%b3%d0%be%d1%80%d0%b8%d1%82%d0%bc-%d1%80%d0%b0%d0%b1%d0%be%d1%82%d1%8b">Алгоритм работы</a>
</h3><ul>
<li>Включение дополнительных компонентов <span class="shortcode shortcode-tag"><a href="/ru/categories/windows/" target="_blank">#Windows</a></span>.</li>
<li>Настройка необходимых для рабочей станции служб.</li>
<li>Отключение <strong>IE Enhanced Security Configuration</strong> для аккаунтов администраторов и пользователей.</li>
<li>Переключение приоритета процессора в сторону приложений.</li>
<li>Настройка <strong>MMAgent</strong>.</li>
<li>Переключение <strong>DEP</strong> только на программы <span class="shortcode shortcode-tag"><a href="/ru/categories/windows/" target="_blank">#Windows</a></span> и службы.</li>
</ul>
<h3 id="скрипт">
  <a class="link-body-emphasis" href="#%d1%81%d0%ba%d1%80%d0%b8%d0%bf%d1%82">Скрипт</a>
</h3>
    

    
        
            
            <div class="shortcode shortcode-file mb-3">
              <div class="card overflow-hidden">
                <div class="card-header">
                  <div class="d-flex align-items-center">
                    <div class="flex-shrink-0">
                      <i class="far fa-file-code fa-fw"></i>
                    </div>
                    <div class="flex-grow-1 mx-2 text-truncate">
                      <code>pwsh.win.srv.ws.ps1</code>
                    </div>
                    <div class="flex-shrink-0">
                      <ul class="list-inline mb-0">
                        <li class="list-inline-item" data-bs-tooltip data-bs-title='Копировать'>
                          <a class="text-body" href="#"
                             data-fn="clipboard preventDefault" data-clipboard-target="#cp-eb02bad459b07f569daa6fc3f7717c7d"
                             role="button" aria-label='Копировать'>
                            <i class="fas fa-copy fa-fw"></i>
                          </a>
                        </li>
                        <li class="list-inline-item" data-bs-tooltip data-bs-title='Скачать'>
                          <a class="text-body" href="/ru/articles/2023/10/fb64d665-3e56-5fa5-a9eb-2e2e251949d8/pwsh.win.srv.ws.ps1" download
                             role="button" aria-label='Скачать'>
                            <i class="fas fa-download fa-fw"></i>
                          </a>
                        </li>
                        <li class="list-inline-item" data-bs-tooltip data-bs-title='Открыть'>
                          <a class="text-body" href="/ru/articles/2023/10/fb64d665-3e56-5fa5-a9eb-2e2e251949d8/pwsh.win.srv.ws.ps1" target="_blank"
                             role="button" aria-label='Открыть'>
                            <i class="fas fa-arrow-up-right-from-square fa-fw"></i>
                          </a>
                        </li>
                      </ul>
                    </div>
                  </div>
                </div>
                <div class="card-body" id="cp-eb02bad459b07f569daa6fc3f7717c7d">
                    
                        
                    
                  <pre><code class="language-ps1">&lt;#PSScriptInfo
  .VERSION      0.1.0
  .GUID         c050355b-ecbd-4b13-b805-3a422dc0c995
  .AUTHOR       Kai Kimera
  .AUTHOREMAIL  mail@kai.kim
  .COMPANYNAME  Library Online
  .COPYRIGHT    2023 Library Online. All rights reserved.
  .LICENSEURI   https://choosealicense.com/licenses/mit/
  .PROJECTURI   https://lib.onl/ru/articles/2023/10/fb64d665-3e56-5fa5-a9eb-2e2e251949d8/
#&gt;

#Requires -Version 7.2
#Requires -RunAsAdministrator

&lt;#
  .SYNOPSIS
  Windows Server configuration script.

  .DESCRIPTION
  The script allows you to set up Windows Server as a workstation.

  .EXAMPLE
  .\pwsh.win.srv.ws.ps1

  .LINK
  https://lib.onl/ru/articles/2023/10/fb64d665-3e56-5fa5-a9eb-2e2e251949d8/
#&gt;

# -------------------------------------------------------------------------------------------------------------------- #
# INITIALIZATION.
# -------------------------------------------------------------------------------------------------------------------- #

function Start-Script() {
  Start-FeatureConfig
  Start-ServiceConfig
  Start-IEConfig
  Start-PriorityControlConfig
  Start-MMAgentConfig
  Start-DEPConfig
}

# -------------------------------------------------------------------------------------------------------------------- #
# CONFIGURING FEATURES.
# -------------------------------------------------------------------------------------------------------------------- #

function Start-FeatureConfig {
  $Param = @{
    Name = &#39;Wireless-Networking&#39;
  }

  Install-WindowsFeature @Param
}

# -------------------------------------------------------------------------------------------------------------------- #
# CONFIGURING SERVICES.
# -------------------------------------------------------------------------------------------------------------------- #

function Start-ServiceConfig() {
  $Name = @(&#39;Audiosrv&#39;, &#39;AudioEndpointBuilder&#39;)

  $Name | ForEach-Object {
    $Param = @{
      Name = &#34;${_}&#34;
      StartupType = &#39;Automatic&#39;
    }

    Set-Service @Param
  }

  $WSearch = @{
    Name = &#39;WSearch&#39;
    StartupType = &#39;AutomaticDelayedStart&#39;
  }

  Set-Service @WSearch
}

# -------------------------------------------------------------------------------------------------------------------- #
# DISABLE IE ENHANCED SECURITY CONFIGURATION (ESC).
# -------------------------------------------------------------------------------------------------------------------- #

function Start-IEConfig() {
  $Path = @(
    &#39;HKLM:\SOFTWARE\Microsoft\Active Setup\Installed Components\{A509B1A7-37EF-4b3f-8CFC-4F3A74704073}&#39;
    &#39;HKLM:\SOFTWARE\Microsoft\Active Setup\Installed Components\{A509B1A8-37EF-4b3f-8CFC-4F3A74704073}&#39;
  )

  $Path | ForEach-Object {
    $Param = @{
      LiteralPath = &#34;${_}&#34;
      Name = &#39;IsInstalled&#39;
      Value = 0
    }

    if (Test-Path -LiteralPath &#34;${_}&#34;) {
      Set-ItemProperty @Param
      Write-Host &#39;IE Enhanced Security Configuration (ESC) has been disabled.&#39;
    } else {
      Write-Error -Message &#34;&#39;${_}&#39; not found!&#34; -ErrorAction &#39;Stop&#39;
    }
  }
}

# -------------------------------------------------------------------------------------------------------------------- #
# ADJUST PROCESSOR RESOURCES FOR BEST PERFORMANCE OF PROGRAMS.
# -------------------------------------------------------------------------------------------------------------------- #

function Start-PriorityControlConfig() {
  $Path = &#39;HKLM:\SYSTEM\CurrentControlSet\Control\PriorityControl&#39;

  $Param = @{
    LiteralPath = &#34;${Path}&#34;
    Name = &#39;Win32PrioritySeparation&#39;
    Value = 38
  }

  if (Test-Path -LiteralPath &#34;${Path}&#34;) {
    Set-ItemProperty @Param
  } else {
    Write-Error -Message &#34;&#39;${Path}&#39; not found!&#34; -ErrorAction &#39;Stop&#39;
  }
}

# -------------------------------------------------------------------------------------------------------------------- #
# CONFIGURING MMAGENT.
# -------------------------------------------------------------------------------------------------------------------- #

function Start-MMAgentConfig() {
  $Param = @{
    MemoryCompression = $true
    OperationAPI = $true
    PageCombining = $true
  }

  Enable-MMAgent @Param
}

# -------------------------------------------------------------------------------------------------------------------- #
# CONFIGURING DEP.
# -------------------------------------------------------------------------------------------------------------------- #

function Start-DEPConfig() {
  cmd.exe /c &#39;bcdedit.exe /set {current} nx OptIn&#39;
}

# -------------------------------------------------------------------------------------------------------------------- #
# -------------------------------------------------&lt; RUNNING SCRIPT &gt;------------------------------------------------- #
# -------------------------------------------------------------------------------------------------------------------- #

Start-Script</code></pre>
                </div>
              </div>
            </div>]]></turbo:content></item><item turbo="true"><title>Восстановление доверительных отношений между PC и Active Directory</title><link>https://lib.onl/ru/articles/2023/10/38fc94dd-8d37-5f9e-b556-676304976a9f/</link><pubDate>Fri, 27 Oct 2023 09:25:25 +0000</pubDate><dc:creator>Kai Kimera</dc:creator><category>MS Windows</category><category>Скрипты</category><category>Терминал</category><yandex:related><link url="https://lib.onl/ru/articles/2023/10/616da78a-eb16-575a-9119-65f0c0c7baee/">Изменение порта RDP</link><link url="https://lib.onl/ru/articles/2023/10/c6e32349-8fc2-53f9-9a42-790878a64076/">PowerShell: Полезные функции</link><link url="https://lib.onl/ru/articles/2023/10/52d75b90-0637-5ba6-91d6-b1bff40e1d67/">PowerShell: Стирание диска</link><link url="https://lib.onl/ru/articles/2023/10/2a73410a-6611-570c-9ab4-dc8cc8998146/">PowerShell: Сжатие видео при помощи FFmpeg</link><link url="https://lib.onl/ru/articles/2023/10/0028821e-c96c-5014-a1dd-8963c161b170/">PowerShell: Определение разрядности ОС Windows</link><link url="https://lib.onl/ru/articles/2023/10/4c7aba7c-f5a6-589a-9975-fdb16f2e2862/">PowerShell Vault</link><link url="https://lib.onl/ru/articles/2023/10/eb39e3f7-b194-53d4-8bad-01edf9fdac47/">Дефрагментация в ОС Windows</link><link url="https://lib.onl/ru/articles/2023/10/75075788-9308-56b7-b531-2008cb35f7d0/">Установка сертификата НУЦ Минцифры</link><link url="https://lib.onl/ru/articles/2022/05/36058650-3f35-5ed5-9565-0aa7d8800c28/">Windows Server 2022 для рабочей станции</link></yandex:related><turbo:extendedHtml>true</turbo:extendedHtml><turbo:source>https://lib.onl/ru/articles/2023/10/38fc94dd-8d37-5f9e-b556-676304976a9f/</turbo:source><turbo:topic>Восстановление доверительных отношений между PC и Active Directory</turbo:topic><turbo:content><![CDATA[<p>Рассмотрим способы решения распространённой проблемы потери доверительных отношений между рабочей станцией и доменом Active Directory (<span class="shortcode shortcode-tag"><a href="/ru/tags/ad/" target="_blank">#AD</a></span>). Из-за этой проблемы пользователь не может авторизоваться под своей учётной записью.</p>
<p>При попытке входа пользователя под доменной учётной записью, могут произойти следующие ошибки.</p>






    




<div class="shortcode shortcode-window">
  <div class="card text-bg-danger mb-3 overflow-hidden">
    <div class="card-header">
      <div class="d-flex align-items-center">
        <div class="flex-shrink-0">
          <i class="fas fa-computer fa-fw"></i>
        </div>
        <div class="flex-grow-1 mx-2">
          <h5 class="mb-0">Trust relationship</h5>
        </div>
        <div class="flex-shrink-0">
          <ul class="list-inline mb-0">
            <li class="list-inline-item"><i class="fas fa-circle fa-fw"></i></li>
            <li class="list-inline-item"><i class="fas fa-circle fa-fw"></i></li>
            <li class="list-inline-item"><i class="fas fa-circle fa-fw"></i></li>
          </ul>
        </div>
      </div>
    </div>
    <div class="card-body">
        <p>The trust relationship between this workstation and the primary domain failed.</p>
<p>(Не удалось восстановить доверительные отношения между рабочей станцией и доменом.)</p>

    </div>
  </div>
</div>







    




<div class="shortcode shortcode-window">
  <div class="card text-bg-danger mb-3 overflow-hidden">
    <div class="card-header">
      <div class="d-flex align-items-center">
        <div class="flex-shrink-0">
          <i class="fas fa-computer fa-fw"></i>
        </div>
        <div class="flex-grow-1 mx-2">
          <h5 class="mb-0">Security database</h5>
        </div>
        <div class="flex-shrink-0">
          <ul class="list-inline mb-0">
            <li class="list-inline-item"><i class="fas fa-circle fa-fw"></i></li>
            <li class="list-inline-item"><i class="fas fa-circle fa-fw"></i></li>
            <li class="list-inline-item"><i class="fas fa-circle fa-fw"></i></li>
          </ul>
        </div>
      </div>
    </div>
    <div class="card-body">
        <p>The security database on the server does not have a computer account for this workstation trust relationship.</p>
<p>(База данных диспетчера учетных записей на сервере не содержит записи для регистрации компьютера через доверительные отношения с этой рабочей станцией.)</p>

    </div>
  </div>
</div>

<p>Ошибка может возникнуть по различным факторам. Например, когда новый компьютер присоединился к домену под уже существующем именем другого компьютера, или когда виртуальная машина восстановилась с контрольной точки.</p>
<h2 id="ручной-способ">
  <a class="link-body-emphasis" href="#%d1%80%d1%83%d1%87%d0%bd%d0%be%d0%b9-%d1%81%d0%bf%d0%be%d1%81%d0%be%d0%b1">Ручной способ</a>
</h2><p>Для того, чтобы исправить ошибку, необходимо последовательно выполнить следующие пункты:</p>
<ol>
<li>Сбросить аккаунт компьютера в <span class="shortcode shortcode-tag"><a href="/ru/tags/ad/" target="_blank">#AD</a></span>.</li>
<li>На проблемном компьютере зайти под локальным администратором и вывести компьютер из домена в рабочую группу.</li>
<li>Перезагрузить компьютер.</li>
<li>Вывести компьютер из рабочей группы и ввести обратно в домен.</li>
<li>Еще раз перезагрузить компьютер.</li>
</ol>
<h2 id="автоматизация">
  <a class="link-body-emphasis" href="#%d0%b0%d0%b2%d1%82%d0%be%d0%bc%d0%b0%d1%82%d0%b8%d0%b7%d0%b0%d1%86%d0%b8%d1%8f">Автоматизация</a>
</h2><p>Как обычно, привожу скрипт по автоматизации восстановления доверительных отношений. Скрипт решит проблему быстро и без перезагрузок. Запускается под администратором.</p>
<h3 id="параметры">
  <a class="link-body-emphasis" href="#%d0%bf%d0%b0%d1%80%d0%b0%d0%bc%d0%b5%d1%82%d1%80%d1%8b">Параметры</a>
</h3><p>Параметр у скрипта один, это название сервера Domain Controller <span class="shortcode shortcode-tag">DC</span>.</p>
<ul>
<li><code>-S</code> <code>-P_Server</code> - название сервера DC (контроллера домена). Если параметр не задан, скрипт выбирает для операции контроллер домена по умолчанию.</li>
</ul>
<h3 id="примеры">
  <a class="link-body-emphasis" href="#%d0%bf%d1%80%d0%b8%d0%bc%d0%b5%d1%80%d1%8b">Примеры</a>
</h3><p>Восстановить доверительные отношения с доменом по умолчанию:</p>






<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-5 shortcode-codeblock-terminal
shortcode-codeblock-terminal-windows shortcode-codeblock-terminal-windows-root">
  <div class="card overflow-hidden" data-bs-theme="dark">
    <div class="card-header">
      <div class="d-flex align-items-center">
        <div class="flex-shrink-0 text-danger">
          <i class="fas fa-terminal fa-fw"></i>
        </div>
        <div class="flex-grow-1 mx-2">
          <h5 class="mb-0">Терминал</h5>
        </div>
        <div class="flex-shrink-0">
          <ul class="list-inline mb-0">
            <li class="list-inline-item" data-bs-tooltip data-bs-title='Копировать'>
              <a class="text-body" href="#"
                 data-fn="clipboard preventDefault" data-clipboard-target="#cp-68ea20644d86b3bf90c073e08aab6e47"
                 role="button" aria-label='Копировать'>
                <i class="fas fa-copy fa-fw"></i>
              </a>
            </li>
          </ul>
        </div>
      </div>
    </div>
    <div class="card-body p-0" id="cp-68ea20644d86b3bf90c073e08aab6e47">
      <pre><code class="language-plaintext">.\pwsh.csc.repair.ps1</code></pre>
    </div>
  </div>
</div>

<p>Восстановить доверительные отношения с доменом <code>DC-server.domain.com</code>:</p>






<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-6 shortcode-codeblock-terminal
shortcode-codeblock-terminal-windows shortcode-codeblock-terminal-windows-root">
  <div class="card overflow-hidden" data-bs-theme="dark">
    <div class="card-header">
      <div class="d-flex align-items-center">
        <div class="flex-shrink-0 text-danger">
          <i class="fas fa-terminal fa-fw"></i>
        </div>
        <div class="flex-grow-1 mx-2">
          <h5 class="mb-0">Терминал</h5>
        </div>
        <div class="flex-shrink-0">
          <ul class="list-inline mb-0">
            <li class="list-inline-item" data-bs-tooltip data-bs-title='Копировать'>
              <a class="text-body" href="#"
                 data-fn="clipboard preventDefault" data-clipboard-target="#cp-3a41d672a78ef75f243fb33d67967372"
                 role="button" aria-label='Копировать'>
                <i class="fas fa-copy fa-fw"></i>
              </a>
            </li>
          </ul>
        </div>
      </div>
    </div>
    <div class="card-body p-0" id="cp-3a41d672a78ef75f243fb33d67967372">
      <pre><code class="language-plaintext">.\pwsh.csc.repair.ps1 -DC &#39;DC-server.domain.com&#39;</code></pre>
    </div>
  </div>
</div>

<h3 id="алгоритм-работы">
  <a class="link-body-emphasis" href="#%d0%b0%d0%bb%d0%b3%d0%be%d1%80%d0%b8%d1%82%d0%bc-%d1%80%d0%b0%d0%b1%d0%be%d1%82%d1%8b">Алгоритм работы</a>
</h3><ul>
<li>Запускается проверка доверительных отношений при помощи cmdlet&rsquo;а <code>Test-ComputerSecureChannel</code>.</li>
<li>Если проверка пройдена, скрипт завершает работу.</li>
<li>Если проверка не пройдена, запускается цикл восстановления доверительных отношений с контроллером домена с временным интервалом в 5 секунд.</li>
</ul>
<h3 id="скрипт">
  <a class="link-body-emphasis" href="#%d1%81%d0%ba%d1%80%d0%b8%d0%bf%d1%82">Скрипт</a>
</h3>
    

    
        
            
            <div class="shortcode shortcode-file mb-3">
              <div class="card overflow-hidden">
                <div class="card-header">
                  <div class="d-flex align-items-center">
                    <div class="flex-shrink-0">
                      <i class="far fa-file-code fa-fw"></i>
                    </div>
                    <div class="flex-grow-1 mx-2 text-truncate">
                      <code>pwsh.csc.repair.ps1</code>
                    </div>
                    <div class="flex-shrink-0">
                      <ul class="list-inline mb-0">
                        <li class="list-inline-item" data-bs-tooltip data-bs-title='Копировать'>
                          <a class="text-body" href="#"
                             data-fn="clipboard preventDefault" data-clipboard-target="#cp-54718f8e4ca502c2022b846fe9594de5"
                             role="button" aria-label='Копировать'>
                            <i class="fas fa-copy fa-fw"></i>
                          </a>
                        </li>
                        <li class="list-inline-item" data-bs-tooltip data-bs-title='Скачать'>
                          <a class="text-body" href="/ru/articles/2023/10/38fc94dd-8d37-5f9e-b556-676304976a9f/pwsh.csc.repair.ps1" download
                             role="button" aria-label='Скачать'>
                            <i class="fas fa-download fa-fw"></i>
                          </a>
                        </li>
                        <li class="list-inline-item" data-bs-tooltip data-bs-title='Открыть'>
                          <a class="text-body" href="/ru/articles/2023/10/38fc94dd-8d37-5f9e-b556-676304976a9f/pwsh.csc.repair.ps1" target="_blank"
                             role="button" aria-label='Открыть'>
                            <i class="fas fa-arrow-up-right-from-square fa-fw"></i>
                          </a>
                        </li>
                      </ul>
                    </div>
                  </div>
                </div>
                <div class="card-body" id="cp-54718f8e4ca502c2022b846fe9594de5">
                    
                        
                    
                  <pre><code class="language-ps1">&lt;#PSScriptInfo
  .VERSION      0.1.0
  .GUID         52672f5d-e2c0-467a-ae1d-c0fc9009a1eb
  .AUTHOR       Kai Kimera
  .AUTHOREMAIL  mail@kai.kim
  .COMPANYNAME  Library Online
  .COPYRIGHT    2023 Library Online. All rights reserved.
  .LICENSEURI   https://choosealicense.com/licenses/mit/
  .PROJECTURI   https://lib.onl/ru/articles/2023/10/38fc94dd-8d37-5f9e-b556-676304976a9f/
#&gt;

#Requires -Version 7.2
#Requires -RunAsAdministrator

&lt;#
  .SYNOPSIS
  Testing and repairing the secure channel between the local computer and its domain.

  .DESCRIPTION
  Verifying that the channel between the local computer and its domain is working correctly by checking the status of its trust relationships. If a connection fails, trying to restore it.

  .PARAMETER P_Server
  Specifies the domain controller to run the command. If this parameter is not specified, this script selects a default domain controller for the operation.

  .PARAMETER P_Sleep
  Sleep time (in seconds).

  .EXAMPLE
  .\pwsh.csc.repair.ps1

  .EXAMPLE
  .\pwsh.csc.repair.ps1 -DC &#39;DC-server.domain.com&#39;

  .LINK
  https://lib.onl/ru/articles/2023/10/38fc94dd-8d37-5f9e-b556-676304976a9f/
#&gt;

# -------------------------------------------------------------------------------------------------------------------- #
# CONFIGURATION.
# -------------------------------------------------------------------------------------------------------------------- #

Param(
  [Parameter(HelpMessage=&#34;Specifies the domain controller to run the command.&#34;)]
  [Alias(&#39;DC&#39;)][string]$P_Server,

  [Parameter(HelpMessage=&#34;Sleep time (in seconds).&#34;)]
  [Alias(&#39;S&#39;)][int]$P_Sleep = 5
)

# -------------------------------------------------------------------------------------------------------------------- #
# INITIALIZATION.
# -------------------------------------------------------------------------------------------------------------------- #

function Start-Script() {
  Start-CSCRepair
}

# -------------------------------------------------------------------------------------------------------------------- #
# EDITING THE REGISTRY.
# -------------------------------------------------------------------------------------------------------------------- #

function Start-CSCRepair() {
  $Param = @{
    Server = &#34;${P_Server}&#34;
    Repair = $true
    Credential = (Get-Credential)
  }

  do {
    if (Test-ComputerSecureChannel) {
      Write-Host &#39;Connection successful. Everything is fine!&#39;
    } else {
      Write-Host &#39;Connection failed! The secure channel between the local computer and the domain is broken. Removing and then rebuilds the channel established by the NetLogon service...&#39;
      Test-ComputerSecureChannel @Param
      Start-Sleep -s $P_Sleep
    }
  } until (Test-ComputerSecureChannel)
}

# -------------------------------------------------------------------------------------------------------------------- #
# -------------------------------------------------&lt; RUNNING SCRIPT &gt;------------------------------------------------- #
# -------------------------------------------------------------------------------------------------------------------- #

Start-Script</code></pre>
                </div>
              </div>
            </div>]]></turbo:content></item><item turbo="true"><title>Изменение порта RDP</title><link>https://lib.onl/ru/articles/2023/10/616da78a-eb16-575a-9119-65f0c0c7baee/</link><pubDate>Thu, 26 Oct 2023 23:35:50 +0000</pubDate><dc:creator>Kai Kimera</dc:creator><category>MS Windows</category><category>Терминал</category><category>Скрипты</category><yandex:related><link url="https://lib.onl/ru/articles/2023/10/c6e32349-8fc2-53f9-9a42-790878a64076/">PowerShell: Полезные функции</link><link url="https://lib.onl/ru/articles/2023/10/52d75b90-0637-5ba6-91d6-b1bff40e1d67/">PowerShell: Стирание диска</link><link url="https://lib.onl/ru/articles/2023/10/2a73410a-6611-570c-9ab4-dc8cc8998146/">PowerShell: Сжатие видео при помощи FFmpeg</link><link url="https://lib.onl/ru/articles/2023/10/0028821e-c96c-5014-a1dd-8963c161b170/">PowerShell: Определение разрядности ОС Windows</link><link url="https://lib.onl/ru/articles/2023/10/4c7aba7c-f5a6-589a-9975-fdb16f2e2862/">PowerShell Vault</link><link url="https://lib.onl/ru/articles/2023/10/eb39e3f7-b194-53d4-8bad-01edf9fdac47/">Дефрагментация в ОС Windows</link><link url="https://lib.onl/ru/articles/2023/10/75075788-9308-56b7-b531-2008cb35f7d0/">Установка сертификата НУЦ Минцифры</link><link url="https://lib.onl/ru/articles/2022/05/36058650-3f35-5ed5-9565-0aa7d8800c28/">Windows Server 2022 для рабочей станции</link></yandex:related><turbo:extendedHtml>true</turbo:extendedHtml><turbo:source>https://lib.onl/ru/articles/2023/10/616da78a-eb16-575a-9119-65f0c0c7baee/</turbo:source><turbo:topic>Изменение порта RDP</turbo:topic><turbo:content><![CDATA[<p>По умолчанию, <span class="shortcode shortcode-tag"><a href="/ru/tags/rdp/" target="_blank">#RDP</a></span> использует порт <span class="shortcode shortcode-tag">TCP</span> <code>3389</code>, но по каким-либо обстоятельствам приходится его менять. Рассмотрим два способа изменения порта RDP.</p>
<h2 id="ручное-изменение-порта">
  <a class="link-body-emphasis" href="#%d1%80%d1%83%d1%87%d0%bd%d0%be%d0%b5-%d0%b8%d0%b7%d0%bc%d0%b5%d0%bd%d0%b5%d0%bd%d0%b8%d0%b5-%d0%bf%d0%be%d1%80%d1%82%d0%b0">Ручное изменение порта</a>
</h2><p>Для изменения порта <span class="shortcode shortcode-tag"><a href="/ru/tags/rdp/" target="_blank">#RDP</a></span>, нужно отредактировать реестр:</p>
<ol>
<li>Открыть редактор реестра <code>regedit.exe</code>.</li>
<li>Пройти по пути <code>HKEY_LOCAL_MACHINE\System\CurrentControlSet\Control\Terminal Server\WinStations\RDP-Tcp</code>.</li>
<li>Найти параметр <code>PortNumber</code>.</li>
<li>Ввести новый номер порта (decimal).</li>
<li>Перезагрузить компьютер.</li>
</ol>




    








    
    






<div class="shortcode shortcode-alert">
  <div class="alert alert-warning d-flex overflow-hidden" role="alert">
    <div class="flex-shrink-0 align-self-center">
      <i class="fas fa-exclamation-triangle fa-fw fa-2x"></i>
    </div>
    <div class="flex-grow-1 ms-3 overflow-hidden">
        <p>Если включён брандмауэр, необходимо в нём разрешить подключение через новый порт <!-- raw HTML omitted --><!-- raw HTML omitted -->#RDP<!-- raw HTML omitted --><!-- raw HTML omitted -->.</p>

    </div>
  </div>
</div>

<h2 id="автоматизация">
  <a class="link-body-emphasis" href="#%d0%b0%d0%b2%d1%82%d0%be%d0%bc%d0%b0%d1%82%d0%b8%d0%b7%d0%b0%d1%86%d0%b8%d1%8f">Автоматизация</a>
</h2><p>Весь процесс можно автоматизировать при помощи скрипта.</p>
<h3 id="параметры">
  <a class="link-body-emphasis" href="#%d0%bf%d0%b0%d1%80%d0%b0%d0%bc%d0%b5%d1%82%d1%80%d1%8b">Параметры</a>
</h3><p>Скрипт имеет один единственный параметр, это номер порта.</p>
<ul>
<li><code>-P</code> <code>-P_Port</code> - номер порта <span class="shortcode shortcode-tag"><a href="/ru/tags/rdp/" target="_blank">#RDP</a></span>.</li>
</ul>
<h3 id="примеры">
  <a class="link-body-emphasis" href="#%d0%bf%d1%80%d0%b8%d0%bc%d0%b5%d1%80%d1%8b">Примеры</a>
</h3><p>Запускается скрипт обычным способом. В параметре <code>-P</code> указывается новый номер порта <span class="shortcode shortcode-tag"><a href="/ru/tags/rdp/" target="_blank">#RDP</a></span>.</p>






<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-6 shortcode-codeblock-terminal
shortcode-codeblock-terminal-windows shortcode-codeblock-terminal-windows-root">
  <div class="card overflow-hidden" data-bs-theme="dark">
    <div class="card-header">
      <div class="d-flex align-items-center">
        <div class="flex-shrink-0 text-danger">
          <i class="fas fa-terminal fa-fw"></i>
        </div>
        <div class="flex-grow-1 mx-2">
          <h5 class="mb-0">Терминал</h5>
        </div>
        <div class="flex-shrink-0">
          <ul class="list-inline mb-0">
            <li class="list-inline-item" data-bs-tooltip data-bs-title='Копировать'>
              <a class="text-body" href="#"
                 data-fn="clipboard preventDefault" data-clipboard-target="#cp-afe19c845bfa133bbd40be110c3f5c8f"
                 role="button" aria-label='Копировать'>
                <i class="fas fa-copy fa-fw"></i>
              </a>
            </li>
          </ul>
        </div>
      </div>
    </div>
    <div class="card-body p-0" id="cp-afe19c845bfa133bbd40be110c3f5c8f">
      <pre><code class="language-plaintext">.\pwsh.rdp.port.ps1 -P 50102</code></pre>
    </div>
  </div>
</div>

<h3 id="алгоритм-работы">
  <a class="link-body-emphasis" href="#%d0%b0%d0%bb%d0%b3%d0%be%d1%80%d0%b8%d1%82%d0%bc-%d1%80%d0%b0%d0%b1%d0%be%d1%82%d1%8b">Алгоритм работы</a>
</h3><ul>
<li>Проверяется в реестре корректность пути и изменяется номер порта <span class="shortcode shortcode-tag"><a href="/ru/tags/rdp/" target="_blank">#RDP</a></span>. Если путь не найден, то скрипт аварийно завершает работу без дальнейших изменений.</li>
<li>В брандмауэр вносится два правила, которые разрешают подключение к новому порту <span class="shortcode shortcode-tag"><a href="/ru/tags/rdp/" target="_blank">#RDP</a></span>.</li>
<li>Если служба <code>TermService</code> (служба удаленных рабочих столов) запущена, она перезапускается, применяя новые параметры порта <span class="shortcode shortcode-tag"><a href="/ru/tags/rdp/" target="_blank">#RDP</a></span>.</li>
</ul>
<h3 id="скрипт">
  <a class="link-body-emphasis" href="#%d1%81%d0%ba%d1%80%d0%b8%d0%bf%d1%82">Скрипт</a>
</h3>
    

    
        
            
            <div class="shortcode shortcode-file mb-3">
              <div class="card overflow-hidden">
                <div class="card-header">
                  <div class="d-flex align-items-center">
                    <div class="flex-shrink-0">
                      <i class="far fa-file-code fa-fw"></i>
                    </div>
                    <div class="flex-grow-1 mx-2 text-truncate">
                      <code>pwsh.rdp.port.ps1</code>
                    </div>
                    <div class="flex-shrink-0">
                      <ul class="list-inline mb-0">
                        <li class="list-inline-item" data-bs-tooltip data-bs-title='Копировать'>
                          <a class="text-body" href="#"
                             data-fn="clipboard preventDefault" data-clipboard-target="#cp-baab08cf40eeafde9474ef0f84b5b4b4"
                             role="button" aria-label='Копировать'>
                            <i class="fas fa-copy fa-fw"></i>
                          </a>
                        </li>
                        <li class="list-inline-item" data-bs-tooltip data-bs-title='Скачать'>
                          <a class="text-body" href="/ru/articles/2023/10/616da78a-eb16-575a-9119-65f0c0c7baee/pwsh.rdp.port.ps1" download
                             role="button" aria-label='Скачать'>
                            <i class="fas fa-download fa-fw"></i>
                          </a>
                        </li>
                        <li class="list-inline-item" data-bs-tooltip data-bs-title='Открыть'>
                          <a class="text-body" href="/ru/articles/2023/10/616da78a-eb16-575a-9119-65f0c0c7baee/pwsh.rdp.port.ps1" target="_blank"
                             role="button" aria-label='Открыть'>
                            <i class="fas fa-arrow-up-right-from-square fa-fw"></i>
                          </a>
                        </li>
                      </ul>
                    </div>
                  </div>
                </div>
                <div class="card-body" id="cp-baab08cf40eeafde9474ef0f84b5b4b4">
                    
                        
                    
                  <pre><code class="language-ps1">&lt;#PSScriptInfo
  .VERSION      0.1.0
  .GUID         5d2bddd9-4eed-42f0-a0ba-7d30efcb81e2
  .AUTHOR       Kai Kimera
  .AUTHOREMAIL  mail@kai.kim
  .COMPANYNAME  Library Online
  .COPYRIGHT    2023 Library Online. All rights reserved.
  .LICENSEURI   https://choosealicense.com/licenses/mit/
  .PROJECTURI   https://lib.onl/ru/articles/2023/10/616da78a-eb16-575a-9119-65f0c0c7baee/
#&gt;

#Requires -Version 7.2
#Requires -RunAsAdministrator

&lt;#
  .SYNOPSIS
  Changing the RDP port number.

  .DESCRIPTION
  Changing the listening port for Remote Desktop on your computer.

  .PARAMETER P_Port
  RDP port number.
  Default: 3389.

  .EXAMPLE
  .\pwsh.rdp.port.ps1 -P 50102

  .LINK
  https://lib.onl/ru/articles/2023/10/616da78a-eb16-575a-9119-65f0c0c7baee/
#&gt;

# -------------------------------------------------------------------------------------------------------------------- #
# CONFIGURATION.
# -------------------------------------------------------------------------------------------------------------------- #

Param(
  [Parameter(HelpMessage=&#34;RDP port number.&#34;)]
  [ValidatePattern(&#39;^[0-9]&#43;$&#39;)]
  [Alias(&#39;P&#39;)][int]$P_Port = 3389
)

# -------------------------------------------------------------------------------------------------------------------- #
# INITIALIZATION.
# -------------------------------------------------------------------------------------------------------------------- #

function Start-Script() {
  Start-RdpRegistry
  Start-RdpFirewall
  Start-RdpService
}

# -------------------------------------------------------------------------------------------------------------------- #
# EDITING THE REGISTRY.
# -------------------------------------------------------------------------------------------------------------------- #

function Start-RdpRegistry() {
  $Path = &#39;HKLM:\SYSTEM\CurrentControlSet\Control\Terminal Server\WinStations\RDP-Tcp&#39;

  $Param = @{
    LiteralPath = &#34;${Path}&#34;
    Name = &#39;PortNumber&#39;
    Value = $P_Port
  }

  if (Test-Path -LiteralPath &#34;${Path}&#34;) {
    Set-ItemProperty @Param
  } else {
    Write-Error -Message &#34;&#39;${Path}&#39; not found!&#34; -ErrorAction &#39;Stop&#39;
  }
}

# -------------------------------------------------------------------------------------------------------------------- #
# EDITING THE FIREWALL.
# -------------------------------------------------------------------------------------------------------------------- #

function Start-RdpFirewall() {
  $TCP = @{
    DisplayName = &#39;Custom RDP Port (TCP-In)&#39;
    Profile = &#39;Public&#39;
    Direction = Inbound
    Action = Allow
    Protocol = TCP
    LocalPort = $P_Port
  }

  $UDP = @{
    DisplayName = &#39;Custom RDP Port (UDP-In)&#39;
    Profile = &#39;Public&#39;
    Direction = Inbound
    Action = Allow
    Protocol = UDP
    LocalPort = $P_Port
  }

  New-NetFirewallRule @TCP
  New-NetFirewallRule @UDP
}

# -------------------------------------------------------------------------------------------------------------------- #
# RESTARTING THE REMOTE DESKTOP SERVICES.
# -------------------------------------------------------------------------------------------------------------------- #

function Start-RdpService() {
  $Name = &#39;TermService&#39;

  $Param = @{
    Name = &#34;${Name}&#34;
    Force = $true
  }

  if ((Get-Service -Name &#34;${Name}&#34;).Status -eq &#39;Running&#39;) {
    Restart-Service @Param
  } else {
    Write-Host &#34;Service &#39;${Name}&#39; not running!&#34;
  }
}

# -------------------------------------------------------------------------------------------------------------------- #
# -------------------------------------------------&lt; RUNNING SCRIPT &gt;------------------------------------------------- #
# -------------------------------------------------------------------------------------------------------------------- #

Start-Script</code></pre>
                </div>
              </div>
            </div>]]></turbo:content></item><item turbo="true"><title>PowerShell: Полезные функции</title><link>https://lib.onl/ru/articles/2023/10/c6e32349-8fc2-53f9-9a42-790878a64076/</link><pubDate>Tue, 24 Oct 2023 03:38:45 +0000</pubDate><dc:creator>Kai Kimera</dc:creator><category>MS Windows</category><category>Терминал</category><category>Скрипты</category><yandex:related><link url="https://lib.onl/ru/articles/2023/10/52d75b90-0637-5ba6-91d6-b1bff40e1d67/">PowerShell: Стирание диска</link><link url="https://lib.onl/ru/articles/2023/10/2a73410a-6611-570c-9ab4-dc8cc8998146/">PowerShell: Сжатие видео при помощи FFmpeg</link><link url="https://lib.onl/ru/articles/2023/10/0028821e-c96c-5014-a1dd-8963c161b170/">PowerShell: Определение разрядности ОС Windows</link><link url="https://lib.onl/ru/articles/2023/10/4c7aba7c-f5a6-589a-9975-fdb16f2e2862/">PowerShell Vault</link><link url="https://lib.onl/ru/articles/2023/10/eb39e3f7-b194-53d4-8bad-01edf9fdac47/">Дефрагментация в ОС Windows</link><link url="https://lib.onl/ru/articles/2023/10/75075788-9308-56b7-b531-2008cb35f7d0/">Установка сертификата НУЦ Минцифры</link><link url="https://lib.onl/ru/articles/2022/05/36058650-3f35-5ed5-9565-0aa7d8800c28/">Windows Server 2022 для рабочей станции</link></yandex:related><turbo:extendedHtml>true</turbo:extendedHtml><turbo:source>https://lib.onl/ru/articles/2023/10/c6e32349-8fc2-53f9-9a42-790878a64076/</turbo:source><turbo:topic>PowerShell: Полезные функции</turbo:topic><turbo:content><![CDATA[<p>Полезные функции <span class="shortcode shortcode-tag"><a href="/ru/tags/powershell/" target="_blank">#PowerShell</a></span>, которые я пишу сам или нахожу в интернете. Очень помогает в работе и в скриптах.</p>
<h2 id="найти-файлы-старше-x-дней-с-момента-создания">
  <a class="link-body-emphasis" href="#%d0%bd%d0%b0%d0%b9%d1%82%d0%b8-%d1%84%d0%b0%d0%b9%d0%bb%d1%8b-%d1%81%d1%82%d0%b0%d1%80%d1%88%d0%b5-x-%d0%b4%d0%bd%d0%b5%d0%b9-%d1%81-%d0%bc%d0%be%d0%bc%d0%b5%d0%bd%d1%82%d0%b0-%d1%81%d0%be%d0%b7%d0%b4%d0%b0%d0%bd%d0%b8%d1%8f">Найти файлы старше X дней с момента создания</a>
</h2><p>Функция позволяет найти и вывести элементы старше X дней по свойству <code>CreationTime</code>.</p>
<h3 id="параметры">
  <a class="link-body-emphasis" href="#%d0%bf%d0%b0%d1%80%d0%b0%d0%bc%d0%b5%d1%82%d1%80%d1%8b">Параметры</a>
</h3><ul>
<li><code>-P</code> - путь к директории, в которой необходимо найти файлы.</li>
<li><code>-T</code> - время, прошедшее с момента создания файла (в секундах).</li>
</ul>

    

    
        
            
            <div class="shortcode shortcode-file mb-3">
              <div class="card overflow-hidden">
                <div class="card-header">
                  <div class="d-flex align-items-center">
                    <div class="flex-shrink-0">
                      <i class="far fa-file-code fa-fw"></i>
                    </div>
                    <div class="flex-grow-1 mx-2 text-truncate">
                      <code>pwsh.find.ct.ps1</code>
                    </div>
                    <div class="flex-shrink-0">
                      <ul class="list-inline mb-0">
                        <li class="list-inline-item" data-bs-tooltip data-bs-title='Копировать'>
                          <a class="text-body" href="#"
                             data-fn="clipboard preventDefault" data-clipboard-target="#cp-4a3e2a1290f2ddcd17bc4d3b02b7d52c"
                             role="button" aria-label='Копировать'>
                            <i class="fas fa-copy fa-fw"></i>
                          </a>
                        </li>
                        <li class="list-inline-item" data-bs-tooltip data-bs-title='Скачать'>
                          <a class="text-body" href="/ru/articles/2023/10/c6e32349-8fc2-53f9-9a42-790878a64076/pwsh.find.ct.ps1" download
                             role="button" aria-label='Скачать'>
                            <i class="fas fa-download fa-fw"></i>
                          </a>
                        </li>
                        <li class="list-inline-item" data-bs-tooltip data-bs-title='Открыть'>
                          <a class="text-body" href="/ru/articles/2023/10/c6e32349-8fc2-53f9-9a42-790878a64076/pwsh.find.ct.ps1" target="_blank"
                             role="button" aria-label='Открыть'>
                            <i class="fas fa-arrow-up-right-from-square fa-fw"></i>
                          </a>
                        </li>
                      </ul>
                    </div>
                  </div>
                </div>
                <div class="card-body" id="cp-4a3e2a1290f2ddcd17bc4d3b02b7d52c">
                    
                        
                    
                  <pre><code class="language-ps1">Param(
  [Alias(&#39;P&#39;)][string]$Path,
  [Alias(&#39;T&#39;)][long]$Time
)

function Find-CreationTime() {
  Get-ChildItem -Path &#34;${Path}&#34; -Recurse -File
    | Sort-Object -Property &#39;LastAccessTime&#39;
    | Where-Object { (($_.CreationTime) -lt ((Get-Date).AddSeconds(-$Time))) }
}

Find-CreationTime</code></pre>
                </div>
              </div>
            </div>
        
    




    










    
    




<div class="shortcode shortcode-alert">
  <div class="alert alert-success d-flex overflow-hidden" role="alert">
    <div class="flex-shrink-0 align-self-center">
      <i class="fas fa-lightbulb fa-fw fa-2x"></i>
    </div>
    <div class="flex-grow-1 ms-3 overflow-hidden">
        <p><code>.AddSeconds</code> можно заменить на <code>.AddDays</code>, чтобы отсчитывать дату не в секундах, а в днях.</p>

    </div>
  </div>
</div>

<h2 id="найти-файлы-старше-x-дней-с-момента-изменения">
  <a class="link-body-emphasis" href="#%d0%bd%d0%b0%d0%b9%d1%82%d0%b8-%d1%84%d0%b0%d0%b9%d0%bb%d1%8b-%d1%81%d1%82%d0%b0%d1%80%d1%88%d0%b5-x-%d0%b4%d0%bd%d0%b5%d0%b9-%d1%81-%d0%bc%d0%be%d0%bc%d0%b5%d0%bd%d1%82%d0%b0-%d0%b8%d0%b7%d0%bc%d0%b5%d0%bd%d0%b5%d0%bd%d0%b8%d1%8f">Найти файлы старше X дней с момента изменения</a>
</h2><p>Функция позволяет найти и вывести элементы старше X дней по свойству <code>LastWriteTime</code>.</p>
<h3 id="параметры-1">
  <a class="link-body-emphasis" href="#%d0%bf%d0%b0%d1%80%d0%b0%d0%bc%d0%b5%d1%82%d1%80%d1%8b-1">Параметры</a>
</h3><ul>
<li><code>-P</code> - путь к директории, в которой необходимо найти файлы.</li>
<li><code>-T</code> - время, прошедшее с момента изменения файла (в секундах).</li>
</ul>




    










    
    




<div class="shortcode shortcode-alert">
  <div class="alert alert-success d-flex overflow-hidden" role="alert">
    <div class="flex-shrink-0 align-self-center">
      <i class="fas fa-lightbulb fa-fw fa-2x"></i>
    </div>
    <div class="flex-grow-1 ms-3 overflow-hidden">
        <p><code>.AddSeconds</code> можно заменить на <code>.AddDays</code>, чтобы отсчитывать дату не в секундах, а в днях.</p>

    </div>
  </div>
</div>


    

    
        
            
            <div class="shortcode shortcode-file mb-3">
              <div class="card overflow-hidden">
                <div class="card-header">
                  <div class="d-flex align-items-center">
                    <div class="flex-shrink-0">
                      <i class="far fa-file-code fa-fw"></i>
                    </div>
                    <div class="flex-grow-1 mx-2 text-truncate">
                      <code>pwsh.find.lwt.ps1</code>
                    </div>
                    <div class="flex-shrink-0">
                      <ul class="list-inline mb-0">
                        <li class="list-inline-item" data-bs-tooltip data-bs-title='Копировать'>
                          <a class="text-body" href="#"
                             data-fn="clipboard preventDefault" data-clipboard-target="#cp-ae78d5ea6f9c068a521d7a9f3c6147f8"
                             role="button" aria-label='Копировать'>
                            <i class="fas fa-copy fa-fw"></i>
                          </a>
                        </li>
                        <li class="list-inline-item" data-bs-tooltip data-bs-title='Скачать'>
                          <a class="text-body" href="/ru/articles/2023/10/c6e32349-8fc2-53f9-9a42-790878a64076/pwsh.find.lwt.ps1" download
                             role="button" aria-label='Скачать'>
                            <i class="fas fa-download fa-fw"></i>
                          </a>
                        </li>
                        <li class="list-inline-item" data-bs-tooltip data-bs-title='Открыть'>
                          <a class="text-body" href="/ru/articles/2023/10/c6e32349-8fc2-53f9-9a42-790878a64076/pwsh.find.lwt.ps1" target="_blank"
                             role="button" aria-label='Открыть'>
                            <i class="fas fa-arrow-up-right-from-square fa-fw"></i>
                          </a>
                        </li>
                      </ul>
                    </div>
                  </div>
                </div>
                <div class="card-body" id="cp-ae78d5ea6f9c068a521d7a9f3c6147f8">
                    
                        
                    
                  <pre><code class="language-ps1">Param(
  [Alias(&#39;P&#39;)][string]$Path,
  [Alias(&#39;T&#39;)][long]$Time
)

function Find-LastWriteTime() {
  Get-ChildItem -Path &#34;${Path}&#34; -Recurse -File
    | Sort-Object -Property &#39;LastAccessTime&#39;
    | Where-Object { (($_.LastWriteTime) -lt ((Get-Date).AddSeconds(-$Time))) }
}

Find-LastWriteTime</code></pre>
                </div>
              </div>
            </div>
        
    
<h2 id="создать-новый-элемент">
  <a class="link-body-emphasis" href="#%d1%81%d0%be%d0%b7%d0%b4%d0%b0%d1%82%d1%8c-%d0%bd%d0%be%d0%b2%d1%8b%d0%b9-%d1%8d%d0%bb%d0%b5%d0%bc%d0%b5%d0%bd%d1%82">Создать новый элемент</a>
</h2><p>Функция позволяет создавать элементы. Ничего экстраординарного здесь нет, просто функция, укорачивающая стандартный cmdlet <code>New-Item</code>.</p>
<h3 id="параметры-2">
  <a class="link-body-emphasis" href="#%d0%bf%d0%b0%d1%80%d0%b0%d0%bc%d0%b5%d1%82%d1%80%d1%8b-2">Параметры</a>
</h3><ul>
<li><code>-T</code> - тип элемента.
<ul>
<li><code>'D'</code> - директория.</li>
<li><code>'F'</code> - файл.</li>
</ul>
</li>
<li><code>-P</code> - путь к директории, в которой необходимо создать элемент.</li>
<li><code>-N</code> - название элемента.</li>
</ul>

    

    
        
            
            <div class="shortcode shortcode-file mb-3">
              <div class="card overflow-hidden">
                <div class="card-header">
                  <div class="d-flex align-items-center">
                    <div class="flex-shrink-0">
                      <i class="far fa-file-code fa-fw"></i>
                    </div>
                    <div class="flex-grow-1 mx-2 text-truncate">
                      <code>pwsh.new.item.ps1</code>
                    </div>
                    <div class="flex-shrink-0">
                      <ul class="list-inline mb-0">
                        <li class="list-inline-item" data-bs-tooltip data-bs-title='Копировать'>
                          <a class="text-body" href="#"
                             data-fn="clipboard preventDefault" data-clipboard-target="#cp-4e5556810dca28017cc1893f59abd96f"
                             role="button" aria-label='Копировать'>
                            <i class="fas fa-copy fa-fw"></i>
                          </a>
                        </li>
                        <li class="list-inline-item" data-bs-tooltip data-bs-title='Скачать'>
                          <a class="text-body" href="/ru/articles/2023/10/c6e32349-8fc2-53f9-9a42-790878a64076/pwsh.new.item.ps1" download
                             role="button" aria-label='Скачать'>
                            <i class="fas fa-download fa-fw"></i>
                          </a>
                        </li>
                        <li class="list-inline-item" data-bs-tooltip data-bs-title='Открыть'>
                          <a class="text-body" href="/ru/articles/2023/10/c6e32349-8fc2-53f9-9a42-790878a64076/pwsh.new.item.ps1" target="_blank"
                             role="button" aria-label='Открыть'>
                            <i class="fas fa-arrow-up-right-from-square fa-fw"></i>
                          </a>
                        </li>
                      </ul>
                    </div>
                  </div>
                </div>
                <div class="card-body" id="cp-4e5556810dca28017cc1893f59abd96f">
                    
                        
                    
                  <pre><code class="language-ps1">param (
  [Alias(&#39;T&#39;)][string]$Type,
  [Alias(&#39;P&#39;)][string]$Path,
  [Alias(&#39;N&#39;)][string]$Name,
  [Alias(&#39;A&#39;)][string]$Action = &#39;SilentlyContinue&#39;
)

function New-Data() {
  switch ($Type) {
    &#39;D&#39; { $Type = &#39;Directory&#39; }
    &#39;F&#39; { $Type = &#39;File&#39; }
  }

  New-Item -Path &#34;${Path}&#34; -Name &#34;${Name}&#34; -ItemType &#34;${Type}&#34; -ErrorAction &#34;${Action}&#34;
}

New-Data</code></pre>
                </div>
              </div>
            </div>
        
    
<h2 id="проверить-существование-элемента">
  <a class="link-body-emphasis" href="#%d0%bf%d1%80%d0%be%d0%b2%d0%b5%d1%80%d0%b8%d1%82%d1%8c-%d1%81%d1%83%d1%89%d0%b5%d1%81%d1%82%d0%b2%d0%be%d0%b2%d0%b0%d0%bd%d0%b8%d0%b5-%d1%8d%d0%bb%d0%b5%d0%bc%d0%b5%d0%bd%d1%82%d0%b0">Проверить существование элемента</a>
</h2><p>Функция позволяет &ldquo;безопасно&rdquo; проверить существование элемента. Применяется параметр <code>-LiteralPath</code>, который интерпретирует путь без какой-либо обработки.</p>
<h3 id="параметры-3">
  <a class="link-body-emphasis" href="#%d0%bf%d0%b0%d1%80%d0%b0%d0%bc%d0%b5%d1%82%d1%80%d1%8b-3">Параметры</a>
</h3><ul>
<li><code>-T</code> - тип элемента.</li>
<li><code>-P</code> - путь к директории, в которой необходимо проверить элемент.</li>
</ul>

    

    
        
            
            <div class="shortcode shortcode-file mb-3">
              <div class="card overflow-hidden">
                <div class="card-header">
                  <div class="d-flex align-items-center">
                    <div class="flex-shrink-0">
                      <i class="far fa-file-code fa-fw"></i>
                    </div>
                    <div class="flex-grow-1 mx-2 text-truncate">
                      <code>pwsh.test.item.ps1</code>
                    </div>
                    <div class="flex-shrink-0">
                      <ul class="list-inline mb-0">
                        <li class="list-inline-item" data-bs-tooltip data-bs-title='Копировать'>
                          <a class="text-body" href="#"
                             data-fn="clipboard preventDefault" data-clipboard-target="#cp-814af3720939d4c7675d0d8c72344086"
                             role="button" aria-label='Копировать'>
                            <i class="fas fa-copy fa-fw"></i>
                          </a>
                        </li>
                        <li class="list-inline-item" data-bs-tooltip data-bs-title='Скачать'>
                          <a class="text-body" href="/ru/articles/2023/10/c6e32349-8fc2-53f9-9a42-790878a64076/pwsh.test.item.ps1" download
                             role="button" aria-label='Скачать'>
                            <i class="fas fa-download fa-fw"></i>
                          </a>
                        </li>
                        <li class="list-inline-item" data-bs-tooltip data-bs-title='Открыть'>
                          <a class="text-body" href="/ru/articles/2023/10/c6e32349-8fc2-53f9-9a42-790878a64076/pwsh.test.item.ps1" target="_blank"
                             role="button" aria-label='Открыть'>
                            <i class="fas fa-arrow-up-right-from-square fa-fw"></i>
                          </a>
                        </li>
                      </ul>
                    </div>
                  </div>
                </div>
                <div class="card-body" id="cp-814af3720939d4c7675d0d8c72344086">
                    
                        
                    
                  <pre><code class="language-ps1">param (
  [Alias(&#39;T&#39;)][string]$Type,
  [Alias(&#39;P&#39;)][string]$Path
)

function Test-Data() {
  switch ($Type) {
    &#39;D&#39; { $Type = &#39;Container&#39; }
    &#39;F&#39; { $Type = &#39;Leaf&#39; }
  }

  Test-Path -LiteralPath &#34;${Path}&#34; -PathType &#34;${Type}&#34;
}

Test-Data</code></pre>
                </div>
              </div>
            </div>
        
    
<h2 id="проверить-существование-модуля">
  <a class="link-body-emphasis" href="#%d0%bf%d1%80%d0%be%d0%b2%d0%b5%d1%80%d0%b8%d1%82%d1%8c-%d1%81%d1%83%d1%89%d0%b5%d1%81%d1%82%d0%b2%d0%be%d0%b2%d0%b0%d0%bd%d0%b8%d0%b5-%d0%bc%d0%be%d0%b4%d1%83%d0%bb%d1%8f">Проверить существование модуля</a>
</h2><p>Функция позволяет проверить существование модуля PowerShell в памяти компьютера.</p>
<h3 id="параметры-4">
  <a class="link-body-emphasis" href="#%d0%bf%d0%b0%d1%80%d0%b0%d0%bc%d0%b5%d1%82%d1%80%d1%8b-4">Параметры</a>
</h3><ul>
<li><code>-N</code> - название модуля.</li>
</ul>

    

    
        
            
            <div class="shortcode shortcode-file mb-3">
              <div class="card overflow-hidden">
                <div class="card-header">
                  <div class="d-flex align-items-center">
                    <div class="flex-shrink-0">
                      <i class="far fa-file-code fa-fw"></i>
                    </div>
                    <div class="flex-grow-1 mx-2 text-truncate">
                      <code>pwsh.test.module.ps1</code>
                    </div>
                    <div class="flex-shrink-0">
                      <ul class="list-inline mb-0">
                        <li class="list-inline-item" data-bs-tooltip data-bs-title='Копировать'>
                          <a class="text-body" href="#"
                             data-fn="clipboard preventDefault" data-clipboard-target="#cp-e5deb8e9a81321c914b7f9908e44e10e"
                             role="button" aria-label='Копировать'>
                            <i class="fas fa-copy fa-fw"></i>
                          </a>
                        </li>
                        <li class="list-inline-item" data-bs-tooltip data-bs-title='Скачать'>
                          <a class="text-body" href="/ru/articles/2023/10/c6e32349-8fc2-53f9-9a42-790878a64076/pwsh.test.module.ps1" download
                             role="button" aria-label='Скачать'>
                            <i class="fas fa-download fa-fw"></i>
                          </a>
                        </li>
                        <li class="list-inline-item" data-bs-tooltip data-bs-title='Открыть'>
                          <a class="text-body" href="/ru/articles/2023/10/c6e32349-8fc2-53f9-9a42-790878a64076/pwsh.test.module.ps1" target="_blank"
                             role="button" aria-label='Открыть'>
                            <i class="fas fa-arrow-up-right-from-square fa-fw"></i>
                          </a>
                        </li>
                      </ul>
                    </div>
                  </div>
                </div>
                <div class="card-body" id="cp-e5deb8e9a81321c914b7f9908e44e10e">
                    
                        
                    
                  <pre><code class="language-ps1">Param(
  [Alias(&#39;N&#39;)][string[]]$Names,
  [Alias(&#39;A&#39;)][string]$Action = &#39;Stop&#39;
)

function Test-Module() {
  ForEach ($Name in $Names) {
    if (-not (Get-Module -ListAvailable -Name &#34;${Name}&#34;)) {
      Write-Error -Message &#34;Module &#39;${Name}&#39; not installed!&#34; -ErrorAction &#34;${Action}&#34;
    }
  }
}

Test-Module</code></pre>
                </div>
              </div>
            </div>
        
    
<h2 id="вывести-сообщение-в-терминал">
  <a class="link-body-emphasis" href="#%d0%b2%d1%8b%d0%b2%d0%b5%d1%81%d1%82%d0%b8-%d1%81%d0%be%d0%be%d0%b1%d1%89%d0%b5%d0%bd%d0%b8%d0%b5-%d0%b2-%d1%82%d0%b5%d1%80%d0%bc%d0%b8%d0%bd%d0%b0%d0%bb">Вывести сообщение в терминал</a>
</h2><p>Функция выводит информацию в терминал по типу сообщений.</p>
<h3 id="параметры-5">
  <a class="link-body-emphasis" href="#%d0%bf%d0%b0%d1%80%d0%b0%d0%bc%d0%b5%d1%82%d1%80%d1%8b-5">Параметры</a>
</h3><ul>
<li><code>-T</code> - тип сообщения.
<ul>
<li><code>'HL'</code> - заголовок.</li>
<li><code>'I'</code> - информационное сообщение.</li>
<li><code>'W'</code> - предупреждение (warning).</li>
<li><code>'E'</code> - ошибка (error).</li>
</ul>
</li>
<li><code>-M</code> - текст сообщения.</li>
<li><code>-A</code> - действие, которое необходимо выполнить при выводе сообщения в терминал.</li>
</ul>

    

    
        
            
            <div class="shortcode shortcode-file mb-3">
              <div class="card overflow-hidden">
                <div class="card-header">
                  <div class="d-flex align-items-center">
                    <div class="flex-shrink-0">
                      <i class="far fa-file-code fa-fw"></i>
                    </div>
                    <div class="flex-grow-1 mx-2 text-truncate">
                      <code>pwsh.write.msg.ps1</code>
                    </div>
                    <div class="flex-shrink-0">
                      <ul class="list-inline mb-0">
                        <li class="list-inline-item" data-bs-tooltip data-bs-title='Копировать'>
                          <a class="text-body" href="#"
                             data-fn="clipboard preventDefault" data-clipboard-target="#cp-676f65534b8dd143cbb4048966a9974e"
                             role="button" aria-label='Копировать'>
                            <i class="fas fa-copy fa-fw"></i>
                          </a>
                        </li>
                        <li class="list-inline-item" data-bs-tooltip data-bs-title='Скачать'>
                          <a class="text-body" href="/ru/articles/2023/10/c6e32349-8fc2-53f9-9a42-790878a64076/pwsh.write.msg.ps1" download
                             role="button" aria-label='Скачать'>
                            <i class="fas fa-download fa-fw"></i>
                          </a>
                        </li>
                        <li class="list-inline-item" data-bs-tooltip data-bs-title='Открыть'>
                          <a class="text-body" href="/ru/articles/2023/10/c6e32349-8fc2-53f9-9a42-790878a64076/pwsh.write.msg.ps1" target="_blank"
                             role="button" aria-label='Открыть'>
                            <i class="fas fa-arrow-up-right-from-square fa-fw"></i>
                          </a>
                        </li>
                      </ul>
                    </div>
                  </div>
                </div>
                <div class="card-body" id="cp-676f65534b8dd143cbb4048966a9974e">
                    
                        
                    
                  <pre><code class="language-ps1">param (
  [Alias(&#39;T&#39;)][string]$Type,
  [Alias(&#39;M&#39;)][string]$Message,
  [Alias(&#39;A&#39;)][string]$Action = &#39;Continue&#39;
)

function Write-Msg() {
  switch ($Type) {
    &#39;HL&#39;    { Write-Host &#34;${NL}--- ${Message}&#34;.ToUpper() -ForegroundColor Blue }
    &#39;I&#39;     { Write-Information -MessageData &#34;${Message}&#34; -InformationAction &#34;${Action}&#34; }
    &#39;W&#39;     { Write-Warning -Message &#34;${Message}&#34; -WarningAction &#34;${Action}&#34; }
    &#39;E&#39;     { Write-Error -Message &#34;${Message}&#34; -ErrorAction &#34;${Action}&#34; }
    default { Write-Host &#34;${Message}&#34; }
  }
}

Write-Msg</code></pre>
                </div>
              </div>
            </div>
        
    
<h2 id="найти-свободную-букву-диска">
  <a class="link-body-emphasis" href="#%d0%bd%d0%b0%d0%b9%d1%82%d0%b8-%d1%81%d0%b2%d0%be%d0%b1%d0%be%d0%b4%d0%bd%d1%83%d1%8e-%d0%b1%d1%83%d0%ba%d0%b2%d1%83-%d0%b4%d0%b8%d1%81%d0%ba%d0%b0">Найти свободную букву диска</a>
</h2><p>Небольшая функция, которая возвращает не занятую букву диска. Используется в <span class="shortcode shortcode-uuid"><a href="/ru/articles/2023/10/52d75b90-0637-5ba6-91d6-b1bff40e1d67/">PowerShell: Стирание диска</a></span>.</p>

    

    
        
            
            <div class="shortcode shortcode-file mb-3">
              <div class="card overflow-hidden">
                <div class="card-header">
                  <div class="d-flex align-items-center">
                    <div class="flex-shrink-0">
                      <i class="far fa-file-code fa-fw"></i>
                    </div>
                    <div class="flex-grow-1 mx-2 text-truncate">
                      <code>pwsh.find.adl.ps1</code>
                    </div>
                    <div class="flex-shrink-0">
                      <ul class="list-inline mb-0">
                        <li class="list-inline-item" data-bs-tooltip data-bs-title='Копировать'>
                          <a class="text-body" href="#"
                             data-fn="clipboard preventDefault" data-clipboard-target="#cp-d10102effb3c8db60d030b4b422fdf6e"
                             role="button" aria-label='Копировать'>
                            <i class="fas fa-copy fa-fw"></i>
                          </a>
                        </li>
                        <li class="list-inline-item" data-bs-tooltip data-bs-title='Скачать'>
                          <a class="text-body" href="/ru/articles/2023/10/c6e32349-8fc2-53f9-9a42-790878a64076/pwsh.find.adl.ps1" download
                             role="button" aria-label='Скачать'>
                            <i class="fas fa-download fa-fw"></i>
                          </a>
                        </li>
                        <li class="list-inline-item" data-bs-tooltip data-bs-title='Открыть'>
                          <a class="text-body" href="/ru/articles/2023/10/c6e32349-8fc2-53f9-9a42-790878a64076/pwsh.find.adl.ps1" target="_blank"
                             role="button" aria-label='Открыть'>
                            <i class="fas fa-arrow-up-right-from-square fa-fw"></i>
                          </a>
                        </li>
                      </ul>
                    </div>
                  </div>
                </div>
                <div class="card-body" id="cp-d10102effb3c8db60d030b4b422fdf6e">
                    
                        
                    
                  <pre><code class="language-ps1">function Find-AvailableDriveLetter() {
  (68..90 | ForEach-Object { $L=[char]$_; if ((Get-PSDrive).Name -notContains $L) { $L } })[0]
}</code></pre>
                </div>
              </div>
            </div>
        
    
<h2 id="получить-размер-файла">
  <a class="link-body-emphasis" href="#%d0%bf%d0%be%d0%bb%d1%83%d1%87%d0%b8%d1%82%d1%8c-%d1%80%d0%b0%d0%b7%d0%bc%d0%b5%d1%80-%d1%84%d0%b0%d0%b9%d0%bb%d0%b0">Получить размер файла</a>
</h2><p>Функция позволяет получить размер файла в различных единицах измерения.</p>
<h3 id="параметры-6">
  <a class="link-body-emphasis" href="#%d0%bf%d0%b0%d1%80%d0%b0%d0%bc%d0%b5%d1%82%d1%80%d1%8b-6">Параметры</a>
</h3><ul>
<li><code>-F</code> - название файла.</li>
</ul>

    

    
        
            
            <div class="shortcode shortcode-file mb-3">
              <div class="card overflow-hidden">
                <div class="card-header">
                  <div class="d-flex align-items-center">
                    <div class="flex-shrink-0">
                      <i class="far fa-file-code fa-fw"></i>
                    </div>
                    <div class="flex-grow-1 mx-2 text-truncate">
                      <code>pwsh.get.filesize.ps1</code>
                    </div>
                    <div class="flex-shrink-0">
                      <ul class="list-inline mb-0">
                        <li class="list-inline-item" data-bs-tooltip data-bs-title='Копировать'>
                          <a class="text-body" href="#"
                             data-fn="clipboard preventDefault" data-clipboard-target="#cp-c14c5845070760f15f1dc53bbd8a5b82"
                             role="button" aria-label='Копировать'>
                            <i class="fas fa-copy fa-fw"></i>
                          </a>
                        </li>
                        <li class="list-inline-item" data-bs-tooltip data-bs-title='Скачать'>
                          <a class="text-body" href="/ru/articles/2023/10/c6e32349-8fc2-53f9-9a42-790878a64076/pwsh.get.filesize.ps1" download
                             role="button" aria-label='Скачать'>
                            <i class="fas fa-download fa-fw"></i>
                          </a>
                        </li>
                        <li class="list-inline-item" data-bs-tooltip data-bs-title='Открыть'>
                          <a class="text-body" href="/ru/articles/2023/10/c6e32349-8fc2-53f9-9a42-790878a64076/pwsh.get.filesize.ps1" target="_blank"
                             role="button" aria-label='Открыть'>
                            <i class="fas fa-arrow-up-right-from-square fa-fw"></i>
                          </a>
                        </li>
                      </ul>
                    </div>
                  </div>
                </div>
                <div class="card-body" id="cp-c14c5845070760f15f1dc53bbd8a5b82">
                    
                        
                    
                  <pre><code class="language-ps1">Param(
  [Alias(&#39;F&#39;)][string]$File
)

function Get-FileSize() {
  (Get-Item &#34;${File}&#34;).Length      # Size in bytes.
  (Get-Item &#34;${File}&#34;).Length/1KB  # Size in KB.
  (Get-Item &#34;${File}&#34;).Length/1MB  # Size in MB.
  (Get-Item &#34;${File}&#34;).Length/1GB  # Size in GB.
  (Get-Item &#34;${File}&#34;).Length/1TB  # Size in TB.
}

Get-FileSize</code></pre>
                </div>
              </div>
            </div>
        
    
<h2 id="работа-с-архивами-7-zip">
  <a class="link-body-emphasis" href="#%d1%80%d0%b0%d0%b1%d0%be%d1%82%d0%b0-%d1%81-%d0%b0%d1%80%d1%85%d0%b8%d0%b2%d0%b0%d0%bc%d0%b8-7-zip">Работа с архивами 7-Zip</a>
</h2><p>Функции по работе с архивами 7-Zip.</p>
<h3 id="параметры-7">
  <a class="link-body-emphasis" href="#%d0%bf%d0%b0%d1%80%d0%b0%d0%bc%d0%b5%d1%82%d1%80%d1%8b-7">Параметры</a>
</h3><ul>
<li><code>-F</code> - путь к файлу.</li>
</ul>
<h3 id="упаковка">
  <a class="link-body-emphasis" href="#%d1%83%d0%bf%d0%b0%d0%ba%d0%be%d0%b2%d0%ba%d0%b0">Упаковка</a>
</h3>
    

    
        
            
            <div class="shortcode shortcode-file mb-3">
              <div class="card overflow-hidden">
                <div class="card-header">
                  <div class="d-flex align-items-center">
                    <div class="flex-shrink-0">
                      <i class="far fa-file-code fa-fw"></i>
                    </div>
                    <div class="flex-grow-1 mx-2 text-truncate">
                      <code>pwsh.compress.7z.ps1</code>
                    </div>
                    <div class="flex-shrink-0">
                      <ul class="list-inline mb-0">
                        <li class="list-inline-item" data-bs-tooltip data-bs-title='Копировать'>
                          <a class="text-body" href="#"
                             data-fn="clipboard preventDefault" data-clipboard-target="#cp-f4a5cdbf3fa776cc5e73f1a0b64bf7f8"
                             role="button" aria-label='Копировать'>
                            <i class="fas fa-copy fa-fw"></i>
                          </a>
                        </li>
                        <li class="list-inline-item" data-bs-tooltip data-bs-title='Скачать'>
                          <a class="text-body" href="/ru/articles/2023/10/c6e32349-8fc2-53f9-9a42-790878a64076/pwsh.compress.7z.ps1" download
                             role="button" aria-label='Скачать'>
                            <i class="fas fa-download fa-fw"></i>
                          </a>
                        </li>
                        <li class="list-inline-item" data-bs-tooltip data-bs-title='Открыть'>
                          <a class="text-body" href="/ru/articles/2023/10/c6e32349-8fc2-53f9-9a42-790878a64076/pwsh.compress.7z.ps1" target="_blank"
                             role="button" aria-label='Открыть'>
                            <i class="fas fa-arrow-up-right-from-square fa-fw"></i>
                          </a>
                        </li>
                      </ul>
                    </div>
                  </div>
                </div>
                <div class="card-body" id="cp-f4a5cdbf3fa776cc5e73f1a0b64bf7f8">
                    
                        
                    
                  <pre><code class="language-ps1">Param(
  [Alias(&#39;F&#39;)][string]$File
)

function Compress-A7z() {
  Get-ChildItem &#34;${File}&#34; | ForEach-Object {
    &amp; &#34;$($Env:ProgramFiles)\7-Zip\7z.exe&#34; a &#34;$($_.FullName &#43; &#39;.7z&#39;)&#34; &#34;$($_.FullName)&#34;
  }
}

Compress-A7z</code></pre>
                </div>
              </div>
            </div>
        
    
<h3 id="распаковка">
  <a class="link-body-emphasis" href="#%d1%80%d0%b0%d1%81%d0%bf%d0%b0%d0%ba%d0%be%d0%b2%d0%ba%d0%b0">Распаковка</a>
</h3>
    

    
        
            
            <div class="shortcode shortcode-file mb-3">
              <div class="card overflow-hidden">
                <div class="card-header">
                  <div class="d-flex align-items-center">
                    <div class="flex-shrink-0">
                      <i class="far fa-file-code fa-fw"></i>
                    </div>
                    <div class="flex-grow-1 mx-2 text-truncate">
                      <code>pwsh.expand.7z.ps1</code>
                    </div>
                    <div class="flex-shrink-0">
                      <ul class="list-inline mb-0">
                        <li class="list-inline-item" data-bs-tooltip data-bs-title='Копировать'>
                          <a class="text-body" href="#"
                             data-fn="clipboard preventDefault" data-clipboard-target="#cp-98e675fcfd093f3f4bb4cdae411fdad0"
                             role="button" aria-label='Копировать'>
                            <i class="fas fa-copy fa-fw"></i>
                          </a>
                        </li>
                        <li class="list-inline-item" data-bs-tooltip data-bs-title='Скачать'>
                          <a class="text-body" href="/ru/articles/2023/10/c6e32349-8fc2-53f9-9a42-790878a64076/pwsh.expand.7z.ps1" download
                             role="button" aria-label='Скачать'>
                            <i class="fas fa-download fa-fw"></i>
                          </a>
                        </li>
                        <li class="list-inline-item" data-bs-tooltip data-bs-title='Открыть'>
                          <a class="text-body" href="/ru/articles/2023/10/c6e32349-8fc2-53f9-9a42-790878a64076/pwsh.expand.7z.ps1" target="_blank"
                             role="button" aria-label='Открыть'>
                            <i class="fas fa-arrow-up-right-from-square fa-fw"></i>
                          </a>
                        </li>
                      </ul>
                    </div>
                  </div>
                </div>
                <div class="card-body" id="cp-98e675fcfd093f3f4bb4cdae411fdad0">
                    
                        
                    
                  <pre><code class="language-ps1">Param(
  [Alias(&#39;F&#39;)][string]$File
)

function Expand-A7z() {
  Get-ChildItem &#34;${File}&#34; | ForEach-Object {
    &amp; &#34;$($Env:ProgramFiles)\7-Zip\7z.exe&#34; x &#34;$($_.FullName)&#34;
  }
}

Expand-A7z</code></pre>
                </div>
              </div>
            </div>
        
    
<h2 id="работа-с-архивами-winrar">
  <a class="link-body-emphasis" href="#%d1%80%d0%b0%d0%b1%d0%be%d1%82%d0%b0-%d1%81-%d0%b0%d1%80%d1%85%d0%b8%d0%b2%d0%b0%d0%bc%d0%b8-winrar">Работа с архивами WinRAR</a>
</h2><p>Функции по работе с архивами WinRAR.</p>
<h3 id="параметры-8">
  <a class="link-body-emphasis" href="#%d0%bf%d0%b0%d1%80%d0%b0%d0%bc%d0%b5%d1%82%d1%80%d1%8b-8">Параметры</a>
</h3><ul>
<li><code>-F</code> - путь к файлу.</li>
</ul>
<h3 id="упаковка-1">
  <a class="link-body-emphasis" href="#%d1%83%d0%bf%d0%b0%d0%ba%d0%be%d0%b2%d0%ba%d0%b0-1">Упаковка</a>
</h3>
    

    
        
            
            <div class="shortcode shortcode-file mb-3">
              <div class="card overflow-hidden">
                <div class="card-header">
                  <div class="d-flex align-items-center">
                    <div class="flex-shrink-0">
                      <i class="far fa-file-code fa-fw"></i>
                    </div>
                    <div class="flex-grow-1 mx-2 text-truncate">
                      <code>pwsh.compress.rar.ps1</code>
                    </div>
                    <div class="flex-shrink-0">
                      <ul class="list-inline mb-0">
                        <li class="list-inline-item" data-bs-tooltip data-bs-title='Копировать'>
                          <a class="text-body" href="#"
                             data-fn="clipboard preventDefault" data-clipboard-target="#cp-b87fbb4afecdc69de2667488d9d8b275"
                             role="button" aria-label='Копировать'>
                            <i class="fas fa-copy fa-fw"></i>
                          </a>
                        </li>
                        <li class="list-inline-item" data-bs-tooltip data-bs-title='Скачать'>
                          <a class="text-body" href="/ru/articles/2023/10/c6e32349-8fc2-53f9-9a42-790878a64076/pwsh.compress.rar.ps1" download
                             role="button" aria-label='Скачать'>
                            <i class="fas fa-download fa-fw"></i>
                          </a>
                        </li>
                        <li class="list-inline-item" data-bs-tooltip data-bs-title='Открыть'>
                          <a class="text-body" href="/ru/articles/2023/10/c6e32349-8fc2-53f9-9a42-790878a64076/pwsh.compress.rar.ps1" target="_blank"
                             role="button" aria-label='Открыть'>
                            <i class="fas fa-arrow-up-right-from-square fa-fw"></i>
                          </a>
                        </li>
                      </ul>
                    </div>
                  </div>
                </div>
                <div class="card-body" id="cp-b87fbb4afecdc69de2667488d9d8b275">
                    
                        
                    
                  <pre><code class="language-ps1">Param(
  [Alias(&#39;F&#39;)][string]$File
)

function Compress-RAR() {
  Get-ChildItem &#34;${File}&#34; | ForEach-Object {
    &amp; &#34;$($Env:ProgramFiles)\WinRAR\Rar.exe&#34; a &#34;$($_.FullName &#43; &#39;.rar&#39;)&#34; &#34;$($_.FullName)&#34;
  }
}

Compress-RAR</code></pre>
                </div>
              </div>
            </div>
        
    
<h3 id="распаковка-1">
  <a class="link-body-emphasis" href="#%d1%80%d0%b0%d1%81%d0%bf%d0%b0%d0%ba%d0%be%d0%b2%d0%ba%d0%b0-1">Распаковка</a>
</h3>
    

    
        
            
            <div class="shortcode shortcode-file mb-3">
              <div class="card overflow-hidden">
                <div class="card-header">
                  <div class="d-flex align-items-center">
                    <div class="flex-shrink-0">
                      <i class="far fa-file-code fa-fw"></i>
                    </div>
                    <div class="flex-grow-1 mx-2 text-truncate">
                      <code>pwsh.expand.rar.ps1</code>
                    </div>
                    <div class="flex-shrink-0">
                      <ul class="list-inline mb-0">
                        <li class="list-inline-item" data-bs-tooltip data-bs-title='Копировать'>
                          <a class="text-body" href="#"
                             data-fn="clipboard preventDefault" data-clipboard-target="#cp-3df87f6e3e63c8d43c4ad4fd486dfabd"
                             role="button" aria-label='Копировать'>
                            <i class="fas fa-copy fa-fw"></i>
                          </a>
                        </li>
                        <li class="list-inline-item" data-bs-tooltip data-bs-title='Скачать'>
                          <a class="text-body" href="/ru/articles/2023/10/c6e32349-8fc2-53f9-9a42-790878a64076/pwsh.expand.rar.ps1" download
                             role="button" aria-label='Скачать'>
                            <i class="fas fa-download fa-fw"></i>
                          </a>
                        </li>
                        <li class="list-inline-item" data-bs-tooltip data-bs-title='Открыть'>
                          <a class="text-body" href="/ru/articles/2023/10/c6e32349-8fc2-53f9-9a42-790878a64076/pwsh.expand.rar.ps1" target="_blank"
                             role="button" aria-label='Открыть'>
                            <i class="fas fa-arrow-up-right-from-square fa-fw"></i>
                          </a>
                        </li>
                      </ul>
                    </div>
                  </div>
                </div>
                <div class="card-body" id="cp-3df87f6e3e63c8d43c4ad4fd486dfabd">
                    
                        
                    
                  <pre><code class="language-ps1">Param(
  [Alias(&#39;F&#39;)][string]$File
)

function Expand-RAR() {
  Get-ChildItem &#34;${File}&#34; | ForEach-Object {
    &amp; &#34;$($Env:ProgramFiles)\WinRAR\Rar.exe&#34; x &#34;$($_.FullName)&#34;
  }
}

Expand-RAR</code></pre>
                </div>
              </div>
            </div>]]></turbo:content></item><item turbo="true"><title>PowerShell: Стирание диска</title><link>https://lib.onl/ru/articles/2023/10/52d75b90-0637-5ba6-91d6-b1bff40e1d67/</link><pubDate>Mon, 23 Oct 2023 11:03:04 +0000</pubDate><dc:creator>Kai Kimera</dc:creator><category>MS Windows</category><category>Терминал</category><category>Скрипты</category><yandex:related><link url="https://lib.onl/ru/articles/2023/10/eb39e3f7-b194-53d4-8bad-01edf9fdac47/">Дефрагментация в ОС Windows</link><link url="https://lib.onl/ru/articles/2023/10/2a73410a-6611-570c-9ab4-dc8cc8998146/">PowerShell: Сжатие видео при помощи FFmpeg</link><link url="https://lib.onl/ru/articles/2023/10/0028821e-c96c-5014-a1dd-8963c161b170/">PowerShell: Определение разрядности ОС Windows</link><link url="https://lib.onl/ru/articles/2023/10/4c7aba7c-f5a6-589a-9975-fdb16f2e2862/">PowerShell Vault</link><link url="https://lib.onl/ru/articles/2023/10/75075788-9308-56b7-b531-2008cb35f7d0/">Установка сертификата НУЦ Минцифры</link><link url="https://lib.onl/ru/articles/2022/05/36058650-3f35-5ed5-9565-0aa7d8800c28/">Windows Server 2022 для рабочей станции</link></yandex:related><turbo:extendedHtml>true</turbo:extendedHtml><turbo:source>https://lib.onl/ru/articles/2023/10/52d75b90-0637-5ba6-91d6-b1bff40e1d67/</turbo:source><turbo:topic>PowerShell: Стирание диска</turbo:topic><turbo:content><![CDATA[<p>Небольшой скрипт, который обнуляет <span class="shortcode shortcode-tag"><a href="/ru/tags/hdd/" target="_blank">#HDD</a></span> / <span class="shortcode shortcode-tag"><a href="/ru/tags/ssd/" target="_blank">#SSD</a></span> и создаёт файловую систему заново.</p>
<h2 id="параметры">
  <a class="link-body-emphasis" href="#%d0%bf%d0%b0%d1%80%d0%b0%d0%bc%d0%b5%d1%82%d1%80%d1%8b">Параметры</a>
</h2><ul>
<li><code>-DN</code> <code>-P_DiskNumber</code> - номер диска. Можно узнать командой <code>Get-Disk</code>. Но если не ввести номер диска в параметры скрипта при запуске, скрипт сам выведет информацию и спросит номер диска. Обязательный параметр.</li>
<li><code>-DL</code> <code>-P_DriveLetter</code> - буква будущего тома. При создании тома, ОС должна присвоить ему букву. Обязательный параметр.</li>
<li><code>-FS</code> <code>-P_FileSystem</code> - файловая система. Может принимать следующие значения:
<ul>
<li><code>'FAT'</code> - файловая система <span class="shortcode shortcode-tag">FAT</span>.</li>
<li><code>'FAT32'</code> - файловая система <span class="shortcode shortcode-tag">FAT32</span>.</li>
<li><code>'exFAT'</code> - файловая система <span class="shortcode shortcode-tag">exFAT</span>.</li>
<li><code>'NTFS'</code> - файловая система <span class="shortcode shortcode-tag">NTFS</span>.</li>
<li><code>'ReFS'</code> - новая файловая система <span class="shortcode shortcode-tag">ReFS</span>.</li>
</ul>
</li>
<li><code>-FSL</code> <code>-P_FileSystemLabel</code> - метка файловой системы.</li>
<li><code>-S</code> <code>-P_Sleep</code> - перерыв между командами (в секундах).</li>
</ul>
<h2 id="примеры">
  <a class="link-body-emphasis" href="#%d0%bf%d1%80%d0%b8%d0%bc%d0%b5%d1%80%d1%8b">Примеры</a>
</h2><p>Скрипт, запущенный без параметров, сам спросит необходимые данные:</p>






<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-7 shortcode-codeblock-terminal
shortcode-codeblock-terminal-windows shortcode-codeblock-terminal-windows-root">
  <div class="card overflow-hidden" data-bs-theme="dark">
    <div class="card-header">
      <div class="d-flex align-items-center">
        <div class="flex-shrink-0 text-danger">
          <i class="fas fa-terminal fa-fw"></i>
        </div>
        <div class="flex-grow-1 mx-2">
          <h5 class="mb-0">Терминал</h5>
        </div>
        <div class="flex-shrink-0">
          <ul class="list-inline mb-0">
            <li class="list-inline-item" data-bs-tooltip data-bs-title='Копировать'>
              <a class="text-body" href="#"
                 data-fn="clipboard preventDefault" data-clipboard-target="#cp-127944f971ee4fff0af499a51e437fa4"
                 role="button" aria-label='Копировать'>
                <i class="fas fa-copy fa-fw"></i>
              </a>
            </li>
          </ul>
        </div>
      </div>
    </div>
    <div class="card-body p-0" id="cp-127944f971ee4fff0af499a51e437fa4">
      <pre><code class="language-plaintext">.\pwsh.disk.erase.ps1</code></pre>
    </div>
  </div>
</div>

<p>Обнулить диск <code>3</code>, новому разделу присвоить букву <code>E</code>, форматировать в <code>NTFS</code> и указать метку <code>USB-SSD</code>:</p>






<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-8 shortcode-codeblock-terminal
shortcode-codeblock-terminal-windows shortcode-codeblock-terminal-windows-root">
  <div class="card overflow-hidden" data-bs-theme="dark">
    <div class="card-header">
      <div class="d-flex align-items-center">
        <div class="flex-shrink-0 text-danger">
          <i class="fas fa-terminal fa-fw"></i>
        </div>
        <div class="flex-grow-1 mx-2">
          <h5 class="mb-0">Терминал</h5>
        </div>
        <div class="flex-shrink-0">
          <ul class="list-inline mb-0">
            <li class="list-inline-item" data-bs-tooltip data-bs-title='Копировать'>
              <a class="text-body" href="#"
                 data-fn="clipboard preventDefault" data-clipboard-target="#cp-ef8b74de1993c39e3f167be1cc519c03"
                 role="button" aria-label='Копировать'>
                <i class="fas fa-copy fa-fw"></i>
              </a>
            </li>
          </ul>
        </div>
      </div>
    </div>
    <div class="card-body p-0" id="cp-ef8b74de1993c39e3f167be1cc519c03">
      <pre><code class="language-plaintext">.\pwsh.disk.erase.ps1 -DN 3 -DL &#39;E&#39; -FS &#39;NTFS&#39; -FSL &#39;USB-SSD&#39;</code></pre>
    </div>
  </div>
</div>

<h2 id="скрипт">
  <a class="link-body-emphasis" href="#%d1%81%d0%ba%d1%80%d0%b8%d0%bf%d1%82">Скрипт</a>
</h2>
    

    
        
            
            <div class="shortcode shortcode-file mb-3">
              <div class="card overflow-hidden">
                <div class="card-header">
                  <div class="d-flex align-items-center">
                    <div class="flex-shrink-0">
                      <i class="far fa-file-code fa-fw"></i>
                    </div>
                    <div class="flex-grow-1 mx-2 text-truncate">
                      <code>pwsh.disk.erase.ps1</code>
                    </div>
                    <div class="flex-shrink-0">
                      <ul class="list-inline mb-0">
                        <li class="list-inline-item" data-bs-tooltip data-bs-title='Копировать'>
                          <a class="text-body" href="#"
                             data-fn="clipboard preventDefault" data-clipboard-target="#cp-3612e319b8800b8d5bf6db79c7fc01ee"
                             role="button" aria-label='Копировать'>
                            <i class="fas fa-copy fa-fw"></i>
                          </a>
                        </li>
                        <li class="list-inline-item" data-bs-tooltip data-bs-title='Скачать'>
                          <a class="text-body" href="/ru/articles/2023/10/52d75b90-0637-5ba6-91d6-b1bff40e1d67/pwsh.disk.erase.ps1" download
                             role="button" aria-label='Скачать'>
                            <i class="fas fa-download fa-fw"></i>
                          </a>
                        </li>
                        <li class="list-inline-item" data-bs-tooltip data-bs-title='Открыть'>
                          <a class="text-body" href="/ru/articles/2023/10/52d75b90-0637-5ba6-91d6-b1bff40e1d67/pwsh.disk.erase.ps1" target="_blank"
                             role="button" aria-label='Открыть'>
                            <i class="fas fa-arrow-up-right-from-square fa-fw"></i>
                          </a>
                        </li>
                      </ul>
                    </div>
                  </div>
                </div>
                <div class="card-body" id="cp-3612e319b8800b8d5bf6db79c7fc01ee">
                    
                        
                    
                  <pre><code class="language-ps1">&lt;#PSScriptInfo
  .VERSION      0.1.0
  .GUID         8d95f4d5-4d14-412c-9fa4-b75ebe79df09
  .AUTHOR       Kai Kimera
  .AUTHOREMAIL  mail@kai.kim
  .COMPANYNAME  Library Online
  .COPYRIGHT    2023 Library Online. All rights reserved.
  .LICENSEURI   https://choosealicense.com/licenses/mit/
  .PROJECTURI   https://lib.onl/ru/articles/2023/10/52d75b90-0637-5ba6-91d6-b1bff40e1d67/
#&gt;

#Requires -Version 7.2
#Requires -RunAsAdministrator

&lt;#
  .SYNOPSIS
  Disk erase script.

  .DESCRIPTION
  Disk cleanup followed by partition creation.

  .PARAMETER P_DiskNumber
  Specifies the disk number of the disk on which to perform the clear operation. For a list of available disks, see the &#39;Get-Disk&#39; cmdlet.

  .PARAMETER P_FileSystem
  Specifies the file system with which to format the volume.
  The acceptable values for this parameter are: &#39;NTFS&#39;, &#39;ReFS&#39;, &#39;exFAT&#39;, &#39;FAT32&#39; and &#39;FAT&#39;.

  .PARAMETER P_Sleep
  Sleep time (in seconds).

  .EXAMPLE
  .\pwsh.disk.erase.ps1 -DN 3 -DL &#39;E&#39; -FS &#39;NTFS&#39; -FSL &#39;USB-SSD&#39;

  .LINK
  https://lib.onl/ru/articles/2023/10/52d75b90-0637-5ba6-91d6-b1bff40e1d67/
#&gt;

# -------------------------------------------------------------------------------------------------------------------- #
# CONFIGURATION.
# -------------------------------------------------------------------------------------------------------------------- #

Param(
  [Parameter(HelpMessage=&#34;Specify the disk number.&#34;)]
  [ValidatePattern(&#39;^[0-9]&#43;$&#39;)]
  [Alias(&#39;DN&#39;)][int]$P_DiskNumber,

  [Parameter(HelpMessage=&#34;Specify the file system to format the volume.&#34;)]
  [ValidateSet(&#39;FAT&#39;, &#39;FAT32&#39;, &#39;exFAT&#39;, &#39;NTFS&#39;, &#39;ReFS&#39;)]
  [Alias(&#39;FS&#39;)][string]$P_FileSystem,

  [Parameter(HelpMessage=&#34;Sleep time (in seconds).&#34;)]
  [Alias(&#39;S&#39;)][int]$P_Sleep = 2
)

# New line separator.
$NL = &#34;$([Environment]::NewLine)&#34;

# Random number.
$Random = &#34;$(Get-Random -Minimum 1000 -Maximum 9999)&#34;

# Getting free drive letter and to assign to the new partition.
$DriveLetter = &#34;$((68..90 | ForEach-Object { $L=[char]$_; if ((Get-PSDrive).Name -notContains $L) { $L } })[0])&#34;

# Specifying a new label to use for the volume.
$FileSystemLabel = &#34;DISK_${Random}&#34;

# -------------------------------------------------------------------------------------------------------------------- #
# INITIALIZATION.
# -------------------------------------------------------------------------------------------------------------------- #

function Start-Script() {
  Start-DPDiskList        # Showing disk list.
  if (-not $P_DiskNumber) { $P_DiskNumber = (Read-Host -Prompt &#39;Disk number&#39;) }   # Getting disk number.
  if (-not $P_FileSystem) { $P_FileSystem = (Read-Host -Prompt &#39;File system&#39;) }   # Getting file system.
  Start-DPDiskClear       # Starting clearing disk.
  Start-DPDiskInit        # Initializing disk.
  Start-DPDiskPartition   # Creating partition.
  Start-DPDiskFormat      # Formatting volume.
}

# -------------------------------------------------------------------------------------------------------------------- #
# DISK LIST.
# -------------------------------------------------------------------------------------------------------------------- #

function Start-DPDiskList() {
  Write-Msg -T &#39;HL&#39; -M &#39;Disk List&#39;
  Get-Disk
}

# -------------------------------------------------------------------------------------------------------------------- #
# CLEAR DISK.
# -------------------------------------------------------------------------------------------------------------------- #

function Start-DPDiskClear() {
  Write-Msg -T &#39;HL&#39; -M &#34;[DISK #${P_DiskNumber}] Clear Disk&#34;
  Write-Msg -T &#39;W&#39; -A &#39;Inquire&#39; -M (&#34;You specified drive number &#39;${P_DiskNumber}&#39;.${NL}&#34; &#43;
  &#34;All data will be DELETED!&#34;)

  $Param = @{
    Number = $P_DiskNumber
    RemoveData = $true
    RemoveOEM = $true
    Confirm = $false
  }

  Clear-Disk @Param
  Start-Sleep -s $P_Sleep
}

# -------------------------------------------------------------------------------------------------------------------- #
# INITIALIZE DISK.
# -------------------------------------------------------------------------------------------------------------------- #

function Start-DPDiskInit() {
  Write-Msg -T &#39;HL&#39; -M &#34;[DISK #${P_DiskNumber}] Initialize Disk&#34;

  $Param = @{
    Number = $P_DiskNumber
    PartitionStyle = &#39;GPT&#39;
  }

  Initialize-Disk @Param
  Start-Sleep -s $P_Sleep
}

# -------------------------------------------------------------------------------------------------------------------- #
# CREATE PARTITION.
# -------------------------------------------------------------------------------------------------------------------- #

function Start-DPDiskPartition() {
  Write-Msg -T &#39;HL&#39; -M &#34;[DISK #${P_DiskNumber}] Create Partition&#34;

  $Param = @{
    DiskNumber = $P_DiskNumber
    DriveLetter = &#34;${DriveLetter}&#34;
    UseMaximumSize = $true
  }

  New-Partition @Param
  Start-Sleep -s $P_Sleep
}

# -------------------------------------------------------------------------------------------------------------------- #
# FORMAT DISK VOLUME.
# -------------------------------------------------------------------------------------------------------------------- #

function Start-DPDiskFormat() {
  Write-Msg -T &#39;HL&#39; -M &#34;[DISK #${P_DiskNumber}] Format Disk Volume (${DriveLetter} / ${P_FileSystem})&#34;

  if (-not $P_FileSystem) { $P_FileSystem = &#39;NTFS&#39; }

  $Param = @{
    DriveLetter = &#34;${DriveLetter}&#34;
    FileSystem = &#34;${P_FileSystem}&#34;
    NewFileSystemLabel = &#34;${FileSystemLabel}&#34;
    Force = $true
  }

  Format-Volume @Param
  Start-Sleep -s $P_Sleep
}

# -------------------------------------------------------------------------------------------------------------------- #
# ------------------------------------------------&lt; COMMON FUNCTIONS &gt;------------------------------------------------ #
# -------------------------------------------------------------------------------------------------------------------- #

# -------------------------------------------------------------------------------------------------------------------- #
# SYSTEM MESSAGES.
# -------------------------------------------------------------------------------------------------------------------- #

function Write-Msg() {
  param (
    [Alias(&#39;T&#39;)][string]$Type,
    [Alias(&#39;M&#39;)][string]$Message,
    [Alias(&#39;A&#39;)][string]$Action = &#39;Continue&#39;
  )

  switch ($Type) {
    &#39;HL&#39;    { Write-Host &#34;${NL}--- ${Message}&#34;.ToUpper() -ForegroundColor Blue }
    &#39;I&#39;     { Write-Information -MessageData &#34;${Message}&#34; -InformationAction &#34;${Action}&#34; }
    &#39;W&#39;     { Write-Warning -Message &#34;${Message}&#34; -WarningAction &#34;${Action}&#34; }
    &#39;E&#39;     { Write-Error -Message &#34;${Message}&#34; -ErrorAction &#34;${Action}&#34; }
    default { Write-Host &#34;${Message}&#34; }
  }
}

# -------------------------------------------------------------------------------------------------------------------- #
# -------------------------------------------------&lt; RUNNING SCRIPT &gt;------------------------------------------------- #
# -------------------------------------------------------------------------------------------------------------------- #

Start-Script</code></pre>
                </div>
              </div>
            </div>]]></turbo:content></item><item turbo="true"><title>PowerShell: Сжатие видео при помощи FFmpeg</title><link>https://lib.onl/ru/articles/2023/10/2a73410a-6611-570c-9ab4-dc8cc8998146/</link><pubDate>Sun, 22 Oct 2023 14:06:44 +0000</pubDate><dc:creator>Kai Kimera</dc:creator><category>MS Windows</category><category>Терминал</category><category>Скрипты</category><yandex:related><link url="https://lib.onl/ru/articles/2023/10/0028821e-c96c-5014-a1dd-8963c161b170/">PowerShell: Определение разрядности ОС Windows</link><link url="https://lib.onl/ru/articles/2023/10/4c7aba7c-f5a6-589a-9975-fdb16f2e2862/">PowerShell Vault</link><link url="https://lib.onl/ru/articles/2023/10/eb39e3f7-b194-53d4-8bad-01edf9fdac47/">Дефрагментация в ОС Windows</link><link url="https://lib.onl/ru/articles/2023/10/75075788-9308-56b7-b531-2008cb35f7d0/">Установка сертификата НУЦ Минцифры</link><link url="https://lib.onl/ru/articles/2022/05/36058650-3f35-5ed5-9565-0aa7d8800c28/">Windows Server 2022 для рабочей станции</link></yandex:related><turbo:extendedHtml>true</turbo:extendedHtml><turbo:source>https://lib.onl/ru/articles/2023/10/2a73410a-6611-570c-9ab4-dc8cc8998146/</turbo:source><turbo:topic>PowerShell: Сжатие видео при помощи FFmpeg</turbo:topic><turbo:content><![CDATA[<p>Когда то в далёкой далёкой галактике&hellip; Ко мне на работе обратились с просьбой как то уменьшить видео, записанное на камеру в формате <code>.mov</code>. Естественно, я воспользовался библиотекой <span class="shortcode shortcode-tag"><a href="/ru/tags/ffmpeg/" target="_blank">#FFmpeg</a></span>. Но скрипт автоматизации решил написать только сейчас&hellip;</p>
<p>Скрипт прост как лапоть. Состоит из небольшого количества вводных параметров, большинство из которых изменять не требуется. Предназначен скрипт для быстрого пакетного конвертирования файлов видео из одного формата в другой, в основном, с целью уменьшения размера. Скрипт не предназначен для сложного редактирования видео!</p>
<h2 id="параметры">
  <a class="link-body-emphasis" href="#%d0%bf%d0%b0%d1%80%d0%b0%d0%bc%d0%b5%d1%82%d1%80%d1%8b">Параметры</a>
</h2><ul>
<li><code>-F</code> <code>-Files</code> - массив входящих файлов.</li>
<li><code>-CV</code> <code>-vCodec</code> - видео кодек, используемый для конвертации. По умолчанию: <code>libx265</code>. Поддерживаемые кодеки:
<ul>
<li><code>'libx264'</code> - кодек &ldquo;H.264&rdquo;.</li>
<li><code>'libx265'</code> - кодек &ldquo;H.265&rdquo;.</li>
<li><code>'libvpx-vp9'</code> - кодек &ldquo;VP9&rdquo; (&ldquo;WebM&rdquo;).</li>
<li><code>'libaom-av1'</code> - кодек &ldquo;AV1&rdquo;.</li>
</ul>
</li>
<li><code>-CA</code> <code>-aCodec</code> - аудио кодек, используемый для конвертации. По умолчанию: <code>copy</code>. Поддерживаемые кодеки:
<ul>
<li><code>'libfdk_aac'</code> - кодек &ldquo;Fraunhofer FDK AAC&rdquo;.</li>
<li><code>'aac'</code> - кодек &ldquo;FFmpeg AAC&rdquo;.</li>
<li><code>'libmp3lame'</code> - кодек &ldquo;FFmpeg MP3&rdquo;.</li>
</ul>
</li>
<li><code>-R</code> <code>-Framerate</code> - частота кадров выходящего файла (FPS). Сжатие кадров с учётом движения, где сцены движения кодируются с меньшим качеством, чем статичные сцены, что субъективно приводит к восприятию, как качественного, ибо визуально человек различает больше деталей в неподвижных объектах, чем в движущихся. Если параметр не указан, то значение берётся из входящего файла.</li>
<li><code>-C</code> <code>-CRF</code> - постоянный коэффициент потока (Constant Rate Factor). Это режим кодирования для кодеков &ldquo;H.264&rdquo; и &ldquo;H.265&rdquo; с постоянным воспринимаемым качеством, осуществляемый с помощью настройки качества (и управления скоростью). Если параметр не указан, то значение берётся по умолчанию, обычно это <code>28</code> при кодеке <code>libx265</code> и <code>23</code> при <code>libx264</code>.</li>
<li><code>-P</code> <code>-Preset</code> - пресеты. Это набор параметров, которые обеспечивают определённую скорость кодирования с степень сжатия. У каждого кодека видео свой набор пресетов. Нужно смотреть <a title="" href="https://trac.ffmpeg.org/wiki" target="_blank" rel="noopener noreferrer">документацию</a>.</li>
<li><code>-EXT</code> <code>-Extension</code> - расширение выходящих файлов.</li>
</ul>
<h2 id="примеры">
  <a class="link-body-emphasis" href="#%d0%bf%d1%80%d0%b8%d0%bc%d0%b5%d1%80%d1%8b">Примеры</a>
</h2><p>Конвертировать файлы <code>file_01.mov</code>, <code>file_02.mov</code> и <code>file_03.mov</code> в формат <code>mp4</code>:</p>






<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-1 shortcode-codeblock-terminal
shortcode-codeblock-terminal-windows shortcode-codeblock-terminal-windows-user">
  <div class="card overflow-hidden" data-bs-theme="dark">
    <div class="card-header">
      <div class="d-flex align-items-center">
        <div class="flex-shrink-0 ">
          <i class="fas fa-terminal fa-fw"></i>
        </div>
        <div class="flex-grow-1 mx-2">
          <h5 class="mb-0">Терминал</h5>
        </div>
        <div class="flex-shrink-0">
          <ul class="list-inline mb-0">
            <li class="list-inline-item" data-bs-tooltip data-bs-title='Копировать'>
              <a class="text-body" href="#"
                 data-fn="clipboard preventDefault" data-clipboard-target="#cp-ffd530a9538c20f6f108d2838d101e79"
                 role="button" aria-label='Копировать'>
                <i class="fas fa-copy fa-fw"></i>
              </a>
            </li>
          </ul>
        </div>
      </div>
    </div>
    <div class="card-body p-0" id="cp-ffd530a9538c20f6f108d2838d101e79">
      <pre><code class="language-plaintext">Compress-Video -F &#39;file_01.mov&#39;, &#39;file_02.mov&#39;, &#39;file_03.mov&#39;</code></pre>
    </div>
  </div>
</div>

<p>Пакетная конвертация всех файлов с расширением <code>.mov</code> в формат <code>mp4</code>:</p>






<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-2 shortcode-codeblock-terminal
shortcode-codeblock-terminal-windows shortcode-codeblock-terminal-windows-user">
  <div class="card overflow-hidden" data-bs-theme="dark">
    <div class="card-header">
      <div class="d-flex align-items-center">
        <div class="flex-shrink-0 ">
          <i class="fas fa-terminal fa-fw"></i>
        </div>
        <div class="flex-grow-1 mx-2">
          <h5 class="mb-0">Терминал</h5>
        </div>
        <div class="flex-shrink-0">
          <ul class="list-inline mb-0">
            <li class="list-inline-item" data-bs-tooltip data-bs-title='Копировать'>
              <a class="text-body" href="#"
                 data-fn="clipboard preventDefault" data-clipboard-target="#cp-b651f607d7dbc4402152d493b1c9b2be"
                 role="button" aria-label='Копировать'>
                <i class="fas fa-copy fa-fw"></i>
              </a>
            </li>
          </ul>
        </div>
      </div>
    </div>
    <div class="card-body p-0" id="cp-b651f607d7dbc4402152d493b1c9b2be">
      <pre><code class="language-plaintext">Compress-Video -F &#39;*.mov&#39;</code></pre>
    </div>
  </div>
</div>

<h2 id="алгоритм-работы">
  <a class="link-body-emphasis" href="#%d0%b0%d0%bb%d0%b3%d0%be%d1%80%d0%b8%d1%82%d0%bc-%d1%80%d0%b0%d0%b1%d0%be%d1%82%d1%8b">Алгоритм работы</a>
</h2><p>Скрипт предназначен для быстрого пакетного преобразования файлов видео из одного формата в другой.</p>




    








    
    






<div class="shortcode shortcode-alert">
  <div class="alert alert-warning d-flex overflow-hidden" role="alert">
    <div class="flex-shrink-0 align-self-center">
      <i class="fas fa-exclamation-triangle fa-fw fa-2x"></i>
    </div>
    <div class="flex-grow-1 ms-3 overflow-hidden">
        <p>Для работы скрипта необходим файл <code>ffmpeg.exe</code>, архив которого можно скачать с сайта <a title="" href="https://www.gyan.dev/ffmpeg/builds/" target="_blank" rel="noopener noreferrer">gyan.dev</a>, распаковать и разместить рядом с файлом скрипта или в любую дочернюю директорию. Скрипт сам найдёт файл <code>ffmpeg.exe</code> и начнёт его использовать.</p>

    </div>
  </div>
</div>

<h2 id="скрипт">
  <a class="link-body-emphasis" href="#%d1%81%d0%ba%d1%80%d0%b8%d0%bf%d1%82">Скрипт</a>
</h2>

    <div class="shortcode shortcode-gh-repo mb-3">
      <div class="row row-cols-1 row-cols-lg-2 g-3">
          
            <div class="col gh-repo" data-repos="pkgstore/pwsh-ffmpeg">
              <div class="card">
                <div class="row g-0">
                  <div class="col-md-4 p-1">
                    <a class="d-block gh-repo-avatar"
                       href="https://github.com/pkgstore/pwsh-ffmpeg" target="_blank"
                       rel="noopener noreferrer nofollow">
                      <img class="card-img gh-repo-avatar"
                           src="https://github.com/identicons/pkgstore.png"
                           alt="pkgstore/pwsh-ffmpeg" loading="lazy"/>
                    </a>
                  </div>
                  <div class="col">
                    <div class="card-body h-100">
                      <div class="d-flex flex-column h-100">
                        <div class="flex-shrink-0">
                          <h5 class="card-title">
                            <a class="gh-repo-name"
                               href="https://github.com/pkgstore/pwsh-ffmpeg" target="_blank"
                               rel="noopener noreferrer nofollow">pkgstore/pwsh-ffmpeg</a>
                          </h5>
                          <h6 class="card-subtitle mb-2 text-body-secondary gh-repo-owner"></h6>
                          <p class="card-text gh-repo-description"></p>
                        </div>
                        <div class="mt-auto">
                          <div class="row row-cols-auto g-2 mt-3">
                            <div class="col">
                              <div class="btn btn-light btn-sm"
                                   data-bs-tooltip data-bs-title='Язык разработки'>
                                <i class="fas fa-code fa-fw me-1"></i>
                                <span class="gh-repo-language">#</span>
                              </div>
                            </div>
                            <div class="col">
                              <div class="btn btn-light btn-sm"
                                   data-bs-tooltip data-bs-title='Подписки'>
                                <i class="fas fa-eye fa-fw me-1"></i>
                                <span class="gh-repo-subscribers">#</span>
                              </div>
                            </div>
                            <div class="col">
                              <div class="btn btn-light btn-sm"
                                   data-bs-tooltip data-bs-title='Звёзды'>
                                <i class="fas fa-star fa-fw me-1"></i>
                                <span class="gh-repo-stars">#</span>
                              </div>
                            </div>
                            <div class="col">
                              <div class="btn btn-light btn-sm"
                                   data-bs-tooltip data-bs-title='Вилки'>
                                <i class="fas fa-code-branch fa-fw me-1"></i>
                                <span class="gh-repo-forks">#</span>
                              </div>
                            </div>
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          
      </div>
    </div>]]></turbo:content></item><item turbo="true"><title>PowerShell: Определение разрядности ОС Windows</title><link>https://lib.onl/ru/articles/2023/10/0028821e-c96c-5014-a1dd-8963c161b170/</link><pubDate>Sat, 21 Oct 2023 17:42:05 +0000</pubDate><dc:creator>Kai Kimera</dc:creator><category>MS Windows</category><category>Терминал</category><yandex:related><link url="https://lib.onl/ru/articles/2023/10/4c7aba7c-f5a6-589a-9975-fdb16f2e2862/">PowerShell Vault</link><link url="https://lib.onl/ru/articles/2023/10/eb39e3f7-b194-53d4-8bad-01edf9fdac47/">Дефрагментация в ОС Windows</link><link url="https://lib.onl/ru/articles/2023/10/75075788-9308-56b7-b531-2008cb35f7d0/">Установка сертификата НУЦ Минцифры</link><link url="https://lib.onl/ru/articles/2022/05/36058650-3f35-5ed5-9565-0aa7d8800c28/">Windows Server 2022 для рабочей станции</link></yandex:related><turbo:extendedHtml>true</turbo:extendedHtml><turbo:source>https://lib.onl/ru/articles/2023/10/0028821e-c96c-5014-a1dd-8963c161b170/</turbo:source><turbo:topic>PowerShell: Определение разрядности ОС Windows</turbo:topic><turbo:content><![CDATA[<p>Нашёл на Stack Overflow хорошую функцию по определению разрядности ОС и процесса <span class="shortcode shortcode-tag"><a href="/ru/tags/powershell/" target="_blank">#PowerShell</a></span>. Запишу, обязательно пригодится.</p>
<h2 id="разрядность-ос">
  <a class="link-body-emphasis" href="#%d1%80%d0%b0%d0%b7%d1%80%d1%8f%d0%b4%d0%bd%d0%be%d1%81%d1%82%d1%8c-%d0%be%d1%81">Разрядность ОС</a>
</h2><p>Разрядность ОС можно определить следующей функцией:</p>



<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-1 shortcode-codeblock-powershell">
  <div class="d-flex overflow-hidden">
    <div class="flex-grow-1 rounded overflow-hidden" id="cp-d53dc3e2d8a94fd7e1a9ba56d2807b56">
      
      <pre><code class='language-powershell'>function Get-Architecture {
  # What bitness does Windows use.
  switch ([Environment]::Is64BitOperatingSystem) { # Needs &#39;.NET 4&#39;.
    $true   { 64; break }
    $false  { 32; break }
    default {
      (Get-WmiObject -Class Win32_OperatingSystem).OSArchitecture -replace &#39;\D&#39;
      # Or do any of these:
      # (Get-WmiObject -Class Win32_ComputerSystem).SystemType -replace &#39;\D&#39; -replace &#39;86&#39;, &#39;32&#39;
      # (Get-WmiObject -Class Win32_Processor).AddressWidth # This is slow...
    }
  }
}</code></pre>
    </div>
    <div class="flex-shrink-0">
      <ul class="list-inline mb-0">
        <li class="list-inline-item" data-bs-tooltip data-bs-title='Копировать'>
          <a class="text-body" href="#"
             data-fn="clipboard preventDefault" data-clipboard-target="#cp-d53dc3e2d8a94fd7e1a9ba56d2807b56"
             role="button" aria-label='Копировать'>
            <i class="fas fa-copy fa-fw"></i>
          </a>
        </li>
      </ul>
    </div>
  </div>
</div>

<p>Можно записать эту функцию в файл и запустить файл в терминале, или же внедрить в крупный проект и вызывать по имени <code>Get-Architecture</code>.</p>
<h3 id="результат">
  <a class="link-body-emphasis" href="#%d1%80%d0%b5%d0%b7%d1%83%d0%bb%d1%8c%d1%82%d0%b0%d1%82">Результат</a>
</h3>





<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-2 shortcode-codeblock-terminal
shortcode-codeblock-terminal-windows shortcode-codeblock-terminal-windows-user">
  <div class="card overflow-hidden" data-bs-theme="dark">
    <div class="card-header">
      <div class="d-flex align-items-center">
        <div class="flex-shrink-0 ">
          <i class="fas fa-terminal fa-fw"></i>
        </div>
        <div class="flex-grow-1 mx-2">
          <h5 class="mb-0">Терминал</h5>
        </div>
        <div class="flex-shrink-0">
          <ul class="list-inline mb-0">
            <li class="list-inline-item" data-bs-tooltip data-bs-title='Копировать'>
              <a class="text-body" href="#"
                 data-fn="clipboard preventDefault" data-clipboard-target="#cp-7aa9efd0ea3604c9885d9df913083449"
                 role="button" aria-label='Копировать'>
                <i class="fas fa-copy fa-fw"></i>
              </a>
            </li>
          </ul>
        </div>
      </div>
    </div>
    <div class="card-body p-0" id="cp-7aa9efd0ea3604c9885d9df913083449">
      <pre><code class="language-plaintext">.\arch.ps1
64</code></pre>
    </div>
  </div>
</div>

<h2 id="разрядность-ос-и-powershell">
  <a class="link-body-emphasis" href="#%d1%80%d0%b0%d0%b7%d1%80%d1%8f%d0%b4%d0%bd%d0%be%d1%81%d1%82%d1%8c-%d0%be%d1%81-%d0%b8-powershell">Разрядность ОС и PowerShell</a>
</h2><p>Расширенная версия, которая позволяет определить разрядность ОС и процесса PowerShell, под которым выполняется функция.</p>



<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-3 shortcode-codeblock-powershell">
  <div class="d-flex overflow-hidden">
    <div class="flex-grow-1 rounded overflow-hidden" id="cp-a6746996a7ec075e0c4255ba8f2ac198">
      
      <pre><code class='language-powershell'>function Get-Architecture {
  # What bitness does Windows use.
  $windowsBitness = switch ([Environment]::Is64BitOperatingSystem) { # Needs &#39;.NET 4&#39;.
    $true   { 64; break }
    $false  { 32; break }
    default {
      (Get-WmiObject -Class Win32_OperatingSystem).OSArchitecture -replace &#39;\D&#39;
      # Or do any of these:
      # (Get-WmiObject -Class Win32_ComputerSystem).SystemType -replace &#39;\D&#39; -replace &#39;86&#39;, &#39;32&#39;
      # (Get-WmiObject -Class Win32_Processor).AddressWidth # Slow...
    }
  }

  # What bitness does this PowerShell process use.
  $processBitness = [IntPtr]::Size * 8
  # Or do any of these:
  # $processBitness = $env:PROCESSOR_ARCHITECTURE -replace &#39;\D&#39; -replace &#39;86|ARM&#39;, &#39;32&#39;
  # $processBitness = if ([Environment]::Is64BitProcess) { 64 } else { 32 }

  # Return the info as object.
  New-Object -TypeName PSObject -Property @{
    &#39;ProcessArchitecture&#39; = &#34;{0} bit&#34; -f $processBitness
    &#39;WindowsArchitecture&#39; = &#34;{0} bit&#34; -f $windowsBitness
  }
}</code></pre>
    </div>
    <div class="flex-shrink-0">
      <ul class="list-inline mb-0">
        <li class="list-inline-item" data-bs-tooltip data-bs-title='Копировать'>
          <a class="text-body" href="#"
             data-fn="clipboard preventDefault" data-clipboard-target="#cp-a6746996a7ec075e0c4255ba8f2ac198"
             role="button" aria-label='Копировать'>
            <i class="fas fa-copy fa-fw"></i>
          </a>
        </li>
      </ul>
    </div>
  </div>
</div>

<p>Можно записать эту функцию в файл и запустить файл в терминале, или же внедрить в крупный проект и вызывать по имени <code>Get-Architecture</code>.</p>
<h3 id="результат-1">
  <a class="link-body-emphasis" href="#%d1%80%d0%b5%d0%b7%d1%83%d0%bb%d1%8c%d1%82%d0%b0%d1%82-1">Результат</a>
</h3>





<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-4 shortcode-codeblock-terminal
shortcode-codeblock-terminal-windows shortcode-codeblock-terminal-windows-user">
  <div class="card overflow-hidden" data-bs-theme="dark">
    <div class="card-header">
      <div class="d-flex align-items-center">
        <div class="flex-shrink-0 ">
          <i class="fas fa-terminal fa-fw"></i>
        </div>
        <div class="flex-grow-1 mx-2">
          <h5 class="mb-0">Терминал</h5>
        </div>
        <div class="flex-shrink-0">
          <ul class="list-inline mb-0">
            <li class="list-inline-item" data-bs-tooltip data-bs-title='Копировать'>
              <a class="text-body" href="#"
                 data-fn="clipboard preventDefault" data-clipboard-target="#cp-f05e48b33f9d205e2dd0cb4c70c49eef"
                 role="button" aria-label='Копировать'>
                <i class="fas fa-copy fa-fw"></i>
              </a>
            </li>
          </ul>
        </div>
      </div>
    </div>
    <div class="card-body p-0" id="cp-f05e48b33f9d205e2dd0cb4c70c49eef">
      <pre><code class="language-plaintext">.\arch.ps1

ProcessArchitecture WindowsArchitecture
------------------- -------------------
64 bit              64 bit</code></pre>
    </div>
  </div>
</div>]]></turbo:content></item><item turbo="true"><title>PowerShell Vault</title><link>https://lib.onl/ru/articles/2023/10/4c7aba7c-f5a6-589a-9975-fdb16f2e2862/</link><pubDate>Fri, 20 Oct 2023 09:57:21 +0000</pubDate><dc:creator>Kai Kimera</dc:creator><category>MS Windows</category><category>Терминал</category><category>Скрипты</category><yandex:related><link url="https://lib.onl/ru/articles/2023/10/eb39e3f7-b194-53d4-8bad-01edf9fdac47/">Дефрагментация в ОС Windows</link><link url="https://lib.onl/ru/articles/2023/10/75075788-9308-56b7-b531-2008cb35f7d0/">Установка сертификата НУЦ Минцифры</link><link url="https://lib.onl/ru/articles/2022/05/36058650-3f35-5ed5-9565-0aa7d8800c28/">Windows Server 2022 для рабочей станции</link></yandex:related><turbo:extendedHtml>true</turbo:extendedHtml><turbo:source>https://lib.onl/ru/articles/2023/10/4c7aba7c-f5a6-589a-9975-fdb16f2e2862/</turbo:source><turbo:topic>PowerShell Vault</turbo:topic><turbo:content><![CDATA[<p>На работе в локальной сети использовалась задача, которая перемещала старые, по долгу не использовавшиеся, файлы из главного файлового хранилища в резервное. Но так как организация являлась проектной, то старые файлы могли понадобиться в любое время.</p>
<p>Задача использовала простой скрипт с фильтрацией файлов по параметрам <em>время создания</em> и <em>время изменения</em>. Я чуть доработали скрипт и решил опубликовать его для других администраторов. Вдруг, пригодится. Только перед использованием прошу проверить скрипт в какой-нибудь песочнице.</p>




    












    
    


<div class="shortcode shortcode-alert">
  <div class="alert alert-danger d-flex overflow-hidden" role="alert">
    <div class="flex-shrink-0 align-self-center">
      <i class="fas fa-circle-radiation fa-fw fa-2x"></i>
    </div>
    <div class="flex-grow-1 ms-3 overflow-hidden">
        <p>Есть вероятность, что скрипт удалит все файлы в вашем файловом хранилище, из-за того, что автор может оказаться <em>рукожопом</em>! Поэтому, перед боевой задачей, проверьте скрипт в какой-нибудь песочнице. А кто хорошо разбирается в <!-- raw HTML omitted --><!-- raw HTML omitted -->#PowerShell<!-- raw HTML omitted --><!-- raw HTML omitted --> - автор будет благодарен за оптимизацию и корректировку скрипта.</p>

    </div>
  </div>
</div>

<h2 id="параметры">
  <a class="link-body-emphasis" href="#%d0%bf%d0%b0%d1%80%d0%b0%d0%bc%d0%b5%d1%82%d1%80%d1%8b">Параметры</a>
</h2><ul>
<li><code>-M</code> <code>-Mode</code> - режим работы скрипта. По умолчанию <code>'MV'</code>.
<ul>
<li><code>'CP'</code> - копировать файлы из источника в хранилище.</li>
<li><code>'MV'</code> - перемещать файлы из источника в хранилище.</li>
<li><code>'RM'</code> - только удалять файлы из источника без копирования или перемещения куда-либо.</li>
</ul>
</li>
<li><code>-SRC</code> <code>-Source</code> - путь к директории откуда перемещать файлы. Например, <code>-SRC 'C:\Data\Source'</code>. По умолчанию: <code>${PSScriptRoot}\Source</code>.</li>
<li><code>-DST</code> <code>-Vault</code> - путь к директории куда перемещать файлы. Например, <code>-DST 'C:\Data\Vault'</code>. По умолчанию: <code>${PSScriptRoot}\Vault</code>.</li>
<li><code>-CT</code> <code>-CreationTime</code> - время создания файла в секундах. Например, <code>-CT 5270400</code>. По умолчанию: <code>5270400</code> (61 день).</li>
<li><code>-WT</code> <code>-LastWriteTime</code> - время изменения файла в секундах. Например, <code>-WT 5270400</code>. По умолчанию: <code>${P_CreationTime}</code>.</li>
<li><code>-FS</code> <code>-FileSize</code> - размер файла. Например, <code>-FS '5kb'</code> или <code>-FS '12mb'</code>. По умолчанию: <code>'0kb'</code>.</li>
<li><code>-E</code> <code>-Exclude</code> - путь к файлу с исключениями. Например, <code>-E 'C:\Data\exclude.txt'</code>. По умолчанию: <code>${PSScriptRoot}\vault.exclude.txt</code>.</li>
<li><code>-L</code> <code>-Logs</code> - путь к директории с журналами работы скрипта. Например, <code>-L 'C:\Data\Logs'</code>. По умолчанию: <code>${PSScriptRoot}\Logs</code>.</li>
<li><code>-RD</code> <code>-RemoveDirs</code> - удалять пустые каталоги.</li>
<li><code>-O</code> <code>-Overwrite</code> - перезаписать файлы в Vault.</li>
</ul>
<h2 id="примеры">
  <a class="link-body-emphasis" href="#%d0%bf%d1%80%d0%b8%d0%bc%d0%b5%d1%80%d1%8b">Примеры</a>
</h2><p>Запустить перемещение файлов из <code>Source</code> в <code>Vault</code> с сохранением структуры директорий:</p>






<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-1 shortcode-codeblock-terminal
shortcode-codeblock-terminal-windows shortcode-codeblock-terminal-windows-user">
  <div class="card overflow-hidden" data-bs-theme="dark">
    <div class="card-header">
      <div class="d-flex align-items-center">
        <div class="flex-shrink-0 ">
          <i class="fas fa-terminal fa-fw"></i>
        </div>
        <div class="flex-grow-1 mx-2">
          <h5 class="mb-0">Терминал</h5>
        </div>
        <div class="flex-shrink-0">
          <ul class="list-inline mb-0">
            <li class="list-inline-item" data-bs-tooltip data-bs-title='Копировать'>
              <a class="text-body" href="#"
                 data-fn="clipboard preventDefault" data-clipboard-target="#cp-2632b4caca97fae7357c2d04165221c1"
                 role="button" aria-label='Копировать'>
                <i class="fas fa-copy fa-fw"></i>
              </a>
            </li>
          </ul>
        </div>
      </div>
    </div>
    <div class="card-body p-0" id="cp-2632b4caca97fae7357c2d04165221c1">
      <pre><code class="language-plaintext">Start-Vault -SRC &#39;C:\Data\Source&#39; -DST &#39;C:\Data\Vault&#39;</code></pre>
    </div>
  </div>
</div>

<p>Запустить перемещение файлов с временем создания и изменения от 10 дней (<code>864000</code>) из <code>Source</code> в <code>Vault</code> с сохранением структуры директорий:</p>






<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-2 shortcode-codeblock-terminal
shortcode-codeblock-terminal-windows shortcode-codeblock-terminal-windows-user">
  <div class="card overflow-hidden" data-bs-theme="dark">
    <div class="card-header">
      <div class="d-flex align-items-center">
        <div class="flex-shrink-0 ">
          <i class="fas fa-terminal fa-fw"></i>
        </div>
        <div class="flex-grow-1 mx-2">
          <h5 class="mb-0">Терминал</h5>
        </div>
        <div class="flex-shrink-0">
          <ul class="list-inline mb-0">
            <li class="list-inline-item" data-bs-tooltip data-bs-title='Копировать'>
              <a class="text-body" href="#"
                 data-fn="clipboard preventDefault" data-clipboard-target="#cp-a8f6199993aa6ffb5d0a9313e2a19ce7"
                 role="button" aria-label='Копировать'>
                <i class="fas fa-copy fa-fw"></i>
              </a>
            </li>
          </ul>
        </div>
      </div>
    </div>
    <div class="card-body p-0" id="cp-a8f6199993aa6ffb5d0a9313e2a19ce7">
      <pre><code class="language-plaintext">Start-Vault -SRC &#39;C:\Data\Source&#39; -DST &#39;C:\Data\Vault&#39; -CT &#39;864000&#39; -WT &#39;864000&#39;</code></pre>
    </div>
  </div>
</div>

<p>Запустить перемещение файлов с временем создания и изменения от 10 дней (<code>864000</code>) и размером более 32 мегабайта (<code>32mb</code>) из <code>Source</code> в <code>Vault</code> с сохранением структуры директорий:</p>






<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-3 shortcode-codeblock-terminal
shortcode-codeblock-terminal-windows shortcode-codeblock-terminal-windows-user">
  <div class="card overflow-hidden" data-bs-theme="dark">
    <div class="card-header">
      <div class="d-flex align-items-center">
        <div class="flex-shrink-0 ">
          <i class="fas fa-terminal fa-fw"></i>
        </div>
        <div class="flex-grow-1 mx-2">
          <h5 class="mb-0">Терминал</h5>
        </div>
        <div class="flex-shrink-0">
          <ul class="list-inline mb-0">
            <li class="list-inline-item" data-bs-tooltip data-bs-title='Копировать'>
              <a class="text-body" href="#"
                 data-fn="clipboard preventDefault" data-clipboard-target="#cp-c623222ec3469344e785bce3ec07781d"
                 role="button" aria-label='Копировать'>
                <i class="fas fa-copy fa-fw"></i>
              </a>
            </li>
          </ul>
        </div>
      </div>
    </div>
    <div class="card-body p-0" id="cp-c623222ec3469344e785bce3ec07781d">
      <pre><code class="language-plaintext">Start-Vault -SRC &#39;C:\Data\Source&#39; -DST &#39;C:\Data\Vault&#39; -CT &#39;864000&#39; -WT &#39;864000&#39; -FS &#39;32mb&#39;</code></pre>
    </div>
  </div>
</div>

<p>Запустить перемещение файлов с временем создания и изменения от 10 дней (<code>864000</code>), и с перезаписью файлов с одинаковыми названиями (<code>-O</code>) из <code>Source</code> в <code>Vault</code> с сохранением структуры директорий:</p>






<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-4 shortcode-codeblock-terminal
shortcode-codeblock-terminal-windows shortcode-codeblock-terminal-windows-user">
  <div class="card overflow-hidden" data-bs-theme="dark">
    <div class="card-header">
      <div class="d-flex align-items-center">
        <div class="flex-shrink-0 ">
          <i class="fas fa-terminal fa-fw"></i>
        </div>
        <div class="flex-grow-1 mx-2">
          <h5 class="mb-0">Терминал</h5>
        </div>
        <div class="flex-shrink-0">
          <ul class="list-inline mb-0">
            <li class="list-inline-item" data-bs-tooltip data-bs-title='Копировать'>
              <a class="text-body" href="#"
                 data-fn="clipboard preventDefault" data-clipboard-target="#cp-5843854ed2435711468464bba0dd90a6"
                 role="button" aria-label='Копировать'>
                <i class="fas fa-copy fa-fw"></i>
              </a>
            </li>
          </ul>
        </div>
      </div>
    </div>
    <div class="card-body p-0" id="cp-5843854ed2435711468464bba0dd90a6">
      <pre><code class="language-plaintext">Start-Vault -SRC &#39;C:\Data\Source&#39; -DST &#39;C:\Data\Vault&#39; -CT &#39;864000&#39; -WT &#39;864000&#39; -O</code></pre>
    </div>
  </div>
</div>

<p>Параметр <code>-O</code> означает, что не нужно архивировать старый файл при перемещении нового с таким же названием. Старый файл в хранилище перезапишется новым.</p>
<h2 id="алгоритм-работы">
  <a class="link-body-emphasis" href="#%d0%b0%d0%bb%d0%b3%d0%be%d1%80%d0%b8%d1%82%d0%bc-%d1%80%d0%b0%d0%b1%d0%be%d1%82%d1%8b">Алгоритм работы</a>
</h2><p>Скрипт создаёт хранилище старых файлов. Это, своего рода, аналог резервного копирования. При перемещении файлов из источника в хранилище, скрипт обрабатывает несколько заданных параметров и фильтров. Всё настроить можно под себя. По умолчанию, скрипт перемещает файлы из источника в хранилище, и если в хранилище уже имеется старый файл с названием кау у нового перемещаемого, то старый файл архивируется с меткой <code>.[UnixTime].7z</code>.</p>




    








    
    






<div class="shortcode shortcode-alert">
  <div class="alert alert-warning d-flex overflow-hidden" role="alert">
    <div class="flex-shrink-0 align-self-center">
      <i class="fas fa-exclamation-triangle fa-fw fa-2x"></i>
    </div>
    <div class="flex-grow-1 ms-3 overflow-hidden">
        <p>Для работы скрипта необходим архиватор <strong>7-Zip</strong>, а конкретно его облегчённая версия <code>7za.exe</code> с библиотеками из <strong>7-Zip Extra</strong>. Скачать можно с <a title="" href="https://www.7-zip.org/download.html" target="_blank" rel="noopener noreferrer">официального сайта</a>. После скачивания архива, файлы <code>7za.exe</code>, <code>7za.dll</code> и <code>7zxa.dll</code> нужно разместить рядом со скриптом, или в любую дочернюю директорию. Скрипт сам найдёт путь к <code>7za.exe</code>.</p>

    </div>
  </div>
</div>

<h2 id="скрипт">
  <a class="link-body-emphasis" href="#%d1%81%d0%ba%d1%80%d0%b8%d0%bf%d1%82">Скрипт</a>
</h2>

    <div class="shortcode shortcode-gh-repo mb-3">
      <div class="row row-cols-1 row-cols-lg-2 g-3">
          
            <div class="col gh-repo" data-repos="pkgstore/pwsh-vault">
              <div class="card">
                <div class="row g-0">
                  <div class="col-md-4 p-1">
                    <a class="d-block gh-repo-avatar"
                       href="https://github.com/pkgstore/pwsh-vault" target="_blank"
                       rel="noopener noreferrer nofollow">
                      <img class="card-img gh-repo-avatar"
                           src="https://github.com/identicons/pkgstore.png"
                           alt="pkgstore/pwsh-vault" loading="lazy"/>
                    </a>
                  </div>
                  <div class="col">
                    <div class="card-body h-100">
                      <div class="d-flex flex-column h-100">
                        <div class="flex-shrink-0">
                          <h5 class="card-title">
                            <a class="gh-repo-name"
                               href="https://github.com/pkgstore/pwsh-vault" target="_blank"
                               rel="noopener noreferrer nofollow">pkgstore/pwsh-vault</a>
                          </h5>
                          <h6 class="card-subtitle mb-2 text-body-secondary gh-repo-owner"></h6>
                          <p class="card-text gh-repo-description"></p>
                        </div>
                        <div class="mt-auto">
                          <div class="row row-cols-auto g-2 mt-3">
                            <div class="col">
                              <div class="btn btn-light btn-sm"
                                   data-bs-tooltip data-bs-title='Язык разработки'>
                                <i class="fas fa-code fa-fw me-1"></i>
                                <span class="gh-repo-language">#</span>
                              </div>
                            </div>
                            <div class="col">
                              <div class="btn btn-light btn-sm"
                                   data-bs-tooltip data-bs-title='Подписки'>
                                <i class="fas fa-eye fa-fw me-1"></i>
                                <span class="gh-repo-subscribers">#</span>
                              </div>
                            </div>
                            <div class="col">
                              <div class="btn btn-light btn-sm"
                                   data-bs-tooltip data-bs-title='Звёзды'>
                                <i class="fas fa-star fa-fw me-1"></i>
                                <span class="gh-repo-stars">#</span>
                              </div>
                            </div>
                            <div class="col">
                              <div class="btn btn-light btn-sm"
                                   data-bs-tooltip data-bs-title='Вилки'>
                                <i class="fas fa-code-branch fa-fw me-1"></i>
                                <span class="gh-repo-forks">#</span>
                              </div>
                            </div>
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          
      </div>
    </div>]]></turbo:content></item><item turbo="true"><title>Дефрагментация в ОС Windows</title><link>https://lib.onl/ru/articles/2023/10/eb39e3f7-b194-53d4-8bad-01edf9fdac47/</link><pubDate>Fri, 20 Oct 2023 00:46:16 +0000</pubDate><dc:creator>Kai Kimera</dc:creator><category>MS Windows</category><category>Терминал</category><yandex:related><link url="https://lib.onl/ru/articles/2023/10/75075788-9308-56b7-b531-2008cb35f7d0/">Установка сертификата НУЦ Минцифры</link><link url="https://lib.onl/ru/articles/2023/09/dd5a3e1a-596b-50d5-b070-b2a065f99f32/">Получение и установка MS Office 2021 LTSC</link><link url="https://lib.onl/ru/articles/2022/05/862226e6-cbb1-58f8-bc8e-0cfef747f475/">Интеграция обновлений в дистрибутив ОС MS Windows</link><link url="https://lib.onl/ru/articles/2022/05/36058650-3f35-5ed5-9565-0aa7d8800c28/">Windows Server 2022 для рабочей станции</link></yandex:related><turbo:extendedHtml>true</turbo:extendedHtml><turbo:source>https://lib.onl/ru/articles/2023/10/eb39e3f7-b194-53d4-8bad-01edf9fdac47/</turbo:source><turbo:topic>Дефрагментация в ОС Windows</turbo:topic><turbo:content><![CDATA[<p>При работе с оборудованием, мне приходится сталкиваться с довольно старыми устройствами, их их работу нужно как-нибудь оптимизировать. Одним из вариантов оптимизации является дефрагментация <span class="shortcode shortcode-tag"><a href="/ru/tags/hdd/" target="_blank">#HDD</a></span>.</p>
<h2 id="powershell">
  <a class="link-body-emphasis" href="#powershell">PowerShell</a>
</h2><p>Командлет по дефрагментации для <span class="shortcode shortcode-tag"><a href="/ru/tags/powershell/" target="_blank">#PowerShell</a></span> называется <code>Optimize-Volume</code> и может принимать следующие параметры:</p>
<ul>
<li><code>-Analyze</code> - выполнение анализа указанного тома.</li>
<li><code>-Defrag</code> - выполнение дефрагментации указанного тома.</li>
<li><code>-DriveLetter</code> - буква тома.</li>
<li><code>-NormalPriority</code> - выполнение процесса с нормальным приоритетом (по умолчанию приоритет пониженный).</li>
<li><code>-ReTrim</code> - выполнение TRIM-операции для <span class="shortcode shortcode-tag"><a href="/ru/tags/ssd/" target="_blank">#SSD</a></span>.</li>
</ul>
<p>Это наиболее востребованные параметры. Остальные параметры можно посмотреть в <a title="" href="https://learn.microsoft.com/en-us/powershell/module/storage/optimize-volume" target="_blank" rel="noopener noreferrer">официальной документации</a>.</p>




    










    
    




<div class="shortcode shortcode-alert">
  <div class="alert alert-success d-flex overflow-hidden" role="alert">
    <div class="flex-shrink-0 align-self-center">
      <i class="fas fa-lightbulb fa-fw fa-2x"></i>
    </div>
    <div class="flex-grow-1 ms-3 overflow-hidden">
        <p>Для всех команд можно добавить параметр <code>-Verbose</code>, который выводит подробную информацию о происходящем процессе.</p>

    </div>
  </div>
</div>

<h3 id="анализ-тома">
  <a class="link-body-emphasis" href="#%d0%b0%d0%bd%d0%b0%d0%bb%d0%b8%d0%b7-%d1%82%d0%be%d0%bc%d0%b0">Анализ тома</a>
</h3>


<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-4 shortcode-codeblock-powershell">
  <div class="d-flex overflow-hidden">
    <div class="flex-grow-1 rounded overflow-hidden" id="cp-dc3d7b585515cf3dcc41d4f4378051b1">
      
      <pre><code class='language-powershell'>Optimize-Volume -DriveLetter C -Analyze</code></pre>
    </div>
    <div class="flex-shrink-0">
      <ul class="list-inline mb-0">
        <li class="list-inline-item" data-bs-tooltip data-bs-title='Копировать'>
          <a class="text-body" href="#"
             data-fn="clipboard preventDefault" data-clipboard-target="#cp-dc3d7b585515cf3dcc41d4f4378051b1"
             role="button" aria-label='Копировать'>
            <i class="fas fa-copy fa-fw"></i>
          </a>
        </li>
      </ul>
    </div>
  </div>
</div>

<p>Где:</p>
<ul>
<li><code>-DriveLetter C</code> - буква тома (диск C:).</li>
<li><code>-Analyze</code> - анализ.</li>
</ul>
<h3 id="дефрагментация">
  <a class="link-body-emphasis" href="#%d0%b4%d0%b5%d1%84%d1%80%d0%b0%d0%b3%d0%bc%d0%b5%d0%bd%d1%82%d0%b0%d1%86%d0%b8%d1%8f">Дефрагментация</a>
</h3>


<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-5 shortcode-codeblock-powershell">
  <div class="d-flex overflow-hidden">
    <div class="flex-grow-1 rounded overflow-hidden" id="cp-b5f665cf4b66a28a22db2f0e152285fd">
      
      <pre><code class='language-powershell'>Optimize-Volume -DriveLetter C -Defrag</code></pre>
    </div>
    <div class="flex-shrink-0">
      <ul class="list-inline mb-0">
        <li class="list-inline-item" data-bs-tooltip data-bs-title='Копировать'>
          <a class="text-body" href="#"
             data-fn="clipboard preventDefault" data-clipboard-target="#cp-b5f665cf4b66a28a22db2f0e152285fd"
             role="button" aria-label='Копировать'>
            <i class="fas fa-copy fa-fw"></i>
          </a>
        </li>
      </ul>
    </div>
  </div>
</div>

<p>Где:</p>
<ul>
<li><code>-DriveLetter C</code> - буква тома (диск C:).</li>
<li><code>-Defrag</code> - дефрагментация.</li>
</ul>
<h3 id="trim-операция-для-ssd">
  <a class="link-body-emphasis" href="#trim-%d0%be%d0%bf%d0%b5%d1%80%d0%b0%d1%86%d0%b8%d1%8f-%d0%b4%d0%bb%d1%8f-ssd">TRIM-операция для SSD</a>
</h3>


<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-6 shortcode-codeblock-powershell">
  <div class="d-flex overflow-hidden">
    <div class="flex-grow-1 rounded overflow-hidden" id="cp-3428c7b819499b482baf8cfb300963b8">
      
      <pre><code class='language-powershell'>Optimize-Volume -DriveLetter C -ReTrim</code></pre>
    </div>
    <div class="flex-shrink-0">
      <ul class="list-inline mb-0">
        <li class="list-inline-item" data-bs-tooltip data-bs-title='Копировать'>
          <a class="text-body" href="#"
             data-fn="clipboard preventDefault" data-clipboard-target="#cp-3428c7b819499b482baf8cfb300963b8"
             role="button" aria-label='Копировать'>
            <i class="fas fa-copy fa-fw"></i>
          </a>
        </li>
      </ul>
    </div>
  </div>
</div>

<p>Где:</p>
<ul>
<li><code>-DriveLetter C</code> - буква тома (диск C:).</li>
<li><code>-ReTrim</code> - на дисках SSD запускает TRIM-операцию.</li>
</ul>
<h2 id="cmd-defrag">
  <a class="link-body-emphasis" href="#cmd-defrag">CMD Defrag</a>
</h2><p>Утилита <code>defrag.exe</code> выполняет анализ и оптимизацию томов через командную строку. Утилита может принимать следующие параметры:</p>
<ul>
<li>Тома:
<ul>
<li><code>/c</code> - выполнение операции на всех томах.</li>
<li><code>/e</code> - выполнение операции на всех томах, кроме указанных.</li>
</ul>
</li>
<li>Операции:
<ul>
<li><code>/a</code> - анализ указанных томов.</li>
<li><code>/d</code> - выполнение традиционной дефрагментации (по умолчанию). На многоуровневом томе традиционная дефрагментация выполняется только на уровне ёмкости.</li>
<li><code>/l</code> - выполнение TRIM-операции для SSD.</li>
<li><code>/o</code> - выполнение правильной оптимизации для каждого типа носителя.</li>
<li><code>/u</code> - отображение хода операции.</li>
</ul>
</li>
</ul>




    










    
    




<div class="shortcode shortcode-alert">
  <div class="alert alert-success d-flex overflow-hidden" role="alert">
    <div class="flex-shrink-0 align-self-center">
      <i class="fas fa-lightbulb fa-fw fa-2x"></i>
    </div>
    <div class="flex-grow-1 ms-3 overflow-hidden">
        <p>Для всех команд можно добавить параметр <code>/v</code>, который выводит подробную информацию о происходящем процессе.</p>

    </div>
  </div>
</div>

<h3 id="анализ-тома-1">
  <a class="link-body-emphasis" href="#%d0%b0%d0%bd%d0%b0%d0%bb%d0%b8%d0%b7-%d1%82%d0%be%d0%bc%d0%b0-1">Анализ тома</a>
</h3><p>Анализ тома, с отображением хода выполнения и выводом результатов в подробном формате:</p>



<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-8 shortcode-codeblock-cmd">
  <div class="d-flex overflow-hidden">
    <div class="flex-grow-1 rounded overflow-hidden" id="cp-b7601052219089504bbc94148c3a7a8c">
      
      <pre><code class='language-cmd'>defrag c: /u /a</code></pre>
    </div>
    <div class="flex-shrink-0">
      <ul class="list-inline mb-0">
        <li class="list-inline-item" data-bs-tooltip data-bs-title='Копировать'>
          <a class="text-body" href="#"
             data-fn="clipboard preventDefault" data-clipboard-target="#cp-b7601052219089504bbc94148c3a7a8c"
             role="button" aria-label='Копировать'>
            <i class="fas fa-copy fa-fw"></i>
          </a>
        </li>
      </ul>
    </div>
  </div>
</div>

<p>Где:</p>
<ul>
<li><code>c:</code> - буква тома (диск <code>C:</code>).</li>
<li><code>/u</code> - отображение хода выполнения операции.</li>
<li><code>/a</code> - анализ.</li>
</ul>
<h3 id="параллельная-дефрагментация">
  <a class="link-body-emphasis" href="#%d0%bf%d0%b0%d1%80%d0%b0%d0%bb%d0%bb%d0%b5%d0%bb%d1%8c%d0%bd%d0%b0%d1%8f-%d0%b4%d0%b5%d1%84%d1%80%d0%b0%d0%b3%d0%bc%d0%b5%d0%bd%d1%82%d0%b0%d1%86%d0%b8%d1%8f">Параллельная дефрагментация</a>
</h3><p>Параллельная дефрагментация томов <code>C:</code> и <code>D:</code> в фоновом режиме:</p>



<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-9 shortcode-codeblock-cmd">
  <div class="d-flex overflow-hidden">
    <div class="flex-grow-1 rounded overflow-hidden" id="cp-a482a0f4f0d7b41a46bfc540385ba7aa">
      
      <pre><code class='language-cmd'>defrag c: d: /m</code></pre>
    </div>
    <div class="flex-shrink-0">
      <ul class="list-inline mb-0">
        <li class="list-inline-item" data-bs-tooltip data-bs-title='Копировать'>
          <a class="text-body" href="#"
             data-fn="clipboard preventDefault" data-clipboard-target="#cp-a482a0f4f0d7b41a46bfc540385ba7aa"
             role="button" aria-label='Копировать'>
            <i class="fas fa-copy fa-fw"></i>
          </a>
        </li>
      </ul>
    </div>
  </div>
</div>

<p>Где:</p>
<ul>
<li><code>c:</code> - буква тома (диск <code>C:</code>).</li>
<li><code>d:</code> - буква тома (диск <code>D:</code>).</li>
<li><code>/m</code> - выполнение операции с каждым томом параллельно в фоновом режиме.</li>
</ul>
<h3 id="дефрагментация-всех-томах">
  <a class="link-body-emphasis" href="#%d0%b4%d0%b5%d1%84%d1%80%d0%b0%d0%b3%d0%bc%d0%b5%d0%bd%d1%82%d0%b0%d1%86%d0%b8%d1%8f-%d0%b2%d1%81%d0%b5%d1%85-%d1%82%d0%be%d0%bc%d0%b0%d1%85">Дефрагментация всех томах</a>
</h3><p>Выполнить дефрагментацию на всех локальных томах с нормальным приоритетом:</p>



<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-10 shortcode-codeblock-cmd">
  <div class="d-flex overflow-hidden">
    <div class="flex-grow-1 rounded overflow-hidden" id="cp-0d8bf37d76bb21beda96310f39532ffd">
      
      <pre><code class='language-cmd'>defrag /u /c /h</code></pre>
    </div>
    <div class="flex-shrink-0">
      <ul class="list-inline mb-0">
        <li class="list-inline-item" data-bs-tooltip data-bs-title='Копировать'>
          <a class="text-body" href="#"
             data-fn="clipboard preventDefault" data-clipboard-target="#cp-0d8bf37d76bb21beda96310f39532ffd"
             role="button" aria-label='Копировать'>
            <i class="fas fa-copy fa-fw"></i>
          </a>
        </li>
      </ul>
    </div>
  </div>
</div>

<p>Где:</p>
<ul>
<li><code>/u</code> - отображение хода выполнения операции.</li>
<li><code>/c</code> - выполнение операции на всех томах.</li>
<li><code>/h</code> - выполнение операции с нормальным приоритетом (по умолчанию приоритет пониженный).</li>
</ul>
<h3 id="trim-операция-для-ssd-1">
  <a class="link-body-emphasis" href="#trim-%d0%be%d0%bf%d0%b5%d1%80%d0%b0%d1%86%d0%b8%d1%8f-%d0%b4%d0%bb%d1%8f-ssd-1">TRIM-операция для SSD</a>
</h3>


<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-11 shortcode-codeblock-cmd">
  <div class="d-flex overflow-hidden">
    <div class="flex-grow-1 rounded overflow-hidden" id="cp-3d67874540ee52d6d4277843438d3b19">
      
      <pre><code class='language-cmd'>defrag /u /c /l</code></pre>
    </div>
    <div class="flex-shrink-0">
      <ul class="list-inline mb-0">
        <li class="list-inline-item" data-bs-tooltip data-bs-title='Копировать'>
          <a class="text-body" href="#"
             data-fn="clipboard preventDefault" data-clipboard-target="#cp-3d67874540ee52d6d4277843438d3b19"
             role="button" aria-label='Копировать'>
            <i class="fas fa-copy fa-fw"></i>
          </a>
        </li>
      </ul>
    </div>
  </div>
</div>

<p>Где:</p>
<ul>
<li><code>/u</code> - отображение хода выполнения операции.</li>
<li><code>/c</code> - выполнение операции на всех томах.</li>
<li><code>/l</code> или <code>/retrim</code> - на дисках SSD запускает TRIM-операцию.</li>
</ul>]]></turbo:content></item><item turbo="true"><title>MikroTik: Добавление корневых сертификатов в RouterOS</title><link>https://lib.onl/ru/articles/2023/10/cc13623b-970c-5950-867e-168f9ba9025a/</link><pubDate>Thu, 19 Oct 2023 08:56:43 +0000</pubDate><dc:creator>Kai Kimera</dc:creator><category>Сеть</category><category>Безопасность</category><yandex:related><link url="https://lib.onl/ru/articles/2020/07/ff2ae66e-8e14-5c4a-baa6-0cd2e59f6517/">MikroTik и CloudFlare: Динамический IP для домена</link></yandex:related><turbo:extendedHtml>true</turbo:extendedHtml><turbo:source>https://lib.onl/ru/articles/2023/10/cc13623b-970c-5950-867e-168f9ba9025a/</turbo:source><turbo:topic>MikroTik: Добавление корневых сертификатов в RouterOS</turbo:topic><turbo:content><![CDATA[<p>Репозиторий корневых сертификатов необходим для того, чтобы <span class="shortcode shortcode-tag"><a href="/ru/tags/routeros/" target="_blank">#RouterOS</a></span> имела представление какие вообще центры сертификации существуют.</p>
<p>Если репозиторий заполнен корневыми сертификатами центров сертификации, <span class="shortcode shortcode-tag"><a href="/ru/tags/routeros/" target="_blank">#RouterOS</a></span> сможет проверять подлинность выданных этими центрами сертификатов, работать с DNS over HTTPS (<span class="shortcode shortcode-tag"><a href="/ru/tags/doh/" target="_blank">#DoH</a></span>) и делать другую работу, связанную с шифрованием данных.</p>
<h2 id="загрузка-базы-сертификатов">
  <a class="link-body-emphasis" href="#%d0%b7%d0%b0%d0%b3%d1%80%d1%83%d0%b7%d0%ba%d0%b0-%d0%b1%d0%b0%d0%b7%d1%8b-%d1%81%d0%b5%d1%80%d1%82%d0%b8%d1%84%d0%b8%d0%ba%d0%b0%d1%82%d0%be%d0%b2">Загрузка базы сертификатов</a>
</h2><p>Файл <a title="" href="https://curl.se/docs/caextract.html" target="_blank" rel="noopener noreferrer">cacert.pem</a> с сайта <a title="" href="https://curl.se/" target="_blank" rel="noopener noreferrer">curl.se</a> переодически обновляется и содержит в себе корневые сертификаты центров сертификации. Откроем терминал в <span class="shortcode shortcode-tag"><a href="/ru/tags/routeros/" target="_blank">#RouterOS</a></span> и скачаем сразу на роутер командой:</p>



<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-4 ">
  <div class="d-flex overflow-hidden">
    <div class="flex-grow-1 rounded overflow-hidden" id="cp-bd90c08785ddded3245c651db56a99e1">
      
      <pre><code >/tool fetch url=&#34;https://curl.se/ca/cacert.pem&#34; dst-path=&#34;ros.cacert.pem&#34;</code></pre>
    </div>
    <div class="flex-shrink-0">
      <ul class="list-inline mb-0">
        <li class="list-inline-item" data-bs-tooltip data-bs-title='Копировать'>
          <a class="text-body" href="#"
             data-fn="clipboard preventDefault" data-clipboard-target="#cp-bd90c08785ddded3245c651db56a99e1"
             role="button" aria-label='Копировать'>
            <i class="fas fa-copy fa-fw"></i>
          </a>
        </li>
      </ul>
    </div>
  </div>
</div>

<p>Где:</p>
<ul>
<li><code>url</code> - URL файла, который необходимо скачать.</li>
<li><code>dst-path</code> - название, под которым файл сохранится на роутере. Я добавляю префикс <code>ros.</code>, чтобы знать, что этот файл важен для <span class="shortcode shortcode-tag"><a href="/ru/tags/routeros/" target="_blank">#RouterOS</a></span>.</li>
</ul>
<h2 id="импортирование-сертификатов-в-репозиторий">
  <a class="link-body-emphasis" href="#%d0%b8%d0%bc%d0%bf%d0%be%d1%80%d1%82%d0%b8%d1%80%d0%be%d0%b2%d0%b0%d0%bd%d0%b8%d0%b5-%d1%81%d0%b5%d1%80%d1%82%d0%b8%d1%84%d0%b8%d0%ba%d0%b0%d1%82%d0%be%d0%b2-%d0%b2-%d1%80%d0%b5%d0%bf%d0%be%d0%b7%d0%b8%d1%82%d0%be%d1%80%d0%b8%d0%b9">Импортирование сертификатов в репозиторий</a>
</h2><p>Теперь когда файл на роутере, нужно импортировать его содержимое в репозиторий сертификатов. Делается это следующей командой:</p>



<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-6 ">
  <div class="d-flex overflow-hidden">
    <div class="flex-grow-1 rounded overflow-hidden" id="cp-4bed1426ed409fb8face1536ac5131b5">
      
      <pre><code >/certificate import file-name=&#34;ros.cacert.pem&#34; passphrase=&#34;&#34; name=&#34;ROS&#34;</code></pre>
    </div>
    <div class="flex-shrink-0">
      <ul class="list-inline mb-0">
        <li class="list-inline-item" data-bs-tooltip data-bs-title='Копировать'>
          <a class="text-body" href="#"
             data-fn="clipboard preventDefault" data-clipboard-target="#cp-4bed1426ed409fb8face1536ac5131b5"
             role="button" aria-label='Копировать'>
            <i class="fas fa-copy fa-fw"></i>
          </a>
        </li>
      </ul>
    </div>
  </div>
</div>

<p>Где:</p>
<ul>
<li><code>file-name</code> - название файла на  роутере.</li>
<li><code>name</code> - название, под которым сертификаты будут обозначаться в репозитории сертификатов. Здесь тоже я указываю <code>ROS</code>, чтобы знать, что сертификаты импортировались вручную. Вы можете ввести любое своё название, главное, чтобы оно для вас что-то обозначало.</li>
</ul>




    










    
    




<div class="shortcode shortcode-alert">
  <div class="alert alert-success d-flex overflow-hidden" role="alert">
    <div class="flex-shrink-0 align-self-center">
      <i class="fas fa-lightbulb fa-fw fa-2x"></i>
    </div>
    <div class="flex-grow-1 ms-3 overflow-hidden">
        <p>Параметр <code>name</code> можно не указывать, тогда при импорте сертификатов, RouterOS в этот параметр автоматически подставит название файла.</p>

    </div>
  </div>
</div>]]></turbo:content></item><item turbo="true"><title>Создание сертификатов при помощи OpenSSL</title><link>https://lib.onl/ru/articles/2023/10/6733cb51-62a0-5ed9-b421-8f08c4e0cb18/</link><pubDate>Tue, 17 Oct 2023 23:42:31 +0000</pubDate><dc:creator>Kai Kimera</dc:creator><category>Терминал</category><category>Скрипты</category><category>Linux</category><yandex:related><link url="https://lib.onl/ru/articles/2023/10/75075788-9308-56b7-b531-2008cb35f7d0/">Установка сертификата НУЦ Минцифры</link><link url="https://lib.onl/ru/articles/2021/08/ca744dce-e607-52e6-9952-8ae04e052a5b/">Скрипт автоматического удаления устаревших файлов</link></yandex:related><turbo:extendedHtml>true</turbo:extendedHtml><turbo:source>https://lib.onl/ru/articles/2023/10/6733cb51-62a0-5ed9-b421-8f08c4e0cb18/</turbo:source><turbo:topic>Создание сертификатов при помощи OpenSSL</turbo:topic><turbo:content><![CDATA[<p><span class="shortcode shortcode-tag"><a href="/ru/tags/openssl/" target="_blank">#OpenSSL</a></span> является библиотекой по работе с криптографией, но в этой статье я затрону только часть функций этого инструмента, а именно создание само-подписанных сертификатов.</p>
<h2 id="создание-центра-сертификации">
  <a class="link-body-emphasis" href="#%d1%81%d0%be%d0%b7%d0%b4%d0%b0%d0%bd%d0%b8%d0%b5-%d1%86%d0%b5%d0%bd%d1%82%d1%80%d0%b0-%d1%81%d0%b5%d1%80%d1%82%d0%b8%d1%84%d0%b8%d0%ba%d0%b0%d1%86%d0%b8%d0%b8">Создание центра сертификации</a>
</h2><p>При помощи корневого сертификата, мы будем подписывать сертификаты клиентские. Создаём сертификат центра сертификации&hellip;</p>



<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-1 shortcode-codeblock-bash">
  <div class="d-flex overflow-hidden">
    <div class="flex-grow-1 rounded overflow-hidden" id="cp-3f765f6edfef0d9b3e44ff445b931851">
      
      <pre><code class='language-bash'>openssl req -x509 -newkey ec:&lt;( openssl ecparam -name &#39;secp384r1&#39; ) -nodes -days &#39;3650&#39; -keyout &#39;ca.root.key&#39; -out &#39;ca.root.crt&#39;</code></pre>
    </div>
    <div class="flex-shrink-0">
      <ul class="list-inline mb-0">
        <li class="list-inline-item" data-bs-tooltip data-bs-title='Копировать'>
          <a class="text-body" href="#"
             data-fn="clipboard preventDefault" data-clipboard-target="#cp-3f765f6edfef0d9b3e44ff445b931851"
             role="button" aria-label='Копировать'>
            <i class="fas fa-copy fa-fw"></i>
          </a>
        </li>
      </ul>
    </div>
  </div>
</div>

<p>Где:</p>
<ul>
<li><code>-days '3650'</code> - количество дней, по прошествии которого сертификат центра сертификации станет недействительным.</li>
<li><code>-keyout 'ca.root.key'</code> - название создаваемого файла с ключом центра сертификации.</li>
<li><code>-out 'ca.root.crt'</code> - название создаваемого файла с сертификатом центра сертификации.</li>
</ul>
<h2 id="создание-клиентского-сертификата">
  <a class="link-body-emphasis" href="#%d1%81%d0%be%d0%b7%d0%b4%d0%b0%d0%bd%d0%b8%d0%b5-%d0%ba%d0%bb%d0%b8%d0%b5%d0%bd%d1%82%d1%81%d0%ba%d0%be%d0%b3%d0%be-%d1%81%d0%b5%d1%80%d1%82%d0%b8%d1%84%d0%b8%d0%ba%d0%b0%d1%82%d0%b0">Создание клиентского сертификата</a>
</h2><p>Как только будет готов корневой сертификат, можно приступать к выпуску клиентских сертификатов.</p>
<h3 id="создание-приватного-ключа">
  <a class="link-body-emphasis" href="#%d1%81%d0%be%d0%b7%d0%b4%d0%b0%d0%bd%d0%b8%d0%b5-%d0%bf%d1%80%d0%b8%d0%b2%d0%b0%d1%82%d0%bd%d0%be%d0%b3%d0%be-%d0%ba%d0%bb%d1%8e%d1%87%d0%b0">Создание приватного ключа</a>
</h3><p>Для начала создаём приватный ключ.</p>



<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-2 shortcode-codeblock-bash">
  <div class="d-flex overflow-hidden">
    <div class="flex-grow-1 rounded overflow-hidden" id="cp-f5d7e23fa0e5a52b4090f036f109bc95">
      
      <pre><code class='language-bash'>openssl ecparam -name &#39;prime256v1&#39; -genkey -noout -out &#39;client.private.key&#39;</code></pre>
    </div>
    <div class="flex-shrink-0">
      <ul class="list-inline mb-0">
        <li class="list-inline-item" data-bs-tooltip data-bs-title='Копировать'>
          <a class="text-body" href="#"
             data-fn="clipboard preventDefault" data-clipboard-target="#cp-f5d7e23fa0e5a52b4090f036f109bc95"
             role="button" aria-label='Копировать'>
            <i class="fas fa-copy fa-fw"></i>
          </a>
        </li>
      </ul>
    </div>
  </div>
</div>

<p>Где:</p>
<ul>
<li><code>-out 'client.private.key'</code> - название создаваемого файла с клиентским приватным ключом.</li>
</ul>
<h3 id="создание-публичного-ключа">
  <a class="link-body-emphasis" href="#%d1%81%d0%be%d0%b7%d0%b4%d0%b0%d0%bd%d0%b8%d0%b5-%d0%bf%d1%83%d0%b1%d0%bb%d0%b8%d1%87%d0%bd%d0%be%d0%b3%d0%be-%d0%ba%d0%bb%d1%8e%d1%87%d0%b0">Создание публичного ключа</a>
</h3><p>Создание публичного ключа будет не лишним.</p>



<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-3 shortcode-codeblock-bash">
  <div class="d-flex overflow-hidden">
    <div class="flex-grow-1 rounded overflow-hidden" id="cp-5b50d6e33eba24db3ce569aa0363de91">
      
      <pre><code class='language-bash'>openssl ec -in &#39;client.private.key&#39; -pubout -out &#39;client.public.key&#39;</code></pre>
    </div>
    <div class="flex-shrink-0">
      <ul class="list-inline mb-0">
        <li class="list-inline-item" data-bs-tooltip data-bs-title='Копировать'>
          <a class="text-body" href="#"
             data-fn="clipboard preventDefault" data-clipboard-target="#cp-5b50d6e33eba24db3ce569aa0363de91"
             role="button" aria-label='Копировать'>
            <i class="fas fa-copy fa-fw"></i>
          </a>
        </li>
      </ul>
    </div>
  </div>
</div>

<p>Где:</p>
<ul>
<li><code>-in 'client.private.key'</code> - файл c клиентским приватным ключом.</li>
<li><code>-out 'client.public.key'</code> - название создаваемого файла с клиентским публичным ключом.</li>
</ul>
<h3 id="создание-запроса-на-подпись-сертификата">
  <a class="link-body-emphasis" href="#%d1%81%d0%be%d0%b7%d0%b4%d0%b0%d0%bd%d0%b8%d0%b5-%d0%b7%d0%b0%d0%bf%d1%80%d0%be%d1%81%d0%b0-%d0%bd%d0%b0-%d0%bf%d0%be%d0%b4%d0%bf%d0%b8%d1%81%d1%8c-%d1%81%d0%b5%d1%80%d1%82%d0%b8%d1%84%d0%b8%d0%ba%d0%b0%d1%82%d0%b0">Создание запроса на подпись сертификата</a>
</h3><p>Выполняем запрос на сертификат.</p>



<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-4 shortcode-codeblock-bash">
  <div class="d-flex overflow-hidden">
    <div class="flex-grow-1 rounded overflow-hidden" id="cp-b51bd3b86c3aaa8495a681e301f1d578">
      
      <pre><code class='language-bash'>openssl req -new -key &#39;client.private.key&#39; -out &#39;client.csr&#39;</code></pre>
    </div>
    <div class="flex-shrink-0">
      <ul class="list-inline mb-0">
        <li class="list-inline-item" data-bs-tooltip data-bs-title='Копировать'>
          <a class="text-body" href="#"
             data-fn="clipboard preventDefault" data-clipboard-target="#cp-b51bd3b86c3aaa8495a681e301f1d578"
             role="button" aria-label='Копировать'>
            <i class="fas fa-copy fa-fw"></i>
          </a>
        </li>
      </ul>
    </div>
  </div>
</div>

<p>Где:</p>
<ul>
<li><code>-key 'client.private.key'</code> - файл с приватным ключом клиентского сертификата.</li>
<li><code>-out 'client.csr'</code> - название создаваемого файла с запросом на подпись клиентского сертификата.</li>
</ul>
<p>При выполнении запроса будет предложено ввести актуальные данные для будущего сертификата:</p>
<ul>
<li><code>Country Name (2 letter code)</code> - двухбуквенный код страны, в которой юридически находится ваша организация.</li>
<li><code>State or Province Name (full name)</code> - штат или провинция, в которой юридически находится ваша организация.</li>
<li><code>Locality Name (e.g., city)</code> - город, в котором юридически находится ваша организация.</li>
<li><code>Organization Name (e.g., company)</code> - юридически зарегистрированное название вашей организации.</li>
<li><code>Organizational Unit Name (e.g., section)</code> - название вашего отдела в организации (опционально).</li>
<li><code>Common Name (e.g., server FQDN)</code> - полное доменное имя (FQDN) (например, <a title="" href="https://www.example.com" target="_blank" rel="noopener noreferrer">www.example.com</a>).</li>
<li><code>Email Address</code> - ваш адрес email (опционально).</li>
<li><code>A challenge password</code> - пароль (опционально).</li>
<li><code>An optional company name</code> - необязательное название компании (опционально).</li>
</ul>
<p>Самое главное поле это <code>Common Name (e.g., server FQDN)</code> (<code>CN</code>), заполнять его необходимо очень внимательно.</p>
<h3 id="создание-и-подпись-сертификата">
  <a class="link-body-emphasis" href="#%d1%81%d0%be%d0%b7%d0%b4%d0%b0%d0%bd%d0%b8%d0%b5-%d0%b8-%d0%bf%d0%be%d0%b4%d0%bf%d0%b8%d1%81%d1%8c-%d1%81%d0%b5%d1%80%d1%82%d0%b8%d1%84%d0%b8%d0%ba%d0%b0%d1%82%d0%b0">Создание и подпись сертификата</a>
</h3><p>В заключительной части остаётся только создать сам сертификат и подписать его.</p>



<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-5 shortcode-codeblock-bash">
  <div class="d-flex overflow-hidden">
    <div class="flex-grow-1 rounded overflow-hidden" id="cp-f0e55aeca5af92dd78b516172cadb106">
      
      <pre><code class='language-bash'>openssl x509 -req -in &#39;client.csr&#39; -CA &#39;ca.crt&#39; -CAkey &#39;ca.key&#39; -days &#39;3650&#39; -out &#39;client.crt&#39;</code></pre>
    </div>
    <div class="flex-shrink-0">
      <ul class="list-inline mb-0">
        <li class="list-inline-item" data-bs-tooltip data-bs-title='Копировать'>
          <a class="text-body" href="#"
             data-fn="clipboard preventDefault" data-clipboard-target="#cp-f0e55aeca5af92dd78b516172cadb106"
             role="button" aria-label='Копировать'>
            <i class="fas fa-copy fa-fw"></i>
          </a>
        </li>
      </ul>
    </div>
  </div>
</div>

<p>Где:</p>
<ul>
<li><code>-in 'client.csr'</code> - файл с запросом клиентского сертификата.</li>
<li><code>-CA 'ca.crt'</code> - файл с сертификатом центра сертификации.</li>
<li><code>-CAkey 'ca.key'</code> - файл с ключом центра сертификации.</li>
<li><code>-days '3650'</code> - количество дней, по прошествии которого клиентский сертификат станет недействительным.</li>
<li><code>-out 'client.crt'</code> - название создаваемого файла с клиентским сертификатом.</li>
</ul>
<h3 id="экспорт-сертификата">
  <a class="link-body-emphasis" href="#%d1%8d%d0%ba%d1%81%d0%bf%d0%be%d1%80%d1%82-%d1%81%d0%b5%d1%80%d1%82%d0%b8%d1%84%d0%b8%d0%ba%d0%b0%d1%82%d0%b0">Экспорт сертификата</a>
</h3><p>Для того, чтобы импортировать сертификат на клиентские устройства, его необходимо экспортировать в формат <code>P12</code>. <code>P12</code> является контейнером, в котором содержится приватный ключ сертификата и сам сертификат.</p>



<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-6 shortcode-codeblock-bash">
  <div class="d-flex overflow-hidden">
    <div class="flex-grow-1 rounded overflow-hidden" id="cp-0719b7f95a851792bf10ffaef3db5769">
      
      <pre><code class='language-bash'>openssl pkcs12 -export -inkey &#39;client.private.key&#39; -in &#39;client.crt&#39; -out &#39;client.p12&#39;</code></pre>
    </div>
    <div class="flex-shrink-0">
      <ul class="list-inline mb-0">
        <li class="list-inline-item" data-bs-tooltip data-bs-title='Копировать'>
          <a class="text-body" href="#"
             data-fn="clipboard preventDefault" data-clipboard-target="#cp-0719b7f95a851792bf10ffaef3db5769"
             role="button" aria-label='Копировать'>
            <i class="fas fa-copy fa-fw"></i>
          </a>
        </li>
      </ul>
    </div>
  </div>
</div>

<p>Где:</p>
<ul>
<li><code>-inkey 'client.private.key'</code> - файл с приватным клиентским ключом.</li>
<li><code>-in 'client.crt'</code> - файл с клиентским сертификатом.</li>
<li><code>-out 'client.p12'</code> - название создаваемого файла-контейнера с приватным ключом и сертификатом.</li>
</ul>
<h3 id="верификация-сертификата">
  <a class="link-body-emphasis" href="#%d0%b2%d0%b5%d1%80%d0%b8%d1%84%d0%b8%d0%ba%d0%b0%d1%86%d0%b8%d1%8f-%d1%81%d0%b5%d1%80%d1%82%d0%b8%d1%84%d0%b8%d0%ba%d0%b0%d1%82%d0%b0">Верификация сертификата</a>
</h3>


<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-7 shortcode-codeblock-bash">
  <div class="d-flex overflow-hidden">
    <div class="flex-grow-1 rounded overflow-hidden" id="cp-627fade837255a2e99299bde5b274eb7">
      
      <pre><code class='language-bash'>openssl verify -CAfile &#39;ca.crt&#39; &#39;client.crt&#39;</code></pre>
    </div>
    <div class="flex-shrink-0">
      <ul class="list-inline mb-0">
        <li class="list-inline-item" data-bs-tooltip data-bs-title='Копировать'>
          <a class="text-body" href="#"
             data-fn="clipboard preventDefault" data-clipboard-target="#cp-627fade837255a2e99299bde5b274eb7"
             role="button" aria-label='Копировать'>
            <i class="fas fa-copy fa-fw"></i>
          </a>
        </li>
      </ul>
    </div>
  </div>
</div>

<ul>
<li><code>-CAfile 'ca.crt'</code> - файл с сертификатом центра сертификации.</li>
<li><code>'client.crt'</code> - файл с клиентским сертификатом.</li>
</ul>
<h3 id="просмотр-сертификата">
  <a class="link-body-emphasis" href="#%d0%bf%d1%80%d0%be%d1%81%d0%bc%d0%be%d1%82%d1%80-%d1%81%d0%b5%d1%80%d1%82%d0%b8%d1%84%d0%b8%d0%ba%d0%b0%d1%82%d0%b0">Просмотр сертификата</a>
</h3>


<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-8 shortcode-codeblock-bash">
  <div class="d-flex overflow-hidden">
    <div class="flex-grow-1 rounded overflow-hidden" id="cp-304e1d6730b0380b9901564c9113ffe9">
      
      <pre><code class='language-bash'>openssl x509 -in &#39;client.crt&#39; -text</code></pre>
    </div>
    <div class="flex-shrink-0">
      <ul class="list-inline mb-0">
        <li class="list-inline-item" data-bs-tooltip data-bs-title='Копировать'>
          <a class="text-body" href="#"
             data-fn="clipboard preventDefault" data-clipboard-target="#cp-304e1d6730b0380b9901564c9113ffe9"
             role="button" aria-label='Копировать'>
            <i class="fas fa-copy fa-fw"></i>
          </a>
        </li>
      </ul>
    </div>
  </div>
</div>

<p>Где:</p>
<ul>
<li><code>-in 'client.crt'</code> - файл с клиентским сертификатом.</li>
</ul>
<p>При выполнении команды, терминал покажет информацию со всеми основными сведениями о сертификате (пример ниже).</p>






<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-9 shortcode-codeblock-terminal
shortcode-codeblock-terminal-linux shortcode-codeblock-terminal-linux-user">
  <div class="card overflow-hidden" data-bs-theme="dark">
    <div class="card-header">
      <div class="d-flex align-items-center">
        <div class="flex-shrink-0 ">
          <i class="fas fa-terminal fa-fw"></i>
        </div>
        <div class="flex-grow-1 mx-2">
          <h5 class="mb-0">Терминал</h5>
        </div>
        <div class="flex-shrink-0">
          <ul class="list-inline mb-0">
            <li class="list-inline-item" data-bs-tooltip data-bs-title='Копировать'>
              <a class="text-body" href="#"
                 data-fn="clipboard preventDefault" data-clipboard-target="#cp-b7eb9a3222e1dfe07b36cf2737a426d1"
                 role="button" aria-label='Копировать'>
                <i class="fas fa-copy fa-fw"></i>
              </a>
            </li>
          </ul>
        </div>
      </div>
    </div>
    <div class="card-body p-0" id="cp-b7eb9a3222e1dfe07b36cf2737a426d1">
      <pre><code class="language-plaintext">openssl x509 -in &#39;client.crt&#39; -text

Certificate:
    Data:
        Version: 1 (0x0)
        Serial Number:
            49:14:b8:78:17:a1:ca:c4:6a:41:1b:23:f3:8a:8d:36:e0:9e:69:81
        Signature Algorithm: ecdsa-with-SHA256
        Issuer: C = AU, ST = Some-State, O = Internet Widgits Pty Ltd, CN = CA
        Validity
            Not Before: Oct 18 21:31:53 2023 GMT
            Not After : Oct 15 21:31:53 2033 GMT
        Subject: C = AU, ST = Some-State, O = Internet Widgits Pty Ltd, CN = CN-FQDN, emailAddress = mail@example.com
        Subject Public Key Info:
            Public Key Algorithm: id-ecPublicKey
                Public-Key: (256 bit)
                pub:
                    04:9f:22:91:cc:14:b3:75:ad:44:cc:0d:96:0d:19:
                    04:c4:20:79:fd:b7:f5:65:64:dd:65:a1:f0:b8:2d:
                    e4:02:75:62:41:03:7c:6e:2f:48:e4:11:38:dc:ed:
                    08:1f:4c:fa:5f:2f:a2:f5:5d:51:2e:8e:de:de:70:
                    33:aa:e5:3b:95
                ASN1 OID: prime256v1
                NIST CURVE: P-256
    Signature Algorithm: ecdsa-with-SHA256
         30:64:02:30:0d:ff:b1:dc:8b:a6:c6:9c:ad:65:8a:7c:01:41:
         9f:91:ca:24:4c:0b:28:5a:5c:f6:35:2a:b2:d7:58:ca:39:da:
         6c:bf:cf:8b:23:20:ce:11:45:13:61:36:e2:23:4a:e9:02:30:
         54:dc:45:ed:ef:21:58:ea:c7:b6:63:db:a2:d9:71:fe:3d:b3:
         d6:1e:15:82:7b:c8:e8:08:33:d5:2f:d5:f2:8f:3b:41:ea:53:
         1e:2d:a9:1e:9e:25:9c:fb:a7:12:f9:ec</code></pre>
    </div>
  </div>
</div>

<h3 id="просмотр-запроса-на-подпись-сертификата">
  <a class="link-body-emphasis" href="#%d0%bf%d1%80%d0%be%d1%81%d0%bc%d0%be%d1%82%d1%80-%d0%b7%d0%b0%d0%bf%d1%80%d0%be%d1%81%d0%b0-%d0%bd%d0%b0-%d0%bf%d0%be%d0%b4%d0%bf%d0%b8%d1%81%d1%8c-%d1%81%d0%b5%d1%80%d1%82%d0%b8%d1%84%d0%b8%d0%ba%d0%b0%d1%82%d0%b0">Просмотр запроса на подпись сертификата</a>
</h3>


<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-10 shortcode-codeblock-bash">
  <div class="d-flex overflow-hidden">
    <div class="flex-grow-1 rounded overflow-hidden" id="cp-9ea01b817c9f5efffcebade52fa81d7b">
      
      <pre><code class='language-bash'>openssl req -in &#39;client.csr&#39; -text</code></pre>
    </div>
    <div class="flex-shrink-0">
      <ul class="list-inline mb-0">
        <li class="list-inline-item" data-bs-tooltip data-bs-title='Копировать'>
          <a class="text-body" href="#"
             data-fn="clipboard preventDefault" data-clipboard-target="#cp-9ea01b817c9f5efffcebade52fa81d7b"
             role="button" aria-label='Копировать'>
            <i class="fas fa-copy fa-fw"></i>
          </a>
        </li>
      </ul>
    </div>
  </div>
</div>

<p>Где:</p>
<ul>
<li><code>-in 'client.csr'</code> - файл с запросом на подпись клиентского сертификата.</li>
</ul>
<p>Команда выдаст информацию по запросу на подпись клиентского сертификата (пример ниже).</p>






<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-11 shortcode-codeblock-terminal
shortcode-codeblock-terminal-linux shortcode-codeblock-terminal-linux-user">
  <div class="card overflow-hidden" data-bs-theme="dark">
    <div class="card-header">
      <div class="d-flex align-items-center">
        <div class="flex-shrink-0 ">
          <i class="fas fa-terminal fa-fw"></i>
        </div>
        <div class="flex-grow-1 mx-2">
          <h5 class="mb-0">Терминал</h5>
        </div>
        <div class="flex-shrink-0">
          <ul class="list-inline mb-0">
            <li class="list-inline-item" data-bs-tooltip data-bs-title='Копировать'>
              <a class="text-body" href="#"
                 data-fn="clipboard preventDefault" data-clipboard-target="#cp-1933efe35d5cf43c2cc4c46374440cbe"
                 role="button" aria-label='Копировать'>
                <i class="fas fa-copy fa-fw"></i>
              </a>
            </li>
          </ul>
        </div>
      </div>
    </div>
    <div class="card-body p-0" id="cp-1933efe35d5cf43c2cc4c46374440cbe">
      <pre><code class="language-plaintext">openssl req -in &#39;client.csr&#39; -text

Certificate Request:
    Data:
        Version: 1 (0x0)
        Subject: C = AU, ST = Some-State, O = Internet Widgits Pty Ltd, CN = CN-FQDN, emailAddress = mail@example.com
        Subject Public Key Info:
            Public Key Algorithm: id-ecPublicKey
                Public-Key: (256 bit)
                pub:
                    04:9f:22:91:cc:14:b3:75:ad:44:cc:0d:96:0d:19:
                    04:c4:20:79:fd:b7:f5:65:64:dd:65:a1:f0:b8:2d:
                    e4:02:75:62:41:03:7c:6e:2f:48:e4:11:38:dc:ed:
                    08:1f:4c:fa:5f:2f:a2:f5:5d:51:2e:8e:de:de:70:
                    33:aa:e5:3b:95
                ASN1 OID: prime256v1
                NIST CURVE: P-256
        Attributes:
            a0:00
        Requested Extensions:
    Signature Algorithm: ecdsa-with-SHA256
         30:45:02:20:51:9c:a0:b9:b2:61:7f:fa:64:ea:34:1f:65:15:
         37:ae:f4:89:30:47:11:89:db:c4:1b:1d:9b:82:b9:64:ea:c7:
         02:21:00:f8:00:70:4e:e6:db:99:78:cf:25:22:c0:8d:c6:b1:
         f3:f0:d8:68:3b:c2:51:21:a5:b3:fa:97:f9:85:c6:9c:49</code></pre>
    </div>
  </div>
</div>

<h2 id="автоматизация">
  <a class="link-body-emphasis" href="#%d0%b0%d0%b2%d1%82%d0%be%d0%bc%d0%b0%d1%82%d0%b8%d0%b7%d0%b0%d1%86%d0%b8%d1%8f">Автоматизация</a>
</h2><p>Команд много. Поэтому я как обычно, решил всё автоматизировать и загнать в скрипт.</p>

    

    
        
            
            <div class="shortcode shortcode-file mb-3">
              <div class="card overflow-hidden">
                <div class="card-header">
                  <div class="d-flex align-items-center">
                    <div class="flex-shrink-0">
                      <i class="far fa-file-code fa-fw"></i>
                    </div>
                    <div class="flex-grow-1 mx-2 text-truncate">
                      <code>bash.openssl.ca.sh</code>
                    </div>
                    <div class="flex-shrink-0">
                      <ul class="list-inline mb-0">
                        <li class="list-inline-item" data-bs-tooltip data-bs-title='Копировать'>
                          <a class="text-body" href="#"
                             data-fn="clipboard preventDefault" data-clipboard-target="#cp-d93fe792b3477d5e8baa60d0fe5f88cc"
                             role="button" aria-label='Копировать'>
                            <i class="fas fa-copy fa-fw"></i>
                          </a>
                        </li>
                        <li class="list-inline-item" data-bs-tooltip data-bs-title='Скачать'>
                          <a class="text-body" href="/ru/articles/2023/10/6733cb51-62a0-5ed9-b421-8f08c4e0cb18/bash.openssl.ca.sh" download
                             role="button" aria-label='Скачать'>
                            <i class="fas fa-download fa-fw"></i>
                          </a>
                        </li>
                        <li class="list-inline-item" data-bs-tooltip data-bs-title='Открыть'>
                          <a class="text-body" href="/ru/articles/2023/10/6733cb51-62a0-5ed9-b421-8f08c4e0cb18/bash.openssl.ca.sh" target="_blank"
                             role="button" aria-label='Открыть'>
                            <i class="fas fa-arrow-up-right-from-square fa-fw"></i>
                          </a>
                        </li>
                      </ul>
                    </div>
                  </div>
                </div>
                <div class="card-body" id="cp-d93fe792b3477d5e8baa60d0fe5f88cc">
                    
                        
                    
                  <pre><code class="language-sh">#!/usr/bin/env -S bash -e
#
# OpenSSL certificate generator with CA.
#
# @package    Bash
# @author     Kai Kimera &lt;mail@kai.kim&gt;
# @copyright  2023 Library Online
# @license    MIT
# @version    0.1.2
# @link       https://lib.onl/ru/articles/2023/10/6733cb51-62a0-5ed9-b421-8f08c4e0cb18/
# -------------------------------------------------------------------------------------------------------------------- #

(( EUID == 0 )) &amp;&amp; { echo &gt;&amp;2 &#39;This script should not be run as root!&#39;; exit 1; }

# -------------------------------------------------------------------------------------------------------------------- #
# CONFIGURATION.
# -------------------------------------------------------------------------------------------------------------------- #

# Get &#39;date&#39; command.
date=&#34;$( command -v date )&#34;

# Get &#39;openssl&#39; command.
ossl=&#34;$( command -v openssl )&#34;

# Get &#39;shuf&#39; command.
shuf=&#34;$( command -v shuf )&#34;

# CA key &amp; certificate names.
ca_key=&#39;ca.root.key&#39;
ca_crt=&#39;ca.root.crt&#39;

# Specifies the number of days to make a certificate valid for.
# Default is 10 years.
days=&#39;3650&#39;

# Timestamp.
ts=&#34;$(( $( ${date} -u &#39;&#43;%s%N&#39; ) / 1000000 ))&#34;

# Suffix.
sfx=$( ${shuf} -i &#39;1000-9999&#39; -n 1 --random-source=&#39;/dev/random&#39; )

# -------------------------------------------------------------------------------------------------------------------- #
# -----------------------------------------------------&lt; SCRIPT &gt;----------------------------------------------------- #
# -------------------------------------------------------------------------------------------------------------------- #

# -------------------------------------------------------------------------------------------------------------------- #
# CERTIFICATE AUTHORITY.
# -------------------------------------------------------------------------------------------------------------------- #

ca() {
  local ec=&#39;secp384r1&#39;

  ! [[ -x &#34;${ossl}&#34; ]] &amp;&amp; { echo &gt;&amp;2 &#34;&#39;openssl&#39; is not installed!&#34;; exit 1; }

  echo &#34;&#34; &amp;&amp; echo &#34;--- [SSL] Certificate Authority&#34; &amp;&amp; echo &#34;&#34;
  ${ossl} req -x509 -newkey ec:&lt;( openssl ecparam -name &#34;${ec}&#34; ) -nodes -sha384 -days &#34;${days}&#34; \
    -keyout &#34;${ca_key}&#34; -out &#34;${ca_crt}&#34; \
    &amp;&amp; ${ossl} x509 -in &#34;${ca_crt}&#34; -text -noout
}

# -------------------------------------------------------------------------------------------------------------------- #
# CLIENT CERTIFICATE.
# -------------------------------------------------------------------------------------------------------------------- #

cert() {
  local ec=&#39;prime256v1&#39;
  local key_pvt=&#34;${ts}.${sfx}.private.key&#34;
  local key_pub=&#34;${ts}.${sfx}.public.key&#34;
  local csr=&#34;${ts}.${sfx}.csr&#34;
  local crt=&#34;${ts}.${sfx}.crt&#34;
  local p12=&#34;${ts}.${sfx}.p12&#34;
  local srl=&#34;${ts}.${sfx}.srl&#34;

  ! [[ -x &#34;${ossl}&#34; ]] &amp;&amp; { echo &gt;&amp;2 &#34;&#39;openssl&#39; is not installed!&#34;; exit 1; }
  ! [[ -x &#34;${shuf}&#34; ]] &amp;&amp; { echo &gt;&amp;2 &#34;&#39;shuf&#39; is not installed!&#34;; exit 1; }

  echo &#34;&#34; &amp;&amp; echo &#34;--- [SSL] Client Certificate [${ts}]&#34; &amp;&amp; echo &#34;&#34;
  ${ossl} ecparam -name &#34;${ec}&#34; -genkey -noout -out &#34;${key_pvt}&#34; \
    &amp;&amp; ${ossl} ec -in &#34;${key_pvt}&#34; -pubout -out &#34;${key_pub}&#34; \
    &amp;&amp; ${ossl} req -new -key &#34;${key_pvt}&#34; -out &#34;${csr}&#34; \
    &amp;&amp; ${ossl} x509 -req -in &#34;${csr}&#34; \
        -CA &#34;${ca_crt}&#34; -CAkey &#34;${ca_key}&#34; -days &#34;${days}&#34; \
        -CAcreateserial -CAserial &#34;${srl}&#34; \
        -out &#34;${crt}&#34; \
    &amp;&amp; ${ossl} pkcs12 -export \
        -inkey &#34;${key_pvt}&#34; \
        -in &#34;${crt}&#34; -out &#34;${p12}&#34; \
    &amp;&amp; ${ossl} verify -CAfile &#34;${ca_crt}&#34; &#34;${crt}&#34; \
    &amp;&amp; ${ossl} x509 -in &#34;${crt}&#34; -text -noout
}

&#34;$@&#34;</code></pre>
                </div>
              </div>
            </div>
        
    
<p>Скрипт содержит две функции, вызывать которых можно по отдельности. Функция <code>ca()</code> позволяет сгенерировать ключ и сертификат центра сертификации, а функция <code>cert()</code>, соответственно, генерирует клиентские сертификаты.</p>
<h3 id="использование">
  <a class="link-body-emphasis" href="#%d0%b8%d1%81%d0%bf%d0%be%d0%bb%d1%8c%d0%b7%d0%be%d0%b2%d0%b0%d0%bd%d0%b8%d0%b5">Использование</a>
</h3><ol>
<li>Создать ключ и сертификат центра сертификации:</li>
</ol>






<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-13 shortcode-codeblock-terminal
shortcode-codeblock-terminal-linux shortcode-codeblock-terminal-linux-user">
  <div class="card overflow-hidden" data-bs-theme="dark">
    <div class="card-header">
      <div class="d-flex align-items-center">
        <div class="flex-shrink-0 ">
          <i class="fas fa-terminal fa-fw"></i>
        </div>
        <div class="flex-grow-1 mx-2">
          <h5 class="mb-0">Терминал</h5>
        </div>
        <div class="flex-shrink-0">
          <ul class="list-inline mb-0">
            <li class="list-inline-item" data-bs-tooltip data-bs-title='Копировать'>
              <a class="text-body" href="#"
                 data-fn="clipboard preventDefault" data-clipboard-target="#cp-4ed51f0028a40fe74392ee8fd703dcfb"
                 role="button" aria-label='Копировать'>
                <i class="fas fa-copy fa-fw"></i>
              </a>
            </li>
          </ul>
        </div>
      </div>
    </div>
    <div class="card-body p-0" id="cp-4ed51f0028a40fe74392ee8fd703dcfb">
      <pre><code class="language-plaintext">bash bash.openssl.ca.sh ca</code></pre>
    </div>
  </div>
</div>

<ol start="2">
<li>Создать клиентские ключи и сертификаты:</li>
</ol>






<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-14 shortcode-codeblock-terminal
shortcode-codeblock-terminal-linux shortcode-codeblock-terminal-linux-user">
  <div class="card overflow-hidden" data-bs-theme="dark">
    <div class="card-header">
      <div class="d-flex align-items-center">
        <div class="flex-shrink-0 ">
          <i class="fas fa-terminal fa-fw"></i>
        </div>
        <div class="flex-grow-1 mx-2">
          <h5 class="mb-0">Терминал</h5>
        </div>
        <div class="flex-shrink-0">
          <ul class="list-inline mb-0">
            <li class="list-inline-item" data-bs-tooltip data-bs-title='Копировать'>
              <a class="text-body" href="#"
                 data-fn="clipboard preventDefault" data-clipboard-target="#cp-f4e395fea9fa95a8b6c504a8d4b00c24"
                 role="button" aria-label='Копировать'>
                <i class="fas fa-copy fa-fw"></i>
              </a>
            </li>
          </ul>
        </div>
      </div>
    </div>
    <div class="card-body p-0" id="cp-f4e395fea9fa95a8b6c504a8d4b00c24">
      <pre><code class="language-plaintext">bash bash.openssl.ca.sh cert</code></pre>
    </div>
  </div>
</div>

<p>Немного расскажу про алгоритм генерации сертификатов.</p>
<ol>
<li>У сертификата есть поле <code>Serial Number</code>, которое содержит серийный номер сертификата. Серийный номер сертификата это уникальный номер, выданный центром сертификации. В моём скрипте при генерации клиентского сертификата указаны опции <code>-CAcreateserial</code> и <code>-CAserial &quot;${srl}&quot;</code>, которые позволяют OpenSSL создавать рядом с клиентскими сертификатами файлы формата <code>.slr</code>, содержащие в себе серийные номера сгенерированных сертификатов. Таким образом можно создавать небольшую локальную базу данных выданных сертификатов.</li>
<li>Файл каждого клиентского сертификата генерируется с названием вида <code>[TS].[SFX].[EXE]</code>, где <code>[TS]</code> - это временная метка в микросекундах, <code>[SFX]</code> - числовой суффикс, а <code>[EXE]</code> - расширение файлов.</li>
</ol>
<p>На этом всё. Не исключаю факта присутствия ошибок или неточностей. Если что, жду предложения в электронную почту. <span class="shortcode shortcode-emoji">😄</span></p>
<h2 id="быстрое-создание-само-подписанного-сертификата">
  <a class="link-body-emphasis" href="#%d0%b1%d1%8b%d1%81%d1%82%d1%80%d0%be%d0%b5-%d1%81%d0%be%d0%b7%d0%b4%d0%b0%d0%bd%d0%b8%d0%b5-%d1%81%d0%b0%d0%bc%d0%be-%d0%bf%d0%be%d0%b4%d0%bf%d0%b8%d1%81%d0%b0%d0%bd%d0%bd%d0%be%d0%b3%d0%be-%d1%81%d0%b5%d1%80%d1%82%d0%b8%d1%84%d0%b8%d0%ba%d0%b0%d1%82%d0%b0">Быстрое создание само-подписанного сертификата</a>
</h2><p>Для быстрого создания само-подписанного сертификата, я написал пару небольших команд.</p>
<h3 id="ecc-elliptic-curve-cryptography">
  <a class="link-body-emphasis" href="#ecc-elliptic-curve-cryptography">ECC (Elliptic Curve Cryptography)</a>
</h3>


<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-16 shortcode-codeblock-bash">
  <div class="d-flex overflow-hidden">
    <div class="flex-grow-1 rounded overflow-hidden" id="cp-520c6b0b829afb5691c2f3efe2ae2841">
      
      <pre><code class='language-bash'>ossl_days=&#39;3650&#39;; ossl_country=&#39;RU&#39;; ossl_state=&#39;Russia&#39;; ossl_city=&#39;Moscow&#39;; ossl_org=&#39;RiK&#39;; ossl_host=&#39;example.com&#39;; openssl ecparam -genkey -name &#39;prime256v1&#39; -out &#34;${ossl_host}.key&#34; &amp;&amp; openssl req -new -sha256 -key &#34;${ossl_host}.key&#34; -out &#34;${ossl_host}.csr&#34; -subj &#34;/C=${ossl_country}/ST=${ossl_state}/L=${ossl_city}/O=${ossl_org}/CN=${ossl_host}&#34; -addext &#34;subjectAltName=DNS:${ossl_host},DNS:*.${ossl_host}&#34; &amp;&amp; openssl req -x509 -sha256 -days ${ossl_days} -key &#34;${ossl_host}.key&#34; -in &#34;${ossl_host}.csr&#34; -out &#34;${ossl_host}.crt&#34; &amp;&amp; openssl x509 -in &#34;${ossl_host}.crt&#34; -text -noout</code></pre>
    </div>
    <div class="flex-shrink-0">
      <ul class="list-inline mb-0">
        <li class="list-inline-item" data-bs-tooltip data-bs-title='Копировать'>
          <a class="text-body" href="#"
             data-fn="clipboard preventDefault" data-clipboard-target="#cp-520c6b0b829afb5691c2f3efe2ae2841"
             role="button" aria-label='Копировать'>
            <i class="fas fa-copy fa-fw"></i>
          </a>
        </li>
      </ul>
    </div>
  </div>
</div>

<p>Где:</p>
<ul>
<li><code>ossl_days</code> - количество дней валидности сертификата.</li>
<li><code>ossl_country</code> - страна.</li>
<li><code>ossl_state</code> - штат.</li>
<li><code>ossl_city</code> - город.</li>
<li><code>ossl_org</code> - организация.</li>
<li><code>ossl_host</code> - хост.</li>
</ul>
<h3 id="rsa-rivest-shamir-adleman">
  <a class="link-body-emphasis" href="#rsa-rivest-shamir-adleman">RSA (Rivest-Shamir-Adleman)</a>
</h3>


<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-17 shortcode-codeblock-bash">
  <div class="d-flex overflow-hidden">
    <div class="flex-grow-1 rounded overflow-hidden" id="cp-ad7ecebf097438e0a3b71d5be7181556">
      
      <pre><code class='language-bash'>ossl_days=&#39;3650&#39;; ossl_country=&#39;RU&#39;; ossl_state=&#39;Russia&#39;; ossl_city=&#39;Moscow&#39;; ossl_org=&#39;RiK&#39;; ossl_host=&#39;example.com&#39;; openssl genrsa -out &#34;${ossl_host}.key&#34; 2048 &amp;&amp; openssl req -new -sha256 -key &#34;${ossl_host}.key&#34; -out &#34;${ossl_host}.csr&#34; -subj &#34;/C=${ossl_country}/ST=${ossl_state}/L=${ossl_city}/O=${ossl_org}/CN=${ossl_host}&#34; -addext &#34;subjectAltName=DNS:${ossl_host},DNS:*.${ossl_host}&#34; &amp;&amp; openssl req -x509 -sha256 -days ${ossl_days} -key &#34;${ossl_host}.key&#34; -in &#34;${ossl_host}.csr&#34; -out &#34;${ossl_host}.crt&#34; &amp;&amp; openssl x509 -in &#34;${ossl_host}.crt&#34; -text -noout</code></pre>
    </div>
    <div class="flex-shrink-0">
      <ul class="list-inline mb-0">
        <li class="list-inline-item" data-bs-tooltip data-bs-title='Копировать'>
          <a class="text-body" href="#"
             data-fn="clipboard preventDefault" data-clipboard-target="#cp-ad7ecebf097438e0a3b71d5be7181556"
             role="button" aria-label='Копировать'>
            <i class="fas fa-copy fa-fw"></i>
          </a>
        </li>
      </ul>
    </div>
  </div>
</div>

<p>Где:</p>
<ul>
<li><code>ossl_days</code> - количество дней валидности сертификата.</li>
<li><code>ossl_country</code> - страна.</li>
<li><code>ossl_state</code> - штат.</li>
<li><code>ossl_city</code> - город.</li>
<li><code>ossl_org</code> - организация.</li>
<li><code>ossl_host</code> - хост.</li>
</ul>
<h3 id="скрипт">
  <a class="link-body-emphasis" href="#%d1%81%d0%ba%d1%80%d0%b8%d0%bf%d1%82">Скрипт</a>
</h3>
    

    
        
            
            <div class="shortcode shortcode-file mb-3">
              <div class="card overflow-hidden">
                <div class="card-header">
                  <div class="d-flex align-items-center">
                    <div class="flex-shrink-0">
                      <i class="far fa-file-code fa-fw"></i>
                    </div>
                    <div class="flex-grow-1 mx-2 text-truncate">
                      <code>bash.openssl.ssc.sh</code>
                    </div>
                    <div class="flex-shrink-0">
                      <ul class="list-inline mb-0">
                        <li class="list-inline-item" data-bs-tooltip data-bs-title='Копировать'>
                          <a class="text-body" href="#"
                             data-fn="clipboard preventDefault" data-clipboard-target="#cp-7d5b82efa3bc6cb2e4477de5964d1cde"
                             role="button" aria-label='Копировать'>
                            <i class="fas fa-copy fa-fw"></i>
                          </a>
                        </li>
                        <li class="list-inline-item" data-bs-tooltip data-bs-title='Скачать'>
                          <a class="text-body" href="/ru/articles/2023/10/6733cb51-62a0-5ed9-b421-8f08c4e0cb18/bash.openssl.ssc.sh" download
                             role="button" aria-label='Скачать'>
                            <i class="fas fa-download fa-fw"></i>
                          </a>
                        </li>
                        <li class="list-inline-item" data-bs-tooltip data-bs-title='Открыть'>
                          <a class="text-body" href="/ru/articles/2023/10/6733cb51-62a0-5ed9-b421-8f08c4e0cb18/bash.openssl.ssc.sh" target="_blank"
                             role="button" aria-label='Открыть'>
                            <i class="fas fa-arrow-up-right-from-square fa-fw"></i>
                          </a>
                        </li>
                      </ul>
                    </div>
                  </div>
                </div>
                <div class="card-body" id="cp-7d5b82efa3bc6cb2e4477de5964d1cde">
                    
                        
                    
                  <pre><code class="language-sh">#!/usr/bin/env -S bash -e
#
# OpenSSL self signed certificate generator.
#
# @package    Bash
# @author     Kai Kimera &lt;mail@kai.kim&gt;
# @copyright  2024 Library Online
# @license    MIT
# @version    0.1.0
# @link       https://lib.onl/ru/articles/2023/10/6733cb51-62a0-5ed9-b421-8f08c4e0cb18/
# -------------------------------------------------------------------------------------------------------------------- #

(( EUID == 0 )) &amp;&amp; { echo &gt;&amp;2 &#39;This script should not be run as root!&#39;; exit 1; }

# -------------------------------------------------------------------------------------------------------------------- #
# CONFIGURATION.
# -------------------------------------------------------------------------------------------------------------------- #

# Get &#39;openssl&#39; command.
ossl=&#34;$( command -v openssl )&#34;

# Specifies the number of days to make a certificate valid for.
# Default is 10 years.
days=&#39;3650&#39;

# The two-letter country code where your company is legally located.
country=&#39;RU&#39;

# The state/province where your company is legally located.
state=&#39;Russia&#39;

# The city where your company is legally located.
city=&#39;Moscow&#39;

# Your company&#39;s legally registered name (e.g., YourCompany, Inc.).
org=&#39;YourCompany&#39;

# The fully-qualified domain name (FQDN) (e.g., www.example.com).
host=&#34;${1:-example.com}&#34;

# Your email address.
email=&#34;mail@${host}&#34;

# -------------------------------------------------------------------------------------------------------------------- #
# -----------------------------------------------------&lt; SCRIPT &gt;----------------------------------------------------- #
# -------------------------------------------------------------------------------------------------------------------- #

! [[ -x &#34;${ossl}&#34; ]] &amp;&amp; { echo &gt;&amp;2 &#34;&#39;openssl&#39; is not installed!&#34;; exit 1; }

echo &#34;&#34; &amp;&amp; echo &#34;--- [SSL] Self Signed Certificate: &#39;${host}&#39;&#34; &amp;&amp; echo &#34;&#34;

if [[ &#34;${2}&#34; = &#39;rsa&#39; ]]; then
  ${ossl} genrsa -out &#34;${host}.key&#34; 2048
else
  ${ossl} ecparam -genkey -name &#39;prime256v1&#39; -out &#34;${host}.key&#34;
fi

if [[ -f &#34;${host}.key&#34; ]]; then
  ${ossl} req -new -sha256 -key &#34;${host}.key&#34; -out &#34;${host}.csr&#34; \
    -subj &#34;/C=${country}/ST=${state}/L=${city}/O=${org}/emailAddress=${email}/CN=${host}&#34; \
    -addext &#34;subjectAltName=DNS:${host},DNS:*.${host}&#34; \
    &amp;&amp; ${ossl} req -x509 -sha256 -days ${days} \
      -key &#34;${host}.key&#34; -in &#34;${host}.csr&#34; -out &#34;${host}.crt&#34; \
    &amp;&amp; ${ossl} x509 -in &#34;${host}.crt&#34; -text -noout
else
  echo &#34;&#39;${host}.key&#39; not found!&#34; &amp;&amp; exit 1
fi

exit 0</code></pre>
                </div>
              </div>
            </div>]]></turbo:content></item><item turbo="true"><title>Дополнительная страница для vBulletin 4</title><link>https://lib.onl/ru/articles/2023/10/382d49d6-8f44-5367-bf24-88890d7c4723/</link><pubDate>Tue, 17 Oct 2023 18:01:38 +0000</pubDate><dc:creator>Kai Kimera</dc:creator><category>CMF</category><category>В истории</category><yandex:related><link url="https://lib.onl/ru/articles/2023/10/01d19479-028f-5b81-9c58-9c99adb08461/">Дополнительная страница для vBulletin 3</link><link url="https://lib.onl/ru/articles/2023/10/c079a268-5fb5-5d0d-8c00-0202630ce13d/">Условия в шаблонах для vBulletin 4</link><link url="https://lib.onl/ru/articles/2023/10/f82b1436-6752-5084-ba98-264b264edca7/">Условия в шаблонах для vBulletin 3</link><link url="https://lib.onl/ru/articles/2023/10/f0463a78-0393-5891-bbe5-c39ec575ae75/">Дополнительная страница для IP.Board 2.3</link><link url="https://lib.onl/ru/articles/2023/10/560dfed8-9a25-5db3-95a6-a7df8129e960/">Невидимые ссылки для гостей на IP.Board 2.3</link><link url="https://lib.onl/ru/articles/2023/10/347826e1-53d9-5c99-a6f8-66fc359323a2/">Динамическое "(Powered by Invision Power Board)" на IP.Board 2.3</link><link url="https://lib.onl/ru/articles/2023/10/d477b5ce-8095-5607-91c7-5c5ad7b7f146/">Читабельные ссылки на темы форума для IP.Board 2.3</link><link url="https://lib.onl/ru/articles/2023/10/a0756cae-ae3c-59ff-b587-ee8c7f3247c8/">FAQ для IP.Board 2.3</link><link url="https://lib.onl/ru/articles/2023/10/54d4e488-9a8f-55ed-8fea-c77d4dba0720/">SQL запросы IP.Board 2.3</link><link url="https://lib.onl/ru/articles/2023/10/06c9d359-31f0-5862-a342-62a21d4eb032/">SQL запросы IP.Board 3.x</link><link url="https://lib.onl/ru/articles/2023/10/0743e73e-7c4c-5ab8-bba3-ba70bdb5cdfd/">Условия в файлах IP.Board 2.3</link><link url="https://lib.onl/ru/articles/2023/10/d310a44c-4259-5bef-a7c2-d3d09a5c69f4/">Условия в шаблонах IP.Board 2.3</link><link url="https://lib.onl/ru/articles/2023/10/a7405294-9f0c-52c1-a70e-ce4990079dc7/">Условия в шаблонах IP.Board 3.x</link></yandex:related><turbo:extendedHtml>true</turbo:extendedHtml><turbo:source>https://lib.onl/ru/articles/2023/10/382d49d6-8f44-5367-bf24-88890d7c4723/</turbo:source><turbo:topic>Дополнительная страница для vBulletin 4</turbo:topic><turbo:content><![CDATA[<p>Создание дополнительных страниц для уже устаревшего форумного движка <span class="shortcode shortcode-tag"><a href="/ru/tags/vbulletin/" target="_blank">#vBulletin</a></span> 4.</p>
<p>Для <span class="shortcode shortcode-tag"><a href="/ru/tags/vbulletin/" target="_blank">#vBulletin</a></span> версии <strong>4.0</strong> действия практически одни и те же, как в материале <span class="shortcode shortcode-uuid"><a href="/ru/articles/2023/10/01d19479-028f-5b81-9c58-9c99adb08461/">Дополнительная страница для vBulletin 3</a></span>.</p>
<h2 id="что-такое-дополнительная-страница-или-custom-pages">
  <a class="link-body-emphasis" href="#%d1%87%d1%82%d0%be-%d1%82%d0%b0%d0%ba%d0%be%d0%b5-%d0%b4%d0%be%d0%bf%d0%be%d0%bb%d0%bd%d0%b8%d1%82%d0%b5%d0%bb%d1%8c%d0%bd%d0%b0%d1%8f-%d1%81%d1%82%d1%80%d0%b0%d0%bd%d0%b8%d1%86%d0%b0-%d0%b8%d0%bb%d0%b8-custom-pages">Что такое дополнительная страница (или Custom Pages)?</a>
</h2><p>Дополнительная страница (или Custom Pages) - это страница, &ldquo;совмещённая&rdquo; со стилем форума.</p>
<h2 id="как-сделать-дополнительную-страницу">
  <a class="link-body-emphasis" href="#%d0%ba%d0%b0%d0%ba-%d1%81%d0%b4%d0%b5%d0%bb%d0%b0%d1%82%d1%8c-%d0%b4%d0%be%d0%bf%d0%be%d0%bb%d0%bd%d0%b8%d1%82%d0%b5%d0%bb%d1%8c%d0%bd%d1%83%d1%8e-%d1%81%d1%82%d1%80%d0%b0%d0%bd%d0%b8%d1%86%d1%83">Как сделать дополнительную страницу?</a>
</h2><p>Необходимо создать шаблон <code>custom_ШАБЛОН</code>, содержимое которого представляет собой следующий код:</p>



<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-3 shortcode-codeblock-html">
  <div class="d-flex overflow-hidden">
    <div class="flex-grow-1 rounded overflow-hidden" id="cp-ac6cb8ad329ad836939a439190d3ced3">
      
      <pre><code class='language-html'>{vb:stylevar htmldoctype}
&lt;html xmlns=&#34;http://www.w3.org/1999/xhtml&#34; dir=&#34;{vb:stylevar textdirection}&#34; lang=&#34;{vb:stylevar languagecode}&#34; id=&#34;vbulletin_html&#34;&gt;
&lt;head&gt;
  &lt;title&gt;{vb:raw vboptions.bbtitle}&lt;/title&gt;
  {vb:raw headinclude}
&lt;/head&gt;
&lt;body&gt;
  {vb:raw header}
  {vb:raw navbar}
  &lt;div id=&#34;pagetitle&#34;&gt;
    &lt;h1&gt;{vb:raw pagetitle}&lt;/h1&gt;
  &lt;/div&gt;
  &lt;h2 class=&#34;blockhead&#34;&gt;&lt;!-- Заголовок страницы --&gt;&lt;/h2&gt;
    &lt;div class=&#34;blockbody&#34;&gt;
    &lt;div class=&#34;blockrow&#34;&gt;
      &lt;!-- Текст страницы --&gt;
    &lt;/div&gt;
  &lt;/div&gt;
  {vb:raw footer}
&lt;/body&gt;
&lt;/html&gt;</code></pre>
    </div>
    <div class="flex-shrink-0">
      <ul class="list-inline mb-0">
        <li class="list-inline-item" data-bs-tooltip data-bs-title='Копировать'>
          <a class="text-body" href="#"
             data-fn="clipboard preventDefault" data-clipboard-target="#cp-ac6cb8ad329ad836939a439190d3ced3"
             role="button" aria-label='Копировать'>
            <i class="fas fa-copy fa-fw"></i>
          </a>
        </li>
      </ul>
    </div>
  </div>
</div>

<p>Страница будет располагаться по адресу:</p>



<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-4 ">
  <div class="d-flex overflow-hidden">
    <div class="flex-grow-1 rounded overflow-hidden" id="cp-a0bf36a5c873284e84de210e55d6e9c6">
      
      <pre><code >https://example.com/misc.php?do=page&amp;template=ШАБЛОН</code></pre>
    </div>
    <div class="flex-shrink-0">
      <ul class="list-inline mb-0">
        <li class="list-inline-item" data-bs-tooltip data-bs-title='Копировать'>
          <a class="text-body" href="#"
             data-fn="clipboard preventDefault" data-clipboard-target="#cp-a0bf36a5c873284e84de210e55d6e9c6"
             role="button" aria-label='Копировать'>
            <i class="fas fa-copy fa-fw"></i>
          </a>
        </li>
      </ul>
    </div>
  </div>
</div>]]></turbo:content></item><item turbo="true"><title>Дополнительная страница для vBulletin 3</title><link>https://lib.onl/ru/articles/2023/10/01d19479-028f-5b81-9c58-9c99adb08461/</link><pubDate>Tue, 17 Oct 2023 17:39:09 +0000</pubDate><dc:creator>Kai Kimera</dc:creator><category>CMF</category><category>В истории</category><yandex:related><link url="https://lib.onl/ru/articles/2023/10/c079a268-5fb5-5d0d-8c00-0202630ce13d/">Условия в шаблонах для vBulletin 4</link><link url="https://lib.onl/ru/articles/2023/10/f82b1436-6752-5084-ba98-264b264edca7/">Условия в шаблонах для vBulletin 3</link><link url="https://lib.onl/ru/articles/2023/10/f0463a78-0393-5891-bbe5-c39ec575ae75/">Дополнительная страница для IP.Board 2.3</link><link url="https://lib.onl/ru/articles/2023/10/560dfed8-9a25-5db3-95a6-a7df8129e960/">Невидимые ссылки для гостей на IP.Board 2.3</link><link url="https://lib.onl/ru/articles/2023/10/347826e1-53d9-5c99-a6f8-66fc359323a2/">Динамическое "(Powered by Invision Power Board)" на IP.Board 2.3</link><link url="https://lib.onl/ru/articles/2023/10/d477b5ce-8095-5607-91c7-5c5ad7b7f146/">Читабельные ссылки на темы форума для IP.Board 2.3</link><link url="https://lib.onl/ru/articles/2023/10/a0756cae-ae3c-59ff-b587-ee8c7f3247c8/">FAQ для IP.Board 2.3</link><link url="https://lib.onl/ru/articles/2023/10/54d4e488-9a8f-55ed-8fea-c77d4dba0720/">SQL запросы IP.Board 2.3</link><link url="https://lib.onl/ru/articles/2023/10/06c9d359-31f0-5862-a342-62a21d4eb032/">SQL запросы IP.Board 3.x</link><link url="https://lib.onl/ru/articles/2023/10/0743e73e-7c4c-5ab8-bba3-ba70bdb5cdfd/">Условия в файлах IP.Board 2.3</link><link url="https://lib.onl/ru/articles/2023/10/d310a44c-4259-5bef-a7c2-d3d09a5c69f4/">Условия в шаблонах IP.Board 2.3</link><link url="https://lib.onl/ru/articles/2023/10/a7405294-9f0c-52c1-a70e-ce4990079dc7/">Условия в шаблонах IP.Board 3.x</link></yandex:related><turbo:extendedHtml>true</turbo:extendedHtml><turbo:source>https://lib.onl/ru/articles/2023/10/01d19479-028f-5b81-9c58-9c99adb08461/</turbo:source><turbo:topic>Дополнительная страница для vBulletin 3</turbo:topic><turbo:content><![CDATA[<p>Материал по созданию дополнительных страниц в <span class="shortcode shortcode-tag"><a href="/ru/tags/vbulletin/" target="_blank">#vBulletin</a></span> 3. Возможно, кто-то ещё пользуется этой версией движка&hellip;</p>
<h2 id="что-такое-дополнительная-страница-или-custom-pages">
  <a class="link-body-emphasis" href="#%d1%87%d1%82%d0%be-%d1%82%d0%b0%d0%ba%d0%be%d0%b5-%d0%b4%d0%be%d0%bf%d0%be%d0%bb%d0%bd%d0%b8%d1%82%d0%b5%d0%bb%d1%8c%d0%bd%d0%b0%d1%8f-%d1%81%d1%82%d1%80%d0%b0%d0%bd%d0%b8%d1%86%d0%b0-%d0%b8%d0%bb%d0%b8-custom-pages">Что такое дополнительная страница (или Custom Pages)?</a>
</h2><p>Дополнительная страница (или Custom Pages) - это страница, &ldquo;совмещённая&rdquo; со стилем форума и находится по адресу:</p>



<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-1 ">
  <div class="d-flex overflow-hidden">
    <div class="flex-grow-1 rounded overflow-hidden" id="cp-c6f681b0f2542f0f957804817ab8ae10">
      
      <pre><code >http://example.com/misc.php?do=page&amp;template=название_страницы</code></pre>
    </div>
    <div class="flex-shrink-0">
      <ul class="list-inline mb-0">
        <li class="list-inline-item" data-bs-tooltip data-bs-title='Копировать'>
          <a class="text-body" href="#"
             data-fn="clipboard preventDefault" data-clipboard-target="#cp-c6f681b0f2542f0f957804817ab8ae10"
             role="button" aria-label='Копировать'>
            <i class="fas fa-copy fa-fw"></i>
          </a>
        </li>
      </ul>
    </div>
  </div>
</div>

<h2 id="как-сделать-дополнительную-страницу">
  <a class="link-body-emphasis" href="#%d0%ba%d0%b0%d0%ba-%d1%81%d0%b4%d0%b5%d0%bb%d0%b0%d1%82%d1%8c-%d0%b4%d0%be%d0%bf%d0%be%d0%bb%d0%bd%d0%b8%d1%82%d0%b5%d0%bb%d1%8c%d0%bd%d1%83%d1%8e-%d1%81%d1%82%d1%80%d0%b0%d0%bd%d0%b8%d1%86%d1%83">Как сделать дополнительную страницу?</a>
</h2><p>Итак, для начала нужно создать дополнительный шаблон того стиля, который вами используется. Этот дополнительный шаблон должен иметь префикс <code>custom_</code>, то есть само название дополнительного шаблона должно выглядеть вот так: <code>custom_ШАБЛОН</code>.</p>
<p>После этого в тело шаблона вставляем следующий код:</p>



<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-2 shortcode-codeblock-html">
  <div class="d-flex overflow-hidden">
    <div class="flex-grow-1 rounded overflow-hidden" id="cp-9ad98458b849a999ba9f719d2cf58005">
      
      <pre><code class='language-html'>$stylevar[htmldoctype]
&lt;html dir=&#34;$stylevar[textdirection]&#34; lang=&#34;$stylevar[languagecode]&#34;&gt;
  &lt;head&gt;
    $headinclude
    &lt;title&gt;$vboptions[bbtitle]&lt;/title&gt;
  &lt;/head&gt;
  &lt;body&gt;
    $header
    $navbar
    &lt;!-- На этом месте будет находится ваш код страницы. --&gt;
    $footer
  &lt;/body&gt;
&lt;/html&gt;</code></pre>
    </div>
    <div class="flex-shrink-0">
      <ul class="list-inline mb-0">
        <li class="list-inline-item" data-bs-tooltip data-bs-title='Копировать'>
          <a class="text-body" href="#"
             data-fn="clipboard preventDefault" data-clipboard-target="#cp-9ad98458b849a999ba9f719d2cf58005"
             role="button" aria-label='Копировать'>
            <i class="fas fa-copy fa-fw"></i>
          </a>
        </li>
      </ul>
    </div>
  </div>
</div>

<p>Вот и всё!</p>]]></turbo:content></item><item turbo="true"><title>Дополнительная страница для IP.Board 2.3</title><link>https://lib.onl/ru/articles/2023/10/f0463a78-0393-5891-bbe5-c39ec575ae75/</link><pubDate>Tue, 17 Oct 2023 17:39:08 +0000</pubDate><dc:creator>Kai Kimera</dc:creator><category>CMF</category><category>В истории</category><yandex:related><link url="https://lib.onl/ru/articles/2023/10/560dfed8-9a25-5db3-95a6-a7df8129e960/">Невидимые ссылки для гостей на IP.Board 2.3</link><link url="https://lib.onl/ru/articles/2023/10/347826e1-53d9-5c99-a6f8-66fc359323a2/">Динамическое "(Powered by Invision Power Board)" на IP.Board 2.3</link><link url="https://lib.onl/ru/articles/2023/10/d477b5ce-8095-5607-91c7-5c5ad7b7f146/">Читабельные ссылки на темы форума для IP.Board 2.3</link><link url="https://lib.onl/ru/articles/2023/10/a0756cae-ae3c-59ff-b587-ee8c7f3247c8/">FAQ для IP.Board 2.3</link><link url="https://lib.onl/ru/articles/2023/10/54d4e488-9a8f-55ed-8fea-c77d4dba0720/">SQL запросы IP.Board 2.3</link><link url="https://lib.onl/ru/articles/2023/10/06c9d359-31f0-5862-a342-62a21d4eb032/">SQL запросы IP.Board 3.x</link><link url="https://lib.onl/ru/articles/2023/10/0743e73e-7c4c-5ab8-bba3-ba70bdb5cdfd/">Условия в файлах IP.Board 2.3</link><link url="https://lib.onl/ru/articles/2023/10/d310a44c-4259-5bef-a7c2-d3d09a5c69f4/">Условия в шаблонах IP.Board 2.3</link><link url="https://lib.onl/ru/articles/2023/10/a7405294-9f0c-52c1-a70e-ce4990079dc7/">Условия в шаблонах IP.Board 3.x</link><link url="https://lib.onl/ru/articles/2023/10/c079a268-5fb5-5d0d-8c00-0202630ce13d/">Условия в шаблонах для vBulletin 4</link><link url="https://lib.onl/ru/articles/2023/10/f82b1436-6752-5084-ba98-264b264edca7/">Условия в шаблонах для vBulletin 3</link></yandex:related><turbo:extendedHtml>true</turbo:extendedHtml><turbo:source>https://lib.onl/ru/articles/2023/10/f0463a78-0393-5891-bbe5-c39ec575ae75/</turbo:source><turbo:topic>Дополнительная страница для IP.Board 2.3</turbo:topic><turbo:content><![CDATA[<p>Ещё один артефакт прошлого. Инструкция по созданию дополнительных страниц в <span class="shortcode shortcode-tag"><a href="/ru/tags/ipb/" target="_blank">#IPB</a></span> 2.3. Старая, но вдруг кому-то пригодится.</p>
<h2 id="что-такое-дополнительная-страница-или-custom-pages">
  <a class="link-body-emphasis" href="#%d1%87%d1%82%d0%be-%d1%82%d0%b0%d0%ba%d0%be%d0%b5-%d0%b4%d0%be%d0%bf%d0%be%d0%bb%d0%bd%d0%b8%d1%82%d0%b5%d0%bb%d1%8c%d0%bd%d0%b0%d1%8f-%d1%81%d1%82%d1%80%d0%b0%d0%bd%d0%b8%d1%86%d0%b0-%d0%b8%d0%bb%d0%b8-custom-pages">Что такое дополнительная страница (или Custom Pages)?</a>
</h2><p>Дополнительная страница (или Custom Pages) - это страница, &ldquo;совмещённая&rdquo; со стилем форума и находится по адресу:</p>



<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-1 ">
  <div class="d-flex overflow-hidden">
    <div class="flex-grow-1 rounded overflow-hidden" id="cp-b79d0727cafa9163d4ae0745cc9942a3">
      
      <pre><code >http://example.com/index.php?autocom=название_страницы</code></pre>
    </div>
    <div class="flex-shrink-0">
      <ul class="list-inline mb-0">
        <li class="list-inline-item" data-bs-tooltip data-bs-title='Копировать'>
          <a class="text-body" href="#"
             data-fn="clipboard preventDefault" data-clipboard-target="#cp-b79d0727cafa9163d4ae0745cc9942a3"
             role="button" aria-label='Копировать'>
            <i class="fas fa-copy fa-fw"></i>
          </a>
        </li>
      </ul>
    </div>
  </div>
</div>

<p>Объект <code>название_страницы</code> представляет собой название файла <code>.php</code> дополнительной страницы.</p>
<h2 id="как-сделать-дополнительную-страницу">
  <a class="link-body-emphasis" href="#%d0%ba%d0%b0%d0%ba-%d1%81%d0%b4%d0%b5%d0%bb%d0%b0%d1%82%d1%8c-%d0%b4%d0%be%d0%bf%d0%be%d0%bb%d0%bd%d0%b8%d1%82%d0%b5%d0%bb%d1%8c%d0%bd%d1%83%d1%8e-%d1%81%d1%82%d1%80%d0%b0%d0%bd%d0%b8%d1%86%d1%83">Как сделать дополнительную страницу?</a>
</h2><p>Создаём файл <code>.php</code> следующего содержания:</p>
<p>


<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-2 shortcode-codeblock-php">
  <div class="d-flex overflow-hidden">
    <div class="flex-grow-1 rounded overflow-hidden" id="cp-367e12bce3701e41019d8cd4d54ea3c6">
      
      <pre><code class='language-php'>&lt;?php
class component_public
{
  var $ipsclass;

  function run_component()
  {
    $this-&gt;pagetitle = &#34;Название страницы&#34;;
    /* Здесь идёт название вашей страницы.
    Название также будет показано в панели навигации вашего форума. */

    $this-&gt;nav[] = &#34;&lt;a href=&#39;{$this-&gt;ipsclass-&gt;base_url}autocom=custom&#39;&gt;{$this-&gt;pagetitle}&lt;/a&gt;&#34;;
    $this-&gt;ipsclass-&gt;load_template(&#39;skin_global&#39;);

    $output .= &#34;Здесь содержимое страницы&#34;;
    /* Здесь будет содержимое вашей будущей страницы.
    Содержимое помещается между кавычками.
    Также, как обычно, вам доступен HTML-код. */

    $this-&gt;ipsclass-&gt;print-&gt;add_output($output);
    $this-&gt;ipsclass-&gt;print-&gt;do_output(array(&#39;TITLE&#39; =&gt; &#34;{$this-&gt;ipsclass-&gt;vars[&#39;board_name&#39;]} - {$this-&gt;pagetitle}&#34;, &#39;JS&#39; =&gt; 0, &#39;NAV&#39; =&gt; $this-&gt;nav));
  }
}</code></pre>
    </div>
    <div class="flex-shrink-0">
      <ul class="list-inline mb-0">
        <li class="list-inline-item" data-bs-tooltip data-bs-title='Копировать'>
          <a class="text-body" href="#"
             data-fn="clipboard preventDefault" data-clipboard-target="#cp-367e12bce3701e41019d8cd4d54ea3c6"
             role="button" aria-label='Копировать'>
            <i class="fas fa-copy fa-fw"></i>
          </a>
        </li>
      </ul>
    </div>
  </div>
</div>

В самом коде установлены комментарии, так что вы без труда разберётесь что к чему.</p>
<p>После создания этого PHP-файла, вы должны поместить его в папку <code>./sources/components_public</code>.</p>
<p>Всё!</p>]]></turbo:content></item><item turbo="true"><title>Условия в шаблонах для vBulletin 4</title><link>https://lib.onl/ru/articles/2023/10/c079a268-5fb5-5d0d-8c00-0202630ce13d/</link><pubDate>Tue, 17 Oct 2023 17:20:56 +0000</pubDate><dc:creator>Kai Kimera</dc:creator><category>CMF</category><category>В истории</category><yandex:related><link url="https://lib.onl/ru/articles/2023/10/f82b1436-6752-5084-ba98-264b264edca7/">Условия в шаблонах для vBulletin 3</link><link url="https://lib.onl/ru/articles/2023/10/560dfed8-9a25-5db3-95a6-a7df8129e960/">Невидимые ссылки для гостей на IP.Board 2.3</link><link url="https://lib.onl/ru/articles/2023/10/347826e1-53d9-5c99-a6f8-66fc359323a2/">Динамическое "(Powered by Invision Power Board)" на IP.Board 2.3</link><link url="https://lib.onl/ru/articles/2023/10/d477b5ce-8095-5607-91c7-5c5ad7b7f146/">Читабельные ссылки на темы форума для IP.Board 2.3</link><link url="https://lib.onl/ru/articles/2023/10/a0756cae-ae3c-59ff-b587-ee8c7f3247c8/">FAQ для IP.Board 2.3</link><link url="https://lib.onl/ru/articles/2023/10/54d4e488-9a8f-55ed-8fea-c77d4dba0720/">SQL запросы IP.Board 2.3</link><link url="https://lib.onl/ru/articles/2023/10/06c9d359-31f0-5862-a342-62a21d4eb032/">SQL запросы IP.Board 3.x</link><link url="https://lib.onl/ru/articles/2023/10/0743e73e-7c4c-5ab8-bba3-ba70bdb5cdfd/">Условия в файлах IP.Board 2.3</link><link url="https://lib.onl/ru/articles/2023/10/d310a44c-4259-5bef-a7c2-d3d09a5c69f4/">Условия в шаблонах IP.Board 2.3</link><link url="https://lib.onl/ru/articles/2023/10/a7405294-9f0c-52c1-a70e-ce4990079dc7/">Условия в шаблонах IP.Board 3.x</link></yandex:related><turbo:extendedHtml>true</turbo:extendedHtml><turbo:source>https://lib.onl/ru/articles/2023/10/c079a268-5fb5-5d0d-8c00-0202630ce13d/</turbo:source><turbo:topic>Условия в шаблонах для vBulletin 4</turbo:topic><turbo:content><![CDATA[<p>Набор условий для применения в шаблонах форумного движка <span class="shortcode shortcode-tag"><a href="/ru/tags/vbulletin/" target="_blank">#vBulletin</a></span> 4. К сожалению, версия 4 оказалась провальной. Зато, из неё родился всем известный <span class="shortcode shortcode-tag"><a href="/ru/tags/xenforo/" target="_blank">#XenForo</a></span>!</p>
<h2 id="обычные-условия">
  <a class="link-body-emphasis" href="#%d0%be%d0%b1%d1%8b%d1%87%d0%bd%d1%8b%d0%b5-%d1%83%d1%81%d0%bb%d0%be%d0%b2%d0%b8%d1%8f">Обычные условия</a>
</h2><ol>
<li>Показать информацию только для пользователей</li>
</ol>



<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-2 shortcode-codeblock-html">
  <div class="d-flex overflow-hidden">
    <div class="flex-grow-1 rounded overflow-hidden" id="cp-8d1669f214b988f16f93f6c04496805f">
      
      <pre><code class='language-html'>&lt;vb:if condition=&#34;$show[&#39;member&#39;]&#34;&gt;
  &lt;!-- информация только для пользователей --&gt;
&lt;/vb:if&gt;</code></pre>
    </div>
    <div class="flex-shrink-0">
      <ul class="list-inline mb-0">
        <li class="list-inline-item" data-bs-tooltip data-bs-title='Копировать'>
          <a class="text-body" href="#"
             data-fn="clipboard preventDefault" data-clipboard-target="#cp-8d1669f214b988f16f93f6c04496805f"
             role="button" aria-label='Копировать'>
            <i class="fas fa-copy fa-fw"></i>
          </a>
        </li>
      </ul>
    </div>
  </div>
</div>

<ol start="2">
<li>Показать информацию только для гостей</li>
</ol>



<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-3 shortcode-codeblock-html">
  <div class="d-flex overflow-hidden">
    <div class="flex-grow-1 rounded overflow-hidden" id="cp-af7348ec6e41c4ee00a30720471ee806">
      
      <pre><code class='language-html'>&lt;vb:if condition=&#34;$show[&#39;guest&#39;]&#34;&gt;
  &lt;!-- информация только для гостей --&gt;
&lt;/vb:if&gt;</code></pre>
    </div>
    <div class="flex-shrink-0">
      <ul class="list-inline mb-0">
        <li class="list-inline-item" data-bs-tooltip data-bs-title='Копировать'>
          <a class="text-body" href="#"
             data-fn="clipboard preventDefault" data-clipboard-target="#cp-af7348ec6e41c4ee00a30720471ee806"
             role="button" aria-label='Копировать'>
            <i class="fas fa-copy fa-fw"></i>
          </a>
        </li>
      </ul>
    </div>
  </div>
</div>

<ol start="3">
<li>Показать информацию только для определённой группы.</li>
</ol>



<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-4 shortcode-codeblock-html">
  <div class="d-flex overflow-hidden">
    <div class="flex-grow-1 rounded overflow-hidden" id="cp-a596e65bf12790f690478cf75a44d5f4">
      
      <pre><code class='language-html'>&lt;vb:if condition=&#34;is_member_of($bbuserinfo, 1,2,3)&#34;&gt;
  &lt;!-- информация только для группы с ID = 1, 2 и 3 --&gt;
&lt;/vb:if&gt;</code></pre>
    </div>
    <div class="flex-shrink-0">
      <ul class="list-inline mb-0">
        <li class="list-inline-item" data-bs-tooltip data-bs-title='Копировать'>
          <a class="text-body" href="#"
             data-fn="clipboard preventDefault" data-clipboard-target="#cp-a596e65bf12790f690478cf75a44d5f4"
             role="button" aria-label='Копировать'>
            <i class="fas fa-copy fa-fw"></i>
          </a>
        </li>
      </ul>
    </div>
  </div>
</div>

<ol start="4">
<li>Показать информацию только для определённой группы в сообщении.</li>
</ol>



<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-5 shortcode-codeblock-html">
  <div class="d-flex overflow-hidden">
    <div class="flex-grow-1 rounded overflow-hidden" id="cp-ac5ff7131fd27ee4682b6355ff695850">
      
      <pre><code class='language-html'>&lt;vb:if condition=&#34;is_member_of($post, 1,2,3)&#34;&gt;
  &lt;!-- информация только для группы с ID = 1, 2 и 3 --&gt;
&lt;/vb:if&gt;</code></pre>
    </div>
    <div class="flex-shrink-0">
      <ul class="list-inline mb-0">
        <li class="list-inline-item" data-bs-tooltip data-bs-title='Копировать'>
          <a class="text-body" href="#"
             data-fn="clipboard preventDefault" data-clipboard-target="#cp-ac5ff7131fd27ee4682b6355ff695850"
             role="button" aria-label='Копировать'>
            <i class="fas fa-copy fa-fw"></i>
          </a>
        </li>
      </ul>
    </div>
  </div>
</div>

<ol start="5">
<li>Показать информацию только для определённого пользователя.</li>
</ol>



<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-6 shortcode-codeblock-html">
  <div class="d-flex overflow-hidden">
    <div class="flex-grow-1 rounded overflow-hidden" id="cp-52bc77b57ed80227c86aa2e127cbac9c">
      
      <pre><code class='language-html'>&lt;vb:if condition=&#34;$bbuserinfo[&#39;userid&#39;] == 318713&#34;&gt;
  &lt;!-- информация только для пользователя с ID = 318713 --&gt;
&lt;/vb:if&gt;</code></pre>
    </div>
    <div class="flex-shrink-0">
      <ul class="list-inline mb-0">
        <li class="list-inline-item" data-bs-tooltip data-bs-title='Копировать'>
          <a class="text-body" href="#"
             data-fn="clipboard preventDefault" data-clipboard-target="#cp-52bc77b57ed80227c86aa2e127cbac9c"
             role="button" aria-label='Копировать'>
            <i class="fas fa-copy fa-fw"></i>
          </a>
        </li>
      </ul>
    </div>
  </div>
</div>

<ol start="6">
<li>Показать информацию для всех, кроме определённого пользователя.</li>
</ol>



<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-7 shortcode-codeblock-html">
  <div class="d-flex overflow-hidden">
    <div class="flex-grow-1 rounded overflow-hidden" id="cp-ba497f98705babad69b0a4d45cd67b36">
      
      <pre><code class='language-html'>&lt;vb:if condition=&#34;$bbuserinfo[&#39;userid&#39;] != 318713&#34;&gt;
  &lt;!-- информация для всех, кроме пользователя с ID = 318713 --&gt;
&lt;/vb:if&gt;</code></pre>
    </div>
    <div class="flex-shrink-0">
      <ul class="list-inline mb-0">
        <li class="list-inline-item" data-bs-tooltip data-bs-title='Копировать'>
          <a class="text-body" href="#"
             data-fn="clipboard preventDefault" data-clipboard-target="#cp-ba497f98705babad69b0a4d45cd67b36"
             role="button" aria-label='Копировать'>
            <i class="fas fa-copy fa-fw"></i>
          </a>
        </li>
      </ul>
    </div>
  </div>
</div>

<ol start="7">
<li>Показать информацию для всех модераторов во всех форумах.</li>
</ol>



<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-8 shortcode-codeblock-html">
  <div class="d-flex overflow-hidden">
    <div class="flex-grow-1 rounded overflow-hidden" id="cp-27a077ab12e8db80f539b35355e218ca">
      
      <pre><code class='language-html'>&lt;vb:if condition=&#34;can_moderate()&#34;&gt;
  &lt;!-- информация для модераторов во всех форумах --&gt;
&lt;/vb:if&gt;</code></pre>
    </div>
    <div class="flex-shrink-0">
      <ul class="list-inline mb-0">
        <li class="list-inline-item" data-bs-tooltip data-bs-title='Копировать'>
          <a class="text-body" href="#"
             data-fn="clipboard preventDefault" data-clipboard-target="#cp-27a077ab12e8db80f539b35355e218ca"
             role="button" aria-label='Копировать'>
            <i class="fas fa-copy fa-fw"></i>
          </a>
        </li>
      </ul>
    </div>
  </div>
</div>

<ol start="8">
<li>Показать информацию для модератора в определённом форуме.</li>
</ol>



<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-9 shortcode-codeblock-html">
  <div class="d-flex overflow-hidden">
    <div class="flex-grow-1 rounded overflow-hidden" id="cp-177002f1b0953e3e2854cec93d744c00">
      
      <pre><code class='language-html'>&lt;vb:if condition=&#34;can_moderate($forum[&#39;x])&#34;&gt;
  &lt;!-- информация для модератора определённого форума с ID = X --&gt;
&lt;/vb:if&gt;</code></pre>
    </div>
    <div class="flex-shrink-0">
      <ul class="list-inline mb-0">
        <li class="list-inline-item" data-bs-tooltip data-bs-title='Копировать'>
          <a class="text-body" href="#"
             data-fn="clipboard preventDefault" data-clipboard-target="#cp-177002f1b0953e3e2854cec93d744c00"
             role="button" aria-label='Копировать'>
            <i class="fas fa-copy fa-fw"></i>
          </a>
        </li>
      </ul>
    </div>
  </div>
</div>

<ol start="9">
<li>Показать информацию во всех форумах, кроме одного.</li>
</ol>



<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-10 shortcode-codeblock-html">
  <div class="d-flex overflow-hidden">
    <div class="flex-grow-1 rounded overflow-hidden" id="cp-48da1593b8838ced1a2ea7f84b3bd7cc">
      
      <pre><code class='language-html'>&lt;vb:if condition=&#34;$forum[forumid] != x&#34;&gt;
  &lt;!-- информация во всех форумах, кроме ID = X --&gt;
&lt;/vb:if&gt;</code></pre>
    </div>
    <div class="flex-shrink-0">
      <ul class="list-inline mb-0">
        <li class="list-inline-item" data-bs-tooltip data-bs-title='Копировать'>
          <a class="text-body" href="#"
             data-fn="clipboard preventDefault" data-clipboard-target="#cp-48da1593b8838ced1a2ea7f84b3bd7cc"
             role="button" aria-label='Копировать'>
            <i class="fas fa-copy fa-fw"></i>
          </a>
        </li>
      </ul>
    </div>
  </div>
</div>

<ol start="10">
<li>Показать информацию в определённых форумах.</li>
</ol>



<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-11 shortcode-codeblock-html">
  <div class="d-flex overflow-hidden">
    <div class="flex-grow-1 rounded overflow-hidden" id="cp-8b3b44066db6915ce39de25e5c62eae5">
      
      <pre><code class='language-html'>&lt;vb:if condition=&#34;in_array($forum[&#39;forumid&#39;], array(1,2,3))&#34;&gt;
  &lt;!-- информация для форумов с ID = 1, 2 или 3 --&gt;
&lt;/vb:if&gt;</code></pre>
    </div>
    <div class="flex-shrink-0">
      <ul class="list-inline mb-0">
        <li class="list-inline-item" data-bs-tooltip data-bs-title='Копировать'>
          <a class="text-body" href="#"
             data-fn="clipboard preventDefault" data-clipboard-target="#cp-8b3b44066db6915ce39de25e5c62eae5"
             role="button" aria-label='Копировать'>
            <i class="fas fa-copy fa-fw"></i>
          </a>
        </li>
      </ul>
    </div>
  </div>
</div>

<ol start="11">
<li>Показать информацию только на определённой странице.</li>
</ol>



<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-12 shortcode-codeblock-html">
  <div class="d-flex overflow-hidden">
    <div class="flex-grow-1 rounded overflow-hidden" id="cp-38f9841a1191aaee3293ab88c3dd9cfa">
      
      <pre><code class='language-html'>&lt;vb:if condition=&#34;THIS_SCRIPT == &#39;calendar&#39;&#34;&gt;
  &lt;!-- Показать информацию в calendar.php --&gt;
&lt;/vb:if&gt;</code></pre>
    </div>
    <div class="flex-shrink-0">
      <ul class="list-inline mb-0">
        <li class="list-inline-item" data-bs-tooltip data-bs-title='Копировать'>
          <a class="text-body" href="#"
             data-fn="clipboard preventDefault" data-clipboard-target="#cp-38f9841a1191aaee3293ab88c3dd9cfa"
             role="button" aria-label='Копировать'>
            <i class="fas fa-copy fa-fw"></i>
          </a>
        </li>
      </ul>
    </div>
  </div>
</div>

<ol start="12">
<li>Показать информацию везде, кроме определённой страницы.</li>
</ol>



<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-13 shortcode-codeblock-html">
  <div class="d-flex overflow-hidden">
    <div class="flex-grow-1 rounded overflow-hidden" id="cp-8bfcda7c6371731b68df50db3c9fe464">
      
      <pre><code class='language-html'>&lt;vb:if condition=&#34;THIS_SCRIPT != &#39;calendar&#39;&#34;&gt;
  &lt;!-- информация на всех страницах, кроме calendar.php --&gt;
&lt;/vb:if&gt;</code></pre>
    </div>
    <div class="flex-shrink-0">
      <ul class="list-inline mb-0">
        <li class="list-inline-item" data-bs-tooltip data-bs-title='Копировать'>
          <a class="text-body" href="#"
             data-fn="clipboard preventDefault" data-clipboard-target="#cp-8bfcda7c6371731b68df50db3c9fe464"
             role="button" aria-label='Копировать'>
            <i class="fas fa-copy fa-fw"></i>
          </a>
        </li>
      </ul>
    </div>
  </div>
</div>

<ol start="13">
<li>Показать информацию, если переменная активна.</li>
</ol>



<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-14 shortcode-codeblock-html">
  <div class="d-flex overflow-hidden">
    <div class="flex-grow-1 rounded overflow-hidden" id="cp-55b26ec6c31cbbbd8b00c9e40db67bae">
      
      <pre><code class='language-html'>&lt;vb:if condition=&#34;$customvar&#34;&gt;
  &lt;!-- показать, если переменная $customvar активна --&gt;
&lt;/vb:if&gt;</code></pre>
    </div>
    <div class="flex-shrink-0">
      <ul class="list-inline mb-0">
        <li class="list-inline-item" data-bs-tooltip data-bs-title='Копировать'>
          <a class="text-body" href="#"
             data-fn="clipboard preventDefault" data-clipboard-target="#cp-55b26ec6c31cbbbd8b00c9e40db67bae"
             role="button" aria-label='Копировать'>
            <i class="fas fa-copy fa-fw"></i>
          </a>
        </li>
      </ul>
    </div>
  </div>
</div>

<ol start="14">
<li>Показать информацию, если переменная имеет значение.</li>
</ol>



<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-15 shortcode-codeblock-html">
  <div class="d-flex overflow-hidden">
    <div class="flex-grow-1 rounded overflow-hidden" id="cp-5daa68a634b01aa1eaea20d0e1d7bd2a">
      
      <pre><code class='language-html'>&lt;vb:if condition=&#34;$customvar == значение&#34;&gt;
  &lt;!-- показать, если переменная $customvar имеет значение &#34;значение&#34; --&gt;
&lt;/vb:if&gt;</code></pre>
    </div>
    <div class="flex-shrink-0">
      <ul class="list-inline mb-0">
        <li class="list-inline-item" data-bs-tooltip data-bs-title='Копировать'>
          <a class="text-body" href="#"
             data-fn="clipboard preventDefault" data-clipboard-target="#cp-5daa68a634b01aa1eaea20d0e1d7bd2a"
             role="button" aria-label='Копировать'>
            <i class="fas fa-copy fa-fw"></i>
          </a>
        </li>
      </ul>
    </div>
  </div>
</div>

<ol start="15">
<li>Показать информацию, если переменная НЕ имеет значение.</li>
</ol>



<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-16 shortcode-codeblock-html">
  <div class="d-flex overflow-hidden">
    <div class="flex-grow-1 rounded overflow-hidden" id="cp-2a2d7a569a42fb2c7d194cd506da9814">
      
      <pre><code class='language-html'>&lt;vb:if condition=&#34;$customvar != значение&#34;&gt;
  &lt;!-- показать, если переменная $customvar на имеет значение &#34;значение&#34; --&gt;
&lt;/vb:if&gt;</code></pre>
    </div>
    <div class="flex-shrink-0">
      <ul class="list-inline mb-0">
        <li class="list-inline-item" data-bs-tooltip data-bs-title='Копировать'>
          <a class="text-body" href="#"
             data-fn="clipboard preventDefault" data-clipboard-target="#cp-2a2d7a569a42fb2c7d194cd506da9814"
             role="button" aria-label='Копировать'>
            <i class="fas fa-copy fa-fw"></i>
          </a>
        </li>
      </ul>
    </div>
  </div>
</div>

<ol start="16">
<li>Показать информацию только для пользователя не набравшего определённого количества сообщений.</li>
</ol>



<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-17 shortcode-codeblock-html">
  <div class="d-flex overflow-hidden">
    <div class="flex-grow-1 rounded overflow-hidden" id="cp-3b91e5b91cfdb01f5ff49cb0eb7aa98a">
      
      <pre><code class='language-html'>&lt;vb:if condition=&#34;$post[posts] &lt; 10&#34;&gt;
  &lt;!-- информация для пользователя, не набравшего 10 сообщений --&gt;
&lt;/vb:if&gt;</code></pre>
    </div>
    <div class="flex-shrink-0">
      <ul class="list-inline mb-0">
        <li class="list-inline-item" data-bs-tooltip data-bs-title='Копировать'>
          <a class="text-body" href="#"
             data-fn="clipboard preventDefault" data-clipboard-target="#cp-3b91e5b91cfdb01f5ff49cb0eb7aa98a"
             role="button" aria-label='Копировать'>
            <i class="fas fa-copy fa-fw"></i>
          </a>
        </li>
      </ul>
    </div>
  </div>
</div>

<h2 id="комбинированные-условия">
  <a class="link-body-emphasis" href="#%d0%ba%d0%be%d0%bc%d0%b1%d0%b8%d0%bd%d0%b8%d1%80%d0%be%d0%b2%d0%b0%d0%bd%d0%bd%d1%8b%d0%b5-%d1%83%d1%81%d0%bb%d0%be%d0%b2%d0%b8%d1%8f">Комбинированные условия</a>
</h2>


<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-18 shortcode-codeblock-html">
  <div class="d-flex overflow-hidden">
    <div class="flex-grow-1 rounded overflow-hidden" id="cp-0c060ee7f327dfa9de2eb2f4264240fc">
      
      <pre><code class='language-html'>&lt;vb:if condition=&#34;$show[&#39;guest&#39;]&#34;&gt;
  &lt;!-- показать только для гостей --&gt;
&lt;vb:else /&gt;
  &lt;!-- показать только зарегистрированным пользователям --&gt;
&lt;/vb:if&gt;
&lt;vb:if condition=&#34;$show[&#39;guest&#39;]&#34;&gt;
  &lt;!-- показать только для гостей --&gt;
&lt;vb:elseif condition=&#34;is_member_of($bbuserinfo, 5,6)&#34; /&gt;
  &lt;!-- показать только для групп пользователей с ID = 5 и 6 --&gt;
&lt;vb:else /&gt;
  &lt;!-- показать только зарегистрированным пользователям --&gt;
&lt;/vb:if&gt;</code></pre>
    </div>
    <div class="flex-shrink-0">
      <ul class="list-inline mb-0">
        <li class="list-inline-item" data-bs-tooltip data-bs-title='Копировать'>
          <a class="text-body" href="#"
             data-fn="clipboard preventDefault" data-clipboard-target="#cp-0c060ee7f327dfa9de2eb2f4264240fc"
             role="button" aria-label='Копировать'>
            <i class="fas fa-copy fa-fw"></i>
          </a>
        </li>
      </ul>
    </div>
  </div>
</div>]]></turbo:content></item><item turbo="true"><title>Условия в шаблонах для vBulletin 3</title><link>https://lib.onl/ru/articles/2023/10/f82b1436-6752-5084-ba98-264b264edca7/</link><pubDate>Tue, 17 Oct 2023 17:07:58 +0000</pubDate><dc:creator>Kai Kimera</dc:creator><category>CMF</category><category>В истории</category><yandex:related><link url="https://lib.onl/ru/articles/2023/10/560dfed8-9a25-5db3-95a6-a7df8129e960/">Невидимые ссылки для гостей на IP.Board 2.3</link><link url="https://lib.onl/ru/articles/2023/10/347826e1-53d9-5c99-a6f8-66fc359323a2/">Динамическое "(Powered by Invision Power Board)" на IP.Board 2.3</link><link url="https://lib.onl/ru/articles/2023/10/d477b5ce-8095-5607-91c7-5c5ad7b7f146/">Читабельные ссылки на темы форума для IP.Board 2.3</link><link url="https://lib.onl/ru/articles/2023/10/a0756cae-ae3c-59ff-b587-ee8c7f3247c8/">FAQ для IP.Board 2.3</link><link url="https://lib.onl/ru/articles/2023/10/54d4e488-9a8f-55ed-8fea-c77d4dba0720/">SQL запросы IP.Board 2.3</link><link url="https://lib.onl/ru/articles/2023/10/06c9d359-31f0-5862-a342-62a21d4eb032/">SQL запросы IP.Board 3.x</link><link url="https://lib.onl/ru/articles/2023/10/0743e73e-7c4c-5ab8-bba3-ba70bdb5cdfd/">Условия в файлах IP.Board 2.3</link><link url="https://lib.onl/ru/articles/2023/10/d310a44c-4259-5bef-a7c2-d3d09a5c69f4/">Условия в шаблонах IP.Board 2.3</link><link url="https://lib.onl/ru/articles/2023/10/a7405294-9f0c-52c1-a70e-ce4990079dc7/">Условия в шаблонах IP.Board 3.x</link></yandex:related><turbo:extendedHtml>true</turbo:extendedHtml><turbo:source>https://lib.onl/ru/articles/2023/10/f82b1436-6752-5084-ba98-264b264edca7/</turbo:source><turbo:topic>Условия в шаблонах для vBulletin 3</turbo:topic><turbo:content><![CDATA[<p>Набор условий для применения в шаблонах форумного движка <span class="shortcode shortcode-tag"><a href="/ru/tags/vbulletin/" target="_blank">#vBulletin</a></span> 3.</p>
<h2 id="условия-в-шаблонах">
  <a class="link-body-emphasis" href="#%d1%83%d1%81%d0%bb%d0%be%d0%b2%d0%b8%d1%8f-%d0%b2-%d1%88%d0%b0%d0%b1%d0%bb%d0%be%d0%bd%d0%b0%d1%85">Условия в шаблонах</a>
</h2><ol>
<li>Показать информацию для одной или нескольких групп пользователей.</li>
</ol>



<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-1 shortcode-codeblock-html">
  <div class="d-flex overflow-hidden">
    <div class="flex-grow-1 rounded overflow-hidden" id="cp-4b4149c5182ab0adfc79bd4cfbdb85ce">
      
      <pre><code class='language-html'>&lt;if condition=&#34;is_member_of($bbuserinfo, X, Y, Z)&#34;&gt;
  &lt;!-- информация --&gt;
&lt;/if&gt;</code></pre>
    </div>
    <div class="flex-shrink-0">
      <ul class="list-inline mb-0">
        <li class="list-inline-item" data-bs-tooltip data-bs-title='Копировать'>
          <a class="text-body" href="#"
             data-fn="clipboard preventDefault" data-clipboard-target="#cp-4b4149c5182ab0adfc79bd4cfbdb85ce"
             role="button" aria-label='Копировать'>
            <i class="fas fa-copy fa-fw"></i>
          </a>
        </li>
      </ul>
    </div>
  </div>
</div>

<ol start="2">
<li>Показать информацию только для одного пользователя.</li>
</ol>



<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-2 shortcode-codeblock-html">
  <div class="d-flex overflow-hidden">
    <div class="flex-grow-1 rounded overflow-hidden" id="cp-0da0a5de15f7447a42bacc11510400cc">
      
      <pre><code class='language-html'>&lt;if condition=&#34;$bbuserinfo[userid] == X&#34;&gt;
  &lt;!-- информация --&gt;
&lt;/if&gt;</code></pre>
    </div>
    <div class="flex-shrink-0">
      <ul class="list-inline mb-0">
        <li class="list-inline-item" data-bs-tooltip data-bs-title='Копировать'>
          <a class="text-body" href="#"
             data-fn="clipboard preventDefault" data-clipboard-target="#cp-0da0a5de15f7447a42bacc11510400cc"
             role="button" aria-label='Копировать'>
            <i class="fas fa-copy fa-fw"></i>
          </a>
        </li>
      </ul>
    </div>
  </div>
</div>

<ol start="3">
<li>Показать информацию только для нескольких пользователей.</li>
</ol>



<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-3 shortcode-codeblock-html">
  <div class="d-flex overflow-hidden">
    <div class="flex-grow-1 rounded overflow-hidden" id="cp-02f9a882e1fbffb51ee8fb205092d17f">
      
      <pre><code class='language-html'>&lt;if condition=&#34;in_array($bbuserinfo[userid], array(X,Y,Z))&#34;&gt;
  &lt;!-- информация --&gt;
&lt;/if&gt;</code></pre>
    </div>
    <div class="flex-shrink-0">
      <ul class="list-inline mb-0">
        <li class="list-inline-item" data-bs-tooltip data-bs-title='Копировать'>
          <a class="text-body" href="#"
             data-fn="clipboard preventDefault" data-clipboard-target="#cp-02f9a882e1fbffb51ee8fb205092d17f"
             role="button" aria-label='Копировать'>
            <i class="fas fa-copy fa-fw"></i>
          </a>
        </li>
      </ul>
    </div>
  </div>
</div>

<ol start="4">
<li>Скрыть информацию для одной группы пользователей.</li>
</ol>



<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-4 shortcode-codeblock-html">
  <div class="d-flex overflow-hidden">
    <div class="flex-grow-1 rounded overflow-hidden" id="cp-1f3563eb8f6528d33f3af5ed512ee84a">
      
      <pre><code class='language-html'>&lt;if condition=&#34;!is_member_of($bbuserinfo, X)&#34;&gt;
  &lt;!-- информация --&gt;
&lt;/if&gt;</code></pre>
    </div>
    <div class="flex-shrink-0">
      <ul class="list-inline mb-0">
        <li class="list-inline-item" data-bs-tooltip data-bs-title='Копировать'>
          <a class="text-body" href="#"
             data-fn="clipboard preventDefault" data-clipboard-target="#cp-1f3563eb8f6528d33f3af5ed512ee84a"
             role="button" aria-label='Копировать'>
            <i class="fas fa-copy fa-fw"></i>
          </a>
        </li>
      </ul>
    </div>
  </div>
</div>

<ol start="5">
<li>Скрыть информацию для нескольких групп пользователей.</li>
</ol>



<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-5 shortcode-codeblock-html">
  <div class="d-flex overflow-hidden">
    <div class="flex-grow-1 rounded overflow-hidden" id="cp-0a64190151222c841b28c4555742cf2e">
      
      <pre><code class='language-html'>&lt;if condition=&#34;!is_member_of($bbuserinfo, X, Y, Z)&#34;&gt;
  &lt;!-- информация --&gt;
&lt;/if&gt;</code></pre>
    </div>
    <div class="flex-shrink-0">
      <ul class="list-inline mb-0">
        <li class="list-inline-item" data-bs-tooltip data-bs-title='Копировать'>
          <a class="text-body" href="#"
             data-fn="clipboard preventDefault" data-clipboard-target="#cp-0a64190151222c841b28c4555742cf2e"
             role="button" aria-label='Копировать'>
            <i class="fas fa-copy fa-fw"></i>
          </a>
        </li>
      </ul>
    </div>
  </div>
</div>

<ol start="6">
<li>Скрыть информацию от нескольких пользователей.</li>
</ol>



<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-6 shortcode-codeblock-html">
  <div class="d-flex overflow-hidden">
    <div class="flex-grow-1 rounded overflow-hidden" id="cp-db39f9f703b146a56af707db161ba390">
      
      <pre><code class='language-html'>&lt;if condition=&#34;!in_array($bbuserinfo[userid], array(X,Y,Z))&#34;&gt;
  &lt;!-- информация --&gt;
&lt;/if&gt;</code></pre>
    </div>
    <div class="flex-shrink-0">
      <ul class="list-inline mb-0">
        <li class="list-inline-item" data-bs-tooltip data-bs-title='Копировать'>
          <a class="text-body" href="#"
             data-fn="clipboard preventDefault" data-clipboard-target="#cp-db39f9f703b146a56af707db161ba390"
             role="button" aria-label='Копировать'>
            <i class="fas fa-copy fa-fw"></i>
          </a>
        </li>
      </ul>
    </div>
  </div>
</div>

<ol start="7">
<li>Показать информацию только в определённом форуме.</li>
</ol>



<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-7 shortcode-codeblock-html">
  <div class="d-flex overflow-hidden">
    <div class="flex-grow-1 rounded overflow-hidden" id="cp-939bb790d12daea21db3131dab5aef20">
      
      <pre><code class='language-html'>&lt;if condition=&#34;$forumid == X&#34;&gt;
  &lt;!-- информация --&gt;
&lt;/if&gt;</code></pre>
    </div>
    <div class="flex-shrink-0">
      <ul class="list-inline mb-0">
        <li class="list-inline-item" data-bs-tooltip data-bs-title='Копировать'>
          <a class="text-body" href="#"
             data-fn="clipboard preventDefault" data-clipboard-target="#cp-939bb790d12daea21db3131dab5aef20"
             role="button" aria-label='Копировать'>
            <i class="fas fa-copy fa-fw"></i>
          </a>
        </li>
      </ul>
    </div>
  </div>
</div>

<ol start="8">
<li>Показать информацию в нескольких форумах.</li>
</ol>



<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-8 shortcode-codeblock-html">
  <div class="d-flex overflow-hidden">
    <div class="flex-grow-1 rounded overflow-hidden" id="cp-c4a107294ee912aee1dccba12611d923">
      
      <pre><code class='language-html'>&lt;if condition=&#34;in_array($forumid, array(X,Y,Z))&#34;&gt;
  &lt;!-- информация --&gt;
&lt;/if&gt;</code></pre>
    </div>
    <div class="flex-shrink-0">
      <ul class="list-inline mb-0">
        <li class="list-inline-item" data-bs-tooltip data-bs-title='Копировать'>
          <a class="text-body" href="#"
             data-fn="clipboard preventDefault" data-clipboard-target="#cp-c4a107294ee912aee1dccba12611d923"
             role="button" aria-label='Копировать'>
            <i class="fas fa-copy fa-fw"></i>
          </a>
        </li>
      </ul>
    </div>
  </div>
</div>

<ol start="9">
<li>Скрыть информацию в определённом форуме.</li>
</ol>



<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-9 shortcode-codeblock-html">
  <div class="d-flex overflow-hidden">
    <div class="flex-grow-1 rounded overflow-hidden" id="cp-93473e198236ad44ae91b451f730eefe">
      
      <pre><code class='language-html'>&lt;if condition=&#34;$forumid != X&#34;&gt;
  &lt;!-- информация --&gt;
&lt;/if&gt;</code></pre>
    </div>
    <div class="flex-shrink-0">
      <ul class="list-inline mb-0">
        <li class="list-inline-item" data-bs-tooltip data-bs-title='Копировать'>
          <a class="text-body" href="#"
             data-fn="clipboard preventDefault" data-clipboard-target="#cp-93473e198236ad44ae91b451f730eefe"
             role="button" aria-label='Копировать'>
            <i class="fas fa-copy fa-fw"></i>
          </a>
        </li>
      </ul>
    </div>
  </div>
</div>

<ol start="10">
<li>Скрыть информацию в нескольких форумах.</li>
</ol>



<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-10 shortcode-codeblock-html">
  <div class="d-flex overflow-hidden">
    <div class="flex-grow-1 rounded overflow-hidden" id="cp-8a93adc8668d2ea88f3b32ee73453ce9">
      
      <pre><code class='language-html'>&lt;if condition=&#34;!in_array($forumid, array(X,Y,Z))&#34;&gt;
  &lt;!-- информация --&gt;
&lt;/if&gt;</code></pre>
    </div>
    <div class="flex-shrink-0">
      <ul class="list-inline mb-0">
        <li class="list-inline-item" data-bs-tooltip data-bs-title='Копировать'>
          <a class="text-body" href="#"
             data-fn="clipboard preventDefault" data-clipboard-target="#cp-8a93adc8668d2ea88f3b32ee73453ce9"
             role="button" aria-label='Копировать'>
            <i class="fas fa-copy fa-fw"></i>
          </a>
        </li>
      </ul>
    </div>
  </div>
</div>]]></turbo:content></item><item turbo="true"><title>Невидимые ссылки для гостей на IP.Board 2.3</title><link>https://lib.onl/ru/articles/2023/10/560dfed8-9a25-5db3-95a6-a7df8129e960/</link><pubDate>Tue, 17 Oct 2023 03:15:11 +0000</pubDate><dc:creator>Kai Kimera</dc:creator><category>CMF</category><category>В истории</category><yandex:related><link url="https://lib.onl/ru/articles/2023/10/347826e1-53d9-5c99-a6f8-66fc359323a2/">Динамическое "(Powered by Invision Power Board)" на IP.Board 2.3</link><link url="https://lib.onl/ru/articles/2023/10/d477b5ce-8095-5607-91c7-5c5ad7b7f146/">Читабельные ссылки на темы форума для IP.Board 2.3</link><link url="https://lib.onl/ru/articles/2023/10/a0756cae-ae3c-59ff-b587-ee8c7f3247c8/">FAQ для IP.Board 2.3</link><link url="https://lib.onl/ru/articles/2023/10/54d4e488-9a8f-55ed-8fea-c77d4dba0720/">SQL запросы IP.Board 2.3</link><link url="https://lib.onl/ru/articles/2023/10/06c9d359-31f0-5862-a342-62a21d4eb032/">SQL запросы IP.Board 3.x</link><link url="https://lib.onl/ru/articles/2023/10/0743e73e-7c4c-5ab8-bba3-ba70bdb5cdfd/">Условия в файлах IP.Board 2.3</link><link url="https://lib.onl/ru/articles/2023/10/d310a44c-4259-5bef-a7c2-d3d09a5c69f4/">Условия в шаблонах IP.Board 2.3</link><link url="https://lib.onl/ru/articles/2023/10/a7405294-9f0c-52c1-a70e-ce4990079dc7/">Условия в шаблонах IP.Board 3.x</link></yandex:related><turbo:extendedHtml>true</turbo:extendedHtml><turbo:source>https://lib.onl/ru/articles/2023/10/560dfed8-9a25-5db3-95a6-a7df8129e960/</turbo:source><turbo:topic>Невидимые ссылки для гостей на IP.Board 2.3</turbo:topic><turbo:content><![CDATA[<p>Когда-то была очень полезная модификация для <span class="shortcode shortcode-tag"><a href="/ru/tags/ipb/" target="_blank">#IPB</a></span>, которая защищала ссылки внутри форума от гостей. Ибо нефиг смотреть просто так, регистрируйтесь!</p>
    






    
    








<div class="shortcode shortcode-alert">
  <div class="alert alert-info d-flex overflow-hidden" role="alert">
    <div class="flex-shrink-0 align-self-center">
      <i class="fas fa-info fa-fw fa-2x"></i>
    </div>
    <div class="flex-grow-1 ms-3 overflow-hidden">
        <ul>
<li>Автор: Sannis.</li>
</ul>

    </div>
  </div>
</div>

<h2 id="внедрение-модификации">
  <a class="link-body-emphasis" href="#%d0%b2%d0%bd%d0%b5%d0%b4%d1%80%d0%b5%d0%bd%d0%b8%d0%b5-%d0%bc%d0%be%d0%b4%d0%b8%d1%84%d0%b8%d0%ba%d0%b0%d1%86%d0%b8%d0%b8">Внедрение модификации</a>
</h2><p>Эта небольшая модификация позволяет сделать так, чтобы ссылки стали скрытыми от гостей. Для этого нужно отредактировать файлы <code>topic.php</code> и <code>class_post.php</code>.</p>
<p>Открыть файл <code>./sources/action_public/topic.php</code>, найти:</p>



<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-2 shortcode-codeblock-php">
  <div class="d-flex overflow-hidden">
    <div class="flex-grow-1 rounded overflow-hidden" id="cp-14e30711fd89532c74dde7849b88253d">
      
      <pre><code class='language-php'>//-----------------------------------------
// Highlight...
//-----------------------------------------</code></pre>
    </div>
    <div class="flex-shrink-0">
      <ul class="list-inline mb-0">
        <li class="list-inline-item" data-bs-tooltip data-bs-title='Копировать'>
          <a class="text-body" href="#"
             data-fn="clipboard preventDefault" data-clipboard-target="#cp-14e30711fd89532c74dde7849b88253d"
             role="button" aria-label='Копировать'>
            <i class="fas fa-copy fa-fw"></i>
          </a>
        </li>
      </ul>
    </div>
  </div>
</div>

<p>Заменить на:</p>



<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-3 shortcode-codeblock-php">
  <div class="d-flex overflow-hidden">
    <div class="flex-grow-1 rounded overflow-hidden" id="cp-b02d7b18cc4af69ff23de1542ee9178c">
      
      <pre><code class='language-php'>if (!$this-&gt;ipsclass-&gt;member[&#39;id&#39;]) {
  //-----------------------------------------
  // Clear links for guests
  //-----------------------------------------

  $row[&#39;post&#39;] = preg_replace(&#34;#&lt;a href=[\&#34;&#39;].&#43;?[\&#34;&#39;].&#43;?&gt;.&#43;?&lt;/a&gt;#&#34;, &#34;&lt;i&gt;ссылка&lt;/i&gt;&#34;, $row[&#39;post&#39;]);
}</code></pre>
    </div>
    <div class="flex-shrink-0">
      <ul class="list-inline mb-0">
        <li class="list-inline-item" data-bs-tooltip data-bs-title='Копировать'>
          <a class="text-body" href="#"
             data-fn="clipboard preventDefault" data-clipboard-target="#cp-b02d7b18cc4af69ff23de1542ee9178c"
             role="button" aria-label='Копировать'>
            <i class="fas fa-copy fa-fw"></i>
          </a>
        </li>
      </ul>
    </div>
  </div>
</div>

<p>Открыть файл <code>./sources/classes/class_post.php</code>, найти:</p>



<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-4 shortcode-codeblock-php">
  <div class="d-flex overflow-hidden">
    <div class="flex-grow-1 rounded overflow-hidden" id="cp-ee37e96975067eb749ea63fba11c5195">
      
      <pre><code class='language-php'>$extra = &#34;&#34;;

if ( $tmp_post )
{
  $raw_post .= &#34;[quote name=&#39;&#34;.$this-&gt;parser-&gt;make_quote_safe($tp[&#39;author_name&#39;]).&#34;&#39; date=&#39;&#34;.$this-&gt;parser-&gt;make_quote_safe($this-&gt;ipsclass-&gt;get_date( $tp[&#39;post_date&#39;], &#39;LONG&#39;, 1 )).&#34;&#39; post=&#39;&#34;.$tp[&#39;pid&#39;].&#34;&#39;]\n$tmp_post\n&#34;.$extra.&#39;[/quote]&#39;.&#34;\n\n\n&#34;;
}</code></pre>
    </div>
    <div class="flex-shrink-0">
      <ul class="list-inline mb-0">
        <li class="list-inline-item" data-bs-tooltip data-bs-title='Копировать'>
          <a class="text-body" href="#"
             data-fn="clipboard preventDefault" data-clipboard-target="#cp-ee37e96975067eb749ea63fba11c5195"
             role="button" aria-label='Копировать'>
            <i class="fas fa-copy fa-fw"></i>
          </a>
        </li>
      </ul>
    </div>
  </div>
</div>

<p>Заменить на:</p>



<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-5 shortcode-codeblock-php">
  <div class="d-flex overflow-hidden">
    <div class="flex-grow-1 rounded overflow-hidden" id="cp-1b492585241dbfc98c96654c04f04333">
      
      <pre><code class='language-php'>if (!$this-&gt;ipsclass-&gt;member[&#39;id&#39;]) {
  //-----------------------------------------
  // Clear links for guests
  //-----------------------------------------

  $tmp_post = preg_replace(&#34;#\[url\](\S&#43;?)\[/url\]#i&#34;, &#34;[i]ссылка[/i]&#34;, $tmp_post);
  $tmp_post = preg_replace(&#34;#\[url\s*=\s*\&#34;\;\s*(\S&#43;?)\s*\&#34;\;\s*\](.*?)\[\/url\]#i&#34;, &#34;\\2&#34;, $tmp_post);
  $tmp_post = preg_replace(&#34;#\[url\s*=\s*(\S&#43;?)\s*\](.*?)\[\/url\]#i&#34;, &#34;\\2&#34;, $tmp_post);
}</code></pre>
    </div>
    <div class="flex-shrink-0">
      <ul class="list-inline mb-0">
        <li class="list-inline-item" data-bs-tooltip data-bs-title='Копировать'>
          <a class="text-body" href="#"
             data-fn="clipboard preventDefault" data-clipboard-target="#cp-1b492585241dbfc98c96654c04f04333"
             role="button" aria-label='Копировать'>
            <i class="fas fa-copy fa-fw"></i>
          </a>
        </li>
      </ul>
    </div>
  </div>
</div>]]></turbo:content></item><item turbo="true"><title>Динамическое "(Powered by Invision Power Board)" на IP.Board 2.3</title><link>https://lib.onl/ru/articles/2023/10/347826e1-53d9-5c99-a6f8-66fc359323a2/</link><pubDate>Tue, 17 Oct 2023 03:10:06 +0000</pubDate><dc:creator>Kai Kimera</dc:creator><category>CMF</category><category>В истории</category><yandex:related><link url="https://lib.onl/ru/articles/2023/10/d477b5ce-8095-5607-91c7-5c5ad7b7f146/">Читабельные ссылки на темы форума для IP.Board 2.3</link><link url="https://lib.onl/ru/articles/2023/10/a0756cae-ae3c-59ff-b587-ee8c7f3247c8/">FAQ для IP.Board 2.3</link><link url="https://lib.onl/ru/articles/2023/10/54d4e488-9a8f-55ed-8fea-c77d4dba0720/">SQL запросы IP.Board 2.3</link><link url="https://lib.onl/ru/articles/2023/10/06c9d359-31f0-5862-a342-62a21d4eb032/">SQL запросы IP.Board 3.x</link><link url="https://lib.onl/ru/articles/2023/10/0743e73e-7c4c-5ab8-bba3-ba70bdb5cdfd/">Условия в файлах IP.Board 2.3</link><link url="https://lib.onl/ru/articles/2023/10/d310a44c-4259-5bef-a7c2-d3d09a5c69f4/">Условия в шаблонах IP.Board 2.3</link><link url="https://lib.onl/ru/articles/2023/10/a7405294-9f0c-52c1-a70e-ce4990079dc7/">Условия в шаблонах IP.Board 3.x</link></yandex:related><turbo:extendedHtml>true</turbo:extendedHtml><turbo:source>https://lib.onl/ru/articles/2023/10/347826e1-53d9-5c99-a6f8-66fc359323a2/</turbo:source><turbo:topic>Динамическое "(Powered by Invision Power Board)" на IP.Board 2.3</turbo:topic><turbo:content><![CDATA[<p>Нашёл ещё одну модификацию а-ля &ldquo;прикол на зависть другим&rdquo; для <span class="shortcode shortcode-tag"><a href="/ru/tags/ipb/" target="_blank">#IPB</a></span>. Модификация позволяет сделать из копирайта форума динамически изменяемую &ldquo;свистульку&rdquo;.</p>
<h2 id="внедрение-модификации">
  <a class="link-body-emphasis" href="#%d0%b2%d0%bd%d0%b5%d0%b4%d1%80%d0%b5%d0%bd%d0%b8%d0%b5-%d0%bc%d0%be%d0%b4%d0%b8%d1%84%d0%b8%d0%ba%d0%b0%d1%86%d0%b8%d0%b8">Внедрение модификации</a>
</h2><p>Открыть файл <code>./sources/action_public/boards.php</code>, найти:</p>



<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-1 shortcode-codeblock-php">
  <div class="d-flex overflow-hidden">
    <div class="flex-grow-1 rounded overflow-hidden" id="cp-4dbc5bc728ce1da1491be4880aea4c99">
      
      <pre><code class='language-php'>$cp = &#34; (Powered by Invision Power Board)&#34;;</code></pre>
    </div>
    <div class="flex-shrink-0">
      <ul class="list-inline mb-0">
        <li class="list-inline-item" data-bs-tooltip data-bs-title='Копировать'>
          <a class="text-body" href="#"
             data-fn="clipboard preventDefault" data-clipboard-target="#cp-4dbc5bc728ce1da1491be4880aea4c99"
             role="button" aria-label='Копировать'>
            <i class="fas fa-copy fa-fw"></i>
          </a>
        </li>
      </ul>
    </div>
  </div>
</div>

<p>Заменить на:</p>



<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-2 shortcode-codeblock-php">
  <div class="d-flex overflow-hidden">
    <div class="flex-grow-1 rounded overflow-hidden" id="cp-a4346eb4259a1638ae770ae3cd447388">
      
      <pre><code class='language-php'>$cp_phrases = array(
  &#39;0&#39; =&gt; &#39; - CYBER-CITY: Поддержка&#39;,
  &#39;1&#39; =&gt; &#39; - CYBER-CITY: Разработка&#39;,
  &#39;2&#39; =&gt; &#39; - CYBER-CITY: Исследование&#39;,
);

$cp_rand = rand(0, 2);
$cp = $cp_phrases[$cp_rand];</code></pre>
    </div>
    <div class="flex-shrink-0">
      <ul class="list-inline mb-0">
        <li class="list-inline-item" data-bs-tooltip data-bs-title='Копировать'>
          <a class="text-body" href="#"
             data-fn="clipboard preventDefault" data-clipboard-target="#cp-a4346eb4259a1638ae770ae3cd447388"
             role="button" aria-label='Копировать'>
            <i class="fas fa-copy fa-fw"></i>
          </a>
        </li>
      </ul>
    </div>
  </div>
</div>

<p>Не забудьте, если у вас больше фраз, чем 3, то измените <code>rand(0, 2)</code>, где <code>0</code> - первая фраза, <code>2</code> - последняя.</p>]]></turbo:content></item><item turbo="true"><title>Читабельные ссылки на темы форума для IP.Board 2.3</title><link>https://lib.onl/ru/articles/2023/10/d477b5ce-8095-5607-91c7-5c5ad7b7f146/</link><pubDate>Tue, 17 Oct 2023 02:45:40 +0000</pubDate><dc:creator>Kai Kimera</dc:creator><category>CMF</category><category>В истории</category><yandex:related><link url="https://lib.onl/ru/articles/2023/10/a0756cae-ae3c-59ff-b587-ee8c7f3247c8/">FAQ для IP.Board 2.3</link><link url="https://lib.onl/ru/articles/2023/10/54d4e488-9a8f-55ed-8fea-c77d4dba0720/">SQL запросы IP.Board 2.3</link><link url="https://lib.onl/ru/articles/2023/10/06c9d359-31f0-5862-a342-62a21d4eb032/">SQL запросы IP.Board 3.x</link><link url="https://lib.onl/ru/articles/2023/10/0743e73e-7c4c-5ab8-bba3-ba70bdb5cdfd/">Условия в файлах IP.Board 2.3</link><link url="https://lib.onl/ru/articles/2023/10/d310a44c-4259-5bef-a7c2-d3d09a5c69f4/">Условия в шаблонах IP.Board 2.3</link><link url="https://lib.onl/ru/articles/2023/10/a7405294-9f0c-52c1-a70e-ce4990079dc7/">Условия в шаблонах IP.Board 3.x</link></yandex:related><turbo:extendedHtml>true</turbo:extendedHtml><turbo:source>https://lib.onl/ru/articles/2023/10/d477b5ce-8095-5607-91c7-5c5ad7b7f146/</turbo:source><turbo:topic>Читабельные ссылки на темы форума для IP.Board 2.3</turbo:topic><turbo:content><![CDATA[<p>Очередной артефакт прошлого. Когда то была очень крутая модификация для <span class="shortcode shortcode-tag"><a href="/ru/tags/ipb/" target="_blank">#IPB</a></span> 2.3. Эта модификация позволяла преобразовывать обычные ссылки на темы внутри форума в читабельный формат с текстом. Золотое время было&hellip;</p>
    






    
    








<div class="shortcode shortcode-alert">
  <div class="alert alert-info d-flex overflow-hidden" role="alert">
    <div class="flex-shrink-0 align-self-center">
      <i class="fas fa-info fa-fw fa-2x"></i>
    </div>
    <div class="flex-grow-1 ms-3 overflow-hidden">
        <ul>
<li>Автор: GiV.</li>
<li>Тестирование (маленькое :)): KaiKimera.</li>
<li>Исправление ошибок и неточностей: Sannis.</li>
</ul>

    </div>
  </div>
</div>

<h2 id="внедрение-модификации">
  <a class="link-body-emphasis" href="#%d0%b2%d0%bd%d0%b5%d0%b4%d1%80%d0%b5%d0%bd%d0%b8%d0%b5-%d0%bc%d0%be%d0%b4%d0%b8%d1%84%d0%b8%d0%ba%d0%b0%d1%86%d0%b8%d0%b8">Внедрение модификации</a>
</h2><p>Открыть файл <code>./sources/classes/bbcode/class_bbcode_core.php</code>, найти:</p>



<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-2 shortcode-codeblock-php">
  <div class="d-flex overflow-hidden">
    <div class="flex-grow-1 rounded overflow-hidden" id="cp-a20f920de014e6a953fc39ae13ce8ae9">
      
      <pre><code class='language-php'>$show = $url[&#39;show&#39;];</code></pre>
    </div>
    <div class="flex-shrink-0">
      <ul class="list-inline mb-0">
        <li class="list-inline-item" data-bs-tooltip data-bs-title='Копировать'>
          <a class="text-body" href="#"
             data-fn="clipboard preventDefault" data-clipboard-target="#cp-a20f920de014e6a953fc39ae13ce8ae9"
             role="button" aria-label='Копировать'>
            <i class="fas fa-copy fa-fw"></i>
          </a>
        </li>
      </ul>
    </div>
  </div>
</div>

<p>Добавить <strong>после</strong>:</p>



<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-3 shortcode-codeblock-php">
  <div class="d-flex overflow-hidden">
    <div class="flex-grow-1 rounded overflow-hidden" id="cp-286de75f7e0f10ca12df0f4c0885d316">
      
      <pre><code class='language-php'>if (strpos($show, $this-&gt;ipsclass-&gt;base_url) !== false) {
  $match = array();

  if (preg_match(&#34;/showtopic=(\d&#43;)/&#34;, $show, $match) or preg_match(&#34;/&amp;t=(\d&#43;)/&#34;, $show, $match)) {
    $show = $this-&gt;_getUrlLocalName(&#39;topics&#39;, $match[1]);
  }

  if (preg_match(&#34;/showforum=(\d&#43;)/&#34;, $show, $match)) {
    $show = $this-&gt;_getUrlLocalName(&#39;forums&#39;, $match[1]);
  }

  if (preg_match(&#34;/showuser=(\d&#43;)/&#34;, $show, $match)) {
    $show = $this-&gt;_getUrlLocalName(&#39;members&#39;, $match[1]);
  }

  if (!$show) {
    $show = $url[&#39;show&#39;];
  }
} else</code></pre>
    </div>
    <div class="flex-shrink-0">
      <ul class="list-inline mb-0">
        <li class="list-inline-item" data-bs-tooltip data-bs-title='Копировать'>
          <a class="text-body" href="#"
             data-fn="clipboard preventDefault" data-clipboard-target="#cp-286de75f7e0f10ca12df0f4c0885d316"
             role="button" aria-label='Копировать'>
            <i class="fas fa-copy fa-fw"></i>
          </a>
        </li>
      </ul>
    </div>
  </div>
</div>

<p>Найти:</p>



<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-4 shortcode-codeblock-php">
  <div class="d-flex overflow-hidden">
    <div class="flex-grow-1 rounded overflow-hidden" id="cp-f3a327cbeaa0203835b73cc07976fe81">
      
      <pre><code class='language-php'>/*-------------------------------------------------------------------------*/
// Remove sessions in a nice way
/*-------------------------------------------------------------------------*/</code></pre>
    </div>
    <div class="flex-shrink-0">
      <ul class="list-inline mb-0">
        <li class="list-inline-item" data-bs-tooltip data-bs-title='Копировать'>
          <a class="text-body" href="#"
             data-fn="clipboard preventDefault" data-clipboard-target="#cp-f3a327cbeaa0203835b73cc07976fe81"
             role="button" aria-label='Копировать'>
            <i class="fas fa-copy fa-fw"></i>
          </a>
        </li>
      </ul>
    </div>
  </div>
</div>

<p>Добавить <strong>перед</strong>:</p>



<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-5 shortcode-codeblock-php">
  <div class="d-flex overflow-hidden">
    <div class="flex-grow-1 rounded overflow-hidden" id="cp-8501591a8ecd0880869e1d511c28f997">
      
      <pre><code class='language-php'>function _getUrlLocalName($from = &#39;&#39;, $for = &#39;&#39;)
{
  // Сколько раз разбирали ссылки.
  static $parsedUrls;

  // Проверка на лимит разбора ссылок, чем больше число, тем больше
  // вероятность, что злоумышленник может создать нагрузку на БД.
  if (&#43;&#43;$parsedUrls &gt;= 10) return false;
  if (!$from or !$for) return false;

  // Оптимизация для ссылок на форумы/разделы. Берем имя не через запрос
  // к базе, а из кэша форумов. Спасибо улетает к SAT.
  if ($from == &#39;forums&#39;) {
    return $this-&gt;ipsclass-&gt;cache[&#39;forum_cache&#39;][$for][&#39;name&#39;];
  }

  // &#39;pk&#39; - имя первичного ключа (id&#39;ентификатора) в таблице.
  // &#39;fieldName&#39; - имя поля в таблице, в котором хранится возвращаемое имя.
  $pk = &#39;id&#39;;           // В большинстве случаев имя первичного ключа - &#39;id&#39;.
  $fieldName = &#39;name&#39;;  // Имя поля - &#39;name&#39;.

  // Однако в случае с темами у нас другие &#39;pk&#39; и &#39;fieldName&#39;.
  if ($from == &#39;topics&#39;) {
    $pk = &#39;tid&#39;;          // Имя первичного ключа - &#39;tid&#39;.
    $fieldName = &#39;title&#39;; // Имя поля с названием - &#39;title&#39;.
  }

  // Однако в случае с пользователями у нас другое &#39;fieldName&#39;.
  if ($from == &#39;members&#39;) {
    $fieldName = &#39;members_display_name&#39;; // Имя поля с названием - &#39;members_display_name&#39;.
  }

  $this-&gt;ipsclass-&gt;DB-&gt;simple_select($fieldName, $from, $pk . &#34;= &#39;&#34; . $for . &#34;&#39;&#34;);
  $ci = $this-&gt;ipsclass-&gt;DB-&gt;exec_query();
  $row = $this-&gt;ipsclass-&gt;DB-&gt;fetch_row($ci);

  if ($fieldValue = $row[$fieldName]) {
    return $fieldValue;
  }

  return false;
}</code></pre>
    </div>
    <div class="flex-shrink-0">
      <ul class="list-inline mb-0">
        <li class="list-inline-item" data-bs-tooltip data-bs-title='Копировать'>
          <a class="text-body" href="#"
             data-fn="clipboard preventDefault" data-clipboard-target="#cp-8501591a8ecd0880869e1d511c28f997"
             role="button" aria-label='Копировать'>
            <i class="fas fa-copy fa-fw"></i>
          </a>
        </li>
      </ul>
    </div>
  </div>
</div>]]></turbo:content></item><item turbo="true"><title>FAQ для IP.Board 2.3</title><link>https://lib.onl/ru/articles/2023/10/a0756cae-ae3c-59ff-b587-ee8c7f3247c8/</link><pubDate>Tue, 17 Oct 2023 00:57:06 +0000</pubDate><dc:creator>Kai Kimera</dc:creator><category>CMF</category><category>В истории</category><yandex:related><link url="https://lib.onl/ru/articles/2023/10/54d4e488-9a8f-55ed-8fea-c77d4dba0720/">SQL запросы IP.Board 2.3</link><link url="https://lib.onl/ru/articles/2023/10/06c9d359-31f0-5862-a342-62a21d4eb032/">SQL запросы IP.Board 3.x</link><link url="https://lib.onl/ru/articles/2023/10/0743e73e-7c4c-5ab8-bba3-ba70bdb5cdfd/">Условия в файлах IP.Board 2.3</link><link url="https://lib.onl/ru/articles/2023/10/d310a44c-4259-5bef-a7c2-d3d09a5c69f4/">Условия в шаблонах IP.Board 2.3</link><link url="https://lib.onl/ru/articles/2023/10/a7405294-9f0c-52c1-a70e-ce4990079dc7/">Условия в шаблонах IP.Board 3.x</link></yandex:related><turbo:extendedHtml>true</turbo:extendedHtml><turbo:source>https://lib.onl/ru/articles/2023/10/a0756cae-ae3c-59ff-b587-ee8c7f3247c8/</turbo:source><turbo:topic>FAQ для IP.Board 2.3</turbo:topic><turbo:content><![CDATA[<p>Сборник вопросов и ответов по форумному движку <span class="shortcode shortcode-tag"><a href="/ru/tags/ipb/" target="_blank">#IPB</a></span> 2.3.</p>
<h2 id="как-сделать-портал-главной-страницей-форума">
  <a class="link-body-emphasis" href="#%d0%ba%d0%b0%d0%ba-%d1%81%d0%b4%d0%b5%d0%bb%d0%b0%d1%82%d1%8c-%d0%bf%d0%be%d1%80%d1%82%d0%b0%d0%bb-%d0%b3%d0%bb%d0%b0%d0%b2%d0%bd%d0%be%d0%b9-%d1%81%d1%82%d1%80%d0%b0%d0%bd%d0%b8%d1%86%d0%b5%d0%b9-%d1%84%d0%be%d1%80%d1%83%d0%bc%d0%b0">Как сделать портал главной страницей форума?</a>
</h2><p>Открыть файл <code>init.php</code>, найти:</p>



<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-1 shortcode-codeblock-php">
  <div class="d-flex overflow-hidden">
    <div class="flex-grow-1 rounded overflow-hidden" id="cp-dbccb7b80530f23fffc50749907a1bcc">
      
      <pre><code class='language-php'>define( &#39;IPB_MAKE_PORTAL_HOMEPAGE&#39;, 0 );</code></pre>
    </div>
    <div class="flex-shrink-0">
      <ul class="list-inline mb-0">
        <li class="list-inline-item" data-bs-tooltip data-bs-title='Копировать'>
          <a class="text-body" href="#"
             data-fn="clipboard preventDefault" data-clipboard-target="#cp-dbccb7b80530f23fffc50749907a1bcc"
             role="button" aria-label='Копировать'>
            <i class="fas fa-copy fa-fw"></i>
          </a>
        </li>
      </ul>
    </div>
  </div>
</div>

<p>Заменить на:</p>



<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-2 shortcode-codeblock-php">
  <div class="d-flex overflow-hidden">
    <div class="flex-grow-1 rounded overflow-hidden" id="cp-a430f896f30a491dce07e76f5594ad58">
      
      <pre><code class='language-php'>define( &#39;IPB_MAKE_PORTAL_HOMEPAGE&#39;, 1 );</code></pre>
    </div>
    <div class="flex-shrink-0">
      <ul class="list-inline mb-0">
        <li class="list-inline-item" data-bs-tooltip data-bs-title='Копировать'>
          <a class="text-body" href="#"
             data-fn="clipboard preventDefault" data-clipboard-target="#cp-a430f896f30a491dce07e76f5594ad58"
             role="button" aria-label='Копировать'>
            <i class="fas fa-copy fa-fw"></i>
          </a>
        </li>
      </ul>
    </div>
  </div>
</div>

<h2 id="как-удалить-powered-by-invision-power-board-из-title">
  <a class="link-body-emphasis" href="#%d0%ba%d0%b0%d0%ba-%d1%83%d0%b4%d0%b0%d0%bb%d0%b8%d1%82%d1%8c-powered-by-invision-power-board-%d0%b8%d0%b7-title">Как удалить (Powered by Invision Power Board) из title?</a>
</h2><p>Открыть файл <code>./sources/action_public/boards.php</code>, найти:</p>



<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-3 shortcode-codeblock-php">
  <div class="d-flex overflow-hidden">
    <div class="flex-grow-1 rounded overflow-hidden" id="cp-24d0d9e4dda2412ee0aa3fcd81c40d30">
      
      <pre><code class='language-php'>$cp = &#34; (Powered by Invision Power Board)&#34;;</code></pre>
    </div>
    <div class="flex-shrink-0">
      <ul class="list-inline mb-0">
        <li class="list-inline-item" data-bs-tooltip data-bs-title='Копировать'>
          <a class="text-body" href="#"
             data-fn="clipboard preventDefault" data-clipboard-target="#cp-24d0d9e4dda2412ee0aa3fcd81c40d30"
             role="button" aria-label='Копировать'>
            <i class="fas fa-copy fa-fw"></i>
          </a>
        </li>
      </ul>
    </div>
  </div>
</div>

<p>Заменить на:</p>



<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-4 shortcode-codeblock-php">
  <div class="d-flex overflow-hidden">
    <div class="flex-grow-1 rounded overflow-hidden" id="cp-f7eadf457c3ba3567df773b9b72b8e82">
      
      <pre><code class='language-php'>$cp = &#34;&#34;;</code></pre>
    </div>
    <div class="flex-shrink-0">
      <ul class="list-inline mb-0">
        <li class="list-inline-item" data-bs-tooltip data-bs-title='Копировать'>
          <a class="text-body" href="#"
             data-fn="clipboard preventDefault" data-clipboard-target="#cp-f7eadf457c3ba3567df773b9b72b8e82"
             role="button" aria-label='Копировать'>
            <i class="fas fa-copy fa-fw"></i>
          </a>
        </li>
      </ul>
    </div>
  </div>
</div>

<h2 id="как-убрать-текст-в-просмотре-темы-под-аватаром">
  <a class="link-body-emphasis" href="#%d0%ba%d0%b0%d0%ba-%d1%83%d0%b1%d1%80%d0%b0%d1%82%d1%8c-%d1%82%d0%b5%d0%ba%d1%81%d1%82-%d0%b2-%d0%bf%d1%80%d0%be%d1%81%d0%bc%d0%be%d1%82%d1%80%d0%b5-%d1%82%d0%b5%d0%bc%d1%8b-%d0%bf%d0%be%d0%b4-%d0%b0%d0%b2%d0%b0%d1%82%d0%b0%d1%80%d0%be%d0%bc">Как убрать текст в просмотре темы под аватаром?</a>
</h2><p>Нужно отредактировать шаблон <code>RenderRow</code>:</p>
<ul>
<li>Админцентр / Внешний вид / <em>Ваш скин</em>.
<ul>
<li>редактировать HTML фрагменты / <code>skin_topic</code> (Просмотр темы) / <code>RenderRow</code>.</li>
</ul>
</li>
</ul>
<p>Код, отвечающий за поля пользователя в сообщении:</p>



<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-5 shortcode-codeblock-php">
  <div class="d-flex overflow-hidden">
    <div class="flex-grow-1 rounded overflow-hidden" id="cp-49c4ad63c88715e76e4a09862d063213">
      
      <pre><code class='language-php'>{$author[&#39;avatar&#39;]}&lt;br /&gt;&lt;br /&gt;
{$author[&#39;title&#39;]}&lt;br /&gt;
{$author[&#39;member_rank_img&#39;]}&lt;br /&gt;&lt;br /&gt;
{$author[&#39;member_group&#39;]}&lt;br /&gt;
{$author[&#39;member_posts&#39;]}&lt;br /&gt;
{$author[&#39;member_joined&#39;]}&lt;br /&gt;
{$author[&#39;member_location&#39;]}
{$author[&#39;member_number&#39;]}&lt;br /&gt;</code></pre>
    </div>
    <div class="flex-shrink-0">
      <ul class="list-inline mb-0">
        <li class="list-inline-item" data-bs-tooltip data-bs-title='Копировать'>
          <a class="text-body" href="#"
             data-fn="clipboard preventDefault" data-clipboard-target="#cp-49c4ad63c88715e76e4a09862d063213"
             role="button" aria-label='Копировать'>
            <i class="fas fa-copy fa-fw"></i>
          </a>
        </li>
      </ul>
    </div>
  </div>
</div>

<p>Где:</p>
<ul>
<li><code>{$author['avatar']}</code> - аватар.</li>
<li><code>{$author['title']}</code> - ранг.</li>
<li><code>{$author['member_rank_img']}</code> - изображения ранга.</li>
<li><code>{$author['member_group']}</code> - Группа пользователя.</li>
<li><code>{$author['member_posts']}</code> - Сообщения.</li>
<li><code>{$author['member_joined']}</code> - Регистрация.</li>
<li><code>{$author['member_number']}</code> - ID пользователя.</li>
</ul>
<h2 id="как-добавить-дополнительные-кнопки-bb-кода-в-быстрый-ответ">
  <a class="link-body-emphasis" href="#%d0%ba%d0%b0%d0%ba-%d0%b4%d0%be%d0%b1%d0%b0%d0%b2%d0%b8%d1%82%d1%8c-%d0%b4%d0%be%d0%bf%d0%be%d0%bb%d0%bd%d0%b8%d1%82%d0%b5%d0%bb%d1%8c%d0%bd%d1%8b%d0%b5-%d0%ba%d0%bd%d0%be%d0%bf%d0%ba%d0%b8-bb-%d0%ba%d0%be%d0%b4%d0%b0-%d0%b2-%d0%b1%d1%8b%d1%81%d1%82%d1%80%d1%8b%d0%b9-%d0%be%d1%82%d0%b2%d0%b5%d1%82">Как добавить дополнительные кнопки BB-кода в быстрый ответ?</a>
</h2><p>Сначала нужно в файле <code>./jscripts/ips_text_editor_lite.js</code> добавить свои BB-коды, а потом отредактировать шаблон <code>quick_reply_box_open</code>.</p>
<p>Открываем <code>./jscripts/ips_text_editor_lite.js</code>, находим строчку:</p>



<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-6 shortcode-codeblock-js">
  <div class="d-flex overflow-hidden">
    <div class="flex-grow-1 rounded overflow-hidden" id="cp-6f31019e85cbea2f740d46b72a8cd2bb">
      
      <pre><code class='language-js'>this.ipb_code=function(){var _text=this.get_selection();this.wrap_tags(&#39;code&#39;,false,_text);};</code></pre>
    </div>
    <div class="flex-shrink-0">
      <ul class="list-inline mb-0">
        <li class="list-inline-item" data-bs-tooltip data-bs-title='Копировать'>
          <a class="text-body" href="#"
             data-fn="clipboard preventDefault" data-clipboard-target="#cp-6f31019e85cbea2f740d46b72a8cd2bb"
             role="button" aria-label='Копировать'>
            <i class="fas fa-copy fa-fw"></i>
          </a>
        </li>
      </ul>
    </div>
  </div>
</div>

<p>Эта строка отвечает за BB-код <code>CODE</code>. Копируем её к себе в редактор и заменяем в ней слово code на свой BB-код (например, у меня будет это <code>[i]spoiler[/i]</code>):</p>



<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-7 shortcode-codeblock-js">
  <div class="d-flex overflow-hidden">
    <div class="flex-grow-1 rounded overflow-hidden" id="cp-cb8e273de9ed0e33064d6c02fae2ce9e">
      
      <pre><code class='language-js'>this.ipb_spoiler=function(){var _text=this.get_selection();this.wrap_tags(&#39;spoiler&#39;,false,_text);};</code></pre>
    </div>
    <div class="flex-shrink-0">
      <ul class="list-inline mb-0">
        <li class="list-inline-item" data-bs-tooltip data-bs-title='Копировать'>
          <a class="text-body" href="#"
             data-fn="clipboard preventDefault" data-clipboard-target="#cp-cb8e273de9ed0e33064d6c02fae2ce9e"
             role="button" aria-label='Копировать'>
            <i class="fas fa-copy fa-fw"></i>
          </a>
        </li>
      </ul>
    </div>
  </div>
</div>

<p>После этого вставляем её обратно в файл <code>./jscripts/ips_text_editor_lite.js</code>, НО уже после скопированной нами ранее строки с BB-кодом <code>CODE</code>. Получается вот так:</p>



<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-8 shortcode-codeblock-js">
  <div class="d-flex overflow-hidden">
    <div class="flex-grow-1 rounded overflow-hidden" id="cp-a8c4ac189064d2b32c059b86e63e1d4f">
      
      <pre><code class='language-js'>this.ipb_code=function(){var _text=this.get_selection();this.wrap_tags(&#39;code&#39;,false,_text);};this.ipb_spoiler=function(){var _text=this.get_selection();this.wrap_tags(&#39;spoiler&#39;,false,_text);};</code></pre>
    </div>
    <div class="flex-shrink-0">
      <ul class="list-inline mb-0">
        <li class="list-inline-item" data-bs-tooltip data-bs-title='Копировать'>
          <a class="text-body" href="#"
             data-fn="clipboard preventDefault" data-clipboard-target="#cp-a8c4ac189064d2b32c059b86e63e1d4f"
             role="button" aria-label='Копировать'>
            <i class="fas fa-copy fa-fw"></i>
          </a>
        </li>
      </ul>
    </div>
  </div>
</div>

<p>Сохраняем!</p>
<p>Теперь нужно отредактировать шаблон <code>quick_reply_box_open</code>:</p>
<ul>
<li>Админцентр / Внешний вид / <em>Ваш скин</em>.
<ul>
<li>редактировать HTML фрагменты / <code>skin_topic</code> (Просмотр темы) / <code>quick_reply_box_open</code>.</li>
</ul>
</li>
</ul>
<p>Открываем шаблон, находим:</p>



<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-9 shortcode-codeblock-html">
  <div class="d-flex overflow-hidden">
    <div class="flex-grow-1 rounded overflow-hidden" id="cp-c7245220864f106926bcd11a3ad842f7">
      
      <pre><code class='language-html'>&lt;td&gt;&lt;div class=&#34;rte-normal&#34; id=&#34;fast-reply_cmd_ipb_code&#34;&gt;&lt;img src=&#34;style_images/&lt;#IMG_DIR#&gt;/folder_editor_images/rte-code-button.png&#34;  alt=&#34;{$this-&gt;ipsclass-&gt;lang[&#39;js_rte_lite_code&#39;]}&#34; title=&#34;{$this-&gt;ipsclass-&gt;lang[&#39;js_rte_lite_code&#39;]}&#34;&gt;&lt;/div&gt;&lt;/td&gt;</code></pre>
    </div>
    <div class="flex-shrink-0">
      <ul class="list-inline mb-0">
        <li class="list-inline-item" data-bs-tooltip data-bs-title='Копировать'>
          <a class="text-body" href="#"
             data-fn="clipboard preventDefault" data-clipboard-target="#cp-c7245220864f106926bcd11a3ad842f7"
             role="button" aria-label='Копировать'>
            <i class="fas fa-copy fa-fw"></i>
          </a>
        </li>
      </ul>
    </div>
  </div>
</div>

<p>Копируем этот участок и вставляем ниже. Теперь нужно отредактировать вставленный нами участок. Слово <code>code</code> заменяем на свой тег. Напомню, что у меня это - <code>spoiler</code>. Вот пример:</p>



<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-10 shortcode-codeblock-html">
  <div class="d-flex overflow-hidden">
    <div class="flex-grow-1 rounded overflow-hidden" id="cp-3f477deaf1e0cf51d6037629c845be96">
      
      <pre><code class='language-html'>&lt;td&gt;&lt;div class=&#34;rte-normal&#34; id=&#34;fast-reply_cmd_ipb_spoiler&#34;&gt;&lt;img src=&#34;style_images/&lt;#IMG_DIR#&gt;/folder_editor_images/rte-spoiler-button.png&#34;  alt=&#34;Спойлер&#34; title=&#34;Спойлер&#34;&gt;&lt;/div&gt;&lt;/td&gt;</code></pre>
    </div>
    <div class="flex-shrink-0">
      <ul class="list-inline mb-0">
        <li class="list-inline-item" data-bs-tooltip data-bs-title='Копировать'>
          <a class="text-body" href="#"
             data-fn="clipboard preventDefault" data-clipboard-target="#cp-3f477deaf1e0cf51d6037629c845be96"
             role="button" aria-label='Копировать'>
            <i class="fas fa-copy fa-fw"></i>
          </a>
        </li>
      </ul>
    </div>
  </div>
</div>

<p>Не забудьте загрузить кнопку для своего тега в папку <code>./style_images/папка_стиля/folder_editor_images</code>.</p>
<h2 id="как-добавить-дополнительные-кнопки-bb-кода-в-расширенный-ответ">
  <a class="link-body-emphasis" href="#%d0%ba%d0%b0%d0%ba-%d0%b4%d0%be%d0%b1%d0%b0%d0%b2%d0%b8%d1%82%d1%8c-%d0%b4%d0%be%d0%bf%d0%be%d0%bb%d0%bd%d0%b8%d1%82%d0%b5%d0%bb%d1%8c%d0%bd%d1%8b%d0%b5-%d0%ba%d0%bd%d0%be%d0%bf%d0%ba%d0%b8-bb-%d0%ba%d0%be%d0%b4%d0%b0-%d0%b2-%d1%80%d0%b0%d1%81%d1%88%d0%b8%d1%80%d0%b5%d0%bd%d0%bd%d1%8b%d0%b9-%d0%be%d1%82%d0%b2%d0%b5%d1%82">Как добавить дополнительные кнопки BB-кода в расширенный ответ?</a>
</h2><p>Инструкция добавления BB-кода в расширенный ответ похожа на предыдущую, за исключением того, что для расширенного ответа необходимо отредактировать файл <code>./jscripts/ips_text_editor.js</code> и шаблон <code>ips_editor</code>.</p>
<p>Открываем <code>./jscripts/ips_text_editor.js</code>, находим:</p>



<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-11 shortcode-codeblock-js">
  <div class="d-flex overflow-hidden">
    <div class="flex-grow-1 rounded overflow-hidden" id="cp-628399ba45ad51339525a679b860ad71">
      
      <pre><code class='language-js'>this.ipb_quote = function()
  {
    this.wrap_tags_lite(  &#39;[quote]&#39;, &#39;[/quote]&#39;, 0)
  };</code></pre>
    </div>
    <div class="flex-shrink-0">
      <ul class="list-inline mb-0">
        <li class="list-inline-item" data-bs-tooltip data-bs-title='Копировать'>
          <a class="text-body" href="#"
             data-fn="clipboard preventDefault" data-clipboard-target="#cp-628399ba45ad51339525a679b860ad71"
             role="button" aria-label='Копировать'>
            <i class="fas fa-copy fa-fw"></i>
          </a>
        </li>
      </ul>
    </div>
  </div>
</div>

<p>Добавить ниже:</p>



<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-12 shortcode-codeblock-js">
  <div class="d-flex overflow-hidden">
    <div class="flex-grow-1 rounded overflow-hidden" id="cp-a225592f28d7356cef856491eedff690">
      
      <pre><code class='language-js'>this.ipb_youtube = function()
  {
    this.wrap_tags_lite(  &#39;[spoiler]&#39;, &#39;[/spoiler]&#39;, 0)
  };</code></pre>
    </div>
    <div class="flex-shrink-0">
      <ul class="list-inline mb-0">
        <li class="list-inline-item" data-bs-tooltip data-bs-title='Копировать'>
          <a class="text-body" href="#"
             data-fn="clipboard preventDefault" data-clipboard-target="#cp-a225592f28d7356cef856491eedff690"
             role="button" aria-label='Копировать'>
            <i class="fas fa-copy fa-fw"></i>
          </a>
        </li>
      </ul>
    </div>
  </div>
</div>

<p>После этого необходимо отредактировать шаблон <code>skin_editors</code> (редактор сообщений) / <code>ips_editor</code>, чтобы добавить кнопку в расширенный ответ. Находим:</p>



<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-13 shortcode-codeblock-html">
  <div class="d-flex overflow-hidden">
    <div class="flex-grow-1 rounded overflow-hidden" id="cp-0354ee639d3780f64e196e9fab6f73f4">
      
      <pre><code class='language-html'>&lt;td&gt;&lt;div class=&#34;rte-normal&#34;  id=&#34;{$editor_id}_cmd_ipb_code&#34;&gt;&lt;img  src=&#34;{$images_path}rte-code-button.png&#34;   alt=&#34;{$this-&gt;ipsclass-&gt;lang[&#39;js_rte_lite_code&#39;]}&#34;  title=&#34;{$this-&gt;ipsclass-&gt;lang[&#39;js_rte_lite_code&#39;]}&#34;&gt;&lt;/div&gt;&lt;/td&gt;</code></pre>
    </div>
    <div class="flex-shrink-0">
      <ul class="list-inline mb-0">
        <li class="list-inline-item" data-bs-tooltip data-bs-title='Копировать'>
          <a class="text-body" href="#"
             data-fn="clipboard preventDefault" data-clipboard-target="#cp-0354ee639d3780f64e196e9fab6f73f4"
             role="button" aria-label='Копировать'>
            <i class="fas fa-copy fa-fw"></i>
          </a>
        </li>
      </ul>
    </div>
  </div>
</div>

<p>Добавляем выше:</p>



<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-14 shortcode-codeblock-html">
  <div class="d-flex overflow-hidden">
    <div class="flex-grow-1 rounded overflow-hidden" id="cp-7fab636053f168e305954ee645a5df3b">
      
      <pre><code class='language-html'>&lt;td&gt;&lt;div class=&#34;rte-normal&#34; id=&#34;{$editor_id}_cmd_ipb_youtube&#34;&gt;&lt;img src=&#34;{$images_path}rte-code-tube.png&#34;  alt=&#34;Youtube&#34; title=&#34;YouTube&#34;&gt;&lt;/div&gt;&lt;/td&gt;</code></pre>
    </div>
    <div class="flex-shrink-0">
      <ul class="list-inline mb-0">
        <li class="list-inline-item" data-bs-tooltip data-bs-title='Копировать'>
          <a class="text-body" href="#"
             data-fn="clipboard preventDefault" data-clipboard-target="#cp-7fab636053f168e305954ee645a5df3b"
             role="button" aria-label='Копировать'>
            <i class="fas fa-copy fa-fw"></i>
          </a>
        </li>
      </ul>
    </div>
  </div>
</div>

<p>Не забудьте загрузить кнопку для своего тега в папку <code>./style_images/папка_стиля/folder_editor_images</code>.</p>
<h2 id="возникает-ошибка-fatal-error-allowed-memory-size-of-xxx-bytes-exhausted-tried-to-allocate-yyy-bytes-что-это-такое">
  <a class="link-body-emphasis" href="#%d0%b2%d0%be%d0%b7%d0%bd%d0%b8%d0%ba%d0%b0%d0%b5%d1%82-%d0%be%d1%88%d0%b8%d0%b1%d0%ba%d0%b0-fatal-error-allowed-memory-size-of-xxx-bytes-exhausted-tried-to-allocate-yyy-bytes-%d1%87%d1%82%d0%be-%d1%8d%d1%82%d0%be-%d1%82%d0%b0%d0%ba%d0%be%d0%b5">Возникает ошибка Fatal error: Allowed memory size of xxx bytes exhausted (tried to allocate yyy bytes). Что это такое?</a>
</h2><p>При попытке зайти в тему, профиль пользователя, список пользователей либо любую другую страницу ничего не выводится, либо выводится сообщение аналогичное приведенному:</p>






    




<div class="shortcode shortcode-window">
  <div class="card text-bg-danger mb-3 overflow-hidden">
    <div class="card-header">
      <div class="d-flex align-items-center">
        <div class="flex-shrink-0">
          <i class="fas fa-computer fa-fw"></i>
        </div>
        <div class="flex-grow-1 mx-2">
          <h5 class="mb-0">Fatal error</h5>
        </div>
        <div class="flex-shrink-0">
          <ul class="list-inline mb-0">
            <li class="list-inline-item"><i class="fas fa-circle fa-fw"></i></li>
            <li class="list-inline-item"><i class="fas fa-circle fa-fw"></i></li>
            <li class="list-inline-item"><i class="fas fa-circle fa-fw"></i></li>
          </ul>
        </div>
      </div>
    </div>
    <div class="card-body">
        <p>Fatal error: Allowed memory size of 8388608 bytes exhausted (tried to allocate 737280 bytes) in /home/ourmobil/public_html/forum/sources/ipsclass.php(2054) : eval()&rsquo;d code on line 1085</p>

    </div>
  </div>
</div>

<p>или такому:</p>






    




<div class="shortcode shortcode-window">
  <div class="card text-bg-danger mb-3 overflow-hidden">
    <div class="card-header">
      <div class="d-flex align-items-center">
        <div class="flex-shrink-0">
          <i class="fas fa-computer fa-fw"></i>
        </div>
        <div class="flex-grow-1 mx-2">
          <h5 class="mb-0">Fatal error</h5>
        </div>
        <div class="flex-shrink-0">
          <ul class="list-inline mb-0">
            <li class="list-inline-item"><i class="fas fa-circle fa-fw"></i></li>
            <li class="list-inline-item"><i class="fas fa-circle fa-fw"></i></li>
            <li class="list-inline-item"><i class="fas fa-circle fa-fw"></i></li>
          </ul>
        </div>
      </div>
    </div>
    <div class="card-body">
        <p>Fatal error: Allowed memory size of 50331648 bytes exhausted (tried to allocate 16 bytes) in /home/users/d/demon99/docs/subs/cs/forum/ips_kernel/class_xml.php on line 254</p>

    </div>
  </div>
</div>

<p>Это означает, что для выполнения скрипта требуется больше памяти, чем предоставляет PHP. Необходимо увеличить количество выделяемой PHP памяти. Сделать это можно одним из следующих способов:</p>
<ol>
<li>В <code>.htaccess</code> добавить строку (при условии, что <span class="shortcode shortcode-tag"><a href="/ru/tags/php/" target="_blank">#PHP</a></span> работает под Apache):</li>
</ol>



<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-18 ">
  <div class="d-flex overflow-hidden">
    <div class="flex-grow-1 rounded overflow-hidden" id="cp-2db78110601d84b5be1b6280257b1949">
      
      <pre><code >php_value memory_limit 32M</code></pre>
    </div>
    <div class="flex-shrink-0">
      <ul class="list-inline mb-0">
        <li class="list-inline-item" data-bs-tooltip data-bs-title='Копировать'>
          <a class="text-body" href="#"
             data-fn="clipboard preventDefault" data-clipboard-target="#cp-2db78110601d84b5be1b6280257b1949"
             role="button" aria-label='Копировать'>
            <i class="fas fa-copy fa-fw"></i>
          </a>
        </li>
      </ul>
    </div>
  </div>
</div>

<ol start="2">
<li>В <code>php.ini</code> (при условии, что Вы можете его редактировать) изменить значение параметра <code>memory_limit</code>:</li>
</ol>



<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-19 ">
  <div class="d-flex overflow-hidden">
    <div class="flex-grow-1 rounded overflow-hidden" id="cp-c45360f4e866cec5f88c919f652a17a0">
      
      <pre><code >memory_limit 32M</code></pre>
    </div>
    <div class="flex-shrink-0">
      <ul class="list-inline mb-0">
        <li class="list-inline-item" data-bs-tooltip data-bs-title='Копировать'>
          <a class="text-body" href="#"
             data-fn="clipboard preventDefault" data-clipboard-target="#cp-c45360f4e866cec5f88c919f652a17a0"
             role="button" aria-label='Копировать'>
            <i class="fas fa-copy fa-fw"></i>
          </a>
        </li>
      </ul>
    </div>
  </div>
</div>

<ol start="3">
<li>Добавив в <code>index.php</code> после:</li>
</ol>



<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-20 ">
  <div class="d-flex overflow-hidden">
    <div class="flex-grow-1 rounded overflow-hidden" id="cp-93618ab0efc1cf9e98a51c19ef6fdaa3">
      
      <pre><code >&lt;?php</code></pre>
    </div>
    <div class="flex-shrink-0">
      <ul class="list-inline mb-0">
        <li class="list-inline-item" data-bs-tooltip data-bs-title='Копировать'>
          <a class="text-body" href="#"
             data-fn="clipboard preventDefault" data-clipboard-target="#cp-93618ab0efc1cf9e98a51c19ef6fdaa3"
             role="button" aria-label='Копировать'>
            <i class="fas fa-copy fa-fw"></i>
          </a>
        </li>
      </ul>
    </div>
  </div>
</div>

<p>следующий код:</p>



<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-21 shortcode-codeblock-php">
  <div class="d-flex overflow-hidden">
    <div class="flex-grow-1 rounded overflow-hidden" id="cp-6728affba5b967a375607d6914ac30af">
      
      <pre><code class='language-php'>ini_set(&#39;memory_limit&#39;, &#39;32M&#39;);</code></pre>
    </div>
    <div class="flex-shrink-0">
      <ul class="list-inline mb-0">
        <li class="list-inline-item" data-bs-tooltip data-bs-title='Копировать'>
          <a class="text-body" href="#"
             data-fn="clipboard preventDefault" data-clipboard-target="#cp-6728affba5b967a375607d6914ac30af"
             role="button" aria-label='Копировать'>
            <i class="fas fa-copy fa-fw"></i>
          </a>
        </li>
      </ul>
    </div>
  </div>
</div>

<p>Если ни один из предложенных вариантов не подошел, обратитесь за помощью к хостеру с указанием описания ошибки.</p>
<h2 id="как-сделать-форум-на-несколько-доменов">
  <a class="link-body-emphasis" href="#%d0%ba%d0%b0%d0%ba-%d1%81%d0%b4%d0%b5%d0%bb%d0%b0%d1%82%d1%8c-%d1%84%d0%be%d1%80%d1%83%d0%bc-%d0%bd%d0%b0-%d0%bd%d0%b5%d1%81%d0%ba%d0%be%d0%bb%d1%8c%d0%ba%d0%be-%d0%b4%d0%be%d0%bc%d0%b5%d0%bd%d0%be%d0%b2">Как сделать форум на несколько доменов?</a>
</h2><p>Если у вас несколько доменов, но ОДНА база данных, то в <code>conf_global.php</code> нужно изменить строчку:</p>



<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-22 shortcode-codeblock-php">
  <div class="d-flex overflow-hidden">
    <div class="flex-grow-1 rounded overflow-hidden" id="cp-abff8eee97e869aa1f9f946335887017">
      
      <pre><code class='language-php'>$INFO[&#39;board_url&#39;] = &#39;http://domain.com&#39;;</code></pre>
    </div>
    <div class="flex-shrink-0">
      <ul class="list-inline mb-0">
        <li class="list-inline-item" data-bs-tooltip data-bs-title='Копировать'>
          <a class="text-body" href="#"
             data-fn="clipboard preventDefault" data-clipboard-target="#cp-abff8eee97e869aa1f9f946335887017"
             role="button" aria-label='Копировать'>
            <i class="fas fa-copy fa-fw"></i>
          </a>
        </li>
      </ul>
    </div>
  </div>
</div>

<p>На такую:</p>



<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-23 shortcode-codeblock-php">
  <div class="d-flex overflow-hidden">
    <div class="flex-grow-1 rounded overflow-hidden" id="cp-8ef7c1fbeac907c5f59e34a85e1ed3e2">
      
      <pre><code class='language-php'>$INFO[&#39;board_url&#39;] = &#34;http://&#34;.$_SERVER[&#34;HTTP_HOST&#34;];</code></pre>
    </div>
    <div class="flex-shrink-0">
      <ul class="list-inline mb-0">
        <li class="list-inline-item" data-bs-tooltip data-bs-title='Копировать'>
          <a class="text-body" href="#"
             data-fn="clipboard preventDefault" data-clipboard-target="#cp-8ef7c1fbeac907c5f59e34a85e1ed3e2"
             role="button" aria-label='Копировать'>
            <i class="fas fa-copy fa-fw"></i>
          </a>
        </li>
      </ul>
    </div>
  </div>
</div>

<p>Однако, если форум установлен в под-директорию, например, <code>http://domain.com/forum</code>, то необходимо изменить строчку на следующую:</p>
<p>


<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-24 shortcode-codeblock-php">
  <div class="d-flex overflow-hidden">
    <div class="flex-grow-1 rounded overflow-hidden" id="cp-0dc81e711f79234ba85e1c191054fdf7">
      
      <pre><code class='language-php'>$INFO[&#39;board_url&#39;] = &#34;http://&#34;.$_SERVER[&#34;HTTP_HOST&#34;].&#34;/forum&#34;;</code></pre>
    </div>
    <div class="flex-shrink-0">
      <ul class="list-inline mb-0">
        <li class="list-inline-item" data-bs-tooltip data-bs-title='Копировать'>
          <a class="text-body" href="#"
             data-fn="clipboard preventDefault" data-clipboard-target="#cp-0dc81e711f79234ba85e1c191054fdf7"
             role="button" aria-label='Копировать'>
            <i class="fas fa-copy fa-fw"></i>
          </a>
        </li>
      </ul>
    </div>
  </div>
</div>

Где:</p>
<ul>
<li><code>forum</code> - папка форума.</li>
</ul>
<h2 id="как-сделать-чтобы-прикреплённые-имена-файлов-имели-русские-символы-в-названии">
  <a class="link-body-emphasis" href="#%d0%ba%d0%b0%d0%ba-%d1%81%d0%b4%d0%b5%d0%bb%d0%b0%d1%82%d1%8c-%d1%87%d1%82%d0%be%d0%b1%d1%8b-%d0%bf%d1%80%d0%b8%d0%ba%d1%80%d0%b5%d0%bf%d0%bb%d1%91%d0%bd%d0%bd%d1%8b%d0%b5-%d0%b8%d0%bc%d0%b5%d0%bd%d0%b0-%d1%84%d0%b0%d0%b9%d0%bb%d0%be%d0%b2-%d0%b8%d0%bc%d0%b5%d0%bb%d0%b8-%d1%80%d1%83%d1%81%d1%81%d0%ba%d0%b8%d0%b5-%d1%81%d0%b8%d0%bc%d0%b2%d0%be%d0%bb%d1%8b-%d0%b2-%d0%bd%d0%b0%d0%b7%d0%b2%d0%b0%d0%bd%d0%b8%d0%b8">Как сделать, чтобы прикреплённые имена файлов имели русские символы в названии?</a>
</h2><p>Для этого необходимо открыть файл <code>./ips_kernel/class_upload.php</code>, найти:</p>



<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-25 shortcode-codeblock-php">
  <div class="d-flex overflow-hidden">
    <div class="flex-grow-1 rounded overflow-hidden" id="cp-f71712047ec41b938cc3a0e13e6daa53">
      
      <pre><code class='language-php'>//-------------------------------------------------
// Make the uploaded file safe
//-------------------------------------------------

$FILE_NAME = preg_replace( &#34;/[^\w\.]/&#34;, &#34;_&#34;, $FILE_NAME );</code></pre>
    </div>
    <div class="flex-shrink-0">
      <ul class="list-inline mb-0">
        <li class="list-inline-item" data-bs-tooltip data-bs-title='Копировать'>
          <a class="text-body" href="#"
             data-fn="clipboard preventDefault" data-clipboard-target="#cp-f71712047ec41b938cc3a0e13e6daa53"
             role="button" aria-label='Копировать'>
            <i class="fas fa-copy fa-fw"></i>
          </a>
        </li>
      </ul>
    </div>
  </div>
</div>

<p>Заменить на:</p>



<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-26 shortcode-codeblock-php">
  <div class="d-flex overflow-hidden">
    <div class="flex-grow-1 rounded overflow-hidden" id="cp-9bb5930164cf79daa143b02b38074685">
      
      <pre><code class='language-php'>//-------------------------------------------------
// Make the uploaded file safe
//-------------------------------------------------

$FILE_NAME = preg_replace( &#34;/[^a-zA-Z0-9а-яА-Я\-\.\_]/&#34;, &#34;_&#34;, $FILE_NAME );</code></pre>
    </div>
    <div class="flex-shrink-0">
      <ul class="list-inline mb-0">
        <li class="list-inline-item" data-bs-tooltip data-bs-title='Копировать'>
          <a class="text-body" href="#"
             data-fn="clipboard preventDefault" data-clipboard-target="#cp-9bb5930164cf79daa143b02b38074685"
             role="button" aria-label='Копировать'>
            <i class="fas fa-copy fa-fw"></i>
          </a>
        </li>
      </ul>
    </div>
  </div>
</div>]]></turbo:content></item><item turbo="true"><title>SQL запросы IP.Board 2.3</title><link>https://lib.onl/ru/articles/2023/10/54d4e488-9a8f-55ed-8fea-c77d4dba0720/</link><pubDate>Mon, 16 Oct 2023 23:59:21 +0000</pubDate><dc:creator>Kai Kimera</dc:creator><category>CMF</category><category>В истории</category><yandex:related><link url="https://lib.onl/ru/articles/2023/10/06c9d359-31f0-5862-a342-62a21d4eb032/">SQL запросы IP.Board 3.x</link><link url="https://lib.onl/ru/articles/2023/10/0743e73e-7c4c-5ab8-bba3-ba70bdb5cdfd/">Условия в файлах IP.Board 2.3</link><link url="https://lib.onl/ru/articles/2023/10/d310a44c-4259-5bef-a7c2-d3d09a5c69f4/">Условия в шаблонах IP.Board 2.3</link><link url="https://lib.onl/ru/articles/2023/10/a7405294-9f0c-52c1-a70e-ce4990079dc7/">Условия в шаблонах IP.Board 3.x</link></yandex:related><turbo:extendedHtml>true</turbo:extendedHtml><turbo:source>https://lib.onl/ru/articles/2023/10/54d4e488-9a8f-55ed-8fea-c77d4dba0720/</turbo:source><turbo:topic>SQL запросы IP.Board 2.3</turbo:topic><turbo:content><![CDATA[<p>Запросы для базы дынных (<span class="shortcode shortcode-tag"><a href="/ru/tags/sql/" target="_blank">#SQL</a></span>) <span class="shortcode shortcode-tag"><a href="/ru/tags/ipb/" target="_blank">#IPB</a></span> 2.3. Информация со старых проектов. Пригодится.</p>
<h2 id="sql-запросы">
  <a class="link-body-emphasis" href="#sql-%d0%b7%d0%b0%d0%bf%d1%80%d0%be%d1%81%d1%8b">SQL запросы</a>
</h2><ol>
<li>Заменить определённый текст во всех сообщениях на форуме.</li>
</ol>



<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-2 shortcode-codeblock-sql">
  <div class="d-flex overflow-hidden">
    <div class="flex-grow-1 rounded overflow-hidden" id="cp-31d2980b93351fe0691af15a15cff866">
      
      <pre><code class='language-sql'>UPDATE ibf_posts SET post = REPLACE(post,&#39;старый текст&#39;,&#39;новый текст&#39;);</code></pre>
    </div>
    <div class="flex-shrink-0">
      <ul class="list-inline mb-0">
        <li class="list-inline-item" data-bs-tooltip data-bs-title='Копировать'>
          <a class="text-body" href="#"
             data-fn="clipboard preventDefault" data-clipboard-target="#cp-31d2980b93351fe0691af15a15cff866"
             role="button" aria-label='Копировать'>
            <i class="fas fa-copy fa-fw"></i>
          </a>
        </li>
      </ul>
    </div>
  </div>
</div>

<ol start="2">
<li>Заменить текст во всех описаниях форумов.</li>
</ol>



<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-3 shortcode-codeblock-sql">
  <div class="d-flex overflow-hidden">
    <div class="flex-grow-1 rounded overflow-hidden" id="cp-e769e16a3de7a17d8606246624af4298">
      
      <pre><code class='language-sql'>UPDATE ibf_forums SET description = REPLACE(description,&#39;старый текст&#39;,&#39;новый текст&#39;);</code></pre>
    </div>
    <div class="flex-shrink-0">
      <ul class="list-inline mb-0">
        <li class="list-inline-item" data-bs-tooltip data-bs-title='Копировать'>
          <a class="text-body" href="#"
             data-fn="clipboard preventDefault" data-clipboard-target="#cp-e769e16a3de7a17d8606246624af4298"
             role="button" aria-label='Копировать'>
            <i class="fas fa-copy fa-fw"></i>
          </a>
        </li>
      </ul>
    </div>
  </div>
</div>

<ol start="3">
<li>Очистка журнала предупреждений конкретного пользователя, где X - вставить id пользователя, чей журнал вы хотите очистить.</li>
</ol>



<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-4 shortcode-codeblock-sql">
  <div class="d-flex overflow-hidden">
    <div class="flex-grow-1 rounded overflow-hidden" id="cp-9def53454d5fd3ac293c84ed21b060d5">
      
      <pre><code class='language-sql'>DELETE FROM ibf_warn_logs WHERE wlog_mid=X;</code></pre>
    </div>
    <div class="flex-shrink-0">
      <ul class="list-inline mb-0">
        <li class="list-inline-item" data-bs-tooltip data-bs-title='Копировать'>
          <a class="text-body" href="#"
             data-fn="clipboard preventDefault" data-clipboard-target="#cp-9def53454d5fd3ac293c84ed21b060d5"
             role="button" aria-label='Копировать'>
            <i class="fas fa-copy fa-fw"></i>
          </a>
        </li>
      </ul>
    </div>
  </div>
</div>

<ol start="4">
<li>Удалить подписи у всех пользователей.</li>
</ol>



<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-5 shortcode-codeblock-sql">
  <div class="d-flex overflow-hidden">
    <div class="flex-grow-1 rounded overflow-hidden" id="cp-c4ea60571022bee71cd6e66135e0737d">
      
      <pre><code class='language-sql'>UPDATE ibf_member_extra SET signature=&#39;Ваша подпись удалена&#39;;</code></pre>
    </div>
    <div class="flex-shrink-0">
      <ul class="list-inline mb-0">
        <li class="list-inline-item" data-bs-tooltip data-bs-title='Копировать'>
          <a class="text-body" href="#"
             data-fn="clipboard preventDefault" data-clipboard-target="#cp-c4ea60571022bee71cd6e66135e0737d"
             role="button" aria-label='Копировать'>
            <i class="fas fa-copy fa-fw"></i>
          </a>
        </li>
      </ul>
    </div>
  </div>
</div>

<ol start="5">
<li>Удаление модераторов.</li>
</ol>



<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-6 shortcode-codeblock-sql">
  <div class="d-flex overflow-hidden">
    <div class="flex-grow-1 rounded overflow-hidden" id="cp-1bb0a97bed2e38a32040aaff4b376bb7">
      
      <pre><code class='language-sql'>DELETE FROM ibf_moderators;</code></pre>
    </div>
    <div class="flex-shrink-0">
      <ul class="list-inline mb-0">
        <li class="list-inline-item" data-bs-tooltip data-bs-title='Копировать'>
          <a class="text-body" href="#"
             data-fn="clipboard preventDefault" data-clipboard-target="#cp-1bb0a97bed2e38a32040aaff4b376bb7"
             role="button" aria-label='Копировать'>
            <i class="fas fa-copy fa-fw"></i>
          </a>
        </li>
      </ul>
    </div>
  </div>
</div>

<ol start="6">
<li>Удаление модератора из всех форумов.</li>
</ol>



<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-7 shortcode-codeblock-sql">
  <div class="d-flex overflow-hidden">
    <div class="flex-grow-1 rounded overflow-hidden" id="cp-e38fb995affc6ad39cdd047f351b9603">
      
      <pre><code class='language-sql'>DELETE FROM ibf_moderators WHERE member_id = XX;</code></pre>
    </div>
    <div class="flex-shrink-0">
      <ul class="list-inline mb-0">
        <li class="list-inline-item" data-bs-tooltip data-bs-title='Копировать'>
          <a class="text-body" href="#"
             data-fn="clipboard preventDefault" data-clipboard-target="#cp-e38fb995affc6ad39cdd047f351b9603"
             role="button" aria-label='Копировать'>
            <i class="fas fa-copy fa-fw"></i>
          </a>
        </li>
      </ul>
    </div>
  </div>
</div>

<ol start="7">
<li>Удаление модератора из определённых форумов.</li>
</ol>



<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-8 shortcode-codeblock-sql">
  <div class="d-flex overflow-hidden">
    <div class="flex-grow-1 rounded overflow-hidden" id="cp-f9af2cfad8c414156a4d94f0ebfd8b10">
      
      <pre><code class='language-sql'>DELETE FROM ibf_moderators WHERE member_id = XX AND forum_id IN (4, 11, 22, 25);</code></pre>
    </div>
    <div class="flex-shrink-0">
      <ul class="list-inline mb-0">
        <li class="list-inline-item" data-bs-tooltip data-bs-title='Копировать'>
          <a class="text-body" href="#"
             data-fn="clipboard preventDefault" data-clipboard-target="#cp-f9af2cfad8c414156a4d94f0ebfd8b10"
             role="button" aria-label='Копировать'>
            <i class="fas fa-copy fa-fw"></i>
          </a>
        </li>
      </ul>
    </div>
  </div>
</div>

<ol start="8">
<li>Удаление аватаров у всех пользователей.</li>
</ol>



<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-9 shortcode-codeblock-sql">
  <div class="d-flex overflow-hidden">
    <div class="flex-grow-1 rounded overflow-hidden" id="cp-331386427bd1cc7f197f6a5cad4cb412">
      
      <pre><code class='language-sql'>DELETE FROM ibf_member_extra WHERE avatar_location AND avatar_size;</code></pre>
    </div>
    <div class="flex-shrink-0">
      <ul class="list-inline mb-0">
        <li class="list-inline-item" data-bs-tooltip data-bs-title='Копировать'>
          <a class="text-body" href="#"
             data-fn="clipboard preventDefault" data-clipboard-target="#cp-331386427bd1cc7f197f6a5cad4cb412"
             role="button" aria-label='Копировать'>
            <i class="fas fa-copy fa-fw"></i>
          </a>
        </li>
      </ul>
    </div>
  </div>
</div>

<ol start="9">
<li>Если не работает, то выполните следующие два запроса:</li>
</ol>



<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-10 shortcode-codeblock-sql">
  <div class="d-flex overflow-hidden">
    <div class="flex-grow-1 rounded overflow-hidden" id="cp-590c1443014ac6c4b3a78825e5de2055">
      
      <pre><code class='language-sql'>UPDATE ibf_member_extra SET avatar_location = &#39;&#39;;</code></pre>
    </div>
    <div class="flex-shrink-0">
      <ul class="list-inline mb-0">
        <li class="list-inline-item" data-bs-tooltip data-bs-title='Копировать'>
          <a class="text-body" href="#"
             data-fn="clipboard preventDefault" data-clipboard-target="#cp-590c1443014ac6c4b3a78825e5de2055"
             role="button" aria-label='Копировать'>
            <i class="fas fa-copy fa-fw"></i>
          </a>
        </li>
      </ul>
    </div>
  </div>
</div>




<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-11 shortcode-codeblock-sql">
  <div class="d-flex overflow-hidden">
    <div class="flex-grow-1 rounded overflow-hidden" id="cp-b53c6522614efde8feb274db36151c5a">
      
      <pre><code class='language-sql'>UPDATE ibf_member_extra SET avatar_size = &#39;&#39;;</code></pre>
    </div>
    <div class="flex-shrink-0">
      <ul class="list-inline mb-0">
        <li class="list-inline-item" data-bs-tooltip data-bs-title='Копировать'>
          <a class="text-body" href="#"
             data-fn="clipboard preventDefault" data-clipboard-target="#cp-b53c6522614efde8feb274db36151c5a"
             role="button" aria-label='Копировать'>
            <i class="fas fa-copy fa-fw"></i>
          </a>
        </li>
      </ul>
    </div>
  </div>
</div>

<ol start="10">
<li>Массовый перенос пользователей c определённым количеством сообщений из одной группы в другую.</li>
</ol>



<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-12 shortcode-codeblock-sql">
  <div class="d-flex overflow-hidden">
    <div class="flex-grow-1 rounded overflow-hidden" id="cp-322a0a833e9fdd67d915e900ce9e0610">
      
      <pre><code class='language-sql'>UPDATE ibf_members SET mgroup=Б WHERE mgroup=А AND posts &gt; 0;</code></pre>
    </div>
    <div class="flex-shrink-0">
      <ul class="list-inline mb-0">
        <li class="list-inline-item" data-bs-tooltip data-bs-title='Копировать'>
          <a class="text-body" href="#"
             data-fn="clipboard preventDefault" data-clipboard-target="#cp-322a0a833e9fdd67d915e900ce9e0610"
             role="button" aria-label='Копировать'>
            <i class="fas fa-copy fa-fw"></i>
          </a>
        </li>
      </ul>
    </div>
  </div>
</div>

<ol start="11">
<li>Удалить пользователей определенной группы, где b меняете на номер группы.</li>
</ol>



<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-13 shortcode-codeblock-sql">
  <div class="d-flex overflow-hidden">
    <div class="flex-grow-1 rounded overflow-hidden" id="cp-a14a81fe2056e639fc1e0595b10fe505">
      
      <pre><code class='language-sql'>DELETE FROM ibf_members WHERE mgroup=&#39;b&#39;;</code></pre>
    </div>
    <div class="flex-shrink-0">
      <ul class="list-inline mb-0">
        <li class="list-inline-item" data-bs-tooltip data-bs-title='Копировать'>
          <a class="text-body" href="#"
             data-fn="clipboard preventDefault" data-clipboard-target="#cp-a14a81fe2056e639fc1e0595b10fe505"
             role="button" aria-label='Копировать'>
            <i class="fas fa-copy fa-fw"></i>
          </a>
        </li>
      </ul>
    </div>
  </div>
</div>

<ol start="12">
<li>Удалить все ICQ номера пользователей.</li>
</ol>



<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-14 shortcode-codeblock-sql">
  <div class="d-flex overflow-hidden">
    <div class="flex-grow-1 rounded overflow-hidden" id="cp-4450422b6f7761239cc1ab5f6361fb19">
      
      <pre><code class='language-sql'>UPDATE ibf_member_extra SET icq_number=&#39;&#39;;</code></pre>
    </div>
    <div class="flex-shrink-0">
      <ul class="list-inline mb-0">
        <li class="list-inline-item" data-bs-tooltip data-bs-title='Копировать'>
          <a class="text-body" href="#"
             data-fn="clipboard preventDefault" data-clipboard-target="#cp-4450422b6f7761239cc1ab5f6361fb19"
             role="button" aria-label='Копировать'>
            <i class="fas fa-copy fa-fw"></i>
          </a>
        </li>
      </ul>
    </div>
  </div>
</div>

<ol start="13">
<li>Удалить ссылки на сайт у всех пользователей.</li>
</ol>



<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-15 shortcode-codeblock-sql">
  <div class="d-flex overflow-hidden">
    <div class="flex-grow-1 rounded overflow-hidden" id="cp-a2fcf00c5eb0e836ea41a446871840d2">
      
      <pre><code class='language-sql'>UPDATE ibf_member_extra SET website=&#39;&#39;;</code></pre>
    </div>
    <div class="flex-shrink-0">
      <ul class="list-inline mb-0">
        <li class="list-inline-item" data-bs-tooltip data-bs-title='Копировать'>
          <a class="text-body" href="#"
             data-fn="clipboard preventDefault" data-clipboard-target="#cp-a2fcf00c5eb0e836ea41a446871840d2"
             role="button" aria-label='Копировать'>
            <i class="fas fa-copy fa-fw"></i>
          </a>
        </li>
      </ul>
    </div>
  </div>
</div>

<ol start="14">
<li>Снятие обязательного подтверждения модератором.</li>
</ol>



<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-16 shortcode-codeblock-sql">
  <div class="d-flex overflow-hidden">
    <div class="flex-grow-1 rounded overflow-hidden" id="cp-1d76b93ee39bd9df97f30539e20f0271">
      
      <pre><code class='language-sql'>UPDATE ibf_members SET mod_posts=&#39;&#39;;</code></pre>
    </div>
    <div class="flex-shrink-0">
      <ul class="list-inline mb-0">
        <li class="list-inline-item" data-bs-tooltip data-bs-title='Копировать'>
          <a class="text-body" href="#"
             data-fn="clipboard preventDefault" data-clipboard-target="#cp-1d76b93ee39bd9df97f30539e20f0271"
             role="button" aria-label='Копировать'>
            <i class="fas fa-copy fa-fw"></i>
          </a>
        </li>
      </ul>
    </div>
  </div>
</div>

<ol start="15">
<li>Снятие только чтение/read_only.</li>
</ol>



<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-17 shortcode-codeblock-sql">
  <div class="d-flex overflow-hidden">
    <div class="flex-grow-1 rounded overflow-hidden" id="cp-2b691bf1cbc3631399f269d1d8360b59">
      
      <pre><code class='language-sql'>UPDATE ibf_members SET restrict_post=&#39;&#39;;</code></pre>
    </div>
    <div class="flex-shrink-0">
      <ul class="list-inline mb-0">
        <li class="list-inline-item" data-bs-tooltip data-bs-title='Копировать'>
          <a class="text-body" href="#"
             data-fn="clipboard preventDefault" data-clipboard-target="#cp-2b691bf1cbc3631399f269d1d8360b59"
             role="button" aria-label='Копировать'>
            <i class="fas fa-copy fa-fw"></i>
          </a>
        </li>
      </ul>
    </div>
  </div>
</div>

<ol start="16">
<li>Очистка журнала.</li>
</ol>



<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-18 shortcode-codeblock-sql">
  <div class="d-flex overflow-hidden">
    <div class="flex-grow-1 rounded overflow-hidden" id="cp-9a5222668073ca2b700298baec5bf066">
      
      <pre><code class='language-sql'>DELETE FROM ibf_warn_logs WHERE wlog_mid=id_пользователя;</code></pre>
    </div>
    <div class="flex-shrink-0">
      <ul class="list-inline mb-0">
        <li class="list-inline-item" data-bs-tooltip data-bs-title='Копировать'>
          <a class="text-body" href="#"
             data-fn="clipboard preventDefault" data-clipboard-target="#cp-9a5222668073ca2b700298baec5bf066"
             role="button" aria-label='Копировать'>
            <i class="fas fa-copy fa-fw"></i>
          </a>
        </li>
      </ul>
    </div>
  </div>
</div>

<ol start="17">
<li>Удаление всех установленных смайликов, то есть они переходят в список неустановленных смайликов.</li>
</ol>



<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-19 shortcode-codeblock-sql">
  <div class="d-flex overflow-hidden">
    <div class="flex-grow-1 rounded overflow-hidden" id="cp-c7db65c81bb0a8b238b6f9fea97d4fed">
      
      <pre><code class='language-sql'>DELETE FROM ibf_emoticons;</code></pre>
    </div>
    <div class="flex-shrink-0">
      <ul class="list-inline mb-0">
        <li class="list-inline-item" data-bs-tooltip data-bs-title='Копировать'>
          <a class="text-body" href="#"
             data-fn="clipboard preventDefault" data-clipboard-target="#cp-c7db65c81bb0a8b238b6f9fea97d4fed"
             role="button" aria-label='Копировать'>
            <i class="fas fa-copy fa-fw"></i>
          </a>
        </li>
      </ul>
    </div>
  </div>
</div>

<ol start="18">
<li>Установка кодировки и сравнения БД по умолчанию.</li>
</ol>



<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-20 shortcode-codeblock-sql">
  <div class="d-flex overflow-hidden">
    <div class="flex-grow-1 rounded overflow-hidden" id="cp-d7faba46936dee1508be96c2b4e92670">
      
      <pre><code class='language-sql'>ALTER DATABASE `название_бд` DEFAULT CHARACTER SET cp1251 COLLATE cp1251_general_ci;</code></pre>
    </div>
    <div class="flex-shrink-0">
      <ul class="list-inline mb-0">
        <li class="list-inline-item" data-bs-tooltip data-bs-title='Копировать'>
          <a class="text-body" href="#"
             data-fn="clipboard preventDefault" data-clipboard-target="#cp-d7faba46936dee1508be96c2b4e92670"
             role="button" aria-label='Копировать'>
            <i class="fas fa-copy fa-fw"></i>
          </a>
        </li>
      </ul>
    </div>
  </div>
</div>

<ol start="19">
<li>Аннулируем счётчик сообщений у всех пользователей.</li>
</ol>



<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-21 shortcode-codeblock-sql">
  <div class="d-flex overflow-hidden">
    <div class="flex-grow-1 rounded overflow-hidden" id="cp-cca3d7eddce6b38932ab69ea88dde270">
      
      <pre><code class='language-sql'>UPDATE ibf_members SET posts=&#39;0&#39;;</code></pre>
    </div>
    <div class="flex-shrink-0">
      <ul class="list-inline mb-0">
        <li class="list-inline-item" data-bs-tooltip data-bs-title='Копировать'>
          <a class="text-body" href="#"
             data-fn="clipboard preventDefault" data-clipboard-target="#cp-cca3d7eddce6b38932ab69ea88dde270"
             role="button" aria-label='Копировать'>
            <i class="fas fa-copy fa-fw"></i>
          </a>
        </li>
      </ul>
    </div>
  </div>
</div>

<ol start="20">
<li>Аннулируем счётчик сообщений у определённых групп.</li>
</ol>



<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-22 shortcode-codeblock-sql">
  <div class="d-flex overflow-hidden">
    <div class="flex-grow-1 rounded overflow-hidden" id="cp-0860408cb464bbbaf1c4b72458faf5fb">
      
      <pre><code class='language-sql'>UPDATE ibf_members SET posts=&#39;0&#39; WHERE mgroup=&#39;номер_группы&#39;;</code></pre>
    </div>
    <div class="flex-shrink-0">
      <ul class="list-inline mb-0">
        <li class="list-inline-item" data-bs-tooltip data-bs-title='Копировать'>
          <a class="text-body" href="#"
             data-fn="clipboard preventDefault" data-clipboard-target="#cp-0860408cb464bbbaf1c4b72458faf5fb"
             role="button" aria-label='Копировать'>
            <i class="fas fa-copy fa-fw"></i>
          </a>
        </li>
      </ul>
    </div>
  </div>
</div>

<ol start="21">
<li>Удаление всех сообщений оставленных гостями.</li>
</ol>



<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-23 shortcode-codeblock-sql">
  <div class="d-flex overflow-hidden">
    <div class="flex-grow-1 rounded overflow-hidden" id="cp-7778afe6f03320ef62ff1d59bc1aa77a">
      
      <pre><code class='language-sql'>DELETE FROM ibf_posts WHERE author_id=&#39;0&#39;;</code></pre>
    </div>
    <div class="flex-shrink-0">
      <ul class="list-inline mb-0">
        <li class="list-inline-item" data-bs-tooltip data-bs-title='Копировать'>
          <a class="text-body" href="#"
             data-fn="clipboard preventDefault" data-clipboard-target="#cp-7778afe6f03320ef62ff1d59bc1aa77a"
             role="button" aria-label='Копировать'>
            <i class="fas fa-copy fa-fw"></i>
          </a>
        </li>
      </ul>
    </div>
  </div>
</div>

<ol start="22">
<li>Заменить текст во всех описаниях тем.</li>
</ol>



<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-24 shortcode-codeblock-sql">
  <div class="d-flex overflow-hidden">
    <div class="flex-grow-1 rounded overflow-hidden" id="cp-92c22b581587502d3d96ddc997981b7f">
      
      <pre><code class='language-sql'>UPDATE ibf_topics SET description = REPLACE(description,&#39;старый текст&#39;,&#39;новый текст&#39;);</code></pre>
    </div>
    <div class="flex-shrink-0">
      <ul class="list-inline mb-0">
        <li class="list-inline-item" data-bs-tooltip data-bs-title='Копировать'>
          <a class="text-body" href="#"
             data-fn="clipboard preventDefault" data-clipboard-target="#cp-92c22b581587502d3d96ddc997981b7f"
             role="button" aria-label='Копировать'>
            <i class="fas fa-copy fa-fw"></i>
          </a>
        </li>
      </ul>
    </div>
  </div>
</div>

<h2 id="благодарности">
  <a class="link-body-emphasis" href="#%d0%b1%d0%bb%d0%b0%d0%b3%d0%be%d0%b4%d0%b0%d1%80%d0%bd%d0%be%d1%81%d1%82%d0%b8">Благодарности</a>
</h2><p>В составлении запросов благодарим следующих участников конференции:</p>
<ul>
<li>Mazafuka</li>
<li>КиКиМоРа</li>
<li>a_aqua</li>
<li>Ritsuka</li>
<li>Security</li>
<li>truth</li>
</ul>]]></turbo:content></item><item turbo="true"><title>SQL запросы IP.Board 3.x</title><link>https://lib.onl/ru/articles/2023/10/06c9d359-31f0-5862-a342-62a21d4eb032/</link><pubDate>Mon, 16 Oct 2023 23:55:00 +0000</pubDate><dc:creator>Kai Kimera</dc:creator><category>CMF</category><category>В истории</category><yandex:related><link url="https://lib.onl/ru/articles/2023/10/0743e73e-7c4c-5ab8-bba3-ba70bdb5cdfd/">Условия в файлах IP.Board 2.3</link><link url="https://lib.onl/ru/articles/2023/10/d310a44c-4259-5bef-a7c2-d3d09a5c69f4/">Условия в шаблонах IP.Board 2.3</link><link url="https://lib.onl/ru/articles/2023/10/a7405294-9f0c-52c1-a70e-ce4990079dc7/">Условия в шаблонах IP.Board 3.x</link></yandex:related><turbo:extendedHtml>true</turbo:extendedHtml><turbo:source>https://lib.onl/ru/articles/2023/10/06c9d359-31f0-5862-a342-62a21d4eb032/</turbo:source><turbo:topic>SQL запросы IP.Board 3.x</turbo:topic><turbo:content><![CDATA[<p>Запросы для базы дынных (<span class="shortcode shortcode-tag"><a href="/ru/tags/sql/" target="_blank">#SQL</a></span>) <span class="shortcode shortcode-tag"><a href="/ru/tags/ipb/" target="_blank">#IPB</a></span> 3. Информация со старых проектов. Пригодится.</p>
<h2 id="sql-запросы">
  <a class="link-body-emphasis" href="#sql-%d0%b7%d0%b0%d0%bf%d1%80%d0%be%d1%81%d1%8b">SQL запросы</a>
</h2><ol>
<li>Удалить всех модераторов.</li>
</ol>



<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-2 shortcode-codeblock-sql">
  <div class="d-flex overflow-hidden">
    <div class="flex-grow-1 rounded overflow-hidden" id="cp-4fb14ca20d166b660091b4e098c6754c">
      
      <pre><code class='language-sql'>DELETE FROM moderators;</code></pre>
    </div>
    <div class="flex-shrink-0">
      <ul class="list-inline mb-0">
        <li class="list-inline-item" data-bs-tooltip data-bs-title='Копировать'>
          <a class="text-body" href="#"
             data-fn="clipboard preventDefault" data-clipboard-target="#cp-4fb14ca20d166b660091b4e098c6754c"
             role="button" aria-label='Копировать'>
            <i class="fas fa-copy fa-fw"></i>
          </a>
        </li>
      </ul>
    </div>
  </div>
</div>

<ol start="2">
<li>Удалить все подписи.</li>
</ol>



<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-3 shortcode-codeblock-sql">
  <div class="d-flex overflow-hidden">
    <div class="flex-grow-1 rounded overflow-hidden" id="cp-66544b5b2bef04a7bff8a08b4af48ae8">
      
      <pre><code class='language-sql'>DELETE FROM content_cache_sigs;</code></pre>
    </div>
    <div class="flex-shrink-0">
      <ul class="list-inline mb-0">
        <li class="list-inline-item" data-bs-tooltip data-bs-title='Копировать'>
          <a class="text-body" href="#"
             data-fn="clipboard preventDefault" data-clipboard-target="#cp-66544b5b2bef04a7bff8a08b4af48ae8"
             role="button" aria-label='Копировать'>
            <i class="fas fa-copy fa-fw"></i>
          </a>
        </li>
      </ul>
    </div>
  </div>
</div>




<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-4 shortcode-codeblock-sql">
  <div class="d-flex overflow-hidden">
    <div class="flex-grow-1 rounded overflow-hidden" id="cp-74237e1a33e218bd7a488ac70f8f988a">
      
      <pre><code class='language-sql'>UPDATE profile_portal SET signature=&#39;&#39;;</code></pre>
    </div>
    <div class="flex-shrink-0">
      <ul class="list-inline mb-0">
        <li class="list-inline-item" data-bs-tooltip data-bs-title='Копировать'>
          <a class="text-body" href="#"
             data-fn="clipboard preventDefault" data-clipboard-target="#cp-74237e1a33e218bd7a488ac70f8f988a"
             role="button" aria-label='Копировать'>
            <i class="fas fa-copy fa-fw"></i>
          </a>
        </li>
      </ul>
    </div>
  </div>
</div>

<ol start="3">
<li>Массовый перенос пользователей c определённым количеством сообщений из одной группы в другую.</li>
</ol>



<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-5 shortcode-codeblock-sql">
  <div class="d-flex overflow-hidden">
    <div class="flex-grow-1 rounded overflow-hidden" id="cp-6960abf865623a6c30804e0addab7f50">
      
      <pre><code class='language-sql'>UPDATE members SET member_group_id=Б WHERE member_group_id=А AND posts &gt; 0;</code></pre>
    </div>
    <div class="flex-shrink-0">
      <ul class="list-inline mb-0">
        <li class="list-inline-item" data-bs-tooltip data-bs-title='Копировать'>
          <a class="text-body" href="#"
             data-fn="clipboard preventDefault" data-clipboard-target="#cp-6960abf865623a6c30804e0addab7f50"
             role="button" aria-label='Копировать'>
            <i class="fas fa-copy fa-fw"></i>
          </a>
        </li>
      </ul>
    </div>
  </div>
</div>

<ol start="4">
<li>Полный пересчет репутации сообщений и пользователей после ручной правки <code>ibf_reputation_index</code>.</li>
</ol>



<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-6 shortcode-codeblock-sql">
  <div class="d-flex overflow-hidden">
    <div class="flex-grow-1 rounded overflow-hidden" id="cp-aadaeb20cc156469a7ee70cdfba4909b">
      
      <pre><code class='language-sql'>TRUNCATE ibf_reputation_cache;</code></pre>
    </div>
    <div class="flex-shrink-0">
      <ul class="list-inline mb-0">
        <li class="list-inline-item" data-bs-tooltip data-bs-title='Копировать'>
          <a class="text-body" href="#"
             data-fn="clipboard preventDefault" data-clipboard-target="#cp-aadaeb20cc156469a7ee70cdfba4909b"
             role="button" aria-label='Копировать'>
            <i class="fas fa-copy fa-fw"></i>
          </a>
        </li>
      </ul>
    </div>
  </div>
</div>




<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-7 shortcode-codeblock-sql">
  <div class="d-flex overflow-hidden">
    <div class="flex-grow-1 rounded overflow-hidden" id="cp-6807d02e5b0fd5c752814ea68b6a2689">
      
      <pre><code class='language-sql'>INSERT INTO ibf_reputation_cache (app, type, type_id, rep_points) SELECT app, type, type_id, SUM(rep_rating) FROM ibf_reputation_index GROUP BY type_id;</code></pre>
    </div>
    <div class="flex-shrink-0">
      <ul class="list-inline mb-0">
        <li class="list-inline-item" data-bs-tooltip data-bs-title='Копировать'>
          <a class="text-body" href="#"
             data-fn="clipboard preventDefault" data-clipboard-target="#cp-6807d02e5b0fd5c752814ea68b6a2689"
             role="button" aria-label='Копировать'>
            <i class="fas fa-copy fa-fw"></i>
          </a>
        </li>
      </ul>
    </div>
  </div>
</div>




<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-8 shortcode-codeblock-sql">
  <div class="d-flex overflow-hidden">
    <div class="flex-grow-1 rounded overflow-hidden" id="cp-c322eeb4baea5462ca1deb285e255b7d">
      
      <pre><code class='language-sql'>UPDATE ibf_profile_portal pp SET pp.pp_reputation_points = (SELECT SUM(r.rep_points) FROM ibf_posts p LEFT JOIN ibf_reputation_cache r ON r.type_id = p.pid WHERE p.author_id = pp.pp_member_id);</code></pre>
    </div>
    <div class="flex-shrink-0">
      <ul class="list-inline mb-0">
        <li class="list-inline-item" data-bs-tooltip data-bs-title='Копировать'>
          <a class="text-body" href="#"
             data-fn="clipboard preventDefault" data-clipboard-target="#cp-c322eeb4baea5462ca1deb285e255b7d"
             role="button" aria-label='Копировать'>
            <i class="fas fa-copy fa-fw"></i>
          </a>
        </li>
      </ul>
    </div>
  </div>
</div>

<ol start="5">
<li>Удаление или замена ненужного мусора из сообщений, например, куски от старых BBCODE.</li>
</ol>



<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-9 shortcode-codeblock-sql">
  <div class="d-flex overflow-hidden">
    <div class="flex-grow-1 rounded overflow-hidden" id="cp-744f3b5a70926959e390caf3ee57100b">
      
      <pre><code class='language-sql'>UPDATE ibf_posts SET post = REPLACE(post,&#34;original&#34;,&#34;replace&#34;);</code></pre>
    </div>
    <div class="flex-shrink-0">
      <ul class="list-inline mb-0">
        <li class="list-inline-item" data-bs-tooltip data-bs-title='Копировать'>
          <a class="text-body" href="#"
             data-fn="clipboard preventDefault" data-clipboard-target="#cp-744f3b5a70926959e390caf3ee57100b"
             role="button" aria-label='Копировать'>
            <i class="fas fa-copy fa-fw"></i>
          </a>
        </li>
      </ul>
    </div>
  </div>
</div>

<ol start="6">
<li>Удаление или замена информации из подписей пользователей.</li>
</ol>



<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-10 shortcode-codeblock-sql">
  <div class="d-flex overflow-hidden">
    <div class="flex-grow-1 rounded overflow-hidden" id="cp-75ca134c214cdc03528df63dcc354ad4">
      
      <pre><code class='language-sql'>UPDATE ibf_profile_portal SET signature = REPLACE(signature,&#34;original&#34;,&#34;replace&#34;);</code></pre>
    </div>
    <div class="flex-shrink-0">
      <ul class="list-inline mb-0">
        <li class="list-inline-item" data-bs-tooltip data-bs-title='Копировать'>
          <a class="text-body" href="#"
             data-fn="clipboard preventDefault" data-clipboard-target="#cp-75ca134c214cdc03528df63dcc354ad4"
             role="button" aria-label='Копировать'>
            <i class="fas fa-copy fa-fw"></i>
          </a>
        </li>
      </ul>
    </div>
  </div>
</div>

<h2 id="благодарности">
  <a class="link-body-emphasis" href="#%d0%b1%d0%bb%d0%b0%d0%b3%d0%be%d0%b4%d0%b0%d1%80%d0%bd%d0%be%d1%81%d1%82%d0%b8">Благодарности</a>
</h2><p>В составлении запросов благодарим следующих участников конференции:</p>
<ul>
<li>Mazafuka</li>
<li>КиКиМоРа</li>
<li>a_aqua</li>
<li>Ritsuka</li>
<li>Security</li>
<li>truth</li>
</ul>]]></turbo:content></item><item turbo="true"><title>Условия в файлах IP.Board 2.3</title><link>https://lib.onl/ru/articles/2023/10/0743e73e-7c4c-5ab8-bba3-ba70bdb5cdfd/</link><pubDate>Mon, 16 Oct 2023 23:49:40 +0000</pubDate><dc:creator>Kai Kimera</dc:creator><category>CMF</category><category>В истории</category><yandex:related><link url="https://lib.onl/ru/articles/2023/10/d310a44c-4259-5bef-a7c2-d3d09a5c69f4/">Условия в шаблонах IP.Board 2.3</link><link url="https://lib.onl/ru/articles/2023/10/a7405294-9f0c-52c1-a70e-ce4990079dc7/">Условия в шаблонах IP.Board 3.x</link></yandex:related><turbo:extendedHtml>true</turbo:extendedHtml><turbo:source>https://lib.onl/ru/articles/2023/10/0743e73e-7c4c-5ab8-bba3-ba70bdb5cdfd/</turbo:source><turbo:topic>Условия в файлах IP.Board 2.3</turbo:topic><turbo:content><![CDATA[<p>Условия в файлах для <span class="shortcode shortcode-tag"><a href="/ru/tags/ipb/" target="_blank">#IPB</a></span> 2.3. Версия <strong>2.3</strong> ужа давно не актуальна, но информация пусть будет.</p>
<h2 id="условия-в-файлах">
  <a class="link-body-emphasis" href="#%d1%83%d1%81%d0%bb%d0%be%d0%b2%d0%b8%d1%8f-%d0%b2-%d1%84%d0%b0%d0%b9%d0%bb%d0%b0%d1%85">Условия в файлах</a>
</h2><ol>
<li>Показать информацию только для пользователей.</li>
</ol>



<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-1 shortcode-codeblock-php">
  <div class="d-flex overflow-hidden">
    <div class="flex-grow-1 rounded overflow-hidden" id="cp-ab76ff450ee0b06d92cce30fc8ce15e1">
      
      <pre><code class='language-php'>if ( $this-&gt;ipsclass-&gt;member[&#39;id&#39;] )
{
  /* информация только для пользователей */
}</code></pre>
    </div>
    <div class="flex-shrink-0">
      <ul class="list-inline mb-0">
        <li class="list-inline-item" data-bs-tooltip data-bs-title='Копировать'>
          <a class="text-body" href="#"
             data-fn="clipboard preventDefault" data-clipboard-target="#cp-ab76ff450ee0b06d92cce30fc8ce15e1"
             role="button" aria-label='Копировать'>
            <i class="fas fa-copy fa-fw"></i>
          </a>
        </li>
      </ul>
    </div>
  </div>
</div>

<ol start="2">
<li>Показать информацию только супер-модераторам.</li>
</ol>



<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-2 shortcode-codeblock-php">
  <div class="d-flex overflow-hidden">
    <div class="flex-grow-1 rounded overflow-hidden" id="cp-7fcc8ea6961feba1db47d7379a9b0d33">
      
      <pre><code class='language-php'>if ( $this-&gt;ipsclass-&gt;member[&#39;g_is_supmod&#39;] )
{
  /* информация только для супермодераторов */
}</code></pre>
    </div>
    <div class="flex-shrink-0">
      <ul class="list-inline mb-0">
        <li class="list-inline-item" data-bs-tooltip data-bs-title='Копировать'>
          <a class="text-body" href="#"
             data-fn="clipboard preventDefault" data-clipboard-target="#cp-7fcc8ea6961feba1db47d7379a9b0d33"
             role="button" aria-label='Копировать'>
            <i class="fas fa-copy fa-fw"></i>
          </a>
        </li>
      </ul>
    </div>
  </div>
</div>

<ol start="3">
<li>Показать информацию только администраторам.</li>
</ol>



<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-3 shortcode-codeblock-php">
  <div class="d-flex overflow-hidden">
    <div class="flex-grow-1 rounded overflow-hidden" id="cp-575fdb0a5b42fd7df650241bee53bb52">
      
      <pre><code class='language-php'>if ( $this-&gt;ipsclass-&gt;member[&#39;mgroup&#39;] == $this-&gt;ipsclass-&gt;vars[&#39;admin_group&#39;] )
{
  /* информация только для администраторов */
}</code></pre>
    </div>
    <div class="flex-shrink-0">
      <ul class="list-inline mb-0">
        <li class="list-inline-item" data-bs-tooltip data-bs-title='Копировать'>
          <a class="text-body" href="#"
             data-fn="clipboard preventDefault" data-clipboard-target="#cp-575fdb0a5b42fd7df650241bee53bb52"
             role="button" aria-label='Копировать'>
            <i class="fas fa-copy fa-fw"></i>
          </a>
        </li>
      </ul>
    </div>
  </div>
</div>

<ol start="4">
<li>Показать информацию только модераторам.</li>
</ol>



<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-4 shortcode-codeblock-php">
  <div class="d-flex overflow-hidden">
    <div class="flex-grow-1 rounded overflow-hidden" id="cp-8bb5a9d2b2fc46e6aaff7a8823ab2e88">
      
      <pre><code class='language-php'>if ( $this-&gt;ipsclass-&gt;member[&#39;_moderator&#39;] )
{
  /* информация только для модераторов */
}</code></pre>
    </div>
    <div class="flex-shrink-0">
      <ul class="list-inline mb-0">
        <li class="list-inline-item" data-bs-tooltip data-bs-title='Копировать'>
          <a class="text-body" href="#"
             data-fn="clipboard preventDefault" data-clipboard-target="#cp-8bb5a9d2b2fc46e6aaff7a8823ab2e88"
             role="button" aria-label='Копировать'>
            <i class="fas fa-copy fa-fw"></i>
          </a>
        </li>
      </ul>
    </div>
  </div>
</div>

<ol start="5">
<li>Показать информацию в определённом форуме.</li>
</ol>



<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-5 shortcode-codeblock-php">
  <div class="d-flex overflow-hidden">
    <div class="flex-grow-1 rounded overflow-hidden" id="cp-34781f2385efdcc255385f72d20dd351">
      
      <pre><code class='language-php'>if ( $this-&gt;ipsclass-&gt;input[&#39;f&#39;] = 35 )
{
  /* информация только в опеределённом форуме с ID = 35 */
}</code></pre>
    </div>
    <div class="flex-shrink-0">
      <ul class="list-inline mb-0">
        <li class="list-inline-item" data-bs-tooltip data-bs-title='Копировать'>
          <a class="text-body" href="#"
             data-fn="clipboard preventDefault" data-clipboard-target="#cp-34781f2385efdcc255385f72d20dd351"
             role="button" aria-label='Копировать'>
            <i class="fas fa-copy fa-fw"></i>
          </a>
        </li>
      </ul>
    </div>
  </div>
</div>

<ol start="6">
<li>Показать информацию на определённой странице.</li>
</ol>



<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-6 shortcode-codeblock-php">
  <div class="d-flex overflow-hidden">
    <div class="flex-grow-1 rounded overflow-hidden" id="cp-8d395d0e5ea8a9e05daca076a48c2378">
      
      <pre><code class='language-php'>if ( $ipsclass-&gt;input[&#39;_low_act&#39;] == &#39;home&#39; )
{
  /* информация только на определённой странице (в данном случае - home) */
}</code></pre>
    </div>
    <div class="flex-shrink-0">
      <ul class="list-inline mb-0">
        <li class="list-inline-item" data-bs-tooltip data-bs-title='Копировать'>
          <a class="text-body" href="#"
             data-fn="clipboard preventDefault" data-clipboard-target="#cp-8d395d0e5ea8a9e05daca076a48c2378"
             role="button" aria-label='Копировать'>
            <i class="fas fa-copy fa-fw"></i>
          </a>
        </li>
      </ul>
    </div>
  </div>
</div>

<ol start="7">
<li>Пример сложной конструкции с применением <code>&lt;или&gt;</code>.</li>
</ol>



<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-7 shortcode-codeblock-php">
  <div class="d-flex overflow-hidden">
    <div class="flex-grow-1 rounded overflow-hidden" id="cp-8da01c9c32a88974a80d5535b01dafe6">
      
      <pre><code class='language-php'>if ( $this-&gt;ipsclass-&gt;member[&#39;id&#39;] )
{
  /* информация только для пользователей */
}
else
{
  /* информация только для гостей */
}</code></pre>
    </div>
    <div class="flex-shrink-0">
      <ul class="list-inline mb-0">
        <li class="list-inline-item" data-bs-tooltip data-bs-title='Копировать'>
          <a class="text-body" href="#"
             data-fn="clipboard preventDefault" data-clipboard-target="#cp-8da01c9c32a88974a80d5535b01dafe6"
             role="button" aria-label='Копировать'>
            <i class="fas fa-copy fa-fw"></i>
          </a>
        </li>
      </ul>
    </div>
  </div>
</div>]]></turbo:content></item><item turbo="true"><title>Условия в шаблонах IP.Board 2.3</title><link>https://lib.onl/ru/articles/2023/10/d310a44c-4259-5bef-a7c2-d3d09a5c69f4/</link><pubDate>Mon, 16 Oct 2023 23:11:29 +0000</pubDate><dc:creator>Kai Kimera</dc:creator><category>CMF</category><category>В истории</category><yandex:related><link url="https://lib.onl/ru/articles/2023/10/a7405294-9f0c-52c1-a70e-ce4990079dc7/">Условия в шаблонах IP.Board 3.x</link></yandex:related><turbo:extendedHtml>true</turbo:extendedHtml><turbo:source>https://lib.onl/ru/articles/2023/10/d310a44c-4259-5bef-a7c2-d3d09a5c69f4/</turbo:source><turbo:topic>Условия в шаблонах IP.Board 2.3</turbo:topic><turbo:content><![CDATA[<p>Список условий, которые можно использовать в шаблонах <span class="shortcode shortcode-tag"><a href="/ru/tags/ipb/" target="_blank">#IPB</a></span> 2.3. Версия <strong>2.3</strong> уже давно не актуальна, но я всё же решил сохранить информацию в своей библиотеке.</p>
<h2 id="условия-в-шаблонах">
  <a class="link-body-emphasis" href="#%d1%83%d1%81%d0%bb%d0%be%d0%b2%d0%b8%d1%8f-%d0%b2-%d1%88%d0%b0%d0%b1%d0%bb%d0%be%d0%bd%d0%b0%d1%85">Условия в шаблонах</a>
</h2><ol>
<li>Показать информацию только для пользователей.</li>
</ol>



<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-1 shortcode-codeblock-html">
  <div class="d-flex overflow-hidden">
    <div class="flex-grow-1 rounded overflow-hidden" id="cp-127aeae89e3d1b246419468cd7707a58">
      
      <pre><code class='language-html'>&lt;if=&#34;ipb.member[&#39;id&#39;] &gt; 0&#34;&gt;
  &lt;!-- информация только для пользователей --&gt;
&lt;/if&gt;</code></pre>
    </div>
    <div class="flex-shrink-0">
      <ul class="list-inline mb-0">
        <li class="list-inline-item" data-bs-tooltip data-bs-title='Копировать'>
          <a class="text-body" href="#"
             data-fn="clipboard preventDefault" data-clipboard-target="#cp-127aeae89e3d1b246419468cd7707a58"
             role="button" aria-label='Копировать'>
            <i class="fas fa-copy fa-fw"></i>
          </a>
        </li>
      </ul>
    </div>
  </div>
</div>

<ol start="2">
<li>Показать информацию только для гостей.</li>
</ol>



<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-2 shortcode-codeblock-html">
  <div class="d-flex overflow-hidden">
    <div class="flex-grow-1 rounded overflow-hidden" id="cp-80cbe449b783c3a19b5dd6e263c8a0d5">
      
      <pre><code class='language-html'>&lt;if=&#34;ipb.member[&#39;id&#39;] &lt;= 0&#34;&gt;
  &lt;!-- информация только для гостей --&gt;
&lt;/if&gt;</code></pre>
    </div>
    <div class="flex-shrink-0">
      <ul class="list-inline mb-0">
        <li class="list-inline-item" data-bs-tooltip data-bs-title='Копировать'>
          <a class="text-body" href="#"
             data-fn="clipboard preventDefault" data-clipboard-target="#cp-80cbe449b783c3a19b5dd6e263c8a0d5"
             role="button" aria-label='Копировать'>
            <i class="fas fa-copy fa-fw"></i>
          </a>
        </li>
      </ul>
    </div>
  </div>
</div>

<ol start="3">
<li>Показать информацию только для группы администраторов.</li>
</ol>



<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-3 shortcode-codeblock-html">
  <div class="d-flex overflow-hidden">
    <div class="flex-grow-1 rounded overflow-hidden" id="cp-5d10a1650ff2c5b5660f0e3275ebe5b3">
      
      <pre><code class='language-html'>&lt;if=&#34;ipb.member[&#39;mgroup&#39;] == ipb.vars[&#39;admin_group&#39;]&#34;&gt;
  &lt;!-- информация только для группы администраторов --&gt;
&lt;/if&gt;</code></pre>
    </div>
    <div class="flex-shrink-0">
      <ul class="list-inline mb-0">
        <li class="list-inline-item" data-bs-tooltip data-bs-title='Копировать'>
          <a class="text-body" href="#"
             data-fn="clipboard preventDefault" data-clipboard-target="#cp-5d10a1650ff2c5b5660f0e3275ebe5b3"
             role="button" aria-label='Копировать'>
            <i class="fas fa-copy fa-fw"></i>
          </a>
        </li>
      </ul>
    </div>
  </div>
</div>

<ol start="4">
<li>Показать информацию только для администрации форума.</li>
</ol>



<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-4 shortcode-codeblock-html">
  <div class="d-flex overflow-hidden">
    <div class="flex-grow-1 rounded overflow-hidden" id="cp-55cb53ede994b5a8ae034246f2617e07">
      
      <pre><code class='language-html'>&lt;if=&#34;ipb.member[&#39;mgroup&#39;] == ipb.vars[&#39;admin_group&#39;] || ipb.member[&#39;is_mod&#39;] || ipb.member[&#39;g_is_supmod&#39;] == 1&#34;&gt;
  &lt;!-- информация только для администрации (различные группы) --&gt;
&lt;/if&gt;</code></pre>
    </div>
    <div class="flex-shrink-0">
      <ul class="list-inline mb-0">
        <li class="list-inline-item" data-bs-tooltip data-bs-title='Копировать'>
          <a class="text-body" href="#"
             data-fn="clipboard preventDefault" data-clipboard-target="#cp-55cb53ede994b5a8ae034246f2617e07"
             role="button" aria-label='Копировать'>
            <i class="fas fa-copy fa-fw"></i>
          </a>
        </li>
      </ul>
    </div>
  </div>
</div>

<ol start="5">
<li>Показать информацию только для определённого пользователя (<code>{id}</code> = ID пользователя).</li>
</ol>



<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-5 shortcode-codeblock-html">
  <div class="d-flex overflow-hidden">
    <div class="flex-grow-1 rounded overflow-hidden" id="cp-12e1da363d14a46d40ea1d1924b4a5e8">
      
      <pre><code class='language-html'>&lt;if=&#34;ipb.member[&#39;id&#39;] == {id}&#34;&gt;
  &lt;!-- информация только для пользователя с определённым {id} --&gt;
&lt;/if&gt;</code></pre>
    </div>
    <div class="flex-shrink-0">
      <ul class="list-inline mb-0">
        <li class="list-inline-item" data-bs-tooltip data-bs-title='Копировать'>
          <a class="text-body" href="#"
             data-fn="clipboard preventDefault" data-clipboard-target="#cp-12e1da363d14a46d40ea1d1924b4a5e8"
             role="button" aria-label='Копировать'>
            <i class="fas fa-copy fa-fw"></i>
          </a>
        </li>
      </ul>
    </div>
  </div>
</div>

<ol start="6">
<li>Показать информацию только для определённых пользователей (<code>{id}</code> = ID пользователя).</li>
</ol>



<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-6 shortcode-codeblock-html">
  <div class="d-flex overflow-hidden">
    <div class="flex-grow-1 rounded overflow-hidden" id="cp-fe13256e833d73faac71d7c705586bd2">
      
      <pre><code class='language-html'>&lt;if=&#34;ipb.member[&#39;id&#39;] == {id1} || ipb.member[&#39;id&#39;] == {id2}&#34;&gt;
  &lt;!-- информация только для пользователя с {id1} и {id2} --&gt;
&lt;/if&gt;</code></pre>
    </div>
    <div class="flex-shrink-0">
      <ul class="list-inline mb-0">
        <li class="list-inline-item" data-bs-tooltip data-bs-title='Копировать'>
          <a class="text-body" href="#"
             data-fn="clipboard preventDefault" data-clipboard-target="#cp-fe13256e833d73faac71d7c705586bd2"
             role="button" aria-label='Копировать'>
            <i class="fas fa-copy fa-fw"></i>
          </a>
        </li>
      </ul>
    </div>
  </div>
</div>

<ol start="7">
<li>Показать информацию только для определённой группы (<code>{gid}</code> = ID группы).</li>
</ol>



<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-7 shortcode-codeblock-html">
  <div class="d-flex overflow-hidden">
    <div class="flex-grow-1 rounded overflow-hidden" id="cp-be9d344ac291a6c30e9d8ba927a2293e">
      
      <pre><code class='language-html'>&lt;if=&#34;ipb.member[&#39;mgroup&#39;] == {gid}&#34;&gt;
  &lt;!-- информация только для определённой группы с {gid} --&gt;
&lt;/if&gt;</code></pre>
    </div>
    <div class="flex-shrink-0">
      <ul class="list-inline mb-0">
        <li class="list-inline-item" data-bs-tooltip data-bs-title='Копировать'>
          <a class="text-body" href="#"
             data-fn="clipboard preventDefault" data-clipboard-target="#cp-be9d344ac291a6c30e9d8ba927a2293e"
             role="button" aria-label='Копировать'>
            <i class="fas fa-copy fa-fw"></i>
          </a>
        </li>
      </ul>
    </div>
  </div>
</div>

<ol start="8">
<li>Показать информацию тольк для двух определённых групп (<code>{gid}</code> = ID группы).</li>
</ol>



<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-8 shortcode-codeblock-html">
  <div class="d-flex overflow-hidden">
    <div class="flex-grow-1 rounded overflow-hidden" id="cp-98f0985fc75438aea6cb0367571e8c4c">
      
      <pre><code class='language-html'>&lt;if=&#34;ipb.member[&#39;mgroup&#39;] == {gid1} || ipb.member[&#39;mgroup&#39;] == {gid2}&#34;&gt;
  &lt;!-- информация только для группы с {gid1} и {gid2} --&gt;
&lt;/if&gt;</code></pre>
    </div>
    <div class="flex-shrink-0">
      <ul class="list-inline mb-0">
        <li class="list-inline-item" data-bs-tooltip data-bs-title='Копировать'>
          <a class="text-body" href="#"
             data-fn="clipboard preventDefault" data-clipboard-target="#cp-98f0985fc75438aea6cb0367571e8c4c"
             role="button" aria-label='Копировать'>
            <i class="fas fa-copy fa-fw"></i>
          </a>
        </li>
      </ul>
    </div>
  </div>
</div>

<ol start="9">
<li>Показать информацию только на определённой странице форума (<code>idx</code> = страница).</li>
</ol>



<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-9 shortcode-codeblock-html">
  <div class="d-flex overflow-hidden">
    <div class="flex-grow-1 rounded overflow-hidden" id="cp-0b3d357219891a1b8ea733652827ec4a">
      
      <pre><code class='language-html'>&lt;if=&#34;ipb.input[&#39;_low_act&#39;] == &#39;idx&#39;&#34;&gt;
  &lt;!-- информация только для определённой страницы форума (index.php?act=idx) --&gt;
&lt;/if&gt;</code></pre>
    </div>
    <div class="flex-shrink-0">
      <ul class="list-inline mb-0">
        <li class="list-inline-item" data-bs-tooltip data-bs-title='Копировать'>
          <a class="text-body" href="#"
             data-fn="clipboard preventDefault" data-clipboard-target="#cp-0b3d357219891a1b8ea733652827ec4a"
             role="button" aria-label='Копировать'>
            <i class="fas fa-copy fa-fw"></i>
          </a>
        </li>
      </ul>
    </div>
  </div>
</div>

<ol start="10">
<li>Показать информацию только в определённом форуме (<code>{fid}</code> = ID форума).</li>
</ol>



<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-10 shortcode-codeblock-html">
  <div class="d-flex overflow-hidden">
    <div class="flex-grow-1 rounded overflow-hidden" id="cp-c59c09d0f3c35e3850fb6db8ebe78836">
      
      <pre><code class='language-html'>&lt;if=&#34;ipb.input[&#39;showforum&#39;] == {fid}&#34;&gt;
  &lt;!-- информация только для определённого форума с {fid} --&gt;
&lt;/if&gt;</code></pre>
    </div>
    <div class="flex-shrink-0">
      <ul class="list-inline mb-0">
        <li class="list-inline-item" data-bs-tooltip data-bs-title='Копировать'>
          <a class="text-body" href="#"
             data-fn="clipboard preventDefault" data-clipboard-target="#cp-c59c09d0f3c35e3850fb6db8ebe78836"
             role="button" aria-label='Копировать'>
            <i class="fas fa-copy fa-fw"></i>
          </a>
        </li>
      </ul>
    </div>
  </div>
</div>

<ol start="11">
<li>Показать информацию только в определённой теме (<code>{tid}</code> = ID темы).</li>
</ol>



<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-11 shortcode-codeblock-html">
  <div class="d-flex overflow-hidden">
    <div class="flex-grow-1 rounded overflow-hidden" id="cp-343272e253e51ef760cefc32b21a80f4">
      
      <pre><code class='language-html'>&lt;if=&#34;ipb.input[&#39;showtopic&#39;] == {tid}&#34;&gt;
  &lt;!-- информация только для определённой темы с {tid} --&gt;
&lt;/if&gt;</code></pre>
    </div>
    <div class="flex-shrink-0">
      <ul class="list-inline mb-0">
        <li class="list-inline-item" data-bs-tooltip data-bs-title='Копировать'>
          <a class="text-body" href="#"
             data-fn="clipboard preventDefault" data-clipboard-target="#cp-343272e253e51ef760cefc32b21a80f4"
             role="button" aria-label='Копировать'>
            <i class="fas fa-copy fa-fw"></i>
          </a>
        </li>
      </ul>
    </div>
  </div>
</div>

<ol start="12">
<li>Показать информацию только в определённом сообщении (<code>{pnid}</code> = номер сообщения).</li>
</ol>



<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-12 shortcode-codeblock-html">
  <div class="d-flex overflow-hidden">
    <div class="flex-grow-1 rounded overflow-hidden" id="cp-72bea48609373540ca04a8ff85661955">
      
      <pre><code class='language-html'>&lt;if=&#34;$post[&#39;post_count&#39;] == {pnid}&#34;&gt;
  &lt;!-- информация только в сообщении с номером {pnid} --&gt;
&lt;/if&gt;</code></pre>
    </div>
    <div class="flex-shrink-0">
      <ul class="list-inline mb-0">
        <li class="list-inline-item" data-bs-tooltip data-bs-title='Копировать'>
          <a class="text-body" href="#"
             data-fn="clipboard preventDefault" data-clipboard-target="#cp-72bea48609373540ca04a8ff85661955"
             role="button" aria-label='Копировать'>
            <i class="fas fa-copy fa-fw"></i>
          </a>
        </li>
      </ul>
    </div>
  </div>
</div>

<ol start="13">
<li>Показать информацию во всех, кроме определённого сообщения (<code>{pnid}</code> = номер сообщения).</li>
</ol>



<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-13 shortcode-codeblock-html">
  <div class="d-flex overflow-hidden">
    <div class="flex-grow-1 rounded overflow-hidden" id="cp-8126976bca08fc29c3ed0e067e7d8338">
      
      <pre><code class='language-html'>&lt;if=&#34;$post[&#39;post_count&#39;] != {pnid}&#34;&gt;
  &lt;!-- информация во всех сообщениях, кроме сообщения с номером {pnid} --&gt;
&lt;/if&gt;</code></pre>
    </div>
    <div class="flex-shrink-0">
      <ul class="list-inline mb-0">
        <li class="list-inline-item" data-bs-tooltip data-bs-title='Копировать'>
          <a class="text-body" href="#"
             data-fn="clipboard preventDefault" data-clipboard-target="#cp-8126976bca08fc29c3ed0e067e7d8338"
             role="button" aria-label='Копировать'>
            <i class="fas fa-copy fa-fw"></i>
          </a>
        </li>
      </ul>
    </div>
  </div>
</div>

<ol start="14">
<li>Показать информацию в определённых сообщениях (<code>1,5,10</code> = номера сообщений).</li>
</ol>



<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-14 shortcode-codeblock-html">
  <div class="d-flex overflow-hidden">
    <div class="flex-grow-1 rounded overflow-hidden" id="cp-ea53988604d76fb2bcd3ae2c92c9fb94">
      
      <pre><code class='language-html'>&lt;if=&#34;in_array($post[&#39;post_count&#39;], array(1,5,10))&#34;&gt;
  &lt;!-- отображение информации в сообщениях 1, 5 и 10 --&gt;
&lt;/if&gt;</code></pre>
    </div>
    <div class="flex-shrink-0">
      <ul class="list-inline mb-0">
        <li class="list-inline-item" data-bs-tooltip data-bs-title='Копировать'>
          <a class="text-body" href="#"
             data-fn="clipboard preventDefault" data-clipboard-target="#cp-ea53988604d76fb2bcd3ae2c92c9fb94"
             role="button" aria-label='Копировать'>
            <i class="fas fa-copy fa-fw"></i>
          </a>
        </li>
      </ul>
    </div>
  </div>
</div>

<ol start="15">
<li>Показать информацию только в определённом сообщении пользователя (<code>{id}</code> = ID пользователя).</li>
</ol>



<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-15 shortcode-codeblock-html">
  <div class="d-flex overflow-hidden">
    <div class="flex-grow-1 rounded overflow-hidden" id="cp-7181db14feeb6ecc9f4af272dea70cb7">
      
      <pre><code class='language-html'>&lt;if=&#34;$author[&#39;id&#39;] == {id}&#34;&gt;
  &lt;!-- информация только в определённом сообщении пользователя с ID = {id} --&gt;
&lt;/if&gt;</code></pre>
    </div>
    <div class="flex-shrink-0">
      <ul class="list-inline mb-0">
        <li class="list-inline-item" data-bs-tooltip data-bs-title='Копировать'>
          <a class="text-body" href="#"
             data-fn="clipboard preventDefault" data-clipboard-target="#cp-7181db14feeb6ecc9f4af272dea70cb7"
             role="button" aria-label='Копировать'>
            <i class="fas fa-copy fa-fw"></i>
          </a>
        </li>
      </ul>
    </div>
  </div>
</div>

<ol start="16">
<li>Пример сложной конструкции с применением <code>&lt;или&gt;</code>.</li>
</ol>



<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-16 shortcode-codeblock-html">
  <div class="d-flex overflow-hidden">
    <div class="flex-grow-1 rounded overflow-hidden" id="cp-c3ce283735477d3c89eb697aa84d876d">
      
      <pre><code class='language-html'>&lt;if=&#34;ipb.member[&#39;id&#39;] &gt; 0&#34;&gt;
  &lt;!-- информация только для пользователей --&gt;
&lt;else /&gt;
  &lt;!-- информация только для гостей --&gt;
&lt;/if&gt;</code></pre>
    </div>
    <div class="flex-shrink-0">
      <ul class="list-inline mb-0">
        <li class="list-inline-item" data-bs-tooltip data-bs-title='Копировать'>
          <a class="text-body" href="#"
             data-fn="clipboard preventDefault" data-clipboard-target="#cp-c3ce283735477d3c89eb697aa84d876d"
             role="button" aria-label='Копировать'>
            <i class="fas fa-copy fa-fw"></i>
          </a>
        </li>
      </ul>
    </div>
  </div>
</div>]]></turbo:content></item><item turbo="true"><title>Условия в шаблонах IP.Board 3.x</title><link>https://lib.onl/ru/articles/2023/10/a7405294-9f0c-52c1-a70e-ce4990079dc7/</link><pubDate>Mon, 16 Oct 2023 23:07:22 +0000</pubDate><dc:creator>Kai Kimera</dc:creator><category>CMF</category><category>В истории</category><turbo:extendedHtml>true</turbo:extendedHtml><turbo:source>https://lib.onl/ru/articles/2023/10/a7405294-9f0c-52c1-a70e-ce4990079dc7/</turbo:source><turbo:topic>Условия в шаблонах IP.Board 3.x</turbo:topic><turbo:content><![CDATA[<p>Список условий, которые можно использовать в шаблонах <span class="shortcode shortcode-tag"><a href="/ru/tags/ipb/" target="_blank">#IPB</a></span> 3.x. Продолжаю находить и публиковать старые заметки со своих давно закрытых ресурсов.</p>
<h2 id="условия-в-шаблонах">
  <a class="link-body-emphasis" href="#%d1%83%d1%81%d0%bb%d0%be%d0%b2%d0%b8%d1%8f-%d0%b2-%d1%88%d0%b0%d0%b1%d0%bb%d0%be%d0%bd%d0%b0%d1%85">Условия в шаблонах</a>
</h2><ol>
<li>Отображение информации в определённом сообщении.</li>
</ol>



<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-1 shortcode-codeblock-html">
  <div class="d-flex overflow-hidden">
    <div class="flex-grow-1 rounded overflow-hidden" id="cp-94f2ab4435ef2448303cc776b505bb10">
      
      <pre><code class='language-html'>&lt;if test=&#34;$post[&#39;post&#39;][&#39;post_count&#39;] == X&#34;&gt;
  &lt;!-- информация только в сообщении X --&gt;
&lt;/if&gt;</code></pre>
    </div>
    <div class="flex-shrink-0">
      <ul class="list-inline mb-0">
        <li class="list-inline-item" data-bs-tooltip data-bs-title='Копировать'>
          <a class="text-body" href="#"
             data-fn="clipboard preventDefault" data-clipboard-target="#cp-94f2ab4435ef2448303cc776b505bb10"
             role="button" aria-label='Копировать'>
            <i class="fas fa-copy fa-fw"></i>
          </a>
        </li>
      </ul>
    </div>
  </div>
</div>

<p>Где:</p>
<ul>
<li><code>X</code> - номер сообщения в теме.</li>
</ul>
<ol start="2">
<li>Отображение информации для определённых групп.</li>
</ol>



<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-2 shortcode-codeblock-html">
  <div class="d-flex overflow-hidden">
    <div class="flex-grow-1 rounded overflow-hidden" id="cp-d984d5e0d6946c882b96f0d4c44661c1">
      
      <pre><code class='language-html'>&lt;if test=&#34;in_array($this-&gt;memberData[&#39;member_group_id&#39;], array( 4,5,6 ) )&#34;&gt;
  &lt;!-- информация только для групп ID = 4, 5 и 6 --&gt;
&lt;else /&gt;
  &lt;!-- информация для всех остальных --&gt;
&lt;/if&gt;</code></pre>
    </div>
    <div class="flex-shrink-0">
      <ul class="list-inline mb-0">
        <li class="list-inline-item" data-bs-tooltip data-bs-title='Копировать'>
          <a class="text-body" href="#"
             data-fn="clipboard preventDefault" data-clipboard-target="#cp-d984d5e0d6946c882b96f0d4c44661c1"
             role="button" aria-label='Копировать'>
            <i class="fas fa-copy fa-fw"></i>
          </a>
        </li>
      </ul>
    </div>
  </div>
</div>

<ol start="3">
<li>Пример сложной конструкции с применением <code>&lt;или&gt;</code>.</li>
</ol>



<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-3 shortcode-codeblock-html">
  <div class="d-flex overflow-hidden">
    <div class="flex-grow-1 rounded overflow-hidden" id="cp-1de450df43a53da34c3ba7d906da1bfc">
      
      <pre><code class='language-html'>&lt;if test=&#34;memberbox:|:$this-&gt;memberData[&#39;member_id&#39;]&#34;&gt;
  &lt;!-- информация только для пользователей --&gt;
&lt;else /&gt;
  &lt;!-- информация только для гостей --&gt;
&lt;/if&gt;</code></pre>
    </div>
    <div class="flex-shrink-0">
      <ul class="list-inline mb-0">
        <li class="list-inline-item" data-bs-tooltip data-bs-title='Копировать'>
          <a class="text-body" href="#"
             data-fn="clipboard preventDefault" data-clipboard-target="#cp-1de450df43a53da34c3ba7d906da1bfc"
             role="button" aria-label='Копировать'>
            <i class="fas fa-copy fa-fw"></i>
          </a>
        </li>
      </ul>
    </div>
  </div>
</div>]]></turbo:content></item><item turbo="true"><title>Установка сертификата НУЦ Минцифры</title><link>https://lib.onl/ru/articles/2023/10/75075788-9308-56b7-b531-2008cb35f7d0/</link><pubDate>Fri, 06 Oct 2023 11:42:15 +0000</pubDate><dc:creator>Kai Kimera</dc:creator><category>Linux</category><category>MS Windows</category><category>Безопасность</category><yandex:related><link url="https://lib.onl/ru/articles/2022/05/36058650-3f35-5ed5-9565-0aa7d8800c28/">Windows Server 2022 для рабочей станции</link><link url="https://lib.onl/ru/articles/2021/08/ca744dce-e607-52e6-9952-8ae04e052a5b/">Скрипт автоматического удаления устаревших файлов</link></yandex:related><turbo:extendedHtml>true</turbo:extendedHtml><turbo:source>https://lib.onl/ru/articles/2023/10/75075788-9308-56b7-b531-2008cb35f7d0/</turbo:source><turbo:topic>Установка сертификата НУЦ Минцифры</turbo:topic><turbo:content><![CDATA[<p>Рассказываю о нескольких способах установки сертификатов от НУЦ Минцифры. Установка производится в ОС MS <span class="shortcode shortcode-tag"><a href="/ru/categories/windows/" target="_blank">#Windows</a></span> и <span class="shortcode shortcode-tag"><a href="/ru/tags/linux/" target="_blank">#Linux</a></span>.</p>
<h2 id="ms-windows">
  <a class="link-body-emphasis" href="#ms-windows">MS Windows</a>
</h2><h3 id="установка-корневого-сертификата">
  <a class="link-body-emphasis" href="#%d1%83%d1%81%d1%82%d0%b0%d0%bd%d0%be%d0%b2%d0%ba%d0%b0-%d0%ba%d0%be%d1%80%d0%bd%d0%b5%d0%b2%d0%be%d0%b3%d0%be-%d1%81%d0%b5%d1%80%d1%82%d0%b8%d1%84%d0%b8%d0%ba%d0%b0%d1%82%d0%b0">Установка корневого сертификата</a>
</h3><ul>
<li><a title="" href="https://gu-st.ru/content/Other/doc/russian_trusted_root_ca.cer" target="_blank" rel="noopener noreferrer">Скачать</a> корневой сертификат.</li>
<li>Открыть скаченный файл <code>russian_trusted_root_ca.cer</code> и нажать кнопку <span class="shortcode shortcode-key d-inline-block"><kbd>Установить сертификат...</kbd></span>.</li>
<li>В <strong>Мастере импорта сертификатов</strong> выбрать <em>Текущий пользователь</em>.
<ul>
<li>Выбрать <em>Поместить все сертификаты в следующее хранилище</em>.</li>
<li>Нажать <span class="shortcode shortcode-key d-inline-block"><kbd>Обзор</kbd></span> и выбрать <em>Доверенные корневые центры сертификации</em>.</li>
<li>В окне <strong>Завершение мастера импорта сертификатов</strong> нажать <span class="shortcode shortcode-key d-inline-block"><kbd>Готово</kbd></span>.</li>
</ul>
</li>
</ul>
<h3 id="установка-выпускающего-сертификата">
  <a class="link-body-emphasis" href="#%d1%83%d1%81%d1%82%d0%b0%d0%bd%d0%be%d0%b2%d0%ba%d0%b0-%d0%b2%d1%8b%d0%bf%d1%83%d1%81%d0%ba%d0%b0%d1%8e%d1%89%d0%b5%d0%b3%d0%be-%d1%81%d0%b5%d1%80%d1%82%d0%b8%d1%84%d0%b8%d0%ba%d0%b0%d1%82%d0%b0">Установка выпускающего сертификата</a>
</h3><ul>
<li><a title="" href="https://gu-st.ru/content/Other/doc/russian_trusted_sub_ca.cer" target="_blank" rel="noopener noreferrer">Скачать</a> выпускающий сертификат.</li>
<li>Открыть скаченный файл <code>russian_trusted_sub_ca.cer</code> и нажать кнопку <span class="shortcode shortcode-key d-inline-block"><kbd>Установить сертификат...</kbd></span>.</li>
<li>В <strong>Мастере импорта сертификатов</strong> выбрать <em>Текущий пользователь</em>.
<ul>
<li>Выбрать <em>Автоматически выбрать хранилище на основе типа сертификата</em>.</li>
<li>В окне <strong>Завершение мастера импорта сертификатов</strong> нажать <span class="shortcode shortcode-key d-inline-block"><kbd>Готово</kbd></span>.</li>
</ul>
</li>
</ul>
<h3 id="powershell">
  <a class="link-body-emphasis" href="#powershell">PowerShell</a>
</h3><p>При помощи <span class="shortcode shortcode-tag"><a href="/ru/tags/powershell/" target="_blank">#PowerShell</a></span> можно установить сертификат одной строчкой, состоящей из нескольких команд:</p>
<ul>
<li><code>Invoke-WebRequest</code> - скачивает файл с внешнего веб-ресурса.</li>
<li><code>Import-Certificate</code> - импортирует сертификат в указанное хранилище.</li>
<li><code>${DIR}</code> - переменная, определяющая директорию <code>Downloads</code> (<code>Загрузки</code>) для текущего пользователя.</li>
</ul>



<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-8 shortcode-codeblock-powershell">
  <div class="d-flex overflow-hidden">
    <div class="flex-grow-1 rounded overflow-hidden" id="cp-22a607a29f384b7dcf32952a4f5da3d7">
      
      <pre><code class='language-powershell'>${CERT_ROOT} = &#39;russian_trusted_root_ca.cer&#39;; ${CERT_SUB} = &#39;russian_trusted_sub_ca.cer&#39;; ${DIR} = (New-Object -ComObject Shell.Application).NameSpace(&#39;shell:Downloads&#39;).Self.Path; Invoke-WebRequest &#34;https://gu-st.ru/content/Other/doc/${CERT_ROOT}&#34; -OutFile &#34;${DIR}\${CERT_ROOT}&#34;; Import-Certificate -FilePath &#34;${DIR}\${CERT_ROOT}&#34; -CertStoreLocation &#39;Cert:\CurrentUser\Root&#39;; Invoke-WebRequest &#34;https://gu-st.ru/content/Other/doc/${CERT_SUB}&#34; -OutFile &#34;${DIR}\${CERT_SUB}&#34;; Import-Certificate -FilePath &#34;${DIR}\${CERT_SUB}&#34; -CertStoreLocation &#39;Cert:\CurrentUser\CA&#39;;</code></pre>
    </div>
    <div class="flex-shrink-0">
      <ul class="list-inline mb-0">
        <li class="list-inline-item" data-bs-tooltip data-bs-title='Копировать'>
          <a class="text-body" href="#"
             data-fn="clipboard preventDefault" data-clipboard-target="#cp-22a607a29f384b7dcf32952a4f5da3d7"
             role="button" aria-label='Копировать'>
            <i class="fas fa-copy fa-fw"></i>
          </a>
        </li>
      </ul>
    </div>
  </div>
</div>

<h2 id="linux">
  <a class="link-body-emphasis" href="#linux">Linux</a>
</h2><p>Для <span class="shortcode shortcode-tag"><a href="/ru/tags/linux/" target="_blank">#Linux</a></span> можно воспользоваться пакетом сертификатов в формате <code>.PEM</code> от <span class="shortcode shortcode-tag">MacOS</span>. Положительным моментом подобного пакета является то, что <span class="shortcode shortcode-tag">PEM</span> содержит в себе сразу два сертификата: корневой и выпускающий.</p>
<h3 id="установка-корневого-и-выпускающего-сертификатов">
  <a class="link-body-emphasis" href="#%d1%83%d1%81%d1%82%d0%b0%d0%bd%d0%be%d0%b2%d0%ba%d0%b0-%d0%ba%d0%be%d1%80%d0%bd%d0%b5%d0%b2%d0%be%d0%b3%d0%be-%d0%b8-%d0%b2%d1%8b%d0%bf%d1%83%d1%81%d0%ba%d0%b0%d1%8e%d1%89%d0%b5%d0%b3%d0%be-%d1%81%d0%b5%d1%80%d1%82%d0%b8%d1%84%d0%b8%d0%ba%d0%b0%d1%82%d0%be%d0%b2">Установка корневого и выпускающего сертификатов</a>
</h3><ul>
<li><a title="" href="https://gu-st.ru/content/Other/doc/russiantrustedca.pem" target="_blank" rel="noopener noreferrer">Скачать</a> файл с корневым и выпускающим сертификатами.</li>
<li>Добавить скаченный файл <code>russiantrustedca.pem</code> в хранилище доверенных сертификатов в зависимости от дистрибутива <span class="shortcode shortcode-tag"><a href="/ru/tags/linux/" target="_blank">#Linux</a></span>.
<ul>
<li>DEB-based: <code>/usr/local/share/ca-certificates/</code>.</li>
<li>RHEL-based: <code>/etc/pki/ca-trust/source/anchors/</code>.</li>
<li>Arch Linux: <code>/etc/ca-certificates/trust-source/anchors/</code>.</li>
</ul>
</li>
<li>Обновить хранилище сертификатов следующими командами.
<ul>
<li>DEB-based: <code>update-ca-certificates --fresh</code>.</li>
<li>RHEL-based: <code>update-ca-trust force-enable</code> и <code>update-ca-trust extract</code>.</li>
</ul>
</li>
</ul>
<h3 id="bash">
  <a class="link-body-emphasis" href="#bash">Bash</a>
</h3><p>Установить сертификат можно одной командой. Команды вводится от пользователя <code>root</code>. Как выше приводилось, для <span class="shortcode shortcode-tag"><a href="/ru/tags/deb/" target="_blank">#DEB</a></span>-based и <span class="shortcode shortcode-tag">RHEL</span>-based дистрибутивов, пути хранилища сертификатов различаются. Поэтому, я привожу две команды под каждые версии дистрибутивов.</p>
<h4 id="deb-based-дистрибутивы">
  <a class="link-body-emphasis" href="#deb-based-%d0%b4%d0%b8%d1%81%d1%82%d1%80%d0%b8%d0%b1%d1%83%d1%82%d0%b8%d0%b2%d1%8b">DEB-based дистрибутивы</a>
</h4>


<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-15 shortcode-codeblock-bash">
  <div class="d-flex overflow-hidden">
    <div class="flex-grow-1 rounded overflow-hidden" id="cp-6e6e1d370670bfab2d36421cdca781d5">
      
      <pre><code class='language-bash'>CERT=&#39;russiantrustedca.pem&#39;; curl -o &#34;/usr/local/share/ca-certificates/${CERT}&#34; &#34;https://gu-st.ru/content/Other/doc/${CERT}&#34; &amp;&amp; update-ca-certificates --fresh;</code></pre>
    </div>
    <div class="flex-shrink-0">
      <ul class="list-inline mb-0">
        <li class="list-inline-item" data-bs-tooltip data-bs-title='Копировать'>
          <a class="text-body" href="#"
             data-fn="clipboard preventDefault" data-clipboard-target="#cp-6e6e1d370670bfab2d36421cdca781d5"
             role="button" aria-label='Копировать'>
            <i class="fas fa-copy fa-fw"></i>
          </a>
        </li>
      </ul>
    </div>
  </div>
</div>

<h4 id="rhel-based-дистрибутивы">
  <a class="link-body-emphasis" href="#rhel-based-%d0%b4%d0%b8%d1%81%d1%82%d1%80%d0%b8%d0%b1%d1%83%d1%82%d0%b8%d0%b2%d1%8b">RHEL-based дистрибутивы</a>
</h4>


<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-16 shortcode-codeblock-bash">
  <div class="d-flex overflow-hidden">
    <div class="flex-grow-1 rounded overflow-hidden" id="cp-802f5a82673746d2c3e4b5351d615cd0">
      
      <pre><code class='language-bash'>CERT=&#39;russiantrustedca.pem&#39;; curl -o &#34;/etc/pki/ca-trust/source/anchors/${CERT}&#34; &#34;https://gu-st.ru/content/Other/doc/${CERT}&#34; &amp;&amp; update-ca-trust force-enable &amp;&amp; update-ca-trust extract;</code></pre>
    </div>
    <div class="flex-shrink-0">
      <ul class="list-inline mb-0">
        <li class="list-inline-item" data-bs-tooltip data-bs-title='Копировать'>
          <a class="text-body" href="#"
             data-fn="clipboard preventDefault" data-clipboard-target="#cp-802f5a82673746d2c3e4b5351d615cd0"
             role="button" aria-label='Копировать'>
            <i class="fas fa-copy fa-fw"></i>
          </a>
        </li>
      </ul>
    </div>
  </div>
</div>]]></turbo:content></item><item turbo="true"><title>Получение и установка MS Office 2021 LTSC</title><link>https://lib.onl/ru/articles/2023/09/dd5a3e1a-596b-50d5-b070-b2a065f99f32/</link><pubDate>Tue, 26 Sep 2023 17:17:18 +0000</pubDate><dc:creator>Kai Kimera</dc:creator><category>MS Windows</category><category>Скрипты</category><yandex:related><link url="https://lib.onl/ru/articles/2022/05/862226e6-cbb1-58f8-bc8e-0cfef747f475/">Интеграция обновлений в дистрибутив ОС MS Windows</link></yandex:related><turbo:extendedHtml>true</turbo:extendedHtml><turbo:source>https://lib.onl/ru/articles/2023/09/dd5a3e1a-596b-50d5-b070-b2a065f99f32/</turbo:source><turbo:topic>Получение и установка MS Office 2021 LTSC</turbo:topic><turbo:content><![CDATA[<p>MS Office является самым популярным набором приложений для офисной работы. На момент написания этой статьи, актуальной версией MS <span class="shortcode shortcode-tag"><a href="/ru/tags/office/" target="_blank">#Office</a></span> является 2021. Её можно купить в магазине. Но здесь я расскажу как получить актуальную версию MS <span class="shortcode shortcode-tag"><a href="/ru/tags/office/" target="_blank">#Office</a></span> 2021 LTSC с серверов Microsoft.</p>
<p>MS <span class="shortcode shortcode-tag"><a href="/ru/tags/office/" target="_blank">#Office</a></span> 2021 LTSC просто так не купить, это программное обеспечение распространяется для организаций по соглашению о корпоративном лицензировании. MS Office 2021 LTSC поддерживает устройства только с операционными системами MS <span class="shortcode shortcode-tag"><a href="/ru/categories/windows/" target="_blank">#Windows</a></span> 10 или MS <span class="shortcode shortcode-tag"><a href="/ru/categories/windows/" target="_blank">#Windows</a></span> 11.</p>
<h2 id="получение-ms-office-2021-ltsc">
  <a class="link-body-emphasis" href="#%d0%bf%d0%be%d0%bb%d1%83%d1%87%d0%b5%d0%bd%d0%b8%d0%b5-ms-office-2021-ltsc">Получение MS Office 2021 LTSC</a>
</h2><p>Для получения установочного дистрибутива необходимо выполнить подготовительные шаги:</p>
<ol>
<li>Скачать и запустить <a title="" href="https://www.microsoft.com/download/details.aspx?id=49117" target="_blank" rel="noopener noreferrer">Office Deployment Tool</a>.</li>
<li>Во время установки, выбрать директорию для распаковки <strong>Office Deployment Tool</strong>. В эту директорию будет в дальнейшем загружен установочный дистрибутив MS Office 2021 LTSC.</li>
<li>После завершения процесса установки, открыть консоль и перейти в директорию (<code>cd &lt;path&gt;</code>), куда был установлен Office Deployment Tool.</li>
<li>В корне директории Office Deployment Tool создать файл <code>office.2021.xml</code> следующего содержания:</li>
</ol>

    

    
        
            
            <div class="shortcode shortcode-file mb-3">
              <div class="card overflow-hidden">
                <div class="card-header">
                  <div class="d-flex align-items-center">
                    <div class="flex-shrink-0">
                      <i class="far fa-file-code fa-fw"></i>
                    </div>
                    <div class="flex-grow-1 mx-2 text-truncate">
                      <code>office.2021.xml</code>
                    </div>
                    <div class="flex-shrink-0">
                      <ul class="list-inline mb-0">
                        <li class="list-inline-item" data-bs-tooltip data-bs-title='Копировать'>
                          <a class="text-body" href="#"
                             data-fn="clipboard preventDefault" data-clipboard-target="#cp-f6935bdb4c434264b369c6afd0eb82d1"
                             role="button" aria-label='Копировать'>
                            <i class="fas fa-copy fa-fw"></i>
                          </a>
                        </li>
                        <li class="list-inline-item" data-bs-tooltip data-bs-title='Скачать'>
                          <a class="text-body" href="/ru/articles/2023/09/dd5a3e1a-596b-50d5-b070-b2a065f99f32/office.2021.xml" download
                             role="button" aria-label='Скачать'>
                            <i class="fas fa-download fa-fw"></i>
                          </a>
                        </li>
                        <li class="list-inline-item" data-bs-tooltip data-bs-title='Открыть'>
                          <a class="text-body" href="/ru/articles/2023/09/dd5a3e1a-596b-50d5-b070-b2a065f99f32/office.2021.xml" target="_blank"
                             role="button" aria-label='Открыть'>
                            <i class="fas fa-arrow-up-right-from-square fa-fw"></i>
                          </a>
                        </li>
                      </ul>
                    </div>
                  </div>
                </div>
                <div class="card-body" id="cp-f6935bdb4c434264b369c6afd0eb82d1">
                    
                        
                    
                  <pre><code class="language-xml">&lt;Configuration ID=&#34;42865718-c416-4c72-990b-20b6972cb9af&#34;&gt;
  &lt;Add OfficeClientEdition=&#34;64&#34; Channel=&#34;PerpetualVL2021&#34;&gt;
    &lt;Product ID=&#34;ProPlus2021Volume&#34; PIDKEY=&#34;FXYTK-NJJ8C-GB6DW-3DYQT-6F7TH&#34;&gt;
      &lt;Language ID=&#34;en-us&#34; /&gt;
      &lt;Language ID=&#34;ru-ru&#34; /&gt;
    &lt;/Product&gt;
    &lt;Product ID=&#34;VisioPro2021Volume&#34; PIDKEY=&#34;KNH8D-FGHT4-T8RK3-CTDYJ-K2HT4&#34;&gt;
      &lt;Language ID=&#34;en-us&#34; /&gt;
      &lt;Language ID=&#34;ru-ru&#34; /&gt;
    &lt;/Product&gt;
    &lt;Product ID=&#34;ProjectPro2021Volume&#34; PIDKEY=&#34;FTNWT-C6WBT-8HMGF-K9PRX-QV9H8&#34;&gt;
      &lt;Language ID=&#34;en-us&#34; /&gt;
      &lt;Language ID=&#34;ru-ru&#34; /&gt;
    &lt;/Product&gt;
    &lt;Product ID=&#34;LanguagePack&#34;&gt;
      &lt;Language ID=&#34;en-us&#34; /&gt;
      &lt;Language ID=&#34;ru-ru&#34; /&gt;
    &lt;/Product&gt;
    &lt;Product ID=&#34;ProofingTools&#34;&gt;
      &lt;Language ID=&#34;en-us&#34; /&gt;
      &lt;Language ID=&#34;ru-ru&#34; /&gt;
    &lt;/Product&gt;
  &lt;/Add&gt;
  &lt;Property Name=&#34;SharedComputerLicensing&#34; Value=&#34;0&#34; /&gt;
  &lt;Property Name=&#34;FORCEAPPSHUTDOWN&#34; Value=&#34;FALSE&#34; /&gt;
  &lt;Property Name=&#34;DeviceBasedLicensing&#34; Value=&#34;0&#34; /&gt;
  &lt;Property Name=&#34;SCLCacheOverride&#34; Value=&#34;0&#34; /&gt;
  &lt;Property Name=&#34;AUTOACTIVATE&#34; Value=&#34;1&#34; /&gt;
  &lt;Updates Enabled=&#34;TRUE&#34; /&gt;
  &lt;RemoveMSI /&gt;
&lt;/Configuration&gt;</code></pre>
                </div>
              </div>
            </div>
        
    
<p>Далее, в консоли выполните команду <code>setup.exe /download office.2021.xml</code>. Команда запускает формирование и скачивание установочного дистрибутива MS Office 2021 LTCS с серверов Microsoft. Команда может не отображать процесс своей работы. После завершения команды, консоль вернёт управление пользователю, тем самым можно контролировать завершение получения установочного дистрибутива.</p>
<h2 id="установка-полной-версии-ms-office-2021-ltsc">
  <a class="link-body-emphasis" href="#%d1%83%d1%81%d1%82%d0%b0%d0%bd%d0%be%d0%b2%d0%ba%d0%b0-%d0%bf%d0%be%d0%bb%d0%bd%d0%be%d0%b9-%d0%b2%d0%b5%d1%80%d1%81%d0%b8%d0%b8-ms-office-2021-ltsc">Установка полной версии MS Office 2021 LTSC</a>
</h2><p>После получения установочного дистрибутива MS Office 2021 LTCS, в той же консоли необходимо выполнить команду <code>setup.exe /configure office.2021.xml</code>. Эта команда запускает процесс установки <strong>полной версии</strong> MS Office 2021 LTCS на компьютер пользователя со всеми дополнительными модулями.</p>
<h2 id="установка-минимальной-версии-ms-office-2021-ltsc">
  <a class="link-body-emphasis" href="#%d1%83%d1%81%d1%82%d0%b0%d0%bd%d0%be%d0%b2%d0%ba%d0%b0-%d0%bc%d0%b8%d0%bd%d0%b8%d0%bc%d0%b0%d0%bb%d1%8c%d0%bd%d0%be%d0%b9-%d0%b2%d0%b5%d1%80%d1%81%d0%b8%d0%b8-ms-office-2021-ltsc">Установка минимальной версии MS Office 2021 LTSC</a>
</h2><p>Для администраторов, которые хотят установить на компьютер пользователя только самые необходимые компоненты (<span class="shortcode shortcode-tag">Access</span>, <span class="shortcode shortcode-tag">Excel</span>, <span class="shortcode shortcode-tag">Outlook</span>, <span class="shortcode shortcode-tag">PowerPoint</span> и <span class="shortcode shortcode-tag">World</span>), предлагаю следующий конфигурационный файл:</p>

    

    
        
            
            <div class="shortcode shortcode-file mb-3">
              <div class="card overflow-hidden">
                <div class="card-header">
                  <div class="d-flex align-items-center">
                    <div class="flex-shrink-0">
                      <i class="far fa-file-code fa-fw"></i>
                    </div>
                    <div class="flex-grow-1 mx-2 text-truncate">
                      <code>office.2021.minimal.xml</code>
                    </div>
                    <div class="flex-shrink-0">
                      <ul class="list-inline mb-0">
                        <li class="list-inline-item" data-bs-tooltip data-bs-title='Копировать'>
                          <a class="text-body" href="#"
                             data-fn="clipboard preventDefault" data-clipboard-target="#cp-e5d8e9f136c44e77c31b2437e272aff7"
                             role="button" aria-label='Копировать'>
                            <i class="fas fa-copy fa-fw"></i>
                          </a>
                        </li>
                        <li class="list-inline-item" data-bs-tooltip data-bs-title='Скачать'>
                          <a class="text-body" href="/ru/articles/2023/09/dd5a3e1a-596b-50d5-b070-b2a065f99f32/office.2021.minimal.xml" download
                             role="button" aria-label='Скачать'>
                            <i class="fas fa-download fa-fw"></i>
                          </a>
                        </li>
                        <li class="list-inline-item" data-bs-tooltip data-bs-title='Открыть'>
                          <a class="text-body" href="/ru/articles/2023/09/dd5a3e1a-596b-50d5-b070-b2a065f99f32/office.2021.minimal.xml" target="_blank"
                             role="button" aria-label='Открыть'>
                            <i class="fas fa-arrow-up-right-from-square fa-fw"></i>
                          </a>
                        </li>
                      </ul>
                    </div>
                  </div>
                </div>
                <div class="card-body" id="cp-e5d8e9f136c44e77c31b2437e272aff7">
                    
                        
                    
                  <pre><code class="language-xml">&lt;Configuration ID=&#34;42865718-c416-4c72-990b-20b6972cb9af&#34;&gt;
  &lt;Add OfficeClientEdition=&#34;64&#34; Channel=&#34;PerpetualVL2021&#34;&gt;
    &lt;Product ID=&#34;ProPlus2021Volume&#34; PIDKEY=&#34;FXYTK-NJJ8C-GB6DW-3DYQT-6F7TH&#34;&gt;
      &lt;Language ID=&#34;en-us&#34; /&gt;
      &lt;Language ID=&#34;ru-ru&#34; /&gt;
      &lt;ExcludeApp ID=&#34;Lync&#34; /&gt;
      &lt;ExcludeApp ID=&#34;OneDrive&#34; /&gt;
      &lt;ExcludeApp ID=&#34;OneNote&#34; /&gt;
      &lt;ExcludeApp ID=&#34;Publisher&#34; /&gt;
      &lt;ExcludeApp ID=&#34;Teams&#34; /&gt;
    &lt;/Product&gt;
    &lt;Product ID=&#34;LanguagePack&#34;&gt;
      &lt;Language ID=&#34;en-us&#34; /&gt;
      &lt;Language ID=&#34;ru-ru&#34; /&gt;
    &lt;/Product&gt;
    &lt;Product ID=&#34;ProofingTools&#34;&gt;
      &lt;Language ID=&#34;en-us&#34; /&gt;
      &lt;Language ID=&#34;ru-ru&#34; /&gt;
    &lt;/Product&gt;
  &lt;/Add&gt;
  &lt;Property Name=&#34;SharedComputerLicensing&#34; Value=&#34;0&#34; /&gt;
  &lt;Property Name=&#34;FORCEAPPSHUTDOWN&#34; Value=&#34;FALSE&#34; /&gt;
  &lt;Property Name=&#34;DeviceBasedLicensing&#34; Value=&#34;0&#34; /&gt;
  &lt;Property Name=&#34;SCLCacheOverride&#34; Value=&#34;0&#34; /&gt;
  &lt;Property Name=&#34;AUTOACTIVATE&#34; Value=&#34;1&#34; /&gt;
  &lt;Updates Enabled=&#34;TRUE&#34; /&gt;
  &lt;RemoveMSI /&gt;
&lt;/Configuration&gt;</code></pre>
                </div>
              </div>
            </div>
        
    
<p>Сохраните его под названием <code>office.2021.minimal.xml</code> и запустите процесс установки при помощи команды <code>setup.exe /configure office.2021.minimal.xml</code>.</p>
<h2 id="создание-собственных-конфигураций">
  <a class="link-body-emphasis" href="#%d1%81%d0%be%d0%b7%d0%b4%d0%b0%d0%bd%d0%b8%d0%b5-%d1%81%d0%be%d0%b1%d1%81%d1%82%d0%b2%d0%b5%d0%bd%d0%bd%d1%8b%d1%85-%d0%ba%d0%be%d0%bd%d1%84%d0%b8%d0%b3%d1%83%d1%80%d0%b0%d1%86%d0%b8%d0%b9">Создание собственных конфигураций</a>
</h2><p>Приведённые выше XML-файлы это файлы конфигураций. Их можно создавать самому при помощи веб-инструмента <a title="" href="https://config.office.com/deploymentsettings" target="_blank" rel="noopener noreferrer">Office Deployment Center</a>. На странице создания конфигураций укажите необходимые параметры и настройки, и нажмите кнопку <span class="shortcode shortcode-key d-inline-block"><kbd>Импорт</kbd></span>.</p>
<p>Полученный XML-файл можно указывать в командах <code>setup.exe /download &lt;XML_FILE&gt;</code> и <code>setup.exe /configure &lt;XML_FILE&gt;</code> для конфигурирования установочного дистрибутива.</p>
<h2 id="активация-при-помощи-kms-сервера">
  <a class="link-body-emphasis" href="#%d0%b0%d0%ba%d1%82%d0%b8%d0%b2%d0%b0%d1%86%d0%b8%d1%8f-%d0%bf%d1%80%d0%b8-%d0%bf%d0%be%d0%bc%d0%be%d1%89%d0%b8-kms-%d1%81%d0%b5%d1%80%d0%b2%d0%b5%d1%80%d0%b0">Активация при помощи KMS-сервера</a>
</h2><p>Если в сети вашей организации присутствует KMS-сервер, установленный MS Office 2021 можно активировать при помощи этого сервера.</p>




    










    
    




<div class="shortcode shortcode-alert">
  <div class="alert alert-success d-flex overflow-hidden" role="alert">
    <div class="flex-shrink-0 align-self-center">
      <i class="fas fa-lightbulb fa-fw fa-2x"></i>
    </div>
    <div class="flex-grow-1 ms-3 overflow-hidden">
        <p>Подобным способом активируются следующие версии MS Office:</p>
<ul>
<li>Microsoft Office 2016 Volume License Pack.</li>
<li>Microsoft Office 2019 Volume License Pack.</li>
<li>Microsoft Office LTSC 2021 Volume License Pack.</li>
</ul>

    </div>
  </div>
</div>

<p>Для активации MS Office при помощи KMS-сервера, необходимо открыть консоль и перейти в директорию с файлом <code>ospp.vbs</code>. Обычно, этот файл находится в директории <code>\Program Files\Microsoft Office\Office16</code>. После того, как консоль будет находится в необходимой директории с файлом <code>ospp.vbs</code>, можно выполнять следующие команды в зависимости от задачи.</p>
<ol>
<li>Указать адрес KMS-сервера для клиента MS Office:</li>
</ol>



<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-14 shortcode-codeblock-powershell">
  <div class="d-flex overflow-hidden">
    <div class="flex-grow-1 rounded overflow-hidden" id="cp-959d8444f4406ab02acaf6103251f7b4">
      
      <pre><code class='language-powershell'>cscript ospp.vbs /sethst:kms.example.com</code></pre>
    </div>
    <div class="flex-shrink-0">
      <ul class="list-inline mb-0">
        <li class="list-inline-item" data-bs-tooltip data-bs-title='Копировать'>
          <a class="text-body" href="#"
             data-fn="clipboard preventDefault" data-clipboard-target="#cp-959d8444f4406ab02acaf6103251f7b4"
             role="button" aria-label='Копировать'>
            <i class="fas fa-copy fa-fw"></i>
          </a>
        </li>
      </ul>
    </div>
  </div>
</div>

<ol start="2">
<li>Указать нестандартный порт (<code>1689</code>) KMS-сервера:</li>
</ol>



<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-15 shortcode-codeblock-powershell">
  <div class="d-flex overflow-hidden">
    <div class="flex-grow-1 rounded overflow-hidden" id="cp-fa23588b61405645478bc48f44d62eee">
      
      <pre><code class='language-powershell'>cscript ospp.vbs /setprt:1689</code></pre>
    </div>
    <div class="flex-shrink-0">
      <ul class="list-inline mb-0">
        <li class="list-inline-item" data-bs-tooltip data-bs-title='Копировать'>
          <a class="text-body" href="#"
             data-fn="clipboard preventDefault" data-clipboard-target="#cp-fa23588b61405645478bc48f44d62eee"
             role="button" aria-label='Копировать'>
            <i class="fas fa-copy fa-fw"></i>
          </a>
        </li>
      </ul>
    </div>
  </div>
</div>

<ol start="3">
<li>Выполнить активацию MS Office на KMS-сервере:</li>
</ol>



<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-16 shortcode-codeblock-powershell">
  <div class="d-flex overflow-hidden">
    <div class="flex-grow-1 rounded overflow-hidden" id="cp-5b3acf806e8b91a9cb30012542b3a3ae">
      
      <pre><code class='language-powershell'>cscript ospp.vbs /act</code></pre>
    </div>
    <div class="flex-shrink-0">
      <ul class="list-inline mb-0">
        <li class="list-inline-item" data-bs-tooltip data-bs-title='Копировать'>
          <a class="text-body" href="#"
             data-fn="clipboard preventDefault" data-clipboard-target="#cp-5b3acf806e8b91a9cb30012542b3a3ae"
             role="button" aria-label='Копировать'>
            <i class="fas fa-copy fa-fw"></i>
          </a>
        </li>
      </ul>
    </div>
  </div>
</div>

<ol start="4">
<li>Узнать текущий статус активации MS Office:</li>
</ol>



<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-17 shortcode-codeblock-powershell">
  <div class="d-flex overflow-hidden">
    <div class="flex-grow-1 rounded overflow-hidden" id="cp-bc40606ec409f5fecc6e62f45127356f">
      
      <pre><code class='language-powershell'>cscript ospp.vbs /dstatusall</code></pre>
    </div>
    <div class="flex-shrink-0">
      <ul class="list-inline mb-0">
        <li class="list-inline-item" data-bs-tooltip data-bs-title='Копировать'>
          <a class="text-body" href="#"
             data-fn="clipboard preventDefault" data-clipboard-target="#cp-bc40606ec409f5fecc6e62f45127356f"
             role="button" aria-label='Копировать'>
            <i class="fas fa-copy fa-fw"></i>
          </a>
        </li>
      </ul>
    </div>
  </div>
</div>

<p>В интернете можно найти открытые KMS-серверы для нелегальной активации MS Office. Но подобные действия имеют противоправный характер. <span class="shortcode shortcode-emoji">😜</span></p>]]></turbo:content></item><item turbo="true"><title>Включение DNS over TLS (DoT) в OPNsense</title><link>https://lib.onl/ru/articles/2022/08/badb30a9-0471-5dab-a422-85422c0ac611/</link><pubDate>Sun, 14 Aug 2022 18:16:34 +0000</pubDate><dc:creator>Kai Kimera</dc:creator><category>Сеть</category><turbo:extendedHtml>true</turbo:extendedHtml><turbo:source>https://lib.onl/ru/articles/2022/08/badb30a9-0471-5dab-a422-85422c0ac611/</turbo:source><turbo:topic>Включение DNS over TLS (DoT) в OPNsense</turbo:topic><turbo:content><![CDATA[<p>Почитав несколько статей на тему <span class="shortcode shortcode-tag"><a href="/ru/tags/dot/" target="_blank">#DoT</a></span>, я решил написать небольшую заметку по настройки <span class="shortcode shortcode-tag"><a href="/ru/tags/opnsense/" target="_blank">#OPNsense</a></span> на использование этого протокола.</p>
<p><strong>DNS поверх TLS</strong> или <span class="shortcode shortcode-tag"><a href="/ru/tags/dot/" target="_blank">#DoT</a></span> это протокол, при помощи которого происходит шифрование запросов и ответов к <span class="shortcode shortcode-tag"><a href="/ru/tags/dns/" target="_blank">#DNS</a></span> через <span class="shortcode shortcode-tag">TLS</span>. Таким образом, повышается конфиденциальность и безопасность пользователей в интернете.</p>
<p>Не все публичные сервера поддерживают <span class="shortcode shortcode-tag"><a href="/ru/tags/dot/" target="_blank">#DoT</a></span>. Список наиболее предпочтительных, по моему мнению, я приведу в таблице в конце статьи. А теперь, по пунктам, я расскажу как правильно настроить <span class="shortcode shortcode-tag"><a href="/ru/tags/opnsense/" target="_blank">#OPNsense</a></span>, чтобы она задействовала протокол <span class="shortcode shortcode-tag"><a href="/ru/tags/dot/" target="_blank">#DoT</a></span> в своей работе. Для этого нужно выполнить всего несколько шагов&hellip;</p>
<h2 id="настройка-opnsense">
  <a class="link-body-emphasis" href="#%d0%bd%d0%b0%d1%81%d1%82%d1%80%d0%be%d0%b9%d0%ba%d0%b0-opnsense">Настройка OPNsense</a>
</h2><ul>
<li>System / Settings / General
<ul>
<li>Удалить все записи о DNS, если они имеются.</li>
<li>Отключить параметр <strong>Allow DNS server list to be overridden by DHCP/PPP on WAN</strong>.</li>
<li>Отключить параметр <strong>Do not use the local DNS service as a nameserver for this system</strong>.</li>
</ul>
</li>
<li>Services / Unbound DNS / General
<ul>
<li>Включить сервис, поставив галочку напротив <strong>Enable</strong>.</li>
<li>Выбрать в параметре <strong>Network Interfaces</strong> пункт локальной сети, в данном случае, <em>LAN</em>.</li>
<li>Включить <strong>DNSSEC</strong>, поставив галочку напротив парамера <strong>Enable DNSSEC Support</strong>.</li>
<li>Остальные параметры можно не трогать.</li>
</ul>
</li>
<li>Services / Unbound DNS / DNS over TLS
<ul>
<li>Добавить публичные сервера DNS из списка ниже.</li>
</ul>
</li>
</ul>
<h2 id="публичные-сервера-dns">
  <a class="link-body-emphasis" href="#%d0%bf%d1%83%d0%b1%d0%bb%d0%b8%d1%87%d0%bd%d1%8b%d0%b5-%d1%81%d0%b5%d1%80%d0%b2%d0%b5%d1%80%d0%b0-dns">Публичные сервера DNS</a>
</h2><p>Ниже я привожу список публичных серверов <span class="shortcode shortcode-tag"><a href="/ru/tags/dns/" target="_blank">#DNS</a></span>, которые поддерживают функцию DNS over TLS (<span class="shortcode shortcode-tag"><a href="/ru/tags/dot/" target="_blank">#DoT</a></span>).</p>
<h3 id="cloudflare">
  <a class="link-body-emphasis" href="#cloudflare">Cloudflare</a>
</h3>




<table class='table table-striped table-bordered table-responsive w-50'>
<thead>
<tr>
<th>Server IP</th>
<th>Server Port</th>
<th>Verify CN</th>
</tr>
</thead>
<tbody>
<tr>
<td>1.1.1.1</td>
<td>853</td>
<td>cloudflare-dns.com</td>
</tr>
<tr>
<td>1.0.0.1</td>
<td>853</td>
<td>cloudflare-dns.com</td>
</tr>
<tr>
<td>2606:4700:4700::1111</td>
<td>853</td>
<td>cloudflare-dns.com</td>
</tr>
<tr>
<td>2606:4700:4700::1001</td>
<td>853</td>
<td>cloudflare-dns.com</td>
</tr>
</tbody>
</table>


<h3 id="google">
  <a class="link-body-emphasis" href="#google">Google</a>
</h3>




<table class='table table-striped table-bordered table-responsive w-50'>
<thead>
<tr>
<th>Server IP</th>
<th>Server Port</th>
<th>Verify CN</th>
</tr>
</thead>
<tbody>
<tr>
<td>8.8.8.8</td>
<td>853</td>
<td>dns.google</td>
</tr>
<tr>
<td>8.8.4.4</td>
<td>853</td>
<td>dns.google</td>
</tr>
<tr>
<td>2001:4860:4860::8888</td>
<td>853</td>
<td>dns.google</td>
</tr>
<tr>
<td>2001:4860:4860::8844</td>
<td>853</td>
<td>dns.google</td>
</tr>
</tbody>
</table>


<h3 id="quad9">
  <a class="link-body-emphasis" href="#quad9">Quad9</a>
</h3>




<table class='table table-striped table-bordered table-responsive w-50'>
<thead>
<tr>
<th>Server IP</th>
<th>Server Port</th>
<th>Verify CN</th>
</tr>
</thead>
<tbody>
<tr>
<td>9.9.9.9</td>
<td>853</td>
<td>dns.quad9.net</td>
</tr>
<tr>
<td>149.112.112.112</td>
<td>853</td>
<td>dns.quad9.net</td>
</tr>
<tr>
<td>2620:fe::fe</td>
<td>853</td>
<td>dns.quad9.net</td>
</tr>
<tr>
<td>2620:fe::9</td>
<td>853</td>
<td>dns.quad9.net</td>
</tr>
</tbody>
</table>


<h3 id="cisco-umbrella">
  <a class="link-body-emphasis" href="#cisco-umbrella">Cisco Umbrella</a>
</h3>




<table class='table table-striped table-bordered table-responsive w-50'>
<thead>
<tr>
<th>Server IP</th>
<th>Server Port</th>
<th>Verify CN</th>
</tr>
</thead>
<tbody>
<tr>
<td>208.67.222.222</td>
<td>853</td>
<td>dns.opendns.com</td>
</tr>
<tr>
<td>208.67.220.220</td>
<td>853</td>
<td>dns.opendns.com</td>
</tr>
<tr>
<td>2620:119:35::35</td>
<td>853</td>
<td>dns.opendns.com</td>
</tr>
<tr>
<td>2620:119:53::53</td>
<td>853</td>
<td>dns.opendns.com</td>
</tr>
</tbody>
</table>


<h3 id="cleanbrowsing">
  <a class="link-body-emphasis" href="#cleanbrowsing">CleanBrowsing</a>
</h3>




<table class='table table-striped table-bordered table-responsive w-50'>
<thead>
<tr>
<th>Server IP</th>
<th>Server Port</th>
<th>Verify CN</th>
</tr>
</thead>
<tbody>
<tr>
<td>185.228.168.9</td>
<td>853</td>
<td>security-filter-dns.cleanbrowsing.org</td>
</tr>
<tr>
<td>185.228.169.9</td>
<td>853</td>
<td>security-filter-dns.cleanbrowsing.org</td>
</tr>
<tr>
<td>2a0d:2a00:1::2</td>
<td>853</td>
<td>security-filter-dns.cleanbrowsing.org</td>
</tr>
<tr>
<td>2a0d:2a00:2::2</td>
<td>853</td>
<td>security-filter-dns.cleanbrowsing.org</td>
</tr>
</tbody>
</table>


<h3 id="adguard-dns">
  <a class="link-body-emphasis" href="#adguard-dns">AdGuard DNS</a>
</h3>




<table class='table table-striped table-bordered table-responsive w-50'>
<thead>
<tr>
<th>Server IP</th>
<th>Server Port</th>
<th>Verify CN</th>
</tr>
</thead>
<tbody>
<tr>
<td>94.140.14.14</td>
<td>853</td>
<td>dns.adguard-dns.com</td>
</tr>
<tr>
<td>94.140.15.15</td>
<td>853</td>
<td>dns.adguard-dns.com</td>
</tr>
<tr>
<td>2a10:50c0::ad1:ff</td>
<td>853</td>
<td>dns.adguard-dns.com</td>
</tr>
<tr>
<td>2a10:50c0::ad2:ff</td>
<td>853</td>
<td>dns.adguard-dns.com</td>
</tr>
</tbody>
</table>]]></turbo:content></item><item turbo="true"><title>Интеграция обновлений в дистрибутив ОС MS Windows</title><link>https://lib.onl/ru/articles/2022/05/862226e6-cbb1-58f8-bc8e-0cfef747f475/</link><pubDate>Mon, 09 May 2022 12:39:47 +0000</pubDate><dc:creator>Kai Kimera</dc:creator><category>MS Windows</category><category>Терминал</category><category>Скрипты</category><turbo:extendedHtml>true</turbo:extendedHtml><turbo:source>https://lib.onl/ru/articles/2022/05/862226e6-cbb1-58f8-bc8e-0cfef747f475/</turbo:source><turbo:topic>Интеграция обновлений в дистрибутив ОС MS Windows</turbo:topic><turbo:content><![CDATA[<p>Microsoft каждый месяц выпускает новые версии дистрибутивов с уже интегрированными обновлениями. Но есть редакции ОС, например <span class="shortcode shortcode-tag">LTSC</span>, для которых Microsoft не выполняет подобные действия. Приходится делать самому&hellip;</p>
<h2 id="подготовка">
  <a class="link-body-emphasis" href="#%d0%bf%d0%be%d0%b4%d0%b3%d0%be%d1%82%d0%be%d0%b2%d0%ba%d0%b0">Подготовка</a>
</h2><p>Для интеграции обновлений в дистрибутив ОС, потребуется:</p>
<ul>
<li>Дистрибутив операционной системы в файле <code>.iso</code>.</li>
<li>Доступ в интернет для скачивания необходимых инструментов и обновлений.</li>
<li>Рекомендуется <span class="shortcode shortcode-tag"><a href="/ru/tags/ssd/" target="_blank">#SSD</a></span>. Все ниже приведённые этапы требуют активной работы с файлами. Поэтому, существенное ускорение можно получить выполняя все задачи на <span class="shortcode shortcode-tag"><a href="/ru/tags/ssd/" target="_blank">#SSD</a></span>.</li>
</ul>
<h3 id="структура-директорий">
  <a class="link-body-emphasis" href="#%d1%81%d1%82%d1%80%d1%83%d0%ba%d1%82%d1%83%d1%80%d0%b0-%d0%b4%d0%b8%d1%80%d0%b5%d0%ba%d1%82%d0%be%d1%80%d0%b8%d0%b9">Структура директорий</a>
</h3><p>Для начала необходимо создать структуру директорий, которая послужит базисом для процесса интеграции обновлений:</p>
<ul>
<li><code>C:\BuildFarm</code> - корневая директория для работы.
<ul>
<li><code>\MNT</code> - директория, в которую будет монтироваться образ WIM.</li>
<li><code>\UPD</code> - директория для хранения скаченных обновлений.</li>
<li><code>\WIM</code> - директория для хранения образа WIM.</li>
</ul>
</li>
</ul>
<h3 id="ms-dism">
  <a class="link-body-emphasis" href="#ms-dism">MS DISM</a>
</h3><p>Для интеграции обновлений потребуется инструмент <strong>Deployment Image Servicing and Management (DISM)</strong> (<code>DISM.exe</code>), который входит в комплект <a title="" href="https://learn.microsoft.com/en-us/windows-hardware/get-started/adk-install" target="_blank" rel="noopener noreferrer">Windows Assessment and Deployment Kit (Windows ADK)</a>. Обычно, DISM уже поставляется с операционной системой, но я рекомендую <a title="" href="https://learn.microsoft.com/en-us/windows-hardware/get-started/adk-install#other-adk-downloads" target="_blank" rel="noopener noreferrer">скачивать</a> последнюю версию с сайта Microsoft и устанавливать вручную.</p>
<p>Когда Windows ADK установлен, <span class="shortcode shortcode-tag"><a href="/ru/tags/dism/" target="_blank">#DISM</a></span> можно найти в меню <strong>&ldquo;Пуск&rdquo;</strong> вместе с остальными программам. Запускать <span class="shortcode shortcode-tag"><a href="/ru/tags/dism/" target="_blank">#DISM</a></span> необходимо под администратором. Все команды, приведённые ниже, должны будут выполняться только через установленный вручную <span class="shortcode shortcode-tag"><a href="/ru/tags/dism/" target="_blank">#DISM</a></span>. Использовать <span class="shortcode shortcode-tag"><a href="/ru/tags/dism/" target="_blank">#DISM</a></span>, поставляемый с операционной системой нет необходимости.</p>




    










    
    




<div class="shortcode shortcode-alert">
  <div class="alert alert-success d-flex overflow-hidden" role="alert">
    <div class="flex-shrink-0 align-self-center">
      <i class="fas fa-lightbulb fa-fw fa-2x"></i>
    </div>
    <div class="flex-grow-1 ms-3 overflow-hidden">
        <p>Установленный вручную <!-- raw HTML omitted --><!-- raw HTML omitted -->#DISM<!-- raw HTML omitted --><!-- raw HTML omitted --> можно найти в меню &ldquo;Пуск&rdquo; / Windows Kits / <strong>Среда средств развертывания и работы с образами</strong>.</p>

    </div>
  </div>
</div>

<h2 id="интеграция-обновлений">
  <a class="link-body-emphasis" href="#%d0%b8%d0%bd%d1%82%d0%b5%d0%b3%d1%80%d0%b0%d1%86%d0%b8%d1%8f-%d0%be%d0%b1%d0%bd%d0%be%d0%b2%d0%bb%d0%b5%d0%bd%d0%b8%d0%b9">Интеграция обновлений</a>
</h2><p>Обновления можно скачивать с сайта-каталога <a title="" href="https://www.catalog.update.microsoft.com/" target="_blank" rel="noopener noreferrer">Microsoft Update Catalog</a>. Я беру так называемые &ldquo;кумулятивные (накопительные) обновления&rdquo; (cumulative updates), содержащие в себе сразу множество пакетов с исправлениями и обновлениями функций. <a title="" href="https://www.catalog.update.microsoft.com/Search.aspx?q=cumulative%20update" target="_blank" rel="noopener noreferrer">Найти</a> такие крупные обновления можно в каталоге при помощи поискового запроса <code>cumulative update</code>.</p>
<p>Скачиваемые обновления помещаются в директорию <code>C:\BuildFarm\UPD</code> для дальнейшей интеграции в дистрибутив ОС.</p>
<h3 id="извлечение-файла-wim-из-дистрибутива-ms-windows">
  <a class="link-body-emphasis" href="#%d0%b8%d0%b7%d0%b2%d0%bb%d0%b5%d1%87%d0%b5%d0%bd%d0%b8%d0%b5-%d1%84%d0%b0%d0%b9%d0%bb%d0%b0-wim-%d0%b8%d0%b7-%d0%b4%d0%b8%d1%81%d1%82%d1%80%d0%b8%d0%b1%d1%83%d1%82%d0%b8%d0%b2%d0%b0-ms-windows">Извлечение файла WIM из дистрибутива MS Windows</a>
</h3><p>Образ ОС находится в специальном файле <code>sources\install.wim</code>. Его необходимо извлечь при помощи программ для работы с файлами <code>.iso</code> (подойдёт <a title="" href="https://www.ultraiso.com" target="_blank" rel="noopener noreferrer">UltraISO</a> или <a title="" href="https://www.poweriso.com" target="_blank" rel="noopener noreferrer">PowerISO</a>) в директорию <code>C:\BuildFarm\WIM</code>.</p>
<h3 id="получение-информации-из-wim-образа">
  <a class="link-body-emphasis" href="#%d0%bf%d0%be%d0%bb%d1%83%d1%87%d0%b5%d0%bd%d0%b8%d0%b5-%d0%b8%d0%bd%d1%84%d0%be%d1%80%d0%bc%d0%b0%d1%86%d0%b8%d0%b8-%d0%b8%d0%b7-wim-%d0%be%d0%b1%d1%80%d0%b0%d0%b7%d0%b0">Получение информации из WIM-образа</a>
</h3><p>Файл <code>install.wim</code> может содержать несколько редакций ОС. Каждая редакция ОС имеет свой индекс. Для того, чтобы увидеть эти индексы, нужно ввести команду:</p>



<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-8 shortcode-codeblock-powershell">
  <div class="d-flex overflow-hidden">
    <div class="flex-grow-1 rounded overflow-hidden" id="cp-9096a513796e4e3088b19d5121b90116">
      
      <pre><code class='language-powershell'>Dism /Get-ImageInfo /ImageFile:&#34;C:\BuildFarm\WIM\install.wim&#34;</code></pre>
    </div>
    <div class="flex-shrink-0">
      <ul class="list-inline mb-0">
        <li class="list-inline-item" data-bs-tooltip data-bs-title='Копировать'>
          <a class="text-body" href="#"
             data-fn="clipboard preventDefault" data-clipboard-target="#cp-9096a513796e4e3088b19d5121b90116"
             role="button" aria-label='Копировать'>
            <i class="fas fa-copy fa-fw"></i>
          </a>
        </li>
      </ul>
    </div>
  </div>
</div>

<p>Где:</p>
<ul>
<li><code>/Get-ImageInfo</code> - получить информацию о версиях операционной системы, находящихся в WIM-образ.</li>
<li><code>/ImageFile</code> - путь к WIM-образу.</li>
</ul>
<p>Введённая команда предоставит примерно такой выхлоп:</p>






<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-9 shortcode-codeblock-terminal
shortcode-codeblock-terminal-windows shortcode-codeblock-terminal-windows-root">
  <div class="card overflow-hidden" data-bs-theme="dark">
    <div class="card-header">
      <div class="d-flex align-items-center">
        <div class="flex-shrink-0 text-danger">
          <i class="fas fa-terminal fa-fw"></i>
        </div>
        <div class="flex-grow-1 mx-2">
          <h5 class="mb-0">Терминал</h5>
        </div>
        <div class="flex-shrink-0">
          <ul class="list-inline mb-0">
            <li class="list-inline-item" data-bs-tooltip data-bs-title='Копировать'>
              <a class="text-body" href="#"
                 data-fn="clipboard preventDefault" data-clipboard-target="#cp-c58979bb74efa8fc5c941ce1a363cf21"
                 role="button" aria-label='Копировать'>
                <i class="fas fa-copy fa-fw"></i>
              </a>
            </li>
          </ul>
        </div>
      </div>
    </div>
    <div class="card-body p-0" id="cp-c58979bb74efa8fc5c941ce1a363cf21">
      <pre><code class="language-plaintext">Dism /Get-ImageInfo /ImageFile:&#34;C:\BuildFarm\WIM\install.wim&#34;

Details for image : C:\BuildFarm\WIM\install.wim

Index : 1
Name : Windows 10 Education
Description : Windows 10 Education
Size : 15,643,499,526 bytes

Index : 2
Name : Windows 10 Education N
Description : Windows 10 Education N
Size : 14,878,972,660 bytes

Index : 3
Name : Windows 10 Enterprise
Description : Windows 10 Enterprise
Size : 15,643,653,521 bytes

Index : 4
Name : Windows 10 Enterprise N
Description : Windows 10 Enterprise N
Size : 14,878,878,937 bytes

Index : 5
Name : Windows 10 Pro
Description : Windows 10 Pro
Size : 15,658,943,281 bytes

&lt;...&gt;
Extract Specific Windows Index from Windows 10 Multiple Edition ISO</code></pre>
    </div>
  </div>
</div>

<h3 id="монтирование-wim-образа">
  <a class="link-body-emphasis" href="#%d0%bc%d0%be%d0%bd%d1%82%d0%b8%d1%80%d0%be%d0%b2%d0%b0%d0%bd%d0%b8%d0%b5-wim-%d0%be%d0%b1%d1%80%d0%b0%d0%b7%d0%b0">Монтирование WIM-образа</a>
</h3><p>Индексы получены. Теперь необходимо примонтировать редакцию ОС из конкретного индекса. Выбор индекса зависит от вас: выбираете индекс той редакции ОС, которая вам необходима. Я выбрал редакцию <strong>Windows 10 Pro</strong> с индексом <code>5</code>:</p>



<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-10 shortcode-codeblock-powershell">
  <div class="d-flex overflow-hidden">
    <div class="flex-grow-1 rounded overflow-hidden" id="cp-01fa674cecc81b54c064087e1dac91f8">
      
      <pre><code class='language-powershell'>Dism /Mount-Image /ImageFile:&#34;C:\BuildFarm\WIM\install.wim&#34; /MountDir:&#34;C:\BuildFarm\MNT&#34; /index:5</code></pre>
    </div>
    <div class="flex-shrink-0">
      <ul class="list-inline mb-0">
        <li class="list-inline-item" data-bs-tooltip data-bs-title='Копировать'>
          <a class="text-body" href="#"
             data-fn="clipboard preventDefault" data-clipboard-target="#cp-01fa674cecc81b54c064087e1dac91f8"
             role="button" aria-label='Копировать'>
            <i class="fas fa-copy fa-fw"></i>
          </a>
        </li>
      </ul>
    </div>
  </div>
</div>

<p>Где:</p>
<ul>
<li><code>/Mount-Image</code> - команда на монтирование <span class="shortcode shortcode-tag">WIM</span>-образа.</li>
<li><code>/MountDir</code> - путь к директории, в которую необходимо поместить содержимое монтируемого <span class="shortcode shortcode-tag">WIM</span>-образа.</li>
<li><code>/index:5</code> - номер версии дистрибутива ОС. Номер можно узнать командой <code>/Get-ImageInfo</code>.</li>
</ul>




    










    
    




<div class="shortcode shortcode-alert">
  <div class="alert alert-success d-flex overflow-hidden" role="alert">
    <div class="flex-shrink-0 align-self-center">
      <i class="fas fa-lightbulb fa-fw fa-2x"></i>
    </div>
    <div class="flex-grow-1 ms-3 overflow-hidden">
        <p>Если что-то пошло не так, размонтировать образ без сохранения можно следующей командой:</p>
<!-- raw HTML omitted -->
<pre><code>  &lt;pre&gt;&lt;code class='language-bat'&gt;Dism /Unmount-Image /MountDir:&amp;#34;C:\BuildFarm\MNT&amp;#34; /Discard&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;div class=&quot;flex-shrink-0&quot;&gt;
  &lt;ul class=&quot;list-inline mb-0&quot;&gt;
    &lt;li class=&quot;list-inline-item&quot; data-bs-tooltip data-bs-title='Копировать'&gt;
      &lt;a class=&quot;text-body&quot; href=&quot;#&quot;
         data-fn=&quot;clipboard preventDefault&quot; data-clipboard-target=&quot;#cp-5911a710fa958774df16dfcf687aacb1&quot;
         role=&quot;button&quot; aria-label='Копировать'&gt;
        &lt;i class=&quot;fas fa-copy fa-fw&quot;&gt;&lt;/i&gt;
      &lt;/a&gt;
    &lt;/li&gt;
  &lt;/ul&gt;
&lt;/div&gt;
</code></pre>
<!-- raw HTML omitted -->
<p>Проверить список примонтированных образов можно следующей командой:</p>
<!-- raw HTML omitted -->
<pre><code>  &lt;pre&gt;&lt;code class='language-bat'&gt;Dism /Get-MountedImageInfo&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;div class=&quot;flex-shrink-0&quot;&gt;
  &lt;ul class=&quot;list-inline mb-0&quot;&gt;
    &lt;li class=&quot;list-inline-item&quot; data-bs-tooltip data-bs-title='Копировать'&gt;
      &lt;a class=&quot;text-body&quot; href=&quot;#&quot;
         data-fn=&quot;clipboard preventDefault&quot; data-clipboard-target=&quot;#cp-e2f48a92ffdb02c773467b238041c931&quot;
         role=&quot;button&quot; aria-label='Копировать'&gt;
        &lt;i class=&quot;fas fa-copy fa-fw&quot;&gt;&lt;/i&gt;
      &lt;/a&gt;
    &lt;/li&gt;
  &lt;/ul&gt;
&lt;/div&gt;
</code></pre>
<!-- raw HTML omitted -->
<p>Если после размонтирования образ всё ещё остаётся подключённым к системе и является повреждённым, следующая команда можешь помочь:</p>
<!-- raw HTML omitted -->
<pre><code>  &lt;pre&gt;&lt;code class='language-bat'&gt;Dism /Cleanup-Mountpoints&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;div class=&quot;flex-shrink-0&quot;&gt;
  &lt;ul class=&quot;list-inline mb-0&quot;&gt;
    &lt;li class=&quot;list-inline-item&quot; data-bs-tooltip data-bs-title='Копировать'&gt;
      &lt;a class=&quot;text-body&quot; href=&quot;#&quot;
         data-fn=&quot;clipboard preventDefault&quot; data-clipboard-target=&quot;#cp-83f6c403d5c95bf1ea836c39d3deb41c&quot;
         role=&quot;button&quot; aria-label='Копировать'&gt;
        &lt;i class=&quot;fas fa-copy fa-fw&quot;&gt;&lt;/i&gt;
      &lt;/a&gt;
    &lt;/li&gt;
  &lt;/ul&gt;
&lt;/div&gt;
</code></pre>
<!-- raw HTML omitted -->
<p>Она удалит все ресурсы, связанные с повреждённым образом и очистит систему от &ldquo;зависших&rdquo; точек монтирования.</p>

    </div>
  </div>
</div>

<h3 id="интеграция-обновлений-в-wim-образ">
  <a class="link-body-emphasis" href="#%d0%b8%d0%bd%d1%82%d0%b5%d0%b3%d1%80%d0%b0%d1%86%d0%b8%d1%8f-%d0%be%d0%b1%d0%bd%d0%be%d0%b2%d0%bb%d0%b5%d0%bd%d0%b8%d0%b9-%d0%b2-wim-%d0%be%d0%b1%d1%80%d0%b0%d0%b7">Интеграция обновлений в WIM-образ</a>
</h3><p>После монтирования редакции ОС с конкретным индексом, можно начинать процесс интеграции обновлений:</p>
<p>


<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-14 shortcode-codeblock-powershell">
  <div class="d-flex overflow-hidden">
    <div class="flex-grow-1 rounded overflow-hidden" id="cp-4c48e249e885f131a57387f9be0fba51">
      
      <pre><code class='language-powershell'>Dism /Image:&#34;C:\BuildFarm\MNT&#34; /Add-Package /PackagePath:&#34;C:\BuildFarm\UPD&#34;</code></pre>
    </div>
    <div class="flex-shrink-0">
      <ul class="list-inline mb-0">
        <li class="list-inline-item" data-bs-tooltip data-bs-title='Копировать'>
          <a class="text-body" href="#"
             data-fn="clipboard preventDefault" data-clipboard-target="#cp-4c48e249e885f131a57387f9be0fba51"
             role="button" aria-label='Копировать'>
            <i class="fas fa-copy fa-fw"></i>
          </a>
        </li>
      </ul>
    </div>
  </div>
</div>

Где:</p>
<ul>
<li><code>/Image</code> - путь к директории, в которой находится содержимое примонтированного WIM-образа.</li>
<li><code>/Add-Package</code> - команда на добавление пакетов (обновлений) в WIM-образ.
<ul>
<li><code>/PackagePath</code> - путь к директории, в которой находятся пакеты (обновления) для интеграции в WIM-образ.</li>
</ul>
</li>
</ul>
<h3 id="проверка-корректности-интеграции-обновлений-опционально">
  <a class="link-body-emphasis" href="#%d0%bf%d1%80%d0%be%d0%b2%d0%b5%d1%80%d0%ba%d0%b0-%d0%ba%d0%be%d1%80%d1%80%d0%b5%d0%ba%d1%82%d0%bd%d0%be%d1%81%d1%82%d0%b8-%d0%b8%d0%bd%d1%82%d0%b5%d0%b3%d1%80%d0%b0%d1%86%d0%b8%d0%b8-%d0%be%d0%b1%d0%bd%d0%be%d0%b2%d0%bb%d0%b5%d0%bd%d0%b8%d0%b9-%d0%be%d0%bf%d1%86%d0%b8%d0%be%d0%bd%d0%b0%d0%bb%d1%8c%d0%bd%d0%be">Проверка корректности интеграции обновлений (опционально)</a>
</h3><p>По окончании процесса интеграции, можно проверить корректность выполненной задачи. Команда ниже покажет список пакетов, установленных в примонтированной редакции ОС. В этом списке пакетов будут интегрированные обновления.</p>
<p>


<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-15 shortcode-codeblock-powershell">
  <div class="d-flex overflow-hidden">
    <div class="flex-grow-1 rounded overflow-hidden" id="cp-b1495f989b999ad8757cb0cce2ad22b0">
      
      <pre><code class='language-powershell'>Dism /Image:&#34;C:\BuildFarm\MNT&#34; /Get-Packages</code></pre>
    </div>
    <div class="flex-shrink-0">
      <ul class="list-inline mb-0">
        <li class="list-inline-item" data-bs-tooltip data-bs-title='Копировать'>
          <a class="text-body" href="#"
             data-fn="clipboard preventDefault" data-clipboard-target="#cp-b1495f989b999ad8757cb0cce2ad22b0"
             role="button" aria-label='Копировать'>
            <i class="fas fa-copy fa-fw"></i>
          </a>
        </li>
      </ul>
    </div>
  </div>
</div>

Где:</p>
<ul>
<li><code>/Image</code> - путь к директории, в которой находится содержимое примонтированного <span class="shortcode shortcode-tag">WIM</span>-образа.</li>
<li><code>/Get-Packages</code> - команда для получения информации о интегрированных пакетах примонтированного <span class="shortcode shortcode-tag">WIM</span>-образа.</li>
</ul>
<h3 id="очистка-хранилища-компонентов-wim-образ-опционально">
  <a class="link-body-emphasis" href="#%d0%be%d1%87%d0%b8%d1%81%d1%82%d0%ba%d0%b0-%d1%85%d1%80%d0%b0%d0%bd%d0%b8%d0%bb%d0%b8%d1%89%d0%b0-%d0%ba%d0%be%d0%bc%d0%bf%d0%be%d0%bd%d0%b5%d0%bd%d1%82%d0%be%d0%b2-wim-%d0%be%d0%b1%d1%80%d0%b0%d0%b7-%d0%be%d0%bf%d1%86%d0%b8%d0%be%d0%bd%d0%b0%d0%bb%d1%8c%d0%bd%d0%be">Очистка хранилища компонентов WIM-образ (опционально)</a>
</h3><p>Для уменьшения размера дистрибутива можно запустить процедуру удаления предыдущих версий компонентов, которые были изменены (заменены) установленными обновлениями:</p>



<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-18 shortcode-codeblock-powershell">
  <div class="d-flex overflow-hidden">
    <div class="flex-grow-1 rounded overflow-hidden" id="cp-3cd6c0d5b72fe29c12d708be1ec95b9d">
      
      <pre><code class='language-powershell'>Dism /Image:&#34;C:\BuildFarm\MNT&#34; /Cleanup-Image /StartComponentCleanup /ResetBase</code></pre>
    </div>
    <div class="flex-shrink-0">
      <ul class="list-inline mb-0">
        <li class="list-inline-item" data-bs-tooltip data-bs-title='Копировать'>
          <a class="text-body" href="#"
             data-fn="clipboard preventDefault" data-clipboard-target="#cp-3cd6c0d5b72fe29c12d708be1ec95b9d"
             role="button" aria-label='Копировать'>
            <i class="fas fa-copy fa-fw"></i>
          </a>
        </li>
      </ul>
    </div>
  </div>
</div>

<p>Где:</p>
<ul>
<li><code>/Image</code> - путь к директории, в которой находится содержимое примонтированного <span class="shortcode shortcode-tag">WIM</span>-образа.</li>
<li><code>/Cleanup-Image</code> - очистка и восстановление образа.
<ul>
<li><code>/StartComponentCleanup</code> - удаляет заменённые компоненты и уменьшает размер хранилища компонентов.
<ul>
<li><code>/ResetBase</code> - сброс базы заменяемых компонентов.</li>
</ul>
</li>
</ul>
</li>
</ul>
<h3 id="проверка-хранилища-компонентов-wim-образа-опционально">
  <a class="link-body-emphasis" href="#%d0%bf%d1%80%d0%be%d0%b2%d0%b5%d1%80%d0%ba%d0%b0-%d1%85%d1%80%d0%b0%d0%bd%d0%b8%d0%bb%d0%b8%d1%89%d0%b0-%d0%ba%d0%be%d0%bc%d0%bf%d0%be%d0%bd%d0%b5%d0%bd%d1%82%d0%be%d0%b2-wim-%d0%be%d0%b1%d1%80%d0%b0%d0%b7%d0%b0-%d0%be%d0%bf%d1%86%d0%b8%d0%be%d0%bd%d0%b0%d0%bb%d1%8c%d0%bd%d0%be">Проверка хранилища компонентов WIM-образа (опционально)</a>
</h3><p>Опциональный шаг перед заключительным этапом - проверить системные компоненты и файлы на повреждения:</p>



<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-20 shortcode-codeblock-powershell">
  <div class="d-flex overflow-hidden">
    <div class="flex-grow-1 rounded overflow-hidden" id="cp-5808185db9754f0733d6f387627a31e5">
      
      <pre><code class='language-powershell'>Dism /Image:&#34;C:\BuildFarm\MNT&#34; /Cleanup-Image /ScanHealth</code></pre>
    </div>
    <div class="flex-shrink-0">
      <ul class="list-inline mb-0">
        <li class="list-inline-item" data-bs-tooltip data-bs-title='Копировать'>
          <a class="text-body" href="#"
             data-fn="clipboard preventDefault" data-clipboard-target="#cp-5808185db9754f0733d6f387627a31e5"
             role="button" aria-label='Копировать'>
            <i class="fas fa-copy fa-fw"></i>
          </a>
        </li>
      </ul>
    </div>
  </div>
</div>

<p>Где:</p>
<ul>
<li><code>/Image</code> - путь к директории, в которой находится содержимое примонтированного <span class="shortcode shortcode-tag">WIM</span>-образа.</li>
<li><code>/Cleanup-Image</code> - очистка и восстановление образа.
<ul>
<li><code>/ScanHealth</code> - сканирование образа на наличие повреждений хранилища компонентов.</li>
</ul>
</li>
</ul>
<h3 id="сохранение-изменений-в-wim-образе">
  <a class="link-body-emphasis" href="#%d1%81%d0%be%d1%85%d1%80%d0%b0%d0%bd%d0%b5%d0%bd%d0%b8%d0%b5-%d0%b8%d0%b7%d0%bc%d0%b5%d0%bd%d0%b5%d0%bd%d0%b8%d0%b9-%d0%b2-wim-%d0%be%d0%b1%d1%80%d0%b0%d0%b7%d0%b5">Сохранение изменений в WIM-образе</a>
</h3><p>После выполнения всех действий, необходимо отмонтировать редакцию ОС с сохранением изменений. Делается это командой:</p>



<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-22 shortcode-codeblock-powershell">
  <div class="d-flex overflow-hidden">
    <div class="flex-grow-1 rounded overflow-hidden" id="cp-29c7dabf7d8717173a6c74084adf5456">
      
      <pre><code class='language-powershell'>Dism /Unmount-Image /MountDir:&#34;C:\BuildFarm\MNT&#34; /Commit</code></pre>
    </div>
    <div class="flex-shrink-0">
      <ul class="list-inline mb-0">
        <li class="list-inline-item" data-bs-tooltip data-bs-title='Копировать'>
          <a class="text-body" href="#"
             data-fn="clipboard preventDefault" data-clipboard-target="#cp-29c7dabf7d8717173a6c74084adf5456"
             role="button" aria-label='Копировать'>
            <i class="fas fa-copy fa-fw"></i>
          </a>
        </li>
      </ul>
    </div>
  </div>
</div>

<p>Где:</p>
<ul>
<li><code>/Unmount-Image</code> - команда для отмонтирования <span class="shortcode shortcode-tag">WIM</span>-образа.</li>
<li><code>/MountDir</code> - путь к директории, в которой находится содержимое примонтированного <span class="shortcode shortcode-tag">WIM</span>-образа.</li>
<li><code>/Commit</code> - сохранение совершённых изменений в <span class="shortcode shortcode-tag">WIM</span>-образе.</li>
</ul>
<p>Всё. Мы получили файл <code>install.wim</code> с интегрированными обновлениями. Теперь этот файл <code>install.wim</code> необходимо обратно упаковать в образ <span class="shortcode shortcode-tag">ISO</span> с заменой старого.</p>
<h2 id="автоматизация">
  <a class="link-body-emphasis" href="#%d0%b0%d0%b2%d1%82%d0%be%d0%bc%d0%b0%d1%82%d0%b8%d0%b7%d0%b0%d1%86%d0%b8%d1%8f">Автоматизация</a>
</h2><p>Я люблю автоматизировать всё по максимуму. И здесь я не упустил шанс написать небольшой скрипт с деревянной логикой, который сделает все шаги по интеграции обновлений за человека. Только вот, извлечь файл <code>install.wim</code> из <span class="shortcode shortcode-tag">ISO</span>-образа придётся самому.</p>

    

    
        
            
            <div class="shortcode shortcode-file mb-3">
              <div class="card overflow-hidden">
                <div class="card-header">
                  <div class="d-flex align-items-center">
                    <div class="flex-shrink-0">
                      <i class="far fa-file-code fa-fw"></i>
                    </div>
                    <div class="flex-grow-1 mx-2 text-truncate">
                      <code>dism.packages.bat</code>
                    </div>
                    <div class="flex-shrink-0">
                      <ul class="list-inline mb-0">
                        <li class="list-inline-item" data-bs-tooltip data-bs-title='Копировать'>
                          <a class="text-body" href="#"
                             data-fn="clipboard preventDefault" data-clipboard-target="#cp-208a369f5b998f714804b80aea56e783"
                             role="button" aria-label='Копировать'>
                            <i class="fas fa-copy fa-fw"></i>
                          </a>
                        </li>
                        <li class="list-inline-item" data-bs-tooltip data-bs-title='Скачать'>
                          <a class="text-body" href="/ru/articles/2022/05/862226e6-cbb1-58f8-bc8e-0cfef747f475/dism.packages.bat" download
                             role="button" aria-label='Скачать'>
                            <i class="fas fa-download fa-fw"></i>
                          </a>
                        </li>
                        <li class="list-inline-item" data-bs-tooltip data-bs-title='Открыть'>
                          <a class="text-body" href="/ru/articles/2022/05/862226e6-cbb1-58f8-bc8e-0cfef747f475/dism.packages.bat" target="_blank"
                             role="button" aria-label='Открыть'>
                            <i class="fas fa-arrow-up-right-from-square fa-fw"></i>
                          </a>
                        </li>
                      </ul>
                    </div>
                  </div>
                </div>
                <div class="card-body" id="cp-208a369f5b998f714804b80aea56e783">
                    
                        
                    
                  <pre><code class="language-bat">rem Automatic integration of updates into DISM.
rem
rem @package   CMD
rem @author    Kai Kimera &lt;mail@kai.kim&gt;
rem @copyright 2023 Library Online
rem @license   MIT
rem @version   0.1.0
rem @link      https://lib.onl/ru/articles/2022/05/862226e6-cbb1-58f8-bc8e-0cfef747f475/
rem ------------------------------------------------------------------------------------------------------------------ ::

@echo off

set d_mnt=&#34;%~dp0MNT&#34;
set d_upd=&#34;%~dp0UPD&#34;
set d_wim=&#34;%~dp0WIM&#34;
set f_wim=&#34;%d_wim%\install.wim&#34;

rem Creating directories.
if not exist &#34;%d_mnt%&#34; mkdir &#34;%d_mnt%&#34;
if not exist &#34;%d_upd%&#34; mkdir &#34;%d_upd%&#34;
if not exist &#34;%d_wim%&#34; mkdir &#34;%d_wim%&#34;

rem Checking files.
if not exist &#34;%f_wim%&#34; echo Please put &#34;install.wim&#34; file in &#34;WIM&#34; directory... &amp;&amp; pause
if not exist &#34;%d_upd%/*.msu&#34; echo Please put &#34;*.msu&#34; files in &#34;UPD&#34; directory... &amp;&amp; pause

if exist &#34;%f_wim%&#34; (
  echo Getting Windows Image Info...
  Dism /Get-ImageInfo /ImageFile:&#34;%f_wim%&#34;
) else (
  echo &#34;install.wim&#34; not found! &amp; echo.Failed with error #%errorlevel%.
  goto :error
)

set /p index=&#34;Enter INDEX: &#34;

echo Mounting Windows image...
Dism /Mount-Image /ImageFile:&#34;%f_wim%&#34; /MountDir:&#34;%d_mnt%&#34; /index:%index%

echo Adding Windows packages...
Dism /Image:&#34;%d_mnt%&#34; /Add-Package /PackagePath:&#34;%d_upd%&#34;

echo Getting Windows packages...
Dism /Image:&#34;%d_mnt%&#34; /Get-Packages

echo Reseting Windows image...
Dism /Image:&#34;%d_mnt%&#34; /Cleanup-Image /StartComponentCleanup /ResetBase

echo Scaning health Windows image...
Dism /Image:&#34;%d_mnt%&#34; /Cleanup-Image /ScanHealth

echo Saving Windows image...
Dism /Unmount-Image /MountDir:&#34;%d_mnt%&#34; /Commit

exit /b 0

:error
exit /b %errorlevel%</code></pre>
                </div>
              </div>
            </div>
        
    
<p>Поместить скрипт нужно в корень директории <code>BuildFarm</code> и запустить из терминала <span class="shortcode shortcode-tag"><a href="/ru/tags/dism/" target="_blank">#DISM</a></span>. Если же возникнут какие-либо проблемы, ниже есть небольшой скрипт, который размонтирует образ и очистит систему от точек монтирования.</p>

    

    
        
            
            <div class="shortcode shortcode-file mb-3">
              <div class="card overflow-hidden">
                <div class="card-header">
                  <div class="d-flex align-items-center">
                    <div class="flex-shrink-0">
                      <i class="far fa-file-code fa-fw"></i>
                    </div>
                    <div class="flex-grow-1 mx-2 text-truncate">
                      <code>dism.unmount.bat</code>
                    </div>
                    <div class="flex-shrink-0">
                      <ul class="list-inline mb-0">
                        <li class="list-inline-item" data-bs-tooltip data-bs-title='Копировать'>
                          <a class="text-body" href="#"
                             data-fn="clipboard preventDefault" data-clipboard-target="#cp-aa9099f738929564499872a0f0ff040c"
                             role="button" aria-label='Копировать'>
                            <i class="fas fa-copy fa-fw"></i>
                          </a>
                        </li>
                        <li class="list-inline-item" data-bs-tooltip data-bs-title='Скачать'>
                          <a class="text-body" href="/ru/articles/2022/05/862226e6-cbb1-58f8-bc8e-0cfef747f475/dism.unmount.bat" download
                             role="button" aria-label='Скачать'>
                            <i class="fas fa-download fa-fw"></i>
                          </a>
                        </li>
                        <li class="list-inline-item" data-bs-tooltip data-bs-title='Открыть'>
                          <a class="text-body" href="/ru/articles/2022/05/862226e6-cbb1-58f8-bc8e-0cfef747f475/dism.unmount.bat" target="_blank"
                             role="button" aria-label='Открыть'>
                            <i class="fas fa-arrow-up-right-from-square fa-fw"></i>
                          </a>
                        </li>
                      </ul>
                    </div>
                  </div>
                </div>
                <div class="card-body" id="cp-aa9099f738929564499872a0f0ff040c">
                    
                        
                    
                  <pre><code class="language-bat">rem Automatic unmounting WIM images into DISM.
rem
rem @package   CMD
rem @author    Kai Kimera &lt;mail@kai.kim&gt;
rem @copyright 2023 Library Online
rem @license   MIT
rem @version   0.1.0
rem @link      https://lib.onl/ru/articles/2022/05/862226e6-cbb1-58f8-bc8e-0cfef747f475/
rem ------------------------------------------------------------------------------------------------------------------ ::

@echo off

set d_mnt=&#34;%~dp0MNT&#34;

echo Unmounting &#34;install.wim&#34; and discards changes that were made when image was mounted...
Dism /Unmount-Image /MountDir:&#34;%d_mnt%&#34; /Discard

echo Deleting all of resources associated with a mounted image that has been corrupted...
Dism /Cleanup-Mountpoints

echo Getting information about mounted image...
Dism /Get-MountedImageInfo

exit /b 0</code></pre>
                </div>
              </div>
            </div>]]></turbo:content></item><item turbo="true"><title>Windows Server 2022 для рабочей станции</title><link>https://lib.onl/ru/articles/2022/05/36058650-3f35-5ed5-9565-0aa7d8800c28/</link><pubDate>Mon, 09 May 2022 11:53:26 +0000</pubDate><dc:creator>Kai Kimera</dc:creator><category>MS Windows</category><turbo:extendedHtml>true</turbo:extendedHtml><turbo:source>https://lib.onl/ru/articles/2022/05/36058650-3f35-5ed5-9565-0aa7d8800c28/</turbo:source><turbo:topic>Windows Server 2022 для рабочей станции</turbo:topic><turbo:content><![CDATA[<p>В этой небольшой заметке я расскажу, как перенастроить серверную версию ОС <span class="shortcode shortcode-tag"><a href="/ru/categories/windows/" target="_blank">#Windows</a></span> для работы на обычном стационарном ПК.</p>
<h2 id="настройка-служб">
  <a class="link-body-emphasis" href="#%d0%bd%d0%b0%d1%81%d1%82%d1%80%d0%be%d0%b9%d0%ba%d0%b0-%d1%81%d0%bb%d1%83%d0%b6%d0%b1">Настройка служб</a>
</h2><p>На сервере нет необходимости использовать поисковые механизмы и вывод звука, поэтому они отключены. Но на рабочей станции эти параметры необходимы. Для включения звука и поискового механизма, необходимо настроить запуск соответствующих служб.</p>
<ul>
<li>Services
<ul>
<li>Windows Audio
<ul>
<li>Startup type
<ul>
<li>Automatic</li>
</ul>
</li>
</ul>
</li>
<li>Windows Audio Endpoint
<ul>
<li>Startup type
<ul>
<li>Automatic</li>
</ul>
</li>
</ul>
</li>
<li>Windows Search
<ul>
<li>Startup type
<ul>
<li>Automatic (Delayed Start)</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<h2 id="отключение-shutdown-event-tracker">
  <a class="link-body-emphasis" href="#%d0%be%d1%82%d0%ba%d0%bb%d1%8e%d1%87%d0%b5%d0%bd%d0%b8%d0%b5-shutdown-event-tracker">Отключение Shutdown Event Tracker</a>
</h2><p>Сервер должен работать бесперебойно. Любое отключение сервера, по хорошему, должно записываться в специальный журнал. Но так как у нас рабочая станция, записывать каждые перезагрузку или выключение нет необходимости. Включаем службы.</p>
<ul>
<li>Local Group Policy
<ul>
<li>Computer Configuration / Administrative Templates / System
<ul>
<li>Display Shutdown Event Tracker
<ul>
<li>Disabled</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<h2 id="отключение-строгой-системы-безопасности-ie">
  <a class="link-body-emphasis" href="#%d0%be%d1%82%d0%ba%d0%bb%d1%8e%d1%87%d0%b5%d0%bd%d0%b8%d0%b5-%d1%81%d1%82%d1%80%d0%be%d0%b3%d0%be%d0%b9-%d1%81%d0%b8%d1%81%d1%82%d0%b5%d0%bc%d1%8b-%d0%b1%d0%b5%d0%b7%d0%be%d0%bf%d0%b0%d1%81%d0%bd%d0%be%d1%81%d1%82%d0%b8-ie">Отключение строгой системы безопасности IE</a>
</h2><p>Сервер использует строгие параметры системы безопасности <span class="shortcode shortcode-tag">IE</span>. Но на рабочей станции в этих параметрах нет необходимости и они будут только мешать. Отключаем их.</p>
<ul>
<li>Server Manager / Local Server
<ul>
<li>IE Enhanced Security Configuration
<ul>
<li>Off</li>
</ul>
</li>
</ul>
</li>
</ul>
<h2 id="оптимизация-производительности-для-приложений">
  <a class="link-body-emphasis" href="#%d0%be%d0%bf%d1%82%d0%b8%d0%bc%d0%b8%d0%b7%d0%b0%d1%86%d0%b8%d1%8f-%d0%bf%d1%80%d0%be%d0%b8%d0%b7%d0%b2%d0%be%d0%b4%d0%b8%d1%82%d0%b5%d0%bb%d1%8c%d0%bd%d0%be%d1%81%d1%82%d0%b8-%d0%b4%d0%bb%d1%8f-%d0%bf%d1%80%d0%b8%d0%bb%d0%be%d0%b6%d0%b5%d0%bd%d0%b8%d0%b9">Оптимизация производительности для приложений</a>
</h2><p>По умолчанию, на сервере оптимизация включена для фоновых служб. На рабочей станции необходима оптимизация для программ. Включаем оптимизацию для программ.</p>
<ul>
<li>System / Advanced System Settings / Advanced / Performance / Advanced
<ul>
<li>Adjust for best performance of
<ul>
<li>Programs</li>
</ul>
</li>
</ul>
</li>
</ul>
<h2 id="отключение-dep">
  <a class="link-body-emphasis" href="#%d0%be%d1%82%d0%ba%d0%bb%d1%8e%d1%87%d0%b5%d0%bd%d0%b8%d0%b5-dep">Отключение DEP</a>
</h2><p>По умолчанию, <a title="" href="https://docs.microsoft.com/en-us/windows/win32/memory/data-execution-prevention" target="_blank" rel="noopener noreferrer">Data Execution Prevention (DEP)</a> включена абсолютно для всех программ и сервисов. Такая излишняя защита на рабочей станции не нужна. Поэтому, переключаем выполнение <span class="shortcode shortcode-tag">DEP</span> только для программ и сервисов самой ОС Windows.</p>
<ul>
<li>System / Advanced System Settings / Advanced / Performance / Data Execution Prevention
<ul>
<li>Turn on DEP for essential Windows programs and services only</li>
</ul>
</li>
</ul>
<h2 id="включение-memory-compression-operation-api-и-pagecombining">
  <a class="link-body-emphasis" href="#%d0%b2%d0%ba%d0%bb%d1%8e%d1%87%d0%b5%d0%bd%d0%b8%d0%b5-memory-compression-operation-api-%d0%b8-pagecombining">Включение Memory Compression, Operation API и PageCombining</a>
</h2><p>В ОС <span class="shortcode shortcode-tag"><a href="/ru/categories/windows/" target="_blank">#Windows</a></span> для обычных компьютеров включены Memory Compression, Operation API и PageCombining. Поэтому, перенастраиваем серверную версию ОС на такую же конфигурацию. Для этого запускаем <span class="shortcode shortcode-tag"><a href="/ru/tags/powershell/" target="_blank">#PowerShell</a></span> от имени Администратора и выполняем команду:</p>



<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-5 shortcode-codeblock-powershell">
  <div class="d-flex overflow-hidden">
    <div class="flex-grow-1 rounded overflow-hidden" id="cp-05316c41a8ab73a8fd2fdb6a73382f72">
      
      <pre><code class='language-powershell'>Enable-MMAgent -MemoryCompression -OperationAPI -PageCombining</code></pre>
    </div>
    <div class="flex-shrink-0">
      <ul class="list-inline mb-0">
        <li class="list-inline-item" data-bs-tooltip data-bs-title='Копировать'>
          <a class="text-body" href="#"
             data-fn="clipboard preventDefault" data-clipboard-target="#cp-05316c41a8ab73a8fd2fdb6a73382f72"
             role="button" aria-label='Копировать'>
            <i class="fas fa-copy fa-fw"></i>
          </a>
        </li>
      </ul>
    </div>
  </div>
</div>]]></turbo:content></item><item turbo="true"><title>Установка ядра XanMod в Debian</title><link>https://lib.onl/ru/articles/2022/01/06ef2fab-2ae2-5356-9154-7ca1e486d27d/</link><pubDate>Thu, 13 Jan 2022 22:44:15 +0000</pubDate><dc:creator>Kai Kimera</dc:creator><category>Linux</category><yandex:related><link url="https://lib.onl/ru/articles/2022/01/ddddd243-d182-5e26-a161-d2ea7812214a/">Установка Vivaldi в Debian</link><link url="https://lib.onl/ru/articles/2021/09/581804b8-0613-52a8-a5c4-fdae90e7bc8a/">Чёрный экран с курсором при старте GDM</link><link url="https://lib.onl/ru/articles/2021/09/1cf305cd-85d0-5e02-aabb-e01346bfee0f/">Установка Proxmox VE на Debian 11 (Bullseye)</link><link url="https://lib.onl/ru/articles/2021/09/ff829d15-4a19-52e3-a3aa-ad70aa38854a/">Debian: Wired Networks are Unmanaged</link><link url="https://lib.onl/ru/articles/2021/09/b2caccc7-92bf-57ed-970f-136c546f18e2/">Распаковка пакетов DEB / RPM</link><link url="https://lib.onl/ru/articles/2021/09/43b40b92-c29a-504b-87fa-5eac368dcf95/">Отключение установки дополнительных пакетов в Debian APT</link><link url="https://lib.onl/ru/articles/2021/09/aeed7c90-003a-532a-b2c4-3807aaee88fa/">dhclient отправляет 36-значный идентификатор вместо MAC</link></yandex:related><turbo:extendedHtml>true</turbo:extendedHtml><turbo:source>https://lib.onl/ru/articles/2022/01/06ef2fab-2ae2-5356-9154-7ca1e486d27d/</turbo:source><turbo:topic>Установка ядра XanMod в Debian</turbo:topic><turbo:content><![CDATA[<p>Приветствую! В этой небольшой заметке приведу команду, при помощи которой можно добавить репозиторий ядра <span class="shortcode shortcode-tag"><a href="/ru/tags/xanmod/" target="_blank">#XanMod</a></span> в <span class="shortcode shortcode-tag"><a href="/ru/tags/debian/" target="_blank">#Debian</a></span>.</p>
<h2 id="что-такое-ядро-xanmod">
  <a class="link-body-emphasis" href="#%d1%87%d1%82%d0%be-%d1%82%d0%b0%d0%ba%d0%be%d0%b5-%d1%8f%d0%b4%d1%80%d0%be-xanmod">Что такое ядро XanMod?</a>
</h2><p>Ядро <span class="shortcode shortcode-tag"><a href="/ru/tags/xanmod/" target="_blank">#XanMod</a></span> имеет ряд патчей и оптимизаций. Список изменений по сравнению с ванильным ядром, я взял с <a title="" href="https://xanmod.org" target="_blank" rel="noopener noreferrer">официального сайта</a>:</p>
<ul>
<li>Caching, Virtual Memory Manager and CPUFreq Governor improvements.</li>
<li>Full multi-core block layer runqueue requests for high I/O throughput.</li>
<li>BBRv2 TCP congestion control + FQ-PIE packet scheduling and AQM algorithm.</li>
<li>ORC Unwinder for kernel stack traces (debuginfo) implementation.</li>
<li>High responsiveness multitasking Task Type scheduler (SCHED_NORMAL) build available [5.15-tt].</li>
<li>Real-time Linux kernel (PREEMPT_RT) build available [5.15-rt] [5.10-rt].</li>
<li>Third-party patchset available: patches
<ul>
<li>le9&rsquo;s file mappings under memory pressure protection.</li>
<li>Linux Random Number Generator (LRNG) framework.</li>
<li>TCP performance optimizations backport from linux/net-next [5.16] [5.15].</li>
<li>AMD&rsquo;s P-state driver for Zen2 and Zen3 processors [5.16] [5.15].</li>
<li>Futex waitv and legacy WAIT_MULTIPLE implementation for Wine / Proton Fsync support.</li>
<li>WineSync driver for fast kernel-backed Wine [5.16] [5.15] [as module: winesync].</li>
<li>Google&rsquo;s Multigenerational LRU framework [5.16] [5.15].</li>
<li>Google&rsquo;s BBRv2 TCP congestion control.</li>
<li>Paragon&rsquo;s Software NTFS3 driver [as module: ntfs3].</li>
<li>PCIe ACS Override for bypassing IOMMU groups support.</li>
<li>Graysky&rsquo;s additional CPU optimizations for GCC and Clang.</li>
<li>Clear Linux patchset [partial].</li>
<li>Android Ashmem and Binder IPC driver as module for Anbox.</li>
<li>Updated ZSTD library for bug fixes and r/w performance compression improvements on Btrfs, F2FS, SquashFS, pstore, initramfs and vmlinuz.</li>
</ul>
</li>
<li>Generic packages for compatibility with most Debian &amp; Ubuntu based distributions. Builts on the latest LLVM 12.0.1, GCC 11.2 and Binutils 2.37.</li>
<li>GPLv2 license. Can be built for any distribution or purpose.</li>
</ul>
<p>Стоит заметить, что ядро <span class="shortcode shortcode-tag"><a href="/ru/tags/xanmod/" target="_blank">#XanMod</a></span> не единственное, которое интегрирует в себя оптимизации. Есть ещё ядро <a title="" href="https://liquorix.net" target="_blank" rel="noopener noreferrer"><strong>Liquorix</strong></a>, которое занимается практически тем же самым. Но, посмотрев <a title="" href="https://www.phoronix.com/scan.php?page=article&amp;item=ryzen5-xanmod-liquorix" target="_blank" rel="noopener noreferrer">обзор и тесты</a> на Phoronix&rsquo;е, я сделал выбор в пользу <span class="shortcode shortcode-tag"><a href="/ru/tags/xanmod/" target="_blank">#XanMod</a></span>.</p>
<h2 id="установка-xanmod">
  <a class="link-body-emphasis" href="#%d1%83%d1%81%d1%82%d0%b0%d0%bd%d0%be%d0%b2%d0%ba%d0%b0-xanmod">Установка XanMod</a>
</h2><p>Однострочная команда по добавлению ядра <span class="shortcode shortcode-tag"><a href="/ru/tags/xanmod/" target="_blank">#XanMod</a></span> в репозиторий <span class="shortcode shortcode-tag"><a href="/ru/tags/debian/" target="_blank">#Debian</a></span>&rsquo;а приведена ниже. Она дробится на следующие под-команды:</p>
<ol>
<li>Добавление файла <code>xanmod-kernel.list</code> в директорию <code>/etc/apt/sources.list.d</code>.</li>
<li>Скачивание файла подписи <code>archive.key</code> и размещение его в директорию <code>/etc/apt/trusted.gpg.d</code> с названием <code>xanmod-kernel.gpg</code>.</li>
<li>Обновление информации из репозитория при помощи команды <code>apt update</code>.</li>
</ol>



<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-7 shortcode-codeblock-bash">
  <div class="d-flex overflow-hidden">
    <div class="flex-grow-1 rounded overflow-hidden" id="cp-d97e4f6e597fab7ba49585b30ba9d652">
      
      <pre><code class='language-bash'>echo &#39;deb [signed-by=/etc/apt/trusted.gpg.d/xanmod-kernel.gpg] http://deb.xanmod.org releases main&#39; | tee /etc/apt/sources.list.d/xanmod-kernel.list &amp;&amp; curl -fsSL &#39;https://dl.xanmod.org/archive.key&#39; | gpg --dearmor | tee /etc/apt/trusted.gpg.d/xanmod-kernel.gpg &gt; /dev/null &amp;&amp; apt update</code></pre>
    </div>
    <div class="flex-shrink-0">
      <ul class="list-inline mb-0">
        <li class="list-inline-item" data-bs-tooltip data-bs-title='Копировать'>
          <a class="text-body" href="#"
             data-fn="clipboard preventDefault" data-clipboard-target="#cp-d97e4f6e597fab7ba49585b30ba9d652"
             role="button" aria-label='Копировать'>
            <i class="fas fa-copy fa-fw"></i>
          </a>
        </li>
      </ul>
    </div>
  </div>
</div>

<p>После выполнения вышеприведённой команды, установка ядра <span class="shortcode shortcode-tag"><a href="/ru/tags/xanmod/" target="_blank">#XanMod</a></span> происходит таким образом:</p>



<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-9 shortcode-codeblock-bash">
  <div class="d-flex overflow-hidden">
    <div class="flex-grow-1 rounded overflow-hidden" id="cp-08a5271c9f8b121b1b94dc90be21155c">
      
      <pre><code class='language-bash'>apt install linux-xanmod-[ABI]</code></pre>
    </div>
    <div class="flex-shrink-0">
      <ul class="list-inline mb-0">
        <li class="list-inline-item" data-bs-tooltip data-bs-title='Копировать'>
          <a class="text-body" href="#"
             data-fn="clipboard preventDefault" data-clipboard-target="#cp-08a5271c9f8b121b1b94dc90be21155c"
             role="button" aria-label='Копировать'>
            <i class="fas fa-copy fa-fw"></i>
          </a>
        </li>
      </ul>
    </div>
  </div>
</div>

<p>Где:</p>
<ul>
<li><code>[ABI]</code> - версия архитектуры. Список версий архитектур можно посмотреть ниже.</li>
</ul>
<h3 id="примеры">
  <a class="link-body-emphasis" href="#%d0%bf%d1%80%d0%b8%d0%bc%d0%b5%d1%80%d1%8b">Примеры</a>
</h3><p>Установить ядро <span class="shortcode shortcode-tag"><a href="/ru/tags/xanmod/" target="_blank">#XanMod</a></span> с версией архитектуры <code>x64v1</code>:</p>



<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-11 shortcode-codeblock-bash">
  <div class="d-flex overflow-hidden">
    <div class="flex-grow-1 rounded overflow-hidden" id="cp-29655ca9043cec231504b880fe585af6">
      
      <pre><code class='language-bash'>apt install linux-xanmod-x64v1</code></pre>
    </div>
    <div class="flex-shrink-0">
      <ul class="list-inline mb-0">
        <li class="list-inline-item" data-bs-tooltip data-bs-title='Копировать'>
          <a class="text-body" href="#"
             data-fn="clipboard preventDefault" data-clipboard-target="#cp-29655ca9043cec231504b880fe585af6"
             role="button" aria-label='Копировать'>
            <i class="fas fa-copy fa-fw"></i>
          </a>
        </li>
      </ul>
    </div>
  </div>
</div>

<p>Установить ядро <span class="shortcode shortcode-tag"><a href="/ru/tags/xanmod/" target="_blank">#XanMod</a></span> с версией архитектуры <code>x64v2</code>:</p>



<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-13 shortcode-codeblock-bash">
  <div class="d-flex overflow-hidden">
    <div class="flex-grow-1 rounded overflow-hidden" id="cp-2fadbf2f432e098460f0846b19b70aea">
      
      <pre><code class='language-bash'>apt install linux-xanmod-x64v2</code></pre>
    </div>
    <div class="flex-shrink-0">
      <ul class="list-inline mb-0">
        <li class="list-inline-item" data-bs-tooltip data-bs-title='Копировать'>
          <a class="text-body" href="#"
             data-fn="clipboard preventDefault" data-clipboard-target="#cp-2fadbf2f432e098460f0846b19b70aea"
             role="button" aria-label='Копировать'>
            <i class="fas fa-copy fa-fw"></i>
          </a>
        </li>
      </ul>
    </div>
  </div>
</div>

<p>Установить ядро <span class="shortcode shortcode-tag"><a href="/ru/tags/xanmod/" target="_blank">#XanMod</a></span> с версией архитектуры <code>x64v3</code>:</p>



<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-15 shortcode-codeblock-bash">
  <div class="d-flex overflow-hidden">
    <div class="flex-grow-1 rounded overflow-hidden" id="cp-e3c89909960dd3d6a1052613c7f5d4a8">
      
      <pre><code class='language-bash'>apt install linux-xanmod-x64v3</code></pre>
    </div>
    <div class="flex-shrink-0">
      <ul class="list-inline mb-0">
        <li class="list-inline-item" data-bs-tooltip data-bs-title='Копировать'>
          <a class="text-body" href="#"
             data-fn="clipboard preventDefault" data-clipboard-target="#cp-e3c89909960dd3d6a1052613c7f5d4a8"
             role="button" aria-label='Копировать'>
            <i class="fas fa-copy fa-fw"></i>
          </a>
        </li>
      </ul>
    </div>
  </div>
</div>

<p>Установить ядро <span class="shortcode shortcode-tag"><a href="/ru/tags/xanmod/" target="_blank">#XanMod</a></span> с версией архитектуры <code>x64v4</code>:</p>



<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-17 shortcode-codeblock-bash">
  <div class="d-flex overflow-hidden">
    <div class="flex-grow-1 rounded overflow-hidden" id="cp-a25b943c6a305177ff73d40f9fa692ac">
      
      <pre><code class='language-bash'>apt install linux-xanmod-x64v4</code></pre>
    </div>
    <div class="flex-shrink-0">
      <ul class="list-inline mb-0">
        <li class="list-inline-item" data-bs-tooltip data-bs-title='Копировать'>
          <a class="text-body" href="#"
             data-fn="clipboard preventDefault" data-clipboard-target="#cp-a25b943c6a305177ff73d40f9fa692ac"
             role="button" aria-label='Копировать'>
            <i class="fas fa-copy fa-fw"></i>
          </a>
        </li>
      </ul>
    </div>
  </div>
</div>

<p>Для установки Mainline-версии ядра команда будет такой:</p>



<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-18 shortcode-codeblock-bash">
  <div class="d-flex overflow-hidden">
    <div class="flex-grow-1 rounded overflow-hidden" id="cp-bda71abd990dfc3c9d161d87ef9781cc">
      
      <pre><code class='language-bash'>apt install linux-xanmod-edge-x64v3</code></pre>
    </div>
    <div class="flex-shrink-0">
      <ul class="list-inline mb-0">
        <li class="list-inline-item" data-bs-tooltip data-bs-title='Копировать'>
          <a class="text-body" href="#"
             data-fn="clipboard preventDefault" data-clipboard-target="#cp-bda71abd990dfc3c9d161d87ef9781cc"
             role="button" aria-label='Копировать'>
            <i class="fas fa-copy fa-fw"></i>
          </a>
        </li>
      </ul>
    </div>
  </div>
</div>

<h2 id="версии-архитектур-xanmod">
  <a class="link-body-emphasis" href="#%d0%b2%d0%b5%d1%80%d1%81%d0%b8%d0%b8-%d0%b0%d1%80%d1%85%d0%b8%d1%82%d0%b5%d0%ba%d1%82%d1%83%d1%80-xanmod">Версии архитектур XanMod</a>
</h2><p>Версия архитектуры зависит от ядра процессора и поддерживаемых им инструкций. Версию архитектуры можно узнать из списка ниже.</p>
<h3 id="x86-64-legacy">
  <a class="link-body-emphasis" href="#x86-64-legacy">x86-64 (LEGACY)</a>
</h3><p>Суффикс для установки ядра: <code>x64v1</code>.</p>
<p><strong>Поддерживаемые архитектуры:</strong></p>
<ul>
<li>AMD K8-family</li>
<li>AMD K10-family</li>
<li>AMD Family 10h (Barcelona)</li>
<li>Intel Pentium 4 / Xeon (Nocona)</li>
<li>Intel Core 2 (all variants)</li>
<li>All x86-64 CPUs</li>
</ul>
<h3 id="x86-64-v2">
  <a class="link-body-emphasis" href="#x86-64-v2">x86-64-v2</a>
</h3><p>Суффикс для установки ядра: <code>x64v2</code>.</p>
<p><strong>Поддерживаемые архитектуры:</strong></p>
<ul>
<li>AMD Family 14h (Bobcat)</li>
<li>AMD Family 16h (Jaguar)</li>
<li>AMD Family 15h (Bulldozer)</li>
<li>AMD Family 15h (Piledriver)</li>
<li>AMD Family 15h (Steamroller)</li>
<li>Intel 1st Gen Core (Nehalem)</li>
<li>Intel 1.5 Gen Core (Westmere)</li>
<li>Intel 2nd Gen Core (Sandybridge)</li>
<li>Intel 3rd Gen Core (Ivybridge)</li>
<li>Intel low-power Silvermont</li>
<li>Intel Goldmont (Apollo Lake)</li>
<li>Intel Goldmont (Denverton)</li>
<li>Intel Goldmont Plus (Gemini Lake)</li>
</ul>
<h3 id="x86-64-v3">
  <a class="link-body-emphasis" href="#x86-64-v3">x86-64-v3</a>
</h3><p>Суффикс для установки ядра: <code>x64v3</code>.</p>
<p><strong>Поддерживаемые архитектуры:</strong></p>
<ul>
<li>AMD Family 15h (Excavator)</li>
<li>AMD Family 17h (Zen)</li>
<li>AMD Family 17h (Zen+)</li>
<li>AMD Family 17h (Zen2)</li>
<li>AMD Family 19h (Zen3)</li>
<li>Intel 4th Gen Core (Haswell)</li>
<li>Intel 5th Gen Core (Broadwell)</li>
<li>Intel 6th Gen Core (Skylake)</li>
<li>Intel 7th Gen Core (Kaby Lake)</li>
<li>Intel 8/9th Gen Core (Coffee Lake)</li>
<li>Intel 10th Gen Core (Comet Lake)</li>
<li>Intel 12th Gen (Alder Lake)</li>
<li>Intel 13th Gen (Raptor Lake)</li>
<li>Intel 14th Gen (Meteor Lake)</li>
</ul>
<h3 id="x86-64-v4-avx-512">
  <a class="link-body-emphasis" href="#x86-64-v4-avx-512">x86-64-v4 (AVX-512)</a>
</h3><p>Суффикс для установки ядра: <code>x64v4</code>.</p>
<p><strong>Поддерживаемые архитектуры:</strong></p>
<ul>
<li>AMD Family 19h (Zen4)</li>
<li>Intel 6th Gen Core (Skylake X)</li>
<li>Intel 8th Gen Core i3 (Cannon Lake)</li>
<li>Intel Xeon / 10th Gen Core (Ice Lake)</li>
<li>Intel Xeon (Cascade Lake)</li>
<li>Intel Xeon (Cooper Lake)</li>
<li>Intel 3rd Gen 10nm++ (Tiger Lake)</li>
<li>Intel 4th Gen 10nm++ (Sapphire Rapids)</li>
<li>Intel 5th Gen 10nm++ (Emerald Rapids)</li>
<li>Intel 11th Gen (Rocket Lake)</li>
</ul>]]></turbo:content></item><item turbo="true"><title>Установка Vivaldi в Debian</title><link>https://lib.onl/ru/articles/2022/01/ddddd243-d182-5e26-a161-d2ea7812214a/</link><pubDate>Thu, 13 Jan 2022 22:44:01 +0000</pubDate><dc:creator>Kai Kimera</dc:creator><category>Linux</category><yandex:related><link url="https://lib.onl/ru/articles/2021/09/581804b8-0613-52a8-a5c4-fdae90e7bc8a/">Чёрный экран с курсором при старте GDM</link><link url="https://lib.onl/ru/articles/2021/09/1cf305cd-85d0-5e02-aabb-e01346bfee0f/">Установка Proxmox VE на Debian 11 (Bullseye)</link><link url="https://lib.onl/ru/articles/2021/09/ff829d15-4a19-52e3-a3aa-ad70aa38854a/">Debian: Wired Networks are Unmanaged</link><link url="https://lib.onl/ru/articles/2021/09/b2caccc7-92bf-57ed-970f-136c546f18e2/">Распаковка пакетов DEB / RPM</link><link url="https://lib.onl/ru/articles/2021/09/43b40b92-c29a-504b-87fa-5eac368dcf95/">Отключение установки дополнительных пакетов в Debian APT</link><link url="https://lib.onl/ru/articles/2021/09/aeed7c90-003a-532a-b2c4-3807aaee88fa/">dhclient отправляет 36-значный идентификатор вместо MAC</link></yandex:related><turbo:extendedHtml>true</turbo:extendedHtml><turbo:source>https://lib.onl/ru/articles/2022/01/ddddd243-d182-5e26-a161-d2ea7812214a/</turbo:source><turbo:topic>Установка Vivaldi в Debian</turbo:topic><turbo:content><![CDATA[<p>Привет всем! В этой небольшой заметке я приведу команду, при помощи которой можно добавить репозиторий браузера <span class="shortcode shortcode-tag"><a href="/ru/tags/vivaldi/" target="_blank">#Vivaldi</a></span> в <span class="shortcode shortcode-tag"><a href="/ru/tags/debian/" target="_blank">#Debian</a></span>.</p>
<p>Установочный пакет <span class="shortcode shortcode-tag"><a href="/ru/tags/vivaldi/" target="_blank">#Vivaldi</a></span> уже выполняет указанные действия, но для этого он задействует утилиту <code>apt-key</code>, которая в <span class="shortcode shortcode-tag"><a href="/ru/tags/debian/" target="_blank">#Debian</a></span> 11 имеет статус <code>deprecated</code>.</p>
<p>Однострочная команда по добавлению <span class="shortcode shortcode-tag"><a href="/ru/tags/vivaldi/" target="_blank">#Vivaldi</a></span> в репозиторий <span class="shortcode shortcode-tag"><a href="/ru/tags/debian/" target="_blank">#Debian</a></span>&rsquo;а приведена ниже. Она дробится на следующие под-команды:</p>
<ol>
<li>Добавление файла <code>vivaldi-archive.list</code> в директорию <code>/etc/apt/sources.list.d</code>.</li>
<li>Скачивание файла подписи <code>linux_signing_key.pub</code> и размещение его в директорию <code>/etc/apt/trusted.gpg.d</code> с названием <code>vivaldi-browser.gpg</code>.</li>
<li>Обновление информации из репозитория при помощи команды <code>apt update</code>.</li>
</ol>



<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-6 shortcode-codeblock-bash">
  <div class="d-flex overflow-hidden">
    <div class="flex-grow-1 rounded overflow-hidden" id="cp-95be974e3898b3fd024cbd8ca171d91e">
      
      <pre><code class='language-bash'>echo &#34;deb [signed-by=/etc/apt/trusted.gpg.d/vivaldi-browser.gpg arch=$(dpkg --print-architecture)] https://repo.vivaldi.com/archive/deb/ stable main&#34; | tee /etc/apt/sources.list.d/vivaldi-archive.list &amp;&amp; curl -fsSL &#39;https://repo.vivaldi.com/archive/linux_signing_key.pub&#39; | gpg --dearmor | tee /etc/apt/trusted.gpg.d/vivaldi-browser.gpg &gt; /dev/null &amp;&amp; apt update</code></pre>
    </div>
    <div class="flex-shrink-0">
      <ul class="list-inline mb-0">
        <li class="list-inline-item" data-bs-tooltip data-bs-title='Копировать'>
          <a class="text-body" href="#"
             data-fn="clipboard preventDefault" data-clipboard-target="#cp-95be974e3898b3fd024cbd8ca171d91e"
             role="button" aria-label='Копировать'>
            <i class="fas fa-copy fa-fw"></i>
          </a>
        </li>
      </ul>
    </div>
  </div>
</div>

<p>После выполнения команды, установка <span class="shortcode shortcode-tag"><a href="/ru/tags/vivaldi/" target="_blank">#Vivaldi</a></span> происходит таким образом:</p>



<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-8 shortcode-codeblock-bash">
  <div class="d-flex overflow-hidden">
    <div class="flex-grow-1 rounded overflow-hidden" id="cp-0227bc4941534fb2610e0c74a4b2ca04">
      
      <pre><code class='language-bash'>apt install vivaldi-stable</code></pre>
    </div>
    <div class="flex-shrink-0">
      <ul class="list-inline mb-0">
        <li class="list-inline-item" data-bs-tooltip data-bs-title='Копировать'>
          <a class="text-body" href="#"
             data-fn="clipboard preventDefault" data-clipboard-target="#cp-0227bc4941534fb2610e0c74a4b2ca04"
             role="button" aria-label='Копировать'>
            <i class="fas fa-copy fa-fw"></i>
          </a>
        </li>
      </ul>
    </div>
  </div>
</div>]]></turbo:content></item><item turbo="true"><title>Чёрный экран с курсором при старте GDM</title><link>https://lib.onl/ru/articles/2021/09/581804b8-0613-52a8-a5c4-fdae90e7bc8a/</link><pubDate>Thu, 30 Sep 2021 08:10:19 +0000</pubDate><dc:creator>Kai Kimera</dc:creator><category>Linux</category><yandex:related><link url="https://lib.onl/ru/articles/2021/09/ff829d15-4a19-52e3-a3aa-ad70aa38854a/">Debian: Wired Networks are Unmanaged</link><link url="https://lib.onl/ru/articles/2021/09/0d11ecc0-2714-5c5c-9b48-804f50419590/">Отключение режима Wayland в GDM</link><link url="https://lib.onl/ru/articles/2021/09/1cf305cd-85d0-5e02-aabb-e01346bfee0f/">Установка Proxmox VE на Debian 11 (Bullseye)</link><link url="https://lib.onl/ru/articles/2021/09/b2caccc7-92bf-57ed-970f-136c546f18e2/">Распаковка пакетов DEB / RPM</link><link url="https://lib.onl/ru/articles/2021/09/43b40b92-c29a-504b-87fa-5eac368dcf95/">Отключение установки дополнительных пакетов в Debian APT</link><link url="https://lib.onl/ru/articles/2021/09/aeed7c90-003a-532a-b2c4-3807aaee88fa/">dhclient отправляет 36-значный идентификатор вместо MAC</link><link url="https://lib.onl/ru/articles/2021/03/0a815547-4f18-52a0-9a99-c463421872ca/">Monero Unit</link></yandex:related><turbo:extendedHtml>true</turbo:extendedHtml><turbo:source>https://lib.onl/ru/articles/2021/09/581804b8-0613-52a8-a5c4-fdae90e7bc8a/</turbo:source><turbo:topic>Чёрный экран с курсором при старте GDM</turbo:topic><turbo:content><![CDATA[<p>На днях установил <span class="shortcode shortcode-tag"><a href="/ru/tags/debian/" target="_blank">#Debian</a></span> 11 на несколько ПК. Всё было отлично, кроме как на одном из ПК почему то <span class="shortcode shortcode-tag"><a href="/ru/tags/gdm/" target="_blank">#GDM</a></span> не стал загружаться. Чёрный экран с мигающем текстовым курсором&hellip;</p>
<p>На других ПК всё было нормально. Отличие проблемного ПК от остальных заключалось в том, что на проблемном ПК система была установлена на <span class="shortcode shortcode-tag"><a href="/ru/tags/ssd/" target="_blank">#SSD</a></span>. Может быть дело в этом. В интернете я нашёл похожую проблему. По сути, проблема заключается в том, что сам <span class="shortcode shortcode-tag"><a href="/ru/tags/gdm/" target="_blank">#GDM</a></span> запускается чуть раньше, чем начинается инициализация графической подсистемы. И на кой чёрт его несёт вперёд&hellip;</p>
<p>В общем, предлагают несколько решений.</p>
<h2 id="настройка-сервиса-gdm">
  <a class="link-body-emphasis" href="#%d0%bd%d0%b0%d1%81%d1%82%d1%80%d0%be%d0%b9%d0%ba%d0%b0-%d1%81%d0%b5%d1%80%d0%b2%d0%b8%d1%81%d0%b0-gdm">Настройка сервиса GDM</a>
</h2><p>Данный вариант решения проблемы предлагает отредактировать стартовые параметры сервиса <span class="shortcode shortcode-tag"><a href="/ru/tags/gdm/" target="_blank">#GDM</a></span>, чтобы тот запускался с небольшой задержкой и не лез вперёд остальной графической подсистемы.</p>
<p>В терминале нужно ввести от root&rsquo;а команду <code>systemctl edit gdm.service</code>, откроется редактор сервиса <span class="shortcode shortcode-tag"><a href="/ru/tags/gdm/" target="_blank">#GDM</a></span>. В нем необходимо добавить строку <code>ExecStartPre=/bin/sleep 2</code>, которая создаёт задержку перед запуском самого <span class="shortcode shortcode-tag"><a href="/ru/tags/gdm/" target="_blank">#GDM</a></span>. Примерно вот так:</p>



<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-7 shortcode-codeblock-ini">
  <div class="d-flex overflow-hidden">
    <div class="flex-grow-1 rounded overflow-hidden" id="cp-4e57444ddc473a0dd65a4008f7ca91a4">
      
      <pre><code class='language-ini'>### Anything between here and the comment below will become the new contents of the file

[Service]
ExecStartPre=/bin/sleep 2

### Lines below this comment will be discarded</code></pre>
    </div>
    <div class="flex-shrink-0">
      <ul class="list-inline mb-0">
        <li class="list-inline-item" data-bs-tooltip data-bs-title='Копировать'>
          <a class="text-body" href="#"
             data-fn="clipboard preventDefault" data-clipboard-target="#cp-4e57444ddc473a0dd65a4008f7ca91a4"
             role="button" aria-label='Копировать'>
            <i class="fas fa-copy fa-fw"></i>
          </a>
        </li>
      </ul>
    </div>
  </div>
</div>

<p>Таким образом GDM начинает запускаться после того, как инициализируется графическая подсистема.</p>
<p>Ещё одно исправление <a title="" href="https://gitlab.gnome.org/GNOME/gdm/-/issues/662#note_993169" target="_blank" rel="noopener noreferrer">предложили</a> в баг-трекере <span class="shortcode shortcode-tag"><a href="/ru/tags/gnome/" target="_blank">#GNOME</a></span> / <span class="shortcode shortcode-tag"><a href="/ru/tags/gdm/" target="_blank">#GDM</a></span>. Вместо торможения загрузки GDM, необходимо добавить следующие строки:</p>



<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-10 shortcode-codeblock-ini">
  <div class="d-flex overflow-hidden">
    <div class="flex-grow-1 rounded overflow-hidden" id="cp-7a81de28e93761c8def130f748d2e9e5">
      
      <pre><code class='language-ini'>[Unit]
Wants=systemd-udev-trigger.service systemd-udev-settle.service
After=systemd-udev-trigger.service systemd-udev-settle.service</code></pre>
    </div>
    <div class="flex-shrink-0">
      <ul class="list-inline mb-0">
        <li class="list-inline-item" data-bs-tooltip data-bs-title='Копировать'>
          <a class="text-body" href="#"
             data-fn="clipboard preventDefault" data-clipboard-target="#cp-7a81de28e93761c8def130f748d2e9e5"
             role="button" aria-label='Копировать'>
            <i class="fas fa-copy fa-fw"></i>
          </a>
        </li>
      </ul>
    </div>
  </div>
</div>

<p>Но это не совсем корректное исправление (хотя исправление, изложенное выше, тоже трудно назвать правильным), так как после применения этих строк, появляется ошибка:</p>






<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-11 shortcode-codeblock-terminal
shortcode-codeblock-terminal-linux shortcode-codeblock-terminal-linux-user">
  <div class="card overflow-hidden" data-bs-theme="dark">
    <div class="card-header">
      <div class="d-flex align-items-center">
        <div class="flex-shrink-0 ">
          <i class="fas fa-terminal fa-fw"></i>
        </div>
        <div class="flex-grow-1 mx-2">
          <h5 class="mb-0">Терминал</h5>
        </div>
        <div class="flex-shrink-0">
          <ul class="list-inline mb-0">
            <li class="list-inline-item" data-bs-tooltip data-bs-title='Копировать'>
              <a class="text-body" href="#"
                 data-fn="clipboard preventDefault" data-clipboard-target="#cp-c70b23821c4749f3372dd04cb63f4501"
                 role="button" aria-label='Копировать'>
                <i class="fas fa-copy fa-fw"></i>
              </a>
            </li>
          </ul>
        </div>
      </div>
    </div>
    <div class="card-body p-0" id="cp-c70b23821c4749f3372dd04cb63f4501">
      <pre><code class="language-plaintext">Dec 27 22:23:48 oleksandr-xps15 udevadm[260]: systemd-udev-settle.service is deprecated. Please fix gdm.service not to pull it in.</code></pre>
    </div>
  </div>
</div>

<h2 id="указание-порядка-инициализации-графической-подсистемы">
  <a class="link-body-emphasis" href="#%d1%83%d0%ba%d0%b0%d0%b7%d0%b0%d0%bd%d0%b8%d0%b5-%d0%bf%d0%be%d1%80%d1%8f%d0%b4%d0%ba%d0%b0-%d0%b8%d0%bd%d0%b8%d1%86%d0%b8%d0%b0%d0%bb%d0%b8%d0%b7%d0%b0%d1%86%d0%b8%d0%b8-%d0%b3%d1%80%d0%b0%d1%84%d0%b8%d1%87%d0%b5%d1%81%d0%ba%d0%be%d0%b9-%d0%bf%d0%be%d0%b4%d1%81%d0%b8%d1%81%d1%82%d0%b5%d0%bc%d1%8b">Указание порядка инициализации графической подсистемы</a>
</h2><p>Этот вариант решения проблемы подходит для <strong>Arch Linux</strong>. Необходимо в файле <code>/etc/mkinitcpio.conf</code> добавить в массив <code>MODULES</code> свою графическую подсистему, чтобы та запускалась раньше, чем <span class="shortcode shortcode-tag"><a href="/ru/tags/gdm/" target="_blank">#GDM</a></span>. Например:</p>



<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-13 shortcode-codeblock-text">
  <div class="d-flex overflow-hidden">
    <div class="flex-grow-1 rounded overflow-hidden" id="cp-b8b3d9acb3baf44f8c119219acceb279">
      
      <pre><code class='language-text'>MODULES=(amdgpu)</code></pre>
    </div>
    <div class="flex-shrink-0">
      <ul class="list-inline mb-0">
        <li class="list-inline-item" data-bs-tooltip data-bs-title='Копировать'>
          <a class="text-body" href="#"
             data-fn="clipboard preventDefault" data-clipboard-target="#cp-b8b3d9acb3baf44f8c119219acceb279"
             role="button" aria-label='Копировать'>
            <i class="fas fa-copy fa-fw"></i>
          </a>
        </li>
      </ul>
    </div>
  </div>
</div>

<p>Можно указать другие графические подсистемы, всё зависит от видеокарты, установленной в ПК:</p>
<ul>
<li><code>amdgpu</code> - для современных видеокарт AMD.</li>
<li><code>radeon</code> - для устаревших видеокарт AMD.</li>
<li><code>nouveau</code> - для Nvidia Nouveau.</li>
<li><code>i915</code> - для Intel.</li>
<li><code>mgag200</code> - для видеокарт Matrox.</li>
</ul>
<p>Если в системе используется <span class="shortcode shortcode-tag"><a href="/ru/tags/intel/" target="_blank">#Intel</a></span> в качестве графики и в модулях прописан <code>i915</code>, то могут появится ошибки <span class="shortcode shortcode-tag">ACPI</span>. Для исправления этих ошибок необходимо добавить <code>intel_agp</code> перед <code>i915</code>. Чтобы проверить корректность загрузки модуля, можно ввести команду <code>lsmod | grep intel_agp</code>.</p>]]></turbo:content></item><item turbo="true"><title>Отключение режима Wayland в GDM</title><link>https://lib.onl/ru/articles/2021/09/0d11ecc0-2714-5c5c-9b48-804f50419590/</link><pubDate>Thu, 30 Sep 2021 07:51:30 +0000</pubDate><dc:creator>Kai Kimera</dc:creator><category>Linux</category><turbo:extendedHtml>true</turbo:extendedHtml><turbo:source>https://lib.onl/ru/articles/2021/09/0d11ecc0-2714-5c5c-9b48-804f50419590/</turbo:source><turbo:topic>Отключение режима Wayland в GDM</turbo:topic><turbo:content><![CDATA[<p>Использовать <span class="shortcode shortcode-tag"><a href="/ru/tags/wayland/" target="_blank">#Wayland</a></span> мне, пока что, нет необходимости. Поэтому, я решил его отключить в <span class="shortcode shortcode-tag"><a href="/ru/tags/gdm/" target="_blank">#GDM</a></span>.</p>
<p>Для того, чтобы отключить выбор режима <span class="shortcode shortcode-tag"><a href="/ru/tags/wayland/" target="_blank">#Wayland</a></span> в <span class="shortcode shortcode-tag"><a href="/ru/tags/gdm/" target="_blank">#GDM</a></span>, необходимо в файле <code>/etc/gdm3/daemon.conf</code> раскомментировать строку:</p>



<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-4 shortcode-codeblock-ini">
  <div class="d-flex overflow-hidden">
    <div class="flex-grow-1 rounded overflow-hidden" id="cp-3a6fe27791bd73d34e41d75508eb70a4">
      
      <pre><code class='language-ini'># WaylandEnable=false</code></pre>
    </div>
    <div class="flex-shrink-0">
      <ul class="list-inline mb-0">
        <li class="list-inline-item" data-bs-tooltip data-bs-title='Копировать'>
          <a class="text-body" href="#"
             data-fn="clipboard preventDefault" data-clipboard-target="#cp-3a6fe27791bd73d34e41d75508eb70a4"
             role="button" aria-label='Копировать'>
            <i class="fas fa-copy fa-fw"></i>
          </a>
        </li>
      </ul>
    </div>
  </div>
</div>

<p>Должно получится так:</p>



<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-5 shortcode-codeblock-ini">
  <div class="d-flex overflow-hidden">
    <div class="flex-grow-1 rounded overflow-hidden" id="cp-142d42cfc46f7d4632c2e148b8b859b2">
      
      <pre><code class='language-ini'>WaylandEnable=false</code></pre>
    </div>
    <div class="flex-shrink-0">
      <ul class="list-inline mb-0">
        <li class="list-inline-item" data-bs-tooltip data-bs-title='Копировать'>
          <a class="text-body" href="#"
             data-fn="clipboard preventDefault" data-clipboard-target="#cp-142d42cfc46f7d4632c2e148b8b859b2"
             role="button" aria-label='Копировать'>
            <i class="fas fa-copy fa-fw"></i>
          </a>
        </li>
      </ul>
    </div>
  </div>
</div>

<p>Таким образом даём понять <span class="shortcode shortcode-tag"><a href="/ru/tags/gdm/" target="_blank">#GDM</a></span>, что мы не желаем использовать <span class="shortcode shortcode-tag"><a href="/ru/tags/wayland/" target="_blank">#Wayland</a></span>.</p>]]></turbo:content></item><item turbo="true"><title>Установка Proxmox VE на Debian 11 (Bullseye)</title><link>https://lib.onl/ru/articles/2021/09/1cf305cd-85d0-5e02-aabb-e01346bfee0f/</link><pubDate>Sun, 12 Sep 2021 21:36:02 +0000</pubDate><dc:creator>Kai Kimera</dc:creator><category>Linux</category><category>В доработке</category><yandex:related><link url="https://lib.onl/ru/articles/2021/09/ff829d15-4a19-52e3-a3aa-ad70aa38854a/">Debian: Wired Networks are Unmanaged</link><link url="https://lib.onl/ru/articles/2021/09/b2caccc7-92bf-57ed-970f-136c546f18e2/">Распаковка пакетов DEB / RPM</link><link url="https://lib.onl/ru/articles/2021/09/43b40b92-c29a-504b-87fa-5eac368dcf95/">Отключение установки дополнительных пакетов в Debian APT</link><link url="https://lib.onl/ru/articles/2021/09/aeed7c90-003a-532a-b2c4-3807aaee88fa/">dhclient отправляет 36-значный идентификатор вместо MAC</link></yandex:related><turbo:extendedHtml>true</turbo:extendedHtml><turbo:source>https://lib.onl/ru/articles/2021/09/1cf305cd-85d0-5e02-aabb-e01346bfee0f/</turbo:source><turbo:topic>Установка Proxmox VE на Debian 11 (Bullseye)</turbo:topic><turbo:content><![CDATA[<p>В этой небольшой заметке, я расскажу как установить <span class="shortcode shortcode-tag"><a href="/ru/tags/proxmox/" target="_blank">#Proxmox</a></span> VE на чистый <span class="shortcode shortcode-tag"><a href="/ru/tags/debian/" target="_blank">#Debian</a></span> 11 (<span class="shortcode shortcode-tag">Bullseye</span>).</p>
<h2 id="подготовка">
  <a class="link-body-emphasis" href="#%d0%bf%d0%be%d0%b4%d0%b3%d0%be%d1%82%d0%be%d0%b2%d0%ba%d0%b0">Подготовка</a>
</h2><p>Для начала необходимо отредактировать файл <code>/etc/hosts</code>, прописав туда <span class="shortcode shortcode-tag"><a href="/ru/tags/ip/" target="_blank">#IP</a></span> сервера, на который будет устанавливаться наш <span class="shortcode shortcode-tag"><a href="/ru/tags/proxmox/" target="_blank">#Proxmox</a></span> VE:</p>



<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-5 shortcode-codeblock-text">
  <div class="d-flex overflow-hidden">
    <div class="flex-grow-1 rounded overflow-hidden" id="cp-b947c0cedde665ac433bb18d4725e2a4">
      
      <pre><code class='language-text'>127.0.0.1   localhost
127.0.1.1   localhost.localdomain     localhost

# Proxmox
10.0.1.1    srv-vm.home.local         srv-vm</code></pre>
    </div>
    <div class="flex-shrink-0">
      <ul class="list-inline mb-0">
        <li class="list-inline-item" data-bs-tooltip data-bs-title='Копировать'>
          <a class="text-body" href="#"
             data-fn="clipboard preventDefault" data-clipboard-target="#cp-b947c0cedde665ac433bb18d4725e2a4"
             role="button" aria-label='Копировать'>
            <i class="fas fa-copy fa-fw"></i>
          </a>
        </li>
      </ul>
    </div>
  </div>
</div>

<p>Для проверки, можно выполнить команду <code>hostname --ip-address</code>, которая вернёт <span class="shortcode shortcode-tag"><a href="/ru/tags/ip/" target="_blank">#IP</a></span> сервера, указанного в <code>/etc/hosts</code> выше.</p>
<h2 id="добавление-репозиториев">
  <a class="link-body-emphasis" href="#%d0%b4%d0%be%d0%b1%d0%b0%d0%b2%d0%bb%d0%b5%d0%bd%d0%b8%d0%b5-%d1%80%d0%b5%d0%bf%d0%be%d0%b7%d0%b8%d1%82%d0%be%d1%80%d0%b8%d0%b5%d0%b2">Добавление репозиториев</a>
</h2><p>Добавим репозиторий <span class="shortcode shortcode-tag"><a href="/ru/tags/proxmox/" target="_blank">#Proxmox</a></span> VE:</p>



<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-8 shortcode-codeblock-bash">
  <div class="d-flex overflow-hidden">
    <div class="flex-grow-1 rounded overflow-hidden" id="cp-50520b67004afb71f698f1e2c952ab57">
      
      <pre><code class='language-bash'>echo &#34;deb [arch=amd64] http://download.proxmox.com/debian/pve bullseye pve-no-subscription&#34; &gt; /etc/apt/sources.list.d/pve.list</code></pre>
    </div>
    <div class="flex-shrink-0">
      <ul class="list-inline mb-0">
        <li class="list-inline-item" data-bs-tooltip data-bs-title='Копировать'>
          <a class="text-body" href="#"
             data-fn="clipboard preventDefault" data-clipboard-target="#cp-50520b67004afb71f698f1e2c952ab57"
             role="button" aria-label='Копировать'>
            <i class="fas fa-copy fa-fw"></i>
          </a>
        </li>
      </ul>
    </div>
  </div>
</div>

<p>Скачаем и установим ключ репозитория:</p>



<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-9 shortcode-codeblock-bash">
  <div class="d-flex overflow-hidden">
    <div class="flex-grow-1 rounded overflow-hidden" id="cp-752d930c87c1c69096fa374e3644bd56">
      
      <pre><code class='language-bash'>curl &#39;https://enterprise.proxmox.com/debian/proxmox-release-bullseye.gpg&#39; -o /etc/apt/trusted.gpg.d/pve.gpg</code></pre>
    </div>
    <div class="flex-shrink-0">
      <ul class="list-inline mb-0">
        <li class="list-inline-item" data-bs-tooltip data-bs-title='Копировать'>
          <a class="text-body" href="#"
             data-fn="clipboard preventDefault" data-clipboard-target="#cp-752d930c87c1c69096fa374e3644bd56"
             role="button" aria-label='Копировать'>
            <i class="fas fa-copy fa-fw"></i>
          </a>
        </li>
      </ul>
    </div>
  </div>
</div>

<p>Обновим базу пакетов <span class="shortcode shortcode-tag"><a href="/ru/tags/apt/" target="_blank">#APT</a></span> и саму систему:</p>



<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-11 shortcode-codeblock-bash">
  <div class="d-flex overflow-hidden">
    <div class="flex-grow-1 rounded overflow-hidden" id="cp-55098e4038f9bf9702764ee4f68d0611">
      
      <pre><code class='language-bash'>apt update &amp;&amp; apt full-upgrade</code></pre>
    </div>
    <div class="flex-shrink-0">
      <ul class="list-inline mb-0">
        <li class="list-inline-item" data-bs-tooltip data-bs-title='Копировать'>
          <a class="text-body" href="#"
             data-fn="clipboard preventDefault" data-clipboard-target="#cp-55098e4038f9bf9702764ee4f68d0611"
             role="button" aria-label='Копировать'>
            <i class="fas fa-copy fa-fw"></i>
          </a>
        </li>
      </ul>
    </div>
  </div>
</div>

<h2 id="установка-пакетов">
  <a class="link-body-emphasis" href="#%d1%83%d1%81%d1%82%d0%b0%d0%bd%d0%be%d0%b2%d0%ba%d0%b0-%d0%bf%d0%b0%d0%ba%d0%b5%d1%82%d0%be%d0%b2">Установка пакетов</a>
</h2><p>Начнём установку пакетов командой:</p>



<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-12 shortcode-codeblock-bash">
  <div class="d-flex overflow-hidden">
    <div class="flex-grow-1 rounded overflow-hidden" id="cp-cd29eb0d510d055cea3adec565bb723b">
      
      <pre><code class='language-bash'>apt install proxmox-ve postfix open-iscsi</code></pre>
    </div>
    <div class="flex-shrink-0">
      <ul class="list-inline mb-0">
        <li class="list-inline-item" data-bs-tooltip data-bs-title='Копировать'>
          <a class="text-body" href="#"
             data-fn="clipboard preventDefault" data-clipboard-target="#cp-cd29eb0d510d055cea3adec565bb723b"
             role="button" aria-label='Копировать'>
            <i class="fas fa-copy fa-fw"></i>
          </a>
        </li>
      </ul>
    </div>
  </div>
</div>

<p>Стоит заметить, что устанавливается <span class="shortcode shortcode-tag"><a href="/ru/tags/postfix/" target="_blank">#Postfix</a></span>, он необходим для отправки писем от <span class="shortcode shortcode-tag"><a href="/ru/tags/proxmox/" target="_blank">#Proxmox</a></span> VE. Но мне в локальной сети такая функция не нужна. При установке, <span class="shortcode shortcode-tag"><a href="/ru/tags/postfix/" target="_blank">#Postfix</a></span> спросит в каком режиме ему необходимо будет работать. Я выбираю <strong>local only</strong>.</p>
<h2 id="исправление-ошибок">
  <a class="link-body-emphasis" href="#%d0%b8%d1%81%d0%bf%d1%80%d0%b0%d0%b2%d0%bb%d0%b5%d0%bd%d0%b8%d0%b5-%d0%be%d1%88%d0%b8%d0%b1%d0%be%d0%ba">Исправление ошибок</a>
</h2><p>После установки <span class="shortcode shortcode-tag"><a href="/ru/tags/proxmox/" target="_blank">#Proxmox</a></span> VE через пакетны менеджер <span class="shortcode shortcode-tag"><a href="/ru/tags/apt/" target="_blank">#APT</a></span>, я столкнулся с некоторыми проблемами. Не знаю, может быть они будут отсутствовать, если устанавливать <span class="shortcode shortcode-tag"><a href="/ru/tags/proxmox/" target="_blank">#Proxmox</a></span> VE при помощи его отдельного файла <span class="shortcode shortcode-tag">ISO</span>&hellip;</p>
<h3 id="lvm2-activation-generator-lvmconfig-failed">
  <a class="link-body-emphasis" href="#lvm2-activation-generator-lvmconfig-failed">lvm2-activation-generator: lvmconfig failed</a>
</h3><p>Для исправления ошибки <code>lvm2-activation-generator: lvmconfig failed</code>, необходимо в файле <code>/etc/lvm/lvm.conf</code> изменить параметр <code>event_activation</code>, а именно рас-комментировать и установить в <code>0</code>:</p>



<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-20 shortcode-codeblock-text">
  <div class="d-flex overflow-hidden">
    <div class="flex-grow-1 rounded overflow-hidden" id="cp-a91050a5d4ef74930ae0da49d5a58218">
      
      <pre><code class='language-text'>global {
  &lt;...&gt;
  # Configuration option global/event_activation.
  # Activate LVs based on system-generated device events.
  # When a device appears on the system, a system-generated event runs
  # the pvscan command to activate LVs if the new PV completes the VG.
  # Use auto_activation_volume_list to select which LVs should be
  # activated from these events (the default is all.)
  # When event_activation is disabled, the system will generally run
  # a direct activation command to activate LVs in complete VGs.
  # This configuration option has an automatic default value.
  # event_activation = 1
  &lt;...&gt;
}</code></pre>
    </div>
    <div class="flex-shrink-0">
      <ul class="list-inline mb-0">
        <li class="list-inline-item" data-bs-tooltip data-bs-title='Копировать'>
          <a class="text-body" href="#"
             data-fn="clipboard preventDefault" data-clipboard-target="#cp-a91050a5d4ef74930ae0da49d5a58218"
             role="button" aria-label='Копировать'>
            <i class="fas fa-copy fa-fw"></i>
          </a>
        </li>
      </ul>
    </div>
  </div>
</div>




<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-21 shortcode-codeblock-text">
  <div class="d-flex overflow-hidden">
    <div class="flex-grow-1 rounded overflow-hidden" id="cp-a9478538f6f81fece732ac4fbef3a1c3">
      
      <pre><code class='language-text'>global {
  &lt;...&gt;
  # Configuration option global/event_activation.
  # Activate LVs based on system-generated device events.
  # When a device appears on the system, a system-generated event runs
  # the pvscan command to activate LVs if the new PV completes the VG.
  # Use auto_activation_volume_list to select which LVs should be
  # activated from these events (the default is all.)
  # When event_activation is disabled, the system will generally run
  # a direct activation command to activate LVs in complete VGs.
  # This configuration option has an automatic default value.
  event_activation = 0
  &lt;...&gt;
}</code></pre>
    </div>
    <div class="flex-shrink-0">
      <ul class="list-inline mb-0">
        <li class="list-inline-item" data-bs-tooltip data-bs-title='Копировать'>
          <a class="text-body" href="#"
             data-fn="clipboard preventDefault" data-clipboard-target="#cp-a9478538f6f81fece732ac4fbef3a1c3"
             role="button" aria-label='Копировать'>
            <i class="fas fa-copy fa-fw"></i>
          </a>
        </li>
      </ul>
    </div>
  </div>
</div>

<h3 id="не-поднимается--интерфейс">
  <a class="link-body-emphasis" href="#%d0%bd%d0%b5-%d0%bf%d0%be%d0%b4%d0%bd%d0%b8%d0%bc%d0%b0%d0%b5%d1%82%d1%81%d1%8f--%d0%b8%d0%bd%d1%82%d0%b5%d1%80%d1%84%d0%b5%d0%b9%d1%81">Не поднимается  интерфейс</a>
</h3><p>После установки, у меня перестал автоматически подниматься сетевой интерфейс. Может быть, в отдельном образе <span class="shortcode shortcode-tag">ISO</span> <span class="shortcode shortcode-tag"><a href="/ru/tags/proxmox/" target="_blank">#Proxmox</a></span> VE такой проблемы нет, потому что при установке с отдельного образа <span class="shortcode shortcode-tag">ISO</span>, он запрашивает у администратора параметры сети. Но если устанавливать <span class="shortcode shortcode-tag"><a href="/ru/tags/proxmox/" target="_blank">#Proxmox</a></span> VE через пакетную систему Debian, то никаких запросов не появляется. В общем, я сделал так (<code>/etc/network/interfaces</code>):</p>



<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-26 shortcode-codeblock-text">
  <div class="d-flex overflow-hidden">
    <div class="flex-grow-1 rounded overflow-hidden" id="cp-4e74c50c5e2f9588c6eca4e4ee694bc3">
      
      <pre><code class='language-text'>auto lo
iface lo inet loopback

iface enp3s0 inet manual

auto vmbr0
iface vmbr0 inet static
  address 10.0.1.1/16
  gateway 10.0.0.1
  bridge-ports enp3s0
  bridge-stp off
  bridge-fd 0</code></pre>
    </div>
    <div class="flex-shrink-0">
      <ul class="list-inline mb-0">
        <li class="list-inline-item" data-bs-tooltip data-bs-title='Копировать'>
          <a class="text-body" href="#"
             data-fn="clipboard preventDefault" data-clipboard-target="#cp-4e74c50c5e2f9588c6eca4e4ee694bc3"
             role="button" aria-label='Копировать'>
            <i class="fas fa-copy fa-fw"></i>
          </a>
        </li>
      </ul>
    </div>
  </div>
</div>

<p>Конкретно, тут я добавил блок виртуального соединения:</p>



<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-27 shortcode-codeblock-text">
  <div class="d-flex overflow-hidden">
    <div class="flex-grow-1 rounded overflow-hidden" id="cp-be231bb1dcb8c04a758d19088198ef54">
      
      <pre><code class='language-text'>auto vmbr0
iface vmbr0 inet static
  address 10.0.1.1/16
  gateway 10.0.0.1
  bridge-ports enp3s0
  bridge-stp off
  bridge-fd 0</code></pre>
    </div>
    <div class="flex-shrink-0">
      <ul class="list-inline mb-0">
        <li class="list-inline-item" data-bs-tooltip data-bs-title='Копировать'>
          <a class="text-body" href="#"
             data-fn="clipboard preventDefault" data-clipboard-target="#cp-be231bb1dcb8c04a758d19088198ef54"
             role="button" aria-label='Копировать'>
            <i class="fas fa-copy fa-fw"></i>
          </a>
        </li>
      </ul>
    </div>
  </div>
</div>

<p>Где указал мост с физической картой <code>enp3s0</code>. Саму же карту <code>enp3s0</code> я перевёл в режим <code>manual</code>. После этого, сетевой интерфейс на сервере заработал в штатном режиме.</p>
<p>На этом консольная настройка сервера виртуализации закончена. Настройка самого <span class="shortcode shortcode-tag"><a href="/ru/tags/proxmox/" target="_blank">#Proxmox</a></span>&rsquo;а можно выполнять уже в удобном web-интерфейсе.</p>]]></turbo:content></item><item turbo="true"><title>Debian: Wired Networks are Unmanaged</title><link>https://lib.onl/ru/articles/2021/09/ff829d15-4a19-52e3-a3aa-ad70aa38854a/</link><pubDate>Thu, 09 Sep 2021 19:14:12 +0000</pubDate><dc:creator>Kai Kimera</dc:creator><category>Linux</category><yandex:related><link url="https://lib.onl/ru/articles/2021/09/b2caccc7-92bf-57ed-970f-136c546f18e2/">Распаковка пакетов DEB / RPM</link><link url="https://lib.onl/ru/articles/2021/09/43b40b92-c29a-504b-87fa-5eac368dcf95/">Отключение установки дополнительных пакетов в Debian APT</link><link url="https://lib.onl/ru/articles/2021/09/aeed7c90-003a-532a-b2c4-3807aaee88fa/">dhclient отправляет 36-значный идентификатор вместо MAC</link><link url="https://lib.onl/ru/articles/2021/03/0a815547-4f18-52a0-9a99-c463421872ca/">Monero Unit</link></yandex:related><turbo:extendedHtml>true</turbo:extendedHtml><turbo:source>https://lib.onl/ru/articles/2021/09/ff829d15-4a19-52e3-a3aa-ad70aa38854a/</turbo:source><turbo:topic>Debian: Wired Networks are Unmanaged</turbo:topic><turbo:content><![CDATA[<p>При базовой установке <span class="shortcode shortcode-tag"><a href="/ru/tags/debian/" target="_blank">#Debian</a></span>, Network Manager не устанавливается и, соответственно, он не управляет сетевой конфигурацией. Исправим данную ситуацию&hellip;</p>
<p>Лично я люблю ставить систему в минимальной комплектации. У меня есть <a title="" href="https://uaik.github.io/" target="_blank" rel="noopener noreferrer">отдельный ресурс</a> со сценариями автоматической установки. Это шаблоны, которые позволяют поставить систему в автоматическом режиме и с минимальным набором компонентов. В основном, такие шаблоны полезны для серверов. Однако, для домашнего компьютера тоже вполне подойдут. Но после установки домашней системы через такой шаблон, потребуется небольшая корректировка.</p>
<p>Итак, установим Network Manager при помощи пакетного менеджера <span class="shortcode shortcode-tag"><a href="/ru/tags/apt/" target="_blank">#APT</a></span>:</p>



<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-2 shortcode-codeblock-bash">
  <div class="d-flex overflow-hidden">
    <div class="flex-grow-1 rounded overflow-hidden" id="cp-9e8e2f410ed85289e23c6bee86844600">
      
      <pre><code class='language-bash'>apt install network-manager</code></pre>
    </div>
    <div class="flex-shrink-0">
      <ul class="list-inline mb-0">
        <li class="list-inline-item" data-bs-tooltip data-bs-title='Копировать'>
          <a class="text-body" href="#"
             data-fn="clipboard preventDefault" data-clipboard-target="#cp-9e8e2f410ed85289e23c6bee86844600"
             role="button" aria-label='Копировать'>
            <i class="fas fa-copy fa-fw"></i>
          </a>
        </li>
      </ul>
    </div>
  </div>
</div>

<p>Но этого недостаточно. Система будет говорить, что &ldquo;Wired Networks are Unmanaged&rdquo;, потому что всё ещё сетевой конфигурацией управляет не Network Manager. Для исправления этой ситуации, необходимо в <code>/etc/NetworkManager/NetworkManager.conf</code> изменить <code>managed=false</code> на <code>managed=true</code>.</p>
<p>Далее, перезапустить службу:</p>



<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-3 shortcode-codeblock-bash">
  <div class="d-flex overflow-hidden">
    <div class="flex-grow-1 rounded overflow-hidden" id="cp-57d54dbaf45d693e7f0c6409e4061c18">
      
      <pre><code class='language-bash'>service NetworkManager restart</code></pre>
    </div>
    <div class="flex-shrink-0">
      <ul class="list-inline mb-0">
        <li class="list-inline-item" data-bs-tooltip data-bs-title='Копировать'>
          <a class="text-body" href="#"
             data-fn="clipboard preventDefault" data-clipboard-target="#cp-57d54dbaf45d693e7f0c6409e4061c18"
             role="button" aria-label='Копировать'>
            <i class="fas fa-copy fa-fw"></i>
          </a>
        </li>
      </ul>
    </div>
  </div>
</div>

<p>На этом всё. Теперь сетевой конфигурацией управляет Network Manager.</p>]]></turbo:content></item><item turbo="true"><title>Распаковка пакетов DEB / RPM</title><link>https://lib.onl/ru/articles/2021/09/b2caccc7-92bf-57ed-970f-136c546f18e2/</link><pubDate>Wed, 08 Sep 2021 09:39:36 +0000</pubDate><dc:creator>Kai Kimera</dc:creator><category>Linux</category><yandex:related><link url="https://lib.onl/ru/articles/2021/09/43b40b92-c29a-504b-87fa-5eac368dcf95/">Отключение установки дополнительных пакетов в Debian APT</link><link url="https://lib.onl/ru/articles/2021/09/aeed7c90-003a-532a-b2c4-3807aaee88fa/">dhclient отправляет 36-значный идентификатор вместо MAC</link><link url="https://lib.onl/ru/articles/2021/05/0acd3f9d-07b7-52b8-9fac-b5cb1cc579e0/">Обновление Fedora Linux до актуальной версии</link><link url="https://lib.onl/ru/articles/2020/06/59781965-afe7-5dd5-9798-d1c5ba6cdafd/">Первичная настройка UAIK</link></yandex:related><turbo:extendedHtml>true</turbo:extendedHtml><turbo:source>https://lib.onl/ru/articles/2021/09/b2caccc7-92bf-57ed-970f-136c546f18e2/</turbo:source><turbo:topic>Распаковка пакетов DEB / RPM</turbo:topic><turbo:content><![CDATA[<p>Я собираю пакеты для <span class="shortcode shortcode-tag"><a href="/ru/tags/debian/" target="_blank">#Debian</a></span> и <span class="shortcode shortcode-tag">RHEL</span>. И зачастую, мне необходимо посмотреть содержимое собранного пакета, чтобы удостоверится в правильности сборки и корректности расположения файлов внутри пакета. В этой статье кратно расскажу, как и при помощи чего можно посмотреть собранные пакеты.</p>
<h2 id="deb">
  <a class="link-body-emphasis" href="#deb">DEB</a>
</h2><p>Пакет <code>.deb</code> архивируется при помощи <a title="" href="https://en.wikipedia.org/wiki/Ar_%28Unix%29" target="_blank" rel="noopener noreferrer">ar</a>. Соответственно, распаковать пакет тоже следует через данный архиватор:</p>



<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-2 shortcode-codeblock-bash">
  <div class="d-flex overflow-hidden">
    <div class="flex-grow-1 rounded overflow-hidden" id="cp-32e8ef4d0f3be87f7a3dbcbfcfb3b261">
      
      <pre><code class='language-bash'>ar x example.deb</code></pre>
    </div>
    <div class="flex-shrink-0">
      <ul class="list-inline mb-0">
        <li class="list-inline-item" data-bs-tooltip data-bs-title='Копировать'>
          <a class="text-body" href="#"
             data-fn="clipboard preventDefault" data-clipboard-target="#cp-32e8ef4d0f3be87f7a3dbcbfcfb3b261"
             role="button" aria-label='Копировать'>
            <i class="fas fa-copy fa-fw"></i>
          </a>
        </li>
      </ul>
    </div>
  </div>
</div>

<ul>
<li><code>debian-binary</code> – файл, содержащий версию формата <code>.deb</code>.</li>
<li><code>control.tar.xz</code> – файл, содержащий md5sums и директорию для сборки пакета.</li>
<li><code>data.tar.xz</code> – архив, содержащий все файлы, которые должны быть установлены в системе при установке пакета.</li>
</ul>
<h2 id="rpm">
  <a class="link-body-emphasis" href="#rpm">RPM</a>
</h2><p>Пакет <code>.rpm</code> содержит архив <code>cpio</code>. Имеется удобная утилита <code>rpm2cpio</code>, которая преобразует <code>.rpm</code> в архив <code>cpio</code>.</p>



<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-3 shortcode-codeblock-bash">
  <div class="d-flex overflow-hidden">
    <div class="flex-grow-1 rounded overflow-hidden" id="cp-3621f15c6765ec7c1014bac5ec382b81">
      
      <pre><code class='language-bash'>rpm2cpio myrpmfile.rpm
rpm2cpio - &lt; myrpmfile.rpm
rpm2cpio myrpmfile.rpm | cpio -idmv</code></pre>
    </div>
    <div class="flex-shrink-0">
      <ul class="list-inline mb-0">
        <li class="list-inline-item" data-bs-tooltip data-bs-title='Копировать'>
          <a class="text-body" href="#"
             data-fn="clipboard preventDefault" data-clipboard-target="#cp-3621f15c6765ec7c1014bac5ec382b81"
             role="button" aria-label='Копировать'>
            <i class="fas fa-copy fa-fw"></i>
          </a>
        </li>
      </ul>
    </div>
  </div>
</div>

<p>Опции <code>rpm2cpio</code>:</p>
<ul>
<li><code>-i</code> - восстановить архив.</li>
<li><code>-d</code> - создать необходимые каталоги.</li>
<li><code>-m</code> - сохранить время модификации файлов.</li>
<li><code>-v</code> - подробный вывод процесса преобразования.</li>
</ul>
<p>Также, просматривать <code>.rpm</code> можно при помощи файлового менеджера Midnight Commander (<span class="shortcode shortcode-tag">MC</span>) (<code>mc</code>).</p>]]></turbo:content></item><item turbo="true"><title>Отключение установки дополнительных пакетов в Debian APT</title><link>https://lib.onl/ru/articles/2021/09/43b40b92-c29a-504b-87fa-5eac368dcf95/</link><pubDate>Tue, 07 Sep 2021 13:07:46 +0000</pubDate><dc:creator>Kai Kimera</dc:creator><category>Linux</category><yandex:related><link url="https://lib.onl/ru/articles/2021/09/aeed7c90-003a-532a-b2c4-3807aaee88fa/">dhclient отправляет 36-значный идентификатор вместо MAC</link></yandex:related><turbo:extendedHtml>true</turbo:extendedHtml><turbo:source>https://lib.onl/ru/articles/2021/09/43b40b92-c29a-504b-87fa-5eac368dcf95/</turbo:source><turbo:topic>Отключение установки дополнительных пакетов в Debian APT</turbo:topic><turbo:content><![CDATA[<p>Стандартное действие <span class="shortcode shortcode-tag"><a href="/ru/tags/apt/" target="_blank">#APT</a></span> при установке пакета, это установить дополнительные рекомендуемые пакеты. Но, к примеру, мне рекомендуемые пакеты не нужны. Они занимают место и, если я захочу поставить что-то дополнительно, я поставлю это сам.</p>
<p>Ниже приведены две команды, которые позволяют отключить установку рекомендуемых (Recommends) и дополнительных (Suggests) пакетов.</p>



<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-1 shortcode-codeblock-bash">
  <div class="d-flex overflow-hidden">
    <div class="flex-grow-1 rounded overflow-hidden" id="cp-8740222a21898962958599fa510e2d5d">
      
      <pre><code class='language-bash'>echo &#39;APT::Install-Recommends &#34;false&#34;;&#39; &gt; /etc/apt/apt.conf.d/00InstallRecommends</code></pre>
    </div>
    <div class="flex-shrink-0">
      <ul class="list-inline mb-0">
        <li class="list-inline-item" data-bs-tooltip data-bs-title='Копировать'>
          <a class="text-body" href="#"
             data-fn="clipboard preventDefault" data-clipboard-target="#cp-8740222a21898962958599fa510e2d5d"
             role="button" aria-label='Копировать'>
            <i class="fas fa-copy fa-fw"></i>
          </a>
        </li>
      </ul>
    </div>
  </div>
</div>




<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-2 shortcode-codeblock-bash">
  <div class="d-flex overflow-hidden">
    <div class="flex-grow-1 rounded overflow-hidden" id="cp-b903ffa89b7fe7d5590a3e977f118216">
      
      <pre><code class='language-bash'>echo &#39;APT::Install-Suggests &#34;false&#34;;&#39; &gt; /etc/apt/apt.conf.d/00InstallSuggests</code></pre>
    </div>
    <div class="flex-shrink-0">
      <ul class="list-inline mb-0">
        <li class="list-inline-item" data-bs-tooltip data-bs-title='Копировать'>
          <a class="text-body" href="#"
             data-fn="clipboard preventDefault" data-clipboard-target="#cp-b903ffa89b7fe7d5590a3e977f118216"
             role="button" aria-label='Копировать'>
            <i class="fas fa-copy fa-fw"></i>
          </a>
        </li>
      </ul>
    </div>
  </div>
</div>

<p>Стоит заметить, что при установке <span class="shortcode shortcode-tag"><a href="/ru/tags/debian/" target="_blank">#Debian</a></span> на завершающем этапе можно отключить рекомендуемые пакеты (в <span class="shortcode shortcode-tag">preseed</span> этот параметр именуется как <code>d-i base-installer/install-recommends boolean false</code>). При этом, после установки, <span class="shortcode shortcode-tag"><a href="/ru/tags/debian/" target="_blank">#Debian</a></span> сам создаст файл <code>00InstallRecommends</code> в <code>/etc/apt/apt.conf.d</code> с соответствующим содержанием.</p>]]></turbo:content></item><item turbo="true"><title>dhclient отправляет 36-значный идентификатор вместо MAC</title><link>https://lib.onl/ru/articles/2021/09/aeed7c90-003a-532a-b2c4-3807aaee88fa/</link><pubDate>Tue, 07 Sep 2021 08:38:24 +0000</pubDate><dc:creator>Kai Kimera</dc:creator><category>Linux</category><turbo:extendedHtml>true</turbo:extendedHtml><turbo:source>https://lib.onl/ru/articles/2021/09/aeed7c90-003a-532a-b2c4-3807aaee88fa/</turbo:source><turbo:topic>dhclient отправляет 36-значный идентификатор вместо MAC</turbo:topic><turbo:content><![CDATA[<p>Начиная с <span class="shortcode shortcode-tag"><a href="/ru/tags/debian/" target="_blank">#Debian</a></span> 10 в составе дистрибутива поставляется новая версия <span class="shortcode shortcode-tag"><a href="/ru/tags/dhclient/" target="_blank">#dhclient</a></span>, которая стала более совместимой с RFC. Поэтому, <span class="shortcode shortcode-tag"><a href="/ru/tags/dhclient/" target="_blank">#dhclient</a></span> теперь отправляет не прямой <span class="shortcode shortcode-tag">MAC</span>, а 36-значный идентификатор.</p>
<p>Чтобы указать <span class="shortcode shortcode-tag"><a href="/ru/tags/dhclient/" target="_blank">#dhclient</a></span>&rsquo;у отправлять обычный <span class="shortcode shortcode-tag">MAC</span>, необходимо в <code>/etc/dhcp/dhclient.conf</code> прописать строку:</p>



<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-6 shortcode-codeblock-ini">
  <div class="d-flex overflow-hidden">
    <div class="flex-grow-1 rounded overflow-hidden" id="cp-ee2f6f448a554b02b6d4ebe43d2f8940">
      
      <pre><code class='language-ini'>send dhcp-client-identifier = hardware;</code></pre>
    </div>
    <div class="flex-shrink-0">
      <ul class="list-inline mb-0">
        <li class="list-inline-item" data-bs-tooltip data-bs-title='Копировать'>
          <a class="text-body" href="#"
             data-fn="clipboard preventDefault" data-clipboard-target="#cp-ee2f6f448a554b02b6d4ebe43d2f8940"
             role="button" aria-label='Копировать'>
            <i class="fas fa-copy fa-fw"></i>
          </a>
        </li>
      </ul>
    </div>
  </div>
</div>

<p>Тоже самое при помощи команды:</p>



<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-7 shortcode-codeblock-bash">
  <div class="d-flex overflow-hidden">
    <div class="flex-grow-1 rounded overflow-hidden" id="cp-8557431e1a2751d82df2894c6187dc84">
      
      <pre><code class='language-bash'>echo &#39;send dhcp-client-identifier = hardware;&#39; &gt;&gt; /etc/dhcp/dhclient.conf</code></pre>
    </div>
    <div class="flex-shrink-0">
      <ul class="list-inline mb-0">
        <li class="list-inline-item" data-bs-tooltip data-bs-title='Копировать'>
          <a class="text-body" href="#"
             data-fn="clipboard preventDefault" data-clipboard-target="#cp-8557431e1a2751d82df2894c6187dc84"
             role="button" aria-label='Копировать'>
            <i class="fas fa-copy fa-fw"></i>
          </a>
        </li>
      </ul>
    </div>
  </div>
</div>]]></turbo:content></item><item turbo="true"><title>Скрипт автоматического удаления устаревших файлов</title><link>https://lib.onl/ru/articles/2021/08/ca744dce-e607-52e6-9952-8ae04e052a5b/</link><pubDate>Thu, 19 Aug 2021 15:03:46 +0000</pubDate><dc:creator>Kai Kimera</dc:creator><category>Разработка</category><category>Скрипты</category><yandex:related><link url="https://lib.onl/ru/articles/2021/05/4a3b0a31-0d3d-5a9b-8c07-7e3b4f80669e/">Рекурсивное изменение прав доступа на файлы и директории</link></yandex:related><turbo:extendedHtml>true</turbo:extendedHtml><turbo:source>https://lib.onl/ru/articles/2021/08/ca744dce-e607-52e6-9952-8ae04e052a5b/</turbo:source><turbo:topic>Скрипт автоматического удаления устаревших файлов</turbo:topic><turbo:content><![CDATA[<p>В одной компании стояла задача сделать файловый архив-помойку для хранения и пересылки документации в сторонние организации. Я накидал на <span class="shortcode shortcode-tag"><a href="/ru/tags/php/" target="_blank">#PHP</a></span> самописный интерфейс для загрузки файлов, а на <span class="shortcode shortcode-tag"><a href="/ru/tags/bash/" target="_blank">#bash</a></span>&rsquo;е сделал скрипт автоматического удаления устаревших файлов. Небольшая заметка об этом скрипте.</p>
<p>Скрипт для удаления устаревших файлов очень прост, написан на <span class="shortcode shortcode-tag"><a href="/ru/tags/bash/" target="_blank">#bash</a></span>&rsquo;е и основывается на утилите <code>find</code>. Утилита <code>find</code> имеет опцию <code>-mtime</code>, при помощи которого можно сделать выборку файлов по времени изменения:</p>



<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-3 shortcode-codeblock-bash">
  <div class="d-flex overflow-hidden">
    <div class="flex-grow-1 rounded overflow-hidden" id="cp-7c9ce2fb83e79f364c3e32833b1131bd">
      
      <pre><code class='language-bash'>find &#34;/home/user&#34; -type f -mtime &#43;3</code></pre>
    </div>
    <div class="flex-shrink-0">
      <ul class="list-inline mb-0">
        <li class="list-inline-item" data-bs-tooltip data-bs-title='Копировать'>
          <a class="text-body" href="#"
             data-fn="clipboard preventDefault" data-clipboard-target="#cp-7c9ce2fb83e79f364c3e32833b1131bd"
             role="button" aria-label='Копировать'>
            <i class="fas fa-copy fa-fw"></i>
          </a>
        </li>
      </ul>
    </div>
  </div>
</div>

<p>Здесь мы говорим утилите <code>find</code>, что необходимо найти и показать файлы, у которых с даты последнего изменения прошло более 3 дней. Если необходимо вывести файлы, дата изменения которых будет менее <code>3</code> дней, то ставим отрицательное значение <code>-3</code>.</p>
<p>Далее, конструируем конвейер, и при помощи <code>xargs</code> указываем команду удаления <code>rm -f</code>:</p>



<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-4 shortcode-codeblock-bash">
  <div class="d-flex overflow-hidden">
    <div class="flex-grow-1 rounded overflow-hidden" id="cp-2309a01183a46cf0ee36ac988377c736">
      
      <pre><code class='language-bash'>find &#34;/home/user&#34; -type f -mtime &#43;3 -print0 | xargs -0 rm -f</code></pre>
    </div>
    <div class="flex-shrink-0">
      <ul class="list-inline mb-0">
        <li class="list-inline-item" data-bs-tooltip data-bs-title='Копировать'>
          <a class="text-body" href="#"
             data-fn="clipboard preventDefault" data-clipboard-target="#cp-2309a01183a46cf0ee36ac988377c736"
             role="button" aria-label='Копировать'>
            <i class="fas fa-copy fa-fw"></i>
          </a>
        </li>
      </ul>
    </div>
  </div>
</div>

<p>Сам скрипт провожу ниже.</p>
<h2 id="скрипт">
  <a class="link-body-emphasis" href="#%d1%81%d0%ba%d1%80%d0%b8%d0%bf%d1%82">Скрипт</a>
</h2>
    

    
        
            
            <div class="shortcode shortcode-file mb-3">
              <div class="card overflow-hidden">
                <div class="card-header">
                  <div class="d-flex align-items-center">
                    <div class="flex-shrink-0">
                      <i class="far fa-file-code fa-fw"></i>
                    </div>
                    <div class="flex-grow-1 mx-2 text-truncate">
                      <code>delete-files.sh</code>
                    </div>
                    <div class="flex-shrink-0">
                      <ul class="list-inline mb-0">
                        <li class="list-inline-item" data-bs-tooltip data-bs-title='Копировать'>
                          <a class="text-body" href="#"
                             data-fn="clipboard preventDefault" data-clipboard-target="#cp-c19389e4a42abd7d3acb4b2f7adfd6fd"
                             role="button" aria-label='Копировать'>
                            <i class="fas fa-copy fa-fw"></i>
                          </a>
                        </li>
                        <li class="list-inline-item" data-bs-tooltip data-bs-title='Скачать'>
                          <a class="text-body" href="/ru/articles/2021/08/ca744dce-e607-52e6-9952-8ae04e052a5b/delete-files.sh" download
                             role="button" aria-label='Скачать'>
                            <i class="fas fa-download fa-fw"></i>
                          </a>
                        </li>
                        <li class="list-inline-item" data-bs-tooltip data-bs-title='Открыть'>
                          <a class="text-body" href="/ru/articles/2021/08/ca744dce-e607-52e6-9952-8ae04e052a5b/delete-files.sh" target="_blank"
                             role="button" aria-label='Открыть'>
                            <i class="fas fa-arrow-up-right-from-square fa-fw"></i>
                          </a>
                        </li>
                      </ul>
                    </div>
                  </div>
                </div>
                <div class="card-body" id="cp-c19389e4a42abd7d3acb4b2f7adfd6fd">
                    
                        
                    
                  <pre><code class="language-sh">#!/usr/bin/env -S bash -e
#
# Script for automatically deleting outdated files.
#
# @package    Bash
# @author     Kai Kimera &lt;mail@kai.kim&gt;
# @copyright  2023 Library Online
# @license    MIT
# @version    0.1.0
# @link       https://lib.onl/ru/articles/2021/08/ca744dce-e607-52e6-9952-8ae04e052a5b/
# -------------------------------------------------------------------------------------------------------------------- #

days=&#34;${1}&#34;
dir=&#34;${2}&#34;

find &#34;${dir}&#34; -type f -mtime &#43;${days} -print0 | xargs -0 rm -f

exit 0</code></pre>
                </div>
              </div>
            </div>
        
    
<p>В скрипте я вынес некоторые значения в переменные для удобной перенастройки. Вызывается скрипт следующем образом:</p>






<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-6 shortcode-codeblock-terminal
shortcode-codeblock-terminal-linux shortcode-codeblock-terminal-linux-user">
  <div class="card overflow-hidden" data-bs-theme="dark">
    <div class="card-header">
      <div class="d-flex align-items-center">
        <div class="flex-shrink-0 ">
          <i class="fas fa-terminal fa-fw"></i>
        </div>
        <div class="flex-grow-1 mx-2">
          <h5 class="mb-0">Терминал</h5>
        </div>
        <div class="flex-shrink-0">
          <ul class="list-inline mb-0">
            <li class="list-inline-item" data-bs-tooltip data-bs-title='Копировать'>
              <a class="text-body" href="#"
                 data-fn="clipboard preventDefault" data-clipboard-target="#cp-dfd59547010804b4ad50425a691e180e"
                 role="button" aria-label='Копировать'>
                <i class="fas fa-copy fa-fw"></i>
              </a>
            </li>
          </ul>
        </div>
      </div>
    </div>
    <div class="card-body p-0" id="cp-dfd59547010804b4ad50425a691e180e">
      <pre><code class="language-plaintext">delete-files.sh &#34;3&#34; &#34;/path/to/storage&#34;</code></pre>
    </div>
  </div>
</div>

<p>Где:</p>
<ul>
<li><code>3</code> - количество дней, прошедших с момента последнего изменения файла.</li>
<li><code>/path/to/storage</code> - путь к файловому хранилищу, в котором необходимо удалять устаревшие файлы.</li>
</ul>
<h2 id="автоматический-запуск-по-расписанию">
  <a class="link-body-emphasis" href="#%d0%b0%d0%b2%d1%82%d0%be%d0%bc%d0%b0%d1%82%d0%b8%d1%87%d0%b5%d1%81%d0%ba%d0%b8%d0%b9-%d0%b7%d0%b0%d0%bf%d1%83%d1%81%d0%ba-%d0%bf%d0%be-%d1%80%d0%b0%d1%81%d0%bf%d0%b8%d1%81%d0%b0%d0%bd%d0%b8%d1%8e">Автоматический запуск по расписанию</a>
</h2><p>Осталось добавить выполнение скрипта по <span class="shortcode shortcode-tag">cron</span>&rsquo;у. Я указал время <code>23:59</code>, когда нагрузка на файловое хранилище минимальна:</p>



<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-8 shortcode-codeblock-bash">
  <div class="d-flex overflow-hidden">
    <div class="flex-grow-1 rounded overflow-hidden" id="cp-bed18669471176888b9f257eab876b8f">
      
      <pre><code class='language-bash'># Check &amp; remove old files in 23:59 every day.
59 23 * * * [username] /usr/bin/bash /path/to/delete-files.sh &#34;3&#34; &#34;/path/to/storage&#34; &gt; /dev/null 2&gt;&amp;1</code></pre>
    </div>
    <div class="flex-shrink-0">
      <ul class="list-inline mb-0">
        <li class="list-inline-item" data-bs-tooltip data-bs-title='Копировать'>
          <a class="text-body" href="#"
             data-fn="clipboard preventDefault" data-clipboard-target="#cp-bed18669471176888b9f257eab876b8f"
             role="button" aria-label='Копировать'>
            <i class="fas fa-copy fa-fw"></i>
          </a>
        </li>
      </ul>
    </div>
  </div>
</div>]]></turbo:content></item><item turbo="true"><title>Интересные модули Drupal</title><link>https://lib.onl/ru/articles/2021/08/28fa2886-aea6-5abc-9da8-43be56283cdb/</link><pubDate>Wed, 18 Aug 2021 06:58:21 +0000</pubDate><dc:creator>Kai Kimera</dc:creator><category>CMF</category><category>В доработке</category><yandex:related><link url="https://lib.onl/ru/articles/2021/08/8ddf3622-5dd8-5101-9c40-2f3e08f4a579/">XenForo: Первичные настройки движка и параметры системы</link><link url="https://lib.onl/ru/articles/2020/08/5d35edd8-f0e3-5b39-afd3-2ac3b15b8c4f/">Генератор идентификаторов расширений</link><link url="https://lib.onl/ru/articles/2021/08/f9a39e37-8816-5f80-8133-893f3dc8f352/">Условия в шаблонах XenForo 2</link></yandex:related><turbo:extendedHtml>true</turbo:extendedHtml><turbo:source>https://lib.onl/ru/articles/2021/08/28fa2886-aea6-5abc-9da8-43be56283cdb/</turbo:source><turbo:topic>Интересные модули Drupal</turbo:topic><turbo:content><![CDATA[<p>Здесь собраны ссылки на интересные и необходимые для меня в работе модули <span class="shortcode shortcode-tag"><a href="/ru/tags/drupal/" target="_blank">#Drupal</a></span>.</p>
<h2 id="permissions-by-term">
  <a class="link-body-emphasis" href="#permissions-by-term">Permissions by Term</a>
</h2><p><a title="" href="https://www.drupal.org/project/permissions_by_term" target="_blank" rel="noopener noreferrer">Модуль</a> позволяет применять права доступа к материалу путём добавления термина таксономии.</p>
<h2 id="node-view-permissions">
  <a class="link-body-emphasis" href="#node-view-permissions">Node View Permissions</a>
</h2><p><a title="" href="https://www.drupal.org/project/node_view_permissions" target="_blank" rel="noopener noreferrer">Модуль</a> разрешает или запрещает просматривать материал определённым ролям пользователей. Подобная функция была в Drupal 6, но в последующих версиях её убрали.</p>
<h2 id="poll">
  <a class="link-body-emphasis" href="#poll">Poll</a>
</h2><p><a title="" href="https://www.drupal.org/project/poll" target="_blank" rel="noopener noreferrer">Модуль</a> опросов. Позволяет создавать опросы в различной конфигурации.</p>
<h2 id="scheduler">
  <a class="link-body-emphasis" href="#scheduler">Scheduler</a>
</h2><p>Очень полезный <a title="" href="https://www.drupal.org/project/scheduler" target="_blank" rel="noopener noreferrer">модуль</a>, особенно редакторам. Модуль позволяет создавать отложенные материалы, которые необходимо опубликовать через определённое время.</p>]]></turbo:content></item><item turbo="true"><title>XenForo: Первичные настройки движка и параметры системы</title><link>https://lib.onl/ru/articles/2021/08/8ddf3622-5dd8-5101-9c40-2f3e08f4a579/</link><pubDate>Wed, 18 Aug 2021 06:55:19 +0000</pubDate><dc:creator>Kai Kimera</dc:creator><category>CMF</category><category>Разработка</category><category>Скрипты</category><yandex:related><link url="https://lib.onl/ru/articles/2021/08/f9a39e37-8816-5f80-8133-893f3dc8f352/">Условия в шаблонах XenForo 2</link><link url="https://lib.onl/ru/articles/2020/08/5d35edd8-f0e3-5b39-afd3-2ac3b15b8c4f/">Генератор идентификаторов расширений</link></yandex:related><turbo:extendedHtml>true</turbo:extendedHtml><turbo:source>https://lib.onl/ru/articles/2021/08/8ddf3622-5dd8-5101-9c40-2f3e08f4a579/</turbo:source><turbo:topic>XenForo: Первичные настройки движка и параметры системы</turbo:topic><turbo:content><![CDATA[<p>У меня в проекте находятся несколько форумов на движке <span class="shortcode shortcode-tag"><a href="/ru/tags/xenforo/" target="_blank">#XenForo</a></span>. Здесь я собрал для себя первичные параметры и настройки движка <span class="shortcode shortcode-tag"><a href="/ru/tags/xenforo/" target="_blank">#XenForo</a></span>.</p>
<h2 id="файл-конфигурации">
  <a class="link-body-emphasis" href="#%d1%84%d0%b0%d0%b9%d0%bb-%d0%ba%d0%be%d0%bd%d1%84%d0%b8%d0%b3%d1%83%d1%80%d0%b0%d1%86%d0%b8%d0%b8">Файл конфигурации</a>
</h2><p>Примеры параметров в файле <code>config.php</code> для первоначальной установки и запуска системы.</p>

    

    
        
            
            <div class="shortcode shortcode-file mb-3">
              <div class="card overflow-hidden">
                <div class="card-header">
                  <div class="d-flex align-items-center">
                    <div class="flex-shrink-0">
                      <i class="far fa-file-code fa-fw"></i>
                    </div>
                    <div class="flex-grow-1 mx-2 text-truncate">
                      <code>config.php</code>
                    </div>
                    <div class="flex-shrink-0">
                      <ul class="list-inline mb-0">
                        <li class="list-inline-item" data-bs-tooltip data-bs-title='Копировать'>
                          <a class="text-body" href="#"
                             data-fn="clipboard preventDefault" data-clipboard-target="#cp-65e569c43a793a670ce027dbde47ef1f"
                             role="button" aria-label='Копировать'>
                            <i class="fas fa-copy fa-fw"></i>
                          </a>
                        </li>
                        <li class="list-inline-item" data-bs-tooltip data-bs-title='Скачать'>
                          <a class="text-body" href="/ru/articles/2021/08/8ddf3622-5dd8-5101-9c40-2f3e08f4a579/config.php" download
                             role="button" aria-label='Скачать'>
                            <i class="fas fa-download fa-fw"></i>
                          </a>
                        </li>
                        <li class="list-inline-item" data-bs-tooltip data-bs-title='Открыть'>
                          <a class="text-body" href="/ru/articles/2021/08/8ddf3622-5dd8-5101-9c40-2f3e08f4a579/config.php" target="_blank"
                             role="button" aria-label='Открыть'>
                            <i class="fas fa-arrow-up-right-from-square fa-fw"></i>
                          </a>
                        </li>
                      </ul>
                    </div>
                  </div>
                </div>
                <div class="card-body" id="cp-65e569c43a793a670ce027dbde47ef1f">
                    
                        
                    
                  <pre><code class="language-php">&lt;?php

# Database.
$config[&#39;db&#39;][&#39;host&#39;]                             = &#39;127.0.0.1&#39;;
$config[&#39;db&#39;][&#39;port&#39;]                             = 3306;
$config[&#39;db&#39;][&#39;username&#39;]                         = &#39;&#39;;
$config[&#39;db&#39;][&#39;password&#39;]                         = &#39;&#39;;
$config[&#39;db&#39;][&#39;dbname&#39;]                           = &#39;&#39;;
$config[&#39;db&#39;][&#39;socket&#39;]                           = null;

# Unicode support.
$config[&#39;fullUnicode&#39;]                            = true;

# Site-wide feature.
$config[&#39;enableTfa&#39;]                              = false;
$config[&#39;enableApi&#39;]                              = false;
$config[&#39;enableOneClickUpgrade&#39;]                  = false;

# Cookie.
$config[&#39;cookie&#39;][&#39;prefix&#39;]                       = &#39;xf_&#39;;

# Data and script locations.
$config[&#39;externalDataPath&#39;]                       = &#39;storage/data&#39;;
$config[&#39;externalDataUrl&#39;]                        = &#39;storage/data&#39;;
$config[&#39;internalDataPath&#39;]                       = &#39;storage/data.int&#39;;
$config[&#39;codeCachePath&#39;]                          = &#39;%s/cache/code&#39;;
$config[&#39;tempDataPath&#39;]                           = &#39;%s/temp&#39;;
$config[&#39;javaScriptUrl&#39;]                          = &#39;js&#39;;

# Auth.
$config[&#39;auth&#39;] = [
  &#39;algo&#39; =&gt; PASSWORD_ARGON2ID
];

# Cache.
/*
$config[&#39;cache&#39;][&#39;enabled&#39;]                       = true;
$config[&#39;cache&#39;][&#39;provider&#39;]                      = &#39;Redis&#39;;
$config[&#39;cache&#39;][&#39;config&#39;]                        = [
  &#39;host&#39; =&gt; &#39;127.0.0.1&#39;,
  &#39;password&#39; =&gt; &#39;&#39;,
  &#39;database&#39; =&gt; 1
];
*/

# Guest page caching.
/*
$config[&#39;pageCache&#39;][&#39;enabled&#39;]                   = true;
$config[&#39;cache&#39;][&#39;context&#39;][&#39;page&#39;][&#39;provider&#39;]   = &#39;Filesystem&#39;;
$config[&#39;cache&#39;][&#39;context&#39;][&#39;page&#39;][&#39;config&#39;]     = [
  &#39;directory&#39; =&gt; &#39;&#39;
];
*/</code></pre>
                </div>
              </div>
            </div>
        
    
<h2 id="регистрация-пользователей">
  <a class="link-body-emphasis" href="#%d1%80%d0%b5%d0%b3%d0%b8%d1%81%d1%82%d1%80%d0%b0%d1%86%d0%b8%d1%8f-%d0%bf%d0%be%d0%bb%d1%8c%d0%b7%d0%be%d0%b2%d0%b0%d1%82%d0%b5%d0%bb%d0%b5%d0%b9">Регистрация пользователей</a>
</h2><p>Параметры для регистрации пользователей.</p>
<p><strong>Регулярное выражение:</strong></p>



<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-3 shortcode-codeblock-text">
  <div class="d-flex overflow-hidden">
    <div class="flex-grow-1 rounded overflow-hidden" id="cp-6ca79445d28bd5b98cbcedad4552df31">
      
      <pre><code class='language-text'>#(?!^[\d\-\_\s]&#43;$)^(([a-zA-Z0-9\-\_\s]&#43;)|(((\xD0[\x80-\xBF])|(\xD1[\x80-\xBF])|([0-9\-\_\s]))&#43;))$#</code></pre>
    </div>
    <div class="flex-shrink-0">
      <ul class="list-inline mb-0">
        <li class="list-inline-item" data-bs-tooltip data-bs-title='Копировать'>
          <a class="text-body" href="#"
             data-fn="clipboard preventDefault" data-clipboard-target="#cp-6ca79445d28bd5b98cbcedad4552df31"
             role="button" aria-label='Копировать'>
            <i class="fas fa-copy fa-fw"></i>
          </a>
        </li>
      </ul>
    </div>
  </div>
</div>

<h2 id="теги">
  <a class="link-body-emphasis" href="#%d1%82%d0%b5%d0%b3%d0%b8">Теги</a>
</h2><p>Параметры для ввода тегов.</p>
<p><strong>Регулярное выражение:</strong></p>



<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-4 shortcode-codeblock-text">
  <div class="d-flex overflow-hidden">
    <div class="flex-grow-1 rounded overflow-hidden" id="cp-67f82f0007eccdb593c294bd615a3dd6">
      
      <pre><code class='language-text'>#(?!^[\d\-\_\s]&#43;$)^(([a-zA-Z0-9\-\_\s]&#43;)|(((\xD0[\x80-\xBF])|(\xD1[\x80-\xBF])|([0-9\-\_\s]))&#43;))$#</code></pre>
    </div>
    <div class="flex-shrink-0">
      <ul class="list-inline mb-0">
        <li class="list-inline-item" data-bs-tooltip data-bs-title='Копировать'>
          <a class="text-body" href="#"
             data-fn="clipboard preventDefault" data-clipboard-target="#cp-67f82f0007eccdb593c294bd615a3dd6"
             role="button" aria-label='Копировать'>
            <i class="fas fa-copy fa-fw"></i>
          </a>
        </li>
      </ul>
    </div>
  </div>
</div>

<h2 id="группы-пользователей">
  <a class="link-body-emphasis" href="#%d0%b3%d1%80%d1%83%d0%bf%d0%bf%d1%8b-%d0%bf%d0%be%d0%bb%d1%8c%d0%b7%d0%be%d0%b2%d0%b0%d1%82%d0%b5%d0%bb%d0%b5%d0%b9">Группы пользователей</a>
</h2><p>Настройки групп пользователей.</p>
<p><strong>Стандартные группы:</strong></p>
<ul>
<li>Unregistered / Unconfirmed <code>ID(1)</code></li>
<li>Registered <code>ID(2)</code></li>
<li>Administrative <code>ID(3)</code></li>
<li>Moderating <code>ID(4)</code></li>
</ul>]]></turbo:content></item><item turbo="true"><title>Условия в шаблонах XenForo 2</title><link>https://lib.onl/ru/articles/2021/08/f9a39e37-8816-5f80-8133-893f3dc8f352/</link><pubDate>Tue, 17 Aug 2021 12:21:10 +0000</pubDate><dc:creator>Kai Kimera</dc:creator><category>CMF</category><yandex:related><link url="https://lib.onl/ru/articles/2020/08/5d35edd8-f0e3-5b39-afd3-2ac3b15b8c4f/">Генератор идентификаторов расширений</link></yandex:related><turbo:extendedHtml>true</turbo:extendedHtml><turbo:source>https://lib.onl/ru/articles/2021/08/f9a39e37-8816-5f80-8133-893f3dc8f352/</turbo:source><turbo:topic>Условия в шаблонах XenForo 2</turbo:topic><turbo:content><![CDATA[<p>Представляю список условий, которые можно использовать в шаблонах <span class="shortcode shortcode-tag"><a href="/ru/tags/xenforo/" target="_blank">#XenForo</a></span>. Все возможные условия перечислить затруднительно, потому что существует множество различных вариантов фильтрации и выборки информации. Здесь представлены наиболее популярные варианты.</p>
<p>С этой статьи я начинаю попытку восстановления накопленных данных за период моей деятельности в качестве исследователя и разработчика веб-приложений.</p>
<h2 id="условия-в-шаблонах">
  <a class="link-body-emphasis" href="#%d1%83%d1%81%d0%bb%d0%be%d0%b2%d0%b8%d1%8f-%d0%b2-%d1%88%d0%b0%d0%b1%d0%bb%d0%be%d0%bd%d0%b0%d1%85">Условия в шаблонах</a>
</h2><ol>
<li>Отображение информации только администраторам.</li>
</ol>



<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-1 shortcode-codeblock-html">
  <div class="d-flex overflow-hidden">
    <div class="flex-grow-1 rounded overflow-hidden" id="cp-c0360fb67921e1250452e8e8e038965d">
      
      <pre><code class='language-html'>&lt;xf:if is=&#34;$xf.visitor.is_admin&#34;&gt;
  &lt;!-- content --&gt;
&lt;/xf:if&gt;</code></pre>
    </div>
    <div class="flex-shrink-0">
      <ul class="list-inline mb-0">
        <li class="list-inline-item" data-bs-tooltip data-bs-title='Копировать'>
          <a class="text-body" href="#"
             data-fn="clipboard preventDefault" data-clipboard-target="#cp-c0360fb67921e1250452e8e8e038965d"
             role="button" aria-label='Копировать'>
            <i class="fas fa-copy fa-fw"></i>
          </a>
        </li>
      </ul>
    </div>
  </div>
</div>

<ol start="2">
<li>Отображение информации только модераторам.</li>
</ol>



<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-2 shortcode-codeblock-html">
  <div class="d-flex overflow-hidden">
    <div class="flex-grow-1 rounded overflow-hidden" id="cp-8ed955bf4b1a9aaa453fc78c2fafb615">
      
      <pre><code class='language-html'>&lt;xf:if is=&#34;$xf.visitor.is_moderator&#34;&gt;
  &lt;!-- content --&gt;
&lt;/xf:if&gt;</code></pre>
    </div>
    <div class="flex-shrink-0">
      <ul class="list-inline mb-0">
        <li class="list-inline-item" data-bs-tooltip data-bs-title='Копировать'>
          <a class="text-body" href="#"
             data-fn="clipboard preventDefault" data-clipboard-target="#cp-8ed955bf4b1a9aaa453fc78c2fafb615"
             role="button" aria-label='Копировать'>
            <i class="fas fa-copy fa-fw"></i>
          </a>
        </li>
      </ul>
    </div>
  </div>
</div>

<ol start="3">
<li>Отображение информации только администраторам и модераторам.</li>
</ol>



<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-3 shortcode-codeblock-html">
  <div class="d-flex overflow-hidden">
    <div class="flex-grow-1 rounded overflow-hidden" id="cp-6132820333e63b4ca896ca95577edb07">
      
      <pre><code class='language-html'>&lt;xf:if is=&#34;$xf.visitor.is_admin OR $xf.visitor.is_moderator&#34;&gt;
  &lt;!-- content --&gt;
&lt;/xf:if&gt;</code></pre>
    </div>
    <div class="flex-shrink-0">
      <ul class="list-inline mb-0">
        <li class="list-inline-item" data-bs-tooltip data-bs-title='Копировать'>
          <a class="text-body" href="#"
             data-fn="clipboard preventDefault" data-clipboard-target="#cp-6132820333e63b4ca896ca95577edb07"
             role="button" aria-label='Копировать'>
            <i class="fas fa-copy fa-fw"></i>
          </a>
        </li>
      </ul>
    </div>
  </div>
</div>

<ol start="4">
<li>Отображение информации только зарегистрированному пользователю</li>
</ol>



<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-4 shortcode-codeblock-html">
  <div class="d-flex overflow-hidden">
    <div class="flex-grow-1 rounded overflow-hidden" id="cp-173f113ed8027f205522c7c26d552443">
      
      <pre><code class='language-html'>&lt;xf:if is=&#34;$xf.visitor.user_id&#34;&gt;
  &lt;!-- content --&gt;
&lt;/xf:if&gt;</code></pre>
    </div>
    <div class="flex-shrink-0">
      <ul class="list-inline mb-0">
        <li class="list-inline-item" data-bs-tooltip data-bs-title='Копировать'>
          <a class="text-body" href="#"
             data-fn="clipboard preventDefault" data-clipboard-target="#cp-173f113ed8027f205522c7c26d552443"
             role="button" aria-label='Копировать'>
            <i class="fas fa-copy fa-fw"></i>
          </a>
        </li>
      </ul>
    </div>
  </div>
</div>

<ol start="5">
<li>Отображение информации гостю.</li>
</ol>



<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-5 shortcode-codeblock-html">
  <div class="d-flex overflow-hidden">
    <div class="flex-grow-1 rounded overflow-hidden" id="cp-6a235f9a5aabc88587b9974900ebed03">
      
      <pre><code class='language-html'>&lt;xf:if is=&#34;!$xf.visitor.user_id&#34;&gt;
  &lt;!-- content --&gt;
&lt;/xf:if&gt;</code></pre>
    </div>
    <div class="flex-shrink-0">
      <ul class="list-inline mb-0">
        <li class="list-inline-item" data-bs-tooltip data-bs-title='Копировать'>
          <a class="text-body" href="#"
             data-fn="clipboard preventDefault" data-clipboard-target="#cp-6a235f9a5aabc88587b9974900ebed03"
             role="button" aria-label='Копировать'>
            <i class="fas fa-copy fa-fw"></i>
          </a>
        </li>
      </ul>
    </div>
  </div>
</div>

<ol start="6">
<li>Отображение разной информации зарегистрированному пользователю и гостю.</li>
</ol>



<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-6 shortcode-codeblock-html">
  <div class="d-flex overflow-hidden">
    <div class="flex-grow-1 rounded overflow-hidden" id="cp-28e61240476028c5ac2a1060b89029e7">
      
      <pre><code class='language-html'>&lt;xf:if is=&#34;!$xf.visitor.user_id&#34;&gt;
  &lt;!-- content for members --&gt;
&lt;xf:else /&gt;
  &lt;!-- content for guests --&gt;
&lt;/xf:if&gt;</code></pre>
    </div>
    <div class="flex-shrink-0">
      <ul class="list-inline mb-0">
        <li class="list-inline-item" data-bs-tooltip data-bs-title='Копировать'>
          <a class="text-body" href="#"
             data-fn="clipboard preventDefault" data-clipboard-target="#cp-28e61240476028c5ac2a1060b89029e7"
             role="button" aria-label='Копировать'>
            <i class="fas fa-copy fa-fw"></i>
          </a>
        </li>
      </ul>
    </div>
  </div>
</div>

<ol start="7">
<li>Отображение информации только заблокированным пользователям.</li>
</ol>



<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-7 shortcode-codeblock-html">
  <div class="d-flex overflow-hidden">
    <div class="flex-grow-1 rounded overflow-hidden" id="cp-93ed707c1d973a4f4570bf0f6ec7c023">
      
      <pre><code class='language-html'>&lt;xf:if is=&#34;$user.is_banned&#34;&gt;
  &lt;!-- content --&gt;
&lt;/xf:if&gt;</code></pre>
    </div>
    <div class="flex-shrink-0">
      <ul class="list-inline mb-0">
        <li class="list-inline-item" data-bs-tooltip data-bs-title='Копировать'>
          <a class="text-body" href="#"
             data-fn="clipboard preventDefault" data-clipboard-target="#cp-93ed707c1d973a4f4570bf0f6ec7c023"
             role="button" aria-label='Копировать'>
            <i class="fas fa-copy fa-fw"></i>
          </a>
        </li>
      </ul>
    </div>
  </div>
</div>

<ol start="8">
<li>Отображение информации только если у пользователя симпатий больше определённого количества.</li>
</ol>



<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-8 shortcode-codeblock-html">
  <div class="d-flex overflow-hidden">
    <div class="flex-grow-1 rounded overflow-hidden" id="cp-77d461c4162d04cbdfda67f25be9c034">
      
      <pre><code class='language-html'>&lt;xf:if is=&#34;$user.like_count|number &gt; X&#34;&gt;
  &lt;!-- content --&gt;
&lt;/xf:if&gt;</code></pre>
    </div>
    <div class="flex-shrink-0">
      <ul class="list-inline mb-0">
        <li class="list-inline-item" data-bs-tooltip data-bs-title='Копировать'>
          <a class="text-body" href="#"
             data-fn="clipboard preventDefault" data-clipboard-target="#cp-77d461c4162d04cbdfda67f25be9c034"
             role="button" aria-label='Копировать'>
            <i class="fas fa-copy fa-fw"></i>
          </a>
        </li>
      </ul>
    </div>
  </div>
</div>

<ol start="9">
<li>Отображение информации только если у пользователя сообщений больше определённого количества.</li>
</ol>



<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-9 shortcode-codeblock-html">
  <div class="d-flex overflow-hidden">
    <div class="flex-grow-1 rounded overflow-hidden" id="cp-8c08a842d559135e78c86a25efac1cd6">
      
      <pre><code class='language-html'>&lt;xf:if is=&#34;{$xf.visitor.message_count|number} &gt; X&#34;&gt;
  &lt;!-- content --&gt;
&lt;/xf:if&gt;</code></pre>
    </div>
    <div class="flex-shrink-0">
      <ul class="list-inline mb-0">
        <li class="list-inline-item" data-bs-tooltip data-bs-title='Копировать'>
          <a class="text-body" href="#"
             data-fn="clipboard preventDefault" data-clipboard-target="#cp-8c08a842d559135e78c86a25efac1cd6"
             role="button" aria-label='Копировать'>
            <i class="fas fa-copy fa-fw"></i>
          </a>
        </li>
      </ul>
    </div>
  </div>
</div>

<ol start="10">
<li>Отображение информации только если у пользователя очков больше определённого количества.</li>
</ol>



<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-10 shortcode-codeblock-html">
  <div class="d-flex overflow-hidden">
    <div class="flex-grow-1 rounded overflow-hidden" id="cp-ec725e59317b160e2b399ff4c6910f8c">
      
      <pre><code class='language-html'>&lt;xf:if is=&#34;$user.trophy_points|number &gt; X&#34;&gt;
  &lt;!-- content --&gt;
&lt;/xf:if&gt;</code></pre>
    </div>
    <div class="flex-shrink-0">
      <ul class="list-inline mb-0">
        <li class="list-inline-item" data-bs-tooltip data-bs-title='Копировать'>
          <a class="text-body" href="#"
             data-fn="clipboard preventDefault" data-clipboard-target="#cp-ec725e59317b160e2b399ff4c6910f8c"
             role="button" aria-label='Копировать'>
            <i class="fas fa-copy fa-fw"></i>
          </a>
        </li>
      </ul>
    </div>
  </div>
</div>

<ol start="11">
<li>Отображение информации определённому пользователю.</li>
</ol>



<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-11 shortcode-codeblock-html">
  <div class="d-flex overflow-hidden">
    <div class="flex-grow-1 rounded overflow-hidden" id="cp-e1fb997876f211aa530697579c825e50">
      
      <pre><code class='language-html'>&lt;xf:if is=&#34;$xf.visitor.user_id == X&#34;&gt;
  &lt;!-- content --&gt;
&lt;/xf:if&gt;</code></pre>
    </div>
    <div class="flex-shrink-0">
      <ul class="list-inline mb-0">
        <li class="list-inline-item" data-bs-tooltip data-bs-title='Копировать'>
          <a class="text-body" href="#"
             data-fn="clipboard preventDefault" data-clipboard-target="#cp-e1fb997876f211aa530697579c825e50"
             role="button" aria-label='Копировать'>
            <i class="fas fa-copy fa-fw"></i>
          </a>
        </li>
      </ul>
    </div>
  </div>
</div>

<ol start="12">
<li>Отображение информации определённым пользователям.</li>
</ol>



<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-12 shortcode-codeblock-html">
  <div class="d-flex overflow-hidden">
    <div class="flex-grow-1 rounded overflow-hidden" id="cp-a4cf06ce894fc8f40016636207f7237f">
      
      <pre><code class='language-html'>&lt;xf:if is=&#34;in_array($xf.visitor.user_id, [X, Y, Z])&#34;&gt;
  &lt;!-- content --&gt;
&lt;/xf:if&gt;</code></pre>
    </div>
    <div class="flex-shrink-0">
      <ul class="list-inline mb-0">
        <li class="list-inline-item" data-bs-tooltip data-bs-title='Копировать'>
          <a class="text-body" href="#"
             data-fn="clipboard preventDefault" data-clipboard-target="#cp-a4cf06ce894fc8f40016636207f7237f"
             role="button" aria-label='Копировать'>
            <i class="fas fa-copy fa-fw"></i>
          </a>
        </li>
      </ul>
    </div>
  </div>
</div>

<ol start="13">
<li>(1) Отображение информации определённым группам пользователей.</li>
</ol>



<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-13 shortcode-codeblock-html">
  <div class="d-flex overflow-hidden">
    <div class="flex-grow-1 rounded overflow-hidden" id="cp-9fc0a73bdbbb524b06b42daf73d8e888">
      
      <pre><code class='language-html'>&lt;xf:if is=&#34;{{$xf.visitor.isMemberOf([X, Y])}}&#34;&gt;
  &lt;!-- content --&gt;
&lt;/xf:if&gt;</code></pre>
    </div>
    <div class="flex-shrink-0">
      <ul class="list-inline mb-0">
        <li class="list-inline-item" data-bs-tooltip data-bs-title='Копировать'>
          <a class="text-body" href="#"
             data-fn="clipboard preventDefault" data-clipboard-target="#cp-9fc0a73bdbbb524b06b42daf73d8e888"
             role="button" aria-label='Копировать'>
            <i class="fas fa-copy fa-fw"></i>
          </a>
        </li>
      </ul>
    </div>
  </div>
</div>

<ol start="13">
<li>(2) Отображение информации определённой группе пользователей.</li>
</ol>



<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-14 shortcode-codeblock-html">
  <div class="d-flex overflow-hidden">
    <div class="flex-grow-1 rounded overflow-hidden" id="cp-9b000ec7c8f1ce7414a9170e279d29b9">
      
      <pre><code class='language-html'>&lt;xf:if is=&#34;{{$xf.visitor.isMemberOf(X)}}&#34;&gt;
  &lt;!-- content --&gt;
&lt;/xf:if&gt;</code></pre>
    </div>
    <div class="flex-shrink-0">
      <ul class="list-inline mb-0">
        <li class="list-inline-item" data-bs-tooltip data-bs-title='Копировать'>
          <a class="text-body" href="#"
             data-fn="clipboard preventDefault" data-clipboard-target="#cp-9b000ec7c8f1ce7414a9170e279d29b9"
             role="button" aria-label='Копировать'>
            <i class="fas fa-copy fa-fw"></i>
          </a>
        </li>
      </ul>
    </div>
  </div>
</div>

<ol start="14">
<li>(1) Скрытие информации от определённых групп пользователей.</li>
</ol>



<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-15 shortcode-codeblock-html">
  <div class="d-flex overflow-hidden">
    <div class="flex-grow-1 rounded overflow-hidden" id="cp-5b9934ecca25f47a6b7032c169d341a0">
      
      <pre><code class='language-html'>&lt;xf:if is=&#34;{{!$xf.visitor.isMemberOf([X, Y])}}&#34;&gt;
  &lt;!-- content --&gt;
&lt;/xf:if&gt;</code></pre>
    </div>
    <div class="flex-shrink-0">
      <ul class="list-inline mb-0">
        <li class="list-inline-item" data-bs-tooltip data-bs-title='Копировать'>
          <a class="text-body" href="#"
             data-fn="clipboard preventDefault" data-clipboard-target="#cp-5b9934ecca25f47a6b7032c169d341a0"
             role="button" aria-label='Копировать'>
            <i class="fas fa-copy fa-fw"></i>
          </a>
        </li>
      </ul>
    </div>
  </div>
</div>

<ol start="14">
<li>(2) Скрытие информации от определённой группы пользователей.</li>
</ol>



<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-16 shortcode-codeblock-html">
  <div class="d-flex overflow-hidden">
    <div class="flex-grow-1 rounded overflow-hidden" id="cp-954ea5c76b734b220295eaa17919b9fb">
      
      <pre><code class='language-html'>&lt;xf:if is=&#34;{{!$xf.visitor.isMemberOf(X)}}&#34;&gt;
  &lt;!-- content --&gt;
&lt;/xf:if&gt;</code></pre>
    </div>
    <div class="flex-shrink-0">
      <ul class="list-inline mb-0">
        <li class="list-inline-item" data-bs-tooltip data-bs-title='Копировать'>
          <a class="text-body" href="#"
             data-fn="clipboard preventDefault" data-clipboard-target="#cp-954ea5c76b734b220295eaa17919b9fb"
             role="button" aria-label='Копировать'>
            <i class="fas fa-copy fa-fw"></i>
          </a>
        </li>
      </ul>
    </div>
  </div>
</div>

<ol start="15">
<li>(1) Отображение информации после первого сообщения в теме.</li>
</ol>



<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-17 shortcode-codeblock-html">
  <div class="d-flex overflow-hidden">
    <div class="flex-grow-1 rounded overflow-hidden" id="cp-d3eea51dae6fb288a510cf590135614b">
      
      <pre><code class='language-html'>&lt;xf:if is=&#34;$post.position % $xf.options.messagesPerPage == 0&#34;&gt;
  &lt;!-- content --&gt;
&lt;/xf:if&gt;</code></pre>
    </div>
    <div class="flex-shrink-0">
      <ul class="list-inline mb-0">
        <li class="list-inline-item" data-bs-tooltip data-bs-title='Копировать'>
          <a class="text-body" href="#"
             data-fn="clipboard preventDefault" data-clipboard-target="#cp-d3eea51dae6fb288a510cf590135614b"
             role="button" aria-label='Копировать'>
            <i class="fas fa-copy fa-fw"></i>
          </a>
        </li>
      </ul>
    </div>
  </div>
</div>

<ol start="15">
<li>(2) Отображение информации через определённое количества сообщений.</li>
</ol>



<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-18 shortcode-codeblock-html">
  <div class="d-flex overflow-hidden">
    <div class="flex-grow-1 rounded overflow-hidden" id="cp-80530d7156cec825eb3ab4e2d53a5a82">
      
      <pre><code class='language-html'>&lt;xf:if is=&#34;$post.position % $xf.options.messagesPerPage == X&#34;&gt;
  &lt;!-- content --&gt;
&lt;/xf:if&gt;</code></pre>
    </div>
    <div class="flex-shrink-0">
      <ul class="list-inline mb-0">
        <li class="list-inline-item" data-bs-tooltip data-bs-title='Копировать'>
          <a class="text-body" href="#"
             data-fn="clipboard preventDefault" data-clipboard-target="#cp-80530d7156cec825eb3ab4e2d53a5a82"
             role="button" aria-label='Копировать'>
            <i class="fas fa-copy fa-fw"></i>
          </a>
        </li>
      </ul>
    </div>
  </div>
</div>

<ol start="16">
<li>Отображение информации на странице, на которой присутствует боковая панель.</li>
</ol>



<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-19 shortcode-codeblock-html">
  <div class="d-flex overflow-hidden">
    <div class="flex-grow-1 rounded overflow-hidden" id="cp-0c9076b6ac8714918724ee9fe226443e">
      
      <pre><code class='language-html'>&lt;xf:if is=&#34;$sidebar&#34;&gt;
  &lt;!-- content --&gt;
&lt;/xf:if&gt;</code></pre>
    </div>
    <div class="flex-shrink-0">
      <ul class="list-inline mb-0">
        <li class="list-inline-item" data-bs-tooltip data-bs-title='Копировать'>
          <a class="text-body" href="#"
             data-fn="clipboard preventDefault" data-clipboard-target="#cp-0c9076b6ac8714918724ee9fe226443e"
             role="button" aria-label='Копировать'>
            <i class="fas fa-copy fa-fw"></i>
          </a>
        </li>
      </ul>
    </div>
  </div>
</div>

<ol start="17">
<li>Отображение информации на главной (домашней) странице форума.</li>
</ol>



<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-20 shortcode-codeblock-html">
  <div class="d-flex overflow-hidden">
    <div class="flex-grow-1 rounded overflow-hidden" id="cp-d523dc55d365d1906e1d7f38dceb7d81">
      
      <pre><code class='language-html'>&lt;xf:if is=&#34;$template == &#39;forum_list&#39;&#34;&gt;
  &lt;!-- content --&gt;
&lt;/xf:if&gt;</code></pre>
    </div>
    <div class="flex-shrink-0">
      <ul class="list-inline mb-0">
        <li class="list-inline-item" data-bs-tooltip data-bs-title='Копировать'>
          <a class="text-body" href="#"
             data-fn="clipboard preventDefault" data-clipboard-target="#cp-d523dc55d365d1906e1d7f38dceb7d81"
             role="button" aria-label='Копировать'>
            <i class="fas fa-copy fa-fw"></i>
          </a>
        </li>
      </ul>
    </div>
  </div>
</div>

<ol start="18">
<li>Скрытие информации только с главной (домашней) странице форума.</li>
</ol>



<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-21 shortcode-codeblock-html">
  <div class="d-flex overflow-hidden">
    <div class="flex-grow-1 rounded overflow-hidden" id="cp-f69c7f7942e030a6d8d8b17110ba8009">
      
      <pre><code class='language-html'>&lt;xf:if is=&#34;$template !== &#39;forum_list&#39;&#34;&gt;
  &lt;!-- content --&gt;
&lt;/xf:if&gt;</code></pre>
    </div>
    <div class="flex-shrink-0">
      <ul class="list-inline mb-0">
        <li class="list-inline-item" data-bs-tooltip data-bs-title='Копировать'>
          <a class="text-body" href="#"
             data-fn="clipboard preventDefault" data-clipboard-target="#cp-f69c7f7942e030a6d8d8b17110ba8009"
             role="button" aria-label='Копировать'>
            <i class="fas fa-copy fa-fw"></i>
          </a>
        </li>
      </ul>
    </div>
  </div>
</div>

<ol start="19">
<li>Отображение информации на странице создания новой темы.</li>
</ol>



<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-22 shortcode-codeblock-html">
  <div class="d-flex overflow-hidden">
    <div class="flex-grow-1 rounded overflow-hidden" id="cp-1aee1288915a01f30045ad1c40073754">
      
      <pre><code class='language-html'>&lt;xf:if is=&#34;$template == &#39;forum_post_thread&#39;&#34;&gt;
  &lt;!-- content --&gt;
&lt;/xf:if&gt;</code></pre>
    </div>
    <div class="flex-shrink-0">
      <ul class="list-inline mb-0">
        <li class="list-inline-item" data-bs-tooltip data-bs-title='Копировать'>
          <a class="text-body" href="#"
             data-fn="clipboard preventDefault" data-clipboard-target="#cp-1aee1288915a01f30045ad1c40073754"
             role="button" aria-label='Копировать'>
            <i class="fas fa-copy fa-fw"></i>
          </a>
        </li>
      </ul>
    </div>
  </div>
</div>

<ol start="20">
<li>Скрытие информации на странице создания новой темы.</li>
</ol>



<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-23 shortcode-codeblock-html">
  <div class="d-flex overflow-hidden">
    <div class="flex-grow-1 rounded overflow-hidden" id="cp-79a99613ec7230a3eab7e44509c9afd7">
      
      <pre><code class='language-html'>&lt;xf:if is=&#34;$template != &#39;forum_post_thread&#39;&#34;&gt;
  &lt;!-- content --&gt;
&lt;/xf:if&gt;</code></pre>
    </div>
    <div class="flex-shrink-0">
      <ul class="list-inline mb-0">
        <li class="list-inline-item" data-bs-tooltip data-bs-title='Копировать'>
          <a class="text-body" href="#"
             data-fn="clipboard preventDefault" data-clipboard-target="#cp-79a99613ec7230a3eab7e44509c9afd7"
             role="button" aria-label='Копировать'>
            <i class="fas fa-copy fa-fw"></i>
          </a>
        </li>
      </ul>
    </div>
  </div>
</div>

<ol start="21">
<li>Отображение информации на странице создания нового ресурса.</li>
</ol>



<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-24 shortcode-codeblock-html">
  <div class="d-flex overflow-hidden">
    <div class="flex-grow-1 rounded overflow-hidden" id="cp-7f7f26014b5daed726c0c7c71c8be59a">
      
      <pre><code class='language-html'>&lt;xf:if is=&#34;$template == &#39;xfrm_category_add_resource&#39;&#34;&gt;
  &lt;!-- content --&gt;
&lt;/xf:if&gt;</code></pre>
    </div>
    <div class="flex-shrink-0">
      <ul class="list-inline mb-0">
        <li class="list-inline-item" data-bs-tooltip data-bs-title='Копировать'>
          <a class="text-body" href="#"
             data-fn="clipboard preventDefault" data-clipboard-target="#cp-7f7f26014b5daed726c0c7c71c8be59a"
             role="button" aria-label='Копировать'>
            <i class="fas fa-copy fa-fw"></i>
          </a>
        </li>
      </ul>
    </div>
  </div>
</div>

<ol start="22">
<li>Скрытие информации на странице создания нового ресурса.</li>
</ol>



<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-25 shortcode-codeblock-html">
  <div class="d-flex overflow-hidden">
    <div class="flex-grow-1 rounded overflow-hidden" id="cp-eb933e248ceae2386a7f9fdc58af1cb2">
      
      <pre><code class='language-html'>&lt;xf:if is=&#34;$template != &#39;xfrm_category_add_resource&#39;&#34;&gt;
  &lt;!-- content --&gt;
&lt;/xf:if&gt;</code></pre>
    </div>
    <div class="flex-shrink-0">
      <ul class="list-inline mb-0">
        <li class="list-inline-item" data-bs-tooltip data-bs-title='Копировать'>
          <a class="text-body" href="#"
             data-fn="clipboard preventDefault" data-clipboard-target="#cp-eb933e248ceae2386a7f9fdc58af1cb2"
             role="button" aria-label='Копировать'>
            <i class="fas fa-copy fa-fw"></i>
          </a>
        </li>
      </ul>
    </div>
  </div>
</div>

<ol start="23">
<li>Отображение информации на странице поисковой формы.</li>
</ol>



<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-26 shortcode-codeblock-html">
  <div class="d-flex overflow-hidden">
    <div class="flex-grow-1 rounded overflow-hidden" id="cp-d8f23f16b33b71ce2977a8885bebced6">
      
      <pre><code class='language-html'>&lt;xf:if is=&#34;$template == &#39;search_form&#39;&#34;&gt;
  &lt;!-- content --&gt;
&lt;/xf:if&gt;</code></pre>
    </div>
    <div class="flex-shrink-0">
      <ul class="list-inline mb-0">
        <li class="list-inline-item" data-bs-tooltip data-bs-title='Копировать'>
          <a class="text-body" href="#"
             data-fn="clipboard preventDefault" data-clipboard-target="#cp-d8f23f16b33b71ce2977a8885bebced6"
             role="button" aria-label='Копировать'>
            <i class="fas fa-copy fa-fw"></i>
          </a>
        </li>
      </ul>
    </div>
  </div>
</div>

<ol start="24">
<li>Скрытие информации на странице поисковой формы.</li>
</ol>



<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-27 shortcode-codeblock-html">
  <div class="d-flex overflow-hidden">
    <div class="flex-grow-1 rounded overflow-hidden" id="cp-f9b94f75ec73592b0e6c787e07ca2f03">
      
      <pre><code class='language-html'>&lt;xf:if is=&#34;$template != &#39;search_form&#39;&#34;&gt;
  &lt;!-- content --&gt;
&lt;/xf:if&gt;</code></pre>
    </div>
    <div class="flex-shrink-0">
      <ul class="list-inline mb-0">
        <li class="list-inline-item" data-bs-tooltip data-bs-title='Копировать'>
          <a class="text-body" href="#"
             data-fn="clipboard preventDefault" data-clipboard-target="#cp-f9b94f75ec73592b0e6c787e07ca2f03"
             role="button" aria-label='Копировать'>
            <i class="fas fa-copy fa-fw"></i>
          </a>
        </li>
      </ul>
    </div>
  </div>
</div>

<ol start="25">
<li>Отображение информации на странице &ldquo;Что нового?&rdquo;.</li>
</ol>



<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-28 shortcode-codeblock-html">
  <div class="d-flex overflow-hidden">
    <div class="flex-grow-1 rounded overflow-hidden" id="cp-12f333add056de1b00a803141246468b">
      
      <pre><code class='language-html'>&lt;xf:if is=&#34;$template == &#39;whats_new&#39;&#34;&gt;
  &lt;!-- content --&gt;
&lt;/xf:if&gt;</code></pre>
    </div>
    <div class="flex-shrink-0">
      <ul class="list-inline mb-0">
        <li class="list-inline-item" data-bs-tooltip data-bs-title='Копировать'>
          <a class="text-body" href="#"
             data-fn="clipboard preventDefault" data-clipboard-target="#cp-12f333add056de1b00a803141246468b"
             role="button" aria-label='Копировать'>
            <i class="fas fa-copy fa-fw"></i>
          </a>
        </li>
      </ul>
    </div>
  </div>
</div>

<ol start="26">
<li>Скрытие информации на странице &ldquo;Что нового?&rdquo;.</li>
</ol>



<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-29 shortcode-codeblock-html">
  <div class="d-flex overflow-hidden">
    <div class="flex-grow-1 rounded overflow-hidden" id="cp-92d5b78729869e8fcf821341fa47c543">
      
      <pre><code class='language-html'>&lt;xf:if is=&#34;$template != &#39;whats_new&#39;&#34;&gt;
  &lt;!-- content --&gt;
&lt;/xf:if&gt;</code></pre>
    </div>
    <div class="flex-shrink-0">
      <ul class="list-inline mb-0">
        <li class="list-inline-item" data-bs-tooltip data-bs-title='Копировать'>
          <a class="text-body" href="#"
             data-fn="clipboard preventDefault" data-clipboard-target="#cp-92d5b78729869e8fcf821341fa47c543"
             role="button" aria-label='Копировать'>
            <i class="fas fa-copy fa-fw"></i>
          </a>
        </li>
      </ul>
    </div>
  </div>
</div>

<ol start="27">
<li>Отображение информации на странице просмотра личной переписки.</li>
</ol>



<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-30 shortcode-codeblock-html">
  <div class="d-flex overflow-hidden">
    <div class="flex-grow-1 rounded overflow-hidden" id="cp-93bc63e00bd93c602ae24ab8d2a2f53b">
      
      <pre><code class='language-html'>&lt;xf:if is=&#34;$template == &#39;conversation_view&#39;&#34;&gt;
  &lt;!-- content --&gt;
&lt;/xf:if&gt;</code></pre>
    </div>
    <div class="flex-shrink-0">
      <ul class="list-inline mb-0">
        <li class="list-inline-item" data-bs-tooltip data-bs-title='Копировать'>
          <a class="text-body" href="#"
             data-fn="clipboard preventDefault" data-clipboard-target="#cp-93bc63e00bd93c602ae24ab8d2a2f53b"
             role="button" aria-label='Копировать'>
            <i class="fas fa-copy fa-fw"></i>
          </a>
        </li>
      </ul>
    </div>
  </div>
</div>

<ol start="28">
<li>Скрытие информации на странице просмотра личной переписки.</li>
</ol>



<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-31 shortcode-codeblock-html">
  <div class="d-flex overflow-hidden">
    <div class="flex-grow-1 rounded overflow-hidden" id="cp-a270a9fb748c3a72401b8bf7d343d2d1">
      
      <pre><code class='language-html'>&lt;xf:if is=&#34;$template != &#39;conversation_view&#39;&#34;&gt;
  &lt;!-- content --&gt;
&lt;/xf:if&gt;</code></pre>
    </div>
    <div class="flex-shrink-0">
      <ul class="list-inline mb-0">
        <li class="list-inline-item" data-bs-tooltip data-bs-title='Копировать'>
          <a class="text-body" href="#"
             data-fn="clipboard preventDefault" data-clipboard-target="#cp-a270a9fb748c3a72401b8bf7d343d2d1"
             role="button" aria-label='Копировать'>
            <i class="fas fa-copy fa-fw"></i>
          </a>
        </li>
      </ul>
    </div>
  </div>
</div>

<ol start="29">
<li>Отображение информации на странице просмотра списка личных переписок.</li>
</ol>



<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-32 shortcode-codeblock-html">
  <div class="d-flex overflow-hidden">
    <div class="flex-grow-1 rounded overflow-hidden" id="cp-ac13f55f0601a67cb5e6224227ddb357">
      
      <pre><code class='language-html'>&lt;xf:if is=&#34;$template == &#39;conversation_list&#39;&#34;&gt;
  &lt;!-- content --&gt;
&lt;/xf:if&gt;</code></pre>
    </div>
    <div class="flex-shrink-0">
      <ul class="list-inline mb-0">
        <li class="list-inline-item" data-bs-tooltip data-bs-title='Копировать'>
          <a class="text-body" href="#"
             data-fn="clipboard preventDefault" data-clipboard-target="#cp-ac13f55f0601a67cb5e6224227ddb357"
             role="button" aria-label='Копировать'>
            <i class="fas fa-copy fa-fw"></i>
          </a>
        </li>
      </ul>
    </div>
  </div>
</div>

<ol start="30">
<li>Скрытие информации на странице просмотра списка личных переписок.</li>
</ol>



<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-33 shortcode-codeblock-html">
  <div class="d-flex overflow-hidden">
    <div class="flex-grow-1 rounded overflow-hidden" id="cp-e3c510e63d04516d9d8304f147486aaf">
      
      <pre><code class='language-html'>&lt;xf:if is=&#34;$template != &#39;conversation_list&#39;&#34;&gt;
  &lt;!-- content --&gt;
&lt;/xf:if&gt;</code></pre>
    </div>
    <div class="flex-shrink-0">
      <ul class="list-inline mb-0">
        <li class="list-inline-item" data-bs-tooltip data-bs-title='Копировать'>
          <a class="text-body" href="#"
             data-fn="clipboard preventDefault" data-clipboard-target="#cp-e3c510e63d04516d9d8304f147486aaf"
             role="button" aria-label='Копировать'>
            <i class="fas fa-copy fa-fw"></i>
          </a>
        </li>
      </ul>
    </div>
  </div>
</div>

<ol start="31">
<li>Отображение информации на главной странице ресурсов.</li>
</ol>



<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-34 shortcode-codeblock-html">
  <div class="d-flex overflow-hidden">
    <div class="flex-grow-1 rounded overflow-hidden" id="cp-899927e6a269283538aeb8b94254fb6a">
      
      <pre><code class='language-html'>&lt;xf:if is=&#34;$template == &#39;xfrm_overview&#39;&#34;&gt;
  &lt;!-- content --&gt;
&lt;/xf:if&gt;</code></pre>
    </div>
    <div class="flex-shrink-0">
      <ul class="list-inline mb-0">
        <li class="list-inline-item" data-bs-tooltip data-bs-title='Копировать'>
          <a class="text-body" href="#"
             data-fn="clipboard preventDefault" data-clipboard-target="#cp-899927e6a269283538aeb8b94254fb6a"
             role="button" aria-label='Копировать'>
            <i class="fas fa-copy fa-fw"></i>
          </a>
        </li>
      </ul>
    </div>
  </div>
</div>

<ol start="32">
<li>Скрытие информации на главной странице ресурсов.</li>
</ol>



<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-35 shortcode-codeblock-html">
  <div class="d-flex overflow-hidden">
    <div class="flex-grow-1 rounded overflow-hidden" id="cp-8ea6b7ec1854fc3d7ca38f1ca1d83014">
      
      <pre><code class='language-html'>&lt;xf:if is=&#34;$template != &#39;xfrm_overview&#39;&#34;&gt;
  &lt;!-- content --&gt;
&lt;/xf:if&gt;</code></pre>
    </div>
    <div class="flex-shrink-0">
      <ul class="list-inline mb-0">
        <li class="list-inline-item" data-bs-tooltip data-bs-title='Копировать'>
          <a class="text-body" href="#"
             data-fn="clipboard preventDefault" data-clipboard-target="#cp-8ea6b7ec1854fc3d7ca38f1ca1d83014"
             role="button" aria-label='Копировать'>
            <i class="fas fa-copy fa-fw"></i>
          </a>
        </li>
      </ul>
    </div>
  </div>
</div>

<ol start="33">
<li>Отображение информации на странице просмотра ресурса.</li>
</ol>



<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-36 shortcode-codeblock-html">
  <div class="d-flex overflow-hidden">
    <div class="flex-grow-1 rounded overflow-hidden" id="cp-74e8c774767dd8dde52bf7b535bcdf09">
      
      <pre><code class='language-html'>&lt;xf:if is=&#34;$template == &#39;xfrm_resource_view&#39;&#34;&gt;
  &lt;!-- content --&gt;
&lt;/xf:if&gt;</code></pre>
    </div>
    <div class="flex-shrink-0">
      <ul class="list-inline mb-0">
        <li class="list-inline-item" data-bs-tooltip data-bs-title='Копировать'>
          <a class="text-body" href="#"
             data-fn="clipboard preventDefault" data-clipboard-target="#cp-74e8c774767dd8dde52bf7b535bcdf09"
             role="button" aria-label='Копировать'>
            <i class="fas fa-copy fa-fw"></i>
          </a>
        </li>
      </ul>
    </div>
  </div>
</div>

<ol start="34">
<li>Скрытие информации на странице просмотра ресурса.</li>
</ol>



<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-37 shortcode-codeblock-html">
  <div class="d-flex overflow-hidden">
    <div class="flex-grow-1 rounded overflow-hidden" id="cp-a8ec4131f475d44fbf0b113d1410b229">
      
      <pre><code class='language-html'>&lt;xf:if is=&#34;$template != &#39;xfrm_resource_view&#39;&#34;&gt;
  &lt;!-- content --&gt;
&lt;/xf:if&gt;</code></pre>
    </div>
    <div class="flex-shrink-0">
      <ul class="list-inline mb-0">
        <li class="list-inline-item" data-bs-tooltip data-bs-title='Копировать'>
          <a class="text-body" href="#"
             data-fn="clipboard preventDefault" data-clipboard-target="#cp-a8ec4131f475d44fbf0b113d1410b229"
             role="button" aria-label='Копировать'>
            <i class="fas fa-copy fa-fw"></i>
          </a>
        </li>
      </ul>
    </div>
  </div>
</div>

<ol start="35">
<li>Отображение информации на странице просмотра темы.</li>
</ol>



<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-38 shortcode-codeblock-html">
  <div class="d-flex overflow-hidden">
    <div class="flex-grow-1 rounded overflow-hidden" id="cp-8a21335d37685f465815c4845afadd94">
      
      <pre><code class='language-html'>&lt;xf:if is=&#34;$template == &#39;thread_view&#39;&#34;&gt;
  &lt;!-- content --&gt;
&lt;/xf:if&gt;</code></pre>
    </div>
    <div class="flex-shrink-0">
      <ul class="list-inline mb-0">
        <li class="list-inline-item" data-bs-tooltip data-bs-title='Копировать'>
          <a class="text-body" href="#"
             data-fn="clipboard preventDefault" data-clipboard-target="#cp-8a21335d37685f465815c4845afadd94"
             role="button" aria-label='Копировать'>
            <i class="fas fa-copy fa-fw"></i>
          </a>
        </li>
      </ul>
    </div>
  </div>
</div>

<ol start="36">
<li>Скрытие информации на странице просмотра темы.</li>
</ol>



<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-39 shortcode-codeblock-html">
  <div class="d-flex overflow-hidden">
    <div class="flex-grow-1 rounded overflow-hidden" id="cp-0d360f567482647230dbbb419759cc8b">
      
      <pre><code class='language-html'>&lt;xf:if is=&#34;$template !=&#39;thread_view&#39;&#34;&gt;
  &lt;!-- content --&gt;
&lt;/xf:if&gt;</code></pre>
    </div>
    <div class="flex-shrink-0">
      <ul class="list-inline mb-0">
        <li class="list-inline-item" data-bs-tooltip data-bs-title='Копировать'>
          <a class="text-body" href="#"
             data-fn="clipboard preventDefault" data-clipboard-target="#cp-0d360f567482647230dbbb419759cc8b"
             role="button" aria-label='Копировать'>
            <i class="fas fa-copy fa-fw"></i>
          </a>
        </li>
      </ul>
    </div>
  </div>
</div>

<ol start="37">
<li>Отображение информации на странице просмотра форума (раздела).</li>
</ol>



<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-40 shortcode-codeblock-html">
  <div class="d-flex overflow-hidden">
    <div class="flex-grow-1 rounded overflow-hidden" id="cp-1427f03001f2b030e1572ed6083797e3">
      
      <pre><code class='language-html'>&lt;xf:if is=&#34;$template ==&#39;forum_view&#39;&#34;&gt;
  &lt;!-- content --&gt;
&lt;/xf:if&gt;</code></pre>
    </div>
    <div class="flex-shrink-0">
      <ul class="list-inline mb-0">
        <li class="list-inline-item" data-bs-tooltip data-bs-title='Копировать'>
          <a class="text-body" href="#"
             data-fn="clipboard preventDefault" data-clipboard-target="#cp-1427f03001f2b030e1572ed6083797e3"
             role="button" aria-label='Копировать'>
            <i class="fas fa-copy fa-fw"></i>
          </a>
        </li>
      </ul>
    </div>
  </div>
</div>

<ol start="38">
<li>Скрытие информации на странице просмотра форума (раздела).</li>
</ol>



<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-41 shortcode-codeblock-html">
  <div class="d-flex overflow-hidden">
    <div class="flex-grow-1 rounded overflow-hidden" id="cp-a2568a65b9bd9c720a8c3ed97dabf5ea">
      
      <pre><code class='language-html'>&lt;xf:if is=&#34;$template != &#39;forum_view&#39;&#34;&gt;
  &lt;!-- content --&gt;
&lt;/xf:if&gt;</code></pre>
    </div>
    <div class="flex-shrink-0">
      <ul class="list-inline mb-0">
        <li class="list-inline-item" data-bs-tooltip data-bs-title='Копировать'>
          <a class="text-body" href="#"
             data-fn="clipboard preventDefault" data-clipboard-target="#cp-a2568a65b9bd9c720a8c3ed97dabf5ea"
             role="button" aria-label='Копировать'>
            <i class="fas fa-copy fa-fw"></i>
          </a>
        </li>
      </ul>
    </div>
  </div>
</div>

<ol start="39">
<li>Отображение информации &ldquo;наказанным&rdquo; пользователям.</li>
</ol>



<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-42 shortcode-codeblock-html">
  <div class="d-flex overflow-hidden">
    <div class="flex-grow-1 rounded overflow-hidden" id="cp-53376676ee4c6e25793ca0391f9c64a1">
      
      <pre><code class='language-html'>&lt;xf:if is=&#34;{$xf.visitor.Option.is_discouraged}&#34;&gt;
  &lt;!-- content --&gt;
&lt;/xf:if&gt;</code></pre>
    </div>
    <div class="flex-shrink-0">
      <ul class="list-inline mb-0">
        <li class="list-inline-item" data-bs-tooltip data-bs-title='Копировать'>
          <a class="text-body" href="#"
             data-fn="clipboard preventDefault" data-clipboard-target="#cp-53376676ee4c6e25793ca0391f9c64a1"
             role="button" aria-label='Копировать'>
            <i class="fas fa-copy fa-fw"></i>
          </a>
        </li>
      </ul>
    </div>
  </div>
</div>

<ol start="40">
<li>Отображение информации пользователям, которые имеют Gravatar.</li>
</ol>



<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-43 shortcode-codeblock-html">
  <div class="d-flex overflow-hidden">
    <div class="flex-grow-1 rounded overflow-hidden" id="cp-7cbca8ab8f6b41463b32efa5197b992e">
      
      <pre><code class='language-html'>&lt;xf:if is=&#34;{$xf.visitor.gravatar}&#34;&gt;
  &lt;!-- content --&gt;
&lt;/xf:if&gt;</code></pre>
    </div>
    <div class="flex-shrink-0">
      <ul class="list-inline mb-0">
        <li class="list-inline-item" data-bs-tooltip data-bs-title='Копировать'>
          <a class="text-body" href="#"
             data-fn="clipboard preventDefault" data-clipboard-target="#cp-7cbca8ab8f6b41463b32efa5197b992e"
             role="button" aria-label='Копировать'>
            <i class="fas fa-copy fa-fw"></i>
          </a>
        </li>
      </ul>
    </div>
  </div>
</div>

<ol start="41">
<li>Отображение информации пользователям поддержки форума.</li>
</ol>



<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-44 shortcode-codeblock-html">
  <div class="d-flex overflow-hidden">
    <div class="flex-grow-1 rounded overflow-hidden" id="cp-f07b3c34b7fe4b7219987f61db51e519">
      
      <pre><code class='language-html'>&lt;xf:if is=&#34;{$xf.visitor.is_staff}&#34;&gt;
  &lt;!-- content --&gt;
&lt;/xf:if&gt;</code></pre>
    </div>
    <div class="flex-shrink-0">
      <ul class="list-inline mb-0">
        <li class="list-inline-item" data-bs-tooltip data-bs-title='Копировать'>
          <a class="text-body" href="#"
             data-fn="clipboard preventDefault" data-clipboard-target="#cp-f07b3c34b7fe4b7219987f61db51e519"
             role="button" aria-label='Копировать'>
            <i class="fas fa-copy fa-fw"></i>
          </a>
        </li>
      </ul>
    </div>
  </div>
</div>

<ol start="42">
<li>Отображение информации пользователям без подтверждённого адреса e-mail.</li>
</ol>



<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-45 shortcode-codeblock-html">
  <div class="d-flex overflow-hidden">
    <div class="flex-grow-1 rounded overflow-hidden" id="cp-74081f641d699e47d6fefb0f24a10099">
      
      <pre><code class='language-html'>&lt;xf:if is=&#34;{$xf.visitor.isAwaitingEmailConfirmation()}&#34;&gt;
  &lt;!-- content --&gt;
&lt;/xf:if&gt;</code></pre>
    </div>
    <div class="flex-shrink-0">
      <ul class="list-inline mb-0">
        <li class="list-inline-item" data-bs-tooltip data-bs-title='Копировать'>
          <a class="text-body" href="#"
             data-fn="clipboard preventDefault" data-clipboard-target="#cp-74081f641d699e47d6fefb0f24a10099"
             role="button" aria-label='Копировать'>
            <i class="fas fa-copy fa-fw"></i>
          </a>
        </li>
      </ul>
    </div>
  </div>
</div>

<ol start="43">
<li>Отображение информации в нескольких форумах (разделах).</li>
</ol>



<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-46 shortcode-codeblock-html">
  <div class="d-flex overflow-hidden">
    <div class="flex-grow-1 rounded overflow-hidden" id="cp-4af824ee46e92e062f30857b9466cd18">
      
      <pre><code class='language-html'>&lt;xf:if is=&#34;in_array({$forum.node_id}, [X, Y, Z])&#34;&gt;
  &lt;!-- content --&gt;
&lt;/xf:if&gt;</code></pre>
    </div>
    <div class="flex-shrink-0">
      <ul class="list-inline mb-0">
        <li class="list-inline-item" data-bs-tooltip data-bs-title='Копировать'>
          <a class="text-body" href="#"
             data-fn="clipboard preventDefault" data-clipboard-target="#cp-4af824ee46e92e062f30857b9466cd18"
             role="button" aria-label='Копировать'>
            <i class="fas fa-copy fa-fw"></i>
          </a>
        </li>
      </ul>
    </div>
  </div>
</div>

<ol start="44">
<li>Скрытие информации в нескольких форумах (разделах).</li>
</ol>



<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-47 shortcode-codeblock-html">
  <div class="d-flex overflow-hidden">
    <div class="flex-grow-1 rounded overflow-hidden" id="cp-ce38a55e5e620ca55d8c29feadd84557">
      
      <pre><code class='language-html'>&lt;xf:if is=&#34;in_array($forum.node_id, [X, Y, Z])&#34;&gt;
  &lt;!-- content --&gt;
&lt;/xf:if&gt;</code></pre>
    </div>
    <div class="flex-shrink-0">
      <ul class="list-inline mb-0">
        <li class="list-inline-item" data-bs-tooltip data-bs-title='Копировать'>
          <a class="text-body" href="#"
             data-fn="clipboard preventDefault" data-clipboard-target="#cp-ce38a55e5e620ca55d8c29feadd84557"
             role="button" aria-label='Копировать'>
            <i class="fas fa-copy fa-fw"></i>
          </a>
        </li>
      </ul>
    </div>
  </div>
</div>

<ol start="45">
<li>Отображение информации в определённом форуме (разделе).</li>
</ol>



<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-48 shortcode-codeblock-html">
  <div class="d-flex overflow-hidden">
    <div class="flex-grow-1 rounded overflow-hidden" id="cp-6da01d80f2691d0fda38e167ae39838c">
      
      <pre><code class='language-html'>&lt;xf:if is=&#34;$forum.node_id == X&#34;&gt;
  &lt;!-- content --&gt;
&lt;/xf:if&gt;</code></pre>
    </div>
    <div class="flex-shrink-0">
      <ul class="list-inline mb-0">
        <li class="list-inline-item" data-bs-tooltip data-bs-title='Копировать'>
          <a class="text-body" href="#"
             data-fn="clipboard preventDefault" data-clipboard-target="#cp-6da01d80f2691d0fda38e167ae39838c"
             role="button" aria-label='Копировать'>
            <i class="fas fa-copy fa-fw"></i>
          </a>
        </li>
      </ul>
    </div>
  </div>
</div>

<ol start="46">
<li>Скрытие информации в определённом форуме (разделе).</li>
</ol>



<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-49 shortcode-codeblock-html">
  <div class="d-flex overflow-hidden">
    <div class="flex-grow-1 rounded overflow-hidden" id="cp-da672bf0801a2bf6c9c15912bdd8285e">
      
      <pre><code class='language-html'>&lt;xf:if is=&#34;$forum.node_id != 3&#34;&gt;
  &lt;!-- content --&gt;
&lt;/xf:if&gt;</code></pre>
    </div>
    <div class="flex-shrink-0">
      <ul class="list-inline mb-0">
        <li class="list-inline-item" data-bs-tooltip data-bs-title='Копировать'>
          <a class="text-body" href="#"
             data-fn="clipboard preventDefault" data-clipboard-target="#cp-da672bf0801a2bf6c9c15912bdd8285e"
             role="button" aria-label='Копировать'>
            <i class="fas fa-copy fa-fw"></i>
          </a>
        </li>
      </ul>
    </div>
  </div>
</div>

<ol start="47">
<li>Отображение информации только после первого сообщения в каждой теме.</li>
</ol>



<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-50 shortcode-codeblock-html">
  <div class="d-flex overflow-hidden">
    <div class="flex-grow-1 rounded overflow-hidden" id="cp-2d78603c890263edf5f60766a4267ab0">
      
      <pre><code class='language-html'>&lt;xf:if is=&#34;{$post.position} % {$xf.options.messagesPerPage} == 1&#34;&gt;
  &lt;!-- content --&gt;
&lt;/xf:if&gt;</code></pre>
    </div>
    <div class="flex-shrink-0">
      <ul class="list-inline mb-0">
        <li class="list-inline-item" data-bs-tooltip data-bs-title='Копировать'>
          <a class="text-body" href="#"
             data-fn="clipboard preventDefault" data-clipboard-target="#cp-2d78603c890263edf5f60766a4267ab0"
             role="button" aria-label='Копировать'>
            <i class="fas fa-copy fa-fw"></i>
          </a>
        </li>
      </ul>
    </div>
  </div>
</div>

<ol start="48">
<li>Отображение информации только внутри первого сообщения в каждой теме.</li>
</ol>



<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-51 shortcode-codeblock-html">
  <div class="d-flex overflow-hidden">
    <div class="flex-grow-1 rounded overflow-hidden" id="cp-7004d028e3294442386e847134d1c935">
      
      <pre><code class='language-html'>&lt;xf:if is=&#34;{$post.position} % {$xf.options.messagesPerPage} == 0&#34;&gt;
  &lt;!-- content --&gt;
&lt;/xf:if&gt;</code></pre>
    </div>
    <div class="flex-shrink-0">
      <ul class="list-inline mb-0">
        <li class="list-inline-item" data-bs-tooltip data-bs-title='Копировать'>
          <a class="text-body" href="#"
             data-fn="clipboard preventDefault" data-clipboard-target="#cp-7004d028e3294442386e847134d1c935"
             role="button" aria-label='Копировать'>
            <i class="fas fa-copy fa-fw"></i>
          </a>
        </li>
      </ul>
    </div>
  </div>
</div>

<ol start="49">
<li>Отображение информации только при заполненном поле местоположения.</li>
</ol>



<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-52 shortcode-codeblock-html">
  <div class="d-flex overflow-hidden">
    <div class="flex-grow-1 rounded overflow-hidden" id="cp-14e9ad82580bd84a3363b2731efb0e6a">
      
      <pre><code class='language-html'>&lt;xf:if is=&#34;{$xf.visitor.location}&#34;&gt;
  &lt;!-- content --&gt;
&lt;/xf:if&gt;</code></pre>
    </div>
    <div class="flex-shrink-0">
      <ul class="list-inline mb-0">
        <li class="list-inline-item" data-bs-tooltip data-bs-title='Копировать'>
          <a class="text-body" href="#"
             data-fn="clipboard preventDefault" data-clipboard-target="#cp-14e9ad82580bd84a3363b2731efb0e6a"
             role="button" aria-label='Копировать'>
            <i class="fas fa-copy fa-fw"></i>
          </a>
        </li>
      </ul>
    </div>
  </div>
</div>

<ol start="50">
<li>Отображение информации только при заполненном поле веб-сайта.</li>
</ol>



<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-53 shortcode-codeblock-html">
  <div class="d-flex overflow-hidden">
    <div class="flex-grow-1 rounded overflow-hidden" id="cp-b3dfb8f2baf0cad03a110ec09c1cd2de">
      
      <pre><code class='language-html'>&lt;xf:if is=&#34;{$xf.visitor.website}&#34;&gt;
  &lt;!-- content --&gt;
&lt;/xf:if&gt;</code></pre>
    </div>
    <div class="flex-shrink-0">
      <ul class="list-inline mb-0">
        <li class="list-inline-item" data-bs-tooltip data-bs-title='Копировать'>
          <a class="text-body" href="#"
             data-fn="clipboard preventDefault" data-clipboard-target="#cp-b3dfb8f2baf0cad03a110ec09c1cd2de"
             role="button" aria-label='Копировать'>
            <i class="fas fa-copy fa-fw"></i>
          </a>
        </li>
      </ul>
    </div>
  </div>
</div>

<ol start="51">
<li>Отображение информации при указанной подписи.</li>
</ol>



<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-54 shortcode-codeblock-html">
  <div class="d-flex overflow-hidden">
    <div class="flex-grow-1 rounded overflow-hidden" id="cp-811e90fe8781cbba50f8032cbe37e371">
      
      <pre><code class='language-html'>&lt;xf:if is=&#34;{$xf.visitor.signature}&#34;&gt;
  &lt;!-- content --&gt;
&lt;/xf:if&gt;</code></pre>
    </div>
    <div class="flex-shrink-0">
      <ul class="list-inline mb-0">
        <li class="list-inline-item" data-bs-tooltip data-bs-title='Копировать'>
          <a class="text-body" href="#"
             data-fn="clipboard preventDefault" data-clipboard-target="#cp-811e90fe8781cbba50f8032cbe37e371"
             role="button" aria-label='Копировать'>
            <i class="fas fa-copy fa-fw"></i>
          </a>
        </li>
      </ul>
    </div>
  </div>
</div>

<ol start="52">
<li>Отображение информации только активированным пользователям.</li>
</ol>



<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-55 shortcode-codeblock-html">
  <div class="d-flex overflow-hidden">
    <div class="flex-grow-1 rounded overflow-hidden" id="cp-ff3cab04afc1ab2d04c8606a19df3444">
      
      <pre><code class='language-html'>&lt;xf:if is=&#34;{$xf.visitor.user_state} == &#39;valid&#39;&#34;&gt;
  &lt;!-- content --&gt;
&lt;/xf:if&gt;</code></pre>
    </div>
    <div class="flex-shrink-0">
      <ul class="list-inline mb-0">
        <li class="list-inline-item" data-bs-tooltip data-bs-title='Копировать'>
          <a class="text-body" href="#"
             data-fn="clipboard preventDefault" data-clipboard-target="#cp-ff3cab04afc1ab2d04c8606a19df3444"
             role="button" aria-label='Копировать'>
            <i class="fas fa-copy fa-fw"></i>
          </a>
        </li>
      </ul>
    </div>
  </div>
</div>

<ol start="53">
<li>Отображение информации только пользователям, ожидающим подтверждения адреса e-mail.</li>
</ol>



<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-56 shortcode-codeblock-html">
  <div class="d-flex overflow-hidden">
    <div class="flex-grow-1 rounded overflow-hidden" id="cp-5b8e95cbe0167728a79b02cc917992e2">
      
      <pre><code class='language-html'>&lt;xf:if is=&#34;{$xf.visitor.user_state} == &#39;email_confirm_edit&#39;&#34;&gt;
  &lt;!-- content --&gt;
&lt;/xf:if&gt;</code></pre>
    </div>
    <div class="flex-shrink-0">
      <ul class="list-inline mb-0">
        <li class="list-inline-item" data-bs-tooltip data-bs-title='Копировать'>
          <a class="text-body" href="#"
             data-fn="clipboard preventDefault" data-clipboard-target="#cp-5b8e95cbe0167728a79b02cc917992e2"
             role="button" aria-label='Копировать'>
            <i class="fas fa-copy fa-fw"></i>
          </a>
        </li>
      </ul>
    </div>
  </div>
</div>

<ol start="54">
<li>Отображение информации только пользователям с проблемным адресом e-mail.</li>
</ol>



<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-57 shortcode-codeblock-html">
  <div class="d-flex overflow-hidden">
    <div class="flex-grow-1 rounded overflow-hidden" id="cp-75cc6b6422d90584431abfde226554d6">
      
      <pre><code class='language-html'>&lt;xf:if is=&#34;{$xf.visitor.user_state} == &#39;email_bounce&#39;&#34;&gt;
  &lt;!-- content --&gt;
&lt;/xf:if&gt;</code></pre>
    </div>
    <div class="flex-shrink-0">
      <ul class="list-inline mb-0">
        <li class="list-inline-item" data-bs-tooltip data-bs-title='Копировать'>
          <a class="text-body" href="#"
             data-fn="clipboard preventDefault" data-clipboard-target="#cp-75cc6b6422d90584431abfde226554d6"
             role="button" aria-label='Копировать'>
            <i class="fas fa-copy fa-fw"></i>
          </a>
        </li>
      </ul>
    </div>
  </div>
</div>

<ol start="55">
<li>Отображение информации, если ID пользователя = ID автора темы.</li>
</ol>



<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-58 shortcode-codeblock-html">
  <div class="d-flex overflow-hidden">
    <div class="flex-grow-1 rounded overflow-hidden" id="cp-a5b2abb912c8c3051cbef9b7d43b1fc3">
      
      <pre><code class='language-html'>&lt;xf:if is=&#34;{$__globals.thread} AND {$__globals.thread.user_id} == {$user.user_id}&#34;&gt;
  &lt;!-- content --&gt;
&lt;/xf:if&gt;</code></pre>
    </div>
    <div class="flex-shrink-0">
      <ul class="list-inline mb-0">
        <li class="list-inline-item" data-bs-tooltip data-bs-title='Копировать'>
          <a class="text-body" href="#"
             data-fn="clipboard preventDefault" data-clipboard-target="#cp-a5b2abb912c8c3051cbef9b7d43b1fc3"
             role="button" aria-label='Копировать'>
            <i class="fas fa-copy fa-fw"></i>
          </a>
        </li>
      </ul>
    </div>
  </div>
</div>

<ol start="56">
<li>Отображение информации пользователю, который является автором темы.</li>
</ol>



<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-59 shortcode-codeblock-html">
  <div class="d-flex overflow-hidden">
    <div class="flex-grow-1 rounded overflow-hidden" id="cp-4dc4bebc7290c00f28a3b4ad494d5d33">
      
      <pre><code class='language-html'>&lt;xf:if is=&#34;{$thread.user_id} == {$xf.visitor.user_id}&#34;&gt;
  &lt;!-- content --&gt;
&lt;/xf:if&gt;</code></pre>
    </div>
    <div class="flex-shrink-0">
      <ul class="list-inline mb-0">
        <li class="list-inline-item" data-bs-tooltip data-bs-title='Копировать'>
          <a class="text-body" href="#"
             data-fn="clipboard preventDefault" data-clipboard-target="#cp-4dc4bebc7290c00f28a3b4ad494d5d33"
             role="button" aria-label='Копировать'>
            <i class="fas fa-copy fa-fw"></i>
          </a>
        </li>
      </ul>
    </div>
  </div>
</div>]]></turbo:content></item><item turbo="true"><title>Настройка и использование Git</title><link>https://lib.onl/ru/articles/2021/08/c35f395f-5921-55eb-afcf-1ad812a1a9d9/</link><pubDate>Sat, 14 Aug 2021 15:52:38 +0000</pubDate><dc:creator>Kai Kimera</dc:creator><category>Linux</category><category>Git</category><category>Терминал</category><category>В доработке</category><yandex:related><link url="https://lib.onl/ru/articles/2021/07/3834fbed-71c8-5979-b6c2-236269f5ecea/">Зеркалирование репозитория между хостингами</link><link url="https://lib.onl/ru/articles/2021/05/8544b8ce-4586-578f-9633-e8ae43441a25/">Синхронизация репозитория от GitHub к GitLab</link></yandex:related><turbo:extendedHtml>true</turbo:extendedHtml><turbo:source>https://lib.onl/ru/articles/2021/08/c35f395f-5921-55eb-afcf-1ad812a1a9d9/</turbo:source><turbo:topic>Настройка и использование Git</turbo:topic><turbo:content><![CDATA[<p>В этой заметке я приведу параметры <span class="shortcode shortcode-tag"><a href="/ru/tags/git/" target="_blank">#Git</a></span>, которые сам использую при работе с репозиториями.</p>
<h2 id="первичная-настройка">
  <a class="link-body-emphasis" href="#%d0%bf%d0%b5%d1%80%d0%b2%d0%b8%d1%87%d0%bd%d0%b0%d1%8f-%d0%bd%d0%b0%d1%81%d1%82%d1%80%d0%be%d0%b9%d0%ba%d0%b0">Первичная настройка</a>
</h2><p>Для начала работы с <span class="shortcode shortcode-tag"><a href="/ru/tags/git/" target="_blank">#Git</a></span>&rsquo;ом, его необходимо хотя бы минимально настроить.</p>
<ol>
<li>Указать своё имя:</li>
</ol>



<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-2 shortcode-codeblock-bash">
  <div class="d-flex overflow-hidden">
    <div class="flex-grow-1 rounded overflow-hidden" id="cp-3639f8f81c8ed9ed573ff7fb4d956bc9">
      
      <pre><code class='language-bash'>git config --global user.name &#34;John Doe&#34;</code></pre>
    </div>
    <div class="flex-shrink-0">
      <ul class="list-inline mb-0">
        <li class="list-inline-item" data-bs-tooltip data-bs-title='Копировать'>
          <a class="text-body" href="#"
             data-fn="clipboard preventDefault" data-clipboard-target="#cp-3639f8f81c8ed9ed573ff7fb4d956bc9"
             role="button" aria-label='Копировать'>
            <i class="fas fa-copy fa-fw"></i>
          </a>
        </li>
      </ul>
    </div>
  </div>
</div>

<ol start="2">
<li>Указать свой адрес e-mail:</li>
</ol>



<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-3 shortcode-codeblock-bash">
  <div class="d-flex overflow-hidden">
    <div class="flex-grow-1 rounded overflow-hidden" id="cp-61fbf6d07bd8a2c027c9d6e0fb593fd9">
      
      <pre><code class='language-bash'>git config --global user.email &#34;johndoe@example.com&#34;</code></pre>
    </div>
    <div class="flex-shrink-0">
      <ul class="list-inline mb-0">
        <li class="list-inline-item" data-bs-tooltip data-bs-title='Копировать'>
          <a class="text-body" href="#"
             data-fn="clipboard preventDefault" data-clipboard-target="#cp-61fbf6d07bd8a2c027c9d6e0fb593fd9"
             role="button" aria-label='Копировать'>
            <i class="fas fa-copy fa-fw"></i>
          </a>
        </li>
      </ul>
    </div>
  </div>
</div>

<h2 id="настройка-подписи">
  <a class="link-body-emphasis" href="#%d0%bd%d0%b0%d1%81%d1%82%d1%80%d0%be%d0%b9%d0%ba%d0%b0-%d0%bf%d0%be%d0%b4%d0%bf%d0%b8%d1%81%d0%b8">Настройка подписи</a>
</h2><p>Хорошим тоном будет считаться подпись каждого своего commit&rsquo;а.</p>
<ol>
<li>Выяснить какие ключи установлены в системе (о создании ключей я публиковал заметку <span class="shortcode shortcode-uuid"><a href="/ru/articles/2020/07/7a204545-daa8-58ce-ba35-75e732e1bcc0/">GnuPG: Создание и работа с ключами шифрования</a></span>):</li>
</ol>



<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-5 shortcode-codeblock-bash">
  <div class="d-flex overflow-hidden">
    <div class="flex-grow-1 rounded overflow-hidden" id="cp-e1462d311626aad0ba9753f8feb74e59">
      
      <pre><code class='language-bash'>gpg --list-secret-keys --keyid-format=long</code></pre>
    </div>
    <div class="flex-shrink-0">
      <ul class="list-inline mb-0">
        <li class="list-inline-item" data-bs-tooltip data-bs-title='Копировать'>
          <a class="text-body" href="#"
             data-fn="clipboard preventDefault" data-clipboard-target="#cp-e1462d311626aad0ba9753f8feb74e59"
             role="button" aria-label='Копировать'>
            <i class="fas fa-copy fa-fw"></i>
          </a>
        </li>
      </ul>
    </div>
  </div>
</div>

<ol start="2">
<li>Указать <span class="shortcode shortcode-tag"><a href="/ru/tags/git/" target="_blank">#Git</a></span>&rsquo;у всегда подписывать каждый commit:</li>
</ol>



<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-7 shortcode-codeblock-bash">
  <div class="d-flex overflow-hidden">
    <div class="flex-grow-1 rounded overflow-hidden" id="cp-838bd21641e691d0cfc499fb9077584c">
      
      <pre><code class='language-bash'>git config --global commit.gpgsign true</code></pre>
    </div>
    <div class="flex-shrink-0">
      <ul class="list-inline mb-0">
        <li class="list-inline-item" data-bs-tooltip data-bs-title='Копировать'>
          <a class="text-body" href="#"
             data-fn="clipboard preventDefault" data-clipboard-target="#cp-838bd21641e691d0cfc499fb9077584c"
             role="button" aria-label='Копировать'>
            <i class="fas fa-copy fa-fw"></i>
          </a>
        </li>
      </ul>
    </div>
  </div>
</div>

<ol start="3">
<li>Указать <span class="shortcode shortcode-tag"><a href="/ru/tags/git/" target="_blank">#Git</a></span>&rsquo;у идентификатор ключа для подписи commit&rsquo;а:</li>
</ol>



<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-9 shortcode-codeblock-bash">
  <div class="d-flex overflow-hidden">
    <div class="flex-grow-1 rounded overflow-hidden" id="cp-d5fe48fa9fb8915db88e77e4c36f2487">
      
      <pre><code class='language-bash'>git config --global user.signingkey 3AA5C34371567BD2</code></pre>
    </div>
    <div class="flex-shrink-0">
      <ul class="list-inline mb-0">
        <li class="list-inline-item" data-bs-tooltip data-bs-title='Копировать'>
          <a class="text-body" href="#"
             data-fn="clipboard preventDefault" data-clipboard-target="#cp-d5fe48fa9fb8915db88e77e4c36f2487"
             role="button" aria-label='Копировать'>
            <i class="fas fa-copy fa-fw"></i>
          </a>
        </li>
      </ul>
    </div>
  </div>
</div>

<h2 id="хранилище-паролей">
  <a class="link-body-emphasis" href="#%d1%85%d1%80%d0%b0%d0%bd%d0%b8%d0%bb%d0%b8%d1%89%d0%b5-%d0%bf%d0%b0%d1%80%d0%be%d0%bb%d0%b5%d0%b9">Хранилище паролей</a>
</h2><p><span class="shortcode shortcode-tag"><a href="/ru/tags/git/" target="_blank">#Git</a></span> по умолчанию не сохраняет регистрационные данные для репозиториев. Эта настройка позволяет указать <span class="shortcode shortcode-tag"><a href="/ru/tags/git/" target="_blank">#Git</a></span>&rsquo;у использовать для хранения регистрационных данных текстовый файл <code>~/.git-credentials</code>:</p>



<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-12 shortcode-codeblock-bash">
  <div class="d-flex overflow-hidden">
    <div class="flex-grow-1 rounded overflow-hidden" id="cp-1757623334a2f5b9108390719b46edc9">
      
      <pre><code class='language-bash'>git config --global credential.helper store</code></pre>
    </div>
    <div class="flex-shrink-0">
      <ul class="list-inline mb-0">
        <li class="list-inline-item" data-bs-tooltip data-bs-title='Копировать'>
          <a class="text-body" href="#"
             data-fn="clipboard preventDefault" data-clipboard-target="#cp-1757623334a2f5b9108390719b46edc9"
             role="button" aria-label='Копировать'>
            <i class="fas fa-copy fa-fw"></i>
          </a>
        </li>
      </ul>
    </div>
  </div>
</div>

<h2 id="отмена-изменений">
  <a class="link-body-emphasis" href="#%d0%be%d1%82%d0%bc%d0%b5%d0%bd%d0%b0-%d0%b8%d0%b7%d0%bc%d0%b5%d0%bd%d0%b5%d0%bd%d0%b8%d0%b9">Отмена изменений</a>
</h2><p>Отмена конкретного commit&rsquo;а:</p>



<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-13 shortcode-codeblock-bash">
  <div class="d-flex overflow-hidden">
    <div class="flex-grow-1 rounded overflow-hidden" id="cp-7ca992a2e63fd206722f33c29b83537e">
      
      <pre><code class='language-bash'>git revert [commit]</code></pre>
    </div>
    <div class="flex-shrink-0">
      <ul class="list-inline mb-0">
        <li class="list-inline-item" data-bs-tooltip data-bs-title='Копировать'>
          <a class="text-body" href="#"
             data-fn="clipboard preventDefault" data-clipboard-target="#cp-7ca992a2e63fd206722f33c29b83537e"
             role="button" aria-label='Копировать'>
            <i class="fas fa-copy fa-fw"></i>
          </a>
        </li>
      </ul>
    </div>
  </div>
</div>

<p>Отмена 2-х commit&rsquo;ов подряд:</p>



<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-14 shortcode-codeblock-bash">
  <div class="d-flex overflow-hidden">
    <div class="flex-grow-1 rounded overflow-hidden" id="cp-690d3c3281507a8aea9392d3cea224ff">
      
      <pre><code class='language-bash'>git revert HEAD~2</code></pre>
    </div>
    <div class="flex-shrink-0">
      <ul class="list-inline mb-0">
        <li class="list-inline-item" data-bs-tooltip data-bs-title='Копировать'>
          <a class="text-body" href="#"
             data-fn="clipboard preventDefault" data-clipboard-target="#cp-690d3c3281507a8aea9392d3cea224ff"
             role="button" aria-label='Копировать'>
            <i class="fas fa-copy fa-fw"></i>
          </a>
        </li>
      </ul>
    </div>
  </div>
</div>

<h2 id="модули">
  <a class="link-body-emphasis" href="#%d0%bc%d0%be%d0%b4%d1%83%d0%bb%d0%b8">Модули</a>
</h2><p>Добавление модуля:</p>



<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-15 shortcode-codeblock-bash">
  <div class="d-flex overflow-hidden">
    <div class="flex-grow-1 rounded overflow-hidden" id="cp-e7c3ac5749f46d072a04a6721546edf9">
      
      <pre><code class='language-bash'>git submodule add https://github.com/[MODULE] [MODULE]</code></pre>
    </div>
    <div class="flex-shrink-0">
      <ul class="list-inline mb-0">
        <li class="list-inline-item" data-bs-tooltip data-bs-title='Копировать'>
          <a class="text-body" href="#"
             data-fn="clipboard preventDefault" data-clipboard-target="#cp-e7c3ac5749f46d072a04a6721546edf9"
             role="button" aria-label='Копировать'>
            <i class="fas fa-copy fa-fw"></i>
          </a>
        </li>
      </ul>
    </div>
  </div>
</div>

<p>Рекурсивное обновление всех модулей:</p>



<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-16 shortcode-codeblock-bash">
  <div class="d-flex overflow-hidden">
    <div class="flex-grow-1 rounded overflow-hidden" id="cp-c20763e99e67f29e2f5aeab4a56999e7">
      
      <pre><code class='language-bash'>git submodule update --recursive --remote --merge</code></pre>
    </div>
    <div class="flex-shrink-0">
      <ul class="list-inline mb-0">
        <li class="list-inline-item" data-bs-tooltip data-bs-title='Копировать'>
          <a class="text-body" href="#"
             data-fn="clipboard preventDefault" data-clipboard-target="#cp-c20763e99e67f29e2f5aeab4a56999e7"
             role="button" aria-label='Копировать'>
            <i class="fas fa-copy fa-fw"></i>
          </a>
        </li>
      </ul>
    </div>
  </div>
</div>

<p>Удаление модуля:</p>



<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-17 shortcode-codeblock-bash">
  <div class="d-flex overflow-hidden">
    <div class="flex-grow-1 rounded overflow-hidden" id="cp-e7aff09ced68bf8e3c03a9f148e63405">
      
      <pre><code class='language-bash'>git submodule deinit -f [MODULE]  \
  &amp;&amp; git rm -r --cached [MODULE]  \
  &amp;&amp; rm -rf .git/modules/[MODULE] \
  &amp;&amp; rm -rf [MODULE]</code></pre>
    </div>
    <div class="flex-shrink-0">
      <ul class="list-inline mb-0">
        <li class="list-inline-item" data-bs-tooltip data-bs-title='Копировать'>
          <a class="text-body" href="#"
             data-fn="clipboard preventDefault" data-clipboard-target="#cp-e7aff09ced68bf8e3c03a9f148e63405"
             role="button" aria-label='Копировать'>
            <i class="fas fa-copy fa-fw"></i>
          </a>
        </li>
      </ul>
    </div>
  </div>
</div>

<h2 id="изменение-адреса-репозитория">
  <a class="link-body-emphasis" href="#%d0%b8%d0%b7%d0%bc%d0%b5%d0%bd%d0%b5%d0%bd%d0%b8%d0%b5-%d0%b0%d0%b4%d1%80%d0%b5%d1%81%d0%b0-%d1%80%d0%b5%d0%bf%d0%be%d0%b7%d0%b8%d1%82%d0%be%d1%80%d0%b8%d1%8f">Изменение адреса репозитория</a>
</h2><p>Показать текущий адрес:</p>



<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-18 shortcode-codeblock-bash">
  <div class="d-flex overflow-hidden">
    <div class="flex-grow-1 rounded overflow-hidden" id="cp-4cdc82f67234d25c37272aaf1bb773d9">
      
      <pre><code class='language-bash'>git remote -v</code></pre>
    </div>
    <div class="flex-shrink-0">
      <ul class="list-inline mb-0">
        <li class="list-inline-item" data-bs-tooltip data-bs-title='Копировать'>
          <a class="text-body" href="#"
             data-fn="clipboard preventDefault" data-clipboard-target="#cp-4cdc82f67234d25c37272aaf1bb773d9"
             role="button" aria-label='Копировать'>
            <i class="fas fa-copy fa-fw"></i>
          </a>
        </li>
      </ul>
    </div>
  </div>
</div>

<p>Установить новый адрес:</p>



<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-19 shortcode-codeblock-bash">
  <div class="d-flex overflow-hidden">
    <div class="flex-grow-1 rounded overflow-hidden" id="cp-5a251384b0f7d7b21ee525c2ee0e5d11">
      
      <pre><code class='language-bash'>git remote set-url origin &#39;[URL]&#39;</code></pre>
    </div>
    <div class="flex-shrink-0">
      <ul class="list-inline mb-0">
        <li class="list-inline-item" data-bs-tooltip data-bs-title='Копировать'>
          <a class="text-body" href="#"
             data-fn="clipboard preventDefault" data-clipboard-target="#cp-5a251384b0f7d7b21ee525c2ee0e5d11"
             role="button" aria-label='Копировать'>
            <i class="fas fa-copy fa-fw"></i>
          </a>
        </li>
      </ul>
    </div>
  </div>
</div>

<h2 id="изменение-описания-последнего-commitа">
  <a class="link-body-emphasis" href="#%d0%b8%d0%b7%d0%bc%d0%b5%d0%bd%d0%b5%d0%bd%d0%b8%d0%b5-%d0%be%d0%bf%d0%b8%d1%81%d0%b0%d0%bd%d0%b8%d1%8f-%d0%bf%d0%be%d1%81%d0%bb%d0%b5%d0%b4%d0%bd%d0%b5%d0%b3%d0%be-commit%d0%b0">Изменение описания последнего commit&rsquo;а</a>
</h2><p>Если закралась ошибка в описании изменений кода при последнем commit&rsquo;е, это описание можно изменить при помощи команды:</p>



<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-20 shortcode-codeblock-bash">
  <div class="d-flex overflow-hidden">
    <div class="flex-grow-1 rounded overflow-hidden" id="cp-4241fa114a192b069967907224aaacc6">
      
      <pre><code class='language-bash'>git commit --amend -m &#39;New commit message.&#39;</code></pre>
    </div>
    <div class="flex-shrink-0">
      <ul class="list-inline mb-0">
        <li class="list-inline-item" data-bs-tooltip data-bs-title='Копировать'>
          <a class="text-body" href="#"
             data-fn="clipboard preventDefault" data-clipboard-target="#cp-4241fa114a192b069967907224aaacc6"
             role="button" aria-label='Копировать'>
            <i class="fas fa-copy fa-fw"></i>
          </a>
        </li>
      </ul>
    </div>
  </div>
</div>

<p>Далее, изменённый коммит принудительно отправить на сервер:</p>



<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-21 shortcode-codeblock-bash">
  <div class="d-flex overflow-hidden">
    <div class="flex-grow-1 rounded overflow-hidden" id="cp-e27e43d6b36160394880590970582db0">
      
      <pre><code class='language-bash'>git push --force &#39;[remoteName]&#39; &#39;[branchName]&#39;</code></pre>
    </div>
    <div class="flex-shrink-0">
      <ul class="list-inline mb-0">
        <li class="list-inline-item" data-bs-tooltip data-bs-title='Копировать'>
          <a class="text-body" href="#"
             data-fn="clipboard preventDefault" data-clipboard-target="#cp-e27e43d6b36160394880590970582db0"
             role="button" aria-label='Копировать'>
            <i class="fas fa-copy fa-fw"></i>
          </a>
        </li>
      </ul>
    </div>
  </div>
</div>




<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-22 shortcode-codeblock-bash">
  <div class="d-flex overflow-hidden">
    <div class="flex-grow-1 rounded overflow-hidden" id="cp-cd096a02afa0654decaf68d92aa817d0">
      
      <pre><code class='language-bash'>git push --force &#39;origin&#39; &#39;main&#39;</code></pre>
    </div>
    <div class="flex-shrink-0">
      <ul class="list-inline mb-0">
        <li class="list-inline-item" data-bs-tooltip data-bs-title='Копировать'>
          <a class="text-body" href="#"
             data-fn="clipboard preventDefault" data-clipboard-target="#cp-cd096a02afa0654decaf68d92aa817d0"
             role="button" aria-label='Копировать'>
            <i class="fas fa-copy fa-fw"></i>
          </a>
        </li>
      </ul>
    </div>
  </div>
</div>]]></turbo:content></item><item turbo="true"><title>Зеркалирование репозитория между хостингами</title><link>https://lib.onl/ru/articles/2021/07/3834fbed-71c8-5979-b6c2-236269f5ecea/</link><pubDate>Tue, 06 Jul 2021 17:40:43 +0000</pubDate><dc:creator>Kai Kimera</dc:creator><category>Разработка</category><category>Скрипты</category><yandex:related><link url="https://lib.onl/ru/articles/2021/05/8544b8ce-4586-578f-9633-e8ae43441a25/">Синхронизация репозитория от GitHub к GitLab</link></yandex:related><turbo:extendedHtml>true</turbo:extendedHtml><turbo:source>https://lib.onl/ru/articles/2021/07/3834fbed-71c8-5979-b6c2-236269f5ecea/</turbo:source><turbo:topic>Зеркалирование репозитория между хостингами</turbo:topic><turbo:content><![CDATA[<p>В предыдущей статье <span class="shortcode shortcode-uuid"><a href="/ru/articles/2021/05/8544b8ce-4586-578f-9633-e8ae43441a25/">Синхронизация репозитория от GitHub к GitLab</a></span> я рассказал о том, как организовать синхронизацию между репозиториями <span class="shortcode shortcode-tag"><a href="/ru/tags/git/" target="_blank">#Git</a></span> на разных хостингах, в частности, между <span class="shortcode shortcode-tag"><a href="/ru/tags/github/" target="_blank">#GitHub</a></span> и <span class="shortcode shortcode-tag"><a href="/ru/tags/gitlab/" target="_blank">#GitLab</a></span>. В итоге, я решил сделать <a title="" href="https://github.com/ghastore/github-mirror" target="_blank" rel="noopener noreferrer">собственный GitHub Action</a>, который позволяет полностью зеркалировать репозитории.</p>
<h2 id="использование">
  <a class="link-body-emphasis" href="#%d0%b8%d1%81%d0%bf%d0%be%d0%bb%d1%8c%d0%b7%d0%be%d0%b2%d0%b0%d0%bd%d0%b8%d0%b5">Использование</a>
</h2><p>Для подключения зеркалирования, к примеру, с <span class="shortcode shortcode-tag"><a href="/ru/tags/github/" target="_blank">#GitHub</a></span> на <span class="shortcode shortcode-tag"><a href="/ru/tags/gitlab/" target="_blank">#GitLab</a></span>, необходимо в исходном репозитории создать файл <code>.github/workflows/mirror.yml</code>, в котором указать следующее содержимое:</p>

    

    
        
            
            <div class="shortcode shortcode-file mb-3">
              <div class="card overflow-hidden">
                <div class="card-header">
                  <div class="d-flex align-items-center">
                    <div class="flex-shrink-0">
                      <i class="far fa-file-code fa-fw"></i>
                    </div>
                    <div class="flex-grow-1 mx-2 text-truncate">
                      <code>mirror.yml</code>
                    </div>
                    <div class="flex-shrink-0">
                      <ul class="list-inline mb-0">
                        <li class="list-inline-item" data-bs-tooltip data-bs-title='Копировать'>
                          <a class="text-body" href="#"
                             data-fn="clipboard preventDefault" data-clipboard-target="#cp-44cd2befabb688c1c7ac865b8f4b9293"
                             role="button" aria-label='Копировать'>
                            <i class="fas fa-copy fa-fw"></i>
                          </a>
                        </li>
                        <li class="list-inline-item" data-bs-tooltip data-bs-title='Скачать'>
                          <a class="text-body" href="/ru/articles/2021/07/3834fbed-71c8-5979-b6c2-236269f5ecea/mirror.yml" download
                             role="button" aria-label='Скачать'>
                            <i class="fas fa-download fa-fw"></i>
                          </a>
                        </li>
                        <li class="list-inline-item" data-bs-tooltip data-bs-title='Открыть'>
                          <a class="text-body" href="/ru/articles/2021/07/3834fbed-71c8-5979-b6c2-236269f5ecea/mirror.yml" target="_blank"
                             role="button" aria-label='Открыть'>
                            <i class="fas fa-arrow-up-right-from-square fa-fw"></i>
                          </a>
                        </li>
                      </ul>
                    </div>
                  </div>
                </div>
                <div class="card-body" id="cp-44cd2befabb688c1c7ac865b8f4b9293">
                    
                        
                    
                  <pre><code class="language-yml">name: &#34;Repository Mirror&#34;

on:
  - push

jobs:
  mirror:
    runs-on: ubuntu-latest
    name: &#34;Mirror&#34;
    steps:
      - uses: pkgstore/github-action-mirror@main
        with:
          src_repo: &#34;https://github.com/${{ github.repository }}.git&#34;
          src_user: &#34;${{ secrets.MIRROR_SOURCE_USER_GITHUB }}&#34;
          src_token: &#34;${{ secrets.MIRROR_SOURCE_TOKEN_GITHUB }}&#34;
          dsc_repo: &#34;https://gitlab.com/${{ github.repository }}.git&#34;
          dsc_user: &#34;${{ secrets.MIRROR_TARGET_USER_GITLAB }}&#34;
          dsc_token: &#34;${{ secrets.MIRROR_TARGET_TOKEN_GITLAB }}&#34;</code></pre>
                </div>
              </div>
            </div>
        
    
<ul>
<li><code>src_repo</code> - <strong>URL</strong> исходного репозитория.</li>
<li><code>src_user</code> - <strong>пользователь</strong> исходного репозитория.</li>
<li><code>src_token</code> - <strong>токен пользователя</strong> исходного репозитория.</li>
<li><code>dsc_repo</code> - <strong>URL</strong> зеркального репозитория.</li>
<li><code>dsc_user</code> - <strong>пользователь</strong> зеркального репозитория.</li>
<li><code>dsc_token</code> - <strong>токен пользователя</strong> зеркального репозитория.</li>
</ul>
<p>В этом коде стоит обратить внимание на параметр <code>target_repo</code>. <span class="shortcode shortcode-tag"><a href="/ru/tags/gitlab/" target="_blank">#GitLab</a></span> позволяет автоматически создавать репозиторий при зеркалировании, а так как у меня адреса репозиториев совпадают между <span class="shortcode shortcode-tag"><a href="/ru/tags/github/" target="_blank">#GitHub</a></span> и <span class="shortcode shortcode-tag"><a href="/ru/tags/gitlab/" target="_blank">#GitLab</a></span>, мне гораздо проще выстроить конструкцию <code>https://gitlab.com/${{ github.repository }}.git</code>. Переменная <code>${{ github.repository }}</code> содержит имя пользователя / организации и название репозитория, и, при настройке зеркалирования репозитория на <span class="shortcode shortcode-tag"><a href="/ru/tags/github/" target="_blank">#GitHub</a></span>&rsquo;е, зеркало репозитория автоматически создаётся на <span class="shortcode shortcode-tag"><a href="/ru/tags/gitlab/" target="_blank">#GitLab</a></span>&rsquo;е.</p>]]></turbo:content></item><item turbo="true"><title>Генератор иконок для сайта</title><link>https://lib.onl/ru/articles/2021/05/841ba281-a22b-55ee-b97d-251a5dc111d8/</link><pubDate>Tue, 18 May 2021 07:41:46 +0000</pubDate><dc:creator>Kai Kimera</dc:creator><category>Разработка</category><category>Скрипты</category><turbo:extendedHtml>true</turbo:extendedHtml><turbo:source>https://lib.onl/ru/articles/2021/05/841ba281-a22b-55ee-b97d-251a5dc111d8/</turbo:source><turbo:topic>Генератор иконок для сайта</turbo:topic><turbo:content><![CDATA[<p>Сделал для сайта автоматизированное создание иконок типа <code>favicon</code>, которыми пользуются браузеры и устройства для своих нужд.</p>
<p>Я накидал небольшой скрипт, состоящий из двух функций <code>png()</code> и <code>ico()</code>. Функция <code>png()</code> берёт файл <code>favicon.svg</code> и преобразует его в <span class="shortcode shortcode-tag">PNG</span>, указанных в массиве <code>size</code>, размеров. Функция <code>ico()</code> также берёт файл <code>favicon.svg</code> и преобразует его в формат <span class="shortcode shortcode-tag">ICO</span>, который содержит в себе несколько размеров изображения.</p>

    

    
        
            
            <div class="shortcode shortcode-file mb-3">
              <div class="card overflow-hidden">
                <div class="card-header">
                  <div class="d-flex align-items-center">
                    <div class="flex-shrink-0">
                      <i class="far fa-file-code fa-fw"></i>
                    </div>
                    <div class="flex-grow-1 mx-2 text-truncate">
                      <code>favicon.sh</code>
                    </div>
                    <div class="flex-shrink-0">
                      <ul class="list-inline mb-0">
                        <li class="list-inline-item" data-bs-tooltip data-bs-title='Копировать'>
                          <a class="text-body" href="#"
                             data-fn="clipboard preventDefault" data-clipboard-target="#cp-b05da06962b44906a69601eac9c6204f"
                             role="button" aria-label='Копировать'>
                            <i class="fas fa-copy fa-fw"></i>
                          </a>
                        </li>
                        <li class="list-inline-item" data-bs-tooltip data-bs-title='Скачать'>
                          <a class="text-body" href="/ru/articles/2021/05/841ba281-a22b-55ee-b97d-251a5dc111d8/favicon.sh" download
                             role="button" aria-label='Скачать'>
                            <i class="fas fa-download fa-fw"></i>
                          </a>
                        </li>
                        <li class="list-inline-item" data-bs-tooltip data-bs-title='Открыть'>
                          <a class="text-body" href="/ru/articles/2021/05/841ba281-a22b-55ee-b97d-251a5dc111d8/favicon.sh" target="_blank"
                             role="button" aria-label='Открыть'>
                            <i class="fas fa-arrow-up-right-from-square fa-fw"></i>
                          </a>
                        </li>
                      </ul>
                    </div>
                  </div>
                </div>
                <div class="card-body" id="cp-b05da06962b44906a69601eac9c6204f">
                    
                        
                    
                  <pre><code class="language-sh">#!/usr/bin/env -S bash -e
#
# Generating &#39;favicon.ico&#39; file.
#
# @package    Bash
# @author     Kai Kimera &lt;mail@kai.kim&gt;
# @copyright  2023 Library Online
# @license    MIT
# @version    0.1.0
# @link       https://lib.onl/ru/articles/2021/05/841ba281-a22b-55ee-b97d-251a5dc111d8/
# -------------------------------------------------------------------------------------------------------------------- #

size=( 16 24 32 48 64 72 80 96 128 144 152 167 180 192 196 256 300 512 )
file_svg=&#39;favicon.svg&#39;
file_ico=&#39;favicon.ico&#39;

rsvg=&#34;$( command -v rsvg-convert )&#34;
convert=&#34;$( command -v convert )&#34;
identify=&#34;$( command -v identify )&#34;

png() {
  _check_file
  for i in &#34;${size[@]}&#34;; do
    ${rsvg} -w &#34;${i}&#34; -h &#34;${i}&#34; &#34;${file_svg}&#34; -o &#34;favicon-${i}.png&#34;
  done
}

ico() {
  _check_file
  ${convert} -density &#39;256x256&#39; -background &#39;transparent&#39; &#34;${file_svg}&#34; -define &#39;icon:auto-resize&#39; -colors &#39;256&#39; &#34;${file_ico}&#34;
  ${identify} &#34;${file_ico}&#34;
}

_check_file() {
  [[ -f &#34;${file_svg}&#34; ]] || { printf &#39;%s does not exist!\n&#39; &#34;${file_svg}&#34;; exit 1; }
}

&#34;$@&#34;</code></pre>
                </div>
              </div>
            </div>
        
    
<h2 id="использование">
  <a class="link-body-emphasis" href="#%d0%b8%d1%81%d0%bf%d0%be%d0%bb%d1%8c%d0%b7%d0%be%d0%b2%d0%b0%d0%bd%d0%b8%d0%b5">Использование</a>
</h2><p>Для работы скрипта необходимо, чтобы в системе были установлены <span class="shortcode shortcode-tag">RSVG</span> и <span class="shortcode shortcode-tag"><a href="/ru/tags/imagemagick/" target="_blank">#ImageMagick</a></span>. Скрипт можно сохранить с произвольным именем, например, <code>favicon.sh</code> в директорию, где находится изображение <code>favicon.svg</code>. Далее, вызывать функции следующим образом:</p>






<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-5 shortcode-codeblock-terminal
shortcode-codeblock-terminal-linux shortcode-codeblock-terminal-linux-user">
  <div class="card overflow-hidden" data-bs-theme="dark">
    <div class="card-header">
      <div class="d-flex align-items-center">
        <div class="flex-shrink-0 ">
          <i class="fas fa-terminal fa-fw"></i>
        </div>
        <div class="flex-grow-1 mx-2">
          <h5 class="mb-0">Терминал</h5>
        </div>
        <div class="flex-shrink-0">
          <ul class="list-inline mb-0">
            <li class="list-inline-item" data-bs-tooltip data-bs-title='Копировать'>
              <a class="text-body" href="#"
                 data-fn="clipboard preventDefault" data-clipboard-target="#cp-7678a688b85e71180b8d69e53445a43a"
                 role="button" aria-label='Копировать'>
                <i class="fas fa-copy fa-fw"></i>
              </a>
            </li>
          </ul>
        </div>
      </div>
    </div>
    <div class="card-body p-0" id="cp-7678a688b85e71180b8d69e53445a43a">
      <pre><code class="language-plaintext">bash favicon.sh png</code></pre>
    </div>
  </div>
</div>







<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-6 shortcode-codeblock-terminal
shortcode-codeblock-terminal-linux shortcode-codeblock-terminal-linux-user">
  <div class="card overflow-hidden" data-bs-theme="dark">
    <div class="card-header">
      <div class="d-flex align-items-center">
        <div class="flex-shrink-0 ">
          <i class="fas fa-terminal fa-fw"></i>
        </div>
        <div class="flex-grow-1 mx-2">
          <h5 class="mb-0">Терминал</h5>
        </div>
        <div class="flex-shrink-0">
          <ul class="list-inline mb-0">
            <li class="list-inline-item" data-bs-tooltip data-bs-title='Копировать'>
              <a class="text-body" href="#"
                 data-fn="clipboard preventDefault" data-clipboard-target="#cp-ac4be346de45298ef35afffe9621a4ad"
                 role="button" aria-label='Копировать'>
                <i class="fas fa-copy fa-fw"></i>
              </a>
            </li>
          </ul>
        </div>
      </div>
    </div>
    <div class="card-body p-0" id="cp-ac4be346de45298ef35afffe9621a4ad">
      <pre><code class="language-plaintext">bash favicon.sh ico</code></pre>
    </div>
  </div>
</div>

<p>Скрипт ищет файл <code>favicon.svg</code> и преобразует его в необходимые изображения.</p>]]></turbo:content></item><item turbo="true"><title>Обновление Fedora Linux до актуальной версии</title><link>https://lib.onl/ru/articles/2021/05/0acd3f9d-07b7-52b8-9fac-b5cb1cc579e0/</link><pubDate>Sat, 15 May 2021 20:29:16 +0000</pubDate><dc:creator>Kai Kimera</dc:creator><category>Терминал</category><category>Linux</category><yandex:related><link url="https://lib.onl/ru/articles/2020/06/59781965-afe7-5dd5-9798-d1c5ba6cdafd/">Первичная настройка UAIK</link></yandex:related><turbo:extendedHtml>true</turbo:extendedHtml><turbo:source>https://lib.onl/ru/articles/2021/05/0acd3f9d-07b7-52b8-9fac-b5cb1cc579e0/</turbo:source><turbo:topic>Обновление Fedora Linux до актуальной версии</turbo:topic><turbo:content><![CDATA[<p>Новые версии <span class="shortcode shortcode-tag"><a href="/ru/tags/fedora/" target="_blank">#Fedora</a></span> публикуются каждые 6-8 месяцев. В этой статье я опишу шаги по обновлению дистрибутива между версиями.</p>
<ol>
<li>Устанавливаем плагин обновления системы:</li>
</ol>



<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-1 shortcode-codeblock-bash">
  <div class="d-flex overflow-hidden">
    <div class="flex-grow-1 rounded overflow-hidden" id="cp-a549fd0e52ed1eec4539c1f15bef292a">
      
      <pre><code class='language-bash'>dnf install dnf-plugin-system-upgrade</code></pre>
    </div>
    <div class="flex-shrink-0">
      <ul class="list-inline mb-0">
        <li class="list-inline-item" data-bs-tooltip data-bs-title='Копировать'>
          <a class="text-body" href="#"
             data-fn="clipboard preventDefault" data-clipboard-target="#cp-a549fd0e52ed1eec4539c1f15bef292a"
             role="button" aria-label='Копировать'>
            <i class="fas fa-copy fa-fw"></i>
          </a>
        </li>
      </ul>
    </div>
  </div>
</div>

<ol start="2">
<li>Скачивание актуальной версии системы:</li>
</ol>



<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-2 shortcode-codeblock-bash">
  <div class="d-flex overflow-hidden">
    <div class="flex-grow-1 rounded overflow-hidden" id="cp-993c17d8ff2b31ad122a2328c08df610">
      
      <pre><code class='language-bash'>dnf system-upgrade download --releasever=34</code></pre>
    </div>
    <div class="flex-shrink-0">
      <ul class="list-inline mb-0">
        <li class="list-inline-item" data-bs-tooltip data-bs-title='Копировать'>
          <a class="text-body" href="#"
             data-fn="clipboard preventDefault" data-clipboard-target="#cp-993c17d8ff2b31ad122a2328c08df610"
             role="button" aria-label='Копировать'>
            <i class="fas fa-copy fa-fw"></i>
          </a>
        </li>
      </ul>
    </div>
  </div>
</div>

<ul>
<li><code>releasever</code> - номер актуальной версии системы.</li>
</ul>
<ol start="3">
<li>Запуск обновления системы на актуальную версию:</li>
</ol>



<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-3 shortcode-codeblock-bash">
  <div class="d-flex overflow-hidden">
    <div class="flex-grow-1 rounded overflow-hidden" id="cp-700420268fae48e04cc9e1884cbe1722">
      
      <pre><code class='language-bash'>dnf system-upgrade reboot</code></pre>
    </div>
    <div class="flex-shrink-0">
      <ul class="list-inline mb-0">
        <li class="list-inline-item" data-bs-tooltip data-bs-title='Копировать'>
          <a class="text-body" href="#"
             data-fn="clipboard preventDefault" data-clipboard-target="#cp-700420268fae48e04cc9e1884cbe1722"
             role="button" aria-label='Копировать'>
            <i class="fas fa-copy fa-fw"></i>
          </a>
        </li>
      </ul>
    </div>
  </div>
</div>

<p>Вот и всё. Система обновит пакетную базу и перезагрузится.</p>]]></turbo:content></item><item turbo="true"><title>Настройка статического IP адреса</title><link>https://lib.onl/ru/articles/2021/05/ee559a6c-5cde-5166-9d2d-3ceb55878eb8/</link><pubDate>Sat, 15 May 2021 17:08:30 +0000</pubDate><dc:creator>Kai Kimera</dc:creator><category>Терминал</category><category>Linux</category><category>Сеть</category><category>В доработке</category><turbo:extendedHtml>true</turbo:extendedHtml><turbo:source>https://lib.onl/ru/articles/2021/05/ee559a6c-5cde-5166-9d2d-3ceb55878eb8/</turbo:source><turbo:topic>Настройка статического IP адреса</turbo:topic><turbo:content><![CDATA[<p>Рассмотрим различные способы настройки статического <span class="shortcode shortcode-tag"><a href="/ru/tags/ip/" target="_blank">#IP</a></span> адреса в дистрибутивах <span class="shortcode shortcode-tag"><a href="/ru/tags/linux/" target="_blank">#Linux</a></span>. Способы различаются в зависимости от пакетной базы дистрибутивов. Например, настройка статического <span class="shortcode shortcode-tag"><a href="/ru/tags/ip/" target="_blank">#IP</a></span> в <span class="shortcode shortcode-tag">RHEL</span>-based дистрибутиве будет отличаться от настройки в <span class="shortcode shortcode-tag"><a href="/ru/tags/deb/" target="_blank">#DEB</a></span>-based дистрибутиве.</p>
<h2 id="подготовка">
  <a class="link-body-emphasis" href="#%d0%bf%d0%be%d0%b4%d0%b3%d0%be%d1%82%d0%be%d0%b2%d0%ba%d0%b0">Подготовка</a>
</h2><p>Смотрим текущие сетевые устройства и соединения:</p>






<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-5 shortcode-codeblock-terminal
shortcode-codeblock-terminal-linux shortcode-codeblock-terminal-linux-root">
  <div class="card overflow-hidden" data-bs-theme="dark">
    <div class="card-header">
      <div class="d-flex align-items-center">
        <div class="flex-shrink-0 text-danger">
          <i class="fas fa-terminal fa-fw"></i>
        </div>
        <div class="flex-grow-1 mx-2">
          <h5 class="mb-0">Терминал</h5>
        </div>
        <div class="flex-shrink-0">
          <ul class="list-inline mb-0">
            <li class="list-inline-item" data-bs-tooltip data-bs-title='Копировать'>
              <a class="text-body" href="#"
                 data-fn="clipboard preventDefault" data-clipboard-target="#cp-57eabf80c39a6b2b32215a1688ea953c"
                 role="button" aria-label='Копировать'>
                <i class="fas fa-copy fa-fw"></i>
              </a>
            </li>
          </ul>
        </div>
      </div>
    </div>
    <div class="card-body p-0" id="cp-57eabf80c39a6b2b32215a1688ea953c">
      <pre><code class="language-plaintext">ip a

1: lo: &lt;loopback,up,lower_up&gt; mtu 65536 qdisc noqueue state UNKNOWN group default qlen 1000
  link/loopback 00:00:00:00:00:00 brd 00:00:00:00:00:00
  inet 127.0.0.1/8 scope host lo
2: enp1s0: &lt;broadcast,multicast,up,lower_up&gt; mtu 1500 qdisc fq_codel state UP group default qlen 1000
  link/ether xx:xx:xx:xx:xx:xx brd ff:ff:ff:ff:ff:ff
  inet 192.168.10.123/24 brd 192.168.10.255 scope global dynamic noprefixroute enp1s0</code></pre>
    </div>
  </div>
</div>

<h2 id="настройка-ip-в-rhel-based-дистрибутивах">
  <a class="link-body-emphasis" href="#%d0%bd%d0%b0%d1%81%d1%82%d1%80%d0%be%d0%b9%d0%ba%d0%b0-ip-%d0%b2-rhel-based-%d0%b4%d0%b8%d1%81%d1%82%d1%80%d0%b8%d0%b1%d1%83%d1%82%d0%b8%d0%b2%d0%b0%d1%85">Настройка IP в RHEL-based дистрибутивах</a>
</h2><p>В директории <code>/etc/sysconfig/network-scripts</code> находятся конфигурационные файлы для сетевых интерфейсов. Имя файла состоит из префикса <code>ifcfg</code> и имени интерфейса. Например, содержимое файла для интерфейса <code>enp1s0</code>:</p>






<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-6 shortcode-codeblock-terminal
shortcode-codeblock-terminal-linux shortcode-codeblock-terminal-linux-root">
  <div class="card overflow-hidden" data-bs-theme="dark">
    <div class="card-header">
      <div class="d-flex align-items-center">
        <div class="flex-shrink-0 text-danger">
          <i class="fas fa-terminal fa-fw"></i>
        </div>
        <div class="flex-grow-1 mx-2">
          <h5 class="mb-0">Терминал</h5>
        </div>
        <div class="flex-shrink-0">
          <ul class="list-inline mb-0">
            <li class="list-inline-item" data-bs-tooltip data-bs-title='Копировать'>
              <a class="text-body" href="#"
                 data-fn="clipboard preventDefault" data-clipboard-target="#cp-7514c64626963682b12a6aa62a36d66e"
                 role="button" aria-label='Копировать'>
                <i class="fas fa-copy fa-fw"></i>
              </a>
            </li>
          </ul>
        </div>
      </div>
    </div>
    <div class="card-body p-0" id="cp-7514c64626963682b12a6aa62a36d66e">
      <pre><code class="language-plaintext">cat /etc/sysconfig/network-scripts/ifcfg-enp1s0

TYPE=&#34;Ethernet&#34;
PROXY_METHOD=&#34;none&#34;
BROWSER_ONLY=&#34;no&#34;
BOOTPROTO=&#34;dhcp&#34;
DEFROUTE=&#34;yes&#34;
IPV4_FAILURE_FATAL=&#34;no&#34;
IPV6INIT=&#34;yes&#34;
IPV6_AUTOCONF=&#34;yes&#34;
IPV6_DEFROUTE=&#34;yes&#34;
IPV6_FAILURE_FATAL=&#34;no&#34;
IPV6_ADDR_GEN_MODE=&#34;stable-privacy&#34;
NAME=&#34;enp1s0&#34;
UUID=&#34;&lt;DEVICE_ID&gt;&#34;
DEVICE=&#34;enp1s0&#34;
ONBOOT=&#34;yes&#34;</code></pre>
    </div>
  </div>
</div>

<p>Обратим внимание на опцию <strong>BOOTPROTO</strong>. По умолчанию, в опции <strong>BOOTPROTO</strong> прописано <code>dhcp</code>. Это означает, что сетевой интерфейс получает информацию о сети автоматически от <span class="shortcode shortcode-tag"><a href="/ru/tags/dhcp/" target="_blank">#DHCP</a></span>. Сама опция <strong>BOOTPROTO</strong> может принимать следующие значения:</p>
<ul>
<li><code>none</code> – не использовать протокол.</li>
<li><code>bootp</code> – использование протокола <strong>bootp</strong>.</li>
<li><code>dhcp</code> – использование протокола <strong>dhcp</strong> (по умолчанию).</li>
</ul>
<p>Для настройки статического <span class="shortcode shortcode-tag"><a href="/ru/tags/ip/" target="_blank">#IP</a></span> необходимо установит <strong>BOOTPROTO</strong> в <code>none</code> и дописать в конец файла опции:</p>
<ul>
<li><code>IPADDR</code> - IP адрес.</li>
<li><code>PREFIX</code> - маска сети.</li>
<li><code>GATEWAY</code> - шлюз сети.</li>
<li><code>DNS</code> - серверы DNS.</li>
</ul>
<p>Например:</p>



<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-9 shortcode-codeblock-ini">
  <div class="d-flex overflow-hidden">
    <div class="flex-grow-1 rounded overflow-hidden" id="cp-b5e143a0b90fbedc145cad167be65493">
      
      <pre><code class='language-ini'>TYPE=&#34;Ethernet&#34;
PROXY_METHOD=&#34;none&#34;
BROWSER_ONLY=&#34;no&#34;
BOOTPROTO=&#34;none&#34;
DEFROUTE=&#34;yes&#34;
IPV4_FAILURE_FATAL=&#34;no&#34;
IPV6INIT=&#34;yes&#34;
IPV6_AUTOCONF=&#34;yes&#34;
IPV6_DEFROUTE=&#34;yes&#34;
IPV6_FAILURE_FATAL=&#34;no&#34;
IPV6_ADDR_GEN_MODE=&#34;stable-privacy&#34;
NAME=&#34;enp1s0&#34;
UUID=&#34;&lt;DEVICE_ID&gt;&#34;
DEVICE=&#34;enp1s0&#34;
ONBOOT=&#34;yes&#34;
IPADDR=&#34;192.168.10.55&#34;
PREFIX=&#34;24&#34;
GATEWAY=&#34;192.168.10.1&#34;
DNS1=&#34;192.168.11.1&#34;
DNS1=&#34;192.168.12.1&#34;</code></pre>
    </div>
    <div class="flex-shrink-0">
      <ul class="list-inline mb-0">
        <li class="list-inline-item" data-bs-tooltip data-bs-title='Копировать'>
          <a class="text-body" href="#"
             data-fn="clipboard preventDefault" data-clipboard-target="#cp-b5e143a0b90fbedc145cad167be65493"
             role="button" aria-label='Копировать'>
            <i class="fas fa-copy fa-fw"></i>
          </a>
        </li>
      </ul>
    </div>
  </div>
</div>

<p>После указания всех параметров, необходимо перезапустить интерфейс:</p>



<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-10 shortcode-codeblock-bash">
  <div class="d-flex overflow-hidden">
    <div class="flex-grow-1 rounded overflow-hidden" id="cp-e297a8da19ccac90500f0cd0a3d2e834">
      
      <pre><code class='language-bash'>nmcli con down enp1s0 &amp;&amp; nmcli con up enp1s0</code></pre>
    </div>
    <div class="flex-shrink-0">
      <ul class="list-inline mb-0">
        <li class="list-inline-item" data-bs-tooltip data-bs-title='Копировать'>
          <a class="text-body" href="#"
             data-fn="clipboard preventDefault" data-clipboard-target="#cp-e297a8da19ccac90500f0cd0a3d2e834"
             role="button" aria-label='Копировать'>
            <i class="fas fa-copy fa-fw"></i>
          </a>
        </li>
      </ul>
    </div>
  </div>
</div>

<h2 id="настройка-ip-при-помощи-network-manager-cli-nmcli">
  <a class="link-body-emphasis" href="#%d0%bd%d0%b0%d1%81%d1%82%d1%80%d0%be%d0%b9%d0%ba%d0%b0-ip-%d0%bf%d1%80%d0%b8-%d0%bf%d0%be%d0%bc%d0%be%d1%89%d0%b8-network-manager-cli-nmcli">Настройка IP при помощи Network Manager CLI (nmcli)</a>
</h2><p>Установка <span class="shortcode shortcode-tag"><a href="/ru/tags/ip/" target="_blank">#IP</a></span> адреса:</p>



<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-12 shortcode-codeblock-bash">
  <div class="d-flex overflow-hidden">
    <div class="flex-grow-1 rounded overflow-hidden" id="cp-46eb39c66c7b6a150e0e40bf7c031959">
      
      <pre><code class='language-bash'>nmcli con mod enp1s0 ipv4.addresses &#39;192.168.10.55/24&#39;</code></pre>
    </div>
    <div class="flex-shrink-0">
      <ul class="list-inline mb-0">
        <li class="list-inline-item" data-bs-tooltip data-bs-title='Копировать'>
          <a class="text-body" href="#"
             data-fn="clipboard preventDefault" data-clipboard-target="#cp-46eb39c66c7b6a150e0e40bf7c031959"
             role="button" aria-label='Копировать'>
            <i class="fas fa-copy fa-fw"></i>
          </a>
        </li>
      </ul>
    </div>
  </div>
</div>

<p>Установка шлюза:</p>



<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-13 shortcode-codeblock-bash">
  <div class="d-flex overflow-hidden">
    <div class="flex-grow-1 rounded overflow-hidden" id="cp-386cca40c5ccab3e3260a3ef66271ebe">
      
      <pre><code class='language-bash'>nmcli con mod enp1s0 ipv4.gateway &#39;192.168.10.1&#39;</code></pre>
    </div>
    <div class="flex-shrink-0">
      <ul class="list-inline mb-0">
        <li class="list-inline-item" data-bs-tooltip data-bs-title='Копировать'>
          <a class="text-body" href="#"
             data-fn="clipboard preventDefault" data-clipboard-target="#cp-386cca40c5ccab3e3260a3ef66271ebe"
             role="button" aria-label='Копировать'>
            <i class="fas fa-copy fa-fw"></i>
          </a>
        </li>
      </ul>
    </div>
  </div>
</div>

<p>Установка <span class="shortcode shortcode-tag"><a href="/ru/tags/dns/" target="_blank">#DNS</a></span>:</p>



<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-15 shortcode-codeblock-bash">
  <div class="d-flex overflow-hidden">
    <div class="flex-grow-1 rounded overflow-hidden" id="cp-6388102c58c61265090370db78abe9a7">
      
      <pre><code class='language-bash'>nmcli con mod enp1s0 ipv4.dns &#39;192.168.11.1&#39;</code></pre>
    </div>
    <div class="flex-shrink-0">
      <ul class="list-inline mb-0">
        <li class="list-inline-item" data-bs-tooltip data-bs-title='Копировать'>
          <a class="text-body" href="#"
             data-fn="clipboard preventDefault" data-clipboard-target="#cp-6388102c58c61265090370db78abe9a7"
             role="button" aria-label='Копировать'>
            <i class="fas fa-copy fa-fw"></i>
          </a>
        </li>
      </ul>
    </div>
  </div>
</div>

<p>Установка <strong>BOOTPROTO</strong> в <code>none</code>:</p>



<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-16 shortcode-codeblock-bash">
  <div class="d-flex overflow-hidden">
    <div class="flex-grow-1 rounded overflow-hidden" id="cp-573d3b1ab5699b9d42dcdad933f7ebaa">
      
      <pre><code class='language-bash'>nmcli con mod enp1s0 ipv4.method &#39;manual&#39;</code></pre>
    </div>
    <div class="flex-shrink-0">
      <ul class="list-inline mb-0">
        <li class="list-inline-item" data-bs-tooltip data-bs-title='Копировать'>
          <a class="text-body" href="#"
             data-fn="clipboard preventDefault" data-clipboard-target="#cp-573d3b1ab5699b9d42dcdad933f7ebaa"
             role="button" aria-label='Копировать'>
            <i class="fas fa-copy fa-fw"></i>
          </a>
        </li>
      </ul>
    </div>
  </div>
</div>

<p>Перезапуск интерфейса:</p>



<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-17 shortcode-codeblock-bash">
  <div class="d-flex overflow-hidden">
    <div class="flex-grow-1 rounded overflow-hidden" id="cp-a589e9687b570f0bdf3d013e230aa805">
      
      <pre><code class='language-bash'>nmcli con down enp1s0 &amp;&amp; nmcli con up enp1s0</code></pre>
    </div>
    <div class="flex-shrink-0">
      <ul class="list-inline mb-0">
        <li class="list-inline-item" data-bs-tooltip data-bs-title='Копировать'>
          <a class="text-body" href="#"
             data-fn="clipboard preventDefault" data-clipboard-target="#cp-a589e9687b570f0bdf3d013e230aa805"
             role="button" aria-label='Копировать'>
            <i class="fas fa-copy fa-fw"></i>
          </a>
        </li>
      </ul>
    </div>
  </div>
</div>]]></turbo:content></item><item turbo="true"><title>Перезагрузка и выключение Linux</title><link>https://lib.onl/ru/articles/2021/05/86db7f3a-17ce-502b-b21d-337c3bba5d58/</link><pubDate>Wed, 12 May 2021 14:20:47 +0000</pubDate><dc:creator>Kai Kimera</dc:creator><category>Терминал</category><category>Linux</category><turbo:extendedHtml>true</turbo:extendedHtml><turbo:source>https://lib.onl/ru/articles/2021/05/86db7f3a-17ce-502b-b21d-337c3bba5d58/</turbo:source><turbo:topic>Перезагрузка и выключение Linux</turbo:topic><turbo:content><![CDATA[<p>Нередко приходится завершать работу системы через терминал, например, когда компьютер является удалённой рабочей станцией или сервером и вся работа происходит через терминал. В этой статье я постараюсь привести информацию о командах, позволяющих удалённо завершить работу системы.</p>
<h2 id="halt--poweroff--reboot">
  <a class="link-body-emphasis" href="#halt--poweroff--reboot">halt / poweroff / reboot</a>
</h2><p>Старые команды по управлению питанием системы. Опции у этих команд одинаковые. Отдаются команды из под пользователя <strong>root</strong>. Команда <code>halt</code> приостанавливает все функции <span class="shortcode shortcode-tag">CPU</span>, но сам ПК остаётся включённым. Команда <code>poweroff</code> отключает питание ПК, посылая сигнал по <span class="shortcode shortcode-tag">ACPI</span>. Команда <code>reboot</code> даёт команду системе на перезагрузку.</p>




    










    
    




<div class="shortcode shortcode-alert">
  <div class="alert alert-success d-flex overflow-hidden" role="alert">
    <div class="flex-shrink-0 align-self-center">
      <i class="fas fa-lightbulb fa-fw fa-2x"></i>
    </div>
    <div class="flex-grow-1 ms-3 overflow-hidden">
        <p>Команда <code>halt</code> в современных ОС полностью прекращает работу системы. На системах с <strong>systemd</strong> команда <code>halt</code> является устаревшей и представляет собой символьную ссылку на утилиту <code>systemctl</code>.</p>

    </div>
  </div>
</div>

<p>Предпочтительнее использовать команду <code>shutdown</code>, о которой я расскажу ниже.</p>
<h3 id="синтаксис">
  <a class="link-body-emphasis" href="#%d1%81%d0%b8%d0%bd%d1%82%d0%b0%d0%ba%d1%81%d0%b8%d1%81">Синтаксис</a>
</h3>


<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-3 shortcode-codeblock-text">
  <div class="d-flex overflow-hidden">
    <div class="flex-grow-1 rounded overflow-hidden" id="cp-c50cc034a88af0317a166738c3a8d310">
      
      <pre><code class='language-text'>halt [OPTION]
poweroff [OPTION]
reboot [OPTION]</code></pre>
    </div>
    <div class="flex-shrink-0">
      <ul class="list-inline mb-0">
        <li class="list-inline-item" data-bs-tooltip data-bs-title='Копировать'>
          <a class="text-body" href="#"
             data-fn="clipboard preventDefault" data-clipboard-target="#cp-c50cc034a88af0317a166738c3a8d310"
             role="button" aria-label='Копировать'>
            <i class="fas fa-copy fa-fw"></i>
          </a>
        </li>
      </ul>
    </div>
  </div>
</div>

<h4 id="некоторые-опции">
  <a class="link-body-emphasis" href="#%d0%bd%d0%b5%d0%ba%d0%be%d1%82%d0%be%d1%80%d1%8b%d0%b5-%d0%be%d0%bf%d1%86%d0%b8%d0%b8">Некоторые опции</a>
</h4><ul>
<li><code>-f</code> - принудительное выполнение команды.</li>
<li><code>-p</code> - сообщает команде <code>halt</code> действовать как <code>poweroff</code>.</li>
<li><code>-w</code> - не выполнять никакие действия, только записать в журнал <code>/var/log/wtmp</code> сообщение о завершении работы.</li>
</ul>
<h2 id="shutdown">
  <a class="link-body-emphasis" href="#shutdown">shutdown</a>
</h2><p>За остановку работы ПК отвечает команда <code>shutdown</code>. Она поддерживает несколько опций, через которые задаётся определённое действие. К примеру:</p>
<ul>
<li><code>-r</code> - перезагрузка.</li>
<li><code>-h</code> - выключение.</li>
<li><code>-c</code> - отмена запланированных действий на перезагрузку или выключение.</li>
</ul>
<p>Для запланированной перезагрузки ПК через 1 минуту используется опция <code>-r</code>:</p>



<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-4 shortcode-codeblock-bash">
  <div class="d-flex overflow-hidden">
    <div class="flex-grow-1 rounded overflow-hidden" id="cp-928cee35bee52c328f04aba3371b8778">
      
      <pre><code class='language-bash'>shutdown -r</code></pre>
    </div>
    <div class="flex-shrink-0">
      <ul class="list-inline mb-0">
        <li class="list-inline-item" data-bs-tooltip data-bs-title='Копировать'>
          <a class="text-body" href="#"
             data-fn="clipboard preventDefault" data-clipboard-target="#cp-928cee35bee52c328f04aba3371b8778"
             role="button" aria-label='Копировать'>
            <i class="fas fa-copy fa-fw"></i>
          </a>
        </li>
      </ul>
    </div>
  </div>
</div>

<p>Команда <code>shutdown</code> поддерживает указание времени, когда ПК должен быть перезагружен или выключен. К примеру, перезагрузить через 5 минут:</p>



<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-5 shortcode-codeblock-bash">
  <div class="d-flex overflow-hidden">
    <div class="flex-grow-1 rounded overflow-hidden" id="cp-d2b1e94cfb3ed693bac3d53a3c3da16e">
      
      <pre><code class='language-bash'>shutdown -r &#43;5</code></pre>
    </div>
    <div class="flex-shrink-0">
      <ul class="list-inline mb-0">
        <li class="list-inline-item" data-bs-tooltip data-bs-title='Копировать'>
          <a class="text-body" href="#"
             data-fn="clipboard preventDefault" data-clipboard-target="#cp-d2b1e94cfb3ed693bac3d53a3c3da16e"
             role="button" aria-label='Копировать'>
            <i class="fas fa-copy fa-fw"></i>
          </a>
        </li>
      </ul>
    </div>
  </div>
</div>

<p>Также можно указать конкретное время для перезагрузки. Например, перезагрузить ПК в 18:30:</p>



<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-6 shortcode-codeblock-bash">
  <div class="d-flex overflow-hidden">
    <div class="flex-grow-1 rounded overflow-hidden" id="cp-16d5a6a41f053337fdaf3745fd30a05a">
      
      <pre><code class='language-bash'>shutdown -r 18:30</code></pre>
    </div>
    <div class="flex-shrink-0">
      <ul class="list-inline mb-0">
        <li class="list-inline-item" data-bs-tooltip data-bs-title='Копировать'>
          <a class="text-body" href="#"
             data-fn="clipboard preventDefault" data-clipboard-target="#cp-16d5a6a41f053337fdaf3745fd30a05a"
             role="button" aria-label='Копировать'>
            <i class="fas fa-copy fa-fw"></i>
          </a>
        </li>
      </ul>
    </div>
  </div>
</div>

<p>Если перезагрузка или выключение уже запланированы, их можно отменить опцией <code>-c</code>:</p>



<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-7 shortcode-codeblock-bash">
  <div class="d-flex overflow-hidden">
    <div class="flex-grow-1 rounded overflow-hidden" id="cp-f9dfe2244a892918b20d45ecc82a9b7e">
      
      <pre><code class='language-bash'>shutdown -c</code></pre>
    </div>
    <div class="flex-shrink-0">
      <ul class="list-inline mb-0">
        <li class="list-inline-item" data-bs-tooltip data-bs-title='Копировать'>
          <a class="text-body" href="#"
             data-fn="clipboard preventDefault" data-clipboard-target="#cp-f9dfe2244a892918b20d45ecc82a9b7e"
             role="button" aria-label='Копировать'>
            <i class="fas fa-copy fa-fw"></i>
          </a>
        </li>
      </ul>
    </div>
  </div>
</div>

<p>Для немедленной перезагрузки ПК, вместо времени можно ввести <code>now</code>:</p>



<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-8 shortcode-codeblock-bash">
  <div class="d-flex overflow-hidden">
    <div class="flex-grow-1 rounded overflow-hidden" id="cp-cade6a4abc3b48485c85c9e0aa72765f">
      
      <pre><code class='language-bash'>shutdown -r now</code></pre>
    </div>
    <div class="flex-shrink-0">
      <ul class="list-inline mb-0">
        <li class="list-inline-item" data-bs-tooltip data-bs-title='Копировать'>
          <a class="text-body" href="#"
             data-fn="clipboard preventDefault" data-clipboard-target="#cp-cade6a4abc3b48485c85c9e0aa72765f"
             role="button" aria-label='Копировать'>
            <i class="fas fa-copy fa-fw"></i>
          </a>
        </li>
      </ul>
    </div>
  </div>
</div>

<p>Чтобы выключить ПК через 1 минуту, используется опция <code>-h</code>:</p>



<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-9 shortcode-codeblock-bash">
  <div class="d-flex overflow-hidden">
    <div class="flex-grow-1 rounded overflow-hidden" id="cp-0235f4005d5d0c6fb3dcab2589bf98a6">
      
      <pre><code class='language-bash'>shutdown -h</code></pre>
    </div>
    <div class="flex-shrink-0">
      <ul class="list-inline mb-0">
        <li class="list-inline-item" data-bs-tooltip data-bs-title='Копировать'>
          <a class="text-body" href="#"
             data-fn="clipboard preventDefault" data-clipboard-target="#cp-0235f4005d5d0c6fb3dcab2589bf98a6"
             role="button" aria-label='Копировать'>
            <i class="fas fa-copy fa-fw"></i>
          </a>
        </li>
      </ul>
    </div>
  </div>
</div>

<p>На этом всё, ничего сложного нет. <span class="shortcode shortcode-emoji">😄</span></p>]]></turbo:content></item><item turbo="true"><title>Рекурсивное изменение прав доступа на файлы и директории</title><link>https://lib.onl/ru/articles/2021/05/4a3b0a31-0d3d-5a9b-8c07-7e3b4f80669e/</link><pubDate>Sun, 09 May 2021 17:15:26 +0000</pubDate><dc:creator>Kai Kimera</dc:creator><category>Терминал</category><category>Linux</category><turbo:extendedHtml>true</turbo:extendedHtml><turbo:source>https://lib.onl/ru/articles/2021/05/4a3b0a31-0d3d-5a9b-8c07-7e3b4f80669e/</turbo:source><turbo:topic>Рекурсивное изменение прав доступа на файлы и директории</turbo:topic><turbo:content><![CDATA[<p>Права доступа к файлам и директориям является неотъемлемой частью любой операционной системы. И в этой статье описаны возможности по рекурсивной настройке этих прав доступа.</p>
<p>Изменение прав доступа осуществляется при помощи команды <code>chmod</code>, рекурсивное при добавлении опции <code>-R</code>:</p>



<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-0 shortcode-codeblock-bash">
  <div class="d-flex overflow-hidden">
    <div class="flex-grow-1 rounded overflow-hidden" id="cp-3d2c7996db2554c8c3bccf887bffdd1b">
      
      <pre><code class='language-bash'>chmod -R MODE DIR</code></pre>
    </div>
    <div class="flex-shrink-0">
      <ul class="list-inline mb-0">
        <li class="list-inline-item" data-bs-tooltip data-bs-title='Копировать'>
          <a class="text-body" href="#"
             data-fn="clipboard preventDefault" data-clipboard-target="#cp-3d2c7996db2554c8c3bccf887bffdd1b"
             role="button" aria-label='Копировать'>
            <i class="fas fa-copy fa-fw"></i>
          </a>
        </li>
      </ul>
    </div>
  </div>
</div>

<ul>
<li><code>-R</code> - рекурсивный обход директорий и файлов.</li>
<li><code>MODE</code> - набор прав доступа для их установки.</li>
<li><code>DIR</code> - файл или директория, у которых необходимо установить определённые права доступа.</li>
</ul>
<p>В итоге, команда должна выглядеть так:</p>



<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-1 shortcode-codeblock-bash">
  <div class="d-flex overflow-hidden">
    <div class="flex-grow-1 rounded overflow-hidden" id="cp-6449757c5e7834812b23cac3ef350b39">
      
      <pre><code class='language-bash'>chmod -R 755 /var/www/html</code></pre>
    </div>
    <div class="flex-shrink-0">
      <ul class="list-inline mb-0">
        <li class="list-inline-item" data-bs-tooltip data-bs-title='Копировать'>
          <a class="text-body" href="#"
             data-fn="clipboard preventDefault" data-clipboard-target="#cp-6449757c5e7834812b23cac3ef350b39"
             role="button" aria-label='Копировать'>
            <i class="fas fa-copy fa-fw"></i>
          </a>
        </li>
      </ul>
    </div>
  </div>
</div>

<p>Но, стоит учитывать, что таким образом директории и файлы примут одинаковые права доступа. Чтобы избежать этого, можно воспользоваться командой <code>find</code>, которая отфильтрует директории и файлы друг от друга:</p>



<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-2 shortcode-codeblock-bash">
  <div class="d-flex overflow-hidden">
    <div class="flex-grow-1 rounded overflow-hidden" id="cp-4247b0342e5d5ed1255ce0e72d144e34">
      
      <pre><code class='language-bash'>find /var/www/html -type d -exec chmod 755 {} \;</code></pre>
    </div>
    <div class="flex-shrink-0">
      <ul class="list-inline mb-0">
        <li class="list-inline-item" data-bs-tooltip data-bs-title='Копировать'>
          <a class="text-body" href="#"
             data-fn="clipboard preventDefault" data-clipboard-target="#cp-4247b0342e5d5ed1255ce0e72d144e34"
             role="button" aria-label='Копировать'>
            <i class="fas fa-copy fa-fw"></i>
          </a>
        </li>
      </ul>
    </div>
  </div>
</div>




<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-3 shortcode-codeblock-bash">
  <div class="d-flex overflow-hidden">
    <div class="flex-grow-1 rounded overflow-hidden" id="cp-994319bac7cfc02986dc36c1f970276c">
      
      <pre><code class='language-bash'>find /var/www/html -type f -exec chmod 644 {} \;</code></pre>
    </div>
    <div class="flex-shrink-0">
      <ul class="list-inline mb-0">
        <li class="list-inline-item" data-bs-tooltip data-bs-title='Копировать'>
          <a class="text-body" href="#"
             data-fn="clipboard preventDefault" data-clipboard-target="#cp-994319bac7cfc02986dc36c1f970276c"
             role="button" aria-label='Копировать'>
            <i class="fas fa-copy fa-fw"></i>
          </a>
        </li>
      </ul>
    </div>
  </div>
</div>

<p>Команда <code>find</code> ищет директории (<code>-type d</code>) и файлы (<code>-type f</code>) и скармливает их команде <code>chmod</code>, а та, в свою очередь, уже расставляет права доступа. При использовании <code>-exec</code>, <code>chmod</code> выполняется для каждого найденного элемента поочерёдно. Можно оптимизировать и записать с использованием <code>xargs</code>:</p>



<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-4 shortcode-codeblock-bash">
  <div class="d-flex overflow-hidden">
    <div class="flex-grow-1 rounded overflow-hidden" id="cp-4bcfa497af08ee08177aada748187091">
      
      <pre><code class='language-bash'>find /var/www/html -type d -print0 | xargs -0 chmod 755</code></pre>
    </div>
    <div class="flex-shrink-0">
      <ul class="list-inline mb-0">
        <li class="list-inline-item" data-bs-tooltip data-bs-title='Копировать'>
          <a class="text-body" href="#"
             data-fn="clipboard preventDefault" data-clipboard-target="#cp-4bcfa497af08ee08177aada748187091"
             role="button" aria-label='Копировать'>
            <i class="fas fa-copy fa-fw"></i>
          </a>
        </li>
      </ul>
    </div>
  </div>
</div>




<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-5 shortcode-codeblock-bash">
  <div class="d-flex overflow-hidden">
    <div class="flex-grow-1 rounded overflow-hidden" id="cp-db9b4e85501b78bb4e6fc9179f158369">
      
      <pre><code class='language-bash'>find /var/www/html -type f -print0 | xargs -0 chmod 644</code></pre>
    </div>
    <div class="flex-shrink-0">
      <ul class="list-inline mb-0">
        <li class="list-inline-item" data-bs-tooltip data-bs-title='Копировать'>
          <a class="text-body" href="#"
             data-fn="clipboard preventDefault" data-clipboard-target="#cp-db9b4e85501b78bb4e6fc9179f158369"
             role="button" aria-label='Копировать'>
            <i class="fas fa-copy fa-fw"></i>
          </a>
        </li>
      </ul>
    </div>
  </div>
</div>

<p>При <code>xargs</code>, <code>chmod</code> выполняется сразу для нескольких записей одновременно, как сообщает <strong>Daniel Miessler</strong>:</p>

    

    <div class="shortcode shortcode-quote">
      <figure>
        <blockquote class="blockquote">
            <p>This is where -exec breaks down and xargs shows its superiority. When you use -exec to do the work you run a separate instance of the called program for each element of input. So if find comes up with 10,000 results, you run exec 10,000 times. With xargs, you build up the input into bundles and run them through the command as few times as possible, which is often just once. When dealing with hundreds or thousands of elements this is a big win for xargs.</p>

        </blockquote>
          
            <figcaption class="blockquote-footer">
              <cite>
                  
                    <a href="https://danielmiessler.com/blog/linux-xargs-vs-exec/" target="_blank" rel="noopener nofollow">Daniel Miessler</a>
                  
              </cite>
            </figcaption>
          
      </figure>
    </div>
<p>Если необходимо запустить рекурсивное изменение прав доступа начиная с текущей директории, то <code>/var/www/html</code> необходимо поменять на точку:</p>



<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-7 shortcode-codeblock-bash">
  <div class="d-flex overflow-hidden">
    <div class="flex-grow-1 rounded overflow-hidden" id="cp-9e3814281ffa9e3bc8b23b365e587190">
      
      <pre><code class='language-bash'>find . -type d -print0 | xargs -0 chmod 755</code></pre>
    </div>
    <div class="flex-shrink-0">
      <ul class="list-inline mb-0">
        <li class="list-inline-item" data-bs-tooltip data-bs-title='Копировать'>
          <a class="text-body" href="#"
             data-fn="clipboard preventDefault" data-clipboard-target="#cp-9e3814281ffa9e3bc8b23b365e587190"
             role="button" aria-label='Копировать'>
            <i class="fas fa-copy fa-fw"></i>
          </a>
        </li>
      </ul>
    </div>
  </div>
</div>




<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-8 shortcode-codeblock-bash">
  <div class="d-flex overflow-hidden">
    <div class="flex-grow-1 rounded overflow-hidden" id="cp-e6ba7917e99c464286a6ee7ab02d7c25">
      
      <pre><code class='language-bash'>find . -type f -print0 | xargs -0 chmod 644</code></pre>
    </div>
    <div class="flex-shrink-0">
      <ul class="list-inline mb-0">
        <li class="list-inline-item" data-bs-tooltip data-bs-title='Копировать'>
          <a class="text-body" href="#"
             data-fn="clipboard preventDefault" data-clipboard-target="#cp-e6ba7917e99c464286a6ee7ab02d7c25"
             role="button" aria-label='Копировать'>
            <i class="fas fa-copy fa-fw"></i>
          </a>
        </li>
      </ul>
    </div>
  </div>
</div>]]></turbo:content></item><item turbo="true"><title>Разнообразие команд ls*</title><link>https://lib.onl/ru/articles/2021/05/5ba03b8a-0505-5d80-bfad-f7a4d66f07b0/</link><pubDate>Sun, 09 May 2021 13:44:05 +0000</pubDate><dc:creator>Kai Kimera</dc:creator><category>Терминал</category><category>В доработке</category><category>Linux</category><turbo:extendedHtml>true</turbo:extendedHtml><turbo:source>https://lib.onl/ru/articles/2021/05/5ba03b8a-0505-5d80-bfad-f7a4d66f07b0/</turbo:source><turbo:topic>Разнообразие команд ls*</turbo:topic><turbo:content><![CDATA[<p>Команда <code>ls</code> и её разновидности позволяют вывести список директорий, файлов, устройств и различной другой информации. Я расскажу только о некоторых командах <code>ls*</code>, которые присутствуют в большинстве дистрибутивов <span class="shortcode shortcode-tag"><a href="/ru/tags/linux/" target="_blank">#Linux</a></span>.</p>
<p>Знаю, что есть <code>lsscsi</code>, <code>lsusb</code> и т.п., которые появляются в системе с установкой дополнительных пакетов, но я подобные команды рассматривать не стал. Хотя, по возможности, статью буду дополнять.</p>
<h2 id="ls">
  <a class="link-body-emphasis" href="#ls">ls</a>
</h2><p>Команда позволяет вывести список директорий и файлов в текущем каталоге.</p>
<h3 id="некоторые-опции">
  <a class="link-body-emphasis" href="#%d0%bd%d0%b5%d0%ba%d0%be%d1%82%d0%be%d1%80%d1%8b%d0%b5-%d0%be%d0%bf%d1%86%d0%b8%d0%b8">Некоторые опции</a>
</h3><ul>
<li><code>-l</code> - использовать длинный формат отображения.</li>
<li><code>-S</code> - сортировать по размеру файла.</li>
<li><code>-t</code> - сортировать по времени модификации.</li>
<li><code>-a</code> - показать ВСЕ файлы, в том числе скрытые.</li>
<li><code>-R</code> - рекурсивное отображение директорий и файлов в них.</li>
<li><code>-h</code> - отображение размеров файлов в человеко-читаемом формате.</li>
<li><code>--hide='*.txt' -l</code> - игнорировать файлы с форматом <code>.txt</code>.</li>
</ul>
<h2 id="lscpu">
  <a class="link-body-emphasis" href="#lscpu">lscpu</a>
</h2><p>Отображение доступной информации об установленном процессоре.</p>
<h3 id="некоторые-опции-1">
  <a class="link-body-emphasis" href="#%d0%bd%d0%b5%d0%ba%d0%be%d1%82%d0%be%d1%80%d1%8b%d0%b5-%d0%be%d0%bf%d1%86%d0%b8%d0%b8-1">Некоторые опции</a>
</h3><ul>
<li><code>-a</code> - показать ВСЕ <span class="shortcode shortcode-tag">CPU</span>, как включённые, так и отключённые.</li>
</ul>
<h3 id="пример-использования">
  <a class="link-body-emphasis" href="#%d0%bf%d1%80%d0%b8%d0%bc%d0%b5%d1%80-%d0%b8%d1%81%d0%bf%d0%be%d0%bb%d1%8c%d0%b7%d0%be%d0%b2%d0%b0%d0%bd%d0%b8%d1%8f">Пример использования</a>
</h3>





<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-2 shortcode-codeblock-terminal
shortcode-codeblock-terminal-linux shortcode-codeblock-terminal-linux-user">
  <div class="card overflow-hidden" data-bs-theme="dark">
    <div class="card-header">
      <div class="d-flex align-items-center">
        <div class="flex-shrink-0 ">
          <i class="fas fa-terminal fa-fw"></i>
        </div>
        <div class="flex-grow-1 mx-2">
          <h5 class="mb-0">Терминал</h5>
        </div>
        <div class="flex-shrink-0">
          <ul class="list-inline mb-0">
            <li class="list-inline-item" data-bs-tooltip data-bs-title='Копировать'>
              <a class="text-body" href="#"
                 data-fn="clipboard preventDefault" data-clipboard-target="#cp-366d62da23cd025c80f3ff8d46ef6018"
                 role="button" aria-label='Копировать'>
                <i class="fas fa-copy fa-fw"></i>
              </a>
            </li>
          </ul>
        </div>
      </div>
    </div>
    <div class="card-body p-0" id="cp-366d62da23cd025c80f3ff8d46ef6018">
      <pre><code class="language-plaintext">lscpu

Architecture:                    x86_64
CPU op-mode(s):                  32-bit, 64-bit
Byte Order:                      Little Endian
Address sizes:                   39 bits physical, 48 bits virtual
CPU(s):                          12
On-line CPU(s) list:             0-11
Thread(s) per core:              2
Core(s) per socket:              6
Socket(s):                       1
NUMA node(s):                    1
Vendor ID:                       GenuineIntel
CPU family:                      6
Model:                           165
Model name:                      Intel(R) Core(TM) i5-10400 CPU @ 2.90GHz
Stepping:                        5
CPU MHz:                         2900.000
CPU max MHz:                     4300.0000
CPU min MHz:                     800.0000
BogoMIPS:                        5799.77
L1d cache:                       192 KiB
L1i cache:                       192 KiB
L2 cache:                        1.5 MiB
L3 cache:                        12 MiB</code></pre>
    </div>
  </div>
</div>

<h2 id="lspci">
  <a class="link-body-emphasis" href="#lspci">lspci</a>
</h2><p>Отображение информации по шине <span class="shortcode shortcode-tag">PCI</span> и подключённых к ней устройствах.</p>
<h3 id="пример-использования-1">
  <a class="link-body-emphasis" href="#%d0%bf%d1%80%d0%b8%d0%bc%d0%b5%d1%80-%d0%b8%d1%81%d0%bf%d0%be%d0%bb%d1%8c%d0%b7%d0%be%d0%b2%d0%b0%d0%bd%d0%b8%d1%8f-1">Пример использования</a>
</h3>





<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-4 shortcode-codeblock-terminal
shortcode-codeblock-terminal-linux shortcode-codeblock-terminal-linux-user">
  <div class="card overflow-hidden" data-bs-theme="dark">
    <div class="card-header">
      <div class="d-flex align-items-center">
        <div class="flex-shrink-0 ">
          <i class="fas fa-terminal fa-fw"></i>
        </div>
        <div class="flex-grow-1 mx-2">
          <h5 class="mb-0">Терминал</h5>
        </div>
        <div class="flex-shrink-0">
          <ul class="list-inline mb-0">
            <li class="list-inline-item" data-bs-tooltip data-bs-title='Копировать'>
              <a class="text-body" href="#"
                 data-fn="clipboard preventDefault" data-clipboard-target="#cp-56eda4186bc9426454aa94447ff6e3d6"
                 role="button" aria-label='Копировать'>
                <i class="fas fa-copy fa-fw"></i>
              </a>
            </li>
          </ul>
        </div>
      </div>
    </div>
    <div class="card-body p-0" id="cp-56eda4186bc9426454aa94447ff6e3d6">
      <pre><code class="language-plaintext">lspci

00:00.0 Host bridge: Intel Corporation Comet Lake-S 6c Host Bridge/DRAM Controller (rev 05)
00:01.0 PCI bridge: Intel Corporation 6th-10th Gen Core Processor PCIe Controller (x16) (rev 05)
00:14.0 USB controller: Intel Corporation Comet Lake USB 3.1 xHCI Host Controller
00:14.2 RAM memory: Intel Corporation Comet Lake PCH Shared SRAM
00:14.3 Network controller: Intel Corporation Comet Lake PCH CNVi WiFi
00:15.0 Serial bus controller [0c80]: Intel Corporation Comet Lake PCH Serial IO I2C Controller #0
00:15.1 Serial bus controller [0c80]: Intel Corporation Comet Lake PCH Serial IO I2C Controller #1
00:16.0 Communication controller: Intel Corporation Comet Lake HECI Controller
00:17.0 SATA controller: Intel Corporation Comet Lake SATA AHCI Controller
00:1d.0 PCI bridge: Intel Corporation Comet Lake PCI Express Root Port #9 (rev f0)
00:1f.0 ISA bridge: Intel Corporation Device 0684
00:1f.3 Audio device: Intel Corporation Comet Lake PCH cAVS
00:1f.4 SMBus: Intel Corporation Comet Lake PCH SMBus Controller
00:1f.5 Serial bus controller [0c80]: Intel Corporation Comet Lake PCH SPI Controller
00:1f.6 Ethernet controller: Intel Corporation Ethernet Connection (11) I219-V
01:00.0 VGA compatible controller: Advanced Micro Devices, Inc. [AMD/ATI] Baffin [Radeon RX 550 640SP / RX 560/560X] (rev cf)
01:00.1 Audio device: Advanced Micro Devices, Inc. [AMD/ATI] Baffin HDMI/DP Audio [Radeon RX 550 640SP / RX 560/560X]</code></pre>
    </div>
  </div>
</div>

<h2 id="lsblk">
  <a class="link-body-emphasis" href="#lsblk">lsblk</a>
</h2><p>Отображение информации по блочным устройствам.</p>
<h3 id="пример-использования-2">
  <a class="link-body-emphasis" href="#%d0%bf%d1%80%d0%b8%d0%bc%d0%b5%d1%80-%d0%b8%d1%81%d0%bf%d0%be%d0%bb%d1%8c%d0%b7%d0%be%d0%b2%d0%b0%d0%bd%d0%b8%d1%8f-2">Пример использования</a>
</h3>





<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-5 shortcode-codeblock-terminal
shortcode-codeblock-terminal-linux shortcode-codeblock-terminal-linux-user">
  <div class="card overflow-hidden" data-bs-theme="dark">
    <div class="card-header">
      <div class="d-flex align-items-center">
        <div class="flex-shrink-0 ">
          <i class="fas fa-terminal fa-fw"></i>
        </div>
        <div class="flex-grow-1 mx-2">
          <h5 class="mb-0">Терминал</h5>
        </div>
        <div class="flex-shrink-0">
          <ul class="list-inline mb-0">
            <li class="list-inline-item" data-bs-tooltip data-bs-title='Копировать'>
              <a class="text-body" href="#"
                 data-fn="clipboard preventDefault" data-clipboard-target="#cp-0eb32f583594d7617e2eb2d347c72ab3"
                 role="button" aria-label='Копировать'>
                <i class="fas fa-copy fa-fw"></i>
              </a>
            </li>
          </ul>
        </div>
      </div>
    </div>
    <div class="card-body p-0" id="cp-0eb32f583594d7617e2eb2d347c72ab3">
      <pre><code class="language-plaintext">lsblk

NAME   MAJ:MIN RM   SIZE RO TYPE MOUNTPOINT
sda      8:0    0 232.9G  0 disk
├─sda1   8:1    0   200M  0 part /boot/efi
├─sda2   8:2    0     4G  0 part /boot
├─sda3   8:3    0    64G  0 part /
├─sda4   8:4    0    32G  0 part [SWAP]
├─sda5   8:5    0    16G  0 part /tmp
└─sda6   8:6    0 116.7G  0 part /home
sdb      8:16   0 465.8G  0 disk
└─sdb1   8:17   0 465.8G  0 part /home/storage.01
sdc      8:32   1 119.5G  0 disk
└─sdc1   8:33   1 119.5G  0 part /run/media/user-0001/USB01
sdd      8:48   1  59.8G  0 disk
├─sdd1   8:49   1  59.7G  0 part /run/media/user-0001/Ventoy
└─sdd2   8:50   1    32M  0 part /run/media/user-0001/VTOYEFI
zram0  252:0    0     4G  0 disk [SWAP]</code></pre>
    </div>
  </div>
</div>

<h2 id="lsmod">
  <a class="link-body-emphasis" href="#lsmod">lsmod</a>
</h2><p>Отображение модулей ядра, загруженных в системе.</p>
<h3 id="пример-использования-3">
  <a class="link-body-emphasis" href="#%d0%bf%d1%80%d0%b8%d0%bc%d0%b5%d1%80-%d0%b8%d1%81%d0%bf%d0%be%d0%bb%d1%8c%d0%b7%d0%be%d0%b2%d0%b0%d0%bd%d0%b8%d1%8f-3">Пример использования</a>
</h3>





<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-6 shortcode-codeblock-terminal
shortcode-codeblock-terminal-linux shortcode-codeblock-terminal-linux-user">
  <div class="card overflow-hidden" data-bs-theme="dark">
    <div class="card-header">
      <div class="d-flex align-items-center">
        <div class="flex-shrink-0 ">
          <i class="fas fa-terminal fa-fw"></i>
        </div>
        <div class="flex-grow-1 mx-2">
          <h5 class="mb-0">Терминал</h5>
        </div>
        <div class="flex-shrink-0">
          <ul class="list-inline mb-0">
            <li class="list-inline-item" data-bs-tooltip data-bs-title='Копировать'>
              <a class="text-body" href="#"
                 data-fn="clipboard preventDefault" data-clipboard-target="#cp-63de353497f686864e8e562caebf0ecd"
                 role="button" aria-label='Копировать'>
                <i class="fas fa-copy fa-fw"></i>
              </a>
            </li>
          </ul>
        </div>
      </div>
    </div>
    <div class="card-body p-0" id="cp-63de353497f686864e8e562caebf0ecd">
      <pre><code class="language-plaintext">lsmod

Module                  Size  Used by
exfat                  81920  1
f2fs                  700416  1
uas                    32768  0
usb_storage            81920  4 uas
snd_seq_dummy          16384  0
rfcomm                 90112  0
snd_hrtimer            16384  1
xt_CHECKSUM            16384  1
xt_MASQUERADE          20480  3
xt_conntrack           16384  1
ipt_REJECT             16384  2
nft_compat             20480  16
nf_nat_tftp            16384  0
nft_objref             16384  1
nf_conntrack_tftp      20480  3 nf_nat_tftp
nft_counter            16384  33
tun                    57344  1
bridge                294912  0
stp                    16384  1 bridge
llc                    16384  2 bridge,stp</code></pre>
    </div>
  </div>
</div>]]></turbo:content></item><item turbo="true"><title>Синхронизация репозитория от GitHub к GitLab</title><link>https://lib.onl/ru/articles/2021/05/8544b8ce-4586-578f-9633-e8ae43441a25/</link><pubDate>Sat, 08 May 2021 21:06:18 +0000</pubDate><dc:creator>Kai Kimera</dc:creator><category>Разработка</category><category>Скрипты</category><turbo:extendedHtml>true</turbo:extendedHtml><turbo:source>https://lib.onl/ru/articles/2021/05/8544b8ce-4586-578f-9633-e8ae43441a25/</turbo:source><turbo:topic>Синхронизация репозитория от GitHub к GitLab</turbo:topic><turbo:content><![CDATA[<p>Понадобилось мне на днях синхронизировать некоторые свои репозитории между <span class="shortcode shortcode-tag"><a href="/ru/tags/github/" target="_blank">#GitHub</a></span> и <span class="shortcode shortcode-tag"><a href="/ru/tags/gitlab/" target="_blank">#GitLab</a></span>. Сам <span class="shortcode shortcode-tag"><a href="/ru/tags/gitlab/" target="_blank">#GitLab</a></span> имеет встроенные средства зеркалирования репозиториев от себя к другому git-хранилищу. <span class="shortcode shortcode-tag"><a href="/ru/tags/github/" target="_blank">#GitHub</a></span> же не обладает такой функцией. Но эту функцию можно воссоздать при помощи <span class="shortcode shortcode-tag"><a href="/ru/tags/github/" target="_blank">#GitHub</a></span> <span class="shortcode shortcode-tag"><a href="/ru/tags/actions/" target="_blank">#Actions</a></span>.</p>
<p>Для начала необходимо создать &ldquo;секреты&rdquo; с такими переменными:</p>
<ul>
<li><code>GITLAB_SYNC_REPO_URL</code> - ссылка на пустой репозиторий <span class="shortcode shortcode-tag"><a href="/ru/tags/gitlab/" target="_blank">#GitLab</a></span>.</li>
<li><code>GITLAB_SYNC_USER_NAME</code> - имя пользователя <span class="shortcode shortcode-tag"><a href="/ru/tags/gitlab/" target="_blank">#GitLab</a></span>.</li>
<li><code>GITLAB_SYNC_USER_TOKEN</code> - токен пользователя <span class="shortcode shortcode-tag"><a href="/ru/tags/gitlab/" target="_blank">#GitLab</a></span>. Токен создаётся в настройках аккаунта <span class="shortcode shortcode-tag"><a href="/ru/tags/gitlab/" target="_blank">#GitLab</a></span>.</li>
</ul>
<p>Далее, в корне репозитория нужно создать файл <code>.github/workflows/gitlab-sync.yml</code> со следующим содержанием:</p>

    

    
        
            
            <div class="shortcode shortcode-file mb-3">
              <div class="card overflow-hidden">
                <div class="card-header">
                  <div class="d-flex align-items-center">
                    <div class="flex-shrink-0">
                      <i class="far fa-file-code fa-fw"></i>
                    </div>
                    <div class="flex-grow-1 mx-2 text-truncate">
                      <code>gitlab-sync.yml</code>
                    </div>
                    <div class="flex-shrink-0">
                      <ul class="list-inline mb-0">
                        <li class="list-inline-item" data-bs-tooltip data-bs-title='Копировать'>
                          <a class="text-body" href="#"
                             data-fn="clipboard preventDefault" data-clipboard-target="#cp-ef30aa726a7190f48354ed637a6b88d0"
                             role="button" aria-label='Копировать'>
                            <i class="fas fa-copy fa-fw"></i>
                          </a>
                        </li>
                        <li class="list-inline-item" data-bs-tooltip data-bs-title='Скачать'>
                          <a class="text-body" href="/ru/articles/2021/05/8544b8ce-4586-578f-9633-e8ae43441a25/gitlab-sync.yml" download
                             role="button" aria-label='Скачать'>
                            <i class="fas fa-download fa-fw"></i>
                          </a>
                        </li>
                        <li class="list-inline-item" data-bs-tooltip data-bs-title='Открыть'>
                          <a class="text-body" href="/ru/articles/2021/05/8544b8ce-4586-578f-9633-e8ae43441a25/gitlab-sync.yml" target="_blank"
                             role="button" aria-label='Открыть'>
                            <i class="fas fa-arrow-up-right-from-square fa-fw"></i>
                          </a>
                        </li>
                      </ul>
                    </div>
                  </div>
                </div>
                <div class="card-body" id="cp-ef30aa726a7190f48354ed637a6b88d0">
                    
                        
                    
                  <pre><code class="language-yml">name: GitLab Sync

on:
  - push
  - delete

jobs:
  sync:
    runs-on: ubuntu-latest
    name: Git Repo Sync
    steps:
      - uses: actions/checkout@v2
        with:
          fetch-depth: 0
      - uses: wangchucheng/git-repo-sync@v0.1.0
        with:
          # Such as https://github.com/wangchucheng/git-repo-sync.git
          target-url: ${{ secrets.GITLAB_SYNC_REPO_URL }}
          # Such as wangchucheng
          target-username: ${{ secrets.GITLAB_SYNC_USER_NAME }}
          # You can store token in your project&#39;s &#39;Setting &gt; Secrets&#39; and reference the name here. Such as ${{ secrets.ACCESS_TOKEN }}
          target-token: ${{ secrets.GITLAB_SYNC_USER_TOKEN }}</code></pre>
                </div>
              </div>
            </div>
        
    
<p>На этом всё. Теперь при коммите в репозиторий, <span class="shortcode shortcode-tag"><a href="/ru/tags/github/" target="_blank">#GitHub</a></span> будет запускать Action и автоматически синхронизировать изменения с репозиторием на <span class="shortcode shortcode-tag"><a href="/ru/tags/gitlab/" target="_blank">#GitLab</a></span>.</p>]]></turbo:content></item><item turbo="true"><title>Monero Unit</title><link>https://lib.onl/ru/articles/2021/03/0a815547-4f18-52a0-9a99-c463421872ca/</link><pubDate>Fri, 05 Mar 2021 11:03:20 +0000</pubDate><dc:creator>Kai Kimera</dc:creator><category>Криптография</category><turbo:extendedHtml>true</turbo:extendedHtml><turbo:source>https://lib.onl/ru/articles/2021/03/0a815547-4f18-52a0-9a99-c463421872ca/</turbo:source><turbo:topic>Monero Unit</turbo:topic><turbo:content><![CDATA[<p>Бум майнинга. Скупают видеокарты, ноутбуки. Будут майнить на тостерах и стиральных машинах. Решил попробовать <span class="shortcode shortcode-tag"><a href="/ru/tags/monero/" target="_blank">#Monero</a></span>. Задача была запустить майнер в фоне, желательно в отдельной сессии. И чтобы запускался он каждый раз при старте машины.</p>
<p>Написал небольшой <a title="" href="https://github.com/KaiKimera/xmrig-systemd" target="_blank" rel="noopener noreferrer">systemd unit</a> для майнера <a title="" href="https://github.com/search?q=xmrig" target="_blank" rel="noopener noreferrer">xmrig</a>. Запускается от имени <code>root</code> в отдельной сессии <span class="shortcode shortcode-tag">screen</span>, но можно запускать от любого пользователя: в командах запуска и остановки необходимо вместо <code>root</code> прописывать имя другого пользователя.</p>
<h2 id="установка">
  <a class="link-body-emphasis" href="#%d1%83%d1%81%d1%82%d0%b0%d0%bd%d0%be%d0%b2%d0%ba%d0%b0">Установка</a>
</h2><ol>
<li>Установить <code>screen</code>.</li>
<li>Поместить в директорию <code>/etc/systemd/system</code> файл <code>xmrig@.service</code>.</li>
<li>В файле <code>xmrig@.service</code> задать в параметре <code>ExecStart</code> путь до <code>xmrig.run.sh</code>.</li>
</ol>
<h2 id="использование">
  <a class="link-body-emphasis" href="#%d0%b8%d1%81%d0%bf%d0%be%d0%bb%d1%8c%d0%b7%d0%be%d0%b2%d0%b0%d0%bd%d0%b8%d0%b5">Использование</a>
</h2><ul>
<li>Запуск:</li>
</ul>



<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-2 shortcode-codeblock-bash">
  <div class="d-flex overflow-hidden">
    <div class="flex-grow-1 rounded overflow-hidden" id="cp-0a65308420fb548f182830f27141b71f">
      
      <pre><code class='language-bash'>systemctl enable --now xmrig@root</code></pre>
    </div>
    <div class="flex-shrink-0">
      <ul class="list-inline mb-0">
        <li class="list-inline-item" data-bs-tooltip data-bs-title='Копировать'>
          <a class="text-body" href="#"
             data-fn="clipboard preventDefault" data-clipboard-target="#cp-0a65308420fb548f182830f27141b71f"
             role="button" aria-label='Копировать'>
            <i class="fas fa-copy fa-fw"></i>
          </a>
        </li>
      </ul>
    </div>
  </div>
</div>

<ul>
<li>Остановка:</li>
</ul>



<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-3 shortcode-codeblock-bash">
  <div class="d-flex overflow-hidden">
    <div class="flex-grow-1 rounded overflow-hidden" id="cp-023442b27368bf285554f76db4eda54c">
      
      <pre><code class='language-bash'>systemctl disable --now xmrig@root</code></pre>
    </div>
    <div class="flex-shrink-0">
      <ul class="list-inline mb-0">
        <li class="list-inline-item" data-bs-tooltip data-bs-title='Копировать'>
          <a class="text-body" href="#"
             data-fn="clipboard preventDefault" data-clipboard-target="#cp-023442b27368bf285554f76db4eda54c"
             role="button" aria-label='Копировать'>
            <i class="fas fa-copy fa-fw"></i>
          </a>
        </li>
      </ul>
    </div>
  </div>
</div>]]></turbo:content></item><item turbo="true"><title>Генератор идентификаторов расширений</title><link>https://lib.onl/ru/articles/2020/08/5d35edd8-f0e3-5b39-afd3-2ac3b15b8c4f/</link><pubDate>Sun, 02 Aug 2020 21:01:49 +0000</pubDate><dc:creator>Kai Kimera</dc:creator><category>CMF</category><turbo:extendedHtml>true</turbo:extendedHtml><turbo:source>https://lib.onl/ru/articles/2020/08/5d35edd8-f0e3-5b39-afd3-2ac3b15b8c4f/</turbo:source><turbo:topic>Генератор идентификаторов расширений</turbo:topic><turbo:content><![CDATA[<p>В свободное от работы время я балуюсь разработкой небольших модулей и расширений для различных <span class="shortcode shortcode-tag"><a href="/ru/tags/cmf/" target="_blank">#CMF</a></span>, и некоторые <span class="shortcode shortcode-tag"><a href="/ru/tags/cmf/" target="_blank">#CMF</a></span> требуют использовать идентификаторы в расширениях.</p>
<p>Я стараюсь как то &ldquo;обезличить&rdquo; и унифицировать идентификаторы. Поэтому, для генерации идентификаторов использую очень простой <span class="shortcode shortcode-tag"><a href="/ru/tags/bash/" target="_blank">#bash</a></span>-скрипт. В идентификатор кодируется текущее время в формате <span class="shortcode shortcode-tag">UNIX</span> с наносекундами.</p>
<p>Пример кодирования:</p>



<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-4 shortcode-codeblock-bash">
  <div class="d-flex overflow-hidden">
    <div class="flex-grow-1 rounded overflow-hidden" id="cp-405dddc370c9fe583257b3d53089a225">
      
      <pre><code class='language-bash'>echo &#34;ext_$(date &#43;%s%N | sha512sum | fold -w 8 | head -n 1)&#34;</code></pre>
    </div>
    <div class="flex-shrink-0">
      <ul class="list-inline mb-0">
        <li class="list-inline-item" data-bs-tooltip data-bs-title='Копировать'>
          <a class="text-body" href="#"
             data-fn="clipboard preventDefault" data-clipboard-target="#cp-405dddc370c9fe583257b3d53089a225"
             role="button" aria-label='Копировать'>
            <i class="fas fa-copy fa-fw"></i>
          </a>
        </li>
      </ul>
    </div>
  </div>
</div>

<p>Вывод: <code>ext_96824896</code></p>
<p>Если необходимо, можно конвертировать в верхний регистр:</p>



<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-5 shortcode-codeblock-bash">
  <div class="d-flex overflow-hidden">
    <div class="flex-grow-1 rounded overflow-hidden" id="cp-70885ab192476d3889d813e4b1dc887a">
      
      <pre><code class='language-bash'>echo &#34;EXT_$(date &#43;%s%N | sha512sum | fold -w 8 | head -n 1 | tr &#39;[:lower:]&#39; &#39;[:upper:]&#39;)&#34;</code></pre>
    </div>
    <div class="flex-shrink-0">
      <ul class="list-inline mb-0">
        <li class="list-inline-item" data-bs-tooltip data-bs-title='Копировать'>
          <a class="text-body" href="#"
             data-fn="clipboard preventDefault" data-clipboard-target="#cp-70885ab192476d3889d813e4b1dc887a"
             role="button" aria-label='Копировать'>
            <i class="fas fa-copy fa-fw"></i>
          </a>
        </li>
      </ul>
    </div>
  </div>
</div>

<p>Вывод: <code>EXT_950E60E1</code></p>]]></turbo:content></item><item turbo="true"><title>Конструирование собственной системы ВКС</title><link>https://lib.onl/ru/articles/2020/08/1cc2e43f-187b-55a1-97ed-a772bbdcf78a/</link><pubDate>Sat, 01 Aug 2020 22:44:46 +0000</pubDate><dc:creator>Kai Kimera</dc:creator><category>DIY</category><turbo:extendedHtml>true</turbo:extendedHtml><turbo:source>https://lib.onl/ru/articles/2020/08/1cc2e43f-187b-55a1-97ed-a772bbdcf78a/</turbo:source><turbo:topic>Конструирование собственной системы ВКС</turbo:topic><turbo:content><![CDATA[<p>Крупные компании покупают дорогие наборы техники для создания систем <span class="shortcode shortcode-tag"><a href="/ru/tags/%D0%B2%D0%BA%D1%81/" target="_blank">#ВКС</a></span> (видео-конференц-связь), но для небольших организаций можно собрать такую систему &ldquo;на коленке&rdquo;.</p>
<h2 id="оборудование">
  <a class="link-body-emphasis" href="#%d0%be%d0%b1%d0%be%d1%80%d1%83%d0%b4%d0%be%d0%b2%d0%b0%d0%bd%d0%b8%d0%b5">Оборудование</a>
</h2><p>Для конструирования понадобятся следующие компоненты:</p>
<ul>
<li>Веб-камера высокого разрешения.</li>
<li>Два и более микрофона (зависит от размера комнаты для переговоров) с <strong>круговой диаграммой направленности</strong>.</li>
<li>Стационарный компьютер или ноутбук, который будет использоваться как <strong>передатчик</strong> потока.</li>
<li>Программа создания виртуальных аудио-кабелей <a title="" href="https://vac.muzychenko.net/" target="_blank" rel="noopener noreferrer">VAC</a>.</li>
</ul>
<p>На момент публикации статьи я выбрал следующие компоненты, доступные на рынке:</p>
<ul>
<li>Веб-камера <a title="" href="https://market.yandex.ru/search?text=Logitech%20WebCam%20C615" target="_blank" rel="noopener noreferrer">Logitech WebCam C615</a>.</li>
<li>Два настольных микрофона <a title="" href="https://market.yandex.ru/search?text=maono%20au-bm10" target="_blank" rel="noopener noreferrer">Maono AU-BM10</a>.</li>
</ul>

    
    
    
    
    

    

    

    

    
    
    

    
    

    <div class="shortcode shortcode-imgur ">
      <figure class="figure">
        <a title="Набор для организации #ВКС-станции." class="d-block" href="https://i.imgur.com/Yhim15t.jpeg"
           rel="noopener nofollow" data-fancybox="gallery" data-caption="Набор для организации #ВКС-станции.">
          <img class="figure-img img-fluid rounded" src="https://i.imgur.com/Yhim15t.jpeg" alt="Yhim15t.jpeg" loading="lazy"/>
        </a>
          
            <figcaption class="figure-caption">Набор для организации <!-- raw HTML omitted --><!-- raw HTML omitted -->#ВКС<!-- raw HTML omitted --><!-- raw HTML omitted -->-станции.</figcaption>
          
      </figure>
    </div>
<p>С выбором остальных компонентов, думаю, проблем возникнуть не должно. Единственное, что могу посоветовать не брать ПК со слишком слабым процессором, потому что виртуальные кабели будут так же забирать часть процессорного времени вместе с остальными программами. И, возможно, понадобится вести записи конференций - это тоже требует процессорного времени.</p>
<p>Надо быть внимательным с количеством доступных разъёмов <span class="shortcode shortcode-tag"><a href="/ru/tags/usb/" target="_blank">#USB</a></span>, потому как выбранные компоненты подключаются при помощи коннекторов <span class="shortcode shortcode-tag"><a href="/ru/tags/usb/" target="_blank">#USB</a></span> и количество портов может банально не хватить. Если видно, что разъёмов не хватает, необходимо докупить активный (желательно) <strong>USB-концентратор</strong>.</p>
<h2 id="подключение-и-настройка">
  <a class="link-body-emphasis" href="#%d0%bf%d0%be%d0%b4%d0%ba%d0%bb%d1%8e%d1%87%d0%b5%d0%bd%d0%b8%d0%b5-%d0%b8-%d0%bd%d0%b0%d1%81%d1%82%d1%80%d0%be%d0%b9%d0%ba%d0%b0">Подключение и настройка</a>
</h2><p>При конференции используется два и более микрофонов. Микрофоны должны быть с круговой диаграммой направленности, то есть они должны улавливать все звуки в помещении, независимо от местоположения источника звука.</p>
<p>Сборка всех компонентов не должна составить труда. Технический персонал любой организации справится с этим без лишних проблем. Нетривиальной задачей является подключение двух независимых микрофонов к ПК, надо заставить работать их синхронно. Как раз в этом поможет проброс виртуальных кабелей <a title="" href="https://vac.muzychenko.net/" target="_blank" rel="noopener noreferrer">VAC</a>.</p>
<p>После установки <span class="shortcode shortcode-tag">VAC</span> необходимо указать двум физическим микрофонам передавать поток на один <em>виртуальный интерфейс</em>. Этот виртуальный интерфейс будет выходной точной для приложений. Делается это так:</p>
<ul>
<li>Пуск &gt; Выполнить <code>mmsys.cpl sounds</code> &gt; вкладка <strong>Запись</strong>.</li>
<li>Открыть физический микрофон, перейти на вкладку <strong>Прослушать</strong>.</li>
<li>Поставить галочку <strong>Прослушать с данного устройства</strong>.</li>
<li>В параметре <strong>Воспроизводить с данного устройства</strong> указать необходимый <em>виртуальный интерфейс</em>.</li>
</ul>
<h2 id="проверка">
  <a class="link-body-emphasis" href="#%d0%bf%d1%80%d0%be%d0%b2%d0%b5%d1%80%d0%ba%d0%b0">Проверка</a>
</h2><p>Проверка правильности настроек производится очень просто. Необходимо, чтобы индикаторы физических микрофонов и виртуального интерфейса на вкладке <strong>Запись</strong> работали синхронно. Таким образом, видно, что физические микрофоны принимают звук и передают на виртуальный интерфейс.</p>
<h2 id="заключение">
  <a class="link-body-emphasis" href="#%d0%b7%d0%b0%d0%ba%d0%bb%d1%8e%d1%87%d0%b5%d0%bd%d0%b8%d0%b5">Заключение</a>
</h2><p>Как видно, больших денежных вложений в организацию системы <span class="shortcode shortcode-tag"><a href="/ru/tags/%D0%B2%D0%BA%D1%81/" target="_blank">#ВКС</a></span> не требуется. Нужны только понимание логики работы аудио / видео потоков и смекалка. <span class="shortcode shortcode-emoji">😄</span></p>]]></turbo:content></item><item turbo="true"><title>Windows 10: Настройка через групповые политики</title><link>https://lib.onl/ru/articles/2020/07/94261403-060b-57b6-9bb0-7a0c07d09af9/</link><pubDate>Tue, 21 Jul 2020 21:15:37 +0000</pubDate><dc:creator>Kai Kimera</dc:creator><category>MS Windows</category><turbo:extendedHtml>true</turbo:extendedHtml><turbo:source>https://lib.onl/ru/articles/2020/07/94261403-060b-57b6-9bb0-7a0c07d09af9/</turbo:source><turbo:topic>Windows 10: Настройка через групповые политики</turbo:topic><turbo:content><![CDATA[<p><span class="shortcode shortcode-tag"><a href="/ru/categories/windows/" target="_blank">#Windows</a></span> 10 до сих пор вызывает противоречивые чувства: иногда её поведение предсказуемо, иногда какое-нибудь обновление ломает систему, удаляя данные пользователя. И чтобы как-то улучшить положение дел и усмирить некоторые функции, я использую групповые политики в настройке операционной системы (ОС).</p>
<p>Сразу скажу, что мне нравится английский текст в интерфейсах. Поэтому все ОС у меня с интерфейсом в английской локализации, но я постараюсь максимально подробно описывать приведённые здесь групповые политики. Я использую <span class="shortcode shortcode-tag"><a href="/ru/categories/windows/" target="_blank">#Windows</a></span> 10 в версии Enterprise, и не стоит забывать, что политики могут отличаться между различными версиями ОС.</p>
<p>Как открыть редактор групповых политик? Очень просто: необходимо нажать сочетание клавиш <span class="shortcode shortcode-key d-inline-block"><kbd>WIN &#43; R</kbd></span>, откроется окно команды &ldquo;Выполнить&rdquo; и в текстовом поле набрать gpedit.msc и нажать <span class="shortcode shortcode-key d-inline-block"><kbd>OK</kbd></span>.</p>
<ul>
<li><span class="shortcode shortcode-emoji">✅</span> - включить (разрешить).</li>
<li><span class="shortcode shortcode-emoji">⛔</span> - отключить (запретить).</li>
</ul>
<h2 id="computer-details">
  <a class="link-body-emphasis" href="#computer-details">Computer Details</a>
</h2><p>Секция отвечает за корректировку групповых политик компьютера в целом.</p>
<h3 id="systemdevice-installation">
  <a class="link-body-emphasis" href="#systemdevice-installation">System/Device Installation</a>
</h3><ul>
<li><span class="shortcode shortcode-emoji">✅</span> <strong>Prevent device metadata retrieval from the Internet</strong><br>
Запретить использование мета-информации для подключённых устройств из Интернета. Политика отвечает за отображение индивидуальных значков принтеров, сканеров и такое прочее. Для отображения подобных значков, Windows лезет в Интернет и загружает мета-данные. Мне подобное не нужно, поэтому я включаю политику (включить = запретить).</li>
<li><span class="shortcode shortcode-emoji">✅</span> <strong>Specify search order for device driver source locations</strong><br>
Специальный порядок источников для поиска драйверов в них. А вот эта политика отвечает за автоматическую установку драйверов на видеокарты, звуковые карты, различную периферию и прочее. Здесь можно указать ОС в каких источниках искать драйвера, приложения и прочее. Меня всегда раздражало, когда Windows при подключении к Интернету устанавливает устаревшие драйвера, например, на видеокарту. Зачем, когда я могу скачать свежие версии с сайта производителя? Включаю политику и выбираю опцию, указанную ниже.
<ul>
<li><em>Do not search Windows Update</em><br>
Не использовать Windows Update для поиска драйверов.</li>
</ul>
</li>
</ul>
<h3 id="windows-componentsautoplay-policies">
  <a class="link-body-emphasis" href="#windows-componentsautoplay-policies">Windows Components/AutoPlay Policies</a>
</h3><ul>
<li><span class="shortcode shortcode-emoji">✅</span> <em>Turn off Autoplay</em><br>
Отключить автоматический запуск. Политика позволяет отключить запуск подходящего приложения при втыкании, например, флешки с музыкой или картинками. Ранее (да и сейчас, наверно) таким способом любили запускаться злые вирусы. Включаю политику и выбираю опцию, указанную ниже.
<ul>
<li>All drives<br>
У меня отключено на всех устройствах.</li>
</ul>
</li>
</ul>
<h3 id="windows-componentscloud-content">
  <a class="link-body-emphasis" href="#windows-componentscloud-content">Windows Components/Cloud Content</a>
</h3><ul>
<li><span class="shortcode shortcode-emoji">✅</span> <strong>Do not show Windows tips</strong><br>
Не показывать подсказки Windows. Лично мне подсказки ОС не нужны. Я как нибудь без них обойдусь. Включаю политику.</li>
<li><span class="shortcode shortcode-emoji">✅</span> <strong>Turn off Microsoft consumer experiences</strong><br>
Выключить Microsoft Consumer Experience. Компания Microsoft своими рекомендациями навязывает установку таких приложений, как Candy Crush Soda Saga, FarmVille 2, Flipboard, Twitter, Photoshop Express, Minecraft и т.д. Мне они не нужны да и мне чуждо такое навязывание. Неприятно. Включаю политику, тем самым отключая подобную рекламу.</li>
</ul>
<h3 id="windows-componentsdata-collection-and-preview-builds">
  <a class="link-body-emphasis" href="#windows-componentsdata-collection-and-preview-builds">Windows Components/Data Collection and Preview Builds</a>
</h3><ul>
<li><span class="shortcode shortcode-emoji">✅</span> <strong>Allow Telemetry</strong><br>
Разрешить телеметрию. Полностью телеметрию отключить всё равно не получится, что бы там не писали в Интернете. Поэтому, я включаю телеметрию и устанавливаю уровень сбора информации.
<ul>
<li><em>0 - Security [Enterprise Only]</em><br>
Ставлю нулевой уровень. Собирать данные, необходимые для осуществления безопасности. Но это только для операционной системы класса Enterprise.</li>
</ul>
</li>
</ul>
<h3 id="windows-componentsdesktop-gadgets">
  <a class="link-body-emphasis" href="#windows-componentsdesktop-gadgets">Windows Components/Desktop Gadgets</a>
</h3><ul>
<li><span class="shortcode shortcode-emoji">✅</span> <strong>Turn off desktop gadgets</strong><br>
Выключить гаджеты рабочего стола. Актуально для Windows Vista / 7. В Windows 10 гаджетов не видел. Может потому что не использовал их никогда. Но политику включаю.</li>
</ul>
<h3 id="windows-componentsmicrosoft-defender-antivirus">
  <a class="link-body-emphasis" href="#windows-componentsmicrosoft-defender-antivirus">Windows Components/Microsoft Defender Antivirus</a>
</h3><ul>
<li><span class="shortcode shortcode-emoji">✅</span> <strong>Turn off Microsoft Defender Antivirus</strong><br>
Отключить Microsoft Defender Antivirus. Я отключаю себе антивирус. Головы хватает, чтобы не подхватить вирусы. Использую только ограниченный проверенный набор программ. При этом, если необходимо запустить что-то экзотическое, у меня всегда развёрнута виртуальная машина в Hyper-V.</li>
</ul>
<h3 id="windows-componentsonedrive">
  <a class="link-body-emphasis" href="#windows-componentsonedrive">Windows Components/OneDrive</a>
</h3><ul>
<li><span class="shortcode shortcode-emoji">✅</span> <strong>Prevent the usage of OneDrive for file storage</strong><br>
Запретить использование OneDrive как файловое хранилище. Мне не нужен OneDrive. Поэтому я запрещаю использование OneDrive в качестве хранилища файлов.</li>
</ul>
<h3 id="windows-componentssearch">
  <a class="link-body-emphasis" href="#windows-componentssearch">Windows Components/Search</a>
</h3><ul>
<li><span class="shortcode shortcode-emoji">⛔</span> <strong>Allow Cloud Search</strong><br>
Разрешить использование облачного поиска. Мне не нужен в ОС поиск, который будет искать по различным сайтам. Только локальный поиск. Поэтому, я запрещаю политику.</li>
<li><span class="shortcode shortcode-emoji">⛔</span> <strong>Allow Cortana</strong><br>
Разрешить Cortana. Cortana мне тоже не нужна. Мне не о чём с ней поговорить. Поэтому, я запрещаю Cortana.</li>
</ul>
<h3 id="windows-componentsstore">
  <a class="link-body-emphasis" href="#windows-componentsstore">Windows Components/Store</a>
</h3><ul>
<li><span class="shortcode shortcode-emoji">✅</span> <strong>Disable all apps from Microsoft Store</strong><br>
Отключить все приложения из Microsoft Store. Для выпиливания приложений, установленных из Microsoft Store в Интернете гуляет скрипт на PowerShell. Но мне лень его использовать, да и мало ли что&hellip; Поэтому, я просто отключаю подобные приложения через групповые политики. Они остаются в меню Start, но не используются.</li>
<li><span class="shortcode shortcode-emoji">✅</span> <strong>Turn off the Store application</strong><br>
Подобно представленной выше политике, эта отключает магазин приложений. Согласно описанию и Интернету, эта политика важнее предыдущей, и включение её отключает не только сам магазин, но и приложения из него.</li>
</ul>
<h3 id="windows-componentssync-your-settings">
  <a class="link-body-emphasis" href="#windows-componentssync-your-settings">Windows Components/Sync your settings</a>
</h3><ul>
<li><span class="shortcode shortcode-emoji">✅</span> <strong>Do not sync</strong><br>
Не синхронизировать настройки пользователя. Синхронизация настроек между устройствами мне не нужна. Я включаю политику, тем самым отключаю синхронизацию.</li>
</ul>
<h3 id="windows-componentswindows-game-recording-and-broadcasting">
  <a class="link-body-emphasis" href="#windows-componentswindows-game-recording-and-broadcasting">Windows Components/Windows Game Recording and Broadcasting</a>
</h3><ul>
<li><span class="shortcode shortcode-emoji">⛔</span> <strong>Enables or disables Windows Game Recording and Broadcasting</strong><br>
Включение или отключение функций Windows Game Recording и Broadcasting. Так как я не играю в игры, для меня подобная функциональность ОС избыточна. Отключаю политику.</li>
</ul>
<h3 id="windows-componentswindows-update">
  <a class="link-body-emphasis" href="#windows-componentswindows-update">Windows Components/Windows Update</a>
</h3><ul>
<li><span class="shortcode shortcode-emoji">✅</span> <strong>Configure Automatic Updates</strong><br>
Конфигурация автоматического обновления. Ох, сколько в Интернете страданий по поводу обновлений Windows 10. При включении этой политике, я указываю опции, которые помогут избавится от ряда проблем с автоматическим обновлением.
<ul>
<li><strong>Configure automatic updating:</strong> <em>2 - Notify for download and auto install</em><br>
Я выбираю опцию #2, которая гласит как &ldquo;Информировать о выпуске новых обновлений&rdquo;.</li>
<li><span class="shortcode shortcode-emoji">✅</span> <em>Install updates for other Microsoft products</em><br>
Также отмечаю галочкой опцию &ldquo;Устанавливать обновления для других продуктов Microsoft&rdquo;. Таким образом, более-менее свежие версии, например, Microsoft Office будут обновляться через Windows Update вместе с ОС.</li>
</ul>
</li>
<li><span class="shortcode shortcode-emoji">✅</span> <strong>Do not include drivers with Windows Updates</strong><br>
Не использовать драйвера в Windows Updates. Вот эта опция странная. Может я её не так понимаю, но при включении, Windows Updates всё равно ставит драйвера на устройства. А мне подобное обслуживание не надо.</li>
<li><span class="shortcode shortcode-emoji">✅</span> <strong>No auto-restart with logged on users for scheduled automatic updates installations</strong><br>
Не использовать автоматическую перезагрузку при вошедшем в систему пользователе, когда обновления установились. Вот эта та самая автоматическая перезагрузка, которая попортила нервишки многим пользователям. Например, когда ты днём много работаешь, а на ночь ставишь компьютер считать различные данные, утром можно обнаружить окно готовности войти в систему. Да, установились обновления и компьютер перезагрузился. Включаем политику, тем самым отключая автоматическую перезагрузку.</li>
</ul>
<h2 id="user-details">
  <a class="link-body-emphasis" href="#user-details">User Details</a>
</h2><p>Секция отвечает за корректировку групповых политик под пользователей.</p>
<h3 id="windows-componentsattachment-manager">
  <a class="link-body-emphasis" href="#windows-componentsattachment-manager">Windows Components/Attachment Manager</a>
</h3><ul>
<li><span class="shortcode shortcode-emoji">✅</span> <strong>Do not preserve zone information in file attachments</strong><br>
Не сохранять информацию о зоне в файлах. Суть этой политики такова, что если я скачаю из Интернета, например, какой-нибудь EXE-файл, то файловая система пометит его как небезопасный. Лично мне в этом нет необходимости. Включаю политику.</li>
</ul>
<h3 id="windows-componentscloud-content-1">
  <a class="link-body-emphasis" href="#windows-componentscloud-content-1">Windows Components/Cloud Content</a>
</h3><ul>
<li><span class="shortcode shortcode-emoji">✅</span> <strong>Turn off all Windows spotlight features</strong><br>
Отключить все возможности Windows Spotlight. Windows Spotlight эта функция ОС, которая позволяет отображать на экране входа в систему различную интерактивную информацию, например, сменяющиеся фоновые изображения, различные предложения (рекламные / не рекламные - не знаю, не видел ни разу). Мне это не надо, поэтому я включаю политику, запрещая использование Windows Spotlight.</li>
</ul>
<p>На этом всё. Возможно, некоторые параметры групповых политик покажутся спорными, а некоторые вообще странными и ненужными, но мне так удобно работать. Список будет дорабатываться, если найду что-нибудь ещё интересное.</p>]]></turbo:content></item><item turbo="true"><title>GnuPG: Создание и работа с ключами шифрования</title><link>https://lib.onl/ru/articles/2020/07/7a204545-daa8-58ce-ba35-75e732e1bcc0/</link><pubDate>Thu, 16 Jul 2020 06:55:17 +0000</pubDate><dc:creator>Kai Kimera</dc:creator><category>Криптография</category><category>Безопасность</category><turbo:extendedHtml>true</turbo:extendedHtml><turbo:source>https://lib.onl/ru/articles/2020/07/7a204545-daa8-58ce-ba35-75e732e1bcc0/</turbo:source><turbo:topic>GnuPG: Создание и работа с ключами шифрования</turbo:topic><turbo:content><![CDATA[<p><span class="shortcode shortcode-tag"><a href="/ru/tags/gnupg/" target="_blank">#GnuPG</a></span> (<span class="shortcode shortcode-tag"><a href="/ru/tags/gpg/" target="_blank">#GPG</a></span>) это программа для шифрования информации и создания электронных цифровых подписей. Она создавалась в качестве свободной альтернативе несвободному <span class="shortcode shortcode-tag">PGP</span>.</p>
<h2 id="создание-ключа">
  <a class="link-body-emphasis" href="#%d1%81%d0%be%d0%b7%d0%b4%d0%b0%d0%bd%d0%b8%d0%b5-%d0%ba%d0%bb%d1%8e%d1%87%d0%b0">Создание ключа</a>
</h2><p><span class="shortcode shortcode-tag"><a href="/ru/tags/gpg/" target="_blank">#GPG</a></span> предоставляет различные алгоритмы шифрования. Я предпочитаю алгоритм <span class="shortcode shortcode-tag">ECC</span>, основанный на эллиптических кривых (Elliptic Curve Cryptography).</p>
<p>Для создания ключей шифрования, нужно чтобы в системе была установлена утилита <span class="shortcode shortcode-tag"><a href="/ru/tags/gpg/" target="_blank">#GPG</a></span>. Для систем <span class="shortcode shortcode-tag"><a href="/ru/tags/debian/" target="_blank">#Debian</a></span> и <span class="shortcode shortcode-tag">CentOS</span> / <span class="shortcode shortcode-tag"><a href="/ru/tags/fedora/" target="_blank">#Fedora</a></span> этим занимается пакет <code>gnupg</code>, устанавливается командами:</p>
<ul>
<li>CentOS 8 / Fedora:</li>
</ul>



<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-9 shortcode-codeblock-bash">
  <div class="d-flex overflow-hidden">
    <div class="flex-grow-1 rounded overflow-hidden" id="cp-22b902d6f78b3e6723eaecc40256eeff">
      
      <pre><code class='language-bash'>dnf install gnupg</code></pre>
    </div>
    <div class="flex-shrink-0">
      <ul class="list-inline mb-0">
        <li class="list-inline-item" data-bs-tooltip data-bs-title='Копировать'>
          <a class="text-body" href="#"
             data-fn="clipboard preventDefault" data-clipboard-target="#cp-22b902d6f78b3e6723eaecc40256eeff"
             role="button" aria-label='Копировать'>
            <i class="fas fa-copy fa-fw"></i>
          </a>
        </li>
      </ul>
    </div>
  </div>
</div>

<ul>
<li>Debian:</li>
</ul>



<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-10 shortcode-codeblock-bash">
  <div class="d-flex overflow-hidden">
    <div class="flex-grow-1 rounded overflow-hidden" id="cp-cdbab94d97d87a8acfb433a4921857bf">
      
      <pre><code class='language-bash'>apt install gnupg</code></pre>
    </div>
    <div class="flex-shrink-0">
      <ul class="list-inline mb-0">
        <li class="list-inline-item" data-bs-tooltip data-bs-title='Копировать'>
          <a class="text-body" href="#"
             data-fn="clipboard preventDefault" data-clipboard-target="#cp-cdbab94d97d87a8acfb433a4921857bf"
             role="button" aria-label='Копировать'>
            <i class="fas fa-copy fa-fw"></i>
          </a>
        </li>
      </ul>
    </div>
  </div>
</div>

<p>После того, как пакет установлен, можно начать создание ключа командой:</p>



<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-11 shortcode-codeblock-bash">
  <div class="d-flex overflow-hidden">
    <div class="flex-grow-1 rounded overflow-hidden" id="cp-d9f1b0e380caf5a403f492f42ec026c0">
      
      <pre><code class='language-bash'>gpg --expert --full-gen-key</code></pre>
    </div>
    <div class="flex-shrink-0">
      <ul class="list-inline mb-0">
        <li class="list-inline-item" data-bs-tooltip data-bs-title='Копировать'>
          <a class="text-body" href="#"
             data-fn="clipboard preventDefault" data-clipboard-target="#cp-d9f1b0e380caf5a403f492f42ec026c0"
             role="button" aria-label='Копировать'>
            <i class="fas fa-copy fa-fw"></i>
          </a>
        </li>
      </ul>
    </div>
  </div>
</div>

<p>Команда вернёт следующий результат:</p>






<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-12 shortcode-codeblock-terminal
shortcode-codeblock-terminal-linux shortcode-codeblock-terminal-linux-user">
  <div class="card overflow-hidden" data-bs-theme="dark">
    <div class="card-header">
      <div class="d-flex align-items-center">
        <div class="flex-shrink-0 ">
          <i class="fas fa-terminal fa-fw"></i>
        </div>
        <div class="flex-grow-1 mx-2">
          <h5 class="mb-0">Терминал</h5>
        </div>
        <div class="flex-shrink-0">
          <ul class="list-inline mb-0">
            <li class="list-inline-item" data-bs-tooltip data-bs-title='Копировать'>
              <a class="text-body" href="#"
                 data-fn="clipboard preventDefault" data-clipboard-target="#cp-9645aa0341d9bd07bd45ab4269ab0abb"
                 role="button" aria-label='Копировать'>
                <i class="fas fa-copy fa-fw"></i>
              </a>
            </li>
          </ul>
        </div>
      </div>
    </div>
    <div class="card-body p-0" id="cp-9645aa0341d9bd07bd45ab4269ab0abb">
      <pre><code class="language-plaintext">gpg --expert --full-gen-key

gpg (GnuPG) 2.2.20; Copyright (C) 2020 Free Software Foundation, Inc.
This is free software: you are free to change and redistribute it.
There is NO WARRANTY, to the extent permitted by law.

Please select what kind of key you want:
   (1) RSA and RSA (default)
   (2) DSA and Elgamal
   (3) DSA (sign only)
   (4) RSA (sign only)
   (7) DSA (set your own capabilities)
   (8) RSA (set your own capabilities)
   (9) ECC and ECC
  (10) ECC (sign only)
  (11) ECC (set your own capabilities)
  (13) Existing key
  (14) Existing key from card
Your selection?</code></pre>
    </div>
  </div>
</div>

<p>Здесь спрашивается, какой конкретно ключ мы хотим получить. Вводим <code>9</code>. Получаем:</p>






<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-13 shortcode-codeblock-terminal
shortcode-codeblock-terminal-linux shortcode-codeblock-terminal-linux-user">
  <div class="card overflow-hidden" data-bs-theme="dark">
    <div class="card-header">
      <div class="d-flex align-items-center">
        <div class="flex-shrink-0 ">
          <i class="fas fa-terminal fa-fw"></i>
        </div>
        <div class="flex-grow-1 mx-2">
          <h5 class="mb-0">Терминал</h5>
        </div>
        <div class="flex-shrink-0">
          <ul class="list-inline mb-0">
            <li class="list-inline-item" data-bs-tooltip data-bs-title='Копировать'>
              <a class="text-body" href="#"
                 data-fn="clipboard preventDefault" data-clipboard-target="#cp-f17c907c3dc3fc966dc5db4befa41839"
                 role="button" aria-label='Копировать'>
                <i class="fas fa-copy fa-fw"></i>
              </a>
            </li>
          </ul>
        </div>
      </div>
    </div>
    <div class="card-body p-0" id="cp-f17c907c3dc3fc966dc5db4befa41839">
      <pre><code class="language-plaintext">gpg --expert --full-gen-key

Please select which elliptic curve you want:
   (1) Curve 25519
   (3) NIST P-256
   (4) NIST P-384
   (5) NIST P-521
   (9) secp256k1
Your selection?</code></pre>
    </div>
  </div>
</div>

<p>А здесь уже предстоит выбрать алгоритм шифрования. Вводим <code>1</code>. Получаем:</p>






<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-14 shortcode-codeblock-terminal
shortcode-codeblock-terminal-linux shortcode-codeblock-terminal-linux-user">
  <div class="card overflow-hidden" data-bs-theme="dark">
    <div class="card-header">
      <div class="d-flex align-items-center">
        <div class="flex-shrink-0 ">
          <i class="fas fa-terminal fa-fw"></i>
        </div>
        <div class="flex-grow-1 mx-2">
          <h5 class="mb-0">Терминал</h5>
        </div>
        <div class="flex-shrink-0">
          <ul class="list-inline mb-0">
            <li class="list-inline-item" data-bs-tooltip data-bs-title='Копировать'>
              <a class="text-body" href="#"
                 data-fn="clipboard preventDefault" data-clipboard-target="#cp-2cd2f4146a24d5451525037ecdfc9937"
                 role="button" aria-label='Копировать'>
                <i class="fas fa-copy fa-fw"></i>
              </a>
            </li>
          </ul>
        </div>
      </div>
    </div>
    <div class="card-body p-0" id="cp-2cd2f4146a24d5451525037ecdfc9937">
      <pre><code class="language-plaintext">gpg --expert --full-gen-key

Please specify how long the key should be valid.
         0 = key does not expire
      &lt;n&gt;  = key expires in n days
      &lt;n&gt;w = key expires in n weeks
      &lt;n&gt;m = key expires in n months
      &lt;n&gt;y = key expires in n years
Key is valid for? (0)</code></pre>
    </div>
  </div>
</div>

<p>На последнем шаге настройки ключа спрашивается время действия ключа. Обычно, личные ключи генерируются с безлимитным временем действия. Вводим <code>0</code> (этот пункт идёт по умолчанию).</p>
<p>Дальше будет пара-тройка вопросов по поводу имени владельца ключа, его адреса email и с просьбой указать комментарий. Таким образом, создаётся пара ключей: закрытый и открытый. Открытый ключ можно публиковать на различных ресурсах с целью идентификации владельца и подтверждения его личности. Например, так работает верификация коммитов на <span class="shortcode shortcode-tag"><a href="/ru/tags/gitlab/" target="_blank">#GitLab</a></span>&rsquo;е и <span class="shortcode shortcode-tag"><a href="/ru/tags/github/" target="_blank">#GitHub</a></span>&rsquo;е. Закрытый ключ должен всегда оставаться внутри системы.</p>
<h2 id="список-ключей-в-системе">
  <a class="link-body-emphasis" href="#%d1%81%d0%bf%d0%b8%d1%81%d0%be%d0%ba-%d0%ba%d0%bb%d1%8e%d1%87%d0%b5%d0%b9-%d0%b2-%d1%81%d0%b8%d1%81%d1%82%d0%b5%d0%bc%d0%b5">Список ключей в системе</a>
</h2><p>Посмотреть установленные в системе ключи можно командой:</p>



<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-17 shortcode-codeblock-bash">
  <div class="d-flex overflow-hidden">
    <div class="flex-grow-1 rounded overflow-hidden" id="cp-d75e5950481be436bc9ca90b51e39437">
      
      <pre><code class='language-bash'>gpg --list-keys --keyid-format LONG --with-fingerprint</code></pre>
    </div>
    <div class="flex-shrink-0">
      <ul class="list-inline mb-0">
        <li class="list-inline-item" data-bs-tooltip data-bs-title='Копировать'>
          <a class="text-body" href="#"
             data-fn="clipboard preventDefault" data-clipboard-target="#cp-d75e5950481be436bc9ca90b51e39437"
             role="button" aria-label='Копировать'>
            <i class="fas fa-copy fa-fw"></i>
          </a>
        </li>
      </ul>
    </div>
  </div>
</div>

<p>Где:</p>
<ul>
<li><code>--list-keys</code> - показать список ключей.</li>
<li><code>--keyid-format LONG</code> - формат отображения каждого ключа в расширенном (<code>LONG</code>) формате.</li>
<li><code>--with-fingerprint</code> - вывести отпечаток. Для себя всегда добавляю эту опцию на всякий случай.</li>
</ul>
<p>Команда вернёт следующий результат:</p>






<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-18 shortcode-codeblock-terminal
shortcode-codeblock-terminal-linux shortcode-codeblock-terminal-linux-user">
  <div class="card overflow-hidden" data-bs-theme="dark">
    <div class="card-header">
      <div class="d-flex align-items-center">
        <div class="flex-shrink-0 ">
          <i class="fas fa-terminal fa-fw"></i>
        </div>
        <div class="flex-grow-1 mx-2">
          <h5 class="mb-0">Терминал</h5>
        </div>
        <div class="flex-shrink-0">
          <ul class="list-inline mb-0">
            <li class="list-inline-item" data-bs-tooltip data-bs-title='Копировать'>
              <a class="text-body" href="#"
                 data-fn="clipboard preventDefault" data-clipboard-target="#cp-cbe6912fcd471d38537407985aa40547"
                 role="button" aria-label='Копировать'>
                <i class="fas fa-copy fa-fw"></i>
              </a>
            </li>
          </ul>
        </div>
      </div>
    </div>
    <div class="card-body p-0" id="cp-cbe6912fcd471d38537407985aa40547">
      <pre><code class="language-plaintext">gpg --list-keys --keyid-format LONG --with-fingerprint

pub   ed25519/JTM4BAVLPI8F0XHR 2020-02-17 [SC]
      Key fingerprint = XXXX XXXX XXXX XXXX XXXX  XXXX XXXX XXXX XXXX XXXX
uid                 [ultimate] John Doe &lt;john.doe@example.com&gt;
sub   cv25519/AI9NEDUOWRF016Y2 2020-02-17 [E]</code></pre>
    </div>
  </div>
</div>

<p>Где:</p>
<ul>
<li><code>JTM4BAVLPI8F0XHR</code> - идентификатор ключа. Он потребуется для каких-либо действий с ключом (редактирование / удаление / и т.п.).</li>
<li><code>[ultimate]</code> - уровень доверия к ключу.</li>
<li><code>John Doe</code> - имя хозяина ключа.</li>
<li><code>&lt;john.doe@example.com&gt;</code> - почта хозяина ключа.</li>
<li><code>ed25519</code> &amp; <code>cv25519</code> - алгоритмы шифрования.</li>
</ul>
<h2 id="экспорт-ключа">
  <a class="link-body-emphasis" href="#%d1%8d%d0%ba%d1%81%d0%bf%d0%be%d1%80%d1%82-%d0%ba%d0%bb%d1%8e%d1%87%d0%b0">Экспорт ключа</a>
</h2><p>При создании открытого и закрытого ключей, необходимо экспортировать их для того, чтобы они хранились где-то независимо от системы, например, на какой-нибудь карте памяти или <span class="shortcode shortcode-tag"><a href="/ru/tags/usb/" target="_blank">#USB</a></span>-флешке. Следующие две команды выполняют необходимые действия.</p>
<ol>
<li>Экспорт публичного ключа:</li>
</ol>



<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-20 shortcode-codeblock-bash">
  <div class="d-flex overflow-hidden">
    <div class="flex-grow-1 rounded overflow-hidden" id="cp-4a7b9dfad328a93eb9e134ca1fbece70">
      
      <pre><code class='language-bash'>gpg --armor --output &#39;JohnDoe.public.asc&#39; --export &#39;JTM4BAVLPI8F0XHR&#39;</code></pre>
    </div>
    <div class="flex-shrink-0">
      <ul class="list-inline mb-0">
        <li class="list-inline-item" data-bs-tooltip data-bs-title='Копировать'>
          <a class="text-body" href="#"
             data-fn="clipboard preventDefault" data-clipboard-target="#cp-4a7b9dfad328a93eb9e134ca1fbece70"
             role="button" aria-label='Копировать'>
            <i class="fas fa-copy fa-fw"></i>
          </a>
        </li>
      </ul>
    </div>
  </div>
</div>

<ol start="2">
<li>Экспорт приватного ключа:</li>
</ol>



<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-21 shortcode-codeblock-bash">
  <div class="d-flex overflow-hidden">
    <div class="flex-grow-1 rounded overflow-hidden" id="cp-63ac7d02e1f536e18b54fdb58daf4832">
      
      <pre><code class='language-bash'>gpg --armor --output &#39;JohnDoe.private.asc&#39; --export-secret-keys &#39;JTM4BAVLPI8F0XHR&#39;</code></pre>
    </div>
    <div class="flex-shrink-0">
      <ul class="list-inline mb-0">
        <li class="list-inline-item" data-bs-tooltip data-bs-title='Копировать'>
          <a class="text-body" href="#"
             data-fn="clipboard preventDefault" data-clipboard-target="#cp-63ac7d02e1f536e18b54fdb58daf4832"
             role="button" aria-label='Копировать'>
            <i class="fas fa-copy fa-fw"></i>
          </a>
        </li>
      </ul>
    </div>
  </div>
</div>

<p>Где:</p>
<ul>
<li><code>--armor</code> - экспорт ключа в формате <strong>ASCII</strong> (текстовый формат).</li>
<li><code>--output</code> - имя файлы, в который будет экспортирован ключ.</li>
<li><code>--export 'JTM4BAVLPI8F0XHR'</code> - экспорт открытого ключа с идентификатором <code>JTM4BAVLPI8F0XHR</code>.</li>
<li><code>--export-secret-keys 'JTM4BAVLPI8F0XHR'</code> - экспорт закрытого ключа с идентификатором <code>JTM4BAVLPI8F0XHR</code>.</li>
</ul>
<h2 id="импорт-ключа">
  <a class="link-body-emphasis" href="#%d0%b8%d0%bc%d0%bf%d0%be%d1%80%d1%82-%d0%ba%d0%bb%d1%8e%d1%87%d0%b0">Импорт ключа</a>
</h2><p>С экспортом разобрались. Теперь по поводу импорта&hellip; Импортировать также необходимо открытый и закрытый ключи. Следующие две команды выполняют необходимые действия.</p>
<ol>
<li>Импорт публичного ключа:</li>
</ol>



<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-22 shortcode-codeblock-bash">
  <div class="d-flex overflow-hidden">
    <div class="flex-grow-1 rounded overflow-hidden" id="cp-d5f93d125a096aba92eaaca04a8dca61">
      
      <pre><code class='language-bash'>gpg --import &#39;JohnDoe.public.asc&#39;</code></pre>
    </div>
    <div class="flex-shrink-0">
      <ul class="list-inline mb-0">
        <li class="list-inline-item" data-bs-tooltip data-bs-title='Копировать'>
          <a class="text-body" href="#"
             data-fn="clipboard preventDefault" data-clipboard-target="#cp-d5f93d125a096aba92eaaca04a8dca61"
             role="button" aria-label='Копировать'>
            <i class="fas fa-copy fa-fw"></i>
          </a>
        </li>
      </ul>
    </div>
  </div>
</div>

<ol start="2">
<li>Импорт приватного ключа:</li>
</ol>



<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-23 shortcode-codeblock-bash">
  <div class="d-flex overflow-hidden">
    <div class="flex-grow-1 rounded overflow-hidden" id="cp-4e144f3bda10f852c80205c83368ae77">
      
      <pre><code class='language-bash'>gpg --import &#39;JohnDoe.private.asc&#39;</code></pre>
    </div>
    <div class="flex-shrink-0">
      <ul class="list-inline mb-0">
        <li class="list-inline-item" data-bs-tooltip data-bs-title='Копировать'>
          <a class="text-body" href="#"
             data-fn="clipboard preventDefault" data-clipboard-target="#cp-4e144f3bda10f852c80205c83368ae77"
             role="button" aria-label='Копировать'>
            <i class="fas fa-copy fa-fw"></i>
          </a>
        </li>
      </ul>
    </div>
  </div>
</div>

<p>После импорта ключ приобретает <strong>стандартный уровень доверия</strong>. Для повышения или понижения уровня доверия, ключ необходимо отредактировать.</p>
<h2 id="редактирование-ключа">
  <a class="link-body-emphasis" href="#%d1%80%d0%b5%d0%b4%d0%b0%d0%ba%d1%82%d0%b8%d1%80%d0%be%d0%b2%d0%b0%d0%bd%d0%b8%d0%b5-%d0%ba%d0%bb%d1%8e%d1%87%d0%b0">Редактирование ключа</a>
</h2><p>Следующая команда позволяет отредактировать ключ:</p>



<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-24 shortcode-codeblock-bash">
  <div class="d-flex overflow-hidden">
    <div class="flex-grow-1 rounded overflow-hidden" id="cp-d2d336d61fc6bdad9691481b2b207f87">
      
      <pre><code class='language-bash'>gpg --edit-key &#39;JTM4BAVLPI8F0XHR&#39;</code></pre>
    </div>
    <div class="flex-shrink-0">
      <ul class="list-inline mb-0">
        <li class="list-inline-item" data-bs-tooltip data-bs-title='Копировать'>
          <a class="text-body" href="#"
             data-fn="clipboard preventDefault" data-clipboard-target="#cp-d2d336d61fc6bdad9691481b2b207f87"
             role="button" aria-label='Копировать'>
            <i class="fas fa-copy fa-fw"></i>
          </a>
        </li>
      </ul>
    </div>
  </div>
</div>

<p>Где:</p>
<ul>
<li><code>--edit-key 'JTM4BAVLPI8F0XHR'</code> - редактирование ключа с идентификатором <code>JTM4BAVLPI8F0XHR</code>.</li>
</ul>
<p>Режим редактирования ключа представляет собой текстовый интерфейс, в который вручную вбиваются команды. Например, повысим уровень доверия к ключу до максимального (ultimate).</p>
<ol>
<li>Вводим <code>trust</code>.</li>
<li>Выбираем <code>5 (I trust ultimately)</code>.</li>
<li>Вводим <code>quit</code> (выход).</li>
</ol>
<h2 id="удаление-ключа">
  <a class="link-body-emphasis" href="#%d1%83%d0%b4%d0%b0%d0%bb%d0%b5%d0%bd%d0%b8%d0%b5-%d0%ba%d0%bb%d1%8e%d1%87%d0%b0">Удаление ключа</a>
</h2><p>Если какой-либо ключ стал нам не нужен, его можно удалить следующими командами.</p>
<ol>
<li>Удаление приватного ключа:</li>
</ol>



<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-25 shortcode-codeblock-bash">
  <div class="d-flex overflow-hidden">
    <div class="flex-grow-1 rounded overflow-hidden" id="cp-f03e14bad9501be19a4cd75dc09fb9bb">
      
      <pre><code class='language-bash'>gpg --delete-secret-key &#39;JTM4BAVLPI8F0XHR&#39;</code></pre>
    </div>
    <div class="flex-shrink-0">
      <ul class="list-inline mb-0">
        <li class="list-inline-item" data-bs-tooltip data-bs-title='Копировать'>
          <a class="text-body" href="#"
             data-fn="clipboard preventDefault" data-clipboard-target="#cp-f03e14bad9501be19a4cd75dc09fb9bb"
             role="button" aria-label='Копировать'>
            <i class="fas fa-copy fa-fw"></i>
          </a>
        </li>
      </ul>
    </div>
  </div>
</div>

<p>Где:</p>
<ul>
<li><code>--delete-secret-key 'JTM4BAVLPI8F0XHR'</code> - удаление приватного ключа с идентификатором <code>JTM4BAVLPI8F0XHR</code>.</li>
</ul>
<ol start="2">
<li>Удаление публичного ключа:</li>
</ol>



<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-26 shortcode-codeblock-bash">
  <div class="d-flex overflow-hidden">
    <div class="flex-grow-1 rounded overflow-hidden" id="cp-1502a783181d32aeb36e0206b830ef47">
      
      <pre><code class='language-bash'>gpg --delete-key &#39;JTM4BAVLPI8F0XHR&#39;</code></pre>
    </div>
    <div class="flex-shrink-0">
      <ul class="list-inline mb-0">
        <li class="list-inline-item" data-bs-tooltip data-bs-title='Копировать'>
          <a class="text-body" href="#"
             data-fn="clipboard preventDefault" data-clipboard-target="#cp-1502a783181d32aeb36e0206b830ef47"
             role="button" aria-label='Копировать'>
            <i class="fas fa-copy fa-fw"></i>
          </a>
        </li>
      </ul>
    </div>
  </div>
</div>

<p>Где:</p>
<ul>
<li><code>--delete-key 'JTM4BAVLPI8F0XHR'</code> - удаление публичного ключа с идентификатором <code>JTM4BAVLPI8F0XHR</code>.</li>
</ul>
<p>Эти две команды можно объединить в одну при помощи параметра <code>--delete-secret-and-public-key</code>:</p>



<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-27 shortcode-codeblock-bash">
  <div class="d-flex overflow-hidden">
    <div class="flex-grow-1 rounded overflow-hidden" id="cp-c62414dc3e15c7c8cf4dc544d7a9718b">
      
      <pre><code class='language-bash'>gpg --delete-secret-and-public-key &#39;JTM4BAVLPI8F0XHR&#39;</code></pre>
    </div>
    <div class="flex-shrink-0">
      <ul class="list-inline mb-0">
        <li class="list-inline-item" data-bs-tooltip data-bs-title='Копировать'>
          <a class="text-body" href="#"
             data-fn="clipboard preventDefault" data-clipboard-target="#cp-c62414dc3e15c7c8cf4dc544d7a9718b"
             role="button" aria-label='Копировать'>
            <i class="fas fa-copy fa-fw"></i>
          </a>
        </li>
      </ul>
    </div>
  </div>
</div>

<p>Где:</p>
<ul>
<li><code>--delete-secret-and-public-key 'JTM4BAVLPI8F0XHR'</code> - удаление приватного и публичного ключа с идентификатором <code>JTM4BAVLPI8F0XHR</code>.</li>
</ul>
<h2 id="скрипт-автоматической-генерации-ключей">
  <a class="link-body-emphasis" href="#%d1%81%d0%ba%d1%80%d0%b8%d0%bf%d1%82-%d0%b0%d0%b2%d1%82%d0%be%d0%bc%d0%b0%d1%82%d0%b8%d1%87%d0%b5%d1%81%d0%ba%d0%be%d0%b9-%d0%b3%d0%b5%d0%bd%d0%b5%d1%80%d0%b0%d1%86%d0%b8%d0%b8-%d0%ba%d0%bb%d1%8e%d1%87%d0%b5%d0%b9">Скрипт автоматической генерации ключей</a>
</h2><p>Собрал &ldquo;на коленке&rdquo; небольшой скрипт, позволяющий генерировать ключи без вступительных вопросов. Скрипт генерирует ключи и экспортирует их в свою директорию.</p>

    

    
        
            
            <div class="shortcode shortcode-file mb-3">
              <div class="card overflow-hidden">
                <div class="card-header">
                  <div class="d-flex align-items-center">
                    <div class="flex-shrink-0">
                      <i class="far fa-file-code fa-fw"></i>
                    </div>
                    <div class="flex-grow-1 mx-2 text-truncate">
                      <code>bash.gpg.gen.sh</code>
                    </div>
                    <div class="flex-shrink-0">
                      <ul class="list-inline mb-0">
                        <li class="list-inline-item" data-bs-tooltip data-bs-title='Копировать'>
                          <a class="text-body" href="#"
                             data-fn="clipboard preventDefault" data-clipboard-target="#cp-deb60635a76bd67ed5a267ba374b5342"
                             role="button" aria-label='Копировать'>
                            <i class="fas fa-copy fa-fw"></i>
                          </a>
                        </li>
                        <li class="list-inline-item" data-bs-tooltip data-bs-title='Скачать'>
                          <a class="text-body" href="/ru/articles/2020/07/7a204545-daa8-58ce-ba35-75e732e1bcc0/bash.gpg.gen.sh" download
                             role="button" aria-label='Скачать'>
                            <i class="fas fa-download fa-fw"></i>
                          </a>
                        </li>
                        <li class="list-inline-item" data-bs-tooltip data-bs-title='Открыть'>
                          <a class="text-body" href="/ru/articles/2020/07/7a204545-daa8-58ce-ba35-75e732e1bcc0/bash.gpg.gen.sh" target="_blank"
                             role="button" aria-label='Открыть'>
                            <i class="fas fa-arrow-up-right-from-square fa-fw"></i>
                          </a>
                        </li>
                      </ul>
                    </div>
                  </div>
                </div>
                <div class="card-body" id="cp-deb60635a76bd67ed5a267ba374b5342">
                    
                        
                    
                  <pre><code class="language-sh">#!/usr/bin/env -S bash -e
#
# Creating a new GPG key.
#
# @package    Bash
# @author     Kai Kimera &lt;mail@kai.kim&gt;
# @copyright  2023 Library Online
# @license    MIT
# @version    0.1.0
# @link       https://lib.onl/ru/articles/2020/07/7a204545-daa8-58ce-ba35-75e732e1bcc0/
# -------------------------------------------------------------------------------------------------------------------- #

(( EUID == 0 )) &amp;&amp; { echo &gt;&amp;2 &#39;This script should not be run as root!&#39;; exit 1; }

# -------------------------------------------------------------------------------------------------------------------- #
# CREATING AND EXPORT KEY.
# -------------------------------------------------------------------------------------------------------------------- #

key() {
  name=&#34;${1}&#34;
  mail=&#34;${2}&#34;
  pass=&#34;${3}&#34;

  # Creating key.
  gpg --batch --gen-key &lt;&lt;EOF
Key-Type: EDDSA
Key-Curve: ed25519
Subkey-Type: ECDH
Subkey-Curve: cv25519
Name-Real: ${name}
Name-Email: ${mail}
Expire-Date: 0
Passphrase: ${pass}
%commit
EOF

  # Export public key.
  gpg --batch --armor \
    --output &#34;${mail}.public.asc&#34; \
    --export &#34;${mail}&#34;

  # Export private key.
  gpg --batch --armor --pinentry-mode=loopback --yes \
    --passphrase &#34;${pass}&#34; \
    --output &#34;${mail}.private.asc&#34; \
    --export-secret-keys &#34;${mail}&#34;
}

# -------------------------------------------------------------------------------------------------------------------- #
# -------------------------------------------------&lt; RUNNING SCRIPT &gt;------------------------------------------------- #
# -------------------------------------------------------------------------------------------------------------------- #

&#34;$@&#34;</code></pre>
                </div>
              </div>
            </div>
        
    
<p>Скрипт ожидает на входе три параметра:</p>
<ol>
<li>Email пользователя.</li>
<li>Имя пользователя.</li>
<li>Пароль шифрования ключа.</li>
</ol>
<p>Эти параметры указываются друг за другом в строгом порядке:</p>






<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-29 shortcode-codeblock-terminal
shortcode-codeblock-terminal-linux shortcode-codeblock-terminal-linux-user">
  <div class="card overflow-hidden" data-bs-theme="dark">
    <div class="card-header">
      <div class="d-flex align-items-center">
        <div class="flex-shrink-0 ">
          <i class="fas fa-terminal fa-fw"></i>
        </div>
        <div class="flex-grow-1 mx-2">
          <h5 class="mb-0">Терминал</h5>
        </div>
        <div class="flex-shrink-0">
          <ul class="list-inline mb-0">
            <li class="list-inline-item" data-bs-tooltip data-bs-title='Копировать'>
              <a class="text-body" href="#"
                 data-fn="clipboard preventDefault" data-clipboard-target="#cp-66a0118ebd8a4de08de034091ac1efcc"
                 role="button" aria-label='Копировать'>
                <i class="fas fa-copy fa-fw"></i>
              </a>
            </li>
          </ul>
        </div>
      </div>
    </div>
    <div class="card-body p-0" id="cp-66a0118ebd8a4de08de034091ac1efcc">
      <pre><code class="language-plaintext">bash bash.gpg.gen.sh key &#39;John Doe&#39; &#39;john.doe@example.com&#39; &#39;&lt;PASSPHRASE&gt;&#39;</code></pre>
    </div>
  </div>
</div>

<p>После отработки скрипта, в директории где он запускался появятся два файла с публичным и приватным ключами.</p>]]></turbo:content></item><item turbo="true"><title>MikroTik и CloudFlare: Динамический IP для домена</title><link>https://lib.onl/ru/articles/2020/07/ff2ae66e-8e14-5c4a-baa6-0cd2e59f6517/</link><pubDate>Sun, 12 Jul 2020 15:09:48 +0000</pubDate><dc:creator>Kai Kimera</dc:creator><category>Сеть</category><category>Скрипты</category><turbo:extendedHtml>true</turbo:extendedHtml><turbo:source>https://lib.onl/ru/articles/2020/07/ff2ae66e-8e14-5c4a-baa6-0cd2e59f6517/</turbo:source><turbo:topic>MikroTik и CloudFlare: Динамический IP для домена</turbo:topic><turbo:content><![CDATA[<p>Нашёл скрипт реализации динамической смены <span class="shortcode shortcode-tag"><a href="/ru/tags/ip/" target="_blank">#IP</a></span> адреса из <span class="shortcode shortcode-tag"><a href="/ru/tags/routeros/" target="_blank">#RouterOS</a></span> напрямую в панели управления <span class="shortcode shortcode-tag"><a href="/ru/tags/cloudflare/" target="_blank">#CloudFlare</a></span> при помощи <span class="shortcode shortcode-tag">API</span>. Где нашёл скрипт уже не помню, вроде бы на страницах официального форума <span class="shortcode shortcode-tag"><a href="/ru/tags/mikrotik/" target="_blank">#MikroTik</a></span>.</p>
<p>Скрипт я немного переделал, удалил лишние переменные, некоторые переопределил, подправил области видимости переменных, обновил метод авторизации скрипта на серверах <span class="shortcode shortcode-tag"><a href="/ru/tags/cloudflare/" target="_blank">#CloudFlare</a></span>. Вроде работает.</p>
<p>Сам скрипт нужно настроить под себя, прописав в нём значения переменных. Некоторые значений можно узнать из панели управления доменом в <span class="shortcode shortcode-tag"><a href="/ru/tags/cloudflare/" target="_blank">#CloudFlare</a></span>, но для получения значения переменной <code>cfDnsID</code> необходимо выполнит немного телодвижений. Об этом ниже.</p>
<h2 id="работа-cloudflare-api">
  <a class="link-body-emphasis" href="#%d1%80%d0%b0%d0%b1%d0%be%d1%82%d0%b0-cloudflare-api">Работа CloudFlare API</a>
</h2><p>Без токена - никак.</p>
<h3 id="создание-токена">
  <a class="link-body-emphasis" href="#%d1%81%d0%be%d0%b7%d0%b4%d0%b0%d0%bd%d0%b8%d0%b5-%d1%82%d0%be%d0%ba%d0%b5%d0%bd%d0%b0">Создание токена</a>
</h3><p>Для того, чтобы начать работать с <span class="shortcode shortcode-tag"><a href="/ru/tags/cloudflare/" target="_blank">#CloudFlare</a></span> <span class="shortcode shortcode-tag">API</span>, нам нужно создать специальный токен:</p>
<ol>
<li>Зайти в <a title="" href="https://dash.cloudflare.com/profile/api-tokens" target="_blank" rel="noopener noreferrer">панель управления токенами</a>.</li>
<li>Нажать кнопку <span class="shortcode shortcode-key d-inline-block"><kbd>Create Token</kbd></span>.</li>
<li>На странице выбора шаблонов - выбрать шаблон <strong>Edit zone DNS</strong>.</li>
<li>В разделе <strong>Zone Resources</strong> можно выбрать область доступа токена к зонам (доменам). Можно указать конкретную зону (<em>Specific zone</em>) или выбрать все зоны (<em>All zones</em>).</li>
<li>Всё, нажимаем кнопку <span class="shortcode shortcode-key d-inline-block"><kbd>Continue to summary</kbd></span> и перемещаемся на следующую станицу&hellip;</li>
</ol>
<h3 id="проверка-токена">
  <a class="link-body-emphasis" href="#%d0%bf%d1%80%d0%be%d0%b2%d0%b5%d1%80%d0%ba%d0%b0-%d1%82%d0%be%d0%ba%d0%b5%d0%bd%d0%b0">Проверка токена</a>
</h3><p>По окончании создания токена, <span class="shortcode shortcode-tag"><a href="/ru/tags/cloudflare/" target="_blank">#CloudFlare</a></span> переместит нас на страницу проверки токена. На этой странице будут наш созданный токен (его необходимо сохранить) и команда, которой при помощи утилиты <code>curl</code> можно проверить корректность токена:</p>



<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-12 shortcode-codeblock-bash">
  <div class="d-flex overflow-hidden">
    <div class="flex-grow-1 rounded overflow-hidden" id="cp-d4de84bbeca63d45204e5b503c242cc0">
      
      <pre><code class='language-bash'>curl -X GET &#34;https://api.cloudflare.com/client/v4/user/tokens/verify&#34; \
-H &#34;Authorization: Bearer TOKEN&#34; \
-H &#34;Content-Type:application/json&#34; | python3 -mjson.tool</code></pre>
    </div>
    <div class="flex-shrink-0">
      <ul class="list-inline mb-0">
        <li class="list-inline-item" data-bs-tooltip data-bs-title='Копировать'>
          <a class="text-body" href="#"
             data-fn="clipboard preventDefault" data-clipboard-target="#cp-d4de84bbeca63d45204e5b503c242cc0"
             role="button" aria-label='Копировать'>
            <i class="fas fa-copy fa-fw"></i>
          </a>
        </li>
      </ul>
    </div>
  </div>
</div>

<p>При выполнении, команда вернёт следующий результат:</p>






<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-13 shortcode-codeblock-terminal
shortcode-codeblock-terminal-linux shortcode-codeblock-terminal-linux-user">
  <div class="card overflow-hidden" data-bs-theme="dark">
    <div class="card-header">
      <div class="d-flex align-items-center">
        <div class="flex-shrink-0 ">
          <i class="fas fa-terminal fa-fw"></i>
        </div>
        <div class="flex-grow-1 mx-2">
          <h5 class="mb-0">Терминал</h5>
        </div>
        <div class="flex-shrink-0">
          <ul class="list-inline mb-0">
            <li class="list-inline-item" data-bs-tooltip data-bs-title='Копировать'>
              <a class="text-body" href="#"
                 data-fn="clipboard preventDefault" data-clipboard-target="#cp-2764cdcdb68a83812f60d7f61da5ec9e"
                 role="button" aria-label='Копировать'>
                <i class="fas fa-copy fa-fw"></i>
              </a>
            </li>
          </ul>
        </div>
      </div>
    </div>
    <div class="card-body p-0" id="cp-2764cdcdb68a83812f60d7f61da5ec9e">
      <pre><code class="language-plaintext">curl -X GET &#34;https://api.cloudflare.com/client/v4/user/tokens/verify&#34; -H &#34;Authorization: Bearer &lt;...&gt;&#34; -H &#34;Content-Type: application/json&#34; | python3 -mjson.tool

{
    &#34;result&#34;: {
        &#34;id&#34;: &#34;&lt;...&gt;&#34;,
        &#34;status&#34;: &#34;active&#34;
    },
    &#34;success&#34;: true,
    &#34;errors&#34;: [],
    &#34;messages&#34;: [
        {
            &#34;code&#34;: 10000,
            &#34;message&#34;: &#34;This API Token is valid and active&#34;,
            &#34;type&#34;: null
        }
    ]
}</code></pre>
    </div>
  </div>
</div>

<p>По сообщению &ldquo;This API Token is valid and active&rdquo; понятно, что токен корректный и работает.</p>
<h3 id="получение-id-ресурсной-записи-домена">
  <a class="link-body-emphasis" href="#%d0%bf%d0%be%d0%bb%d1%83%d1%87%d0%b5%d0%bd%d0%b8%d0%b5-id-%d1%80%d0%b5%d1%81%d1%83%d1%80%d1%81%d0%bd%d0%be%d0%b9-%d0%b7%d0%b0%d0%bf%d0%b8%d1%81%d0%b8-%d0%b4%d0%be%d0%bc%d0%b5%d0%bd%d0%b0">Получение ID ресурсной записи домена</a>
</h3><p>Когда у нас есть токен, можно полноценно работать с <span class="shortcode shortcode-tag"><a href="/ru/tags/cloudflare/" target="_blank">#CloudFlare</a></span> <span class="shortcode shortcode-tag">API</span>. Нам нужно получить ID ресурсной записи домена. Получать будем следующей командой:</p>



<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-16 shortcode-codeblock-bash">
  <div class="d-flex overflow-hidden">
    <div class="flex-grow-1 rounded overflow-hidden" id="cp-4c07e91a75a1279baf4129962c0e4f36">
      
      <pre><code class='language-bash'>curl -X GET &#34;https://api.cloudflare.com/client/v4/zones/ZONE_ID/dns_records&#34; \
-H &#34;Authorization: Bearer TOKEN&#34; \
-H &#34;Content-Type: application/json&#34; | python3 -mjson.tool</code></pre>
    </div>
    <div class="flex-shrink-0">
      <ul class="list-inline mb-0">
        <li class="list-inline-item" data-bs-tooltip data-bs-title='Копировать'>
          <a class="text-body" href="#"
             data-fn="clipboard preventDefault" data-clipboard-target="#cp-4c07e91a75a1279baf4129962c0e4f36"
             role="button" aria-label='Копировать'>
            <i class="fas fa-copy fa-fw"></i>
          </a>
        </li>
      </ul>
    </div>
  </div>
</div>

<p>Обратите внимание на следующие заглушки в команде:</p>
<ul>
<li><code>ZONE_ID</code> - ID домена. Находится в панели оправления доменом на главной странице в поле <strong>Zone ID</strong>.</li>
<li><code>TOKEN</code> - токен для доступа к <span class="shortcode shortcode-tag"><a href="/ru/tags/cloudflare/" target="_blank">#CloudFlare</a></span> <span class="shortcode shortcode-tag">API</span>.</li>
</ul>




    








    
    






<div class="shortcode shortcode-alert">
  <div class="alert alert-warning d-flex overflow-hidden" role="alert">
    <div class="flex-shrink-0 align-self-center">
      <i class="fas fa-exclamation-triangle fa-fw fa-2x"></i>
    </div>
    <div class="flex-grow-1 ms-3 overflow-hidden">
        <p>Вместо этих заглушек необходимо подставить свои значения.</p>

    </div>
  </div>
</div>

<p>Сформировав правильную команду с корректными данными и выполнив её, команда вернёт результат в формате <span class="shortcode shortcode-tag">JSON</span>. Результат будет содержать набор всех ресурсных записей конкретного домена. У меня это выглядит так:</p>






<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-21 shortcode-codeblock-terminal
shortcode-codeblock-terminal-linux shortcode-codeblock-terminal-linux-user">
  <div class="card overflow-hidden" data-bs-theme="dark">
    <div class="card-header">
      <div class="d-flex align-items-center">
        <div class="flex-shrink-0 ">
          <i class="fas fa-terminal fa-fw"></i>
        </div>
        <div class="flex-grow-1 mx-2">
          <h5 class="mb-0">Терминал</h5>
        </div>
        <div class="flex-shrink-0">
          <ul class="list-inline mb-0">
            <li class="list-inline-item" data-bs-tooltip data-bs-title='Копировать'>
              <a class="text-body" href="#"
                 data-fn="clipboard preventDefault" data-clipboard-target="#cp-930e2decc0ab6299480193418194265a"
                 role="button" aria-label='Копировать'>
                <i class="fas fa-copy fa-fw"></i>
              </a>
            </li>
          </ul>
        </div>
      </div>
    </div>
    <div class="card-body p-0" id="cp-930e2decc0ab6299480193418194265a">
      <pre><code class="language-plaintext">curl -X GET &#34;https://api.cloudflare.com/client/v4/zones/&lt;...&gt;/dns_records&#34; -H &#34;Authorization: Bearer &lt;...&gt;&#34; -H &#34;Content-Type: application/json&#34; | python3 -mjson.tool

{
    &#34;result&#34;: [
        {
            &#34;id&#34;: &#34;gJDSG5la4IWNOEVn6K2PHyope8Q9YhzC&#34;,
            &#34;zone_id&#34;: &#34;&lt;...&gt;&#34;,
            &#34;zone_name&#34;: &#34;example.com&#34;,
            &#34;name&#34;: &#34;example.com&#34;,
            &#34;type&#34;: &#34;A&#34;,
            &#34;content&#34;: &#34;192.168.10.232&#34;,
            &#34;proxiable&#34;: true,
            &#34;proxied&#34;: true,
            &#34;ttl&#34;: 1,
            &#34;locked&#34;: false,
            &#34;meta&#34;: {
                &#34;auto_added&#34;: false,
                &#34;managed_by_apps&#34;: false,
                &#34;managed_by_argo_tunnel&#34;: false,
                &#34;source&#34;: &#34;primary&#34;
            },
            &#34;created_on&#34;: &#34;2020-02-23T21:26:27.56227Z&#34;,
            &#34;modified_on&#34;: &#34;2020-02-23T21:26:27.56227Z&#34;
        }
    ],
    &#34;success&#34;: true,
    &#34;errors&#34;: [],
    &#34;messages&#34;: [],
    &#34;result_info&#34;: {
        &#34;page&#34;: 1,
        &#34;per_page&#34;: 20,
        &#34;count&#34;: 7,
        &#34;total_count&#34;: 7,
        &#34;total_pages&#34;: 1
    }
}</code></pre>
    </div>
  </div>
</div>

<p>Как видим, команда вернула нам результат с массивом <code>result</code>. В этом массиве находятся все ресурсные записи нашего домена. Каждая ресурсная запись содержит поля <code>id</code> и <code>content</code>:</p>
<ul>
<li><code>id</code> - ID ресурсной записи. Очень важное поле, как раз его значение необходимо записать в переменную <code>cfDnsID</code> скрипта.</li>
<li><code>content</code> - содержимое ресурсной записи.</li>
</ul>
<p>Нам необходимы только записи с типом <code>A</code>. Обычно в записях с типом <code>A</code> хранятся <span class="shortcode shortcode-tag"><a href="/ru/tags/ip/" target="_blank">#IP</a></span> адреса серверов, к которым привязан домен. У записей с типом <code>A</code> в поле <code>content</code> находится IP адрес, который должен изменить наш <span class="shortcode shortcode-tag"><a href="/ru/tags/mikrotik/" target="_blank">#MikroTik</a></span> при обращении к <span class="shortcode shortcode-tag"><a href="/ru/tags/cloudflare/" target="_blank">#CloudFlare</a></span> <span class="shortcode shortcode-tag">API</span>.</p>
<h2 id="скрипт">
  <a class="link-body-emphasis" href="#%d1%81%d0%ba%d1%80%d0%b8%d0%bf%d1%82">Скрипт</a>
</h2>
    

    
        
            
            <div class="shortcode shortcode-file mb-3">
              <div class="card overflow-hidden">
                <div class="card-header">
                  <div class="d-flex align-items-center">
                    <div class="flex-shrink-0">
                      <i class="far fa-file-code fa-fw"></i>
                    </div>
                    <div class="flex-grow-1 mx-2 text-truncate">
                      <code>cf.ddns.rsc</code>
                    </div>
                    <div class="flex-shrink-0">
                      <ul class="list-inline mb-0">
                        <li class="list-inline-item" data-bs-tooltip data-bs-title='Копировать'>
                          <a class="text-body" href="#"
                             data-fn="clipboard preventDefault" data-clipboard-target="#cp-f91da413e2c7b9d8f5367ce5762e7ade"
                             role="button" aria-label='Копировать'>
                            <i class="fas fa-copy fa-fw"></i>
                          </a>
                        </li>
                        <li class="list-inline-item" data-bs-tooltip data-bs-title='Скачать'>
                          <a class="text-body" href="/ru/articles/2020/07/ff2ae66e-8e14-5c4a-baa6-0cd2e59f6517/cf.ddns.rsc" download
                             role="button" aria-label='Скачать'>
                            <i class="fas fa-download fa-fw"></i>
                          </a>
                        </li>
                        <li class="list-inline-item" data-bs-tooltip data-bs-title='Открыть'>
                          <a class="text-body" href="/ru/articles/2020/07/ff2ae66e-8e14-5c4a-baa6-0cd2e59f6517/cf.ddns.rsc" target="_blank"
                             role="button" aria-label='Открыть'>
                            <i class="fas fa-arrow-up-right-from-square fa-fw"></i>
                          </a>
                        </li>
                      </ul>
                    </div>
                  </div>
                </div>
                <div class="card-body" id="cp-f91da413e2c7b9d8f5367ce5762e7ade">
                    
                        
                    
                  <pre><code class="language-rsc"># Mikrotik RouterOS script for CloudFlare DDNS
#
# @package    RouterOS
# @author     Kai Kimera &lt;mail@kai.kim&gt;
# @copyright  2023 Library Online
# @license    MIT
# @version    0.0.1
# @link       https://lib.onl
# -------------------------------------------------------------------------------------------------------------------- #

# RouterOS: WAN interface name.
:local rosWanInterface &#34;ether1&#34;

# RouterOS: Enables trust chain validation from local certificate store.
# &#39;no&#39;  | Disable certificate check.
# &#39;yes&#39; | Enable certificate check.
:local rosCheckCert &#34;no&#34;

# CloudFlare: API token.
:local cfToken &#34;&#34;

# CloudFlare: Domain.
:local cfDomain &#34;example.com&#34;

# CloudFlare: Zone ID.
:local cfZoneID &#34;&#34;

# CloudFlare: DNS ID.
:local cfDnsID &#34;&#34;

# CloudFlare: Domain record type.
:local cfRecordType &#34;A&#34;

# CloudFlare: Debug mode.
# 0 | Disable debug mode.
# 1 | Enable debug mode.
:local cfDebug 0

# -------------------------------------------------------------------------------------------------------------------- #

# IP on WAN interface.
:local srcIP &#34;&#34;

# IP on CloudFlare domain.
:local dstIP &#34;&#34;

# Get RouterOS WAN IP.
:set srcIP [/ip address get [/ip address find interface=$rosWanInterface ] address]
:set srcIP [:pick $srcIP 0 [:find $srcIP &#34;/&#34;]]

# Get CloudFlare domain IP.
:set dstIP [:resolve $cfDomain]

# Build CloudFlare API (v4).
:local cfAPI &#34;https://api.cloudflare.com/client/v4/zones/&#34;
:set cfAPI ($cfAPI . &#34;$cfZoneID/dns_records/$cfDnsID&#34;)
:local cfAPIHeader &#34;Authorization: Bearer $cfToken, Content-Type: application/json&#34;
:local cfAPIData &#34;{\&#34;type\&#34;:\&#34;$cfRecordType\&#34;,\&#34;name\&#34;:\&#34;$cfDomain\&#34;,\&#34;content\&#34;:\&#34;$srcIP\&#34;}&#34;

# Write debug info to log.
:if ($cfDebug) do={
  :log info (&#34;CloudFlare: Domain = $cfDomain&#34;)
  :log info (&#34;CloudFlare: Domain IP (dstIP) = $dstIP&#34;)
  :log info (&#34;CloudFlare: WAN IP (srcIP) = $srcIP&#34;)
  :log info (&#34;CloudFlare: CloudFlare API (cfAPI) = $cfAPI&amp;content=$srcIP&#34;)
}

# Compare and update CF if necessary.
:if ($dstIP != $srcIP) do={
  :log info (&#34;CloudFlare: Updating $cfDomain, setting $srcIP = $cfDomain&#34;)
  /tool fetch \
    mode=https \
    http-method=put \
    http-header-field=&#34;$cfAPIHeader&#34; \
    http-data=&#34;$cfAPIData&#34; url=&#34;$cfAPI&#34; \
    check-certificate=$rosCheckCert \
    output=user as-value
  /ip dns cache flush
} else={
  # :log info &#34;CloudFlare: No update needed!&#34;
}</code></pre>
                </div>
              </div>
            </div>
        
    
<h3 id="настройка">
  <a class="link-body-emphasis" href="#%d0%bd%d0%b0%d1%81%d1%82%d1%80%d0%be%d0%b9%d0%ba%d0%b0">Настройка</a>
</h3><p>Алгоритм настройки довольно прост:</p>
<ol>
<li>Получаем токен для работы с <span class="shortcode shortcode-tag"><a href="/ru/tags/cloudflare/" target="_blank">#CloudFlare</a></span> <span class="shortcode shortcode-tag">API</span>.</li>
<li>При помощи специальной команды узнаём значение поля <code>id</code> ресурсной записи с типом <code>A</code>.</li>
<li>Это значение вписываем в переменную <code>cfDnsID</code> скрипта.</li>
<li>Остальные требуемые значения для переменных уже доступны без каких-либо телодвижений.</li>
</ol>
<h3 id="переменные">
  <a class="link-body-emphasis" href="#%d0%bf%d0%b5%d1%80%d0%b5%d0%bc%d0%b5%d0%bd%d0%bd%d1%8b%d0%b5">Переменные</a>
</h3><p>Опишу переменные и что они из себя представляют:</p>
<ul>
<li><code>rosWanInterface</code> - имя интерфейса <strong>WAN</strong> в <span class="shortcode shortcode-tag"><a href="/ru/tags/routeros/" target="_blank">#RouterOS</a></span>.</li>
<li><code>rosCheckCert</code> - включение / отключение проверки цепочки сертификации при запросе к <span class="shortcode shortcode-tag"><a href="/ru/tags/cloudflare/" target="_blank">#CloudFlare</a></span> <span class="shortcode shortcode-tag">API</span>. Для корректной работы этой функции необходимо, чтобы в репозитории сертификатов <span class="shortcode shortcode-tag"><a href="/ru/tags/routeros/" target="_blank">#RouterOS</a></span> присутствовали корневые сертификаты центров сертификации. Про импортирование сертификатов написано в заметке <span class="shortcode shortcode-uuid"><a href="/ru/articles/2023/10/cc13623b-970c-5950-867e-168f9ba9025a/">MikroTik: Добавление корневых сертификатов в RouterOS</a></span>.</li>
<li><code>cfToken</code> - токен, полученный в <a title="" href="https://dash.cloudflare.com/profile/api-tokens" target="_blank" rel="noopener noreferrer">панели управления токенами</a>.</li>
<li><code>cfDomain</code> - название домена, для которого необходимо динамически менять <span class="shortcode shortcode-tag"><a href="/ru/tags/ip/" target="_blank">#IP</a></span> адрес.</li>
<li><code>cfZoneID</code> - ID домена. Находится в панели управления доменом на главной странице в поле <strong>Zone ID</strong>.</li>
<li><code>cfDnsID</code> - ID ресурсной записи домена. Для получения значения переменной, необходимо выполнить запрос к <span class="shortcode shortcode-tag"><a href="/ru/tags/cloudflare/" target="_blank">#CloudFlare</a></span> <span class="shortcode shortcode-tag">API</span>.</li>
<li><code>cfRecordType</code> - тип ресурсной записи домена. Обычно это <code>A</code>. Менять нет необходимости.</li>
<li><code>cfDebug</code> - включение / отключение отображения технической информации в логе <span class="shortcode shortcode-tag"><a href="/ru/tags/routeros/" target="_blank">#RouterOS</a></span>.</li>
</ul>
<p>Рекомендую настраивать скрипт в редакторе с подсветкой синтаксиса, чтобы не ошибиться и не задеть какую-либо кавычку.</p>
<h3 id="установка">
  <a class="link-body-emphasis" href="#%d1%83%d1%81%d1%82%d0%b0%d0%bd%d0%be%d0%b2%d0%ba%d0%b0">Установка</a>
</h3><p>После настройки скрипта, его нужно добавить в репозиторий скриптов <span class="shortcode shortcode-tag"><a href="/ru/tags/routeros/" target="_blank">#RouterOS</a></span>. Находится репозиторий в <strong>System / Scripts</strong>. При добавлении скрипта, необходимо выбрать политики <code>read</code>, <code>write</code>, <code>test</code>, <code>policy</code>.</p>
<h3 id="планировщик">
  <a class="link-body-emphasis" href="#%d0%bf%d0%bb%d0%b0%d0%bd%d0%b8%d1%80%d0%be%d0%b2%d1%89%d0%b8%d0%ba">Планировщик</a>
</h3><p>Скрипт должен переодически запускаться для проверки и синхронизации <span class="shortcode shortcode-tag"><a href="/ru/tags/ip/" target="_blank">#IP</a></span> адресов сервера и домена. В этом поможет планировщик <span class="shortcode shortcode-tag"><a href="/ru/tags/routeros/" target="_blank">#RouterOS</a></span>. Заходим в <strong>System / Scheduler</strong> и создаём задачу с политиками <code>read</code>, <code>write</code>, <code>test</code>, <code>policy</code>. В поле <strong>On Event</strong> вписываем точное название скрипта, ранее добавленного в репозиторий <span class="shortcode shortcode-tag"><a href="/ru/tags/routeros/" target="_blank">#RouterOS</a></span>.</p>
<h3 id="проверка">
  <a class="link-body-emphasis" href="#%d0%bf%d1%80%d0%be%d0%b2%d0%b5%d1%80%d0%ba%d0%b0">Проверка</a>
</h3><p>Проверить работу скрипта можно в репозитории по адресу <strong>System / Scripts</strong>. Выделив скрипт и нажав на кнопку <span class="shortcode shortcode-key d-inline-block"><kbd>Run</kbd></span>, смотрим изменился ли <span class="shortcode shortcode-tag"><a href="/ru/tags/ip/" target="_blank">#IP</a></span> адрес у домена в панели управления <span class="shortcode shortcode-tag"><a href="/ru/tags/cloudflare/" target="_blank">#CloudFlare</a></span>.</p>]]></turbo:content></item><item turbo="true"><title>Первичная настройка UAIK</title><link>https://lib.onl/ru/articles/2020/06/59781965-afe7-5dd5-9798-d1c5ba6cdafd/</link><pubDate>Tue, 02 Jun 2020 06:20:27 +0000</pubDate><dc:creator>Kai Kimera</dc:creator><category>Linux</category><turbo:extendedHtml>true</turbo:extendedHtml><turbo:source>https://lib.onl/ru/articles/2020/06/59781965-afe7-5dd5-9798-d1c5ba6cdafd/</turbo:source><turbo:topic>Первичная настройка UAIK</turbo:topic><turbo:content><![CDATA[<p>После автоматической установки (<span class="shortcode shortcode-tag">Kickstart</span>) при помощи <a title="" href="https://uaik.github.io/" target="_blank" rel="noopener noreferrer">UAIK</a>, <span class="shortcode shortcode-tag"><a href="/ru/tags/fedora/" target="_blank">#Fedora</a></span> запустится в текстовом режиме. На этом этапе необходимо произвести первичную настройку операционной системы.</p>
<h2 id="включение-графического-режима">
  <a class="link-body-emphasis" href="#%d0%b2%d0%ba%d0%bb%d1%8e%d1%87%d0%b5%d0%bd%d0%b8%d0%b5-%d0%b3%d1%80%d0%b0%d1%84%d0%b8%d1%87%d0%b5%d1%81%d0%ba%d0%be%d0%b3%d0%be-%d1%80%d0%b5%d0%b6%d0%b8%d0%bc%d0%b0">Включение графического режима</a>
</h2>


<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-2 shortcode-codeblock-text">
  <div class="d-flex overflow-hidden">
    <div class="flex-grow-1 rounded overflow-hidden" id="cp-527deaef5808e67fdd6d873000f5ac81">
      
      <pre><code class='language-text'>systemctl set-default graphical.target</code></pre>
    </div>
    <div class="flex-shrink-0">
      <ul class="list-inline mb-0">
        <li class="list-inline-item" data-bs-tooltip data-bs-title='Копировать'>
          <a class="text-body" href="#"
             data-fn="clipboard preventDefault" data-clipboard-target="#cp-527deaef5808e67fdd6d873000f5ac81"
             role="button" aria-label='Копировать'>
            <i class="fas fa-copy fa-fw"></i>
          </a>
        </li>
      </ul>
    </div>
  </div>
</div>

<h2 id="создание-пользователя">
  <a class="link-body-emphasis" href="#%d1%81%d0%be%d0%b7%d0%b4%d0%b0%d0%bd%d0%b8%d0%b5-%d0%bf%d0%be%d0%bb%d1%8c%d0%b7%d0%be%d0%b2%d0%b0%d1%82%d0%b5%d0%bb%d1%8f">Создание пользователя</a>
</h2><ul>
<li>Добавить пользователя:</li>
</ul>



<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-3 shortcode-codeblock-bash">
  <div class="d-flex overflow-hidden">
    <div class="flex-grow-1 rounded overflow-hidden" id="cp-716aa0940ada6dd4022a3cfadf9ba0c4">
      
      <pre><code class='language-bash'>useradd -mc &#34;User 0001&#34; user-0001</code></pre>
    </div>
    <div class="flex-shrink-0">
      <ul class="list-inline mb-0">
        <li class="list-inline-item" data-bs-tooltip data-bs-title='Копировать'>
          <a class="text-body" href="#"
             data-fn="clipboard preventDefault" data-clipboard-target="#cp-716aa0940ada6dd4022a3cfadf9ba0c4"
             role="button" aria-label='Копировать'>
            <i class="fas fa-copy fa-fw"></i>
          </a>
        </li>
      </ul>
    </div>
  </div>
</div>

<ul>
<li>Установить пароль для пользователя:</li>
</ul>



<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-4 shortcode-codeblock-bash">
  <div class="d-flex overflow-hidden">
    <div class="flex-grow-1 rounded overflow-hidden" id="cp-ad028f1ab41876ebb2646430f0a9c218">
      
      <pre><code class='language-bash'>passwd user-0001</code></pre>
    </div>
    <div class="flex-shrink-0">
      <ul class="list-inline mb-0">
        <li class="list-inline-item" data-bs-tooltip data-bs-title='Копировать'>
          <a class="text-body" href="#"
             data-fn="clipboard preventDefault" data-clipboard-target="#cp-ad028f1ab41876ebb2646430f0a9c218"
             role="button" aria-label='Копировать'>
            <i class="fas fa-copy fa-fw"></i>
          </a>
        </li>
      </ul>
    </div>
  </div>
</div>

<h2 id="отключение-пользователя">
  <a class="link-body-emphasis" href="#%d0%be%d1%82%d0%ba%d0%bb%d1%8e%d1%87%d0%b5%d0%bd%d0%b8%d0%b5-%d0%bf%d0%be%d0%bb%d1%8c%d0%b7%d0%be%d0%b2%d0%b0%d1%82%d0%b5%d0%bb%d1%8f">Отключение пользователя</a>
</h2>


<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-5 shortcode-codeblock-bash">
  <div class="d-flex overflow-hidden">
    <div class="flex-grow-1 rounded overflow-hidden" id="cp-e234566a05666c10e348f0fc5de99000">
      
      <pre><code class='language-bash'>usermod -L user-0000</code></pre>
    </div>
    <div class="flex-shrink-0">
      <ul class="list-inline mb-0">
        <li class="list-inline-item" data-bs-tooltip data-bs-title='Копировать'>
          <a class="text-body" href="#"
             data-fn="clipboard preventDefault" data-clipboard-target="#cp-e234566a05666c10e348f0fc5de99000"
             role="button" aria-label='Копировать'>
            <i class="fas fa-copy fa-fw"></i>
          </a>
        </li>
      </ul>
    </div>
  </div>
</div>

<h2 id="перемещение-пользователя">
  <a class="link-body-emphasis" href="#%d0%bf%d0%b5%d1%80%d0%b5%d0%bc%d0%b5%d1%89%d0%b5%d0%bd%d0%b8%d0%b5-%d0%bf%d0%be%d0%bb%d1%8c%d0%b7%d0%be%d0%b2%d0%b0%d1%82%d0%b5%d0%bb%d1%8f">Перемещение пользователя</a>
</h2>


<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-6 shortcode-codeblock-text">
  <div class="d-flex overflow-hidden">
    <div class="flex-grow-1 rounded overflow-hidden" id="cp-ca8efc7b2ceae09c88237f2ad8e78562">
      
      <pre><code class='language-text'>usermod -md /new_home/user-0001 user-0001</code></pre>
    </div>
    <div class="flex-shrink-0">
      <ul class="list-inline mb-0">
        <li class="list-inline-item" data-bs-tooltip data-bs-title='Копировать'>
          <a class="text-body" href="#"
             data-fn="clipboard preventDefault" data-clipboard-target="#cp-ca8efc7b2ceae09c88237f2ad8e78562"
             role="button" aria-label='Копировать'>
            <i class="fas fa-copy fa-fw"></i>
          </a>
        </li>
      </ul>
    </div>
  </div>
</div>

<h2 id="работа-с-диском">
  <a class="link-body-emphasis" href="#%d1%80%d0%b0%d0%b1%d0%be%d1%82%d0%b0-%d1%81-%d0%b4%d0%b8%d1%81%d0%ba%d0%be%d0%bc">Работа с диском</a>
</h2><p>Чтобы создать на новом диске раздел, необходимо войти в программу <code>parted</code>:</p>



<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-7 shortcode-codeblock-text">
  <div class="d-flex overflow-hidden">
    <div class="flex-grow-1 rounded overflow-hidden" id="cp-c14ae32d79a0314231827bc85ffaf0df">
      
      <pre><code class='language-text'>parted -a optimal /dev/sdb</code></pre>
    </div>
    <div class="flex-shrink-0">
      <ul class="list-inline mb-0">
        <li class="list-inline-item" data-bs-tooltip data-bs-title='Копировать'>
          <a class="text-body" href="#"
             data-fn="clipboard preventDefault" data-clipboard-target="#cp-c14ae32d79a0314231827bc85ffaf0df"
             role="button" aria-label='Копировать'>
            <i class="fas fa-copy fa-fw"></i>
          </a>
        </li>
      </ul>
    </div>
  </div>
</div>

<p>Выполнить следующие команды:</p>



<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-8 shortcode-codeblock-text">
  <div class="d-flex overflow-hidden">
    <div class="flex-grow-1 rounded overflow-hidden" id="cp-57bf155c557568634cd7b413695c5782">
      
      <pre><code class='language-text'>(parted) mklabel gpt
(parted) mkpart primary 0% 100%
(parted) quit</code></pre>
    </div>
    <div class="flex-shrink-0">
      <ul class="list-inline mb-0">
        <li class="list-inline-item" data-bs-tooltip data-bs-title='Копировать'>
          <a class="text-body" href="#"
             data-fn="clipboard preventDefault" data-clipboard-target="#cp-57bf155c557568634cd7b413695c5782"
             role="button" aria-label='Копировать'>
            <i class="fas fa-copy fa-fw"></i>
          </a>
        </li>
      </ul>
    </div>
  </div>
</div>

<p>Создать файловую систему:</p>



<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-9 shortcode-codeblock-text">
  <div class="d-flex overflow-hidden">
    <div class="flex-grow-1 rounded overflow-hidden" id="cp-1e4462207a5c7419c5f969ab90c28526">
      
      <pre><code class='language-text'>mkfs.xfs /dev/sdb1</code></pre>
    </div>
    <div class="flex-shrink-0">
      <ul class="list-inline mb-0">
        <li class="list-inline-item" data-bs-tooltip data-bs-title='Копировать'>
          <a class="text-body" href="#"
             data-fn="clipboard preventDefault" data-clipboard-target="#cp-1e4462207a5c7419c5f969ab90c28526"
             role="button" aria-label='Копировать'>
            <i class="fas fa-copy fa-fw"></i>
          </a>
        </li>
      </ul>
    </div>
  </div>
</div>

<p>Настроить автоматическое монтирование раздела в <code>/etc/fstab</code>:</p>



<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-10 shortcode-codeblock-text">
  <div class="d-flex overflow-hidden">
    <div class="flex-grow-1 rounded overflow-hidden" id="cp-8b326368073a4792c0d937751ee737b3">
      
      <pre><code class='language-text'>/dev/sdb1 /home/storage xfs defaults 0 0</code></pre>
    </div>
    <div class="flex-shrink-0">
      <ul class="list-inline mb-0">
        <li class="list-inline-item" data-bs-tooltip data-bs-title='Копировать'>
          <a class="text-body" href="#"
             data-fn="clipboard preventDefault" data-clipboard-target="#cp-8b326368073a4792c0d937751ee737b3"
             role="button" aria-label='Копировать'>
            <i class="fas fa-copy fa-fw"></i>
          </a>
        </li>
      </ul>
    </div>
  </div>
</div>]]></turbo:content></item><item turbo="true"><title>Запись ISO на USB Flash Drive</title><link>https://lib.onl/ru/articles/2020/06/5d90ef6f-f05f-5462-b8a2-28dac0bb2f48/</link><pubDate>Tue, 02 Jun 2020 06:20:24 +0000</pubDate><dc:creator>Kai Kimera</dc:creator><category>Linux</category><turbo:extendedHtml>true</turbo:extendedHtml><turbo:source>https://lib.onl/ru/articles/2020/06/5d90ef6f-f05f-5462-b8a2-28dac0bb2f48/</turbo:source><turbo:topic>Запись ISO на USB Flash Drive</turbo:topic><turbo:content><![CDATA[<p>Команды для &ldquo;правильной&rdquo; записи <span class="shortcode shortcode-tag">ISO</span> на <span class="shortcode shortcode-tag"><a href="/ru/tags/usb/" target="_blank">#USB</a></span> Flash Drive.</p>
<ol>
<li>Определить <span class="shortcode shortcode-tag"><a href="/ru/tags/usb/" target="_blank">#USB</a></span>-накопитель при помощи команды <code>fdisk -l</code>.</li>
<li>Отмонтировать ВСЕ разделы с <span class="shortcode shortcode-tag"><a href="/ru/tags/usb/" target="_blank">#USB</a></span>-накопителя командой <code>umount /dev/sdX*</code>, где <code>X</code> - буква накопителя (например, <code>umount /dev/sdc*</code>).</li>
<li>Загрузить <span class="shortcode shortcode-tag">ISO</span> на <span class="shortcode shortcode-tag"><a href="/ru/tags/usb/" target="_blank">#USB</a></span>-накопитель:</li>
</ol>



<div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-6 shortcode-codeblock-bash">
  <div class="d-flex overflow-hidden">
    <div class="flex-grow-1 rounded overflow-hidden" id="cp-4ad0b49cbdce4920dc11ecea325f1066">
      
      <pre><code class='language-bash'># Отмонтировать и очистить USB-накопитель.
umount /dev/sdX* &amp;&amp; sgdisk -Z /dev/sdX

# Записать образ на USB-накопитель.
dd if=image.iso of=/dev/sdX bs=4M oflag=direct status=progress; sync

# Извлечь USB-накопитель.
eject /dev/sdX</code></pre>
    </div>
    <div class="flex-shrink-0">
      <ul class="list-inline mb-0">
        <li class="list-inline-item" data-bs-tooltip data-bs-title='Копировать'>
          <a class="text-body" href="#"
             data-fn="clipboard preventDefault" data-clipboard-target="#cp-4ad0b49cbdce4920dc11ecea325f1066"
             role="button" aria-label='Копировать'>
            <i class="fas fa-copy fa-fw"></i>
          </a>
        </li>
      </ul>
    </div>
  </div>
</div>]]></turbo:content></item><item turbo="true"><title>Первая запись</title><link>https://lib.onl/ru/articles/2020/06/6a305138-a151-5439-91d8-e2feeed39991/</link><pubDate>Tue, 02 Jun 2020 06:20:21 +0000</pubDate><dc:creator>Kai Kimera</dc:creator><category>Блог</category><turbo:extendedHtml>true</turbo:extendedHtml><turbo:source>https://lib.onl/ru/articles/2020/06/6a305138-a151-5439-91d8-e2feeed39991/</turbo:source><turbo:topic>Первая запись</turbo:topic><turbo:content>&lt;p>Привет!&lt;/p>
&lt;p>Это первая запись для тестирования конфигурации и возможностей данного блога. Запись для тестирования функциональности и корректности шаблонов.&lt;/p></turbo:content></item></channel></rss>