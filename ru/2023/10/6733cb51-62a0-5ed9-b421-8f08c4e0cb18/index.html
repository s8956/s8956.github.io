<!doctype html><html class=h-100 dir=ltr lang=ru-RU data-bs-theme=auto prefix="og: http://ogp.me/ns#
      article: http://ogp.me/ns/article#
      profile: http://ogp.me/ns/profile#
      fb: http://ogp.me/ns/fb#"><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1,viewport-fit=cover"><title>Создание сертификатов при помощи OpenSSL / Library Online</title>
<meta name=title content="Создание сертификатов при помощи OpenSSL / Library Online"><meta name=description content="#OpenSSL является библиотекой по работе с криптографией, но в этой статье я затрону только часть функций этого инструмента, а именно создание само-подписанных сертификатов."><meta name=keywords content="openssl,bash,сертификаты"><link rel=preconnect href=https://gravatar.com crossorigin=anonymous><link rel=preconnect href=https://images.unsplash.com crossorigin=anonymous><script src=/js/theme.min.5f10d03721145ce818261015067fd92d71c874ab15bf49889ca53b1cf0c73c18.js integrity="sha256-XxDQNyEUXOgYJhAVBn/ZLXHIdKsVv0mInKU7HPDHPBg=" crossorigin=anonymous></script><link rel=preload href=/css/vendor.bundle.min.css as=style><link rel=stylesheet href=/css/vendor.bundle.min.css><link rel=preload href=/ru/css/system.bundle.min.css as=style><link rel=stylesheet href=/ru/css/system.bundle.min.css><link rel=icon type=image/png sizes=16x16 href=https://lib.onl/favicon-16.png><link rel="shortcut icon" type=image/png sizes=16x16 href=https://lib.onl/favicon-16.png><link rel=apple-touch-icon sizes=16x16 href=https://lib.onl/favicon-16.png><link rel=icon type=image/png sizes=24x24 href=https://lib.onl/favicon-24.png><link rel="shortcut icon" type=image/png sizes=24x24 href=https://lib.onl/favicon-24.png><link rel=apple-touch-icon sizes=24x24 href=https://lib.onl/favicon-24.png><link rel=icon type=image/png sizes=32x32 href=https://lib.onl/favicon-32.png><link rel="shortcut icon" type=image/png sizes=32x32 href=https://lib.onl/favicon-32.png><link rel=apple-touch-icon sizes=32x32 href=https://lib.onl/favicon-32.png><link rel=icon type=image/png sizes=48x48 href=https://lib.onl/favicon-48.png><link rel="shortcut icon" type=image/png sizes=48x48 href=https://lib.onl/favicon-48.png><link rel=apple-touch-icon sizes=48x48 href=https://lib.onl/favicon-48.png><link rel=icon type=image/png sizes=64x64 href=https://lib.onl/favicon-64.png><link rel="shortcut icon" type=image/png sizes=64x64 href=https://lib.onl/favicon-64.png><link rel=apple-touch-icon sizes=64x64 href=https://lib.onl/favicon-64.png><link rel=icon type=image/png sizes=72x72 href=https://lib.onl/favicon-72.png><link rel="shortcut icon" type=image/png sizes=72x72 href=https://lib.onl/favicon-72.png><link rel=apple-touch-icon sizes=72x72 href=https://lib.onl/favicon-72.png><link rel=icon type=image/png sizes=80x80 href=https://lib.onl/favicon-80.png><link rel="shortcut icon" type=image/png sizes=80x80 href=https://lib.onl/favicon-80.png><link rel=apple-touch-icon sizes=80x80 href=https://lib.onl/favicon-80.png><link rel=icon type=image/png sizes=96x96 href=https://lib.onl/favicon-96.png><link rel="shortcut icon" type=image/png sizes=96x96 href=https://lib.onl/favicon-96.png><link rel=apple-touch-icon sizes=96x96 href=https://lib.onl/favicon-96.png><link rel=icon type=image/png sizes=128x128 href=https://lib.onl/favicon-128.png><link rel="shortcut icon" type=image/png sizes=128x128 href=https://lib.onl/favicon-128.png><link rel=apple-touch-icon sizes=128x128 href=https://lib.onl/favicon-128.png><link rel=icon type=image/png sizes=144x144 href=https://lib.onl/favicon-144.png><link rel="shortcut icon" type=image/png sizes=144x144 href=https://lib.onl/favicon-144.png><link rel=apple-touch-icon sizes=144x144 href=https://lib.onl/favicon-144.png><link rel=icon type=image/png sizes=152x152 href=https://lib.onl/favicon-152.png><link rel="shortcut icon" type=image/png sizes=152x152 href=https://lib.onl/favicon-152.png><link rel=apple-touch-icon sizes=152x152 href=https://lib.onl/favicon-152.png><link rel=icon type=image/png sizes=167x167 href=https://lib.onl/favicon-167.png><link rel="shortcut icon" type=image/png sizes=167x167 href=https://lib.onl/favicon-167.png><link rel=apple-touch-icon sizes=167x167 href=https://lib.onl/favicon-167.png><link rel=icon type=image/png sizes=180x180 href=https://lib.onl/favicon-180.png><link rel="shortcut icon" type=image/png sizes=180x180 href=https://lib.onl/favicon-180.png><link rel=apple-touch-icon sizes=180x180 href=https://lib.onl/favicon-180.png><link rel=icon type=image/png sizes=192x192 href=https://lib.onl/favicon-192.png><link rel="shortcut icon" type=image/png sizes=192x192 href=https://lib.onl/favicon-192.png><link rel=apple-touch-icon sizes=192x192 href=https://lib.onl/favicon-192.png><link rel=icon type=image/png sizes=196x196 href=https://lib.onl/favicon-196.png><link rel="shortcut icon" type=image/png sizes=196x196 href=https://lib.onl/favicon-196.png><link rel=apple-touch-icon sizes=196x196 href=https://lib.onl/favicon-196.png><link rel=icon type=image/png sizes=256x256 href=https://lib.onl/favicon-256.png><link rel="shortcut icon" type=image/png sizes=256x256 href=https://lib.onl/favicon-256.png><link rel=apple-touch-icon sizes=256x256 href=https://lib.onl/favicon-256.png><link rel=icon type=image/png sizes=300x300 href=https://lib.onl/favicon-300.png><link rel="shortcut icon" type=image/png sizes=300x300 href=https://lib.onl/favicon-300.png><link rel=apple-touch-icon sizes=300x300 href=https://lib.onl/favicon-300.png><link rel=icon type=image/png sizes=512x512 href=https://lib.onl/favicon-512.png><link rel="shortcut icon" type=image/png sizes=512x512 href=https://lib.onl/favicon-512.png><link rel=apple-touch-icon sizes=512x512 href=https://lib.onl/favicon-512.png><link rel=icon type=image/svg+xml sizes=any href=https://lib.onl/favicon.svg><link rel="shortcut icon" type=image/x-icon href=https://lib.onl/favicon.ico><link rel="shortcut icon" type=image/vnd.microsoft.icon href=https://lib.onl/favicon.ico><link rel=canonical href=https://lib.onl/ru/2023/10/6733cb51-62a0-5ed9-b421-8f08c4e0cb18/><link rel=alternate href=https://lib.onl/ hreflang=x-default><link rel=alternate href=https://lib.onl/ru/2023/10/6733cb51-62a0-5ed9-b421-8f08c4e0cb18/ hreflang=ru><link rel=manifest type=application/manifest+json href=https://lib.onl/ru/manifest.json title="Library Online"><link rel=search type=application/opensearchdescription+xml href=https://lib.onl/ru/opensearch.xml title="Library Online"><link rel=alternate type=application/json href=https://lib.onl/ru/2023/10/6733cb51-62a0-5ed9-b421-8f08c4e0cb18/index.json title="Library Online"><meta name=application-name content="Library Online"><meta name=theme-color content="#f8f9fa" media="(prefers-color-scheme: light)"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://images.unsplash.com/photo-1568057373189-8bf0cf6179e6"><meta name=twitter:title content="Создание сертификатов при помощи OpenSSL"><meta name=twitter:description content="#OpenSSL является библиотекой по работе с криптографией, но в этой статье я затрону только часть функций этого инструмента, а именно создание само-подписанных сертификатов."><meta property="og:url" content="https://lib.onl/ru/2023/10/6733cb51-62a0-5ed9-b421-8f08c4e0cb18/"><meta property="og:site_name" content="Library Online"><meta property="og:title" content="Создание сертификатов при помощи OpenSSL"><meta property="og:description" content="#OpenSSL является библиотекой по работе с криптографией, но в этой статье я затрону только часть функций этого инструмента, а именно создание само-подписанных сертификатов."><meta property="og:locale" content="ru_RU"><meta property="og:type" content="article"><meta property="article:section" content="articles"><meta property="article:published_time" content="2023-10-18T02:42:31+03:00"><meta property="article:modified_time" content="2024-04-05T14:57:00+03:00"><meta property="article:tag" content="Openssl"><meta property="article:tag" content="Bash"><meta property="article:tag" content="Сертификаты"><meta property="og:image" content="https://images.unsplash.com/photo-1568057373189-8bf0cf6179e6"><meta property="twitter:domain" content="lib.onl"><meta property="twitter:url" content="https://lib.onl/ru/2023/10/6733cb51-62a0-5ed9-b421-8f08c4e0cb18/"><meta property="og:locale" content="ru_RU"><meta property="og:site_name" content="Library Online"><meta name=aiturec:title content="Создание сертификатов при помощи OpenSSL"><meta property="aiturec:description" content="#OpenSSL является библиотекой по работе с криптографией, но в этой статье я затрону только часть функций этого инструмента, а именно создание само-подписанных сертификатов."><meta property="aiturec:item_id" content="6733cb51-62a0-5ed9-b421-8f08c4e0cb18"><meta property="aiturec:datetime" content="2023-10-17T23:42:31Z"><meta property="aiturec:image" content="https://images.unsplash.com/photo-1568057373189-8bf0cf6179e6"><meta property="vk:image" content="https://images.unsplash.com/photo-1568057373189-8bf0cf6179e6"><meta property="article:author" content="Kai Kimera"><meta property="article:tag" content="openssl"><meta property="article:tag" content="bash"><meta property="article:tag" content="сертификаты"><meta name=DC.Title content="Создание сертификатов при помощи OpenSSL"><meta name=DC.Subject content="#OpenSSL является библиотекой по работе с криптографией, но в этой статье я затрону только часть функций этого инструмента, а именно создание само-подписанных сертификатов."><meta name=DC.Description content="#OpenSSL является библиотекой по работе с криптографией, но в этой статье я затрону только часть функций этого инструмента, а именно создание само-подписанных сертификатов."><meta name=DC.Type content="Text"><meta name=DC.Source content="https://lib.onl/ru/2023/10/6733cb51-62a0-5ed9-b421-8f08c4e0cb18/"><meta name=DC.Relation content="https://lib.onl/ru/2023/10/6733cb51-62a0-5ed9-b421-8f08c4e0cb18/"><meta name=DC.Coverage content="World"><meta name=DC.Creator content="Library Online"><meta name=DC.Publisher content="Library Online"><meta name=DC.Contributor content="Library Online"><meta name=DC.Rights content="Library Online"><meta name=DC.Format content="Digital"><meta name=DC.Identifier content="https://lib.onl/ru/2023/10/6733cb51-62a0-5ed9-b421-8f08c4e0cb18/"><meta name=DC.Language content="ru-RU"><meta name=DC.Provenance content="Library Online"><meta name=DC.RightsHolder content="Library Online"><meta name=DC.AccrualPeriodicity content="Weekly"><meta name=DC.AccrualPolicy content="Active"></head><body class="d-flex flex-column h-100 is-page type-articles"><header id=site-header><nav class="navbar navbar-expand-lg navbar-light fixed-top border-bottom shadow-sm text-lg-center bg-body-tertiary"><div class=container-fluid><a class=navbar-brand href=/ru/><img src=https://lib.onl/img/logo.min.svg alt=Логотип width=30 height=24 class="d-inline-block align-text-top"><h2 class="d-inline-block h5 m-0 ms-1">Library Online</h2></a><button type=button class=navbar-toggler data-bs-toggle=collapse data-bs-target=#navTopBar aria-controls=navTopBar aria-expanded=false aria-label='Переключить навигацию'>
<span class=navbar-toggler-icon></span></button><div class="collapse navbar-collapse" id=navTopBar><ul class="navbar-nav me-auto"><li class=nav-item><a class=nav-link href=/ru/articles/><i class="fas fa-file-lines fa-fw"></i>
<span>Статьи</span></a></li><li class=nav-item><a class=nav-link href=/ru/faq/><i class="fas fa-circle-question fa-fw"></i>
<span>Q&amp;A</span></a></li><li class=nav-item><a class=nav-link href=/ru/archive/><i class="fas fa-archive fa-fw"></i>
<span>Архив</span></a></li><li class=nav-item><a class=nav-link href=/ru/about/><i class="fas fa-info-circle fa-fw"></i>
<span>О проекте</span></a></li><li class="nav-item dropdown"><a class="nav-link dropdown-toggle" href=# role=button data-bs-toggle=dropdown aria-expanded=false><i class="fas fa-list fa-fw"></i>
<span>META</span></a><ul class="dropdown-menu shadow"><li><a class=dropdown-item href=/ru/authors/><i class="fas fa-user-circle fa-fw"></i>
<span>Авторы</span></a></li><li><a class=dropdown-item href=/ru/categories/><i class="fas fa-folder-open fa-fw"></i>
<span>Категории</span></a></li><li><a class=dropdown-item href=/ru/tags/><i class="fas fa-tags fa-fw"></i>
<span>Теги</span></a></li></ul></li></ul><ul class=navbar-nav><li class=nav-item><a class="nav-link d-lg-none" href=# data-bs-toggle=modal data-bs-target=#search-modal aria-label=Поиск><i class="fas fa-search fa-fw"></i>
<span>Поиск</span>
</a><a title=Поиск class="nav-link d-none d-lg-block" href=# data-bs-toggle=modal data-bs-target=#search-modal aria-label=Поиск><i class="fas fa-search fa-fw"></i></a></li></ul><ul class=navbar-nav><li class="nav-item dropdown"><a class="nav-link dropdown-toggle d-lg-none ui-theme" href=# role=button data-bs-toggle=dropdown aria-expanded=false aria-label='Переключить тему'><i class="fas fa-circle-half-stroke fa-fw"></i>
<span>Тема интерфейса</span>
</a><a title='Тема интерфейса' class="nav-link dropdown-toggle d-none d-lg-block ui-theme" href=# role=button data-bs-toggle=dropdown aria-expanded=false aria-label='Переключить тему'><i class="fas fa-circle-half-stroke fa-fw"></i></a><ul class="dropdown-menu dropdown-menu-end shadow"><li><button class=dropdown-item type=button data-bs-theme-value=light aria-pressed=false>
<i class="fas fa-sun fa-fw"></i>
<span>Светлая</span></button></li><li><button class=dropdown-item type=button data-bs-theme-value=dark aria-pressed=false>
<i class="fas fa-moon fa-fw"></i>
<span>Тёмная</span></button></li><li><button class="dropdown-item active" type=button data-bs-theme-value=auto aria-pressed=true>
<i class="fas fa-circle-half-stroke fa-fw"></i>
<span>Системная</span></button></li></ul></li></ul></div></div></nav></header><main class="wrapper flex-shrink-0" id=site-main><div class="section py-3"><div class=container><nav style="--bs-breadcrumb-divider:'\2f '" class=small aria-label=breadcrumb><ol class="breadcrumb p-2 rounded bg-body-tertiary"><li class=breadcrumb-item><a href=/ru/ aria-label=Главная><i class="fas fa-home fa-fw"></i></a></li><li class=breadcrumb-item><a href=/ru/articles/ aria-label=Статьи>Статьи</a></li><li class="breadcrumb-item active">Создание сертификатов при помощи OpenSSL</li></ol></nav><article><header><div class="node-cover mb-3"><a title="Создание сертификатов при помощи OpenSSL" class="d-flex align-items-center rounded overflow-hidden bg-body-tertiary" href=/ru/2023/10/6733cb51-62a0-5ed9-b421-8f08c4e0cb18/><picture><source srcset='https://images.unsplash.com/photo-1568057373189-8bf0cf6179e6?crop=edges&amp;w=640&amp;h=360&amp;fit=crop&amp;auto=compress,format 640w,https://images.unsplash.com/photo-1568057373189-8bf0cf6179e6?crop=edges&amp;w=768&amp;h=432&amp;fit=crop&amp;auto=compress,format 768w,https://images.unsplash.com/photo-1568057373189-8bf0cf6179e6?crop=edges&amp;w=1024&amp;h=576&amp;fit=crop&amp;auto=compress,format 1024w,https://images.unsplash.com/photo-1568057373189-8bf0cf6179e6?crop=edges&amp;w=1280&amp;h=720&amp;fit=crop&amp;auto=compress,format 1280w,https://images.unsplash.com/photo-1568057373189-8bf0cf6179e6?crop=edges&amp;w=1600&amp;h=900&amp;fit=crop&amp;auto=compress,format 1600w' sizes="(min-width: 576px) 100vw"><img class=img-fluid src="https://images.unsplash.com/photo-1568057373189-8bf0cf6179e6?crop=edges&amp;w=1600&amp;h=900&amp;fit=crop&amp;auto=compress,format" width=1600 height=900 alt="Создание сертификатов при помощи OpenSSL" loading=lazy></picture></a></div><div class=node-title><h1 class=text-center>Создание сертификатов при помощи OpenSSL</h1></div></header><footer><ul class="list-inline text-center text-body-secondary small"><li class=list-inline-item><time datetime=2023-10-17T23:42:31Z data-fn=date-local>2023/10/17 23:42:31 UTC</time></li><li class=list-inline-item>&bull;</li><li class="list-inline-item text-warning" data-bs-tooltip data-bs-title='Уровень сложности: Средний'><i class="far fa-face-meh fa-fw"></i></li></ul></footer><ul class="nav nav-tabs mb-3" id=node-tabs-87dde14e5012e51854b6cd1c6c895aa6 data-fn=node-tabs role=tablist><li class=nav-item role=presentation data-bs-tooltip data-bs-title=Главная><button class="nav-link active" id=tab-main-home type=button role=tab data-bs-toggle=tab data-bs-target=#tab-pane-main-home aria-controls=tab-pane-main-home aria-selected=true aria-label=Главная>
<i class="fas fa-home fa-fw"></i></button></li><li class=nav-item role=presentation data-bs-tooltip data-bs-title='Журнал изменений'><button class=nav-link id=tab-main-changelog type=button role=tab data-bs-toggle=tab data-bs-target=#tab-pane-main-changelog aria-controls=tab-pane-main-changelog aria-selected=false aria-label='Журнал изменений'>
<i class="far fa-clock fa-fw"></i></button></li><li class=nav-item role=presentation data-bs-tooltip data-bs-title=Информация><button class=nav-link id=tab-main-info type=button role=tab data-bs-toggle=tab data-bs-target=#tab-pane-main-info aria-controls=tab-pane-main-info aria-selected=false aria-label=Информация>
<i class="fas fa-info fa-fw"></i></button></li><li class=nav-item role=presentation data-bs-tooltip data-bs-title=Комментарии><button class=nav-link id=tab-main-comments type=button role=tab data-bs-toggle=tab data-bs-target=#tab-pane-main-comments aria-controls=tab-pane-main-comments aria-selected=false aria-label=Комментарии>
<i class="far fa-comments fa-fw"></i></button></li><li class="nav-item ms-auto" role=presentation data-bs-tooltip data-bs-title=Поделиться><button class=nav-link id=tab-main-share type=button role=tab data-bs-toggle=tab data-bs-target=#tab-pane-main-share aria-controls=tab-pane-main-share aria-selected=false aria-label=Поделиться>
<i class="fas fa-share fa-fw"></i></button></li></ul><div class=tab-content><div class="tab-pane show active" id=tab-pane-main-home role=tabpanel aria-labelledby=tab-main-home tabindex=0><div class=node-body><div class="node-toc mb-3"><div class=accordion id=accordion-toc-10c1210fd18cd5807997de1b035101f3><div class=accordion-item><h2 class=accordion-header><a class="accordion-button collapsed" href=# role=button tabindex=0 data-bs-toggle=collapse data-bs-target=#collapse-toc-10c1210fd18cd5807997de1b035101f3 aria-expanded=false aria-controls=collapse-toc-10c1210fd18cd5807997de1b035101f3 aria-label=Содержание>Содержание</a></h2><div id=collapse-toc-10c1210fd18cd5807997de1b035101f3 class="accordion-collapse collapse"><div class=accordion-body><nav id=TableOfContents><ul><li><a href=#создание-центра-сертификации>Создание центра сертификации</a></li><li><a href=#создание-клиентского-сертификата>Создание клиентского сертификата</a><ul><li><a href=#создание-приватного-ключа>Создание приватного ключа</a></li><li><a href=#создание-запроса-на-подпись-сертификата>Создание запроса на подпись сертификата</a></li><li><a href=#создание-и-подпись-сертификата>Создание и подпись сертификата</a></li><li><a href=#экспорт-сертификата>Экспорт сертификата</a></li><li><a href=#верификация-сертификата>Верификация сертификата</a></li><li><a href=#просмотр-сертификата>Просмотр сертификата</a></li><li><a href=#просмотр-запроса-на-подпись-сертификата>Просмотр запроса на подпись сертификата</a></li></ul></li><li><a href=#автоматизация>Автоматизация</a><ul><li><a href=#использование>Использование</a></li></ul></li><li><a href=#быстрое-создание-само-подписанного-сертификата>Быстрое создание само-подписанного сертификата</a><ul><li><a href=#ecc-elliptic-curve-cryptography>ECC (Elliptic Curve Cryptography)</a></li><li><a href=#rsa-rivest-shamir-adleman>RSA (Rivest-Shamir-Adleman)</a></li><li><a href=#скрипт>Скрипт</a></li></ul></li></ul></nav></div></div></div></div></div><p><span class="shortcode shortcode-tag"><a href=/ru/tags/openssl/ target=_blank>#OpenSSL</a></span> является библиотекой по работе с криптографией, но в этой статье я затрону только часть функций этого инструмента, а именно создание само-подписанных сертификатов.</p><h2 id=создание-центра-сертификации><a class=link-body-emphasis href=#%d1%81%d0%be%d0%b7%d0%b4%d0%b0%d0%bd%d0%b8%d0%b5-%d1%86%d0%b5%d0%bd%d1%82%d1%80%d0%b0-%d1%81%d0%b5%d1%80%d1%82%d0%b8%d1%84%d0%b8%d0%ba%d0%b0%d1%86%d0%b8%d0%b8>Создание центра сертификации</a></h2><p>При помощи корневого сертификата, мы будем подписывать сертификаты клиентские. Создаём сертификат центра сертификации&mldr;</p><div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-0
shortcode-codeblock-bash"><div class="d-flex overflow-hidden"><div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body" id=cp-709e8be31024ad305988e07730c27c79 data-bs-theme=dark><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>openssl ecparam -genkey -name <span class=s1>&#39;secp384r1&#39;</span> <span class=p>|</span> openssl ec -aes256 -out <span class=s2>&#34;_CA.key&#34;</span> <span class=o>&amp;&amp;</span> openssl req -new -sha384 -key <span class=s2>&#34;_CA.key&#34;</span> -out <span class=s2>&#34;_CA.csr&#34;</span> <span class=o>&amp;&amp;</span> openssl x509 -req -sha384 -days <span class=m>3650</span> -key <span class=s2>&#34;_CA.key&#34;</span> -in <span class=s2>&#34;_CA.csr&#34;</span> -out <span class=s2>&#34;_CA.crt&#34;</span></span></span></code></pre></td></tr></table></div></div></div><div class=flex-shrink-0><ul class="list-inline mb-0"><li class=list-inline-item data-bs-tooltip data-bs-title=Копировать><a class=text-body href=# data-fn=clipboard data-clipboard-target=#cp-709e8be31024ad305988e07730c27c79 role=button aria-label=Копировать><i class="fas fa-copy fa-fw"></i></a></li></ul></div></div></div><p>Где:</p><ul><li><code>-days '3650'</code> - количество дней, по прошествии которого сертификат центра сертификации станет недействительным.</li><li><code>'_CA.key'</code> - название создаваемого файла с ключом центра сертификации.</li><li><code>'_CA.crt'</code> - название создаваемого файла с сертификатом центра сертификации.</li></ul><h2 id=создание-клиентского-сертификата><a class=link-body-emphasis href=#%d1%81%d0%be%d0%b7%d0%b4%d0%b0%d0%bd%d0%b8%d0%b5-%d0%ba%d0%bb%d0%b8%d0%b5%d0%bd%d1%82%d1%81%d0%ba%d0%be%d0%b3%d0%be-%d1%81%d0%b5%d1%80%d1%82%d0%b8%d1%84%d0%b8%d0%ba%d0%b0%d1%82%d0%b0>Создание клиентского сертификата</a></h2><p>Как только будет готов корневой сертификат, можно приступать к выпуску клиентских сертификатов.</p><h3 id=создание-приватного-ключа><a class=link-body-emphasis href=#%d1%81%d0%be%d0%b7%d0%b4%d0%b0%d0%bd%d0%b8%d0%b5-%d0%bf%d1%80%d0%b8%d0%b2%d0%b0%d1%82%d0%bd%d0%be%d0%b3%d0%be-%d0%ba%d0%bb%d1%8e%d1%87%d0%b0>Создание приватного ключа</a></h3><p>Для начала создаём приватный ключ.</p><div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-1
shortcode-codeblock-bash"><div class="d-flex overflow-hidden"><div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body" id=cp-3ec35f4be15b62651d0924c546db0a5f data-bs-theme=dark><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>openssl ecparam -genkey -name <span class=s1>&#39;prime256v1&#39;</span> <span class=p>|</span> openssl ec -out <span class=s1>&#39;client.key&#39;</span></span></span></code></pre></td></tr></table></div></div></div><div class=flex-shrink-0><ul class="list-inline mb-0"><li class=list-inline-item data-bs-tooltip data-bs-title=Копировать><a class=text-body href=# data-fn=clipboard data-clipboard-target=#cp-3ec35f4be15b62651d0924c546db0a5f role=button aria-label=Копировать><i class="fas fa-copy fa-fw"></i></a></li></ul></div></div></div><p>Где:</p><ul><li><code>-out 'client.key'</code> - название создаваемого файла с клиентским приватным ключом.</li></ul><h3 id=создание-запроса-на-подпись-сертификата><a class=link-body-emphasis href=#%d1%81%d0%be%d0%b7%d0%b4%d0%b0%d0%bd%d0%b8%d0%b5-%d0%b7%d0%b0%d0%bf%d1%80%d0%be%d1%81%d0%b0-%d0%bd%d0%b0-%d0%bf%d0%be%d0%b4%d0%bf%d0%b8%d1%81%d1%8c-%d1%81%d0%b5%d1%80%d1%82%d0%b8%d1%84%d0%b8%d0%ba%d0%b0%d1%82%d0%b0>Создание запроса на подпись сертификата</a></h3><p>Выполняем запрос на сертификат.</p><div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-2
shortcode-codeblock-bash"><div class="d-flex overflow-hidden"><div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body" id=cp-d504a6d98fb83eef1082d4daf69a12b1 data-bs-theme=dark><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>openssl req -new -key <span class=s1>&#39;client.key&#39;</span> -out <span class=s1>&#39;client.csr&#39;</span></span></span></code></pre></td></tr></table></div></div></div><div class=flex-shrink-0><ul class="list-inline mb-0"><li class=list-inline-item data-bs-tooltip data-bs-title=Копировать><a class=text-body href=# data-fn=clipboard data-clipboard-target=#cp-d504a6d98fb83eef1082d4daf69a12b1 role=button aria-label=Копировать><i class="fas fa-copy fa-fw"></i></a></li></ul></div></div></div><p>Где:</p><ul><li><code>-key 'client.key'</code> - файл с приватным ключом клиентского сертификата.</li><li><code>-out 'client.csr'</code> - название создаваемого файла с запросом на подпись клиентского сертификата.</li></ul><p>При выполнении запроса будет предложено ввести актуальные данные для будущего сертификата:</p><ul><li><code>Country Name (2 letter code)</code> - двухбуквенный код страны, в которой юридически находится ваша организация.</li><li><code>State or Province Name (full name)</code> - штат или провинция, в которой юридически находится ваша организация.</li><li><code>Locality Name (e.g., city)</code> - город, в котором юридически находится ваша организация.</li><li><code>Organization Name (e.g., company)</code> - юридически зарегистрированное название вашей организации.</li><li><code>Organizational Unit Name (e.g., section)</code> - название вашего отдела в организации (опционально).</li><li><code>Common Name (e.g., server FQDN)</code> - полное доменное имя (FQDN) (например, <a title href=https://www.example.com target=_blank rel="noopener noreferrer">www.example.com</a>).</li><li><code>Email Address</code> - ваш адрес email (опционально).</li><li><code>A challenge password</code> - пароль (опционально).</li><li><code>An optional company name</code> - необязательное название компании (опционально).</li></ul><p>Самое главное поле это <code>Common Name (e.g., server FQDN)</code> (<code>CN</code>), заполнять его необходимо очень внимательно.</p><h3 id=создание-и-подпись-сертификата><a class=link-body-emphasis href=#%d1%81%d0%be%d0%b7%d0%b4%d0%b0%d0%bd%d0%b8%d0%b5-%d0%b8-%d0%bf%d0%be%d0%b4%d0%bf%d0%b8%d1%81%d1%8c-%d1%81%d0%b5%d1%80%d1%82%d0%b8%d1%84%d0%b8%d0%ba%d0%b0%d1%82%d0%b0>Создание и подпись сертификата</a></h3><p>В заключительной части остаётся только создать сам сертификат и подписать его.</p><div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-3
shortcode-codeblock-bash"><div class="d-flex overflow-hidden"><div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body" id=cp-4990dddc490efc57772a77437e26a1e0 data-bs-theme=dark><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>openssl x509 -req -days <span class=m>3650</span> -in <span class=s1>&#39;client.csr&#39;</span> -CA <span class=s1>&#39;_CA.crt&#39;</span> -CAkey <span class=s1>&#39;_CA.key&#39;</span> -out <span class=s1>&#39;client.crt&#39;</span></span></span></code></pre></td></tr></table></div></div></div><div class=flex-shrink-0><ul class="list-inline mb-0"><li class=list-inline-item data-bs-tooltip data-bs-title=Копировать><a class=text-body href=# data-fn=clipboard data-clipboard-target=#cp-4990dddc490efc57772a77437e26a1e0 role=button aria-label=Копировать><i class="fas fa-copy fa-fw"></i></a></li></ul></div></div></div><p>Где:</p><ul><li><code>-in 'client.csr'</code> - файл с запросом клиентского сертификата.</li><li><code>-CA '_CA.crt'</code> - файл с сертификатом центра сертификации.</li><li><code>-CAkey '_CA.key'</code> - файл с ключом центра сертификации.</li><li><code>-days '3650'</code> - количество дней, по прошествии которого клиентский сертификат станет недействительным.</li><li><code>-out 'client.crt'</code> - название создаваемого файла с клиентским сертификатом.</li></ul><h3 id=экспорт-сертификата><a class=link-body-emphasis href=#%d1%8d%d0%ba%d1%81%d0%bf%d0%be%d1%80%d1%82-%d1%81%d0%b5%d1%80%d1%82%d0%b8%d1%84%d0%b8%d0%ba%d0%b0%d1%82%d0%b0>Экспорт сертификата</a></h3><p>Для того, чтобы импортировать сертификат на клиентские устройства, его необходимо экспортировать в формат <code>P12</code>. <code>P12</code> является контейнером, в котором содержится приватный ключ сертификата и сам сертификат.</p><div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-4
shortcode-codeblock-bash"><div class="d-flex overflow-hidden"><div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body" id=cp-a207e2a99d89f39c0630404f3a9ac0b6 data-bs-theme=dark><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>openssl pkcs12 -export -inkey <span class=s1>&#39;client.key&#39;</span> -in <span class=s1>&#39;client.crt&#39;</span> -out <span class=s1>&#39;client.p12&#39;</span></span></span></code></pre></td></tr></table></div></div></div><div class=flex-shrink-0><ul class="list-inline mb-0"><li class=list-inline-item data-bs-tooltip data-bs-title=Копировать><a class=text-body href=# data-fn=clipboard data-clipboard-target=#cp-a207e2a99d89f39c0630404f3a9ac0b6 role=button aria-label=Копировать><i class="fas fa-copy fa-fw"></i></a></li></ul></div></div></div><p>Где:</p><ul><li><code>-inkey 'client.key'</code> - файл с приватным клиентским ключом.</li><li><code>-in 'client.crt'</code> - файл с клиентским сертификатом.</li><li><code>-out 'client.p12'</code> - название создаваемого файла-контейнера с приватным ключом и сертификатом.</li></ul><h3 id=верификация-сертификата><a class=link-body-emphasis href=#%d0%b2%d0%b5%d1%80%d0%b8%d1%84%d0%b8%d0%ba%d0%b0%d1%86%d0%b8%d1%8f-%d1%81%d0%b5%d1%80%d1%82%d0%b8%d1%84%d0%b8%d0%ba%d0%b0%d1%82%d0%b0>Верификация сертификата</a></h3><div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-5
shortcode-codeblock-bash"><div class="d-flex overflow-hidden"><div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body" id=cp-88e5db3e58d3f6e220a0f52f57819293 data-bs-theme=dark><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>openssl verify -CAfile <span class=s1>&#39;_CA.crt&#39;</span> <span class=s1>&#39;client.crt&#39;</span></span></span></code></pre></td></tr></table></div></div></div><div class=flex-shrink-0><ul class="list-inline mb-0"><li class=list-inline-item data-bs-tooltip data-bs-title=Копировать><a class=text-body href=# data-fn=clipboard data-clipboard-target=#cp-88e5db3e58d3f6e220a0f52f57819293 role=button aria-label=Копировать><i class="fas fa-copy fa-fw"></i></a></li></ul></div></div></div><ul><li><code>-CAfile '_CA.crt'</code> - файл с сертификатом центра сертификации.</li><li><code>'client.crt'</code> - файл с клиентским сертификатом.</li></ul><h3 id=просмотр-сертификата><a class=link-body-emphasis href=#%d0%bf%d1%80%d0%be%d1%81%d0%bc%d0%be%d1%82%d1%80-%d1%81%d0%b5%d1%80%d1%82%d0%b8%d1%84%d0%b8%d0%ba%d0%b0%d1%82%d0%b0>Просмотр сертификата</a></h3><div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-6
shortcode-codeblock-bash"><div class="d-flex overflow-hidden"><div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body" id=cp-81b8eab6f697ef3325a621fecbe2be3c data-bs-theme=dark><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>openssl x509 -in <span class=s1>&#39;client.crt&#39;</span> -text</span></span></code></pre></td></tr></table></div></div></div><div class=flex-shrink-0><ul class="list-inline mb-0"><li class=list-inline-item data-bs-tooltip data-bs-title=Копировать><a class=text-body href=# data-fn=clipboard data-clipboard-target=#cp-81b8eab6f697ef3325a621fecbe2be3c role=button aria-label=Копировать><i class="fas fa-copy fa-fw"></i></a></li></ul></div></div></div><p>Где:</p><ul><li><code>-in 'client.crt'</code> - файл с клиентским сертификатом.</li></ul><p>При выполнении команды, терминал покажет информацию со всеми основными сведениями о сертификате (пример ниже).</p><div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-7 shortcode-codeblock-terminal
shortcode-codeblock-terminal-linux
shortcode-codeblock-terminal-linux-user"><div class="card overflow-hidden" data-bs-theme=dark><div class=card-header><div class="d-flex align-items-center"><div class=flex-shrink-0><i class="fas fa-terminal fa-fw"></i></div><div class="flex-grow-1 mx-2"><h5 class=mb-0>Терминал</h5></div><div class=flex-shrink-0><ul class="list-inline mb-0"><li class=list-inline-item data-bs-tooltip data-bs-title=Копировать><a class=text-body href=# data-fn=clipboard data-clipboard-target=#cp-168584d25778db4ef4059fa110d71aca role=button aria-label=Копировать><i class="fas fa-copy fa-fw"></i></a></li></ul></div></div></div><div class="card-body p-0 overflow-auto" id=cp-168584d25778db4ef4059fa110d71aca><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-plaintext data-lang=plaintext><span class=line><span class=cl>openssl x509 -in &#39;client.crt&#39; -text
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Certificate:
</span></span><span class=line><span class=cl>    Data:
</span></span><span class=line><span class=cl>        Version: 1 (0x0)
</span></span><span class=line><span class=cl>        Serial Number:
</span></span><span class=line><span class=cl>            49:14:b8:78:17:a1:ca:c4:6a:41:1b:23:f3:8a:8d:36:e0:9e:69:81
</span></span><span class=line><span class=cl>        Signature Algorithm: ecdsa-with-SHA256
</span></span><span class=line><span class=cl>        Issuer: C = AU, ST = Some-State, O = Internet Widgits Pty Ltd, CN = CA
</span></span><span class=line><span class=cl>        Validity
</span></span><span class=line><span class=cl>            Not Before: Oct 18 21:31:53 2023 GMT
</span></span><span class=line><span class=cl>            Not After : Oct 15 21:31:53 2033 GMT
</span></span><span class=line><span class=cl>        Subject: C = AU, ST = Some-State, O = Internet Widgits Pty Ltd, CN = CN-FQDN, emailAddress = mail@example.com
</span></span><span class=line><span class=cl>        Subject Public Key Info:
</span></span><span class=line><span class=cl>            Public Key Algorithm: id-ecPublicKey
</span></span><span class=line><span class=cl>                Public-Key: (256 bit)
</span></span><span class=line><span class=cl>                pub:
</span></span><span class=line><span class=cl>                    04:9f:22:91:cc:14:b3:75:ad:44:cc:0d:96:0d:19:
</span></span><span class=line><span class=cl>                    04:c4:20:79:fd:b7:f5:65:64:dd:65:a1:f0:b8:2d:
</span></span><span class=line><span class=cl>                    e4:02:75:62:41:03:7c:6e:2f:48:e4:11:38:dc:ed:
</span></span><span class=line><span class=cl>                    08:1f:4c:fa:5f:2f:a2:f5:5d:51:2e:8e:de:de:70:
</span></span><span class=line><span class=cl>                    33:aa:e5:3b:95
</span></span><span class=line><span class=cl>                ASN1 OID: prime256v1
</span></span><span class=line><span class=cl>                NIST CURVE: P-256
</span></span><span class=line><span class=cl>    Signature Algorithm: ecdsa-with-SHA256
</span></span><span class=line><span class=cl>         30:64:02:30:0d:ff:b1:dc:8b:a6:c6:9c:ad:65:8a:7c:01:41:
</span></span><span class=line><span class=cl>         9f:91:ca:24:4c:0b:28:5a:5c:f6:35:2a:b2:d7:58:ca:39:da:
</span></span><span class=line><span class=cl>         6c:bf:cf:8b:23:20:ce:11:45:13:61:36:e2:23:4a:e9:02:30:
</span></span><span class=line><span class=cl>         54:dc:45:ed:ef:21:58:ea:c7:b6:63:db:a2:d9:71:fe:3d:b3:
</span></span><span class=line><span class=cl>         d6:1e:15:82:7b:c8:e8:08:33:d5:2f:d5:f2:8f:3b:41:ea:53:
</span></span><span class=line><span class=cl>         1e:2d:a9:1e:9e:25:9c:fb:a7:12:f9:ec</span></span></code></pre></td></tr></table></div></div></div></div></div><h3 id=просмотр-запроса-на-подпись-сертификата><a class=link-body-emphasis href=#%d0%bf%d1%80%d0%be%d1%81%d0%bc%d0%be%d1%82%d1%80-%d0%b7%d0%b0%d0%bf%d1%80%d0%be%d1%81%d0%b0-%d0%bd%d0%b0-%d0%bf%d0%be%d0%b4%d0%bf%d0%b8%d1%81%d1%8c-%d1%81%d0%b5%d1%80%d1%82%d0%b8%d1%84%d0%b8%d0%ba%d0%b0%d1%82%d0%b0>Просмотр запроса на подпись сертификата</a></h3><div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-8
shortcode-codeblock-bash"><div class="d-flex overflow-hidden"><div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body" id=cp-36fa52535ecbb7b81cf81eb1f1f9748a data-bs-theme=dark><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>openssl req -in <span class=s1>&#39;client.csr&#39;</span> -text</span></span></code></pre></td></tr></table></div></div></div><div class=flex-shrink-0><ul class="list-inline mb-0"><li class=list-inline-item data-bs-tooltip data-bs-title=Копировать><a class=text-body href=# data-fn=clipboard data-clipboard-target=#cp-36fa52535ecbb7b81cf81eb1f1f9748a role=button aria-label=Копировать><i class="fas fa-copy fa-fw"></i></a></li></ul></div></div></div><p>Где:</p><ul><li><code>-in 'client.csr'</code> - файл с запросом на подпись клиентского сертификата.</li></ul><p>Команда выдаст информацию по запросу на подпись клиентского сертификата (пример ниже).</p><div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-9 shortcode-codeblock-terminal
shortcode-codeblock-terminal-linux
shortcode-codeblock-terminal-linux-user"><div class="card overflow-hidden" data-bs-theme=dark><div class=card-header><div class="d-flex align-items-center"><div class=flex-shrink-0><i class="fas fa-terminal fa-fw"></i></div><div class="flex-grow-1 mx-2"><h5 class=mb-0>Терминал</h5></div><div class=flex-shrink-0><ul class="list-inline mb-0"><li class=list-inline-item data-bs-tooltip data-bs-title=Копировать><a class=text-body href=# data-fn=clipboard data-clipboard-target=#cp-e0fe93a2492e6a399e47730af090878a role=button aria-label=Копировать><i class="fas fa-copy fa-fw"></i></a></li></ul></div></div></div><div class="card-body p-0 overflow-auto" id=cp-e0fe93a2492e6a399e47730af090878a><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-plaintext data-lang=plaintext><span class=line><span class=cl>openssl req -in &#39;client.csr&#39; -text
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Certificate Request:
</span></span><span class=line><span class=cl>    Data:
</span></span><span class=line><span class=cl>        Version: 1 (0x0)
</span></span><span class=line><span class=cl>        Subject: C = AU, ST = Some-State, O = Internet Widgits Pty Ltd, CN = CN-FQDN, emailAddress = mail@example.com
</span></span><span class=line><span class=cl>        Subject Public Key Info:
</span></span><span class=line><span class=cl>            Public Key Algorithm: id-ecPublicKey
</span></span><span class=line><span class=cl>                Public-Key: (256 bit)
</span></span><span class=line><span class=cl>                pub:
</span></span><span class=line><span class=cl>                    04:9f:22:91:cc:14:b3:75:ad:44:cc:0d:96:0d:19:
</span></span><span class=line><span class=cl>                    04:c4:20:79:fd:b7:f5:65:64:dd:65:a1:f0:b8:2d:
</span></span><span class=line><span class=cl>                    e4:02:75:62:41:03:7c:6e:2f:48:e4:11:38:dc:ed:
</span></span><span class=line><span class=cl>                    08:1f:4c:fa:5f:2f:a2:f5:5d:51:2e:8e:de:de:70:
</span></span><span class=line><span class=cl>                    33:aa:e5:3b:95
</span></span><span class=line><span class=cl>                ASN1 OID: prime256v1
</span></span><span class=line><span class=cl>                NIST CURVE: P-256
</span></span><span class=line><span class=cl>        Attributes:
</span></span><span class=line><span class=cl>            a0:00
</span></span><span class=line><span class=cl>        Requested Extensions:
</span></span><span class=line><span class=cl>    Signature Algorithm: ecdsa-with-SHA256
</span></span><span class=line><span class=cl>         30:45:02:20:51:9c:a0:b9:b2:61:7f:fa:64:ea:34:1f:65:15:
</span></span><span class=line><span class=cl>         37:ae:f4:89:30:47:11:89:db:c4:1b:1d:9b:82:b9:64:ea:c7:
</span></span><span class=line><span class=cl>         02:21:00:f8:00:70:4e:e6:db:99:78:cf:25:22:c0:8d:c6:b1:
</span></span><span class=line><span class=cl>         f3:f0:d8:68:3b:c2:51:21:a5:b3:fa:97:f9:85:c6:9c:49</span></span></code></pre></td></tr></table></div></div></div></div></div><h2 id=автоматизация><a class=link-body-emphasis href=#%d0%b0%d0%b2%d1%82%d0%be%d0%bc%d0%b0%d1%82%d0%b8%d0%b7%d0%b0%d1%86%d0%b8%d1%8f>Автоматизация</a></h2><p>Команд много. Поэтому я как обычно, решил всё автоматизировать и загнать в скрипт.</p><div class="shortcode shortcode-file mb-3"><div class="card overflow-hidden" data-bs-theme=dark><div class=card-header><div class="d-flex align-items-center"><div class=flex-shrink-0><i class="far fa-file-code fa-fw"></i></div><div class="flex-grow-1 mx-2 text-truncate"><code>bash.openssl.ca.sh</code></div><div class=flex-shrink-0><ul class="list-inline mb-0"><li class=list-inline-item data-bs-tooltip data-bs-title=Копировать><a class=text-body href=# data-fn=clipboard data-clipboard-target=#cp-ffe6f4561e772840dc709a845bd78e0f role=button aria-label=Копировать><i class="fas fa-copy fa-fw"></i></a></li><li class=list-inline-item data-bs-tooltip data-bs-title=Скачать><a class=text-body href=/ru/2023/10/6733cb51-62a0-5ed9-b421-8f08c4e0cb18/bash.openssl.ca.sh download role=button aria-label=Скачать><i class="fas fa-download fa-fw"></i></a></li><li class=list-inline-item data-bs-tooltip data-bs-title=Открыть><a class=text-body href=/ru/2023/10/6733cb51-62a0-5ed9-b421-8f08c4e0cb18/bash.openssl.ca.sh target=_blank role=button aria-label=Открыть><i class="fas fa-arrow-up-right-from-square fa-fw"></i></a></li></ul></div></div></div><div class="card-body p-0 overflow-auto" id=cp-ffe6f4561e772840dc709a845bd78e0f><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>  1
</span><span class=lnt>  2
</span><span class=lnt>  3
</span><span class=lnt>  4
</span><span class=lnt>  5
</span><span class=lnt>  6
</span><span class=lnt>  7
</span><span class=lnt>  8
</span><span class=lnt>  9
</span><span class=lnt> 10
</span><span class=lnt> 11
</span><span class=lnt> 12
</span><span class=lnt> 13
</span><span class=lnt> 14
</span><span class=lnt> 15
</span><span class=lnt> 16
</span><span class=lnt> 17
</span><span class=lnt> 18
</span><span class=lnt> 19
</span><span class=lnt> 20
</span><span class=lnt> 21
</span><span class=lnt> 22
</span><span class=lnt> 23
</span><span class=lnt> 24
</span><span class=lnt> 25
</span><span class=lnt> 26
</span><span class=lnt> 27
</span><span class=lnt> 28
</span><span class=lnt> 29
</span><span class=lnt> 30
</span><span class=lnt> 31
</span><span class=lnt> 32
</span><span class=lnt> 33
</span><span class=lnt> 34
</span><span class=lnt> 35
</span><span class=lnt> 36
</span><span class=lnt> 37
</span><span class=lnt> 38
</span><span class=lnt> 39
</span><span class=lnt> 40
</span><span class=lnt> 41
</span><span class=lnt> 42
</span><span class=lnt> 43
</span><span class=lnt> 44
</span><span class=lnt> 45
</span><span class=lnt> 46
</span><span class=lnt> 47
</span><span class=lnt> 48
</span><span class=lnt> 49
</span><span class=lnt> 50
</span><span class=lnt> 51
</span><span class=lnt> 52
</span><span class=lnt> 53
</span><span class=lnt> 54
</span><span class=lnt> 55
</span><span class=lnt> 56
</span><span class=lnt> 57
</span><span class=lnt> 58
</span><span class=lnt> 59
</span><span class=lnt> 60
</span><span class=lnt> 61
</span><span class=lnt> 62
</span><span class=lnt> 63
</span><span class=lnt> 64
</span><span class=lnt> 65
</span><span class=lnt> 66
</span><span class=lnt> 67
</span><span class=lnt> 68
</span><span class=lnt> 69
</span><span class=lnt> 70
</span><span class=lnt> 71
</span><span class=lnt> 72
</span><span class=lnt> 73
</span><span class=lnt> 74
</span><span class=lnt> 75
</span><span class=lnt> 76
</span><span class=lnt> 77
</span><span class=lnt> 78
</span><span class=lnt> 79
</span><span class=lnt> 80
</span><span class=lnt> 81
</span><span class=lnt> 82
</span><span class=lnt> 83
</span><span class=lnt> 84
</span><span class=lnt> 85
</span><span class=lnt> 86
</span><span class=lnt> 87
</span><span class=lnt> 88
</span><span class=lnt> 89
</span><span class=lnt> 90
</span><span class=lnt> 91
</span><span class=lnt> 92
</span><span class=lnt> 93
</span><span class=lnt> 94
</span><span class=lnt> 95
</span><span class=lnt> 96
</span><span class=lnt> 97
</span><span class=lnt> 98
</span><span class=lnt> 99
</span><span class=lnt>100
</span><span class=lnt>101
</span><span class=lnt>102
</span><span class=lnt>103
</span><span class=lnt>104
</span><span class=lnt>105
</span><span class=lnt>106
</span><span class=lnt>107
</span><span class=lnt>108
</span><span class=lnt>109
</span><span class=lnt>110
</span><span class=lnt>111
</span><span class=lnt>112
</span><span class=lnt>113
</span><span class=lnt>114
</span><span class=lnt>115
</span><span class=lnt>116
</span><span class=lnt>117
</span><span class=lnt>118
</span><span class=lnt>119
</span><span class=lnt>120
</span><span class=lnt>121
</span><span class=lnt>122
</span><span class=lnt>123
</span><span class=lnt>124
</span><span class=lnt>125
</span><span class=lnt>126
</span><span class=lnt>127
</span><span class=lnt>128
</span><span class=lnt>129
</span><span class=lnt>130
</span><span class=lnt>131
</span><span class=lnt>132
</span><span class=lnt>133
</span><span class=lnt>134
</span><span class=lnt>135
</span><span class=lnt>136
</span><span class=lnt>137
</span><span class=lnt>138
</span><span class=lnt>139
</span><span class=lnt>140
</span><span class=lnt>141
</span><span class=lnt>142
</span><span class=lnt>143
</span><span class=lnt>144
</span><span class=lnt>145
</span><span class=lnt>146
</span><span class=lnt>147
</span><span class=lnt>148
</span><span class=lnt>149
</span><span class=lnt>150
</span><span class=lnt>151
</span><span class=lnt>152
</span><span class=lnt>153
</span><span class=lnt>154
</span><span class=lnt>155
</span><span class=lnt>156
</span><span class=lnt>157
</span><span class=lnt>158
</span><span class=lnt>159
</span><span class=lnt>160
</span><span class=lnt>161
</span><span class=lnt>162
</span><span class=lnt>163
</span><span class=lnt>164
</span><span class=lnt>165
</span><span class=lnt>166
</span><span class=lnt>167
</span><span class=lnt>168
</span><span class=lnt>169
</span><span class=lnt>170
</span><span class=lnt>171
</span><span class=lnt>172
</span><span class=lnt>173
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-sh data-lang=sh><span class=line><span class=cl><span class=cp>#!/usr/bin/env -S bash -e
</span></span></span><span class=line><span class=cl><span class=cp></span><span class=c1>#</span>
</span></span><span class=line><span class=cl><span class=c1># OpenSSL certificate generator with CA.</span>
</span></span><span class=line><span class=cl><span class=c1>#</span>
</span></span><span class=line><span class=cl><span class=c1># @package    Bash</span>
</span></span><span class=line><span class=cl><span class=c1># @author     Kai Kimera &lt;mail@kai.kim&gt;</span>
</span></span><span class=line><span class=cl><span class=c1># @copyright  2023 Library Online</span>
</span></span><span class=line><span class=cl><span class=c1># @license    MIT</span>
</span></span><span class=line><span class=cl><span class=c1># @version    0.1.2</span>
</span></span><span class=line><span class=cl><span class=c1># @link       https://lib.onl/ru/articles/2023/10/6733cb51-62a0-5ed9-b421-8f08c4e0cb18/</span>
</span></span><span class=line><span class=cl><span class=c1># -------------------------------------------------------------------------------------------------------------------- #</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=o>((</span> <span class=nv>EUID</span> <span class=o>==</span> <span class=m>0</span> <span class=o>))</span> <span class=o>&amp;&amp;</span> <span class=o>{</span> <span class=nb>echo</span> &gt;<span class=p>&amp;</span><span class=m>2</span> <span class=s1>&#39;This script should not be run as root!&#39;</span><span class=p>;</span> <span class=nb>exit</span> 1<span class=p>;</span> <span class=o>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># -------------------------------------------------------------------------------------------------------------------- #</span>
</span></span><span class=line><span class=cl><span class=c1># CONFIGURATION.</span>
</span></span><span class=line><span class=cl><span class=c1># -------------------------------------------------------------------------------------------------------------------- #</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Get &#39;cat&#39; command.</span>
</span></span><span class=line><span class=cl><span class=nv>cat</span><span class=o>=</span><span class=s2>&#34;</span><span class=k>$(</span> <span class=nb>command</span> -v cat <span class=k>)</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Get &#39;date&#39; command.</span>
</span></span><span class=line><span class=cl><span class=nv>date</span><span class=o>=</span><span class=s2>&#34;</span><span class=k>$(</span> <span class=nb>command</span> -v date <span class=k>)</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Get &#39;mkdir&#39; command.</span>
</span></span><span class=line><span class=cl><span class=nv>mkdir</span><span class=o>=</span><span class=s2>&#34;</span><span class=k>$(</span> <span class=nb>command</span> -v mkdir <span class=k>)</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Get &#39;openssl&#39; command.</span>
</span></span><span class=line><span class=cl><span class=nv>ossl</span><span class=o>=</span><span class=s2>&#34;</span><span class=k>$(</span> <span class=nb>command</span> -v openssl <span class=k>)</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Get &#39;shuf&#39; command.</span>
</span></span><span class=line><span class=cl><span class=nv>shuf</span><span class=o>=</span><span class=s2>&#34;</span><span class=k>$(</span> <span class=nb>command</span> -v shuf <span class=k>)</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># CA file names.</span>
</span></span><span class=line><span class=cl><span class=nv>ca</span><span class=o>=</span><span class=s1>&#39;_CA&#39;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Specifies the number of days to make a certificate valid for.</span>
</span></span><span class=line><span class=cl><span class=c1># Default is 10 years.</span>
</span></span><span class=line><span class=cl><span class=nv>days</span><span class=o>=</span><span class=s1>&#39;3650&#39;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># The two-letter country code where your company is legally located.</span>
</span></span><span class=line><span class=cl><span class=nv>country</span><span class=o>=</span><span class=s1>&#39;RU&#39;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># The state/province where your company is legally located.</span>
</span></span><span class=line><span class=cl><span class=nv>state</span><span class=o>=</span><span class=s1>&#39;Russia&#39;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># The city where your company is legally located.</span>
</span></span><span class=line><span class=cl><span class=nv>city</span><span class=o>=</span><span class=s1>&#39;Moscow&#39;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Your company&#39;s legally registered name (e.g., YourCompany, Inc.).</span>
</span></span><span class=line><span class=cl><span class=nv>org</span><span class=o>=</span><span class=s1>&#39;YourCompany&#39;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Timestamp.</span>
</span></span><span class=line><span class=cl><span class=nv>ts</span><span class=o>=</span><span class=s2>&#34;</span><span class=k>$(</span> <span class=si>${</span><span class=nv>date</span><span class=si>}</span> -u <span class=s1>&#39;+%s&#39;</span> <span class=k>)</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Suffix.</span>
</span></span><span class=line><span class=cl><span class=nv>sfx</span><span class=o>=</span><span class=k>$(</span> <span class=si>${</span><span class=nv>shuf</span><span class=si>}</span> -i <span class=s1>&#39;1000-9999&#39;</span> -n <span class=m>1</span> --random-source<span class=o>=</span><span class=s1>&#39;/dev/random&#39;</span> <span class=k>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># -------------------------------------------------------------------------------------------------------------------- #</span>
</span></span><span class=line><span class=cl><span class=c1># -----------------------------------------------------&lt; SCRIPT &gt;----------------------------------------------------- #</span>
</span></span><span class=line><span class=cl><span class=c1># -------------------------------------------------------------------------------------------------------------------- #</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># -------------------------------------------------------------------------------------------------------------------- #</span>
</span></span><span class=line><span class=cl><span class=c1># CERTIFICATE AUTHORITY.</span>
</span></span><span class=line><span class=cl><span class=c1># -------------------------------------------------------------------------------------------------------------------- #</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>ca<span class=o>()</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>  ! <span class=o>[[</span> -x <span class=s2>&#34;</span><span class=si>${</span><span class=nv>ossl</span><span class=si>}</span><span class=s2>&#34;</span> <span class=o>]]</span> <span class=o>&amp;&amp;</span> <span class=o>{</span> <span class=nb>echo</span> &gt;<span class=p>&amp;</span><span class=m>2</span> <span class=s2>&#34;&#39;openssl&#39; is not installed!&#34;</span><span class=p>;</span> <span class=nb>exit</span> 1<span class=p>;</span> <span class=o>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=nb>local</span> <span class=nv>name</span><span class=o>=</span><span class=s2>&#34;</span><span class=si>${</span><span class=nv>1</span><span class=k>:-</span><span class=nv>example</span><span class=p>.com</span><span class=si>}</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl>  <span class=nb>local</span> <span class=nv>email</span><span class=o>=</span><span class=s2>&#34;</span><span class=si>${</span><span class=nv>2</span><span class=k>:-</span><span class=nv>mail</span><span class=p>@example.com</span><span class=si>}</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl>  <span class=nb>local</span> <span class=nv>v3ext_ca</span><span class=o>=</span><span class=s1>&#39;_CA.v3ext&#39;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  cat &gt; <span class=s2>&#34;</span><span class=si>${</span><span class=nv>v3ext_ca</span><span class=si>}</span><span class=s2>&#34;</span> <span class=s>&lt;&lt;EOF
</span></span></span><span class=line><span class=cl><span class=s>authorityKeyIdentifier = keyid:always,issuer
</span></span></span><span class=line><span class=cl><span class=s>basicConstraints = critical, CA:TRUE
</span></span></span><span class=line><span class=cl><span class=s>keyUsage = critical, digitalSignature, cRLSign, keyCertSign
</span></span></span><span class=line><span class=cl><span class=s>EOF</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=nb>echo</span> <span class=s1>&#39;&#39;</span> <span class=o>&amp;&amp;</span> <span class=nb>echo</span> <span class=s2>&#34;--- [SSL-CA] CREATING A CA CERTIFICATE&#34;</span> <span class=o>&amp;&amp;</span> <span class=nb>echo</span> <span class=s1>&#39;&#39;</span>
</span></span><span class=line><span class=cl>  <span class=si>${</span><span class=nv>ossl</span><span class=si>}</span> ecparam -genkey -name <span class=s1>&#39;secp384r1&#39;</span> <span class=p>|</span> <span class=si>${</span><span class=nv>ossl</span><span class=si>}</span> ec -aes256 -out <span class=s2>&#34;</span><span class=si>${</span><span class=nv>ca</span><span class=si>}</span><span class=s2>.key&#34;</span> <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>    <span class=o>&amp;&amp;</span> <span class=si>${</span><span class=nv>ossl</span><span class=si>}</span> req -new -sha384 -key <span class=s2>&#34;</span><span class=si>${</span><span class=nv>ca</span><span class=si>}</span><span class=s2>.key&#34;</span> -out <span class=s2>&#34;</span><span class=si>${</span><span class=nv>ca</span><span class=si>}</span><span class=s2>.csr&#34;</span> <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>    -subj <span class=s2>&#34;/C=</span><span class=si>${</span><span class=nv>country</span><span class=si>}</span><span class=s2>/ST=</span><span class=si>${</span><span class=nv>state</span><span class=si>}</span><span class=s2>/L=</span><span class=si>${</span><span class=nv>city</span><span class=si>}</span><span class=s2>/O=</span><span class=si>${</span><span class=nv>org</span><span class=si>}</span><span class=s2>/emailAddress=</span><span class=si>${</span><span class=nv>email</span><span class=si>}</span><span class=s2>/CN=</span><span class=si>${</span><span class=nv>name</span><span class=si>}</span><span class=s2>&#34;</span> <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>    <span class=o>&amp;&amp;</span> <span class=si>${</span><span class=nv>ossl</span><span class=si>}</span> x509 -req -extfile <span class=s2>&#34;</span><span class=si>${</span><span class=nv>v3ext_ca</span><span class=si>}</span><span class=s2>&#34;</span> -sha384 -days <span class=si>${</span><span class=nv>days</span><span class=si>}</span> -key <span class=s2>&#34;</span><span class=si>${</span><span class=nv>ca</span><span class=si>}</span><span class=s2>.key&#34;</span> -in <span class=s2>&#34;</span><span class=si>${</span><span class=nv>ca</span><span class=si>}</span><span class=s2>.csr&#34;</span> -out <span class=s2>&#34;</span><span class=si>${</span><span class=nv>ca</span><span class=si>}</span><span class=s2>.crt&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    _info <span class=s2>&#34;</span><span class=si>${</span><span class=nv>ca</span><span class=si>}</span><span class=s2>.crt&#34;</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># -------------------------------------------------------------------------------------------------------------------- #</span>
</span></span><span class=line><span class=cl><span class=c1># CLIENT CERTIFICATE.</span>
</span></span><span class=line><span class=cl><span class=c1># -------------------------------------------------------------------------------------------------------------------- #</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>cert<span class=o>()</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>  <span class=k>for</span> i in <span class=s2>&#34;</span><span class=si>${</span><span class=nv>mkdir</span><span class=si>}</span><span class=s2>&#34;</span> <span class=s2>&#34;</span><span class=si>${</span><span class=nv>ossl</span><span class=si>}</span><span class=s2>&#34;</span> <span class=s2>&#34;</span><span class=si>${</span><span class=nv>shuf</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>;</span> <span class=k>do</span>
</span></span><span class=line><span class=cl>    ! <span class=o>[[</span> -x <span class=s2>&#34;</span><span class=si>${</span><span class=nv>i</span><span class=si>}</span><span class=s2>&#34;</span> <span class=o>]]</span> <span class=o>&amp;&amp;</span> <span class=o>{</span> <span class=nb>echo</span> &gt;<span class=p>&amp;</span><span class=m>2</span> <span class=s2>&#34;&#39;</span><span class=si>${</span><span class=nv>i</span><span class=si>}</span><span class=s2>&#39; is not installed!&#34;</span><span class=p>;</span> <span class=nb>exit</span> 1<span class=p>;</span> <span class=o>}</span>
</span></span><span class=line><span class=cl>  <span class=k>done</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=nb>local</span> <span class=nv>name</span><span class=o>=</span><span class=s2>&#34;</span><span class=si>${</span><span class=nv>1</span><span class=k>:-</span><span class=nv>example</span><span class=p>.com</span><span class=si>}</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl>  <span class=nb>local</span> <span class=nv>email</span><span class=o>=</span><span class=s2>&#34;</span><span class=si>${</span><span class=nv>2</span><span class=k>:-</span><span class=nv>mail</span><span class=p>@example.com</span><span class=si>}</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl>  <span class=nb>local</span> <span class=nv>type</span><span class=o>=</span><span class=s2>&#34;</span><span class=si>${</span><span class=nv>3</span><span class=k>:-</span><span class=nv>server</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>;</span> <span class=o>[[</span> <span class=s2>&#34;</span><span class=si>${</span><span class=nv>name</span><span class=si>}</span><span class=s2>&#34;</span> <span class=o>=</span> *<span class=s1>&#39; &#39;</span>* <span class=o>]]</span> <span class=o>&amp;&amp;</span> <span class=nv>type</span><span class=o>=</span><span class=s1>&#39;client&#39;</span>
</span></span><span class=line><span class=cl>  <span class=nb>local</span> <span class=nv>dir</span><span class=o>=</span><span class=s2>&#34;</span><span class=si>${</span><span class=nv>type</span><span class=si>}</span><span class=s2>/</span><span class=si>${</span><span class=nv>name</span><span class=p>// /_</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>;</span> <span class=si>${</span><span class=nv>mkdir</span><span class=si>}</span> -p <span class=s2>&#34;</span><span class=si>${</span><span class=nv>dir</span><span class=si>}</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl>  <span class=nb>local</span> <span class=nv>file</span><span class=o>=</span><span class=s2>&#34;</span><span class=si>${</span><span class=nv>dir</span><span class=si>}</span><span class=s2>/</span><span class=si>${</span><span class=nv>email</span><span class=si>}</span><span class=s2>.</span><span class=si>${</span><span class=nv>ts</span><span class=si>}</span><span class=s2>.</span><span class=si>${</span><span class=nv>sfx</span><span class=si>}</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=nb>local</span> v3ext
</span></span><span class=line><span class=cl>  <span class=k>if</span> <span class=o>[[</span> <span class=s2>&#34;</span><span class=si>${</span><span class=nv>type</span><span class=si>}</span><span class=s2>&#34;</span> <span class=o>=</span> <span class=s1>&#39;client&#39;</span> <span class=o>]]</span><span class=p>;</span> <span class=k>then</span>
</span></span><span class=line><span class=cl>    <span class=nv>v3ext</span><span class=o>=</span><span class=k>$(</span> _v3ext_client <span class=s2>&#34;</span><span class=si>${</span><span class=nv>file</span><span class=si>}</span><span class=s2>.v3ext&#34;</span> <span class=k>)</span>
</span></span><span class=line><span class=cl>  <span class=k>else</span>
</span></span><span class=line><span class=cl>    <span class=nv>v3ext</span><span class=o>=</span><span class=k>$(</span> _v3ext_server <span class=s2>&#34;</span><span class=si>${</span><span class=nv>file</span><span class=si>}</span><span class=s2>.v3ext&#34;</span> <span class=s2>&#34;</span><span class=si>${</span><span class=nv>name</span><span class=si>}</span><span class=s2>&#34;</span> <span class=k>)</span>
</span></span><span class=line><span class=cl>  <span class=k>fi</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=nb>echo</span> <span class=s1>&#39;&#39;</span> <span class=o>&amp;&amp;</span> <span class=nb>echo</span> <span class=s2>&#34;--- [SSL] CREATING A </span><span class=si>${</span><span class=nv>type</span><span class=p>^^</span><span class=si>}</span><span class=s2> CERTIFICATE&#34;</span> <span class=o>&amp;&amp;</span> <span class=nb>echo</span> <span class=s1>&#39;&#39;</span>
</span></span><span class=line><span class=cl>  <span class=si>${</span><span class=nv>ossl</span><span class=si>}</span> ecparam -genkey -name <span class=s1>&#39;prime256v1&#39;</span> <span class=p>|</span> <span class=si>${</span><span class=nv>ossl</span><span class=si>}</span> ec -out <span class=s2>&#34;</span><span class=si>${</span><span class=nv>file</span><span class=si>}</span><span class=s2>.key&#34;</span> <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>    <span class=o>&amp;&amp;</span> <span class=si>${</span><span class=nv>ossl</span><span class=si>}</span> req -new -key <span class=s2>&#34;</span><span class=si>${</span><span class=nv>file</span><span class=si>}</span><span class=s2>.key&#34;</span> -out <span class=s2>&#34;</span><span class=si>${</span><span class=nv>file</span><span class=si>}</span><span class=s2>.csr&#34;</span> <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>    -subj <span class=s2>&#34;/C=</span><span class=si>${</span><span class=nv>country</span><span class=si>}</span><span class=s2>/ST=</span><span class=si>${</span><span class=nv>state</span><span class=si>}</span><span class=s2>/L=</span><span class=si>${</span><span class=nv>city</span><span class=si>}</span><span class=s2>/O=</span><span class=si>${</span><span class=nv>org</span><span class=si>}</span><span class=s2>/emailAddress=</span><span class=si>${</span><span class=nv>email</span><span class=si>}</span><span class=s2>/CN=</span><span class=si>${</span><span class=nv>name</span><span class=si>}</span><span class=s2>&#34;</span> <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>    <span class=o>&amp;&amp;</span> <span class=si>${</span><span class=nv>ossl</span><span class=si>}</span> x509 -req -extfile <span class=s2>&#34;</span><span class=si>${</span><span class=nv>v3ext</span><span class=si>}</span><span class=s2>&#34;</span> -days <span class=si>${</span><span class=nv>days</span><span class=si>}</span> -in <span class=s2>&#34;</span><span class=si>${</span><span class=nv>file</span><span class=si>}</span><span class=s2>.csr&#34;</span> <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>    -CA <span class=s2>&#34;</span><span class=si>${</span><span class=nv>ca</span><span class=si>}</span><span class=s2>.crt&#34;</span> -CAkey <span class=s2>&#34;</span><span class=si>${</span><span class=nv>ca</span><span class=si>}</span><span class=s2>.key&#34;</span> -CAcreateserial -CAserial <span class=s2>&#34;</span><span class=si>${</span><span class=nv>file</span><span class=si>}</span><span class=s2>.srl&#34;</span> -out <span class=s2>&#34;</span><span class=si>${</span><span class=nv>file</span><span class=si>}</span><span class=s2>.crt&#34;</span> <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>    <span class=o>&amp;&amp;</span> <span class=si>${</span><span class=nv>cat</span><span class=si>}</span> <span class=s2>&#34;</span><span class=si>${</span><span class=nv>file</span><span class=si>}</span><span class=s2>.key&#34;</span> <span class=s2>&#34;</span><span class=si>${</span><span class=nv>file</span><span class=si>}</span><span class=s2>.crt&#34;</span> <span class=s2>&#34;</span><span class=si>${</span><span class=nv>ca</span><span class=si>}</span><span class=s2>.crt&#34;</span> &gt; <span class=s2>&#34;</span><span class=si>${</span><span class=nv>file</span><span class=si>}</span><span class=s2>.crt.chain&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  _verify <span class=s2>&#34;</span><span class=si>${</span><span class=nv>ca</span><span class=si>}</span><span class=s2>.crt&#34;</span> <span class=s2>&#34;</span><span class=si>${</span><span class=nv>file</span><span class=si>}</span><span class=s2>.crt&#34;</span> <span class=o>&amp;&amp;</span> _info <span class=s2>&#34;</span><span class=si>${</span><span class=nv>file</span><span class=si>}</span><span class=s2>.crt&#34;</span> <span class=o>&amp;&amp;</span> _export <span class=s2>&#34;</span><span class=si>${</span><span class=nv>file</span><span class=si>}</span><span class=s2>.key&#34;</span> <span class=s2>&#34;</span><span class=si>${</span><span class=nv>file</span><span class=si>}</span><span class=s2>.crt&#34;</span> <span class=s2>&#34;</span><span class=si>${</span><span class=nv>file</span><span class=si>}</span><span class=s2>.p12&#34;</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>_verify<span class=o>()</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>  <span class=nb>echo</span> <span class=s1>&#39;&#39;</span> <span class=o>&amp;&amp;</span> <span class=nb>echo</span> <span class=s2>&#34;--- [SSL] CERTIFICATE VERIFICATION&#34;</span> <span class=o>&amp;&amp;</span> <span class=nb>echo</span> <span class=s1>&#39;&#39;</span>
</span></span><span class=line><span class=cl>  <span class=k>for</span> i in <span class=s2>&#34;</span><span class=si>${</span><span class=nv>1</span><span class=si>}</span><span class=s2>&#34;</span> <span class=s2>&#34;</span><span class=si>${</span><span class=nv>2</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>;</span> <span class=k>do</span> <span class=o>[[</span> ! -f <span class=s2>&#34;</span><span class=si>${</span><span class=nv>i</span><span class=si>}</span><span class=s2>&#34;</span> <span class=o>]]</span> <span class=o>&amp;&amp;</span> <span class=o>{</span> <span class=nb>echo</span> &gt;<span class=p>&amp;</span><span class=m>2</span> <span class=s2>&#34;&#39;</span><span class=si>${</span><span class=nv>i</span><span class=si>}</span><span class=s2>&#39; not found!&#34;</span><span class=p>;</span> <span class=nb>exit</span> 1<span class=p>;</span> <span class=o>}</span><span class=p>;</span> <span class=k>done</span>
</span></span><span class=line><span class=cl>  <span class=si>${</span><span class=nv>ossl</span><span class=si>}</span> verify -CAfile <span class=s2>&#34;</span><span class=si>${</span><span class=nv>1</span><span class=si>}</span><span class=s2>&#34;</span> <span class=s2>&#34;</span><span class=si>${</span><span class=nv>2</span><span class=si>}</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>_info<span class=o>()</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>  <span class=nb>echo</span> <span class=s1>&#39;&#39;</span> <span class=o>&amp;&amp;</span> <span class=nb>echo</span> <span class=s2>&#34;--- [SSL] CERTIFICATE DETAILS&#34;</span> <span class=o>&amp;&amp;</span> <span class=nb>echo</span> <span class=s1>&#39;&#39;</span>
</span></span><span class=line><span class=cl>  <span class=o>[[</span> ! -f <span class=s2>&#34;</span><span class=si>${</span><span class=nv>1</span><span class=si>}</span><span class=s2>&#34;</span> <span class=o>]]</span> <span class=o>&amp;&amp;</span> <span class=o>{</span> <span class=nb>echo</span> &gt;<span class=p>&amp;</span><span class=m>2</span> <span class=s2>&#34;&#39;</span><span class=si>${</span><span class=nv>i</span><span class=si>}</span><span class=s2>&#39; not found!&#34;</span><span class=p>;</span> <span class=nb>exit</span> 1<span class=p>;</span> <span class=o>}</span>
</span></span><span class=line><span class=cl>  <span class=si>${</span><span class=nv>ossl</span><span class=si>}</span> x509 -in <span class=s2>&#34;</span><span class=si>${</span><span class=nv>1</span><span class=si>}</span><span class=s2>&#34;</span> -text -noout
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>_export<span class=o>()</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>  <span class=nb>echo</span> <span class=s1>&#39;&#39;</span> <span class=o>&amp;&amp;</span> <span class=nb>echo</span> <span class=s2>&#34;--- [SSL] EXPORTING A CERTIFICATE&#34;</span> <span class=o>&amp;&amp;</span> <span class=nb>echo</span> <span class=s1>&#39;&#39;</span>
</span></span><span class=line><span class=cl>  <span class=k>for</span> i in <span class=s2>&#34;</span><span class=si>${</span><span class=nv>1</span><span class=si>}</span><span class=s2>&#34;</span> <span class=s2>&#34;</span><span class=si>${</span><span class=nv>2</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>;</span> <span class=k>do</span> <span class=o>[[</span> ! -f <span class=s2>&#34;</span><span class=si>${</span><span class=nv>i</span><span class=si>}</span><span class=s2>&#34;</span> <span class=o>]]</span> <span class=o>&amp;&amp;</span> <span class=o>{</span> <span class=nb>echo</span> &gt;<span class=p>&amp;</span><span class=m>2</span> <span class=s2>&#34;&#39;</span><span class=si>${</span><span class=nv>i</span><span class=si>}</span><span class=s2>&#39; not found!&#34;</span><span class=p>;</span> <span class=nb>exit</span> 1<span class=p>;</span> <span class=o>}</span><span class=p>;</span> <span class=k>done</span>
</span></span><span class=line><span class=cl>  <span class=si>${</span><span class=nv>ossl</span><span class=si>}</span> pkcs12 -export -inkey <span class=s2>&#34;</span><span class=si>${</span><span class=nv>1</span><span class=si>}</span><span class=s2>&#34;</span> -in <span class=s2>&#34;</span><span class=si>${</span><span class=nv>2</span><span class=si>}</span><span class=s2>&#34;</span> -out <span class=s2>&#34;</span><span class=si>${</span><span class=nv>3</span><span class=si>}</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>_v3ext_client<span class=o>()</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>  cat &gt; <span class=s2>&#34;</span><span class=si>${</span><span class=nv>1</span><span class=si>}</span><span class=s2>&#34;</span> <span class=s>&lt;&lt;EOF
</span></span></span><span class=line><span class=cl><span class=s>authorityKeyIdentifier = keyid,issuer
</span></span></span><span class=line><span class=cl><span class=s>basicConstraints = CA:FALSE
</span></span></span><span class=line><span class=cl><span class=s>extendedKeyUsage = clientAuth, emailProtection
</span></span></span><span class=line><span class=cl><span class=s>keyUsage = critical, digitalSignature, keyEncipherment, nonRepudiation
</span></span></span><span class=line><span class=cl><span class=s>nsCertType = client, email
</span></span></span><span class=line><span class=cl><span class=s>nsComment = &#34;OpenSSL Generated Client Certificate&#34;
</span></span></span><span class=line><span class=cl><span class=s>EOF</span>
</span></span><span class=line><span class=cl>  <span class=nb>echo</span> -n <span class=s2>&#34;</span><span class=si>${</span><span class=nv>1</span><span class=si>}</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>_v3ext_server<span class=o>()</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>  cat &gt; <span class=s2>&#34;</span><span class=si>${</span><span class=nv>1</span><span class=si>}</span><span class=s2>&#34;</span> <span class=s>&lt;&lt;EOF
</span></span></span><span class=line><span class=cl><span class=s>authorityKeyIdentifier = keyid,issuer:always
</span></span></span><span class=line><span class=cl><span class=s>basicConstraints = CA:FALSE
</span></span></span><span class=line><span class=cl><span class=s>extendedKeyUsage = serverAuth
</span></span></span><span class=line><span class=cl><span class=s>keyUsage = critical, digitalSignature, keyEncipherment
</span></span></span><span class=line><span class=cl><span class=s>nsCertType = server
</span></span></span><span class=line><span class=cl><span class=s>nsComment = &#34;OpenSSL Generated Server Certificate&#34;
</span></span></span><span class=line><span class=cl><span class=s>subjectAltName = @alt_names
</span></span></span><span class=line><span class=cl><span class=s>
</span></span></span><span class=line><span class=cl><span class=s>[alt_names]
</span></span></span><span class=line><span class=cl><span class=s>DNS.1 = ${2}
</span></span></span><span class=line><span class=cl><span class=s>DNS.2 = *.${2}
</span></span></span><span class=line><span class=cl><span class=s>EOF</span>
</span></span><span class=line><span class=cl>  <span class=nb>echo</span> -n <span class=s2>&#34;</span><span class=si>${</span><span class=nv>1</span><span class=si>}</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># -------------------------------------------------------------------------------------------------------------------- #</span>
</span></span><span class=line><span class=cl><span class=c1># -------------------------------------------------&lt; RUNNING SCRIPT &gt;------------------------------------------------- #</span>
</span></span><span class=line><span class=cl><span class=c1># -------------------------------------------------------------------------------------------------------------------- #</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=s2>&#34;</span><span class=nv>$@</span><span class=s2>&#34;</span></span></span></code></pre></td></tr></table></div></div></div></div></div><p>Скрипт содержит две функции, вызывать которых можно по отдельности. Функция <code>ca()</code> позволяет сгенерировать ключ и сертификат центра сертификации, а функция <code>cert()</code>, соответственно, генерирует клиентские сертификаты.</p><h3 id=использование><a class=link-body-emphasis href=#%d0%b8%d1%81%d0%bf%d0%be%d0%bb%d1%8c%d0%b7%d0%be%d0%b2%d0%b0%d0%bd%d0%b8%d0%b5>Использование</a></h3><ol><li>Создать ключ и сертификат центра сертификации:</li></ol><div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-10 shortcode-codeblock-terminal
shortcode-codeblock-terminal-linux
shortcode-codeblock-terminal-linux-user"><div class="card overflow-hidden" data-bs-theme=dark><div class=card-header><div class="d-flex align-items-center"><div class=flex-shrink-0><i class="fas fa-terminal fa-fw"></i></div><div class="flex-grow-1 mx-2"><h5 class=mb-0>Терминал</h5></div><div class=flex-shrink-0><ul class="list-inline mb-0"><li class=list-inline-item data-bs-tooltip data-bs-title=Копировать><a class=text-body href=# data-fn=clipboard data-clipboard-target=#cp-afbadd59fa33262855e76cf3046d58eb role=button aria-label=Копировать><i class="fas fa-copy fa-fw"></i></a></li></ul></div></div></div><div class="card-body p-0 overflow-auto" id=cp-afbadd59fa33262855e76cf3046d58eb><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-plaintext data-lang=plaintext><span class=line><span class=cl>bash bash.openssl.ca.sh ca</span></span></code></pre></td></tr></table></div></div></div></div></div><ol start=2><li>Создать клиентские ключи и сертификаты:</li></ol><div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-11 shortcode-codeblock-terminal
shortcode-codeblock-terminal-linux
shortcode-codeblock-terminal-linux-user"><div class="card overflow-hidden" data-bs-theme=dark><div class=card-header><div class="d-flex align-items-center"><div class=flex-shrink-0><i class="fas fa-terminal fa-fw"></i></div><div class="flex-grow-1 mx-2"><h5 class=mb-0>Терминал</h5></div><div class=flex-shrink-0><ul class="list-inline mb-0"><li class=list-inline-item data-bs-tooltip data-bs-title=Копировать><a class=text-body href=# data-fn=clipboard data-clipboard-target=#cp-8c786544a91b07689134476efbab229d role=button aria-label=Копировать><i class="fas fa-copy fa-fw"></i></a></li></ul></div></div></div><div class="card-body p-0 overflow-auto" id=cp-8c786544a91b07689134476efbab229d><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-plaintext data-lang=plaintext><span class=line><span class=cl>bash bash.openssl.ca.sh cert</span></span></code></pre></td></tr></table></div></div></div></div></div><p>Немного расскажу про алгоритм генерации сертификатов.</p><ol><li>У сертификата есть поле <code>Serial Number</code>, которое содержит серийный номер сертификата. Серийный номер сертификата это уникальный номер, выданный центром сертификации. В моём скрипте при генерации клиентского сертификата указаны опции <code>-CAcreateserial</code> и <code>-CAserial "${srl}"</code>, которые позволяют OpenSSL создавать рядом с клиентскими сертификатами файлы формата <code>.slr</code>, содержащие в себе серийные номера сгенерированных сертификатов. Таким образом можно создавать небольшую локальную базу данных выданных сертификатов.</li><li>Файл каждого клиентского сертификата генерируется с названием вида <code>[TS].[SFX].[EXE]</code>, где <code>[TS]</code> - это временная метка в микросекундах, <code>[SFX]</code> - числовой суффикс, а <code>[EXE]</code> - расширение файлов.</li></ol><p>На этом всё. Не исключаю факта присутствия ошибок или неточностей. Если что, жду предложения в электронную почту. <span class="shortcode shortcode-emoji">😄</span></p><h2 id=быстрое-создание-само-подписанного-сертификата><a class=link-body-emphasis href=#%d0%b1%d1%8b%d1%81%d1%82%d1%80%d0%be%d0%b5-%d1%81%d0%be%d0%b7%d0%b4%d0%b0%d0%bd%d0%b8%d0%b5-%d1%81%d0%b0%d0%bc%d0%be-%d0%bf%d0%be%d0%b4%d0%bf%d0%b8%d1%81%d0%b0%d0%bd%d0%bd%d0%be%d0%b3%d0%be-%d1%81%d0%b5%d1%80%d1%82%d0%b8%d1%84%d0%b8%d0%ba%d0%b0%d1%82%d0%b0>Быстрое создание само-подписанного сертификата</a></h2><p>Для быстрого создания само-подписанного сертификата, я написал пару небольших команд.</p><h3 id=ecc-elliptic-curve-cryptography><a class=link-body-emphasis href=#ecc-elliptic-curve-cryptography>ECC (Elliptic Curve Cryptography)</a></h3><div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-12
shortcode-codeblock-bash"><div class="d-flex overflow-hidden"><div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body" id=cp-1848cc42619594eeb95197059d1cb9cf data-bs-theme=dark><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=nv>ossl_days</span><span class=o>=</span><span class=s1>&#39;3650&#39;</span><span class=p>;</span> <span class=nv>ossl_country</span><span class=o>=</span><span class=s1>&#39;RU&#39;</span><span class=p>;</span> <span class=nv>ossl_state</span><span class=o>=</span><span class=s1>&#39;Russia&#39;</span><span class=p>;</span> <span class=nv>ossl_city</span><span class=o>=</span><span class=s1>&#39;Moscow&#39;</span><span class=p>;</span> <span class=nv>ossl_org</span><span class=o>=</span><span class=s1>&#39;RiK&#39;</span><span class=p>;</span> <span class=nv>ossl_host</span><span class=o>=</span><span class=s1>&#39;example.com&#39;</span><span class=p>;</span> openssl ecparam -genkey -name <span class=s1>&#39;prime256v1&#39;</span> -out <span class=s2>&#34;</span><span class=si>${</span><span class=nv>ossl_host</span><span class=si>}</span><span class=s2>.key&#34;</span> <span class=o>&amp;&amp;</span> openssl req -new -sha256 -key <span class=s2>&#34;</span><span class=si>${</span><span class=nv>ossl_host</span><span class=si>}</span><span class=s2>.key&#34;</span> -out <span class=s2>&#34;</span><span class=si>${</span><span class=nv>ossl_host</span><span class=si>}</span><span class=s2>.csr&#34;</span> -subj <span class=s2>&#34;/C=</span><span class=si>${</span><span class=nv>ossl_country</span><span class=si>}</span><span class=s2>/ST=</span><span class=si>${</span><span class=nv>ossl_state</span><span class=si>}</span><span class=s2>/L=</span><span class=si>${</span><span class=nv>ossl_city</span><span class=si>}</span><span class=s2>/O=</span><span class=si>${</span><span class=nv>ossl_org</span><span class=si>}</span><span class=s2>/CN=</span><span class=si>${</span><span class=nv>ossl_host</span><span class=si>}</span><span class=s2>&#34;</span> -addext <span class=s1>&#39;basicConstraints = critical, CA:FALSE&#39;</span> -addext <span class=s1>&#39;nsComment = OpenSSL Generated Certificate&#39;</span> -addext <span class=s1>&#39;keyUsage = critical, digitalSignature, keyEncipherment&#39;</span> -addext <span class=s1>&#39;extendedKeyUsage = serverAuth, clientAuth&#39;</span> -addext <span class=s2>&#34;subjectAltName=DNS:</span><span class=si>${</span><span class=nv>ossl_host</span><span class=si>}</span><span class=s2>,DNS:*.</span><span class=si>${</span><span class=nv>ossl_host</span><span class=si>}</span><span class=s2>&#34;</span> <span class=o>&amp;&amp;</span> openssl x509 -req -sha256 -days <span class=si>${</span><span class=nv>ossl_days</span><span class=si>}</span> -copy_extensions <span class=s1>&#39;copyall&#39;</span> -key <span class=s2>&#34;</span><span class=si>${</span><span class=nv>ossl_host</span><span class=si>}</span><span class=s2>.key&#34;</span> -in <span class=s2>&#34;</span><span class=si>${</span><span class=nv>ossl_host</span><span class=si>}</span><span class=s2>.csr&#34;</span> -out <span class=s2>&#34;</span><span class=si>${</span><span class=nv>ossl_host</span><span class=si>}</span><span class=s2>.crt&#34;</span> <span class=o>&amp;&amp;</span> openssl x509 -in <span class=s2>&#34;</span><span class=si>${</span><span class=nv>ossl_host</span><span class=si>}</span><span class=s2>.crt&#34;</span> -text -noout</span></span></code></pre></td></tr></table></div></div></div><div class=flex-shrink-0><ul class="list-inline mb-0"><li class=list-inline-item data-bs-tooltip data-bs-title=Копировать><a class=text-body href=# data-fn=clipboard data-clipboard-target=#cp-1848cc42619594eeb95197059d1cb9cf role=button aria-label=Копировать><i class="fas fa-copy fa-fw"></i></a></li></ul></div></div></div><p>Где:</p><ul><li><code>ossl_days</code> - количество дней валидности сертификата.</li><li><code>ossl_country</code> - страна.</li><li><code>ossl_state</code> - штат.</li><li><code>ossl_city</code> - город.</li><li><code>ossl_org</code> - организация.</li><li><code>ossl_host</code> - хост.</li></ul><h3 id=rsa-rivest-shamir-adleman><a class=link-body-emphasis href=#rsa-rivest-shamir-adleman>RSA (Rivest-Shamir-Adleman)</a></h3><div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-13
shortcode-codeblock-bash"><div class="d-flex overflow-hidden"><div class="flex-grow-1 rounded overflow-hidden bg-body-tertiary text-body" id=cp-98357a5213eac7bd80508214a136b8e5 data-bs-theme=dark><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=nv>ossl_days</span><span class=o>=</span><span class=s1>&#39;3650&#39;</span><span class=p>;</span> <span class=nv>ossl_country</span><span class=o>=</span><span class=s1>&#39;RU&#39;</span><span class=p>;</span> <span class=nv>ossl_state</span><span class=o>=</span><span class=s1>&#39;Russia&#39;</span><span class=p>;</span> <span class=nv>ossl_city</span><span class=o>=</span><span class=s1>&#39;Moscow&#39;</span><span class=p>;</span> <span class=nv>ossl_org</span><span class=o>=</span><span class=s1>&#39;RiK&#39;</span><span class=p>;</span> <span class=nv>ossl_host</span><span class=o>=</span><span class=s1>&#39;example.com&#39;</span><span class=p>;</span> openssl genrsa -out <span class=s2>&#34;</span><span class=si>${</span><span class=nv>ossl_host</span><span class=si>}</span><span class=s2>.key&#34;</span> <span class=m>2048</span> <span class=o>&amp;&amp;</span> openssl req -new -sha256 -key <span class=s2>&#34;</span><span class=si>${</span><span class=nv>ossl_host</span><span class=si>}</span><span class=s2>.key&#34;</span> -out <span class=s2>&#34;</span><span class=si>${</span><span class=nv>ossl_host</span><span class=si>}</span><span class=s2>.csr&#34;</span> -subj <span class=s2>&#34;/C=</span><span class=si>${</span><span class=nv>ossl_country</span><span class=si>}</span><span class=s2>/ST=</span><span class=si>${</span><span class=nv>ossl_state</span><span class=si>}</span><span class=s2>/L=</span><span class=si>${</span><span class=nv>ossl_city</span><span class=si>}</span><span class=s2>/O=</span><span class=si>${</span><span class=nv>ossl_org</span><span class=si>}</span><span class=s2>/CN=</span><span class=si>${</span><span class=nv>ossl_host</span><span class=si>}</span><span class=s2>&#34;</span> -addext <span class=s1>&#39;basicConstraints = critical, CA:FALSE&#39;</span> -addext <span class=s1>&#39;nsComment = OpenSSL Generated Certificate&#39;</span> -addext <span class=s1>&#39;keyUsage = critical, digitalSignature, keyEncipherment&#39;</span> -addext <span class=s1>&#39;extendedKeyUsage = serverAuth, clientAuth&#39;</span> -addext <span class=s2>&#34;subjectAltName=DNS:</span><span class=si>${</span><span class=nv>ossl_host</span><span class=si>}</span><span class=s2>,DNS:*.</span><span class=si>${</span><span class=nv>ossl_host</span><span class=si>}</span><span class=s2>&#34;</span> <span class=o>&amp;&amp;</span> openssl x509 -req -sha256 -days <span class=si>${</span><span class=nv>ossl_days</span><span class=si>}</span> -copy_extensions <span class=s1>&#39;copyall&#39;</span> -key <span class=s2>&#34;</span><span class=si>${</span><span class=nv>ossl_host</span><span class=si>}</span><span class=s2>.key&#34;</span> -in <span class=s2>&#34;</span><span class=si>${</span><span class=nv>ossl_host</span><span class=si>}</span><span class=s2>.csr&#34;</span> -out <span class=s2>&#34;</span><span class=si>${</span><span class=nv>ossl_host</span><span class=si>}</span><span class=s2>.crt&#34;</span> <span class=o>&amp;&amp;</span> openssl x509 -in <span class=s2>&#34;</span><span class=si>${</span><span class=nv>ossl_host</span><span class=si>}</span><span class=s2>.crt&#34;</span> -text -noout</span></span></code></pre></td></tr></table></div></div></div><div class=flex-shrink-0><ul class="list-inline mb-0"><li class=list-inline-item data-bs-tooltip data-bs-title=Копировать><a class=text-body href=# data-fn=clipboard data-clipboard-target=#cp-98357a5213eac7bd80508214a136b8e5 role=button aria-label=Копировать><i class="fas fa-copy fa-fw"></i></a></li></ul></div></div></div><p>Где:</p><ul><li><code>ossl_days</code> - количество дней валидности сертификата.</li><li><code>ossl_country</code> - страна.</li><li><code>ossl_state</code> - штат.</li><li><code>ossl_city</code> - город.</li><li><code>ossl_org</code> - организация.</li><li><code>ossl_host</code> - хост.</li></ul><h3 id=скрипт><a class=link-body-emphasis href=#%d1%81%d0%ba%d1%80%d0%b8%d0%bf%d1%82>Скрипт</a></h3><div class="shortcode shortcode-file mb-3"><div class="card overflow-hidden" data-bs-theme=dark><div class=card-header><div class="d-flex align-items-center"><div class=flex-shrink-0><i class="far fa-file-code fa-fw"></i></div><div class="flex-grow-1 mx-2 text-truncate"><code>bash.openssl.ssc.sh</code></div><div class=flex-shrink-0><ul class="list-inline mb-0"><li class=list-inline-item data-bs-tooltip data-bs-title=Копировать><a class=text-body href=# data-fn=clipboard data-clipboard-target=#cp-0d25c626060f8c3f7392ceab12148058 role=button aria-label=Копировать><i class="fas fa-copy fa-fw"></i></a></li><li class=list-inline-item data-bs-tooltip data-bs-title=Скачать><a class=text-body href=/ru/2023/10/6733cb51-62a0-5ed9-b421-8f08c4e0cb18/bash.openssl.ssc.sh download role=button aria-label=Скачать><i class="fas fa-download fa-fw"></i></a></li><li class=list-inline-item data-bs-tooltip data-bs-title=Открыть><a class=text-body href=/ru/2023/10/6733cb51-62a0-5ed9-b421-8f08c4e0cb18/bash.openssl.ssc.sh target=_blank role=button aria-label=Открыть><i class="fas fa-arrow-up-right-from-square fa-fw"></i></a></li></ul></div></div></div><div class="card-body p-0 overflow-auto" id=cp-0d25c626060f8c3f7392ceab12148058><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span><span class=lnt>44
</span><span class=lnt>45
</span><span class=lnt>46
</span><span class=lnt>47
</span><span class=lnt>48
</span><span class=lnt>49
</span><span class=lnt>50
</span><span class=lnt>51
</span><span class=lnt>52
</span><span class=lnt>53
</span><span class=lnt>54
</span><span class=lnt>55
</span><span class=lnt>56
</span><span class=lnt>57
</span><span class=lnt>58
</span><span class=lnt>59
</span><span class=lnt>60
</span><span class=lnt>61
</span><span class=lnt>62
</span><span class=lnt>63
</span><span class=lnt>64
</span><span class=lnt>65
</span><span class=lnt>66
</span><span class=lnt>67
</span><span class=lnt>68
</span><span class=lnt>69
</span><span class=lnt>70
</span><span class=lnt>71
</span><span class=lnt>72
</span><span class=lnt>73
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-sh data-lang=sh><span class=line><span class=cl><span class=cp>#!/usr/bin/env -S bash -e
</span></span></span><span class=line><span class=cl><span class=cp></span><span class=c1>#</span>
</span></span><span class=line><span class=cl><span class=c1># OpenSSL self signed certificate generator.</span>
</span></span><span class=line><span class=cl><span class=c1>#</span>
</span></span><span class=line><span class=cl><span class=c1># @package    Bash</span>
</span></span><span class=line><span class=cl><span class=c1># @author     Kai Kimera &lt;mail@kai.kim&gt;</span>
</span></span><span class=line><span class=cl><span class=c1># @copyright  2024 Library Online</span>
</span></span><span class=line><span class=cl><span class=c1># @license    MIT</span>
</span></span><span class=line><span class=cl><span class=c1># @version    0.1.0</span>
</span></span><span class=line><span class=cl><span class=c1># @link       https://lib.onl/ru/articles/2023/10/6733cb51-62a0-5ed9-b421-8f08c4e0cb18/</span>
</span></span><span class=line><span class=cl><span class=c1># -------------------------------------------------------------------------------------------------------------------- #</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=o>((</span> <span class=nv>EUID</span> <span class=o>==</span> <span class=m>0</span> <span class=o>))</span> <span class=o>&amp;&amp;</span> <span class=o>{</span> <span class=nb>echo</span> &gt;<span class=p>&amp;</span><span class=m>2</span> <span class=s1>&#39;This script should not be run as root!&#39;</span><span class=p>;</span> <span class=nb>exit</span> 1<span class=p>;</span> <span class=o>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># -------------------------------------------------------------------------------------------------------------------- #</span>
</span></span><span class=line><span class=cl><span class=c1># CONFIGURATION.</span>
</span></span><span class=line><span class=cl><span class=c1># -------------------------------------------------------------------------------------------------------------------- #</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Get &#39;openssl&#39; command.</span>
</span></span><span class=line><span class=cl><span class=nv>ossl</span><span class=o>=</span><span class=s2>&#34;</span><span class=k>$(</span> <span class=nb>command</span> -v openssl <span class=k>)</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Specifies the number of days to make a certificate valid for.</span>
</span></span><span class=line><span class=cl><span class=c1># Default is 10 years.</span>
</span></span><span class=line><span class=cl><span class=nv>days</span><span class=o>=</span><span class=s1>&#39;3650&#39;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># The two-letter country code where your company is legally located.</span>
</span></span><span class=line><span class=cl><span class=nv>country</span><span class=o>=</span><span class=s1>&#39;RU&#39;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># The state/province where your company is legally located.</span>
</span></span><span class=line><span class=cl><span class=nv>state</span><span class=o>=</span><span class=s1>&#39;Russia&#39;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># The city where your company is legally located.</span>
</span></span><span class=line><span class=cl><span class=nv>city</span><span class=o>=</span><span class=s1>&#39;Moscow&#39;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Your company&#39;s legally registered name (e.g., YourCompany, Inc.).</span>
</span></span><span class=line><span class=cl><span class=nv>org</span><span class=o>=</span><span class=s1>&#39;YourCompany&#39;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># The fully-qualified domain name (FQDN) (e.g., www.example.com).</span>
</span></span><span class=line><span class=cl><span class=nv>host</span><span class=o>=</span><span class=s2>&#34;</span><span class=si>${</span><span class=nv>1</span><span class=k>:-</span><span class=nv>example</span><span class=p>.com</span><span class=si>}</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Your email address.</span>
</span></span><span class=line><span class=cl><span class=nv>email</span><span class=o>=</span><span class=s2>&#34;mail@</span><span class=si>${</span><span class=nv>host</span><span class=si>}</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># -------------------------------------------------------------------------------------------------------------------- #</span>
</span></span><span class=line><span class=cl><span class=c1># -----------------------------------------------------&lt; SCRIPT &gt;----------------------------------------------------- #</span>
</span></span><span class=line><span class=cl><span class=c1># -------------------------------------------------------------------------------------------------------------------- #</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>! <span class=o>[[</span> -x <span class=s2>&#34;</span><span class=si>${</span><span class=nv>ossl</span><span class=si>}</span><span class=s2>&#34;</span> <span class=o>]]</span> <span class=o>&amp;&amp;</span> <span class=o>{</span> <span class=nb>echo</span> &gt;<span class=p>&amp;</span><span class=m>2</span> <span class=s2>&#34;&#39;openssl&#39; is not installed!&#34;</span><span class=p>;</span> <span class=nb>exit</span> 1<span class=p>;</span> <span class=o>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nb>echo</span> <span class=s2>&#34;&#34;</span> <span class=o>&amp;&amp;</span> <span class=nb>echo</span> <span class=s2>&#34;--- [SSL] Self Signed Certificate: &#39;</span><span class=si>${</span><span class=nv>host</span><span class=si>}</span><span class=s2>&#39;&#34;</span> <span class=o>&amp;&amp;</span> <span class=nb>echo</span> <span class=s2>&#34;&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>if</span> <span class=o>[[</span> <span class=s2>&#34;</span><span class=si>${</span><span class=nv>2</span><span class=si>}</span><span class=s2>&#34;</span> <span class=o>=</span> <span class=s1>&#39;rsa&#39;</span> <span class=o>]]</span><span class=p>;</span> <span class=k>then</span>
</span></span><span class=line><span class=cl>  <span class=si>${</span><span class=nv>ossl</span><span class=si>}</span> genrsa -out <span class=s2>&#34;</span><span class=si>${</span><span class=nv>host</span><span class=si>}</span><span class=s2>.key&#34;</span> <span class=m>2048</span>
</span></span><span class=line><span class=cl><span class=k>else</span>
</span></span><span class=line><span class=cl>  <span class=si>${</span><span class=nv>ossl</span><span class=si>}</span> ecparam -genkey -name <span class=s1>&#39;prime256v1&#39;</span> -out <span class=s2>&#34;</span><span class=si>${</span><span class=nv>host</span><span class=si>}</span><span class=s2>.key&#34;</span>
</span></span><span class=line><span class=cl><span class=k>fi</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>if</span> <span class=o>[[</span> -f <span class=s2>&#34;</span><span class=si>${</span><span class=nv>host</span><span class=si>}</span><span class=s2>.key&#34;</span> <span class=o>]]</span><span class=p>;</span> <span class=k>then</span>
</span></span><span class=line><span class=cl>  <span class=si>${</span><span class=nv>ossl</span><span class=si>}</span> req -new -sha256 -key <span class=s2>&#34;</span><span class=si>${</span><span class=nv>host</span><span class=si>}</span><span class=s2>.key&#34;</span> -out <span class=s2>&#34;</span><span class=si>${</span><span class=nv>host</span><span class=si>}</span><span class=s2>.csr&#34;</span> <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>    -subj <span class=s2>&#34;/C=</span><span class=si>${</span><span class=nv>country</span><span class=si>}</span><span class=s2>/ST=</span><span class=si>${</span><span class=nv>state</span><span class=si>}</span><span class=s2>/L=</span><span class=si>${</span><span class=nv>city</span><span class=si>}</span><span class=s2>/O=</span><span class=si>${</span><span class=nv>org</span><span class=si>}</span><span class=s2>/emailAddress=</span><span class=si>${</span><span class=nv>email</span><span class=si>}</span><span class=s2>/CN=</span><span class=si>${</span><span class=nv>host</span><span class=si>}</span><span class=s2>&#34;</span> <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>    -addext <span class=s1>&#39;basicConstraints = critical, CA:FALSE&#39;</span> <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>    -addext <span class=s1>&#39;nsComment = OpenSSL Generated Certificate&#39;</span> <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>    -addext <span class=s1>&#39;keyUsage = critical, digitalSignature, keyEncipherment&#39;</span> <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>    -addext <span class=s1>&#39;extendedKeyUsage = serverAuth, clientAuth&#39;</span> <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>    -addext <span class=s2>&#34;subjectAltName=DNS:</span><span class=si>${</span><span class=nv>host</span><span class=si>}</span><span class=s2>,DNS:*.</span><span class=si>${</span><span class=nv>host</span><span class=si>}</span><span class=s2>&#34;</span> <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>    <span class=o>&amp;&amp;</span> <span class=si>${</span><span class=nv>ossl</span><span class=si>}</span> x509 -req -sha256 -days <span class=si>${</span><span class=nv>days</span><span class=si>}</span> -copy_extensions <span class=s1>&#39;copyall&#39;</span> <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>      -key <span class=s2>&#34;</span><span class=si>${</span><span class=nv>host</span><span class=si>}</span><span class=s2>.key&#34;</span> -in <span class=s2>&#34;</span><span class=si>${</span><span class=nv>host</span><span class=si>}</span><span class=s2>.csr&#34;</span> -out <span class=s2>&#34;</span><span class=si>${</span><span class=nv>host</span><span class=si>}</span><span class=s2>.crt&#34;</span> <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>    <span class=o>&amp;&amp;</span> <span class=si>${</span><span class=nv>ossl</span><span class=si>}</span> x509 -in <span class=s2>&#34;</span><span class=si>${</span><span class=nv>host</span><span class=si>}</span><span class=s2>.crt&#34;</span> -text -noout
</span></span><span class=line><span class=cl><span class=k>else</span>
</span></span><span class=line><span class=cl>  <span class=nb>echo</span> <span class=s2>&#34;&#39;</span><span class=si>${</span><span class=nv>host</span><span class=si>}</span><span class=s2>.key&#39; not found!&#34;</span> <span class=o>&amp;&amp;</span> <span class=nb>exit</span> <span class=m>1</span>
</span></span><span class=line><span class=cl><span class=k>fi</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nb>exit</span> <span class=m>0</span></span></span></code></pre></td></tr></table></div></div></div></div></div></div></div><div class=tab-pane id=tab-pane-main-changelog role=tabpanel aria-labelledby=tab-main-changelog tabindex=0><div class=node-body><h2 id=2023-11-08><a class=link-body-emphasis href=#2023-11-08>2023-11-08</a></h2><ul><li><code>bash.openssh.ca.sh</code>: добавление проверки на запуск скрипта под root&rsquo;ом.</li><li><code>bash.openssh.ca.sh</code>: добавление комментариев.</li></ul><h2 id=2024-04-07><a class=link-body-emphasis href=#2024-04-07>2024-04-07</a></h2><ul><li>Добавлены команды для быстрой генерации сертификата без создания CA.</li><li>Добавлен скрипт для быстрой генерации сертификата без создания CA.</li></ul></div></div><div class=tab-pane id=tab-pane-main-info role=tabpanel aria-labelledby=tab-main-info tabindex=0><div class=node-body><div class="row row-cols-1 row-cols-lg-2 g-3"><div class=col><section class="card node-categories h-100"><div class=card-body><h5 class=card-title>Категории</h5><ul class=list-inline><li class=list-inline-item><a href=https://lib.onl/ru/categories/terminal/>Терминал</a></li><li class=list-inline-item><a href=https://lib.onl/ru/categories/scripts/>Скрипты</a></li><li class=list-inline-item><a href=https://lib.onl/ru/categories/linux/>Linux</a></li></ul></div></section></div><div class=col><section class="card node-tags h-100"><div class=card-body><h5 class=card-title>Теги</h5><ul class=list-inline><li class=list-inline-item><a href=https://lib.onl/ru/tags/openssl/>#openssl</a></li><li class=list-inline-item><a href=https://lib.onl/ru/tags/bash/>#bash</a></li><li class=list-inline-item><a href=https://lib.onl/ru/tags/%D1%81%D0%B5%D1%80%D1%82%D0%B8%D1%84%D0%B8%D0%BA%D0%B0%D1%82%D1%8B/>#сертификаты</a></li></ul></div></section></div><div class=col><section class="card node-authors h-100"><div class=card-body><h5 class=card-title>Авторы</h5><ul><li><a href=https://lib.onl/ru/authors/kaikimera/>Kai Kimera</a></li></ul></div></section></div><div class=col><section class="card node-similar h-100"><div class=card-body><h5 class=card-title>Смотрите также</h5><ul><li><a href=/ru/2023/10/75075788-9308-56b7-b531-2008cb35f7d0/>Установка сертификата НУЦ Минцифры</a></li><li><a href=/ru/2021/08/ca744dce-e607-52e6-9952-8ae04e052a5b/>Скрипт автоматического удаления устаревших файлов</a></li></ul></div></section></div><div class=col><section class="card node-meta h-100"><div class=card-body><h5 class=card-title>Мета</h5><div class="row row-cols-1 row-cols-sm-2 g-2 align-items-center"><div class=col>Лицензия</div><div class=col><div class=input-group><input type=text class=form-control value=CC-BY-SA-4.0 readonly>
<a class="btn btn-primary" href=https://choosealicense.com/licenses/cc-by-sa-4.0 target=_blank role=button rel="noopener noreferrer nofollow" data-bs-tooltip data-bs-title="Текст лицензии"><i class="far fa-file-lines fa-fw"></i></a></div></div><div class=col>ID файла</div><div class=col><input type=text class=form-control value=10c1210fd18cd5807997de1b035101f3 readonly></div><div class=col>UUID</div><div class=col><input type=text class=form-control value=6733cb51-62a0-5ed9-b421-8f08c4e0cb18 readonly></div><div class=col>Системный путь</div><div class=col><input type=text class=form-control value=articles/2023/10/1697586151061_3819/index.md readonly></div><div class=col>Тип</div><div class=col><input type=text class=form-control value=articles readonly></div></div></div></section></div><div class=col><section class="card node-stats h-100"><div class=card-body><h5 class=card-title>Статистика</h5><div class="row row-cols-1 row-cols-sm-2 g-2 align-items-center"><div class=col>Количество слов</div><div class=col><input type=text class=form-control value=2355 readonly></div><div class=col>Время чтения</div><div class=col><div class=input-group><input type=text class=form-control value=12 readonly>
<span class=input-group-text>мин.</span></div></div></div></div></section></div></div></div></div><div class=tab-pane id=tab-pane-main-comments role=tabpanel aria-labelledby=tab-main-comments tabindex=0><div class=node-body><div class=giscus></div></div></div><div class=tab-pane id=tab-pane-main-share role=tabpanel aria-labelledby=tab-main-share tabindex=0><div class=node-body><div class="row row-cols-1 row-cols-lg-2 g-3"><div class=col><div class="row row-cols-1 g-3"><div class=col><div class="row row-cols-auto g-2"><div class=col><a class="btn btn-light" href="mailto:?subject=%d0%a1%d0%be%d0%b7%d0%b4%d0%b0%d0%bd%d0%b8%d0%b5%20%d1%81%d0%b5%d1%80%d1%82%d0%b8%d1%84%d0%b8%d0%ba%d0%b0%d1%82%d0%be%d0%b2%20%d0%bf%d1%80%d0%b8%20%d0%bf%d0%be%d0%bc%d0%be%d1%89%d0%b8%20OpenSSL&amp;body=https%3a%2f%2flib.onl%2fru%2f2023%2f10%2f6733cb51-62a0-5ed9-b421-8f08c4e0cb18%2f" data-bs-tooltip data-bs-title=Email role=button rel="noopener noreferrer nofollow"><i class="fas fa-envelope-open-text fa-fw"></i></a></div><div class=col><a class="btn btn-light btn-social" href="https://twitter.com/intent/tweet?url=https%3a%2f%2flib.onl%2fru%2f2023%2f10%2f6733cb51-62a0-5ed9-b421-8f08c4e0cb18%2f&amp;text=%d0%a1%d0%be%d0%b7%d0%b4%d0%b0%d0%bd%d0%b8%d0%b5%20%d1%81%d0%b5%d1%80%d1%82%d0%b8%d1%84%d0%b8%d0%ba%d0%b0%d1%82%d0%be%d0%b2%20%d0%bf%d1%80%d0%b8%20%d0%bf%d0%be%d0%bc%d0%be%d1%89%d0%b8%20OpenSSL&amp;hashtags=openssl%2cbash%2c%d1%81%d0%b5%d1%80%d1%82%d0%b8%d1%84%d0%b8%d0%ba%d0%b0%d1%82%d1%8b" data-bs-tooltip data-bs-title=Twitter role=button rel="noopener noreferrer nofollow" data-fn=popup><i class="fab fa-twitter fa-fw"></i></a></div><div class=col><a class="btn btn-light btn-social" href="https://facebook.com/sharer/sharer.php?u=https%3a%2f%2flib.onl%2fru%2f2023%2f10%2f6733cb51-62a0-5ed9-b421-8f08c4e0cb18%2f" data-bs-tooltip data-bs-title=Facebook role=button rel="noopener noreferrer nofollow" data-fn=popup><i class="fab fa-facebook fa-fw"></i></a></div><div class=col><a class="btn btn-light btn-social" href="https://linkedin.com/sharing/share-offsite/?url=https%3a%2f%2flib.onl%2fru%2f2023%2f10%2f6733cb51-62a0-5ed9-b421-8f08c4e0cb18%2f" data-bs-tooltip data-bs-title=LinkedIn role=button rel="noopener noreferrer nofollow" data-fn=popup><i class="fab fa-linkedin fa-fw"></i></a></div><div class=col><a class="btn btn-light btn-social" href="https://reddit.com/submit?url=https%3a%2f%2flib.onl%2fru%2f2023%2f10%2f6733cb51-62a0-5ed9-b421-8f08c4e0cb18%2f&amp;title=%d0%a1%d0%be%d0%b7%d0%b4%d0%b0%d0%bd%d0%b8%d0%b5%20%d1%81%d0%b5%d1%80%d1%82%d0%b8%d1%84%d0%b8%d0%ba%d0%b0%d1%82%d0%be%d0%b2%20%d0%bf%d1%80%d0%b8%20%d0%bf%d0%be%d0%bc%d0%be%d1%89%d0%b8%20OpenSSL" data-bs-tooltip data-bs-title=Reddit role=button rel="noopener noreferrer nofollow" data-fn=popup><i class="fab fa-reddit fa-fw"></i></a></div><div class=col><a class="btn btn-light btn-social" href="https://vk.com/share.php?url=https%3a%2f%2flib.onl%2fru%2f2023%2f10%2f6733cb51-62a0-5ed9-b421-8f08c4e0cb18%2f&amp;title=%d0%a1%d0%be%d0%b7%d0%b4%d0%b0%d0%bd%d0%b8%d0%b5%20%d1%81%d0%b5%d1%80%d1%82%d0%b8%d1%84%d0%b8%d0%ba%d0%b0%d1%82%d0%be%d0%b2%20%d0%bf%d1%80%d0%b8%20%d0%bf%d0%be%d0%bc%d0%be%d1%89%d0%b8%20OpenSSL&amp;description=%23OpenSSL%20%d1%8f%d0%b2%d0%bb%d1%8f%d0%b5%d1%82%d1%81%d1%8f%20%d0%b1%d0%b8%d0%b1%d0%bb%d0%b8%d0%be%d1%82%d0%b5%d0%ba%d0%be%d0%b9%20%d0%bf%d0%be%20%d1%80%d0%b0%d0%b1%d0%be%d1%82%d0%b5%20%d1%81%20%d0%ba%d1%80%d0%b8%d0%bf%d1%82%d0%be%d0%b3%d1%80%d0%b0%d1%84%d0%b8%d0%b5%d0%b9%2c%20%d0%bd%d0%be%20%d0%b2%20%d1%8d%d1%82%d0%be%d0%b9%20%d1%81%d1%82%d0%b0%d1%82%d1%8c%d0%b5%20%d1%8f%20%d0%b7%d0%b0%d1%82%d1%80%d0%be%d0%bd%d1%83%20%d1%82%d0%be%d0%bb%d1%8c%d0%ba%d0%be%20%d1%87%d0%b0%d1%81%d1%82%d1%8c%20%d1%84%d1%83%d0%bd%d0%ba%d1%86%d0%b8%d0%b9%20%d1%8d%d1%82%d0%be%d0%b3%d0%be%20%d0%b8%d0%bd%d1%81%d1%82%d1%80%d1%83%d0%bc%d0%b5%d0%bd%d1%82%d0%b0%2c%20%d0%b0%20%d0%b8%d0%bc%d0%b5%d0%bd%d0%bd%d0%be%20%d1%81%d0%be%d0%b7%d0%b4%d0%b0%d0%bd%d0%b8%d0%b5%20%d1%81%d0%b0%d0%bc%d0%be-%d0%bf%d0%be%d0%b4%d0%bf%d0%b8%d1%81%d0%b0%d0%bd%d0%bd%d1%8b%d1%85%20%d1%81%d0%b5%d1%80%d1%82%d0%b8%d1%84%d0%b8%d0%ba%d0%b0%d1%82%d0%be%d0%b2.%0a" data-bs-tooltip data-bs-title=ВКонтакте role=button rel="noopener noreferrer nofollow" data-fn=popup><i class="fab fa-vk fa-fw"></i></a></div><div class=col><a class="btn btn-light btn-social" href="https://t.me/share/url?url=https%3a%2f%2flib.onl%2fru%2f2023%2f10%2f6733cb51-62a0-5ed9-b421-8f08c4e0cb18%2f&amp;text=%d0%a1%d0%be%d0%b7%d0%b4%d0%b0%d0%bd%d0%b8%d0%b5%20%d1%81%d0%b5%d1%80%d1%82%d0%b8%d1%84%d0%b8%d0%ba%d0%b0%d1%82%d0%be%d0%b2%20%d0%bf%d1%80%d0%b8%20%d0%bf%d0%be%d0%bc%d0%be%d1%89%d0%b8%20OpenSSL" data-bs-tooltip data-bs-title=Telegram role=button rel="noopener noreferrer nofollow" data-fn=popup><i class="fab fa-telegram fa-fw"></i></a></div><div class=col><a class="btn btn-light btn-social" href="http://pinterest.com/pin/create/button/?url=https%3a%2f%2flib.onl%2fru%2f2023%2f10%2f6733cb51-62a0-5ed9-b421-8f08c4e0cb18%2f" data-bs-tooltip data-bs-title=Pinterest role=button rel="noopener noreferrer nofollow" data-fn=popup><i class="fab fa-pinterest fa-fw"></i></a></div><div class=col><a class="btn btn-light btn-social" href="https://getpocket.com/edit?url=https%3a%2f%2flib.onl%2fru%2f2023%2f10%2f6733cb51-62a0-5ed9-b421-8f08c4e0cb18%2f&amp;title=%d0%a1%d0%be%d0%b7%d0%b4%d0%b0%d0%bd%d0%b8%d0%b5%20%d1%81%d0%b5%d1%80%d1%82%d0%b8%d1%84%d0%b8%d0%ba%d0%b0%d1%82%d0%be%d0%b2%20%d0%bf%d1%80%d0%b8%20%d0%bf%d0%be%d0%bc%d0%be%d1%89%d0%b8%20OpenSSL" target=_blank data-bs-tooltip data-bs-title=Pocket role=button rel="noopener noreferrer nofollow" data-fn=popup><i class="fab fa-get-pocket fa-fw"></i></a></div><div class=col><a class="btn btn-light btn-social" href="https://news.ycombinator.com/submitlink?u=https%3a%2f%2flib.onl%2fru%2f2023%2f10%2f6733cb51-62a0-5ed9-b421-8f08c4e0cb18%2f&amp;t=%d0%a1%d0%be%d0%b7%d0%b4%d0%b0%d0%bd%d0%b8%d0%b5%20%d1%81%d0%b5%d1%80%d1%82%d0%b8%d1%84%d0%b8%d0%ba%d0%b0%d1%82%d0%be%d0%b2%20%d0%bf%d1%80%d0%b8%20%d0%bf%d0%be%d0%bc%d0%be%d1%89%d0%b8%20OpenSSL" data-bs-tooltip data-bs-title='Hacker News' role=button rel="noopener noreferrer nofollow" data-fn=popup><i class="fab fa-hacker-news fa-fw"></i></a></div><div class=col><a class="btn btn-light btn-social" href="https://livejournal.com/update.bml?subject=%d0%a1%d0%be%d0%b7%d0%b4%d0%b0%d0%bd%d0%b8%d0%b5%20%d1%81%d0%b5%d1%80%d1%82%d0%b8%d1%84%d0%b8%d0%ba%d0%b0%d1%82%d0%be%d0%b2%20%d0%bf%d1%80%d0%b8%20%d0%bf%d0%be%d0%bc%d0%be%d1%89%d0%b8%20OpenSSL&amp;event=https%3a%2f%2flib.onl%2fru%2f2023%2f10%2f6733cb51-62a0-5ed9-b421-8f08c4e0cb18%2f" data-bs-tooltip data-bs-title=LiveJournal role=button rel="noopener noreferrer nofollow" data-fn=popup><i class="fas fa-edit fa-fw"></i></a></div><div class=col><a class="btn btn-light btn-social" href="https://connect.ok.ru/dk?st.cmd=WidgetSharePreview&amp;st.shareUrl=https%3a%2f%2flib.onl%2fru%2f2023%2f10%2f6733cb51-62a0-5ed9-b421-8f08c4e0cb18%2f&amp;title=%d0%a1%d0%be%d0%b7%d0%b4%d0%b0%d0%bd%d0%b8%d0%b5%20%d1%81%d0%b5%d1%80%d1%82%d0%b8%d1%84%d0%b8%d0%ba%d0%b0%d1%82%d0%be%d0%b2%20%d0%bf%d1%80%d0%b8%20%d0%bf%d0%be%d0%bc%d0%be%d1%89%d0%b8%20OpenSSL" data-bs-tooltip data-bs-title=Одноклассники role=button rel="noopener noreferrer nofollow" data-fn=popup><i class="fab fa-odnoklassniki fa-fw"></i></a></div><div class=col><a class="btn btn-light btn-social" href="https://blogger.com/blog-this.g?u=https%3a%2f%2flib.onl%2fru%2f2023%2f10%2f6733cb51-62a0-5ed9-b421-8f08c4e0cb18%2f&amp;n=%d0%a1%d0%be%d0%b7%d0%b4%d0%b0%d0%bd%d0%b8%d0%b5%20%d1%81%d0%b5%d1%80%d1%82%d0%b8%d1%84%d0%b8%d0%ba%d0%b0%d1%82%d0%be%d0%b2%20%d0%bf%d1%80%d0%b8%20%d0%bf%d0%be%d0%bc%d0%be%d1%89%d0%b8%20OpenSSL&amp;t=%23OpenSSL%20%d1%8f%d0%b2%d0%bb%d1%8f%d0%b5%d1%82%d1%81%d1%8f%20%d0%b1%d0%b8%d0%b1%d0%bb%d0%b8%d0%be%d1%82%d0%b5%d0%ba%d0%be%d0%b9%20%d0%bf%d0%be%20%d1%80%d0%b0%d0%b1%d0%be%d1%82%d0%b5%20%d1%81%20%d0%ba%d1%80%d0%b8%d0%bf%d1%82%d0%be%d0%b3%d1%80%d0%b0%d1%84%d0%b8%d0%b5%d0%b9%2c%20%d0%bd%d0%be%20%d0%b2%20%d1%8d%d1%82%d0%be%d0%b9%20%d1%81%d1%82%d0%b0%d1%82%d1%8c%d0%b5%20%d1%8f%20%d0%b7%d0%b0%d1%82%d1%80%d0%be%d0%bd%d1%83%20%d1%82%d0%be%d0%bb%d1%8c%d0%ba%d0%be%20%d1%87%d0%b0%d1%81%d1%82%d1%8c%20%d1%84%d1%83%d0%bd%d0%ba%d1%86%d0%b8%d0%b9%20%d1%8d%d1%82%d0%be%d0%b3%d0%be%20%d0%b8%d0%bd%d1%81%d1%82%d1%80%d1%83%d0%bc%d0%b5%d0%bd%d1%82%d0%b0%2c%20%d0%b0%20%d0%b8%d0%bc%d0%b5%d0%bd%d0%bd%d0%be%20%d1%81%d0%be%d0%b7%d0%b4%d0%b0%d0%bd%d0%b8%d0%b5%20%d1%81%d0%b0%d0%bc%d0%be-%d0%bf%d0%be%d0%b4%d0%bf%d0%b8%d1%81%d0%b0%d0%bd%d0%bd%d1%8b%d1%85%20%d1%81%d0%b5%d1%80%d1%82%d0%b8%d1%84%d0%b8%d0%ba%d0%b0%d1%82%d0%be%d0%b2.%0a" data-bs-tooltip data-bs-title=Blogger role=button rel="noopener noreferrer nofollow" data-fn=popup><i class="fab fa-blogger fa-fw"></i></a></div><div class=col><a class="btn btn-light btn-social" href="https://digg.com/submit?url=https%3a%2f%2flib.onl%2fru%2f2023%2f10%2f6733cb51-62a0-5ed9-b421-8f08c4e0cb18%2f" data-bs-tooltip data-bs-title=Digg role=button rel="noopener noreferrer nofollow" data-fn=popup><i class="fab fa-digg fa-fw"></i></a></div><div class=col><a class="btn btn-light btn-social" href="https://web.skype.com/share?url=https%3a%2f%2flib.onl%2fru%2f2023%2f10%2f6733cb51-62a0-5ed9-b421-8f08c4e0cb18%2f&amp;title=%d0%a1%d0%be%d0%b7%d0%b4%d0%b0%d0%bd%d0%b8%d0%b5%20%d1%81%d0%b5%d1%80%d1%82%d0%b8%d1%84%d0%b8%d0%ba%d0%b0%d1%82%d0%be%d0%b2%20%d0%bf%d1%80%d0%b8%20%d0%bf%d0%be%d0%bc%d0%be%d1%89%d0%b8%20OpenSSL" data-bs-tooltip data-bs-title=Skype role=button rel="noopener noreferrer nofollow" data-fn=popup><i class="fab fa-skype fa-fw"></i></a></div><div class=col><a class="btn btn-light btn-social" href="https://api.whatsapp.com/send?text=https%3a%2f%2flib.onl%2fru%2f2023%2f10%2f6733cb51-62a0-5ed9-b421-8f08c4e0cb18%2f" data-bs-tooltip data-bs-title=WhatsApp role=button rel="noopener noreferrer nofollow" data-fn=popup><i class="fab fa-whatsapp fa-fw"></i></a></div><div class=col><a class="btn btn-light btn-social" href="https://tumblr.com/widgets/share/tool?canonicalUrl=https%3a%2f%2flib.onl%2fru%2f2023%2f10%2f6733cb51-62a0-5ed9-b421-8f08c4e0cb18%2f&amp;title=%d0%a1%d0%be%d0%b7%d0%b4%d0%b0%d0%bd%d0%b8%d0%b5%20%d1%81%d0%b5%d1%80%d1%82%d0%b8%d1%84%d0%b8%d0%ba%d0%b0%d1%82%d0%be%d0%b2%20%d0%bf%d1%80%d0%b8%20%d0%bf%d0%be%d0%bc%d0%be%d1%89%d0%b8%20OpenSSL&amp;content=%23OpenSSL%20%d1%8f%d0%b2%d0%bb%d1%8f%d0%b5%d1%82%d1%81%d1%8f%20%d0%b1%d0%b8%d0%b1%d0%bb%d0%b8%d0%be%d1%82%d0%b5%d0%ba%d0%be%d0%b9%20%d0%bf%d0%be%20%d1%80%d0%b0%d0%b1%d0%be%d1%82%d0%b5%20%d1%81%20%d0%ba%d1%80%d0%b8%d0%bf%d1%82%d0%be%d0%b3%d1%80%d0%b0%d1%84%d0%b8%d0%b5%d0%b9%2c%20%d0%bd%d0%be%20%d0%b2%20%d1%8d%d1%82%d0%be%d0%b9%20%d1%81%d1%82%d0%b0%d1%82%d1%8c%d0%b5%20%d1%8f%20%d0%b7%d0%b0%d1%82%d1%80%d0%be%d0%bd%d1%83%20%d1%82%d0%be%d0%bb%d1%8c%d0%ba%d0%be%20%d1%87%d0%b0%d1%81%d1%82%d1%8c%20%d1%84%d1%83%d0%bd%d0%ba%d1%86%d0%b8%d0%b9%20%d1%8d%d1%82%d0%be%d0%b3%d0%be%20%d0%b8%d0%bd%d1%81%d1%82%d1%80%d1%83%d0%bc%d0%b5%d0%bd%d1%82%d0%b0%2c%20%d0%b0%20%d0%b8%d0%bc%d0%b5%d0%bd%d0%bd%d0%be%20%d1%81%d0%be%d0%b7%d0%b4%d0%b0%d0%bd%d0%b8%d0%b5%20%d1%81%d0%b0%d0%bc%d0%be-%d0%bf%d0%be%d0%b4%d0%bf%d0%b8%d1%81%d0%b0%d0%bd%d0%bd%d1%8b%d1%85%20%d1%81%d0%b5%d1%80%d1%82%d0%b8%d1%84%d0%b8%d0%ba%d0%b0%d1%82%d0%be%d0%b2.%0a&amp;tags=openssl%2cbash%2c%d1%81%d0%b5%d1%80%d1%82%d0%b8%d1%84%d0%b8%d0%ba%d0%b0%d1%82%d1%8b&amp;posttype=link" data-bs-tooltip data-bs-title=Tumblr role=button rel="noopener noreferrer nofollow" data-fn=popup><i class="fab fa-tumblr fa-fw"></i></a></div><div class=col><a class="btn btn-light btn-social" href="https://wordpress.com/wp-admin/press-this.php?u=https%3a%2f%2flib.onl%2fru%2f2023%2f10%2f6733cb51-62a0-5ed9-b421-8f08c4e0cb18%2f&amp;t=%d0%a1%d0%be%d0%b7%d0%b4%d0%b0%d0%bd%d0%b8%d0%b5%20%d1%81%d0%b5%d1%80%d1%82%d0%b8%d1%84%d0%b8%d0%ba%d0%b0%d1%82%d0%be%d0%b2%20%d0%bf%d1%80%d0%b8%20%d0%bf%d0%be%d0%bc%d0%be%d1%89%d0%b8%20OpenSSL&amp;s=%23OpenSSL%20%d1%8f%d0%b2%d0%bb%d1%8f%d0%b5%d1%82%d1%81%d1%8f%20%d0%b1%d0%b8%d0%b1%d0%bb%d0%b8%d0%be%d1%82%d0%b5%d0%ba%d0%be%d0%b9%20%d0%bf%d0%be%20%d1%80%d0%b0%d0%b1%d0%be%d1%82%d0%b5%20%d1%81%20%d0%ba%d1%80%d0%b8%d0%bf%d1%82%d0%be%d0%b3%d1%80%d0%b0%d1%84%d0%b8%d0%b5%d0%b9%2c%20%d0%bd%d0%be%20%d0%b2%20%d1%8d%d1%82%d0%be%d0%b9%20%d1%81%d1%82%d0%b0%d1%82%d1%8c%d0%b5%20%d1%8f%20%d0%b7%d0%b0%d1%82%d1%80%d0%be%d0%bd%d1%83%20%d1%82%d0%be%d0%bb%d1%8c%d0%ba%d0%be%20%d1%87%d0%b0%d1%81%d1%82%d1%8c%20%d1%84%d1%83%d0%bd%d0%ba%d1%86%d0%b8%d0%b9%20%d1%8d%d1%82%d0%be%d0%b3%d0%be%20%d0%b8%d0%bd%d1%81%d1%82%d1%80%d1%83%d0%bc%d0%b5%d0%bd%d1%82%d0%b0%2c%20%d0%b0%20%d0%b8%d0%bc%d0%b5%d0%bd%d0%bd%d0%be%20%d1%81%d0%be%d0%b7%d0%b4%d0%b0%d0%bd%d0%b8%d0%b5%20%d1%81%d0%b0%d0%bc%d0%be-%d0%bf%d0%be%d0%b4%d0%bf%d0%b8%d1%81%d0%b0%d0%bd%d0%bd%d1%8b%d1%85%20%d1%81%d0%b5%d1%80%d1%82%d0%b8%d1%84%d0%b8%d0%ba%d0%b0%d1%82%d0%be%d0%b2.%0a" data-bs-tooltip data-bs-title=WordPress role=button rel="noopener noreferrer nofollow" data-fn=popup><i class="fab fa-wordpress fa-fw"></i></a></div></div></div><div class=col><div class=input-group><span class=input-group-text><i class="fas fa-link fa-fw"></i></span>
<input type=text class=form-control value=https://lib.onl/ru/2023/10/6733cb51-62a0-5ed9-b421-8f08c4e0cb18/ data-fn=select-all readonly></div></div><div class=col><div class=input-group><span class=input-group-text><i class="fas fa-file fa-fw"></i></span>
<input type=text class=form-control value=articles/2023/10/1697586151061_3819/index.md data-fn=select-all readonly></div></div></div></div><div class=col><div class="d-flex justify-content-center"><div class="d-block img-thumbnail" data-fn=qrcode data-qr-text=https://lib.onl/ru/2023/10/6733cb51-62a0-5ed9-b421-8f08c4e0cb18/></div></div></div></div></div></div></div></article></div></div></main><footer class="mt-auto border-top bg-body-tertiary" id=site-footer><div class="section py-5 border-bottom"><div class=container><div class="row g-3"><div class=col-lg><article><h2 class="h5 border-bottom pb-1 mb-3">О проекте</h2><div class=node-body><p>Заметки по системному администрированию и веб-разработкам.</p></div></article></div><div class=col-lg><article><h2 class="h5 border-bottom pb-1 mb-3">Ресурсы</h2><div class=node-body><ul><li><a title href=https://kai.kim/ target=_blank rel="noopener noreferrer">Kai Kimera</a></li><li><a title href=https://uaik.github.io/ target=_blank rel="noopener noreferrer">Universal AIK</a></li></ul></div></article></div><div class=col-lg><article><h2 class="h5 border-bottom pb-1 mb-3">Контакты</h2><div class=node-body><ul><li><a title href=mailto:mail@lib.onl target=_self rel>Email</a></li></ul></div></article></div></div></div></div><div class="section py-3 bg-body-secondary"><div class=container><div class="row row-cols-1 row-cols-lg-2 small text-body-secondary align-items-center"><div class="col text-center text-lg-start"><ul class="list-inline mb-0"><li class=list-inline-item><div>Library Online &copy; 2024</div><div>Заметки на тему администрирования и разработки различных систем, приложений и серверов.</div></li></ul></div><div class="col text-center text-lg-end"><ul class="list-inline mb-0"><li class=list-inline-item data-bs-tooltip data-bs-title=JSON><a class="btn btn-light btn-sm" href=/ru/2023/10/6733cb51-62a0-5ed9-b421-8f08c4e0cb18/index.json target=_blank aria-label=JSON><i class="fas fa-code fa-fw"></i></a></li><li class="list-inline-item dropup" data-bs-tooltip data-bs-title=Языки><a class="dropdown-toggle btn btn-light btn-sm" href=# role=button data-bs-toggle=dropdown aria-haspopup=true aria-expanded=false aria-label=Языки><i class="fas fa-language fa-fw"></i></a><div class="dropdown-menu dropdown-menu-end shadow"><a class=dropdown-item href=/ru/ hreflang=ru>Русский
</a><a class=dropdown-item href=/en/ hreflang=en>English</a></div></li></ul></div></div></div></div></footer><div class="modal fade" id=search-modal tabindex=-1 aria-labelledby=searchModalLabel aria-hidden=true><div class="modal-dialog modal-dialog-scrollable modal-xl"><div class=modal-content><div class=modal-header><h5 class=modal-title id=searchModalLabel>Поиск</h5><button type=button class=btn-close data-bs-dismiss=modal aria-label=Закрыть></button></div><div class="modal-body node-body"><div class="row row-cols-1 g-3"><div class=col><div class="row g-3"><div class=col-lg><form action=https://google.com/search method=get class=d-flex target=_blank><input type=hidden name=domains value=lib.onl>
<input type=hidden name=sitesearch value=lib.onl><div class=input-group><span class=input-group-text><i class="fas fa-search fa-fw"></i></span>
<input type=search class=form-control name=q placeholder='Поиск Google' aria-label='Поиск Google'>
<span class=input-group-text><i class="fab fa-google fa-fw"></i></span></div></form></div><div class=col-lg><form action=https://ya.ru/search method=get class=d-flex target=_blank><input type=hidden name=site value=lib.onl><div class=input-group><span class=input-group-text><i class="fas fa-search fa-fw"></i></span>
<input type=search class=form-control name=text placeholder='Поиск Яндекс' aria-label='Поиск Яндекс'>
<span class=input-group-text><i class="fab fa-yandex fa-fw"></i></span></div></form></div></div></div><div class=col><form id=search-form method=get class=d-flex autocomplete=off><div class=input-group><span class=input-group-text><i class="fas fa-search fa-fw"></i></span>
<input id=search-input type=search class=form-control name=q placeholder='Внутренний поиск' aria-label='Внутренний поиск'>
<span class=input-group-text><i class="fas fa-brain fa-fw"></i></span></div></form></div><div class=col><div class="list-group list-group-flush d-none overflow-auto" id=search-results></div><div id=search-help><div class="alert alert-info d-flex align-items-center overflow-hidden node-body" id=alert-0b857aae8b71e304f6bfc131dfc8065c role=alert><div class=flex-shrink-0><i class="fas fa-search fa-fw fa-2x"></i></div><div class="flex-grow-1 ms-3 overflow-hidden"><p>Используется нечёткий поиск (приблизительное сопоставление строк).
Это метод поиска строк, которые приблизительно соответствуют поисковому шаблону.</p><p>Результаты поиска сортируются по точности совпадения с поисковым шаблоном.
Результаты поиска, наиболее точно соответствующие запросу, находятся сверху, приблизительные результаты - снизу.</p></div></div></div></div></div></div></div></div></div><script src=/js/vendor.bundle.min.85b1a46641329b26e58b16e922d5e9797dbc96de73b50df4a9e8f4b897566128.js integrity="sha256-hbGkZkEymyblixbpItXpeX28lt5ztQ30qej0uJdWYSg=" crossorigin=anonymous defer></script><script src=/ru/js/system.bundle.min.e8278af4a5e659c111987a377887079e16ac2cb49267841b749d588d554f6820.js integrity="sha256-6CeK9KXmWcERmHo3eIcHnhasLLSSZ4QbdJ1YjVVPaCA=" crossorigin=anonymous defer></script><script src=https://giscus.app/client.js data-repo=s8956/comments data-repo-id=R_kgDOKgu0Tg data-category=Site data-category-id=DIC_kwDOKgu0Ts4CaJ2z data-mapping=pathname data-strict=1 data-reactions-enabled=1 data-emit-metadata=0 data-input-position=top data-theme=preferred_color_scheme data-lang=ru data-loading=lazy crossorigin=anonymous async></script><script type=application/ld+json>{"@context":"https://schema.org","@type":"Article","articleBody":"#OpenSSL является библиотекой по работе с криптографией, но в этой статье я затрону только часть функций этого инструмента, а именно создание само-подписанных сертификатов.\nСоздание центра сертификации При помощи корневого сертификата, мы будем подписывать сертификаты клиентские. Создаём сертификат центра сертификации\u0026hellip;\n1 openssl ecparam -genkey -name \u0026#39;secp384r1\u0026#39; | openssl ec -aes256 -out \u0026#34;_CA.key\u0026#34; \u0026amp;\u0026amp; openssl req -new -sha384 -key \u0026#34;_CA.key\u0026#34; -out \u0026#34;_CA.csr\u0026#34; \u0026amp;\u0026amp; openssl x509 -req -sha384 -days 3650 -key \u0026#34;_CA.key\u0026#34; -in \u0026#34;_CA.csr\u0026#34; -out \u0026#34;_CA.crt\u0026#34; Где:\n-days '3650' - количество дней, по прошествии которого сертификат центра сертификации станет недействительным. '_CA.key' - название создаваемого файла с ключом центра сертификации. '_CA.crt' - название создаваемого файла с сертификатом центра сертификации. Создание клиентского сертификата Как только будет готов корневой сертификат, можно приступать к выпуску клиентских сертификатов.\nСоздание приватного ключа Для начала создаём приватный ключ.\n1 openssl ecparam -genkey -name \u0026#39;prime256v1\u0026#39; | openssl ec -out \u0026#39;client.key\u0026#39; Где:\n-out 'client.key' - название создаваемого файла с клиентским приватным ключом. Создание запроса на подпись сертификата Выполняем запрос на сертификат.\n1 openssl req -new -key \u0026#39;client.key\u0026#39; -out \u0026#39;client.csr\u0026#39; Где:\n-key 'client.key' - файл с приватным ключом клиентского сертификата. -out 'client.csr' - название создаваемого файла с запросом на подпись клиентского сертификата. При выполнении запроса будет предложено ввести актуальные данные для будущего сертификата:\nCountry Name (2 letter code) - двухбуквенный код страны, в которой юридически находится ваша организация. State or Province Name (full name) - штат или провинция, в которой юридически находится ваша организация. Locality Name (e.g., city) - город, в котором юридически находится ваша организация. Organization Name (e.g., company) - юридически зарегистрированное название вашей организации. Organizational Unit Name (e.g., section) - название вашего отдела в организации (опционально). Common Name (e.g., server FQDN) - полное доменное имя (FQDN) (например, www.example.com). Email Address - ваш адрес email (опционально). A challenge password - пароль (опционально). An optional company name - необязательное название компании (опционально). Самое главное поле это Common Name (e.g., server FQDN) (CN), заполнять его необходимо очень внимательно.\nСоздание и подпись сертификата В заключительной части остаётся только создать сам сертификат и подписать его.\n1 openssl x509 -req -days 3650 -in \u0026#39;client.csr\u0026#39; -CA \u0026#39;_CA.crt\u0026#39; -CAkey \u0026#39;_CA.key\u0026#39; -out \u0026#39;client.crt\u0026#39; Где:\n-in 'client.csr' - файл с запросом клиентского сертификата. -CA '_CA.crt' - файл с сертификатом центра сертификации. -CAkey '_CA.key' - файл с ключом центра сертификации. -days '3650' - количество дней, по прошествии которого клиентский сертификат станет недействительным. -out 'client.crt' - название создаваемого файла с клиентским сертификатом. Экспорт сертификата Для того, чтобы импортировать сертификат на клиентские устройства, его необходимо экспортировать в формат P12. P12 является контейнером, в котором содержится приватный ключ сертификата и сам сертификат.\n1 openssl pkcs12 -export -inkey \u0026#39;client.key\u0026#39; -in \u0026#39;client.crt\u0026#39; -out \u0026#39;client.p12\u0026#39; Где:\n-inkey 'client.key' - файл с приватным клиентским ключом. -in 'client.crt' - файл с клиентским сертификатом. -out 'client.p12' - название создаваемого файла-контейнера с приватным ключом и сертификатом. Верификация сертификата 1 openssl verify -CAfile \u0026#39;_CA.crt\u0026#39; \u0026#39;client.crt\u0026#39; -CAfile '_CA.crt' - файл с сертификатом центра сертификации. 'client.crt' - файл с клиентским сертификатом. Просмотр сертификата 1 openssl x509 -in \u0026#39;client.crt\u0026#39; -text Где:\n-in 'client.crt' - файл с клиентским сертификатом. При выполнении команды, терминал покажет информацию со всеми основными сведениями о сертификате (пример ниже).\nТерминал 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 openssl x509 -in \u0026#39;client.crt\u0026#39; -text Certificate: Data: Version: 1 (0x0) Serial Number: 49:14:b8:78:17:a1:ca:c4:6a:41:1b:23:f3:8a:8d:36:e0:9e:69:81 Signature Algorithm: ecdsa-with-SHA256 Issuer: C = AU, ST = Some-State, O = Internet Widgits Pty Ltd, CN = CA Validity Not Before: Oct 18 21:31:53 2023 GMT Not After : Oct 15 21:31:53 2033 GMT Subject: C = AU, ST = Some-State, O = Internet Widgits Pty Ltd, CN = CN-FQDN, emailAddress = mail@example.com Subject Public Key Info: Public Key Algorithm: id-ecPublicKey Public-Key: (256 bit) pub: 04:9f:22:91:cc:14:b3:75:ad:44:cc:0d:96:0d:19: 04:c4:20:79:fd:b7:f5:65:64:dd:65:a1:f0:b8:2d: e4:02:75:62:41:03:7c:6e:2f:48:e4:11:38:dc:ed: 08:1f:4c:fa:5f:2f:a2:f5:5d:51:2e:8e:de:de:70: 33:aa:e5:3b:95 ASN1 OID: prime256v1 NIST CURVE: P-256 Signature Algorithm: ecdsa-with-SHA256 30:64:02:30:0d:ff:b1:dc:8b:a6:c6:9c:ad:65:8a:7c:01:41: 9f:91:ca:24:4c:0b:28:5a:5c:f6:35:2a:b2:d7:58:ca:39:da: 6c:bf:cf:8b:23:20:ce:11:45:13:61:36:e2:23:4a:e9:02:30: 54:dc:45:ed:ef:21:58:ea:c7:b6:63:db:a2:d9:71:fe:3d:b3: d6:1e:15:82:7b:c8:e8:08:33:d5:2f:d5:f2:8f:3b:41:ea:53: 1e:2d:a9:1e:9e:25:9c:fb:a7:12:f9:ec Просмотр запроса на подпись сертификата 1 openssl req -in \u0026#39;client.csr\u0026#39; -text Где:\n-in 'client.csr' - файл с запросом на подпись клиентского сертификата. Команда выдаст информацию по запросу на подпись клиентского сертификата (пример ниже).\nТерминал 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 openssl req -in \u0026#39;client.csr\u0026#39; -text Certificate Request: Data: Version: 1 (0x0) Subject: C = AU, ST = Some-State, O = Internet Widgits Pty Ltd, CN = CN-FQDN, emailAddress = mail@example.com Subject Public Key Info: Public Key Algorithm: id-ecPublicKey Public-Key: (256 bit) pub: 04:9f:22:91:cc:14:b3:75:ad:44:cc:0d:96:0d:19: 04:c4:20:79:fd:b7:f5:65:64:dd:65:a1:f0:b8:2d: e4:02:75:62:41:03:7c:6e:2f:48:e4:11:38:dc:ed: 08:1f:4c:fa:5f:2f:a2:f5:5d:51:2e:8e:de:de:70: 33:aa:e5:3b:95 ASN1 OID: prime256v1 NIST CURVE: P-256 Attributes: a0:00 Requested Extensions: Signature Algorithm: ecdsa-with-SHA256 30:45:02:20:51:9c:a0:b9:b2:61:7f:fa:64:ea:34:1f:65:15: 37:ae:f4:89:30:47:11:89:db:c4:1b:1d:9b:82:b9:64:ea:c7: 02:21:00:f8:00:70:4e:e6:db:99:78:cf:25:22:c0:8d:c6:b1: f3:f0:d8:68:3b:c2:51:21:a5:b3:fa:97:f9:85:c6:9c:49 Автоматизация Команд много. Поэтому я как обычно, решил всё автоматизировать и загнать в скрипт.\nbash.openssl.ca.sh 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 #!/usr/bin/env -S bash -e # # OpenSSL certificate generator with CA. # # @package Bash # @author Kai Kimera \u0026lt;mail@kai.kim\u0026gt; # @copyright 2023 Library Online # @license MIT # @version 0.1.2 # @link https://lib.onl/ru/articles/2023/10/6733cb51-62a0-5ed9-b421-8f08c4e0cb18/ # -------------------------------------------------------------------------------------------------------------------- # (( EUID == 0 )) \u0026amp;\u0026amp; { echo \u0026gt;\u0026amp;2 \u0026#39;This script should not be run as root!\u0026#39;; exit 1; } # -------------------------------------------------------------------------------------------------------------------- # # CONFIGURATION. # -------------------------------------------------------------------------------------------------------------------- # # Get \u0026#39;cat\u0026#39; command. cat=\u0026#34;$( command -v cat )\u0026#34; # Get \u0026#39;date\u0026#39; command. date=\u0026#34;$( command -v date )\u0026#34; # Get \u0026#39;mkdir\u0026#39; command. mkdir=\u0026#34;$( command -v mkdir )\u0026#34; # Get \u0026#39;openssl\u0026#39; command. ossl=\u0026#34;$( command -v openssl )\u0026#34; # Get \u0026#39;shuf\u0026#39; command. shuf=\u0026#34;$( command -v shuf )\u0026#34; # CA file names. ca=\u0026#39;_CA\u0026#39; # Specifies the number of days to make a certificate valid for. # Default is 10 years. days=\u0026#39;3650\u0026#39; # The two-letter country code where your company is legally located. country=\u0026#39;RU\u0026#39; # The state/province where your company is legally located. state=\u0026#39;Russia\u0026#39; # The city where your company is legally located. city=\u0026#39;Moscow\u0026#39; # Your company\u0026#39;s legally registered name (e.g., YourCompany, Inc.). org=\u0026#39;YourCompany\u0026#39; # Timestamp. ts=\u0026#34;$( ${date} -u \u0026#39;+%s\u0026#39; )\u0026#34; # Suffix. sfx=$( ${shuf} -i \u0026#39;1000-9999\u0026#39; -n 1 --random-source=\u0026#39;/dev/random\u0026#39; ) # -------------------------------------------------------------------------------------------------------------------- # # -----------------------------------------------------\u0026lt; SCRIPT \u0026gt;----------------------------------------------------- # # -------------------------------------------------------------------------------------------------------------------- # # -------------------------------------------------------------------------------------------------------------------- # # CERTIFICATE AUTHORITY. # -------------------------------------------------------------------------------------------------------------------- # ca() { ! [[ -x \u0026#34;${ossl}\u0026#34; ]] \u0026amp;\u0026amp; { echo \u0026gt;\u0026amp;2 \u0026#34;\u0026#39;openssl\u0026#39; is not installed!\u0026#34;; exit 1; } local name=\u0026#34;${1:-example.com}\u0026#34; local email=\u0026#34;${2:-mail@example.com}\u0026#34; local v3ext_ca=\u0026#39;_CA.v3ext\u0026#39; cat \u0026gt; \u0026#34;${v3ext_ca}\u0026#34; \u0026lt;\u0026lt;EOF authorityKeyIdentifier = keyid:always,issuer basicConstraints = critical, CA:TRUE keyUsage = critical, digitalSignature, cRLSign, keyCertSign EOF echo \u0026#39;\u0026#39; \u0026amp;\u0026amp; echo \u0026#34;--- [SSL-CA] CREATING A CA CERTIFICATE\u0026#34; \u0026amp;\u0026amp; echo \u0026#39;\u0026#39; ${ossl} ecparam -genkey -name \u0026#39;secp384r1\u0026#39; | ${ossl} ec -aes256 -out \u0026#34;${ca}.key\u0026#34; \\ \u0026amp;\u0026amp; ${ossl} req -new -sha384 -key \u0026#34;${ca}.key\u0026#34; -out \u0026#34;${ca}.csr\u0026#34; \\ -subj \u0026#34;/C=${country}/ST=${state}/L=${city}/O=${org}/emailAddress=${email}/CN=${name}\u0026#34; \\ \u0026amp;\u0026amp; ${ossl} x509 -req -extfile \u0026#34;${v3ext_ca}\u0026#34; -sha384 -days ${days} -key \u0026#34;${ca}.key\u0026#34; -in \u0026#34;${ca}.csr\u0026#34; -out \u0026#34;${ca}.crt\u0026#34; _info \u0026#34;${ca}.crt\u0026#34; } # -------------------------------------------------------------------------------------------------------------------- # # CLIENT CERTIFICATE. # -------------------------------------------------------------------------------------------------------------------- # cert() { for i in \u0026#34;${mkdir}\u0026#34; \u0026#34;${ossl}\u0026#34; \u0026#34;${shuf}\u0026#34;; do ! [[ -x \u0026#34;${i}\u0026#34; ]] \u0026amp;\u0026amp; { echo \u0026gt;\u0026amp;2 \u0026#34;\u0026#39;${i}\u0026#39; is not installed!\u0026#34;; exit 1; } done local name=\u0026#34;${1:-example.com}\u0026#34; local email=\u0026#34;${2:-mail@example.com}\u0026#34; local type=\u0026#34;${3:-server}\u0026#34;; [[ \u0026#34;${name}\u0026#34; = *\u0026#39; \u0026#39;* ]] \u0026amp;\u0026amp; type=\u0026#39;client\u0026#39; local dir=\u0026#34;${type}/${name// /_}\u0026#34;; ${mkdir} -p \u0026#34;${dir}\u0026#34; local file=\u0026#34;${dir}/${email}.${ts}.${sfx}\u0026#34; local v3ext if [[ \u0026#34;${type}\u0026#34; = \u0026#39;client\u0026#39; ]]; then v3ext=$( _v3ext_client \u0026#34;${file}.v3ext\u0026#34; ) else v3ext=$( _v3ext_server \u0026#34;${file}.v3ext\u0026#34; \u0026#34;${name}\u0026#34; ) fi echo \u0026#39;\u0026#39; \u0026amp;\u0026amp; echo \u0026#34;--- [SSL] CREATING A ${type^^} CERTIFICATE\u0026#34; \u0026amp;\u0026amp; echo \u0026#39;\u0026#39; ${ossl} ecparam -genkey -name \u0026#39;prime256v1\u0026#39; | ${ossl} ec -out \u0026#34;${file}.key\u0026#34; \\ \u0026amp;\u0026amp; ${ossl} req -new -key \u0026#34;${file}.key\u0026#34; -out \u0026#34;${file}.csr\u0026#34; \\ -subj \u0026#34;/C=${country}/ST=${state}/L=${city}/O=${org}/emailAddress=${email}/CN=${name}\u0026#34; \\ \u0026amp;\u0026amp; ${ossl} x509 -req -extfile \u0026#34;${v3ext}\u0026#34; -days ${days} -in \u0026#34;${file}.csr\u0026#34; \\ -CA \u0026#34;${ca}.crt\u0026#34; -CAkey \u0026#34;${ca}.key\u0026#34; -CAcreateserial -CAserial \u0026#34;${file}.srl\u0026#34; -out \u0026#34;${file}.crt\u0026#34; \\ \u0026amp;\u0026amp; ${cat} \u0026#34;${file}.key\u0026#34; \u0026#34;${file}.crt\u0026#34; \u0026#34;${ca}.crt\u0026#34; \u0026gt; \u0026#34;${file}.crt.chain\u0026#34; _verify \u0026#34;${ca}.crt\u0026#34; \u0026#34;${file}.crt\u0026#34; \u0026amp;\u0026amp; _info \u0026#34;${file}.crt\u0026#34; \u0026amp;\u0026amp; _export \u0026#34;${file}.key\u0026#34; \u0026#34;${file}.crt\u0026#34; \u0026#34;${file}.p12\u0026#34; } _verify() { echo \u0026#39;\u0026#39; \u0026amp;\u0026amp; echo \u0026#34;--- [SSL] CERTIFICATE VERIFICATION\u0026#34; \u0026amp;\u0026amp; echo \u0026#39;\u0026#39; for i in \u0026#34;${1}\u0026#34; \u0026#34;${2}\u0026#34;; do [[ ! -f \u0026#34;${i}\u0026#34; ]] \u0026amp;\u0026amp; { echo \u0026gt;\u0026amp;2 \u0026#34;\u0026#39;${i}\u0026#39; not found!\u0026#34;; exit 1; }; done ${ossl} verify -CAfile \u0026#34;${1}\u0026#34; \u0026#34;${2}\u0026#34; } _info() { echo \u0026#39;\u0026#39; \u0026amp;\u0026amp; echo \u0026#34;--- [SSL] CERTIFICATE DETAILS\u0026#34; \u0026amp;\u0026amp; echo \u0026#39;\u0026#39; [[ ! -f \u0026#34;${1}\u0026#34; ]] \u0026amp;\u0026amp; { echo \u0026gt;\u0026amp;2 \u0026#34;\u0026#39;${i}\u0026#39; not found!\u0026#34;; exit 1; } ${ossl} x509 -in \u0026#34;${1}\u0026#34; -text -noout } _export() { echo \u0026#39;\u0026#39; \u0026amp;\u0026amp; echo \u0026#34;--- [SSL] EXPORTING A CERTIFICATE\u0026#34; \u0026amp;\u0026amp; echo \u0026#39;\u0026#39; for i in \u0026#34;${1}\u0026#34; \u0026#34;${2}\u0026#34;; do [[ ! -f \u0026#34;${i}\u0026#34; ]] \u0026amp;\u0026amp; { echo \u0026gt;\u0026amp;2 \u0026#34;\u0026#39;${i}\u0026#39; not found!\u0026#34;; exit 1; }; done ${ossl} pkcs12 -export -inkey \u0026#34;${1}\u0026#34; -in \u0026#34;${2}\u0026#34; -out \u0026#34;${3}\u0026#34; } _v3ext_client() { cat \u0026gt; \u0026#34;${1}\u0026#34; \u0026lt;\u0026lt;EOF authorityKeyIdentifier = keyid,issuer basicConstraints = CA:FALSE extendedKeyUsage = clientAuth, emailProtection keyUsage = critical, digitalSignature, keyEncipherment, nonRepudiation nsCertType = client, email nsComment = \u0026#34;OpenSSL Generated Client Certificate\u0026#34; EOF echo -n \u0026#34;${1}\u0026#34; } _v3ext_server() { cat \u0026gt; \u0026#34;${1}\u0026#34; \u0026lt;\u0026lt;EOF authorityKeyIdentifier = keyid,issuer:always basicConstraints = CA:FALSE extendedKeyUsage = serverAuth keyUsage = critical, digitalSignature, keyEncipherment nsCertType = server nsComment = \u0026#34;OpenSSL Generated Server Certificate\u0026#34; subjectAltName = @alt_names [alt_names] DNS.1 = ${2} DNS.2 = *.${2} EOF echo -n \u0026#34;${1}\u0026#34; } # -------------------------------------------------------------------------------------------------------------------- # # -------------------------------------------------\u0026lt; RUNNING SCRIPT \u0026gt;------------------------------------------------- # # -------------------------------------------------------------------------------------------------------------------- # \u0026#34;$@\u0026#34; Скрипт содержит две функции, вызывать которых можно по отдельности. Функция ca() позволяет сгенерировать ключ и сертификат центра сертификации, а функция cert(), соответственно, генерирует клиентские сертификаты.\nИспользование Создать ключ и сертификат центра сертификации: Терминал 1 bash bash.openssl.ca.sh ca Создать клиентские ключи и сертификаты: Терминал 1 bash bash.openssl.ca.sh cert Немного расскажу про алгоритм генерации сертификатов.\nУ сертификата есть поле Serial Number, которое содержит серийный номер сертификата. Серийный номер сертификата это уникальный номер, выданный центром сертификации. В моём скрипте при генерации клиентского сертификата указаны опции -CAcreateserial и -CAserial \u0026quot;${srl}\u0026quot;, которые позволяют OpenSSL создавать рядом с клиентскими сертификатами файлы формата .slr, содержащие в себе серийные номера сгенерированных сертификатов. Таким образом можно создавать небольшую локальную базу данных выданных сертификатов. Файл каждого клиентского сертификата генерируется с названием вида [TS].[SFX].[EXE], где [TS] - это временная метка в микросекундах, [SFX] - числовой суффикс, а [EXE] - расширение файлов. На этом всё. Не исключаю факта присутствия ошибок или неточностей. Если что, жду предложения в электронную почту. 😄\nБыстрое создание само-подписанного сертификата Для быстрого создания само-подписанного сертификата, я написал пару небольших команд.\nECC (Elliptic Curve Cryptography) 1 ossl_days=\u0026#39;3650\u0026#39;; ossl_country=\u0026#39;RU\u0026#39;; ossl_state=\u0026#39;Russia\u0026#39;; ossl_city=\u0026#39;Moscow\u0026#39;; ossl_org=\u0026#39;RiK\u0026#39;; ossl_host=\u0026#39;example.com\u0026#39;; openssl ecparam -genkey -name \u0026#39;prime256v1\u0026#39; -out \u0026#34;${ossl_host}.key\u0026#34; \u0026amp;\u0026amp; openssl req -new -sha256 -key \u0026#34;${ossl_host}.key\u0026#34; -out \u0026#34;${ossl_host}.csr\u0026#34; -subj \u0026#34;/C=${ossl_country}/ST=${ossl_state}/L=${ossl_city}/O=${ossl_org}/CN=${ossl_host}\u0026#34; -addext \u0026#39;basicConstraints = critical, CA:FALSE\u0026#39; -addext \u0026#39;nsComment = OpenSSL Generated Certificate\u0026#39; -addext \u0026#39;keyUsage = critical, digitalSignature, keyEncipherment\u0026#39; -addext \u0026#39;extendedKeyUsage = serverAuth, clientAuth\u0026#39; -addext \u0026#34;subjectAltName=DNS:${ossl_host},DNS:*.${ossl_host}\u0026#34; \u0026amp;\u0026amp; openssl x509 -req -sha256 -days ${ossl_days} -copy_extensions \u0026#39;copyall\u0026#39; -key \u0026#34;${ossl_host}.key\u0026#34; -in \u0026#34;${ossl_host}.csr\u0026#34; -out \u0026#34;${ossl_host}.crt\u0026#34; \u0026amp;\u0026amp; openssl x509 -in \u0026#34;${ossl_host}.crt\u0026#34; -text -noout Где:\nossl_days - количество дней валидности сертификата. ossl_country - страна. ossl_state - штат. ossl_city - город. ossl_org - организация. ossl_host - хост. RSA (Rivest-Shamir-Adleman) 1 ossl_days=\u0026#39;3650\u0026#39;; ossl_country=\u0026#39;RU\u0026#39;; ossl_state=\u0026#39;Russia\u0026#39;; ossl_city=\u0026#39;Moscow\u0026#39;; ossl_org=\u0026#39;RiK\u0026#39;; ossl_host=\u0026#39;example.com\u0026#39;; openssl genrsa -out \u0026#34;${ossl_host}.key\u0026#34; 2048 \u0026amp;\u0026amp; openssl req -new -sha256 -key \u0026#34;${ossl_host}.key\u0026#34; -out \u0026#34;${ossl_host}.csr\u0026#34; -subj \u0026#34;/C=${ossl_country}/ST=${ossl_state}/L=${ossl_city}/O=${ossl_org}/CN=${ossl_host}\u0026#34; -addext \u0026#39;basicConstraints = critical, CA:FALSE\u0026#39; -addext \u0026#39;nsComment = OpenSSL Generated Certificate\u0026#39; -addext \u0026#39;keyUsage = critical, digitalSignature, keyEncipherment\u0026#39; -addext \u0026#39;extendedKeyUsage = serverAuth, clientAuth\u0026#39; -addext \u0026#34;subjectAltName=DNS:${ossl_host},DNS:*.${ossl_host}\u0026#34; \u0026amp;\u0026amp; openssl x509 -req -sha256 -days ${ossl_days} -copy_extensions \u0026#39;copyall\u0026#39; -key \u0026#34;${ossl_host}.key\u0026#34; -in \u0026#34;${ossl_host}.csr\u0026#34; -out \u0026#34;${ossl_host}.crt\u0026#34; \u0026amp;\u0026amp; openssl x509 -in \u0026#34;${ossl_host}.crt\u0026#34; -text -noout Где:\nossl_days - количество дней валидности сертификата. ossl_country - страна. ossl_state - штат. ossl_city - город. ossl_org - организация. ossl_host - хост. Скрипт bash.openssl.ssc.sh 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 #!/usr/bin/env -S bash -e # # OpenSSL self signed certificate generator. # # @package Bash # @author Kai Kimera \u0026lt;mail@kai.kim\u0026gt; # @copyright 2024 Library Online # @license MIT # @version 0.1.0 # @link https://lib.onl/ru/articles/2023/10/6733cb51-62a0-5ed9-b421-8f08c4e0cb18/ # -------------------------------------------------------------------------------------------------------------------- # (( EUID == 0 )) \u0026amp;\u0026amp; { echo \u0026gt;\u0026amp;2 \u0026#39;This script should not be run as root!\u0026#39;; exit 1; } # -------------------------------------------------------------------------------------------------------------------- # # CONFIGURATION. # -------------------------------------------------------------------------------------------------------------------- # # Get \u0026#39;openssl\u0026#39; command. ossl=\u0026#34;$( command -v openssl )\u0026#34; # Specifies the number of days to make a certificate valid for. # Default is 10 years. days=\u0026#39;3650\u0026#39; # The two-letter country code where your company is legally located. country=\u0026#39;RU\u0026#39; # The state/province where your company is legally located. state=\u0026#39;Russia\u0026#39; # The city where your company is legally located. city=\u0026#39;Moscow\u0026#39; # Your company\u0026#39;s legally registered name (e.g., YourCompany, Inc.). org=\u0026#39;YourCompany\u0026#39; # The fully-qualified domain name (FQDN) (e.g., www.example.com). host=\u0026#34;${1:-example.com}\u0026#34; # Your email address. email=\u0026#34;mail@${host}\u0026#34; # -------------------------------------------------------------------------------------------------------------------- # # -----------------------------------------------------\u0026lt; SCRIPT \u0026gt;----------------------------------------------------- # # -------------------------------------------------------------------------------------------------------------------- # ! [[ -x \u0026#34;${ossl}\u0026#34; ]] \u0026amp;\u0026amp; { echo \u0026gt;\u0026amp;2 \u0026#34;\u0026#39;openssl\u0026#39; is not installed!\u0026#34;; exit 1; } echo \u0026#34;\u0026#34; \u0026amp;\u0026amp; echo \u0026#34;--- [SSL] Self Signed Certificate: \u0026#39;${host}\u0026#39;\u0026#34; \u0026amp;\u0026amp; echo \u0026#34;\u0026#34; if [[ \u0026#34;${2}\u0026#34; = \u0026#39;rsa\u0026#39; ]]; then ${ossl} genrsa -out \u0026#34;${host}.key\u0026#34; 2048 else ${ossl} ecparam -genkey -name \u0026#39;prime256v1\u0026#39; -out \u0026#34;${host}.key\u0026#34; fi if [[ -f \u0026#34;${host}.key\u0026#34; ]]; then ${ossl} req -new -sha256 -key \u0026#34;${host}.key\u0026#34; -out \u0026#34;${host}.csr\u0026#34; \\ -subj \u0026#34;/C=${country}/ST=${state}/L=${city}/O=${org}/emailAddress=${email}/CN=${host}\u0026#34; \\ -addext \u0026#39;basicConstraints = critical, CA:FALSE\u0026#39; \\ -addext \u0026#39;nsComment = OpenSSL Generated Certificate\u0026#39; \\ -addext \u0026#39;keyUsage = critical, digitalSignature, keyEncipherment\u0026#39; \\ -addext \u0026#39;extendedKeyUsage = serverAuth, clientAuth\u0026#39; \\ -addext \u0026#34;subjectAltName=DNS:${host},DNS:*.${host}\u0026#34; \\ \u0026amp;\u0026amp; ${ossl} x509 -req -sha256 -days ${days} -copy_extensions \u0026#39;copyall\u0026#39; \\ -key \u0026#34;${host}.key\u0026#34; -in \u0026#34;${host}.csr\u0026#34; -out \u0026#34;${host}.crt\u0026#34; \\ \u0026amp;\u0026amp; ${ossl} x509 -in \u0026#34;${host}.crt\u0026#34; -text -noout else echo \u0026#34;\u0026#39;${host}.key\u0026#39; not found!\u0026#34; \u0026amp;\u0026amp; exit 1 fi exit 0 ","author":[{"@context":"https://schema.org","@type":"Person","address":{"@type":"PostalAddress","addressCountry":"Russia","addressLocality":"Reutov","addressRegion":"Moscow Region"},"alternateName":"Kai Kimera","award":["Грамота АО Институт ЭНЕРГОСЕТЬПРОЕКТ"],"birthDate":"1987-03-13","birthPlace":{"@type":"Place","address":{"@type":"PostalAddress","addressCountry":"Russia","addressLocality":"Reutov","addressRegion":"Moscow Region"}},"email":"mail@kai.kim","gender":"Male","image":"https://gravatar.com/avatar/911c0a839d7d4c3d750a8ce0de293e84?s=512","jobTitle":"System administrator","mainEntityOfPage":"https://lib.onl/ru/authors/kaikimera/","name":"Kai Kimera","sameAs":["https://github.com/KaiKimera","https://instagram.com/KaiKimera","https://twitter.com/KaiKimera","https://vk.com/KaiKimera","https://youtube.com/@KaiKimera"],"telephone":"+7 (000) 000-0000","url":"https://kai.kim/"}],"dateCreated":"2023-10-17T23:42:31Z","dateModified":"2024-04-05T11:57:00Z","datePublished":"2023-10-17T23:42:31Z","description":"#OpenSSL является библиотекой по работе с криптографией, но в этой статье я затрону только часть функций этого инструмента, а именно создание само-подписанных сертификатов.\n","headline":"Создание сертификатов при помощи OpenSSL","image":"https://images.unsplash.com/photo-1568057373189-8bf0cf6179e6","inLanguage":[{"@type":"Language","alternateName":"ru-RU","name":"Русский"}],"keywords":["openssl","bash","сертификаты"],"mainEntityOfPage":"https://lib.onl/ru/2023/10/6733cb51-62a0-5ed9-b421-8f08c4e0cb18/","pageEnd":1,"pageStart":1,"publisher":"https://lib.onl/#organization","text":"#OpenSSL является библиотекой по работе с криптографией, но в этой статье я затрону только часть функций этого инструмента, а именно создание само-подписанных сертификатов.\nСоздание центра сертификации При помощи корневого сертификата, мы будем подписывать сертификаты клиентские. Создаём сертификат центра сертификации\u0026hellip;\n1 openssl ecparam -genkey -name \u0026#39;secp384r1\u0026#39; | openssl ec -aes256 -out \u0026#34;_CA.key\u0026#34; \u0026amp;\u0026amp; openssl req -new -sha384 -key \u0026#34;_CA.key\u0026#34; -out \u0026#34;_CA.csr\u0026#34; \u0026amp;\u0026amp; openssl x509 -req -sha384 -days 3650 -key \u0026#34;_CA.key\u0026#34; -in \u0026#34;_CA.csr\u0026#34; -out \u0026#34;_CA.crt\u0026#34; Где:\n-days '3650' - количество дней, по прошествии которого сертификат центра сертификации станет недействительным. '_CA.key' - название создаваемого файла с ключом центра сертификации. '_CA.crt' - название создаваемого файла с сертификатом центра сертификации. Создание клиентского сертификата Как только будет готов корневой сертификат, можно приступать к выпуску клиентских сертификатов.\nСоздание приватного ключа Для начала создаём приватный ключ.\n1 openssl ecparam -genkey -name \u0026#39;prime256v1\u0026#39; | openssl ec -out \u0026#39;client.key\u0026#39; Где:\n-out 'client.key' - название создаваемого файла с клиентским приватным ключом. Создание запроса на подпись сертификата Выполняем запрос на сертификат.\n1 openssl req -new -key \u0026#39;client.key\u0026#39; -out \u0026#39;client.csr\u0026#39; Где:\n-key 'client.key' - файл с приватным ключом клиентского сертификата. -out 'client.csr' - название создаваемого файла с запросом на подпись клиентского сертификата. При выполнении запроса будет предложено ввести актуальные данные для будущего сертификата:\nCountry Name (2 letter code) - двухбуквенный код страны, в которой юридически находится ваша организация. State or Province Name (full name) - штат или провинция, в которой юридически находится ваша организация. Locality Name (e.g., city) - город, в котором юридически находится ваша организация. Organization Name (e.g., company) - юридически зарегистрированное название вашей организации. Organizational Unit Name (e.g., section) - название вашего отдела в организации (опционально). Common Name (e.g., server FQDN) - полное доменное имя (FQDN) (например, www.example.com). Email Address - ваш адрес email (опционально). A challenge password - пароль (опционально). An optional company name - необязательное название компании (опционально). Самое главное поле это Common Name (e.g., server FQDN) (CN), заполнять его необходимо очень внимательно.\nСоздание и подпись сертификата В заключительной части остаётся только создать сам сертификат и подписать его.\n1 openssl x509 -req -days 3650 -in \u0026#39;client.csr\u0026#39; -CA \u0026#39;_CA.crt\u0026#39; -CAkey \u0026#39;_CA.key\u0026#39; -out \u0026#39;client.crt\u0026#39; Где:\n-in 'client.csr' - файл с запросом клиентского сертификата. -CA '_CA.crt' - файл с сертификатом центра сертификации. -CAkey '_CA.key' - файл с ключом центра сертификации. -days '3650' - количество дней, по прошествии которого клиентский сертификат станет недействительным. -out 'client.crt' - название создаваемого файла с клиентским сертификатом. Экспорт сертификата Для того, чтобы импортировать сертификат на клиентские устройства, его необходимо экспортировать в формат P12. P12 является контейнером, в котором содержится приватный ключ сертификата и сам сертификат.\n1 openssl pkcs12 -export -inkey \u0026#39;client.key\u0026#39; -in \u0026#39;client.crt\u0026#39; -out \u0026#39;client.p12\u0026#39; Где:\n-inkey 'client.key' - файл с приватным клиентским ключом. -in 'client.crt' - файл с клиентским сертификатом. -out 'client.p12' - название создаваемого файла-контейнера с приватным ключом и сертификатом. Верификация сертификата 1 openssl verify -CAfile \u0026#39;_CA.crt\u0026#39; \u0026#39;client.crt\u0026#39; -CAfile '_CA.crt' - файл с сертификатом центра сертификации. 'client.crt' - файл с клиентским сертификатом. Просмотр сертификата 1 openssl x509 -in \u0026#39;client.crt\u0026#39; -text Где:\n-in 'client.crt' - файл с клиентским сертификатом. При выполнении команды, терминал покажет информацию со всеми основными сведениями о сертификате (пример ниже).\nТерминал 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 openssl x509 -in \u0026#39;client.crt\u0026#39; -text Certificate: Data: Version: 1 (0x0) Serial Number: 49:14:b8:78:17:a1:ca:c4:6a:41:1b:23:f3:8a:8d:36:e0:9e:69:81 Signature Algorithm: ecdsa-with-SHA256 Issuer: C = AU, ST = Some-State, O = Internet Widgits Pty Ltd, CN = CA Validity Not Before: Oct 18 21:31:53 2023 GMT Not After : Oct 15 21:31:53 2033 GMT Subject: C = AU, ST = Some-State, O = Internet Widgits Pty Ltd, CN = CN-FQDN, emailAddress = mail@example.com Subject Public Key Info: Public Key Algorithm: id-ecPublicKey Public-Key: (256 bit) pub: 04:9f:22:91:cc:14:b3:75:ad:44:cc:0d:96:0d:19: 04:c4:20:79:fd:b7:f5:65:64:dd:65:a1:f0:b8:2d: e4:02:75:62:41:03:7c:6e:2f:48:e4:11:38:dc:ed: 08:1f:4c:fa:5f:2f:a2:f5:5d:51:2e:8e:de:de:70: 33:aa:e5:3b:95 ASN1 OID: prime256v1 NIST CURVE: P-256 Signature Algorithm: ecdsa-with-SHA256 30:64:02:30:0d:ff:b1:dc:8b:a6:c6:9c:ad:65:8a:7c:01:41: 9f:91:ca:24:4c:0b:28:5a:5c:f6:35:2a:b2:d7:58:ca:39:da: 6c:bf:cf:8b:23:20:ce:11:45:13:61:36:e2:23:4a:e9:02:30: 54:dc:45:ed:ef:21:58:ea:c7:b6:63:db:a2:d9:71:fe:3d:b3: d6:1e:15:82:7b:c8:e8:08:33:d5:2f:d5:f2:8f:3b:41:ea:53: 1e:2d:a9:1e:9e:25:9c:fb:a7:12:f9:ec Просмотр запроса на подпись сертификата 1 openssl req -in \u0026#39;client.csr\u0026#39; -text Где:\n-in 'client.csr' - файл с запросом на подпись клиентского сертификата. Команда выдаст информацию по запросу на подпись клиентского сертификата (пример ниже).\nТерминал 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 openssl req -in \u0026#39;client.csr\u0026#39; -text Certificate Request: Data: Version: 1 (0x0) Subject: C = AU, ST = Some-State, O = Internet Widgits Pty Ltd, CN = CN-FQDN, emailAddress = mail@example.com Subject Public Key Info: Public Key Algorithm: id-ecPublicKey Public-Key: (256 bit) pub: 04:9f:22:91:cc:14:b3:75:ad:44:cc:0d:96:0d:19: 04:c4:20:79:fd:b7:f5:65:64:dd:65:a1:f0:b8:2d: e4:02:75:62:41:03:7c:6e:2f:48:e4:11:38:dc:ed: 08:1f:4c:fa:5f:2f:a2:f5:5d:51:2e:8e:de:de:70: 33:aa:e5:3b:95 ASN1 OID: prime256v1 NIST CURVE: P-256 Attributes: a0:00 Requested Extensions: Signature Algorithm: ecdsa-with-SHA256 30:45:02:20:51:9c:a0:b9:b2:61:7f:fa:64:ea:34:1f:65:15: 37:ae:f4:89:30:47:11:89:db:c4:1b:1d:9b:82:b9:64:ea:c7: 02:21:00:f8:00:70:4e:e6:db:99:78:cf:25:22:c0:8d:c6:b1: f3:f0:d8:68:3b:c2:51:21:a5:b3:fa:97:f9:85:c6:9c:49 Автоматизация Команд много. Поэтому я как обычно, решил всё автоматизировать и загнать в скрипт.\nbash.openssl.ca.sh 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 #!/usr/bin/env -S bash -e # # OpenSSL certificate generator with CA. # # @package Bash # @author Kai Kimera \u0026lt;mail@kai.kim\u0026gt; # @copyright 2023 Library Online # @license MIT # @version 0.1.2 # @link https://lib.onl/ru/articles/2023/10/6733cb51-62a0-5ed9-b421-8f08c4e0cb18/ # -------------------------------------------------------------------------------------------------------------------- # (( EUID == 0 )) \u0026amp;\u0026amp; { echo \u0026gt;\u0026amp;2 \u0026#39;This script should not be run as root!\u0026#39;; exit 1; } # -------------------------------------------------------------------------------------------------------------------- # # CONFIGURATION. # -------------------------------------------------------------------------------------------------------------------- # # Get \u0026#39;cat\u0026#39; command. cat=\u0026#34;$( command -v cat )\u0026#34; # Get \u0026#39;date\u0026#39; command. date=\u0026#34;$( command -v date )\u0026#34; # Get \u0026#39;mkdir\u0026#39; command. mkdir=\u0026#34;$( command -v mkdir )\u0026#34; # Get \u0026#39;openssl\u0026#39; command. ossl=\u0026#34;$( command -v openssl )\u0026#34; # Get \u0026#39;shuf\u0026#39; command. shuf=\u0026#34;$( command -v shuf )\u0026#34; # CA file names. ca=\u0026#39;_CA\u0026#39; # Specifies the number of days to make a certificate valid for. # Default is 10 years. days=\u0026#39;3650\u0026#39; # The two-letter country code where your company is legally located. country=\u0026#39;RU\u0026#39; # The state/province where your company is legally located. state=\u0026#39;Russia\u0026#39; # The city where your company is legally located. city=\u0026#39;Moscow\u0026#39; # Your company\u0026#39;s legally registered name (e.g., YourCompany, Inc.). org=\u0026#39;YourCompany\u0026#39; # Timestamp. ts=\u0026#34;$( ${date} -u \u0026#39;+%s\u0026#39; )\u0026#34; # Suffix. sfx=$( ${shuf} -i \u0026#39;1000-9999\u0026#39; -n 1 --random-source=\u0026#39;/dev/random\u0026#39; ) # -------------------------------------------------------------------------------------------------------------------- # # -----------------------------------------------------\u0026lt; SCRIPT \u0026gt;----------------------------------------------------- # # -------------------------------------------------------------------------------------------------------------------- # # -------------------------------------------------------------------------------------------------------------------- # # CERTIFICATE AUTHORITY. # -------------------------------------------------------------------------------------------------------------------- # ca() { ! [[ -x \u0026#34;${ossl}\u0026#34; ]] \u0026amp;\u0026amp; { echo \u0026gt;\u0026amp;2 \u0026#34;\u0026#39;openssl\u0026#39; is not installed!\u0026#34;; exit 1; } local name=\u0026#34;${1:-example.com}\u0026#34; local email=\u0026#34;${2:-mail@example.com}\u0026#34; local v3ext_ca=\u0026#39;_CA.v3ext\u0026#39; cat \u0026gt; \u0026#34;${v3ext_ca}\u0026#34; \u0026lt;\u0026lt;EOF authorityKeyIdentifier = keyid:always,issuer basicConstraints = critical, CA:TRUE keyUsage = critical, digitalSignature, cRLSign, keyCertSign EOF echo \u0026#39;\u0026#39; \u0026amp;\u0026amp; echo \u0026#34;--- [SSL-CA] CREATING A CA CERTIFICATE\u0026#34; \u0026amp;\u0026amp; echo \u0026#39;\u0026#39; ${ossl} ecparam -genkey -name \u0026#39;secp384r1\u0026#39; | ${ossl} ec -aes256 -out \u0026#34;${ca}.key\u0026#34; \\ \u0026amp;\u0026amp; ${ossl} req -new -sha384 -key \u0026#34;${ca}.key\u0026#34; -out \u0026#34;${ca}.csr\u0026#34; \\ -subj \u0026#34;/C=${country}/ST=${state}/L=${city}/O=${org}/emailAddress=${email}/CN=${name}\u0026#34; \\ \u0026amp;\u0026amp; ${ossl} x509 -req -extfile \u0026#34;${v3ext_ca}\u0026#34; -sha384 -days ${days} -key \u0026#34;${ca}.key\u0026#34; -in \u0026#34;${ca}.csr\u0026#34; -out \u0026#34;${ca}.crt\u0026#34; _info \u0026#34;${ca}.crt\u0026#34; } # -------------------------------------------------------------------------------------------------------------------- # # CLIENT CERTIFICATE. # -------------------------------------------------------------------------------------------------------------------- # cert() { for i in \u0026#34;${mkdir}\u0026#34; \u0026#34;${ossl}\u0026#34; \u0026#34;${shuf}\u0026#34;; do ! [[ -x \u0026#34;${i}\u0026#34; ]] \u0026amp;\u0026amp; { echo \u0026gt;\u0026amp;2 \u0026#34;\u0026#39;${i}\u0026#39; is not installed!\u0026#34;; exit 1; } done local name=\u0026#34;${1:-example.com}\u0026#34; local email=\u0026#34;${2:-mail@example.com}\u0026#34; local type=\u0026#34;${3:-server}\u0026#34;; [[ \u0026#34;${name}\u0026#34; = *\u0026#39; \u0026#39;* ]] \u0026amp;\u0026amp; type=\u0026#39;client\u0026#39; local dir=\u0026#34;${type}/${name// /_}\u0026#34;; ${mkdir} -p \u0026#34;${dir}\u0026#34; local file=\u0026#34;${dir}/${email}.${ts}.${sfx}\u0026#34; local v3ext if [[ \u0026#34;${type}\u0026#34; = \u0026#39;client\u0026#39; ]]; then v3ext=$( _v3ext_client \u0026#34;${file}.v3ext\u0026#34; ) else v3ext=$( _v3ext_server \u0026#34;${file}.v3ext\u0026#34; \u0026#34;${name}\u0026#34; ) fi echo \u0026#39;\u0026#39; \u0026amp;\u0026amp; echo \u0026#34;--- [SSL] CREATING A ${type^^} CERTIFICATE\u0026#34; \u0026amp;\u0026amp; echo \u0026#39;\u0026#39; ${ossl} ecparam -genkey -name \u0026#39;prime256v1\u0026#39; | ${ossl} ec -out \u0026#34;${file}.key\u0026#34; \\ \u0026amp;\u0026amp; ${ossl} req -new -key \u0026#34;${file}.key\u0026#34; -out \u0026#34;${file}.csr\u0026#34; \\ -subj \u0026#34;/C=${country}/ST=${state}/L=${city}/O=${org}/emailAddress=${email}/CN=${name}\u0026#34; \\ \u0026amp;\u0026amp; ${ossl} x509 -req -extfile \u0026#34;${v3ext}\u0026#34; -days ${days} -in \u0026#34;${file}.csr\u0026#34; \\ -CA \u0026#34;${ca}.crt\u0026#34; -CAkey \u0026#34;${ca}.key\u0026#34; -CAcreateserial -CAserial \u0026#34;${file}.srl\u0026#34; -out \u0026#34;${file}.crt\u0026#34; \\ \u0026amp;\u0026amp; ${cat} \u0026#34;${file}.key\u0026#34; \u0026#34;${file}.crt\u0026#34; \u0026#34;${ca}.crt\u0026#34; \u0026gt; \u0026#34;${file}.crt.chain\u0026#34; _verify \u0026#34;${ca}.crt\u0026#34; \u0026#34;${file}.crt\u0026#34; \u0026amp;\u0026amp; _info \u0026#34;${file}.crt\u0026#34; \u0026amp;\u0026amp; _export \u0026#34;${file}.key\u0026#34; \u0026#34;${file}.crt\u0026#34; \u0026#34;${file}.p12\u0026#34; } _verify() { echo \u0026#39;\u0026#39; \u0026amp;\u0026amp; echo \u0026#34;--- [SSL] CERTIFICATE VERIFICATION\u0026#34; \u0026amp;\u0026amp; echo \u0026#39;\u0026#39; for i in \u0026#34;${1}\u0026#34; \u0026#34;${2}\u0026#34;; do [[ ! -f \u0026#34;${i}\u0026#34; ]] \u0026amp;\u0026amp; { echo \u0026gt;\u0026amp;2 \u0026#34;\u0026#39;${i}\u0026#39; not found!\u0026#34;; exit 1; }; done ${ossl} verify -CAfile \u0026#34;${1}\u0026#34; \u0026#34;${2}\u0026#34; } _info() { echo \u0026#39;\u0026#39; \u0026amp;\u0026amp; echo \u0026#34;--- [SSL] CERTIFICATE DETAILS\u0026#34; \u0026amp;\u0026amp; echo \u0026#39;\u0026#39; [[ ! -f \u0026#34;${1}\u0026#34; ]] \u0026amp;\u0026amp; { echo \u0026gt;\u0026amp;2 \u0026#34;\u0026#39;${i}\u0026#39; not found!\u0026#34;; exit 1; } ${ossl} x509 -in \u0026#34;${1}\u0026#34; -text -noout } _export() { echo \u0026#39;\u0026#39; \u0026amp;\u0026amp; echo \u0026#34;--- [SSL] EXPORTING A CERTIFICATE\u0026#34; \u0026amp;\u0026amp; echo \u0026#39;\u0026#39; for i in \u0026#34;${1}\u0026#34; \u0026#34;${2}\u0026#34;; do [[ ! -f \u0026#34;${i}\u0026#34; ]] \u0026amp;\u0026amp; { echo \u0026gt;\u0026amp;2 \u0026#34;\u0026#39;${i}\u0026#39; not found!\u0026#34;; exit 1; }; done ${ossl} pkcs12 -export -inkey \u0026#34;${1}\u0026#34; -in \u0026#34;${2}\u0026#34; -out \u0026#34;${3}\u0026#34; } _v3ext_client() { cat \u0026gt; \u0026#34;${1}\u0026#34; \u0026lt;\u0026lt;EOF authorityKeyIdentifier = keyid,issuer basicConstraints = CA:FALSE extendedKeyUsage = clientAuth, emailProtection keyUsage = critical, digitalSignature, keyEncipherment, nonRepudiation nsCertType = client, email nsComment = \u0026#34;OpenSSL Generated Client Certificate\u0026#34; EOF echo -n \u0026#34;${1}\u0026#34; } _v3ext_server() { cat \u0026gt; \u0026#34;${1}\u0026#34; \u0026lt;\u0026lt;EOF authorityKeyIdentifier = keyid,issuer:always basicConstraints = CA:FALSE extendedKeyUsage = serverAuth keyUsage = critical, digitalSignature, keyEncipherment nsCertType = server nsComment = \u0026#34;OpenSSL Generated Server Certificate\u0026#34; subjectAltName = @alt_names [alt_names] DNS.1 = ${2} DNS.2 = *.${2} EOF echo -n \u0026#34;${1}\u0026#34; } # -------------------------------------------------------------------------------------------------------------------- # # -------------------------------------------------\u0026lt; RUNNING SCRIPT \u0026gt;------------------------------------------------- # # -------------------------------------------------------------------------------------------------------------------- # \u0026#34;$@\u0026#34; Скрипт содержит две функции, вызывать которых можно по отдельности. Функция ca() позволяет сгенерировать ключ и сертификат центра сертификации, а функция cert(), соответственно, генерирует клиентские сертификаты.\nИспользование Создать ключ и сертификат центра сертификации: Терминал 1 bash bash.openssl.ca.sh ca Создать клиентские ключи и сертификаты: Терминал 1 bash bash.openssl.ca.sh cert Немного расскажу про алгоритм генерации сертификатов.\nУ сертификата есть поле Serial Number, которое содержит серийный номер сертификата. Серийный номер сертификата это уникальный номер, выданный центром сертификации. В моём скрипте при генерации клиентского сертификата указаны опции -CAcreateserial и -CAserial \u0026quot;${srl}\u0026quot;, которые позволяют OpenSSL создавать рядом с клиентскими сертификатами файлы формата .slr, содержащие в себе серийные номера сгенерированных сертификатов. Таким образом можно создавать небольшую локальную базу данных выданных сертификатов. Файл каждого клиентского сертификата генерируется с названием вида [TS].[SFX].[EXE], где [TS] - это временная метка в микросекундах, [SFX] - числовой суффикс, а [EXE] - расширение файлов. На этом всё. Не исключаю факта присутствия ошибок или неточностей. Если что, жду предложения в электронную почту. 😄\nБыстрое создание само-подписанного сертификата Для быстрого создания само-подписанного сертификата, я написал пару небольших команд.\nECC (Elliptic Curve Cryptography) 1 ossl_days=\u0026#39;3650\u0026#39;; ossl_country=\u0026#39;RU\u0026#39;; ossl_state=\u0026#39;Russia\u0026#39;; ossl_city=\u0026#39;Moscow\u0026#39;; ossl_org=\u0026#39;RiK\u0026#39;; ossl_host=\u0026#39;example.com\u0026#39;; openssl ecparam -genkey -name \u0026#39;prime256v1\u0026#39; -out \u0026#34;${ossl_host}.key\u0026#34; \u0026amp;\u0026amp; openssl req -new -sha256 -key \u0026#34;${ossl_host}.key\u0026#34; -out \u0026#34;${ossl_host}.csr\u0026#34; -subj \u0026#34;/C=${ossl_country}/ST=${ossl_state}/L=${ossl_city}/O=${ossl_org}/CN=${ossl_host}\u0026#34; -addext \u0026#39;basicConstraints = critical, CA:FALSE\u0026#39; -addext \u0026#39;nsComment = OpenSSL Generated Certificate\u0026#39; -addext \u0026#39;keyUsage = critical, digitalSignature, keyEncipherment\u0026#39; -addext \u0026#39;extendedKeyUsage = serverAuth, clientAuth\u0026#39; -addext \u0026#34;subjectAltName=DNS:${ossl_host},DNS:*.${ossl_host}\u0026#34; \u0026amp;\u0026amp; openssl x509 -req -sha256 -days ${ossl_days} -copy_extensions \u0026#39;copyall\u0026#39; -key \u0026#34;${ossl_host}.key\u0026#34; -in \u0026#34;${ossl_host}.csr\u0026#34; -out \u0026#34;${ossl_host}.crt\u0026#34; \u0026amp;\u0026amp; openssl x509 -in \u0026#34;${ossl_host}.crt\u0026#34; -text -noout Где:\nossl_days - количество дней валидности сертификата. ossl_country - страна. ossl_state - штат. ossl_city - город. ossl_org - организация. ossl_host - хост. RSA (Rivest-Shamir-Adleman) 1 ossl_days=\u0026#39;3650\u0026#39;; ossl_country=\u0026#39;RU\u0026#39;; ossl_state=\u0026#39;Russia\u0026#39;; ossl_city=\u0026#39;Moscow\u0026#39;; ossl_org=\u0026#39;RiK\u0026#39;; ossl_host=\u0026#39;example.com\u0026#39;; openssl genrsa -out \u0026#34;${ossl_host}.key\u0026#34; 2048 \u0026amp;\u0026amp; openssl req -new -sha256 -key \u0026#34;${ossl_host}.key\u0026#34; -out \u0026#34;${ossl_host}.csr\u0026#34; -subj \u0026#34;/C=${ossl_country}/ST=${ossl_state}/L=${ossl_city}/O=${ossl_org}/CN=${ossl_host}\u0026#34; -addext \u0026#39;basicConstraints = critical, CA:FALSE\u0026#39; -addext \u0026#39;nsComment = OpenSSL Generated Certificate\u0026#39; -addext \u0026#39;keyUsage = critical, digitalSignature, keyEncipherment\u0026#39; -addext \u0026#39;extendedKeyUsage = serverAuth, clientAuth\u0026#39; -addext \u0026#34;subjectAltName=DNS:${ossl_host},DNS:*.${ossl_host}\u0026#34; \u0026amp;\u0026amp; openssl x509 -req -sha256 -days ${ossl_days} -copy_extensions \u0026#39;copyall\u0026#39; -key \u0026#34;${ossl_host}.key\u0026#34; -in \u0026#34;${ossl_host}.csr\u0026#34; -out \u0026#34;${ossl_host}.crt\u0026#34; \u0026amp;\u0026amp; openssl x509 -in \u0026#34;${ossl_host}.crt\u0026#34; -text -noout Где:\nossl_days - количество дней валидности сертификата. ossl_country - страна. ossl_state - штат. ossl_city - город. ossl_org - организация. ossl_host - хост. Скрипт bash.openssl.ssc.sh 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 #!/usr/bin/env -S bash -e # # OpenSSL self signed certificate generator. # # @package Bash # @author Kai Kimera \u0026lt;mail@kai.kim\u0026gt; # @copyright 2024 Library Online # @license MIT # @version 0.1.0 # @link https://lib.onl/ru/articles/2023/10/6733cb51-62a0-5ed9-b421-8f08c4e0cb18/ # -------------------------------------------------------------------------------------------------------------------- # (( EUID == 0 )) \u0026amp;\u0026amp; { echo \u0026gt;\u0026amp;2 \u0026#39;This script should not be run as root!\u0026#39;; exit 1; } # -------------------------------------------------------------------------------------------------------------------- # # CONFIGURATION. # -------------------------------------------------------------------------------------------------------------------- # # Get \u0026#39;openssl\u0026#39; command. ossl=\u0026#34;$( command -v openssl )\u0026#34; # Specifies the number of days to make a certificate valid for. # Default is 10 years. days=\u0026#39;3650\u0026#39; # The two-letter country code where your company is legally located. country=\u0026#39;RU\u0026#39; # The state/province where your company is legally located. state=\u0026#39;Russia\u0026#39; # The city where your company is legally located. city=\u0026#39;Moscow\u0026#39; # Your company\u0026#39;s legally registered name (e.g., YourCompany, Inc.). org=\u0026#39;YourCompany\u0026#39; # The fully-qualified domain name (FQDN) (e.g., www.example.com). host=\u0026#34;${1:-example.com}\u0026#34; # Your email address. email=\u0026#34;mail@${host}\u0026#34; # -------------------------------------------------------------------------------------------------------------------- # # -----------------------------------------------------\u0026lt; SCRIPT \u0026gt;----------------------------------------------------- # # -------------------------------------------------------------------------------------------------------------------- # ! [[ -x \u0026#34;${ossl}\u0026#34; ]] \u0026amp;\u0026amp; { echo \u0026gt;\u0026amp;2 \u0026#34;\u0026#39;openssl\u0026#39; is not installed!\u0026#34;; exit 1; } echo \u0026#34;\u0026#34; \u0026amp;\u0026amp; echo \u0026#34;--- [SSL] Self Signed Certificate: \u0026#39;${host}\u0026#39;\u0026#34; \u0026amp;\u0026amp; echo \u0026#34;\u0026#34; if [[ \u0026#34;${2}\u0026#34; = \u0026#39;rsa\u0026#39; ]]; then ${ossl} genrsa -out \u0026#34;${host}.key\u0026#34; 2048 else ${ossl} ecparam -genkey -name \u0026#39;prime256v1\u0026#39; -out \u0026#34;${host}.key\u0026#34; fi if [[ -f \u0026#34;${host}.key\u0026#34; ]]; then ${ossl} req -new -sha256 -key \u0026#34;${host}.key\u0026#34; -out \u0026#34;${host}.csr\u0026#34; \\ -subj \u0026#34;/C=${country}/ST=${state}/L=${city}/O=${org}/emailAddress=${email}/CN=${host}\u0026#34; \\ -addext \u0026#39;basicConstraints = critical, CA:FALSE\u0026#39; \\ -addext \u0026#39;nsComment = OpenSSL Generated Certificate\u0026#39; \\ -addext \u0026#39;keyUsage = critical, digitalSignature, keyEncipherment\u0026#39; \\ -addext \u0026#39;extendedKeyUsage = serverAuth, clientAuth\u0026#39; \\ -addext \u0026#34;subjectAltName=DNS:${host},DNS:*.${host}\u0026#34; \\ \u0026amp;\u0026amp; ${ossl} x509 -req -sha256 -days ${days} -copy_extensions \u0026#39;copyall\u0026#39; \\ -key \u0026#34;${host}.key\u0026#34; -in \u0026#34;${host}.csr\u0026#34; -out \u0026#34;${host}.crt\u0026#34; \\ \u0026amp;\u0026amp; ${ossl} x509 -in \u0026#34;${host}.crt\u0026#34; -text -noout else echo \u0026#34;\u0026#39;${host}.key\u0026#39; not found!\u0026#34; \u0026amp;\u0026amp; exit 1 fi exit 0 ","url":"https://lib.onl/ru/2023/10/6733cb51-62a0-5ed9-b421-8f08c4e0cb18/","wordCount":2355}</script><script type=application/ld+json>{"@context":"https://schema.org","@id":"https://lib.onl/#website","@type":"WebSite","description":"Заметки на тему администрирования и разработки различных систем, приложений и серверов.","hasPart":[{"@context":"https://schema.org","@type":"WPHeader","cssSelector":"#site-header","headline":"headline-string"},{"@context":"https://schema.org","@type":"WPFooter","copyrightHolder":"https://lib.onl/#organization","copyrightYear":"2024","cssSelector":"#site-footer","publisher":"https://lib.onl/#organization"}],"inLanguage":[{"@type":"Language","alternateName":"ru-RU","name":"Русский"}],"keywords":["Powershell","Forum","Debian","Ipb","Ips","Mikrotik","Cisco","Routeros","Bash","Dns","Freebsd","Cmd","Cmf","Cms","Vbulletin","Chmod","Cloudflare","Fedora","Git","Ios"],"mainEntityOfPage":"https://lib.onl/","name":"Library Online","publisher":"https://lib.onl/#organization","url":"https://lib.onl/"}</script><script type=application/ld+json>{"@context":"https://schema.org","@id":"https://lib.onl/#organization","@type":"Organization","address":{"@type":"PostalAddress","addressCountry":"Russia","addressLocality":"Moscow","addressRegion":"Moscow Region"},"contactPoint":{"@type":"ContactPoint","contactType":"customer service","email":"mail@lib.onl","telephone":"+7 (000) 000-0000"},"description":"Заметки на тему администрирования и разработки различных систем, приложений и серверов.","foundingDate":"2020","legalName":"Library Online","logo":{"@type":"ImageObject","url":"https://lib.onl/img/logo.min.svg"},"mainEntityOfPage":"https://lib.onl/","name":"Library Online","sameAs":[""],"url":"https://lib.onl/"}</script><script type=application/ld+json>{"@context":"https://schema.org","@graph":[{"@type":"SiteNavigationElement","name":"Статьи","position":10,"url":"https://lib.onl/ru/articles/"},{"@type":"SiteNavigationElement","name":"Q\u0026A","position":20,"url":"https://lib.onl/ru/faq/"},{"@type":"SiteNavigationElement","name":"Архив","position":100,"url":"https://lib.onl/ru/archive/"},{"@type":"SiteNavigationElement","name":"О проекте","position":999,"url":"https://lib.onl/ru/about/"},{"@type":"SiteNavigationElement","name":"META","position":9999,"url":"https://lib.onl/ru/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","item":{"@id":"https://lib.onl/ru/","name":"Главная"},"position":1},{"@type":"ListItem","item":{"@id":"https://lib.onl/ru/articles/","name":"Статьи"},"position":2},{"@type":"ListItem","item":{"@id":"https://lib.onl/ru/2023/10/6733cb51-62a0-5ed9-b421-8f08c4e0cb18/","name":"Создание сертификатов при помощи OpenSSL"},"position":3}]}</script></body></html>