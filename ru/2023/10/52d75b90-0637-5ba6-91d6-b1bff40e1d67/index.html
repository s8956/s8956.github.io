<!doctype html><html class=h-100 dir=ltr lang=ru-RU data-bs-theme=auto prefix="og: http://ogp.me/ns#
      article: http://ogp.me/ns/article#
      profile: http://ogp.me/ns/profile#
      fb: http://ogp.me/ns/fb#"><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1,viewport-fit=cover"><title>PowerShell: Стирание диска / Library Online</title>
<meta name=title content="PowerShell: Стирание диска / Library Online"><meta name=description content="Небольшой скрипт, который обнуляет #HDD / #SSD и создаёт файловую систему заново."><meta name=keywords content="powershell,hdd,ssd"><link rel=preconnect href=https://gravatar.com crossorigin=anonymous><link rel=preconnect href=https://images.unsplash.com crossorigin=anonymous><script src=/js/theme.min.5f10d03721145ce818261015067fd92d71c874ab15bf49889ca53b1cf0c73c18.js integrity="sha256-XxDQNyEUXOgYJhAVBn/ZLXHIdKsVv0mInKU7HPDHPBg=" crossorigin=anonymous></script><link rel=preload href=/css/vendor.bundle.min.css as=style><link rel=stylesheet href=/css/vendor.bundle.min.css><link rel=preload href=/ru/css/system.bundle.min.css as=style><link rel=stylesheet href=/ru/css/system.bundle.min.css><link rel=icon type=image/png sizes=16x16 href=https://lib.onl/favicon-16.png><link rel="shortcut icon" type=image/png sizes=16x16 href=https://lib.onl/favicon-16.png><link rel=apple-touch-icon sizes=16x16 href=https://lib.onl/favicon-16.png><link rel=icon type=image/png sizes=24x24 href=https://lib.onl/favicon-24.png><link rel="shortcut icon" type=image/png sizes=24x24 href=https://lib.onl/favicon-24.png><link rel=apple-touch-icon sizes=24x24 href=https://lib.onl/favicon-24.png><link rel=icon type=image/png sizes=32x32 href=https://lib.onl/favicon-32.png><link rel="shortcut icon" type=image/png sizes=32x32 href=https://lib.onl/favicon-32.png><link rel=apple-touch-icon sizes=32x32 href=https://lib.onl/favicon-32.png><link rel=icon type=image/png sizes=48x48 href=https://lib.onl/favicon-48.png><link rel="shortcut icon" type=image/png sizes=48x48 href=https://lib.onl/favicon-48.png><link rel=apple-touch-icon sizes=48x48 href=https://lib.onl/favicon-48.png><link rel=icon type=image/png sizes=64x64 href=https://lib.onl/favicon-64.png><link rel="shortcut icon" type=image/png sizes=64x64 href=https://lib.onl/favicon-64.png><link rel=apple-touch-icon sizes=64x64 href=https://lib.onl/favicon-64.png><link rel=icon type=image/png sizes=72x72 href=https://lib.onl/favicon-72.png><link rel="shortcut icon" type=image/png sizes=72x72 href=https://lib.onl/favicon-72.png><link rel=apple-touch-icon sizes=72x72 href=https://lib.onl/favicon-72.png><link rel=icon type=image/png sizes=80x80 href=https://lib.onl/favicon-80.png><link rel="shortcut icon" type=image/png sizes=80x80 href=https://lib.onl/favicon-80.png><link rel=apple-touch-icon sizes=80x80 href=https://lib.onl/favicon-80.png><link rel=icon type=image/png sizes=96x96 href=https://lib.onl/favicon-96.png><link rel="shortcut icon" type=image/png sizes=96x96 href=https://lib.onl/favicon-96.png><link rel=apple-touch-icon sizes=96x96 href=https://lib.onl/favicon-96.png><link rel=icon type=image/png sizes=128x128 href=https://lib.onl/favicon-128.png><link rel="shortcut icon" type=image/png sizes=128x128 href=https://lib.onl/favicon-128.png><link rel=apple-touch-icon sizes=128x128 href=https://lib.onl/favicon-128.png><link rel=icon type=image/png sizes=144x144 href=https://lib.onl/favicon-144.png><link rel="shortcut icon" type=image/png sizes=144x144 href=https://lib.onl/favicon-144.png><link rel=apple-touch-icon sizes=144x144 href=https://lib.onl/favicon-144.png><link rel=icon type=image/png sizes=152x152 href=https://lib.onl/favicon-152.png><link rel="shortcut icon" type=image/png sizes=152x152 href=https://lib.onl/favicon-152.png><link rel=apple-touch-icon sizes=152x152 href=https://lib.onl/favicon-152.png><link rel=icon type=image/png sizes=167x167 href=https://lib.onl/favicon-167.png><link rel="shortcut icon" type=image/png sizes=167x167 href=https://lib.onl/favicon-167.png><link rel=apple-touch-icon sizes=167x167 href=https://lib.onl/favicon-167.png><link rel=icon type=image/png sizes=180x180 href=https://lib.onl/favicon-180.png><link rel="shortcut icon" type=image/png sizes=180x180 href=https://lib.onl/favicon-180.png><link rel=apple-touch-icon sizes=180x180 href=https://lib.onl/favicon-180.png><link rel=icon type=image/png sizes=192x192 href=https://lib.onl/favicon-192.png><link rel="shortcut icon" type=image/png sizes=192x192 href=https://lib.onl/favicon-192.png><link rel=apple-touch-icon sizes=192x192 href=https://lib.onl/favicon-192.png><link rel=icon type=image/png sizes=196x196 href=https://lib.onl/favicon-196.png><link rel="shortcut icon" type=image/png sizes=196x196 href=https://lib.onl/favicon-196.png><link rel=apple-touch-icon sizes=196x196 href=https://lib.onl/favicon-196.png><link rel=icon type=image/png sizes=256x256 href=https://lib.onl/favicon-256.png><link rel="shortcut icon" type=image/png sizes=256x256 href=https://lib.onl/favicon-256.png><link rel=apple-touch-icon sizes=256x256 href=https://lib.onl/favicon-256.png><link rel=icon type=image/png sizes=300x300 href=https://lib.onl/favicon-300.png><link rel="shortcut icon" type=image/png sizes=300x300 href=https://lib.onl/favicon-300.png><link rel=apple-touch-icon sizes=300x300 href=https://lib.onl/favicon-300.png><link rel=icon type=image/png sizes=512x512 href=https://lib.onl/favicon-512.png><link rel="shortcut icon" type=image/png sizes=512x512 href=https://lib.onl/favicon-512.png><link rel=apple-touch-icon sizes=512x512 href=https://lib.onl/favicon-512.png><link rel=icon type=image/svg+xml sizes=any href=https://lib.onl/favicon.svg><link rel="shortcut icon" type=image/x-icon href=https://lib.onl/favicon.ico><link rel="shortcut icon" type=image/vnd.microsoft.icon href=https://lib.onl/favicon.ico><link rel=canonical href=https://lib.onl/ru/2023/10/52d75b90-0637-5ba6-91d6-b1bff40e1d67/><link rel=alternate href=https://lib.onl/ hreflang=x-default><link rel=alternate href=https://lib.onl/ru/2023/10/52d75b90-0637-5ba6-91d6-b1bff40e1d67/ hreflang=ru><link rel=manifest type=application/manifest+json href=https://lib.onl/ru/manifest.json title="Library Online"><link rel=search type=application/opensearchdescription+xml href=https://lib.onl/ru/opensearch.xml title="Library Online"><link rel=alternate type=application/json href=https://lib.onl/ru/2023/10/52d75b90-0637-5ba6-91d6-b1bff40e1d67/index.json title="Library Online"><meta name=application-name content="Library Online"><meta name=theme-color content="#f8f9fa" media="(prefers-color-scheme: light)"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://images.unsplash.com/photo-1646226343350-1ee5021e342a"><meta name=twitter:title content="PowerShell: Стирание диска"><meta name=twitter:description content="Небольшой скрипт, который обнуляет #HDD / #SSD и создаёт файловую систему заново."><meta property="og:url" content="https://lib.onl/ru/2023/10/52d75b90-0637-5ba6-91d6-b1bff40e1d67/"><meta property="og:site_name" content="Library Online"><meta property="og:title" content="PowerShell: Стирание диска"><meta property="og:description" content="Небольшой скрипт, который обнуляет #HDD / #SSD и создаёт файловую систему заново."><meta property="og:locale" content="ru_RU"><meta property="og:type" content="article"><meta property="article:section" content="articles"><meta property="article:published_time" content="2023-10-23T14:03:04+03:00"><meta property="article:modified_time" content="2023-10-23T14:03:04+03:00"><meta property="article:tag" content="Powershell"><meta property="article:tag" content="Hdd"><meta property="article:tag" content="Ssd"><meta property="og:image" content="https://images.unsplash.com/photo-1646226343350-1ee5021e342a"><meta property="twitter:domain" content="lib.onl"><meta property="twitter:url" content="https://lib.onl/ru/2023/10/52d75b90-0637-5ba6-91d6-b1bff40e1d67/"><meta property="og:locale" content="ru_RU"><meta property="og:site_name" content="Library Online"><meta name=aiturec:title content="PowerShell: Стирание диска"><meta property="aiturec:description" content="Небольшой скрипт, который обнуляет #HDD / #SSD и создаёт файловую систему заново."><meta property="aiturec:item_id" content="52d75b90-0637-5ba6-91d6-b1bff40e1d67"><meta property="aiturec:datetime" content="2023-10-23T11:03:04Z"><meta property="aiturec:image" content="https://images.unsplash.com/photo-1646226343350-1ee5021e342a"><meta property="vk:image" content="https://images.unsplash.com/photo-1646226343350-1ee5021e342a"><meta property="article:author" content="Kai Kimera"><meta property="article:tag" content="powershell"><meta property="article:tag" content="hdd"><meta property="article:tag" content="ssd"><meta name=DC.Title content="PowerShell: Стирание диска"><meta name=DC.Subject content="Небольшой скрипт, который обнуляет #HDD / #SSD и создаёт файловую систему заново."><meta name=DC.Description content="Небольшой скрипт, который обнуляет #HDD / #SSD и создаёт файловую систему заново."><meta name=DC.Type content="Text"><meta name=DC.Source content="https://lib.onl/ru/2023/10/52d75b90-0637-5ba6-91d6-b1bff40e1d67/"><meta name=DC.Relation content="https://lib.onl/ru/2023/10/52d75b90-0637-5ba6-91d6-b1bff40e1d67/"><meta name=DC.Coverage content="World"><meta name=DC.Creator content="Library Online"><meta name=DC.Publisher content="Library Online"><meta name=DC.Contributor content="Library Online"><meta name=DC.Rights content="Library Online"><meta name=DC.Format content="Digital"><meta name=DC.Identifier content="https://lib.onl/ru/2023/10/52d75b90-0637-5ba6-91d6-b1bff40e1d67/"><meta name=DC.Language content="ru-RU"><meta name=DC.Provenance content="Library Online"><meta name=DC.RightsHolder content="Library Online"><meta name=DC.AccrualPeriodicity content="Weekly"><meta name=DC.AccrualPolicy content="Active"></head><body class="d-flex flex-column h-100 is-page type-articles"><header id=site-header><nav class="navbar navbar-expand-lg navbar-light fixed-top border-bottom shadow-sm text-lg-center bg-body-tertiary"><div class=container-fluid><a class=navbar-brand href=/ru/><img src=https://lib.onl/img/logo.min.svg alt=Логотип width=30 height=24 class="d-inline-block align-text-top"><h2 class="d-inline-block h5 m-0 ms-1">Library Online</h2></a><button type=button class=navbar-toggler data-bs-toggle=collapse data-bs-target=#navTopBar aria-controls=navTopBar aria-expanded=false aria-label='Переключить навигацию'>
<span class=navbar-toggler-icon></span></button><div class="collapse navbar-collapse" id=navTopBar><ul class=navbar-nav><li class=nav-item><a class=nav-link href=/ru/articles/><i class="fas fa-file-lines fa-fw"></i>
<span>Статьи</span></a></li><li class=nav-item><a class=nav-link href=/ru/faq/><i class="fas fa-circle-question fa-fw"></i>
<span>Q&amp;A</span></a></li><li class=nav-item><a class=nav-link href=/ru/archive/><i class="fas fa-archive fa-fw"></i>
<span>Архив</span></a></li><li class=nav-item><a class=nav-link href=/ru/about/><i class="fas fa-info-circle fa-fw"></i>
<span>О проекте</span></a></li><li class="nav-item dropdown"><a class="nav-link dropdown-toggle" href=# role=button data-bs-toggle=dropdown aria-expanded=false><i class="fas fa-list fa-fw"></i>
<span>META</span></a><ul class="dropdown-menu shadow"><li><a class=dropdown-item href=/ru/authors/><i class="fas fa-user-circle fa-fw"></i>
<span>Авторы</span></a></li><li><a class=dropdown-item href=/ru/categories/><i class="fas fa-folder-open fa-fw"></i>
<span>Категории</span></a></li><li><a class=dropdown-item href=/ru/tags/><i class="fas fa-tags fa-fw"></i>
<span>Теги</span></a></li></ul></li></ul><ul class="navbar-nav ms-auto"><li class=nav-item><a class="nav-link d-lg-none" href=# data-bs-toggle=modal data-bs-target=#search-modal aria-label=Поиск><i class="fas fa-search fa-fw"></i>
<span>Поиск</span>
</a><a title=Поиск class="nav-link d-none d-lg-block" href=# data-bs-toggle=modal data-bs-target=#search-modal aria-label=Поиск><i class="fas fa-search fa-fw"></i></a></li></ul></div></div></nav></header><main class="wrapper flex-shrink-0" id=site-main><div class="section py-3"><div class=container><nav style="--bs-breadcrumb-divider:'\2f '" class=small aria-label=breadcrumb><ol class="breadcrumb p-2 rounded bg-body-tertiary"><li class=breadcrumb-item><a href=/ru/ aria-label=Главная><i class="fas fa-home fa-fw"></i></a></li><li class=breadcrumb-item><a href=/ru/articles/ aria-label=Статьи>Статьи</a></li><li class="breadcrumb-item active">PowerShell: Стирание диска</li></ol></nav><article><header><div class="node-cover mb-3"><a title="PowerShell: Стирание диска" class="d-flex align-items-center rounded overflow-hidden bg-body-tertiary" href=/ru/2023/10/52d75b90-0637-5ba6-91d6-b1bff40e1d67/><picture><source srcset='https://images.unsplash.com/photo-1646226343350-1ee5021e342a?crop=edges&amp;w=640&amp;h=360&amp;fit=crop&amp;auto=compress,format 640w,https://images.unsplash.com/photo-1646226343350-1ee5021e342a?crop=edges&amp;w=768&amp;h=432&amp;fit=crop&amp;auto=compress,format 768w,https://images.unsplash.com/photo-1646226343350-1ee5021e342a?crop=edges&amp;w=1024&amp;h=576&amp;fit=crop&amp;auto=compress,format 1024w,https://images.unsplash.com/photo-1646226343350-1ee5021e342a?crop=edges&amp;w=1280&amp;h=720&amp;fit=crop&amp;auto=compress,format 1280w,https://images.unsplash.com/photo-1646226343350-1ee5021e342a?crop=edges&amp;w=1600&amp;h=900&amp;fit=crop&amp;auto=compress,format 1600w' sizes="(min-width: 576px) 100vw"><img class=img-fluid src="https://images.unsplash.com/photo-1646226343350-1ee5021e342a?crop=edges&amp;w=1600&amp;h=900&amp;fit=crop&amp;auto=compress,format" width=1600 height=900 alt="PowerShell: Стирание диска" loading=lazy></picture></a></div><div class=node-title><h1 class=text-center>PowerShell: Стирание диска</h1></div></header><footer><ul class="list-inline text-center text-body-secondary small"><li class=list-inline-item><time datetime=2023-10-23T11:03:04Z data-fn=date-local>2023/10/23 11:03:04 UTC</time></li><li class=list-inline-item>&bull;</li><li class="list-inline-item text-success" title='Уровень сложности: Простой'><i class="far fa-face-smile fa-fw"></i></li></ul></footer><ul class="nav nav-tabs mb-3" id=node-tabs-99cd5bca82286ca7874a0cf3c746d932 data-fn=node-tabs role=tablist><li class=nav-item role=presentation title=Главная><button class="nav-link active" id=tab-main-home type=button role=tab data-bs-toggle=tab data-bs-target=#tab-pane-main-home aria-controls=tab-pane-main-home aria-selected=true aria-label=Главная>
<i class="fas fa-home fa-fw"></i></button></li><li class=nav-item role=presentation title=Информация><button class=nav-link id=tab-main-info type=button role=tab data-bs-toggle=tab data-bs-target=#tab-pane-main-info aria-controls=tab-pane-main-info aria-selected=false aria-label=Информация>
<i class="fas fa-info fa-fw"></i></button></li><li class=nav-item role=presentation title=Комментарии><button class=nav-link id=tab-main-comments type=button role=tab data-bs-toggle=tab data-bs-target=#tab-pane-main-comments aria-controls=tab-pane-main-comments aria-selected=false aria-label=Комментарии>
<i class="far fa-comments fa-fw"></i></button></li><li class="nav-item ms-auto" role=presentation title=Поделиться><button class=nav-link id=tab-main-share type=button role=tab data-bs-toggle=tab data-bs-target=#tab-pane-main-share aria-controls=tab-pane-main-share aria-selected=false aria-label=Поделиться>
<i class="fas fa-share fa-fw"></i></button></li></ul><div class=tab-content><div class="tab-pane show active" id=tab-pane-main-home role=tabpanel aria-labelledby=tab-main-home tabindex=0><div class=node-body><div class="node-toc mb-3"><div class=accordion id=accordion-toc-ee8e7f2d0f11fcf70b2ca33ea3f0e80d><div class=accordion-item><h2 class=accordion-header><a class="accordion-button collapsed" href=# role=button tabindex=0 data-bs-toggle=collapse data-bs-target=#collapse-toc-ee8e7f2d0f11fcf70b2ca33ea3f0e80d aria-expanded=false aria-controls=collapse-toc-ee8e7f2d0f11fcf70b2ca33ea3f0e80d aria-label=Содержание>Содержание</a></h2><div id=collapse-toc-ee8e7f2d0f11fcf70b2ca33ea3f0e80d class="accordion-collapse collapse"><div class=accordion-body><nav id=TableOfContents><ul><li><a href=#параметры>Параметры</a></li><li><a href=#примеры>Примеры</a></li><li><a href=#скрипт>Скрипт</a></li></ul></nav></div></div></div></div></div><p>Небольшой скрипт, который обнуляет <span class="shortcode shortcode-tag"><a href=/ru/tags/hdd/ target=_blank>#HDD</a></span> / <span class="shortcode shortcode-tag"><a href=/ru/tags/ssd/ target=_blank>#SSD</a></span> и создаёт файловую систему заново.</p><h2 id=параметры><a class=link-body-emphasis href=#%d0%bf%d0%b0%d1%80%d0%b0%d0%bc%d0%b5%d1%82%d1%80%d1%8b>Параметры</a></h2><ul><li><code>-DN</code> <code>-P_DiskNumber</code> - номер диска. Можно узнать командой <code>Get-Disk</code>. Но если не ввести номер диска в параметры скрипта при запуске, скрипт сам выведет информацию и спросит номер диска. Обязательный параметр.</li><li><code>-FS</code> <code>-P_FileSystem</code> - файловая система. Может принимать следующие значения:<ul><li><code>'FAT'</code> - файловая система <span class="shortcode shortcode-tag">FAT</span>.</li><li><code>'FAT32'</code> - файловая система <span class="shortcode shortcode-tag">FAT32</span>.</li><li><code>'exFAT'</code> - файловая система <span class="shortcode shortcode-tag">exFAT</span>.</li><li><code>'NTFS'</code> - файловая система <span class="shortcode shortcode-tag">NTFS</span>.</li><li><code>'ReFS'</code> - новая файловая система <span class="shortcode shortcode-tag">ReFS</span>.</li></ul></li><li><code>-S</code> <code>-P_Sleep</code> - перерыв между командами (в секундах).</li></ul><h2 id=примеры><a class=link-body-emphasis href=#%d0%bf%d1%80%d0%b8%d0%bc%d0%b5%d1%80%d1%8b>Примеры</a></h2><p>Скрипт, запущенный без параметров, сам спросит необходимые данные:</p><div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-0 shortcode-codeblock-terminal
shortcode-codeblock-terminal-windows
shortcode-codeblock-terminal-windows-root"><div class="card overflow-hidden" data-bs-theme=dark><div class=card-header><div class="d-flex align-items-center"><div class="flex-shrink-0 text-danger"><i class="fas fa-terminal fa-fw"></i></div><div class="flex-grow-1 mx-2"><h5 class=mb-0>Терминал</h5></div><div class=flex-shrink-0><ul class="list-inline mb-0"><li class=list-inline-item title=Копировать><a class=text-body href=# data-fn=clipboard data-clipboard-target=#cp-f5ca6bda1c0d240762b4b2e3912b30cb role=button aria-label=Копировать><i class="fas fa-copy fa-fw"></i></a></li></ul></div></div></div><div class="card-body p-0 overflow-auto" id=cp-f5ca6bda1c0d240762b4b2e3912b30cb><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-plaintext data-lang=plaintext><span class=line><span class=cl>.\pwsh.disk.erase.ps1</span></span></code></pre></td></tr></table></div></div></div></div></div><p>Обнулить диск <code>3</code> и указать метку <code>USB-SSD</code>:</p><div class="shortcode mb-3 shortcode-codeblock shortcode-codeblock-1 shortcode-codeblock-terminal
shortcode-codeblock-terminal-windows
shortcode-codeblock-terminal-windows-root"><div class="card overflow-hidden" data-bs-theme=dark><div class=card-header><div class="d-flex align-items-center"><div class="flex-shrink-0 text-danger"><i class="fas fa-terminal fa-fw"></i></div><div class="flex-grow-1 mx-2"><h5 class=mb-0>Терминал</h5></div><div class=flex-shrink-0><ul class="list-inline mb-0"><li class=list-inline-item title=Копировать><a class=text-body href=# data-fn=clipboard data-clipboard-target=#cp-1dffb9433cdffd1c694d46e3b754d6e0 role=button aria-label=Копировать><i class="fas fa-copy fa-fw"></i></a></li></ul></div></div></div><div class="card-body p-0 overflow-auto" id=cp-1dffb9433cdffd1c694d46e3b754d6e0><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-plaintext data-lang=plaintext><span class=line><span class=cl>.\pwsh.disk.erase.ps1 -DN 3 -FS &#39;NTFS&#39;</span></span></code></pre></td></tr></table></div></div></div></div></div><h2 id=скрипт><a class=link-body-emphasis href=#%d1%81%d0%ba%d1%80%d0%b8%d0%bf%d1%82>Скрипт</a></h2><div class="shortcode shortcode-file mb-3"><div class="card overflow-hidden" data-bs-theme=dark><div class=card-header><div class="d-flex align-items-center"><div class=flex-shrink-0><i class="far fa-file-code fa-fw"></i></div><div class="flex-grow-1 mx-2 text-truncate"><code>pwsh.disk.erase.ps1</code></div><div class=flex-shrink-0><ul class="list-inline mb-0"><li class=list-inline-item title=Копировать><a class=text-body href=# data-fn=clipboard data-clipboard-target=#cp-587c762b826dff0d66a1d8353e5da58e role=button aria-label=Копировать><i class="fas fa-copy fa-fw"></i></a></li><li class=list-inline-item title=Скачать><a class=text-body href=/ru/2023/10/52d75b90-0637-5ba6-91d6-b1bff40e1d67/pwsh.disk.erase.ps1 download role=button aria-label=Скачать><i class="fas fa-download fa-fw"></i></a></li><li class=list-inline-item title=Открыть><a class=text-body href=/ru/2023/10/52d75b90-0637-5ba6-91d6-b1bff40e1d67/pwsh.disk.erase.ps1 target=_blank role=button aria-label=Открыть><i class="fas fa-arrow-up-right-from-square fa-fw"></i></a></li></ul></div></div></div><div class="card-body p-0 overflow-auto" id=cp-587c762b826dff0d66a1d8353e5da58e><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>  1
</span><span class=lnt>  2
</span><span class=lnt>  3
</span><span class=lnt>  4
</span><span class=lnt>  5
</span><span class=lnt>  6
</span><span class=lnt>  7
</span><span class=lnt>  8
</span><span class=lnt>  9
</span><span class=lnt> 10
</span><span class=lnt> 11
</span><span class=lnt> 12
</span><span class=lnt> 13
</span><span class=lnt> 14
</span><span class=lnt> 15
</span><span class=lnt> 16
</span><span class=lnt> 17
</span><span class=lnt> 18
</span><span class=lnt> 19
</span><span class=lnt> 20
</span><span class=lnt> 21
</span><span class=lnt> 22
</span><span class=lnt> 23
</span><span class=lnt> 24
</span><span class=lnt> 25
</span><span class=lnt> 26
</span><span class=lnt> 27
</span><span class=lnt> 28
</span><span class=lnt> 29
</span><span class=lnt> 30
</span><span class=lnt> 31
</span><span class=lnt> 32
</span><span class=lnt> 33
</span><span class=lnt> 34
</span><span class=lnt> 35
</span><span class=lnt> 36
</span><span class=lnt> 37
</span><span class=lnt> 38
</span><span class=lnt> 39
</span><span class=lnt> 40
</span><span class=lnt> 41
</span><span class=lnt> 42
</span><span class=lnt> 43
</span><span class=lnt> 44
</span><span class=lnt> 45
</span><span class=lnt> 46
</span><span class=lnt> 47
</span><span class=lnt> 48
</span><span class=lnt> 49
</span><span class=lnt> 50
</span><span class=lnt> 51
</span><span class=lnt> 52
</span><span class=lnt> 53
</span><span class=lnt> 54
</span><span class=lnt> 55
</span><span class=lnt> 56
</span><span class=lnt> 57
</span><span class=lnt> 58
</span><span class=lnt> 59
</span><span class=lnt> 60
</span><span class=lnt> 61
</span><span class=lnt> 62
</span><span class=lnt> 63
</span><span class=lnt> 64
</span><span class=lnt> 65
</span><span class=lnt> 66
</span><span class=lnt> 67
</span><span class=lnt> 68
</span><span class=lnt> 69
</span><span class=lnt> 70
</span><span class=lnt> 71
</span><span class=lnt> 72
</span><span class=lnt> 73
</span><span class=lnt> 74
</span><span class=lnt> 75
</span><span class=lnt> 76
</span><span class=lnt> 77
</span><span class=lnt> 78
</span><span class=lnt> 79
</span><span class=lnt> 80
</span><span class=lnt> 81
</span><span class=lnt> 82
</span><span class=lnt> 83
</span><span class=lnt> 84
</span><span class=lnt> 85
</span><span class=lnt> 86
</span><span class=lnt> 87
</span><span class=lnt> 88
</span><span class=lnt> 89
</span><span class=lnt> 90
</span><span class=lnt> 91
</span><span class=lnt> 92
</span><span class=lnt> 93
</span><span class=lnt> 94
</span><span class=lnt> 95
</span><span class=lnt> 96
</span><span class=lnt> 97
</span><span class=lnt> 98
</span><span class=lnt> 99
</span><span class=lnt>100
</span><span class=lnt>101
</span><span class=lnt>102
</span><span class=lnt>103
</span><span class=lnt>104
</span><span class=lnt>105
</span><span class=lnt>106
</span><span class=lnt>107
</span><span class=lnt>108
</span><span class=lnt>109
</span><span class=lnt>110
</span><span class=lnt>111
</span><span class=lnt>112
</span><span class=lnt>113
</span><span class=lnt>114
</span><span class=lnt>115
</span><span class=lnt>116
</span><span class=lnt>117
</span><span class=lnt>118
</span><span class=lnt>119
</span><span class=lnt>120
</span><span class=lnt>121
</span><span class=lnt>122
</span><span class=lnt>123
</span><span class=lnt>124
</span><span class=lnt>125
</span><span class=lnt>126
</span><span class=lnt>127
</span><span class=lnt>128
</span><span class=lnt>129
</span><span class=lnt>130
</span><span class=lnt>131
</span><span class=lnt>132
</span><span class=lnt>133
</span><span class=lnt>134
</span><span class=lnt>135
</span><span class=lnt>136
</span><span class=lnt>137
</span><span class=lnt>138
</span><span class=lnt>139
</span><span class=lnt>140
</span><span class=lnt>141
</span><span class=lnt>142
</span><span class=lnt>143
</span><span class=lnt>144
</span><span class=lnt>145
</span><span class=lnt>146
</span><span class=lnt>147
</span><span class=lnt>148
</span><span class=lnt>149
</span><span class=lnt>150
</span><span class=lnt>151
</span><span class=lnt>152
</span><span class=lnt>153
</span><span class=lnt>154
</span><span class=lnt>155
</span><span class=lnt>156
</span><span class=lnt>157
</span><span class=lnt>158
</span><span class=lnt>159
</span><span class=lnt>160
</span><span class=lnt>161
</span><span class=lnt>162
</span><span class=lnt>163
</span><span class=lnt>164
</span><span class=lnt>165
</span><span class=lnt>166
</span><span class=lnt>167
</span><span class=lnt>168
</span><span class=lnt>169
</span><span class=lnt>170
</span><span class=lnt>171
</span><span class=lnt>172
</span><span class=lnt>173
</span><span class=lnt>174
</span><span class=lnt>175
</span><span class=lnt>176
</span><span class=lnt>177
</span><span class=lnt>178
</span><span class=lnt>179
</span><span class=lnt>180
</span><span class=lnt>181
</span><span class=lnt>182
</span><span class=lnt>183
</span><span class=lnt>184
</span><span class=lnt>185
</span><span class=lnt>186
</span><span class=lnt>187
</span><span class=lnt>188
</span><span class=lnt>189
</span><span class=lnt>190
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-ps1 data-lang=ps1><span class=line><span class=cl><span class=cm>&lt;#PSScriptInfo
</span></span></span><span class=line><span class=cl><span class=cm>.VERSION      0.1.0
</span></span></span><span class=line><span class=cl><span class=cm>.GUID         8d95f4d5-4d14-412c-9fa4-b75ebe79df09
</span></span></span><span class=line><span class=cl><span class=cm>.AUTHOR       Kai Kimera
</span></span></span><span class=line><span class=cl><span class=cm>.AUTHOREMAIL  mail@kai.kim
</span></span></span><span class=line><span class=cl><span class=cm>.COMPANYNAME  Library Online
</span></span></span><span class=line><span class=cl><span class=cm>.COPYRIGHT    2023 Library Online. All rights reserved.
</span></span></span><span class=line><span class=cl><span class=cm>.LICENSEURI   https://choosealicense.com/licenses/mit/
</span></span></span><span class=line><span class=cl><span class=cm>.PROJECTURI   https://lib.onl/ru/2023/10/52d75b90-0637-5ba6-91d6-b1bff40e1d67/
</span></span></span><span class=line><span class=cl><span class=cm>#&gt;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c>#</span><span class=k>Requires</span><span class=w> </span><span class=kd>-Version</span><span class=na> 7.2</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c>#</span><span class=k>Requires</span><span class=w> </span><span class=kd>-RunAsAdministrator</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=cm>&lt;#
</span></span></span><span class=line><span class=cl><span class=cm>.</span><span class=sd>SYNOPSIS</span><span class=cm>
</span></span></span><span class=line><span class=cl><span class=cm>Disk erase script.
</span></span></span><span class=line><span class=cl><span class=cm>
</span></span></span><span class=line><span class=cl><span class=cm>.</span><span class=sd>DESCRIPTION</span><span class=cm>
</span></span></span><span class=line><span class=cl><span class=cm>Disk cleanup followed by partition creation.
</span></span></span><span class=line><span class=cl><span class=cm>
</span></span></span><span class=line><span class=cl><span class=cm>.PARAMETER P_DiskNumber
</span></span></span><span class=line><span class=cl><span class=cm>Specifies the disk number of the disk on which to perform the clear operation. For a list of available disks, see the &#39;Get-Disk&#39; cmdlet.
</span></span></span><span class=line><span class=cl><span class=cm>
</span></span></span><span class=line><span class=cl><span class=cm>.PARAMETER P_FileSystem
</span></span></span><span class=line><span class=cl><span class=cm>Specifies the file system with which to format the volume.
</span></span></span><span class=line><span class=cl><span class=cm>The acceptable values for this parameter are: &#39;NTFS&#39;, &#39;ReFS&#39;, &#39;exFAT&#39;, &#39;FAT32&#39; and &#39;FAT&#39;.
</span></span></span><span class=line><span class=cl><span class=cm>
</span></span></span><span class=line><span class=cl><span class=cm>.PARAMETER P_Sleep
</span></span></span><span class=line><span class=cl><span class=cm>Sleep time (in seconds).
</span></span></span><span class=line><span class=cl><span class=cm>
</span></span></span><span class=line><span class=cl><span class=cm>.</span><span class=sd>EXAMPLE</span><span class=cm>
</span></span></span><span class=line><span class=cl><span class=cm>.\pwsh.disk.erase.ps1 -DN 3 -FS &#39;NTFS&#39;
</span></span></span><span class=line><span class=cl><span class=cm>
</span></span></span><span class=line><span class=cl><span class=cm>.</span><span class=sd>LINK</span><span class=cm>
</span></span></span><span class=line><span class=cl><span class=cm>https://lib.onl/ru/2023/10/52d75b90-0637-5ba6-91d6-b1bff40e1d67/
</span></span></span><span class=line><span class=cl><span class=cm>#&gt;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c># -------------------------------------------------------------------------------------------------------------------- #</span>
</span></span><span class=line><span class=cl><span class=c># CONFIGURATION</span>
</span></span><span class=line><span class=cl><span class=c># -------------------------------------------------------------------------------------------------------------------- #</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>param</span><span class=p>(</span>
</span></span><span class=line><span class=cl>  <span class=p>[</span><span class=nb>Parameter</span><span class=p>(</span><span class=na>HelpMessage</span><span class=p>=</span><span class=s2>&#34;Specify the disk number.&#34;</span><span class=p>)]</span>
</span></span><span class=line><span class=cl>  <span class=p>[</span><span class=nb>ValidatePattern</span><span class=p>(</span><span class=s1>&#39;^[0-9]+$&#39;</span><span class=p>)]</span>
</span></span><span class=line><span class=cl>  <span class=p>[</span><span class=nb>Alias</span><span class=p>(</span><span class=s1>&#39;DN&#39;</span><span class=p>)][</span><span class=no>int</span><span class=p>]</span><span class=nv>$P_DiskNumber</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=p>[</span><span class=nb>Parameter</span><span class=p>(</span><span class=na>HelpMessage</span><span class=p>=</span><span class=s2>&#34;Specify the file system to format the volume.&#34;</span><span class=p>)]</span>
</span></span><span class=line><span class=cl>  <span class=p>[</span><span class=nb>ValidateSet</span><span class=p>(</span><span class=s1>&#39;FAT&#39;</span><span class=p>,</span> <span class=s1>&#39;FAT32&#39;</span><span class=p>,</span> <span class=s1>&#39;exFAT&#39;</span><span class=p>,</span> <span class=s1>&#39;NTFS&#39;</span><span class=p>,</span> <span class=s1>&#39;ReFS&#39;</span><span class=p>)]</span>
</span></span><span class=line><span class=cl>  <span class=p>[</span><span class=nb>Alias</span><span class=p>(</span><span class=s1>&#39;FS&#39;</span><span class=p>)][</span><span class=no>string</span><span class=p>]</span><span class=nv>$P_FileSystem</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=p>[</span><span class=nb>Parameter</span><span class=p>(</span><span class=na>HelpMessage</span><span class=p>=</span><span class=s2>&#34;Sleep time (in seconds).&#34;</span><span class=p>)]</span>
</span></span><span class=line><span class=cl>  <span class=p>[</span><span class=nb>Alias</span><span class=p>(</span><span class=s1>&#39;S&#39;</span><span class=p>)][</span><span class=no>int</span><span class=p>]</span><span class=nv>$P_Sleep</span> <span class=p>=</span> <span class=mf>2</span>
</span></span><span class=line><span class=cl><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c># New line separator.</span>
</span></span><span class=line><span class=cl><span class=nv>$NL</span> <span class=p>=</span> <span class=s2>&#34;</span><span class=p>$([</span><span class=no>Environment</span><span class=p>]::</span><span class=n>NewLine</span><span class=p>)</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c># Random number.</span>
</span></span><span class=line><span class=cl><span class=nv>$Random</span> <span class=p>=</span> <span class=s2>&#34;</span><span class=p>$(</span><span class=nb>Get-Random</span> <span class=n>-Minimum</span> <span class=mf>1000</span> <span class=n>-Maximum</span> <span class=mf>9999</span><span class=p>)</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c># Getting free drive letter and to assign to the new partition.</span>
</span></span><span class=line><span class=cl><span class=nv>$DriveLetter</span> <span class=p>=</span> <span class=s2>&#34;</span><span class=p>$((</span><span class=mf>68</span><span class=p>.</span><span class=mf>.90</span> <span class=p>|</span> <span class=nb>ForEach-Object</span> <span class=p>{</span> <span class=nv>$L</span><span class=p>=[</span><span class=no>char</span><span class=p>]</span><span class=nv>$_</span><span class=p>;</span> <span class=k>if</span> <span class=p>((</span><span class=nb>Get-PSDrive</span><span class=p>).</span><span class=py>Name</span> <span class=o>-notContains</span> <span class=nv>$L</span><span class=p>)</span> <span class=p>{</span> <span class=nv>$L</span> <span class=p>}</span> <span class=p>})[</span><span class=mf>0</span><span class=p>])</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c># Specifying a new label to use for the volume.</span>
</span></span><span class=line><span class=cl><span class=nv>$FileSystemLabel</span> <span class=p>=</span> <span class=s2>&#34;DISK_</span><span class=nv>${Random}</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c># -------------------------------------------------------------------------------------------------------------------- #</span>
</span></span><span class=line><span class=cl><span class=c># INITIALIZATION</span>
</span></span><span class=line><span class=cl><span class=c># -------------------------------------------------------------------------------------------------------------------- #</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>function</span><span class=w> </span><span class=nb>Start-Script</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=nb>Start-DPDiskList</span>        <span class=c># Showing disk list.</span>
</span></span><span class=line><span class=cl>  <span class=k>if</span> <span class=p>(</span><span class=o>-not</span> <span class=nv>$P_DiskNumber</span><span class=p>)</span> <span class=p>{</span> <span class=nv>$P_DiskNumber</span> <span class=p>=</span> <span class=p>(</span><span class=nb>Read-Host</span> <span class=n>-Prompt</span> <span class=s1>&#39;Disk number&#39;</span><span class=p>)</span> <span class=p>}</span>   <span class=c># Getting disk number.</span>
</span></span><span class=line><span class=cl>  <span class=k>if</span> <span class=p>(</span><span class=o>-not</span> <span class=nv>$P_FileSystem</span><span class=p>)</span> <span class=p>{</span> <span class=nv>$P_FileSystem</span> <span class=p>=</span> <span class=p>(</span><span class=nb>Read-Host</span> <span class=n>-Prompt</span> <span class=s1>&#39;File system&#39;</span><span class=p>)</span> <span class=p>}</span>   <span class=c># Getting file system.</span>
</span></span><span class=line><span class=cl>  <span class=nb>Start-DPDiskClear</span>       <span class=c># Starting clearing disk.</span>
</span></span><span class=line><span class=cl>  <span class=nb>Start-DPDiskInit</span>        <span class=c># Initializing disk.</span>
</span></span><span class=line><span class=cl>  <span class=nb>Start-DPDiskPartition</span>   <span class=c># Creating partition.</span>
</span></span><span class=line><span class=cl>  <span class=nb>Start-DPDiskFormat</span>      <span class=c># Formatting volume.</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c># -------------------------------------------------------------------------------------------------------------------- #</span>
</span></span><span class=line><span class=cl><span class=c># DISK LIST</span>
</span></span><span class=line><span class=cl><span class=c># -------------------------------------------------------------------------------------------------------------------- #</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>function</span><span class=w> </span><span class=nb>Start-DPDiskList</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=nb>Write-Msg</span> <span class=n>-T</span> <span class=s1>&#39;HL&#39;</span> <span class=n>-M</span> <span class=s1>&#39;Disk List&#39;</span>
</span></span><span class=line><span class=cl>  <span class=nb>Get-Disk</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c># -------------------------------------------------------------------------------------------------------------------- #</span>
</span></span><span class=line><span class=cl><span class=c># CLEAR DISK</span>
</span></span><span class=line><span class=cl><span class=c># -------------------------------------------------------------------------------------------------------------------- #</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>function</span><span class=w> </span><span class=nb>Start-DPDiskClear</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=nb>Write-Msg</span> <span class=n>-T</span> <span class=s1>&#39;HL&#39;</span> <span class=n>-M</span> <span class=s2>&#34;[DISK #</span><span class=nv>${P_DiskNumber}</span><span class=s2>] Clear Disk&#34;</span>
</span></span><span class=line><span class=cl>  <span class=nb>Write-Msg</span> <span class=n>-T</span> <span class=s1>&#39;W&#39;</span> <span class=n>-A</span> <span class=s1>&#39;Inquire&#39;</span> <span class=n>-M</span> <span class=p>(</span><span class=s2>&#34;You specified drive number &#39;</span><span class=nv>${P_DiskNumber}</span><span class=s2>&#39;.</span><span class=nv>${NL}</span><span class=s2>&#34;</span> <span class=p>+</span>
</span></span><span class=line><span class=cl>  <span class=s2>&#34;All data will be DELETED!&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=nv>$Param</span> <span class=p>=</span> <span class=vm>@</span><span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=n>Number</span> <span class=p>=</span> <span class=nv>$P_DiskNumber</span>
</span></span><span class=line><span class=cl>    <span class=n>RemoveData</span> <span class=p>=</span> <span class=vm>$true</span>
</span></span><span class=line><span class=cl>    <span class=n>RemoveOEM</span> <span class=p>=</span> <span class=vm>$true</span>
</span></span><span class=line><span class=cl>    <span class=n>Confirm</span> <span class=p>=</span> <span class=vm>$false</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=nb>Clear-Disk</span> <span class=nv>@Param</span>
</span></span><span class=line><span class=cl>  <span class=nb>Start-Sleep</span> <span class=n>-s</span> <span class=nv>$P_Sleep</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c># -------------------------------------------------------------------------------------------------------------------- #</span>
</span></span><span class=line><span class=cl><span class=c># INITIALIZE DISK</span>
</span></span><span class=line><span class=cl><span class=c># -------------------------------------------------------------------------------------------------------------------- #</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>function</span><span class=w> </span><span class=nb>Start-DPDiskInit</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=nb>Write-Msg</span> <span class=n>-T</span> <span class=s1>&#39;HL&#39;</span> <span class=n>-M</span> <span class=s2>&#34;[DISK #</span><span class=nv>${P_DiskNumber}</span><span class=s2>] Initialize Disk&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=nv>$Param</span> <span class=p>=</span> <span class=vm>@</span><span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=n>Number</span> <span class=p>=</span> <span class=nv>$P_DiskNumber</span>
</span></span><span class=line><span class=cl>    <span class=n>PartitionStyle</span> <span class=p>=</span> <span class=s1>&#39;GPT&#39;</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=nb>Initialize-Disk</span> <span class=nv>@Param</span>
</span></span><span class=line><span class=cl>  <span class=nb>Start-Sleep</span> <span class=n>-s</span> <span class=nv>$P_Sleep</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c># -------------------------------------------------------------------------------------------------------------------- #</span>
</span></span><span class=line><span class=cl><span class=c># CREATE PARTITION</span>
</span></span><span class=line><span class=cl><span class=c># -------------------------------------------------------------------------------------------------------------------- #</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>function</span><span class=w> </span><span class=nb>Start-DPDiskPartition</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=nb>Write-Msg</span> <span class=n>-T</span> <span class=s1>&#39;HL&#39;</span> <span class=n>-M</span> <span class=s2>&#34;[DISK #</span><span class=nv>${P_DiskNumber}</span><span class=s2>] Create Partition&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=nv>$Param</span> <span class=p>=</span> <span class=vm>@</span><span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=n>DiskNumber</span> <span class=p>=</span> <span class=nv>$P_DiskNumber</span>
</span></span><span class=line><span class=cl>    <span class=n>DriveLetter</span> <span class=p>=</span> <span class=s2>&#34;</span><span class=nv>${DriveLetter}</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl>    <span class=n>UseMaximumSize</span> <span class=p>=</span> <span class=vm>$true</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=nb>New-Partition</span> <span class=nv>@Param</span>
</span></span><span class=line><span class=cl>  <span class=nb>Start-Sleep</span> <span class=n>-s</span> <span class=nv>$P_Sleep</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c># -------------------------------------------------------------------------------------------------------------------- #</span>
</span></span><span class=line><span class=cl><span class=c># FORMAT DISK VOLUME</span>
</span></span><span class=line><span class=cl><span class=c># -------------------------------------------------------------------------------------------------------------------- #</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>function</span><span class=w> </span><span class=nb>Start-DPDiskFormat</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=nb>Write-Msg</span> <span class=n>-T</span> <span class=s1>&#39;HL&#39;</span> <span class=n>-M</span> <span class=s2>&#34;[DISK #</span><span class=nv>${P_DiskNumber}</span><span class=s2>] Format Disk Volume (</span><span class=nv>${DriveLetter}</span><span class=s2> / </span><span class=nv>${P_FileSystem}</span><span class=s2>)&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=k>if</span> <span class=p>(</span><span class=o>-not</span> <span class=nv>$P_FileSystem</span><span class=p>)</span> <span class=p>{</span> <span class=nv>$P_FileSystem</span> <span class=p>=</span> <span class=s1>&#39;NTFS&#39;</span> <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=nv>$Param</span> <span class=p>=</span> <span class=vm>@</span><span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=n>DriveLetter</span> <span class=p>=</span> <span class=s2>&#34;</span><span class=nv>${DriveLetter}</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl>    <span class=n>FileSystem</span> <span class=p>=</span> <span class=s2>&#34;</span><span class=nv>${P_FileSystem}</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl>    <span class=n>NewFileSystemLabel</span> <span class=p>=</span> <span class=s2>&#34;</span><span class=nv>${FileSystemLabel}</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl>    <span class=n>Force</span> <span class=p>=</span> <span class=vm>$true</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=nb>Format-Volume</span> <span class=nv>@Param</span>
</span></span><span class=line><span class=cl>  <span class=nb>Start-Sleep</span> <span class=n>-s</span> <span class=nv>$P_Sleep</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c># -------------------------------------------------------------------------------------------------------------------- #</span>
</span></span><span class=line><span class=cl><span class=c># ------------------------------------------------&lt; COMMON FUNCTIONS &gt;------------------------------------------------ #</span>
</span></span><span class=line><span class=cl><span class=c># -------------------------------------------------------------------------------------------------------------------- #</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c># -------------------------------------------------------------------------------------------------------------------- #</span>
</span></span><span class=line><span class=cl><span class=c># SYSTEM MESSAGES</span>
</span></span><span class=line><span class=cl><span class=c># -------------------------------------------------------------------------------------------------------------------- #</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>function</span><span class=w> </span><span class=nb>Write-Msg</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=k>param</span> <span class=p>(</span>
</span></span><span class=line><span class=cl>    <span class=p>[</span><span class=nb>Alias</span><span class=p>(</span><span class=s1>&#39;T&#39;</span><span class=p>)][</span><span class=no>string</span><span class=p>]</span><span class=nv>$Type</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=p>[</span><span class=nb>Alias</span><span class=p>(</span><span class=s1>&#39;M&#39;</span><span class=p>)][</span><span class=no>string</span><span class=p>]</span><span class=nv>$Message</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=p>[</span><span class=nb>Alias</span><span class=p>(</span><span class=s1>&#39;A&#39;</span><span class=p>)][</span><span class=no>string</span><span class=p>]</span><span class=nv>$Action</span> <span class=p>=</span> <span class=s1>&#39;Continue&#39;</span>
</span></span><span class=line><span class=cl>  <span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=k>switch</span> <span class=p>(</span><span class=nv>$Type</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=s1>&#39;HL&#39;</span>    <span class=p>{</span> <span class=nb>Write-Host</span> <span class=s2>&#34;</span><span class=nv>${NL}</span><span class=s2>--- </span><span class=nv>${Message}</span><span class=s2>&#34;</span><span class=p>.</span><span class=py>ToUpper</span><span class=p>()</span> <span class=n>-ForegroundColor</span> <span class=n>Blue</span> <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=s1>&#39;I&#39;</span>     <span class=p>{</span> <span class=nb>Write-Information</span> <span class=n>-MessageData</span> <span class=s2>&#34;</span><span class=nv>${Message}</span><span class=s2>&#34;</span> <span class=n>-InformationAction</span> <span class=s2>&#34;</span><span class=nv>${Action}</span><span class=s2>&#34;</span> <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=s1>&#39;W&#39;</span>     <span class=p>{</span> <span class=nb>Write-Warning</span> <span class=n>-Message</span> <span class=s2>&#34;</span><span class=nv>${Message}</span><span class=s2>&#34;</span> <span class=n>-WarningAction</span> <span class=s2>&#34;</span><span class=nv>${Action}</span><span class=s2>&#34;</span> <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=s1>&#39;E&#39;</span>     <span class=p>{</span> <span class=nb>Write-Error</span> <span class=n>-Message</span> <span class=s2>&#34;</span><span class=nv>${Message}</span><span class=s2>&#34;</span> <span class=n>-ErrorAction</span> <span class=s2>&#34;</span><span class=nv>${Action}</span><span class=s2>&#34;</span> <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=k>default</span> <span class=p>{</span> <span class=nb>Write-Host</span> <span class=s2>&#34;</span><span class=nv>${Message}</span><span class=s2>&#34;</span> <span class=p>}</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c># -------------------------------------------------------------------------------------------------------------------- #</span>
</span></span><span class=line><span class=cl><span class=c># -------------------------------------------------&lt; RUNNING SCRIPT &gt;------------------------------------------------- #</span>
</span></span><span class=line><span class=cl><span class=c># -------------------------------------------------------------------------------------------------------------------- #</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nb>Start-Script</span></span></span></code></pre></td></tr></table></div></div></div></div></div></div></div><div class=tab-pane id=tab-pane-main-info role=tabpanel aria-labelledby=tab-main-info tabindex=0><div class=node-body><div class="row row-cols-1 row-cols-lg-2 g-3"><div class=col><section class="card node-categories h-100"><div class=card-body><h5 class=card-title>Категории</h5><ul class=list-inline><li class=list-inline-item><a href=https://lib.onl/ru/categories/windows/>MS Windows</a></li><li class=list-inline-item><a href=https://lib.onl/ru/categories/terminal/>Терминал</a></li><li class=list-inline-item><a href=https://lib.onl/ru/categories/scripts/>Скрипты</a></li></ul></div></section></div><div class=col><section class="card node-tags h-100"><div class=card-body><h5 class=card-title>Теги</h5><ul class=list-inline><li class=list-inline-item><a href=https://lib.onl/ru/tags/powershell/>#powershell</a></li><li class=list-inline-item><a href=https://lib.onl/ru/tags/hdd/>#hdd</a></li><li class=list-inline-item><a href=https://lib.onl/ru/tags/ssd/>#ssd</a></li></ul></div></section></div><div class=col><section class="card node-authors h-100"><div class=card-body><h5 class=card-title>Авторы</h5><ul><li><a href=https://lib.onl/ru/authors/kaikimera/>Kai Kimera</a></li></ul></div></section></div><div class=col><section class="card node-similar h-100"><div class=card-body><h5 class=card-title>Смотрите также</h5><ul><li><a href=/ru/2023/10/eb39e3f7-b194-53d4-8bad-01edf9fdac47/>Дефрагментация в ОС Windows</a></li><li><a href=/ru/2023/10/2a73410a-6611-570c-9ab4-dc8cc8998146/>PowerShell: Сжатие видео при помощи FFmpeg</a></li><li><a href=/ru/2023/10/0028821e-c96c-5014-a1dd-8963c161b170/>PowerShell: Определение разрядности ОС Windows</a></li><li><a href=/ru/2023/10/4c7aba7c-f5a6-589a-9975-fdb16f2e2862/>PowerShell Vault</a></li><li><a href=/ru/2023/10/75075788-9308-56b7-b531-2008cb35f7d0/>Установка сертификата НУЦ Минцифры</a></li><li><a href=/ru/2022/05/36058650-3f35-5ed5-9565-0aa7d8800c28/>Windows Server 2022 для рабочей станции</a></li></ul></div></section></div><div class=col><section class="card node-meta h-100"><div class=card-body><h5 class=card-title>Мета</h5><div class="row row-cols-1 row-cols-sm-2 g-2 align-items-center"><div class=col>Лицензия</div><div class=col><div class=input-group><input type=text class=form-control value=CC-BY-SA-4.0 readonly>
<a class="btn btn-primary" href=https://choosealicense.com/licenses/cc-by-sa-4.0 target=_blank role=button rel="noopener noreferrer nofollow" title="Текст лицензии"><i class="far fa-file-lines fa-fw"></i></a></div></div><div class=col>ID файла</div><div class=col><input type=text class=form-control value=ee8e7f2d0f11fcf70b2ca33ea3f0e80d readonly></div><div class=col>UUID</div><div class=col><input type=text class=form-control value=52d75b90-0637-5ba6-91d6-b1bff40e1d67 readonly></div><div class=col>Системный путь</div><div class=col><input type=text class=form-control value=articles/2023/10/1698058984859_4016/index.md readonly></div><div class=col>Тип</div><div class=col><input type=text class=form-control value=articles readonly></div></div></div></section></div><div class=col><section class="card node-stats h-100"><div class=card-body><h5 class=card-title>Статистика</h5><div class="row row-cols-1 row-cols-sm-2 g-2 align-items-center"><div class=col>Количество слов</div><div class=col><input type=text class=form-control value=866 readonly></div><div class=col>Время чтения</div><div class=col><div class=input-group><input type=text class=form-control value=5 readonly>
<span class=input-group-text>мин.</span></div></div></div></div></section></div></div></div></div><div class=tab-pane id=tab-pane-main-comments role=tabpanel aria-labelledby=tab-main-comments tabindex=0><div class=node-body><div class=giscus></div></div></div><div class=tab-pane id=tab-pane-main-share role=tabpanel aria-labelledby=tab-main-share tabindex=0><div class=node-body><div class="row row-cols-1 row-cols-lg-2 g-3"><div class=col><div class="row row-cols-1 g-3"><div class=col><div class="row row-cols-auto g-2"><div class=col><a class="btn btn-light" href="mailto:?subject=PowerShell%3a%20%d0%a1%d1%82%d0%b8%d1%80%d0%b0%d0%bd%d0%b8%d0%b5%20%d0%b4%d0%b8%d1%81%d0%ba%d0%b0&amp;body=https%3a%2f%2flib.onl%2fru%2f2023%2f10%2f52d75b90-0637-5ba6-91d6-b1bff40e1d67%2f" data-bs-tooltip data-bs-title=Email role=button rel="noopener noreferrer nofollow"><i class="fas fa-envelope-open-text fa-fw"></i></a></div><div class=col><a class="btn btn-light btn-social" href="https://twitter.com/intent/tweet?url=https%3a%2f%2flib.onl%2fru%2f2023%2f10%2f52d75b90-0637-5ba6-91d6-b1bff40e1d67%2f&amp;text=PowerShell%3a%20%d0%a1%d1%82%d0%b8%d1%80%d0%b0%d0%bd%d0%b8%d0%b5%20%d0%b4%d0%b8%d1%81%d0%ba%d0%b0&amp;hashtags=powershell%2chdd%2cssd" title=Twitter role=button rel="noopener noreferrer nofollow" data-fn=popup><i class="fab fa-twitter fa-fw"></i></a></div><div class=col><a class="btn btn-light btn-social" href="https://facebook.com/sharer/sharer.php?u=https%3a%2f%2flib.onl%2fru%2f2023%2f10%2f52d75b90-0637-5ba6-91d6-b1bff40e1d67%2f" title=Facebook role=button rel="noopener noreferrer nofollow" data-fn=popup><i class="fab fa-facebook fa-fw"></i></a></div><div class=col><a class="btn btn-light btn-social" href="https://linkedin.com/sharing/share-offsite/?url=https%3a%2f%2flib.onl%2fru%2f2023%2f10%2f52d75b90-0637-5ba6-91d6-b1bff40e1d67%2f" data-bs-tooltip data-bs-title=LinkedIn role=button rel="noopener noreferrer nofollow" data-fn=popup><i class="fab fa-linkedin fa-fw"></i></a></div><div class=col><a class="btn btn-light btn-social" href="https://reddit.com/submit?url=https%3a%2f%2flib.onl%2fru%2f2023%2f10%2f52d75b90-0637-5ba6-91d6-b1bff40e1d67%2f&amp;title=PowerShell%3a%20%d0%a1%d1%82%d0%b8%d1%80%d0%b0%d0%bd%d0%b8%d0%b5%20%d0%b4%d0%b8%d1%81%d0%ba%d0%b0" data-bs-tooltip data-bs-title=Reddit role=button rel="noopener noreferrer nofollow" data-fn=popup><i class="fab fa-reddit fa-fw"></i></a></div><div class=col><a class="btn btn-light btn-social" href="https://vk.com/share.php?url=https%3a%2f%2flib.onl%2fru%2f2023%2f10%2f52d75b90-0637-5ba6-91d6-b1bff40e1d67%2f&amp;title=PowerShell%3a%20%d0%a1%d1%82%d0%b8%d1%80%d0%b0%d0%bd%d0%b8%d0%b5%20%d0%b4%d0%b8%d1%81%d0%ba%d0%b0&amp;description=%d0%9d%d0%b5%d0%b1%d0%be%d0%bb%d1%8c%d1%88%d0%be%d0%b9%20%d1%81%d0%ba%d1%80%d0%b8%d0%bf%d1%82%2c%20%d0%ba%d0%be%d1%82%d0%be%d1%80%d1%8b%d0%b9%20%d0%be%d0%b1%d0%bd%d1%83%d0%bb%d1%8f%d0%b5%d1%82%20%23HDD%20%2f%20%23SSD%20%d0%b8%20%d1%81%d0%be%d0%b7%d0%b4%d0%b0%d1%91%d1%82%20%d1%84%d0%b0%d0%b9%d0%bb%d0%be%d0%b2%d1%83%d1%8e%20%d1%81%d0%b8%d1%81%d1%82%d0%b5%d0%bc%d1%83%20%d0%b7%d0%b0%d0%bd%d0%be%d0%b2%d0%be.%0a" title=ВКонтакте role=button rel="noopener noreferrer nofollow" data-fn=popup><i class="fab fa-vk fa-fw"></i></a></div><div class=col><a class="btn btn-light btn-social" href="https://t.me/share/url?url=https%3a%2f%2flib.onl%2fru%2f2023%2f10%2f52d75b90-0637-5ba6-91d6-b1bff40e1d67%2f&amp;text=PowerShell%3a%20%d0%a1%d1%82%d0%b8%d1%80%d0%b0%d0%bd%d0%b8%d0%b5%20%d0%b4%d0%b8%d1%81%d0%ba%d0%b0" data-bs-tooltip data-bs-title=Telegram role=button rel="noopener noreferrer nofollow" data-fn=popup><i class="fab fa-telegram fa-fw"></i></a></div><div class=col><a class="btn btn-light btn-social" href="http://pinterest.com/pin/create/button/?url=https%3a%2f%2flib.onl%2fru%2f2023%2f10%2f52d75b90-0637-5ba6-91d6-b1bff40e1d67%2f" title=Pinterest role=button rel="noopener noreferrer nofollow" data-fn=popup><i class="fab fa-pinterest fa-fw"></i></a></div><div class=col><a class="btn btn-light btn-social" href="https://getpocket.com/edit?url=https%3a%2f%2flib.onl%2fru%2f2023%2f10%2f52d75b90-0637-5ba6-91d6-b1bff40e1d67%2f&amp;title=PowerShell%3a%20%d0%a1%d1%82%d0%b8%d1%80%d0%b0%d0%bd%d0%b8%d0%b5%20%d0%b4%d0%b8%d1%81%d0%ba%d0%b0" target=_blank title=Pocket role=button rel="noopener noreferrer nofollow" data-fn=popup><i class="fab fa-get-pocket fa-fw"></i></a></div><div class=col><a class="btn btn-light btn-social" href="https://news.ycombinator.com/submitlink?u=https%3a%2f%2flib.onl%2fru%2f2023%2f10%2f52d75b90-0637-5ba6-91d6-b1bff40e1d67%2f&amp;t=PowerShell%3a%20%d0%a1%d1%82%d0%b8%d1%80%d0%b0%d0%bd%d0%b8%d0%b5%20%d0%b4%d0%b8%d1%81%d0%ba%d0%b0" data-bs-tooltip data-bs-title='Hacker News' role=button rel="noopener noreferrer nofollow" data-fn=popup><i class="fab fa-hacker-news fa-fw"></i></a></div><div class=col><a class="btn btn-light btn-social" href="https://livejournal.com/update.bml?subject=PowerShell%3a%20%d0%a1%d1%82%d0%b8%d1%80%d0%b0%d0%bd%d0%b8%d0%b5%20%d0%b4%d0%b8%d1%81%d0%ba%d0%b0&amp;event=https%3a%2f%2flib.onl%2fru%2f2023%2f10%2f52d75b90-0637-5ba6-91d6-b1bff40e1d67%2f" title=LiveJournal role=button rel="noopener noreferrer nofollow" data-fn=popup><i class="fas fa-edit fa-fw"></i></a></div><div class=col><a class="btn btn-light btn-social" href="https://connect.ok.ru/dk?st.cmd=WidgetSharePreview&amp;st.shareUrl=https%3a%2f%2flib.onl%2fru%2f2023%2f10%2f52d75b90-0637-5ba6-91d6-b1bff40e1d67%2f&amp;title=PowerShell%3a%20%d0%a1%d1%82%d0%b8%d1%80%d0%b0%d0%bd%d0%b8%d0%b5%20%d0%b4%d0%b8%d1%81%d0%ba%d0%b0" title=Одноклассники role=button rel="noopener noreferrer nofollow" data-fn=popup><i class="fab fa-odnoklassniki fa-fw"></i></a></div><div class=col><a class="btn btn-light btn-social" href="https://blogger.com/blog-this.g?u=https%3a%2f%2flib.onl%2fru%2f2023%2f10%2f52d75b90-0637-5ba6-91d6-b1bff40e1d67%2f&amp;n=PowerShell%3a%20%d0%a1%d1%82%d0%b8%d1%80%d0%b0%d0%bd%d0%b8%d0%b5%20%d0%b4%d0%b8%d1%81%d0%ba%d0%b0&amp;t=%d0%9d%d0%b5%d0%b1%d0%be%d0%bb%d1%8c%d1%88%d0%be%d0%b9%20%d1%81%d0%ba%d1%80%d0%b8%d0%bf%d1%82%2c%20%d0%ba%d0%be%d1%82%d0%be%d1%80%d1%8b%d0%b9%20%d0%be%d0%b1%d0%bd%d1%83%d0%bb%d1%8f%d0%b5%d1%82%20%23HDD%20%2f%20%23SSD%20%d0%b8%20%d1%81%d0%be%d0%b7%d0%b4%d0%b0%d1%91%d1%82%20%d1%84%d0%b0%d0%b9%d0%bb%d0%be%d0%b2%d1%83%d1%8e%20%d1%81%d0%b8%d1%81%d1%82%d0%b5%d0%bc%d1%83%20%d0%b7%d0%b0%d0%bd%d0%be%d0%b2%d0%be.%0a" title=Blogger role=button rel="noopener noreferrer nofollow" data-fn=popup><i class="fab fa-blogger fa-fw"></i></a></div><div class=col><a class="btn btn-light btn-social" href="https://digg.com/submit?url=https%3a%2f%2flib.onl%2fru%2f2023%2f10%2f52d75b90-0637-5ba6-91d6-b1bff40e1d67%2f" data-bs-tooltip data-bs-title=Digg role=button rel="noopener noreferrer nofollow" data-fn=popup><i class="fab fa-digg fa-fw"></i></a></div><div class=col><a class="btn btn-light btn-social" href="https://web.skype.com/share?url=https%3a%2f%2flib.onl%2fru%2f2023%2f10%2f52d75b90-0637-5ba6-91d6-b1bff40e1d67%2f&amp;title=PowerShell%3a%20%d0%a1%d1%82%d0%b8%d1%80%d0%b0%d0%bd%d0%b8%d0%b5%20%d0%b4%d0%b8%d1%81%d0%ba%d0%b0" data-bs-tooltip data-bs-title=Skype role=button rel="noopener noreferrer nofollow" data-fn=popup><i class="fab fa-skype fa-fw"></i></a></div><div class=col><a class="btn btn-light btn-social" href="https://api.whatsapp.com/send?text=https%3a%2f%2flib.onl%2fru%2f2023%2f10%2f52d75b90-0637-5ba6-91d6-b1bff40e1d67%2f" title=WhatsApp role=button rel="noopener noreferrer nofollow" data-fn=popup><i class="fab fa-whatsapp fa-fw"></i></a></div><div class=col><a class="btn btn-light btn-social" href="https://tumblr.com/widgets/share/tool?canonicalUrl=https%3a%2f%2flib.onl%2fru%2f2023%2f10%2f52d75b90-0637-5ba6-91d6-b1bff40e1d67%2f&amp;title=PowerShell%3a%20%d0%a1%d1%82%d0%b8%d1%80%d0%b0%d0%bd%d0%b8%d0%b5%20%d0%b4%d0%b8%d1%81%d0%ba%d0%b0&amp;content=%d0%9d%d0%b5%d0%b1%d0%be%d0%bb%d1%8c%d1%88%d0%be%d0%b9%20%d1%81%d0%ba%d1%80%d0%b8%d0%bf%d1%82%2c%20%d0%ba%d0%be%d1%82%d0%be%d1%80%d1%8b%d0%b9%20%d0%be%d0%b1%d0%bd%d1%83%d0%bb%d1%8f%d0%b5%d1%82%20%23HDD%20%2f%20%23SSD%20%d0%b8%20%d1%81%d0%be%d0%b7%d0%b4%d0%b0%d1%91%d1%82%20%d1%84%d0%b0%d0%b9%d0%bb%d0%be%d0%b2%d1%83%d1%8e%20%d1%81%d0%b8%d1%81%d1%82%d0%b5%d0%bc%d1%83%20%d0%b7%d0%b0%d0%bd%d0%be%d0%b2%d0%be.%0a&amp;tags=powershell%2chdd%2cssd&amp;posttype=link" title=Tumblr role=button rel="noopener noreferrer nofollow" data-fn=popup><i class="fab fa-tumblr fa-fw"></i></a></div><div class=col><a class="btn btn-light btn-social" href="https://wordpress.com/wp-admin/press-this.php?u=https%3a%2f%2flib.onl%2fru%2f2023%2f10%2f52d75b90-0637-5ba6-91d6-b1bff40e1d67%2f&amp;t=PowerShell%3a%20%d0%a1%d1%82%d0%b8%d1%80%d0%b0%d0%bd%d0%b8%d0%b5%20%d0%b4%d0%b8%d1%81%d0%ba%d0%b0&amp;s=%d0%9d%d0%b5%d0%b1%d0%be%d0%bb%d1%8c%d1%88%d0%be%d0%b9%20%d1%81%d0%ba%d1%80%d0%b8%d0%bf%d1%82%2c%20%d0%ba%d0%be%d1%82%d0%be%d1%80%d1%8b%d0%b9%20%d0%be%d0%b1%d0%bd%d1%83%d0%bb%d1%8f%d0%b5%d1%82%20%23HDD%20%2f%20%23SSD%20%d0%b8%20%d1%81%d0%be%d0%b7%d0%b4%d0%b0%d1%91%d1%82%20%d1%84%d0%b0%d0%b9%d0%bb%d0%be%d0%b2%d1%83%d1%8e%20%d1%81%d0%b8%d1%81%d1%82%d0%b5%d0%bc%d1%83%20%d0%b7%d0%b0%d0%bd%d0%be%d0%b2%d0%be.%0a" title=WordPress role=button rel="noopener noreferrer nofollow" data-fn=popup><i class="fab fa-wordpress fa-fw"></i></a></div></div></div><div class=col><div class=input-group><span class=input-group-text><i class="fas fa-link fa-fw"></i></span>
<input type=text class=form-control value=https://lib.onl/ru/2023/10/52d75b90-0637-5ba6-91d6-b1bff40e1d67/ data-fn=select-all readonly></div></div><div class=col><div class=input-group><span class=input-group-text><i class="fas fa-file fa-fw"></i></span>
<input type=text class=form-control value=articles/2023/10/1698058984859_4016/index.md data-fn=select-all readonly></div></div></div></div><div class=col><div class="d-flex justify-content-center"><div class="d-block img-thumbnail" data-fn=qrcode data-qr-text=https://lib.onl/ru/2023/10/52d75b90-0637-5ba6-91d6-b1bff40e1d67/></div></div></div></div></div></div></div></article></div></div></main><footer class="mt-auto border-top bg-body-tertiary" id=site-footer><div class="section py-5 border-bottom"><div class=container><div class="row g-3"><div class=col-lg><article><h2 class="h5 border-bottom pb-1 mb-3">О проекте</h2><div class=node-body><p>Заметки по системному администрированию и веб-разработкам.</p></div></article></div><div class=col-lg><article><h2 class="h5 border-bottom pb-1 mb-3">Ресурсы</h2><div class=node-body><ul><li><a title href=https://kai.kim/ target=_blank rel="noopener noreferrer">Kai Kimera</a></li><li><a title href=https://uaik.github.io/ target=_blank rel="noopener noreferrer">Universal AIK</a></li></ul></div></article></div><div class=col-lg><article><h2 class="h5 border-bottom pb-1 mb-3">Контакты</h2><div class=node-body><ul><li><a title href=mailto:mail@lib.onl target=_self rel>Email</a></li></ul></div></article></div></div></div></div><div class="section py-3 bg-body-secondary"><div class=container><div class="row row-cols-1 row-cols-lg-2 small text-body-secondary align-items-center"><div class="col text-center text-lg-start"><ul class="list-inline mb-0"><li class=list-inline-item><div>Library Online &copy; 2025</div><div>Заметки на тему администрирования и разработки различных систем, приложений и серверов.</div></li></ul></div><div class="col text-center text-lg-end"><ul class="list-inline mb-0"><li class=list-inline-item title=JSON><a class="btn btn-sm" href=/ru/2023/10/52d75b90-0637-5ba6-91d6-b1bff40e1d67/index.json target=_blank aria-label=JSON><i class="fas fa-code fa-fw"></i></a></li><li class="list-inline-item dropup" title='Тема интерфейса'><button class="btn btn-sm dropdown-toggle ui-theme" type=button data-bs-toggle=dropdown aria-expanded=false aria-label='Переключить тему'>
<i class="fas fa-circle-half-stroke fa-fw"></i></button><ul class="dropdown-menu dropdown-menu-end shadow"><li><button class=dropdown-item type=button data-bs-theme-value=light aria-pressed=false>
<i class="fas fa-sun fa-fw"></i>
<span>Светлая</span></button></li><li><button class=dropdown-item type=button data-bs-theme-value=dark aria-pressed=false>
<i class="fas fa-moon fa-fw"></i>
<span>Тёмная</span></button></li><li><button class="dropdown-item active" type=button data-bs-theme-value=auto aria-pressed=true>
<i class="fas fa-circle-half-stroke fa-fw"></i>
<span>Системная</span></button></li></ul></li><li class="list-inline-item dropup" title=Языки><button class="btn btn-sm dropdown-toggle" type=button data-bs-toggle=dropdown aria-expanded=false aria-label=Языки>
<i class="fas fa-language fa-fw"></i></button><ul class="dropdown-menu dropdown-menu-end shadow"><li><a class=dropdown-item href=/ru/ hreflang=ru>Русский</a></li><li><a class=dropdown-item href=/en/ hreflang=en>English</a></li></ul></li></ul></div></div></div></div></footer><div class="modal fade" id=search-modal tabindex=-1 aria-labelledby=searchModalLabel aria-hidden=true><div class="modal-dialog modal-dialog-scrollable modal-xl"><div class=modal-content><div class=modal-header><h5 class=modal-title id=searchModalLabel>Поиск</h5><button type=button class=btn-close data-bs-dismiss=modal aria-label=Закрыть></button></div><div class="modal-body node-body"><div class="row row-cols-1 g-3"><div class=col><div class="row g-3"><div class=col-lg><form action=https://google.com/search method=get class=d-flex target=_blank><input type=hidden name=domains value=lib.onl>
<input type=hidden name=sitesearch value=lib.onl><div class=input-group><span class=input-group-text><i class="fas fa-search fa-fw"></i></span>
<input type=search class=form-control name=q placeholder='Поиск Google' aria-label='Поиск Google'>
<span class=input-group-text><i class="fab fa-google fa-fw"></i></span></div></form></div><div class=col-lg><form action=https://ya.ru/search method=get class=d-flex target=_blank><input type=hidden name=site value=lib.onl><div class=input-group><span class=input-group-text><i class="fas fa-search fa-fw"></i></span>
<input type=search class=form-control name=text placeholder='Поиск Яндекс' aria-label='Поиск Яндекс'>
<span class=input-group-text><i class="fab fa-yandex fa-fw"></i></span></div></form></div></div></div><div class=col><form id=search-form method=get class=d-flex autocomplete=off><div class=input-group><span class=input-group-text><i class="fas fa-search fa-fw"></i></span>
<input id=search-input type=search class=form-control name=q placeholder='Внутренний поиск' aria-label='Внутренний поиск'>
<span class=input-group-text><i class="fas fa-brain fa-fw"></i></span></div></form></div><div class=col><div class="list-group list-group-flush d-none overflow-auto" id=search-results></div><div id=search-help><div class="alert alert-info d-flex align-items-center overflow-hidden node-body" id=alert-f27ab8bb8b3dde2c3a3e222b2d6dfd9c role=alert><div class=flex-shrink-0><i class="fas fa-search fa-fw fa-2x"></i></div><div class="flex-grow-1 ms-3 overflow-hidden"><p>Используется нечёткий поиск (приблизительное сопоставление строк).
Это метод поиска строк, которые приблизительно соответствуют поисковому шаблону.</p><p>Результаты поиска сортируются по точности совпадения с поисковым шаблоном.
Результаты поиска, наиболее точно соответствующие запросу, находятся сверху, приблизительные результаты - снизу.</p></div></div></div></div></div></div></div></div></div><script src=/js/vendor.bundle.min.85b1a46641329b26e58b16e922d5e9797dbc96de73b50df4a9e8f4b897566128.js integrity="sha256-hbGkZkEymyblixbpItXpeX28lt5ztQ30qej0uJdWYSg=" crossorigin=anonymous defer></script><script src=/ru/js/system.bundle.min.e8278af4a5e659c111987a377887079e16ac2cb49267841b749d588d554f6820.js integrity="sha256-6CeK9KXmWcERmHo3eIcHnhasLLSSZ4QbdJ1YjVVPaCA=" crossorigin=anonymous defer></script><script src=https://giscus.app/client.js data-repo=s8956/comments data-repo-id=R_kgDOKgu0Tg data-category=Site data-category-id=DIC_kwDOKgu0Ts4CaJ2z data-mapping=pathname data-strict=1 data-reactions-enabled=1 data-emit-metadata=0 data-input-position=top data-theme=preferred_color_scheme data-lang=ru data-loading=lazy crossorigin=anonymous async></script><script type=application/ld+json>{"@context":"https://schema.org","@type":"Article","articleBody":"Небольшой скрипт, который обнуляет #HDD / #SSD и создаёт файловую систему заново.\nПараметры -DN -P_DiskNumber - номер диска. Можно узнать командой Get-Disk. Но если не ввести номер диска в параметры скрипта при запуске, скрипт сам выведет информацию и спросит номер диска. Обязательный параметр. -FS -P_FileSystem - файловая система. Может принимать следующие значения: 'FAT' - файловая система FAT. 'FAT32' - файловая система FAT32. 'exFAT' - файловая система exFAT. 'NTFS' - файловая система NTFS. 'ReFS' - новая файловая система ReFS. -S -P_Sleep - перерыв между командами (в секундах). Примеры Скрипт, запущенный без параметров, сам спросит необходимые данные:\nТерминал 1 .\\pwsh.disk.erase.ps1 Обнулить диск 3 и указать метку USB-SSD:\nТерминал 1 .\\pwsh.disk.erase.ps1 -DN 3 -FS \u0026#39;NTFS\u0026#39; Скрипт pwsh.disk.erase.ps1 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 \u0026lt;#PSScriptInfo .VERSION 0.1.0 .GUID 8d95f4d5-4d14-412c-9fa4-b75ebe79df09 .AUTHOR Kai Kimera .AUTHOREMAIL mail@kai.kim .COMPANYNAME Library Online .COPYRIGHT 2023 Library Online. All rights reserved. .LICENSEURI https://choosealicense.com/licenses/mit/ .PROJECTURI https://lib.onl/ru/2023/10/52d75b90-0637-5ba6-91d6-b1bff40e1d67/ #\u0026gt; #Requires -Version 7.2 #Requires -RunAsAdministrator \u0026lt;# .SYNOPSIS Disk erase script. .DESCRIPTION Disk cleanup followed by partition creation. .PARAMETER P_DiskNumber Specifies the disk number of the disk on which to perform the clear operation. For a list of available disks, see the \u0026#39;Get-Disk\u0026#39; cmdlet. .PARAMETER P_FileSystem Specifies the file system with which to format the volume. The acceptable values for this parameter are: \u0026#39;NTFS\u0026#39;, \u0026#39;ReFS\u0026#39;, \u0026#39;exFAT\u0026#39;, \u0026#39;FAT32\u0026#39; and \u0026#39;FAT\u0026#39;. .PARAMETER P_Sleep Sleep time (in seconds). .EXAMPLE .\\pwsh.disk.erase.ps1 -DN 3 -FS \u0026#39;NTFS\u0026#39; .LINK https://lib.onl/ru/2023/10/52d75b90-0637-5ba6-91d6-b1bff40e1d67/ #\u0026gt; # -------------------------------------------------------------------------------------------------------------------- # # CONFIGURATION # -------------------------------------------------------------------------------------------------------------------- # param( [Parameter(HelpMessage=\u0026#34;Specify the disk number.\u0026#34;)] [ValidatePattern(\u0026#39;^[0-9]+$\u0026#39;)] [Alias(\u0026#39;DN\u0026#39;)][int]$P_DiskNumber, [Parameter(HelpMessage=\u0026#34;Specify the file system to format the volume.\u0026#34;)] [ValidateSet(\u0026#39;FAT\u0026#39;, \u0026#39;FAT32\u0026#39;, \u0026#39;exFAT\u0026#39;, \u0026#39;NTFS\u0026#39;, \u0026#39;ReFS\u0026#39;)] [Alias(\u0026#39;FS\u0026#39;)][string]$P_FileSystem, [Parameter(HelpMessage=\u0026#34;Sleep time (in seconds).\u0026#34;)] [Alias(\u0026#39;S\u0026#39;)][int]$P_Sleep = 2 ) # New line separator. $NL = \u0026#34;$([Environment]::NewLine)\u0026#34; # Random number. $Random = \u0026#34;$(Get-Random -Minimum 1000 -Maximum 9999)\u0026#34; # Getting free drive letter and to assign to the new partition. $DriveLetter = \u0026#34;$((68..90 | ForEach-Object { $L=[char]$_; if ((Get-PSDrive).Name -notContains $L) { $L } })[0])\u0026#34; # Specifying a new label to use for the volume. $FileSystemLabel = \u0026#34;DISK_${Random}\u0026#34; # -------------------------------------------------------------------------------------------------------------------- # # INITIALIZATION # -------------------------------------------------------------------------------------------------------------------- # function Start-Script() { Start-DPDiskList # Showing disk list. if (-not $P_DiskNumber) { $P_DiskNumber = (Read-Host -Prompt \u0026#39;Disk number\u0026#39;) } # Getting disk number. if (-not $P_FileSystem) { $P_FileSystem = (Read-Host -Prompt \u0026#39;File system\u0026#39;) } # Getting file system. Start-DPDiskClear # Starting clearing disk. Start-DPDiskInit # Initializing disk. Start-DPDiskPartition # Creating partition. Start-DPDiskFormat # Formatting volume. } # -------------------------------------------------------------------------------------------------------------------- # # DISK LIST # -------------------------------------------------------------------------------------------------------------------- # function Start-DPDiskList() { Write-Msg -T \u0026#39;HL\u0026#39; -M \u0026#39;Disk List\u0026#39; Get-Disk } # -------------------------------------------------------------------------------------------------------------------- # # CLEAR DISK # -------------------------------------------------------------------------------------------------------------------- # function Start-DPDiskClear() { Write-Msg -T \u0026#39;HL\u0026#39; -M \u0026#34;[DISK #${P_DiskNumber}] Clear Disk\u0026#34; Write-Msg -T \u0026#39;W\u0026#39; -A \u0026#39;Inquire\u0026#39; -M (\u0026#34;You specified drive number \u0026#39;${P_DiskNumber}\u0026#39;.${NL}\u0026#34; + \u0026#34;All data will be DELETED!\u0026#34;) $Param = @{ Number = $P_DiskNumber RemoveData = $true RemoveOEM = $true Confirm = $false } Clear-Disk @Param Start-Sleep -s $P_Sleep } # -------------------------------------------------------------------------------------------------------------------- # # INITIALIZE DISK # -------------------------------------------------------------------------------------------------------------------- # function Start-DPDiskInit() { Write-Msg -T \u0026#39;HL\u0026#39; -M \u0026#34;[DISK #${P_DiskNumber}] Initialize Disk\u0026#34; $Param = @{ Number = $P_DiskNumber PartitionStyle = \u0026#39;GPT\u0026#39; } Initialize-Disk @Param Start-Sleep -s $P_Sleep } # -------------------------------------------------------------------------------------------------------------------- # # CREATE PARTITION # -------------------------------------------------------------------------------------------------------------------- # function Start-DPDiskPartition() { Write-Msg -T \u0026#39;HL\u0026#39; -M \u0026#34;[DISK #${P_DiskNumber}] Create Partition\u0026#34; $Param = @{ DiskNumber = $P_DiskNumber DriveLetter = \u0026#34;${DriveLetter}\u0026#34; UseMaximumSize = $true } New-Partition @Param Start-Sleep -s $P_Sleep } # -------------------------------------------------------------------------------------------------------------------- # # FORMAT DISK VOLUME # -------------------------------------------------------------------------------------------------------------------- # function Start-DPDiskFormat() { Write-Msg -T \u0026#39;HL\u0026#39; -M \u0026#34;[DISK #${P_DiskNumber}] Format Disk Volume (${DriveLetter} / ${P_FileSystem})\u0026#34; if (-not $P_FileSystem) { $P_FileSystem = \u0026#39;NTFS\u0026#39; } $Param = @{ DriveLetter = \u0026#34;${DriveLetter}\u0026#34; FileSystem = \u0026#34;${P_FileSystem}\u0026#34; NewFileSystemLabel = \u0026#34;${FileSystemLabel}\u0026#34; Force = $true } Format-Volume @Param Start-Sleep -s $P_Sleep } # -------------------------------------------------------------------------------------------------------------------- # # ------------------------------------------------\u0026lt; COMMON FUNCTIONS \u0026gt;------------------------------------------------ # # -------------------------------------------------------------------------------------------------------------------- # # -------------------------------------------------------------------------------------------------------------------- # # SYSTEM MESSAGES # -------------------------------------------------------------------------------------------------------------------- # function Write-Msg() { param ( [Alias(\u0026#39;T\u0026#39;)][string]$Type, [Alias(\u0026#39;M\u0026#39;)][string]$Message, [Alias(\u0026#39;A\u0026#39;)][string]$Action = \u0026#39;Continue\u0026#39; ) switch ($Type) { \u0026#39;HL\u0026#39; { Write-Host \u0026#34;${NL}--- ${Message}\u0026#34;.ToUpper() -ForegroundColor Blue } \u0026#39;I\u0026#39; { Write-Information -MessageData \u0026#34;${Message}\u0026#34; -InformationAction \u0026#34;${Action}\u0026#34; } \u0026#39;W\u0026#39; { Write-Warning -Message \u0026#34;${Message}\u0026#34; -WarningAction \u0026#34;${Action}\u0026#34; } \u0026#39;E\u0026#39; { Write-Error -Message \u0026#34;${Message}\u0026#34; -ErrorAction \u0026#34;${Action}\u0026#34; } default { Write-Host \u0026#34;${Message}\u0026#34; } } } # -------------------------------------------------------------------------------------------------------------------- # # -------------------------------------------------\u0026lt; RUNNING SCRIPT \u0026gt;------------------------------------------------- # # -------------------------------------------------------------------------------------------------------------------- # Start-Script ","author":[{"@context":"https://schema.org","@type":"Person","address":{"@type":"PostalAddress","addressCountry":"Russia","addressLocality":"Reutov","addressRegion":"Moscow Region"},"alternateName":"Kai Kimera","award":["Грамота АО Институт ЭНЕРГОСЕТЬПРОЕКТ"],"birthDate":"1987-03-13","birthPlace":{"@type":"Place","address":{"@type":"PostalAddress","addressCountry":"Russia","addressLocality":"Reutov","addressRegion":"Moscow Region"}},"email":"mail@kai.kim","gender":"Male","image":"https://gravatar.com/avatar/911c0a839d7d4c3d750a8ce0de293e84?s=512","jobTitle":"System administrator","mainEntityOfPage":"https://lib.onl/ru/authors/kaikimera/","name":"Kai Kimera","sameAs":["https://github.com/KaiKimera","https://instagram.com/KaiKimera","https://twitter.com/KaiKimera","https://vk.com/KaiKimera","https://youtube.com/@KaiKimera"],"telephone":"+7 (000) 000-0000","url":"https://kai.kim/"}],"dateCreated":"2023-10-23T11:03:04Z","dateModified":"2023-10-23T11:03:04Z","datePublished":"2023-10-23T11:03:04Z","description":"Небольшой скрипт, который обнуляет #HDD / #SSD и создаёт файловую систему заново.\n","headline":"PowerShell: Стирание диска","image":"https://images.unsplash.com/photo-1646226343350-1ee5021e342a","inLanguage":[{"@type":"Language","alternateName":"ru-RU","name":"Русский"}],"keywords":["powershell","hdd","ssd"],"mainEntityOfPage":"https://lib.onl/ru/2023/10/52d75b90-0637-5ba6-91d6-b1bff40e1d67/","pageEnd":1,"pageStart":1,"publisher":"https://lib.onl/#organization","text":"Небольшой скрипт, который обнуляет #HDD / #SSD и создаёт файловую систему заново.\nПараметры -DN -P_DiskNumber - номер диска. Можно узнать командой Get-Disk. Но если не ввести номер диска в параметры скрипта при запуске, скрипт сам выведет информацию и спросит номер диска. Обязательный параметр. -FS -P_FileSystem - файловая система. Может принимать следующие значения: 'FAT' - файловая система FAT. 'FAT32' - файловая система FAT32. 'exFAT' - файловая система exFAT. 'NTFS' - файловая система NTFS. 'ReFS' - новая файловая система ReFS. -S -P_Sleep - перерыв между командами (в секундах). Примеры Скрипт, запущенный без параметров, сам спросит необходимые данные:\nТерминал 1 .\\pwsh.disk.erase.ps1 Обнулить диск 3 и указать метку USB-SSD:\nТерминал 1 .\\pwsh.disk.erase.ps1 -DN 3 -FS \u0026#39;NTFS\u0026#39; Скрипт pwsh.disk.erase.ps1 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 \u0026lt;#PSScriptInfo .VERSION 0.1.0 .GUID 8d95f4d5-4d14-412c-9fa4-b75ebe79df09 .AUTHOR Kai Kimera .AUTHOREMAIL mail@kai.kim .COMPANYNAME Library Online .COPYRIGHT 2023 Library Online. All rights reserved. .LICENSEURI https://choosealicense.com/licenses/mit/ .PROJECTURI https://lib.onl/ru/2023/10/52d75b90-0637-5ba6-91d6-b1bff40e1d67/ #\u0026gt; #Requires -Version 7.2 #Requires -RunAsAdministrator \u0026lt;# .SYNOPSIS Disk erase script. .DESCRIPTION Disk cleanup followed by partition creation. .PARAMETER P_DiskNumber Specifies the disk number of the disk on which to perform the clear operation. For a list of available disks, see the \u0026#39;Get-Disk\u0026#39; cmdlet. .PARAMETER P_FileSystem Specifies the file system with which to format the volume. The acceptable values for this parameter are: \u0026#39;NTFS\u0026#39;, \u0026#39;ReFS\u0026#39;, \u0026#39;exFAT\u0026#39;, \u0026#39;FAT32\u0026#39; and \u0026#39;FAT\u0026#39;. .PARAMETER P_Sleep Sleep time (in seconds). .EXAMPLE .\\pwsh.disk.erase.ps1 -DN 3 -FS \u0026#39;NTFS\u0026#39; .LINK https://lib.onl/ru/2023/10/52d75b90-0637-5ba6-91d6-b1bff40e1d67/ #\u0026gt; # -------------------------------------------------------------------------------------------------------------------- # # CONFIGURATION # -------------------------------------------------------------------------------------------------------------------- # param( [Parameter(HelpMessage=\u0026#34;Specify the disk number.\u0026#34;)] [ValidatePattern(\u0026#39;^[0-9]+$\u0026#39;)] [Alias(\u0026#39;DN\u0026#39;)][int]$P_DiskNumber, [Parameter(HelpMessage=\u0026#34;Specify the file system to format the volume.\u0026#34;)] [ValidateSet(\u0026#39;FAT\u0026#39;, \u0026#39;FAT32\u0026#39;, \u0026#39;exFAT\u0026#39;, \u0026#39;NTFS\u0026#39;, \u0026#39;ReFS\u0026#39;)] [Alias(\u0026#39;FS\u0026#39;)][string]$P_FileSystem, [Parameter(HelpMessage=\u0026#34;Sleep time (in seconds).\u0026#34;)] [Alias(\u0026#39;S\u0026#39;)][int]$P_Sleep = 2 ) # New line separator. $NL = \u0026#34;$([Environment]::NewLine)\u0026#34; # Random number. $Random = \u0026#34;$(Get-Random -Minimum 1000 -Maximum 9999)\u0026#34; # Getting free drive letter and to assign to the new partition. $DriveLetter = \u0026#34;$((68..90 | ForEach-Object { $L=[char]$_; if ((Get-PSDrive).Name -notContains $L) { $L } })[0])\u0026#34; # Specifying a new label to use for the volume. $FileSystemLabel = \u0026#34;DISK_${Random}\u0026#34; # -------------------------------------------------------------------------------------------------------------------- # # INITIALIZATION # -------------------------------------------------------------------------------------------------------------------- # function Start-Script() { Start-DPDiskList # Showing disk list. if (-not $P_DiskNumber) { $P_DiskNumber = (Read-Host -Prompt \u0026#39;Disk number\u0026#39;) } # Getting disk number. if (-not $P_FileSystem) { $P_FileSystem = (Read-Host -Prompt \u0026#39;File system\u0026#39;) } # Getting file system. Start-DPDiskClear # Starting clearing disk. Start-DPDiskInit # Initializing disk. Start-DPDiskPartition # Creating partition. Start-DPDiskFormat # Formatting volume. } # -------------------------------------------------------------------------------------------------------------------- # # DISK LIST # -------------------------------------------------------------------------------------------------------------------- # function Start-DPDiskList() { Write-Msg -T \u0026#39;HL\u0026#39; -M \u0026#39;Disk List\u0026#39; Get-Disk } # -------------------------------------------------------------------------------------------------------------------- # # CLEAR DISK # -------------------------------------------------------------------------------------------------------------------- # function Start-DPDiskClear() { Write-Msg -T \u0026#39;HL\u0026#39; -M \u0026#34;[DISK #${P_DiskNumber}] Clear Disk\u0026#34; Write-Msg -T \u0026#39;W\u0026#39; -A \u0026#39;Inquire\u0026#39; -M (\u0026#34;You specified drive number \u0026#39;${P_DiskNumber}\u0026#39;.${NL}\u0026#34; + \u0026#34;All data will be DELETED!\u0026#34;) $Param = @{ Number = $P_DiskNumber RemoveData = $true RemoveOEM = $true Confirm = $false } Clear-Disk @Param Start-Sleep -s $P_Sleep } # -------------------------------------------------------------------------------------------------------------------- # # INITIALIZE DISK # -------------------------------------------------------------------------------------------------------------------- # function Start-DPDiskInit() { Write-Msg -T \u0026#39;HL\u0026#39; -M \u0026#34;[DISK #${P_DiskNumber}] Initialize Disk\u0026#34; $Param = @{ Number = $P_DiskNumber PartitionStyle = \u0026#39;GPT\u0026#39; } Initialize-Disk @Param Start-Sleep -s $P_Sleep } # -------------------------------------------------------------------------------------------------------------------- # # CREATE PARTITION # -------------------------------------------------------------------------------------------------------------------- # function Start-DPDiskPartition() { Write-Msg -T \u0026#39;HL\u0026#39; -M \u0026#34;[DISK #${P_DiskNumber}] Create Partition\u0026#34; $Param = @{ DiskNumber = $P_DiskNumber DriveLetter = \u0026#34;${DriveLetter}\u0026#34; UseMaximumSize = $true } New-Partition @Param Start-Sleep -s $P_Sleep } # -------------------------------------------------------------------------------------------------------------------- # # FORMAT DISK VOLUME # -------------------------------------------------------------------------------------------------------------------- # function Start-DPDiskFormat() { Write-Msg -T \u0026#39;HL\u0026#39; -M \u0026#34;[DISK #${P_DiskNumber}] Format Disk Volume (${DriveLetter} / ${P_FileSystem})\u0026#34; if (-not $P_FileSystem) { $P_FileSystem = \u0026#39;NTFS\u0026#39; } $Param = @{ DriveLetter = \u0026#34;${DriveLetter}\u0026#34; FileSystem = \u0026#34;${P_FileSystem}\u0026#34; NewFileSystemLabel = \u0026#34;${FileSystemLabel}\u0026#34; Force = $true } Format-Volume @Param Start-Sleep -s $P_Sleep } # -------------------------------------------------------------------------------------------------------------------- # # ------------------------------------------------\u0026lt; COMMON FUNCTIONS \u0026gt;------------------------------------------------ # # -------------------------------------------------------------------------------------------------------------------- # # -------------------------------------------------------------------------------------------------------------------- # # SYSTEM MESSAGES # -------------------------------------------------------------------------------------------------------------------- # function Write-Msg() { param ( [Alias(\u0026#39;T\u0026#39;)][string]$Type, [Alias(\u0026#39;M\u0026#39;)][string]$Message, [Alias(\u0026#39;A\u0026#39;)][string]$Action = \u0026#39;Continue\u0026#39; ) switch ($Type) { \u0026#39;HL\u0026#39; { Write-Host \u0026#34;${NL}--- ${Message}\u0026#34;.ToUpper() -ForegroundColor Blue } \u0026#39;I\u0026#39; { Write-Information -MessageData \u0026#34;${Message}\u0026#34; -InformationAction \u0026#34;${Action}\u0026#34; } \u0026#39;W\u0026#39; { Write-Warning -Message \u0026#34;${Message}\u0026#34; -WarningAction \u0026#34;${Action}\u0026#34; } \u0026#39;E\u0026#39; { Write-Error -Message \u0026#34;${Message}\u0026#34; -ErrorAction \u0026#34;${Action}\u0026#34; } default { Write-Host \u0026#34;${Message}\u0026#34; } } } # -------------------------------------------------------------------------------------------------------------------- # # -------------------------------------------------\u0026lt; RUNNING SCRIPT \u0026gt;------------------------------------------------- # # -------------------------------------------------------------------------------------------------------------------- # Start-Script ","url":"https://lib.onl/ru/2023/10/52d75b90-0637-5ba6-91d6-b1bff40e1d67/","wordCount":866}</script><script type=application/ld+json>{"@context":"https://schema.org","@id":"https://lib.onl/#website","@type":"WebSite","description":"Заметки на тему администрирования и разработки различных систем, приложений и серверов.","hasPart":[{"@context":"https://schema.org","@type":"WPHeader","cssSelector":"#site-header","headline":"headline-string"},{"@context":"https://schema.org","@type":"WPFooter","copyrightHolder":"https://lib.onl/#organization","copyrightYear":"2025","cssSelector":"#site-footer","publisher":"https://lib.onl/#organization"}],"inLanguage":[{"@type":"Language","alternateName":"ru-RU","name":"Русский"}],"keywords":["Powershell","Debian","Forum","Ipb","Ips","Mikrotik","Freebsd","Linux","Routeros","Cisco","Bash","Dns","Cloudflare","Cmd","Cmf","Cms","Php","Sql","Systemd","Vbulletin"],"mainEntityOfPage":"https://lib.onl/","name":"Library Online","publisher":"https://lib.onl/#organization","url":"https://lib.onl/"}</script><script type=application/ld+json>{"@context":"https://schema.org","@id":"https://lib.onl/#organization","@type":"Organization","address":{"@type":"PostalAddress","addressCountry":"Russia","addressLocality":"Moscow","addressRegion":"Moscow Region"},"contactPoint":{"@type":"ContactPoint","contactType":"customer service","email":"mail@lib.onl","telephone":"+7 (000) 000-0000"},"description":"Заметки на тему администрирования и разработки различных систем, приложений и серверов.","foundingDate":"2020","legalName":"Library Online","logo":{"@type":"ImageObject","url":"https://lib.onl/img/logo.min.svg"},"mainEntityOfPage":"https://lib.onl/","name":"Library Online","sameAs":[""],"url":"https://lib.onl/"}</script><script type=application/ld+json>{"@context":"https://schema.org","@graph":[{"@type":"SiteNavigationElement","name":"Статьи","position":10,"url":"https://lib.onl/ru/articles/"},{"@type":"SiteNavigationElement","name":"Q\u0026A","position":20,"url":"https://lib.onl/ru/faq/"},{"@type":"SiteNavigationElement","name":"Архив","position":100,"url":"https://lib.onl/ru/archive/"},{"@type":"SiteNavigationElement","name":"О проекте","position":999,"url":"https://lib.onl/ru/about/"},{"@type":"SiteNavigationElement","name":"META","position":9999,"url":"https://lib.onl/ru/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","item":{"@id":"https://lib.onl/ru/","name":"Главная"},"position":1},{"@type":"ListItem","item":{"@id":"https://lib.onl/ru/articles/","name":"Статьи"},"position":2},{"@type":"ListItem","item":{"@id":"https://lib.onl/ru/2023/10/52d75b90-0637-5ba6-91d6-b1bff40e1d67/","name":"PowerShell: Стирание диска"},"position":3}]}</script></body></html>